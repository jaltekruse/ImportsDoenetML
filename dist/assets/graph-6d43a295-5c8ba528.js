import{r as reactExports,M,u as useDoenetRenderer,j as jsxRuntimeExports,V as VisibilitySensor,C as Context,m as cesc}from"./index-2b5c64d9.js";import{i}from"./css-ab4d83ca-d016d639.js";var __webpack_modules__={351:(u,N,S)=>{S.d(N,{Z:()=>R});var a,X=S(765),B="1.5.1-dev";a={version:B,licenseText:"JSXGraph v"+B+" Copyright (C) see https://jsxgraph.org",COORDS_BY_USER:1,COORDS_BY_SCREEN:2,OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_TYPE_TANGENT:25,OBJECT_TYPE_HTMLSLIDER:26,OBJECT_TYPE_CHECKBOX:27,OBJECT_TYPE_INPUT:28,OBJECT_TYPE_BUTTON:29,OBJECT_TYPE_TRANSFORMATION:30,OBJECT_TYPE_FOREIGNOBJECT:31,OBJECT_TYPE_VIEW3D:32,OBJECT_TYPE_POINT3D:33,OBJECT_TYPE_LINE3D:34,OBJECT_TYPE_PLANE3D:35,OBJECT_TYPE_CURVE3D:36,OBJECT_TYPE_SURFACE3D:37,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6,OBJECT_CLASS_TEXT:7,OBJECT_CLASS_3D:8,GENTYPE_ABC:1,GENTYPE_AXIS:2,GENTYPE_MID:3,GENTYPE_REFLECTION:4,GENTYPE_MIRRORELEMENT:5,GENTYPE_REFLECTION_ON_LINE:4,GENTYPE_REFLECTION_ON_POINT:5,GENTYPE_TANGENT:6,GENTYPE_PARALLEL:7,GENTYPE_BISECTORLINES:8,GENTYPE_BOARDIMG:9,GENTYPE_BISECTOR:10,GENTYPE_NORMAL:11,GENTYPE_POINT:12,GENTYPE_GLIDER:13,GENTYPE_INTERSECTION:14,GENTYPE_CIRCLE:15,GENTYPE_CIRCLE2POINTS:16,GENTYPE_LINE:17,GENTYPE_TRIANGLE:18,GENTYPE_QUADRILATERAL:19,GENTYPE_TEXT:20,GENTYPE_POLYGON:21,GENTYPE_REGULARPOLYGON:22,GENTYPE_SECTOR:23,GENTYPE_ANGLE:24,GENTYPE_PLOT:25,GENTYPE_SLIDER:26,GENTYPE_TRUNCATE:27,GENTYPE_JCODE:28,GENTYPE_MOVEMENT:29,GENTYPE_COMBINED:30,GENTYPE_RULER:31,GENTYPE_SLOPETRIANGLE:32,GENTYPE_PERPSEGMENT:33,GENTYPE_LABELMOVEMENT:34,GENTYPE_VECTOR:35,GENTYPE_NONREFLEXANGLE:36,GENTYPE_REFLEXANGLE:37,GENTYPE_PATH:38,GENTYPE_DERIVATIVE:39,GENTYPE_DELETE:41,GENTYPE_COPY:42,GENTYPE_MIRROR:43,GENTYPE_ROTATE:44,GENTYPE_ABLATION:45,GENTYPE_MIGRATE:46,GENTYPE_VECTORCOPY:47,GENTYPE_POLYGONCOPY:48,GENTYPE_CTX_TYPE_G:51,GENTYPE_CTX_TYPE_P:52,GENTYPE_CTX_TRACE:53,GENTYPE_CTX_VISIBILITY:54,GENTYPE_CTX_CCVISIBILITY:55,GENTYPE_CTX_MPVISIBILITY:56,GENTYPE_CTX_WITHLABEL:57,GENTYPE_CTX_LABEL:58,GENTYPE_CTX_FIXED:59,GENTYPE_CTX_STROKEWIDTH:60,GENTYPE_CTX_LABELSIZE:61,GENTYPE_CTX_SIZE:62,GENTYPE_CTX_FACE:63,GENTYPE_CTX_STRAIGHT:64,GENTYPE_CTX_ARROW:65,GENTYPE_CTX_COLOR:66,GENTYPE_CTX_RADIUS:67,GENTYPE_CTX_COORDS:68,GENTYPE_CTX_TEXT:69,GENTYPE_CTX_ANGLERADIUS:70,GENTYPE_CTX_DOTVISIBILITY:71,GENTYPE_CTX_FILLOPACITY:72,GENTYPE_CTX_PLOT:73,GENTYPE_CTX_SCALE:74,GENTYPE_CTX_INTVAL:75,GENTYPE_CTX_POINT1:76,GENTYPE_CTX_POINT2:77,GENTYPE_CTX_LABELSTICKY:78,GENTYPE_CTX_TYPE_I:79,GENTYPE_CTX_HASINNERPOINTS:80,GENTYPE_CTX_SNAPWIDTH:81,GENTYPE_CTX_SNAPTOGRID:82},X.Z.extendConstants(X.Z,a);const R=a},705:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(351),B=S(88),R=S(109),A=S(275);a.Z.Coords=function(c,m,v,_){this.board=v,this.usrCoords=[],this.scrCoords=[],this.emitter=!R.Z.exists(_)||_,this.emitter&&B.Z.eventify(this),this.setCoordinates(c,m,!1,!0)},a.Z.extend(a.Z.Coords.prototype,{normalizeUsrCoords:function(){Math.abs(this.usrCoords[0])>A.Z.eps&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(c){var m=Math.round,v=this.board,_=this.usrCoords,f=v.origin.scrCoords;c===!0?(this.scrCoords[0]=m(_[0]),this.scrCoords[1]=m(_[0]*f[1]+_[1]*v.unitX),this.scrCoords[2]=m(_[0]*f[2]-_[2]*v.unitY)):(this.scrCoords[0]=_[0],this.scrCoords[1]=_[0]*f[1]+_[1]*v.unitX,this.scrCoords[2]=_[0]*f[2]-_[2]*v.unitY)},screen2usr:function(){var c=this.board.origin.scrCoords,m=this.scrCoords,v=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(m[1]-c[1])/v.unitX,this.usrCoords[2]=(c[2]-m[2])/v.unitY},distance:function(c,m){var v,_,f=0,g=this.usrCoords,C=this.scrCoords;if(c===X.Z.COORDS_BY_USER){if(v=m.usrCoords,(f=(_=g[0]-v[0])*_)>A.Z.eps*A.Z.eps)return Number.POSITIVE_INFINITY;f+=(_=g[1]-v[1])*_,f+=(_=g[2]-v[2])*_}else v=m.scrCoords,f+=(_=C[1]-v[1])*_,f+=(_=C[2]-v[2])*_;return Math.sqrt(f)},setCoordinates:function(c,m,v,_){var f=this.usrCoords,g=this.scrCoords,C=[f[0],f[1],f[2]],P=[g[0],g[1],g[2]];return c===X.Z.COORDS_BY_USER?(m.length===2?(f[0]=1,f[1]=m[0],f[2]=m[1]):(f[0]=m[0],f[1]=m[1],f[2]=m[2],this.normalizeUsrCoords()),this.usr2screen(v)):(m.length===2?(g[1]=m[0],g[2]=m[1]):(g[1]=m[1],g[2]=m[2]),this.screen2usr()),!this.emitter||_||P[1]===g[1]&&P[2]===g[2]||this.triggerEventHandlers(["update"],[C,P]),this},copy:function(c,m){return m===void 0&&(m=0),this[c].slice(m)},isReal:function(){return!isNaN(this.usrCoords[1]+this.usrCoords[2])&&Math.abs(this.usrCoords[0])>A.Z.eps},__evt__update:function(c,m){},__evt:function(){}});const E=a.Z.Coords},218:(u,N,S)=>{S.d(N,{Z:()=>v});var a=S(765),X=S(275),B=S(922),R=S(336),A=S(309),E=S(705),c=S(351),m=S(109);a.Z.CoordsElement=function(_,f){var g;for(m.Z.exists(_)||(_=[1,0,0]),g=0;g<_.length;++g)_[g]=parseFloat(_[g]);this.coords=new E.Z(c.Z.COORDS_BY_USER,_,this.board),this.initialCoords=new E.Z(c.Z.COORDS_BY_USER,_,this.board),this.position=null,this.isConstrained=!1,this.onPolygon=!1,this.slideObject=null,this.slideObjects=[],this.needsUpdateFromParent=!0,this.groups=[],this.Xjc=null,this.Yjc=null,this.methodMap=m.Z.deepCopy(this.methodMap,{move:"moveTo",moveTo:"moveTo",moveAlong:"moveAlong",visit:"visit",glide:"makeGlider",makeGlider:"makeGlider",intersect:"makeIntersection",makeIntersection:"makeIntersection",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition",setGliderPosition:"setGliderPosition",addConstraint:"addConstraint",dist:"Dist",onPolygon:"onPolygon"}),m.Z.exists(this.element)&&this.addAnchor(_,f),this.isDraggable=!0},a.Z.extend(a.Z.CoordsElement.prototype,{updateConstraint:function(){return this},updateCoords:function(_){return this.needsUpdate?(m.Z.exists(_)||(_=!1),m.Z.evaluate(this.visProp.frozen)||this.updateConstraint(),this.type===c.Z.OBJECT_TYPE_GLIDER&&(this.isConstrained&&(_=!1),_?this.updateGliderFromParent():this.updateGlider()),this.updateTransform(_),this):this},updateGlider:function(){var _,f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q,it,rt=2*Math.PI,dt=!1,ht=this.slideObject,ut=[];if(this.needsUpdateFromParent=!1,ht.elementClass===c.Z.OBJECT_CLASS_CIRCLE)m.Z.evaluate(this.visProp.isgeonext)&&(rt=1),q=B.Z.projectPointToCircle(this,ht,this.board),K=B.Z.rad([ht.center.X()+1,ht.center.Y()],ht.center,this)/rt;else if(ht.elementClass===c.Z.OBJECT_CLASS_LINE){if(this.onPolygon){if(f=ht.point1.coords.usrCoords,C=(g=ht.point2.coords.usrCoords)[_=1]-f[_],Math.abs(C)<X.Z.eps&&(C=g[_=2]-f[_]),T=(B.Z.projectPointToLine(this,ht,this.board).usrCoords[_]-f[_])/C,w=ht.parentPolygon,T<0){for(_=0;_<w.borders.length;_++)if(ht===w.borders[_]){ht=w.borders[(_-1+w.borders.length)%w.borders.length];break}}else if(T>1){for(_=0;_<w.borders.length;_++)if(ht===w.borders[_]){ht=w.borders[(_+1+w.borders.length)%w.borders.length];break}}ht.id!==this.slideObject.id&&(this.slideObject=ht)}f=ht.point1.coords,g=ht.point2.coords,(C=f.distance(c.Z.COORDS_BY_USER,g))<X.Z.eps?(q=f,dt=!0,K=0):(q=B.Z.projectPointToLine(this,ht,this.board),f=f.usrCoords.slice(0),g=g.usrCoords.slice(0),Math.abs(g[0])<X.Z.eps?(C=g[_=1],Math.abs(C)<X.Z.eps&&(C=g[_=2]),K=((C=(q.usrCoords[_]-f[_])/C)>=0?1:-1)*(C=Math.abs(C))/(C+1)):Math.abs(f[0])<X.Z.eps?(C=f[_=1],Math.abs(C)<X.Z.eps&&(C=f[_=2]),K=(C=(q.usrCoords[_]-g[_])/C)<0?(1-2*C)/(1-C):1/(C+1)):(C=g[_=1]-f[_],Math.abs(C)<X.Z.eps&&(C=g[_=2]-f[_]),K=(q.usrCoords[_]-f[_])/C)),at=m.Z.evaluate(this.visProp.snapwidth),m.Z.evaluate(at)>0&&Math.abs(this._smax-this._smin)>=X.Z.eps&&(P=(K=Math.max(Math.min(K,1),0))*(this._smax-this._smin)+this._smin,K=((P=Math.round(P/at)*at)-this._smin)/(this._smax-this._smin),this.update(!0)),f=ht.point1.coords,!m.Z.evaluate(ht.visProp.straightfirst)&&Math.abs(f.usrCoords[0])>X.Z.eps&&K<0&&(q=f,dt=!0,K=0),g=ht.point2.coords,!m.Z.evaluate(ht.visProp.straightlast)&&Math.abs(g.usrCoords[0])>X.Z.eps&&K>1&&(q=g,dt=!0,K=1)}else if(ht.type===c.Z.OBJECT_TYPE_TURTLE)this.updateConstraint(),q=(tt=B.Z.projectPointToTurtle(this,ht,this.board))[0],K=tt[1];else if(ht.elementClass===c.Z.OBJECT_CLASS_CURVE)if(ht.type===c.Z.OBJECT_TYPE_ARC||ht.type===c.Z.OBJECT_TYPE_SECTOR)q=B.Z.projectPointToCircle(this,ht,this.board),j=B.Z.rad(ht.radiuspoint,ht.center,this),L=0,Y=B.Z.rad(ht.radiuspoint,ht.center,ht.anglepoint),K=j,((at=m.Z.evaluate(ht.visProp.selection))==="minor"&&Y>Math.PI||at==="major"&&Y<Math.PI)&&(L=Y,Y=2*Math.PI),(j<L||j>Y)&&(K=Y,(j<L&&j>.5*L||j>Y&&j>.5*Y+Math.PI)&&(K=L),this.needsUpdateFromParent=!0,this.updateGliderFromParent()),rt=Y-L,this.visProp.isgeonext&&(rt=1),Math.abs(rt)>X.Z.eps&&(K/=rt);else if(this.updateConstraint(),ht.transformations.length>0){for(it=!1,(tt=ht.getTransformationSource())[0]&&(it=tt[0],ut.push(ht),ut.push(tt[1]));tt[0]&&m.Z.exists(tt[1]._transformationSource);)tt=tt[1].getTransformationSource(),ut.push(tt[1]);if(Q=this.coords.usrCoords,it){for(_=0;_<ut.length;_++)ut[_].updateTransformMatrix(),H=X.Z.inverse(ut[_].transformMat),Q=X.Z.matVecMult(H,Q);for(F=new E.Z(c.Z.COORDS_BY_USER,Q,this.board).usrCoords,Q=(G=B.Z.projectCoordsToCurve(F[1],F[2],this.position||0,ut[ut.length-1],this.board))[0].usrCoords,_=ut.length-2;_>=0;_--)Q=X.Z.matVecMult(ut[_].transformMat,Q);G[0]=new E.Z(c.Z.COORDS_BY_USER,Q,this.board)}else ht.updateTransformMatrix(),H=X.Z.inverse(ht.transformMat),Q=X.Z.matVecMult(H,Q),F=new E.Z(c.Z.COORDS_BY_USER,Q,this.board).usrCoords,G=B.Z.projectCoordsToCurve(F[1],F[2],this.position||0,ht,this.board);q=G[0],K=G[1]}else q=(tt=B.Z.projectPointToCurve(this,ht,this.board))[0],K=tt[1];else m.Z.isPoint(ht)&&(q=B.Z.projectPointToPoint(this,ht,this.board),K=this.position);this.coords.setCoordinates(c.Z.COORDS_BY_USER,q.usrCoords,dt),this.position=K},updateGliderFromParent:function(){var _,f,g,C,P,w,T,L,Y,j,F,G,H=this.slideObject,q=[],K=2*Math.PI;if(this.needsUpdateFromParent){if(H.elementClass===c.Z.OBJECT_CLASS_CIRCLE)g=H.Radius(),m.Z.evaluate(this.visProp.isgeonext)&&(K=1),P=[H.center.X()+g*Math.cos(this.position*K),H.center.Y()+g*Math.sin(this.position*K)];else if(H.elementClass===c.Z.OBJECT_CLASS_LINE)_=H.point1.coords.usrCoords,f=H.point2.coords.usrCoords,_[0]===0&&_[1]===0&&_[2]===0||f[0]===0&&f[1]===0&&f[2]===0?P=[0,0,0]:Math.abs(f[0])<X.Z.eps?(C=Math.min(Math.abs(this.position),1-X.Z.eps),C/=1-C,this.position<0&&(C=-C),P=[_[0]+C*f[0],_[1]+C*f[1],_[2]+C*f[2]]):Math.abs(_[0])<X.Z.eps?(C=Math.max(this.position,X.Z.eps),C=(C=Math.min(C,2-X.Z.eps))>1?(C-1)/(C-2):(1-C)/C,P=[f[0]+C*_[0],f[1]+C*_[1],f[2]+C*_[2]]):(C=this.position,P=[_[0]+C*(f[0]-_[0]),_[1]+C*(f[1]-_[1]),_[2]+C*(f[2]-_[2])]);else if(H.type===c.Z.OBJECT_TYPE_TURTLE)this.coords.setCoordinates(c.Z.COORDS_BY_USER,[H.Z(this.position),H.X(this.position),H.Y(this.position)]),this.updateConstraint(),P=B.Z.projectPointToTurtle(this,H,this.board)[0].usrCoords;else if(H.elementClass===c.Z.OBJECT_CLASS_CURVE){for(L=!1,(w=H.getTransformationSource())[0]&&(L=w[0],q.push(H),q.push(w[1]));w[0]&&m.Z.exists(w[1]._transformationSource);)w=w[1].getTransformationSource(),q.push(w[1]);if(L?this.coords.setCoordinates(c.Z.COORDS_BY_USER,[q[q.length-1].Z(this.position),q[q.length-1].X(this.position),q[q.length-1].Y(this.position)]):this.coords.setCoordinates(c.Z.COORDS_BY_USER,[H.Z(this.position),H.X(this.position),H.Y(this.position)]),H.type===c.Z.OBJECT_TYPE_ARC||H.type===c.Z.OBJECT_TYPE_SECTOR)Y=B.Z.rad([H.center.X()+1,H.center.Y()],H.center,H.radiuspoint),j=0,G=B.Z.rad(H.radiuspoint,H.center,H.anglepoint),(H.visProp.selection==="minor"&&G>Math.PI||H.visProp.selection==="major"&&G<Math.PI)&&(j=G,G=2*Math.PI),K=G-j,m.Z.evaluate(this.visProp.isgeonext)&&(K=1),((F=this.position*K)<j||F>G)&&(((F=G)<j&&F>.5*j||F>G&&F>.5*G+Math.PI)&&(F=j),this.position=F,Math.abs(K)>X.Z.eps&&(this.position/=K)),g=H.Radius(),P=[H.center.X()+g*Math.cos(this.position*K+Y),H.center.Y()+g*Math.sin(this.position*K+Y)];else if(this.updateConstraint(),L)for(P=B.Z.projectPointToCurve(this,q[q.length-1],this.board)[0].usrCoords,T=q.length-2;T>=0;T--)P=new E.Z(c.Z.COORDS_BY_USER,X.Z.matVecMult(q[T].transformMat,P),this.board).usrCoords;else P=B.Z.projectPointToCurve(this,H,this.board)[0].usrCoords}else m.Z.isPoint(H)&&(P=B.Z.projectPointToPoint(this,H,this.board).usrCoords);this.coords.setCoordinates(c.Z.COORDS_BY_USER,P,!1)}else this.needsUpdateFromParent=!0},updateRendererGeneric:function(_){return this.needsUpdate&&this.board.renderer?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>X.Z.eps&&this.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer[_](this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},Dist:function(_){return this.isReal&&_.isReal?this.coords.distance(c.Z.COORDS_BY_USER,_.coords):NaN},snapToGrid:function(_){return this.handleSnapToGrid(_)},handleSnapToPoints:function(_){var f,g,C,P,w,T,L,Y,j=0,F=1/0,G=null,H=m.Z.evaluate(this.visProp.ignoredsnaptopoints),q=!1;if(P=this.board.objectsList.length,H&&(L=H.length),m.Z.evaluate(this.visProp.snaptopoints)||_){for(w=m.Z.evaluate(this.visProp.attractorunit),T=m.Z.evaluate(this.visProp.attractordistance),f=0;f<P;f++){if(g=this.board.objectsList[f],H){for(q=!1,Y=0;Y<L;Y++)if(g===this.board.select(H[Y])){q=!0;break}if(q)continue}m.Z.isPoint(g)&&g!==this&&g.visPropCalc.visible&&(C=B.Z.projectPointToPoint(this,g,this.board),(j=w==="screen"?C.distance(c.Z.COORDS_BY_SCREEN,this.coords):C.distance(c.Z.COORDS_BY_USER,this.coords))<T&&j<F&&(F=j,G=C))}G!==null&&this.coords.setCoordinates(c.Z.COORDS_BY_USER,G.usrCoords)}return this},snapToPoints:function(_){return this.handleSnapToPoints(_)},handleAttractors:function(){var _,f,g,C,P=0,w=m.Z.evaluate(this.visProp.attractorunit),T=m.Z.evaluate(this.visProp.attractordistance),L=m.Z.evaluate(this.visProp.snatchdistance),Y=m.Z.evaluate(this.visProp.attractors),j=Y.length;if(T!==0){for(_=0;_<j;_++)if(f=this.board.select(Y[_]),m.Z.exists(f)&&f!==this){if(m.Z.isPoint(f)?g=B.Z.projectPointToPoint(this,f,this.board):f.elementClass===c.Z.OBJECT_CLASS_LINE?(C=B.Z.projectCoordsToSegment(this.coords.usrCoords,f.point1.coords.usrCoords,f.point2.coords.usrCoords),g=!m.Z.evaluate(f.visProp.straightfirst)&&C[1]<0?f.point1.coords:!m.Z.evaluate(f.visProp.straightlast)&&C[1]>1?f.point2.coords:new E.Z(c.Z.COORDS_BY_USER,C[0],this.board)):f.elementClass===c.Z.OBJECT_CLASS_CIRCLE?g=B.Z.projectPointToCircle(this,f,this.board):f.elementClass===c.Z.OBJECT_CLASS_CURVE?g=B.Z.projectPointToCurve(this,f,this.board)[0]:f.type===c.Z.OBJECT_TYPE_TURTLE?g=B.Z.projectPointToTurtle(this,f,this.board)[0]:f.type===c.Z.OBJECT_TYPE_POLYGON&&(g=new E.Z(c.Z.COORDS_BY_USER,B.Z.projectCoordsToPolygon(this.coords.usrCoords,f),this.board)),(P=w==="screen"?g.distance(c.Z.COORDS_BY_SCREEN,this.coords):g.distance(c.Z.COORDS_BY_USER,this.coords))<T){this.type===c.Z.OBJECT_TYPE_GLIDER&&(f===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===f)||this.makeGlider(f);break}P>=L&&(f===this.slideObject||this.slideObject&&this.onPolygon&&this.slideObject.parentPolygon===f)&&this.popSlideObject()}return this}},setPositionDirectly:function(_,f){var g,C,P,w,T=this.coords;if(this.relativeCoords)return C=new E.Z(_,f,this.board),m.Z.evaluate(this.visProp.islabel)?(P=A.Z.subtract(C.scrCoords,T.scrCoords),this.relativeCoords.scrCoords[1]+=P[1],this.relativeCoords.scrCoords[2]+=P[2]):(P=A.Z.subtract(C.usrCoords,T.usrCoords),this.relativeCoords.usrCoords[1]+=P[1],this.relativeCoords.usrCoords[2]+=P[2]),this;for(this.coords.setCoordinates(_,f),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),g=this.transformations.length-1;g>=0;g--)_===c.Z.COORDS_BY_SCREEN?w=new E.Z(_,f,this.board).usrCoords:(f.length===2&&(f=[1].concat(f)),w=f),this.initialCoords.setCoordinates(c.Z.COORDS_BY_USER,X.Z.matVecMult(X.Z.inverse(this.transformations[g].matrix),w));return this.prepareUpdate().update(),this.board.isSuspendedUpdate&&this.type===c.Z.OBJECT_TYPE_GLIDER&&this.updateGlider(),this},setPositionByTransform:function(_,f){var g;return f=new E.Z(_,f,this.board),g=this.board.create("transform",f.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(g):this.addTransform(this,g),this.prepareUpdate().update(),this},setPosition:function(_,f){return this.setPositionDirectly(_,f)},setGliderPosition:function(_){return this.type===c.Z.OBJECT_TYPE_GLIDER&&(this.position=_,this.board.update()),this},makeGlider:function(_){var f,g,C,P=this.board.select(_),w=!1;if(P.type===c.Z.OBJECT_TYPE_POLYGON){for(f=Number.MAX_VALUE,g=0;g<P.borders.length;g++)(C=a.Z.Math.Geometry.distPointLine(this.coords.usrCoords,P.borders[g].stdform))<f&&(f=C,_=P.borders[g]);P=this.board.select(_),w=!0}if(!m.Z.exists(P))throw new Error("JSXGraph: slide object undefined.");if(P.type===c.Z.OBJECT_TYPE_TICKS)throw new Error("JSXGraph: gliders on ticks are not possible.");return this.slideObject=this.board.select(_),this.slideObjects.push(this.slideObject),this.addParents(_),this.type=c.Z.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.onPolygon=w,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this.needsUpdateFromParent=!0,this.updateGliderFromParent(),this},popSlideObject:function(){this.slideObjects.length>0&&(this.slideObjects.pop(),this.slideObject.removeChild(this),this.slideObjects.length===0?(this.type=this._org_type,this.type===c.Z.OBJECT_TYPE_POINT?this.elType="point":this.elementClass===c.Z.OBJECT_CLASS_TEXT?this.elType="text":this.type===c.Z.OBJECT_TYPE_IMAGE?this.elType="image":this.type===c.Z.OBJECT_TYPE_FOREIGNOBJECT&&(this.elType="foreignobject"),this.slideObject=null):this.slideObject=this.slideObjects[this.slideObjects.length-1])},free:function(){var _,f;if(this.type!==c.Z.OBJECT_TYPE_GLIDER){if(this.transformations.length=0,delete this.updateConstraint,this.isConstrained=!1,this.isDraggable)return;this.isDraggable=!0,this.elementClass===c.Z.OBJECT_CLASS_POINT&&(this.type=c.Z.OBJECT_TYPE_POINT,this.elType="point"),this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(_ in this.board.objects)this.board.objects.hasOwnProperty(_)&&(f=this.board.objects[_]).descendants&&(delete f.descendants[this.id],delete f.childElements[this.id],this.hasLabel&&(delete f.descendants[this.label.id],delete f.childElements[this.label.id]));this.ancestors={},this.slideObject=null,this.slideObjects=[],this.elementClass===c.Z.OBJECT_CLASS_POINT?(this.type=c.Z.OBJECT_TYPE_POINT,this.elType="point"):this.elementClass===c.Z.OBJECT_CLASS_TEXT?(this.type=this._org_type,this.elType="text"):this.elementClass===c.Z.OBJECT_CLASS_OTHER&&(this.type=this._org_type,this.elType="image")},addConstraint:function(_){var f,g,C=[],P=["X","Y"],w=function(L){return function(){return L}},T=function(L){return function(){return L.Value()}};for(this.elementClass===c.Z.OBJECT_CLASS_POINT&&(this.type=c.Z.OBJECT_TYPE_CAS),this.isDraggable=!1,f=0;f<_.length;f++)g=_[f],m.Z.isString(g)?(C[f]=this.board.jc.snippet(g,!0,null,!0),this.addParentsFromJCFunctions([C[f]]),_.length===2&&(this[P[f]+"jc"]=_[f])):m.Z.isFunction(g)?C[f]=g:m.Z.isNumber(g)?C[f]=w(g):m.Z.isObject(g)&&m.Z.isFunction(g.Value)&&(C[f]=T(g)),C[f].origin=g;return _.length===1?this.updateConstraint=function(){var L=C[0]();return m.Z.isArray(L)?this.coords.setCoordinates(c.Z.COORDS_BY_USER,L):this.coords=L,this}:_.length===2?(this.XEval=C[0],this.YEval=C[1],this.addParents([C[0].origin,C[1].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.Z.COORDS_BY_USER,[this.XEval(),this.YEval()]),this}):(this.ZEval=C[0],this.XEval=C[1],this.YEval=C[2],this.addParents([C[0].origin,C[1].origin,C[2].origin]),this.updateConstraint=function(){return this.coords.setCoordinates(c.Z.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]),this}),this.isConstrained=!0,this.prepareUpdate().update(),this.board.isSuspendedUpdate||(this.updateVisibility().updateRenderer(),this.hasLabel&&this.label.fullUpdate()),this},addAnchor:function(_,f){this.relativeCoords=f?new E.Z(c.Z.COORDS_BY_SCREEN,_.slice(0,2),this.board):new E.Z(c.Z.COORDS_BY_USER,_,this.board),this.element.addChild(this),f&&this.addParents(this.element),this.XEval=function(){var g,C,P;return m.Z.evaluate(this.visProp.islabel)?(P=m.Z.evaluate(this.visProp.offset),g=parseFloat(P[0]),C=this.element.getLabelAnchor(),new E.Z(c.Z.COORDS_BY_SCREEN,[g+this.relativeCoords.scrCoords[1]+C.scrCoords[1],0],this.board).usrCoords[1]):(C=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+C.usrCoords[1])},this.YEval=function(){var g,C,P;return m.Z.evaluate(this.visProp.islabel)?(P=m.Z.evaluate(this.visProp.offset),g=-parseFloat(P[1]),C=this.element.getLabelAnchor(),new E.Z(c.Z.COORDS_BY_SCREEN,[0,g+this.relativeCoords.scrCoords[2]+C.scrCoords[2]],this.board).usrCoords[2]):(C=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+C.usrCoords[2])},this.ZEval=m.Z.createFunction(1,this.board,""),this.updateConstraint=function(){this.coords.setCoordinates(c.Z.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()])},this.isConstrained=!0,this.updateConstraint()},updateTransform:function(_){var f;if(this.transformations.length===0)return this;for(f=0;f<this.transformations.length;f++)this.transformations[f].update();return this},addTransform:function(_,f){var g,C=m.Z.isArray(f)?f:[f],P=C.length;for(this.transformations.length===0&&(this.baseElement=_),g=0;g<P;g++)this.transformations.push(C[g]);return this},startAnimation:function(_,f,g){var C=m.Z.evaluate(_),P=m.Z.evaluate(f),w=this;return g=m.Z.evaluate(g)||250,this.type!==c.Z.OBJECT_TYPE_GLIDER||m.Z.exists(this.intervalCode)||(this.intervalCode=window.setInterval(function(){w._anim(C,P)},g),m.Z.exists(this.intervalCount)||(this.intervalCount=0)),this},stopAnimation:function(){return m.Z.exists(this.intervalCode)&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(_,f,g){g=g||{};var C,P,w,T,L,Y=[],j=[],F=f/this.board.attr.animationdelay,G=function(H,q){return function(){return _[H][q]}};if(m.Z.isArray(_)){for(w=_.length,C=0;C<w;C++)m.Z.isPoint(_[C])?j[C]=_[C]:j[C]={elementClass:c.Z.OBJECT_CLASS_POINT,X:G(C,0),Y:G(C,1)};if((f=f||0)===0)return this.setPosition(c.Z.COORDS_BY_USER,[j[j.length-1].X(),j[j.length-1].Y()]),this.board.update(this);if(!m.Z.exists(g.interpolate)||g.interpolate)for(P=R.Z.Neville(j),C=0;C<F;C++)Y[C]=[],Y[C][0]=P[0]((F-C)/F*P[3]()),Y[C][1]=P[1]((F-C)/F*P[3]());else{for(w=_.length-1,C=0;C<F;++C)L=C/F*w-(T=Math.floor(C/F*w)),Y[C]=[],Y[C][0]=(1-L)*j[T].X()+L*j[T+1].X(),Y[C][1]=(1-L)*j[T].Y()+L*j[T+1].Y();Y.push([j[w].X(),j[w].Y()]),Y.reverse()}this.animationPath=Y}else m.Z.isFunction(_)&&(this.animationPath=_,this.animationStart=new Date().getTime());return this.animationCallback=g.callback,this.board.addAnimation(this),this},moveTo:function(_,f,g){g=g||{},_=new E.Z(c.Z.COORDS_BY_USER,_,this.board);var C,P=this.board.attr.animationdelay,w=Math.ceil(f/P),T=[],L=this.coords.usrCoords[1],Y=this.coords.usrCoords[2],j=_.usrCoords[1]-L,F=_.usrCoords[2]-Y,G=function(H){return g.effect&&g.effect==="<>"?Math.pow(Math.sin(H/w*Math.PI/2),2):H/w};if(!m.Z.exists(f)||f===0||Math.abs(_.usrCoords[0]-this.coords.usrCoords[0])>X.Z.eps)return this.setPosition(c.Z.COORDS_BY_USER,_.usrCoords),this.board.update(this);if(!m.Z.exists(g.callback)&&Math.abs(j)<X.Z.eps&&Math.abs(F)<X.Z.eps)return this;for(C=w;C>=0;C--)T[w-C]=[_.usrCoords[0],L+j*G(C),Y+F*G(C)];return this.animationPath=T,this.animationCallback=g.callback,this.board.addAnimation(this),this},visit:function(_,f,g){_=new E.Z(c.Z.COORDS_BY_USER,_,this.board);var C,P,w,T=this.board.attr.animationdelay,L=[],Y=this.coords.usrCoords[1],j=this.coords.usrCoords[2],F=_.usrCoords[1]-Y,G=_.usrCoords[2]-j,H=function(q){var K=q<w/2?2*q/w:2*(w-q)/w;return g.effect&&g.effect==="<>"?Math.pow(Math.sin(K*Math.PI/2),2):K};for(m.Z.isNumber(g)?g={repeat:g}:(g=g||{},m.Z.exists(g.repeat)||(g.repeat=1)),w=Math.ceil(f/(T*g.repeat)),P=0;P<g.repeat;P++)for(C=w;C>=0;C--)L[P*(w+1)+w-C]=[_.usrCoords[0],Y+F*H(C),j+G*H(C)];return this.animationPath=L,this.animationCallback=g.callback,this.board.addAnimation(this),this},_anim:function(_,f){var g,C,P,w,T,L,Y,j,F;return this.intervalCount+=1,this.intervalCount>f&&(this.intervalCount=0),this.slideObject.elementClass===c.Z.OBJECT_CLASS_LINE?(Y=this.slideObject.point1.coords.scrCoords,j=this.slideObject.point2.coords.scrCoords,g=Math.round((j[1]-Y[1])*this.intervalCount/f),C=Math.round((j[2]-Y[2])*this.intervalCount/f),_>0?w=this.slideObject.point1:(w=this.slideObject.point2,g*=-1,C*=-1),this.coords.setCoordinates(c.Z.COORDS_BY_SCREEN,[w.coords.scrCoords[1]+g,w.coords.scrCoords[2]+C])):this.slideObject.elementClass===c.Z.OBJECT_CLASS_CURVE?(T=_>0?Math.round(this.intervalCount/f*this.board.canvasWidth):Math.round((f-this.intervalCount)/f*this.board.canvasWidth),this.coords.setCoordinates(c.Z.COORDS_BY_SCREEN,[T,0]),F=B.Z.projectPointToCurve(this,this.slideObject,this.board),this.coords=F[0],this.position=F[1]):this.slideObject.elementClass===c.Z.OBJECT_CLASS_CIRCLE&&(P=2*Math.PI,P*=_<0?this.intervalCount/f:(f-this.intervalCount)/f,L=this.slideObject.Radius(),this.coords.setCoordinates(c.Z.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+L*Math.cos(P),this.slideObject.center.coords.usrCoords[2]+L*Math.sin(P)])),this.board.update(this),this},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},getParents:function(){var _=[this.Z(),this.X(),this.Y()];return this.parents.length!==0&&(_=this.parents),this.type===c.Z.OBJECT_TYPE_GLIDER&&(_=[this.X(),this.Y(),this.slideObject.id]),_}}),a.Z.CoordsElement.create=function(_,f,g,C,P,w){var T,L,Y=!1;for(L=0;L<g.length;L++)(m.Z.isFunction(g[L])||m.Z.isString(g[L]))&&(Y=!0);if(Y)(T=new _(f,[0,0],C,P,w)).addConstraint(g);else if(m.Z.isNumber(g[0])&&m.Z.isNumber(g[1]))T=new _(f,g,C,P,w),m.Z.exists(C.slideobject)?T.makeGlider(C.slideobject):T.baseElement=T,T.isDraggable=!0;else{if(!m.Z.isObject(g[0])||!m.Z.isTransformationOrArray(g[1]))return!1;(T=new _(f,[0,0],C,P,w)).addTransform(g[0],g[1]),T.isDraggable=!1}return T.handleSnapToGrid(),T.handleSnapToPoints(),T.handleAttractors(),T.addParents(g),T};const v=a.Z.CoordsElement},958:(u,N,S)=>{S.d(N,{Z:()=>_});var a=S(765),X=S(351),B=S(705),R=S(275),A=S(309),E=S(766),c=S(88),m=S(327),v=S(109);a.Z.GeometryElement=function(f,g,C,P){var w,T,L;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.parents=[],this.symbolic={},this.rendNode=null,this.elType="",this.dump=!0,this.subs={},this.inherits=[],this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabel",label:"label",setName:"setName",getName:"getName",addTransform:"addTransform",setProperty:"setAttribute",setAttribute:"setAttribute",addChild:"addChild",animate:"animate",on:"on",off:"off",trigger:"trigger",addTicks:"addTicks",removeTicks:"removeTicks",removeAllTicks:"removeAllTicks"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},this.visPropCalc={visible:!1},c.Z.eventify(this),this.mouseover=!1,this.lastDragTime=new Date,arguments.length>0){for(T in this.board=f,this.type=C,this._org_type=C,this.elementClass=P||X.Z.OBJECT_CLASS_OTHER,this.id=g.id,w=g.name,v.Z.exists(w)||(w=this.board.generateName(this)),w!==""&&(this.board.elementsByName[w]=this),this.name=w,this.needsRegularUpdate=g.needsregularupdate,v.Z.clearVisPropOld(this),L=this.resolveShortcuts(g))L.hasOwnProperty(T)&&this._set(T,L[T]);this.visProp.draft=L.draft&&L.draft.draft}},a.Z.extend(a.Z.GeometryElement.prototype,{addChild:function(f){var g,C;for(g in this.childElements[f.id]=f,this.addDescendants(f),f.ancestors[this.id]=this,this.descendants)if(this.descendants.hasOwnProperty(g))for(C in this.descendants[g].ancestors[this.id]=this,this.ancestors)this.ancestors.hasOwnProperty(C)&&(this.descendants[g].ancestors[this.ancestors[C].id]=this.ancestors[C]);for(g in this.ancestors)if(this.ancestors.hasOwnProperty(g))for(C in this.descendants)this.descendants.hasOwnProperty(C)&&(this.ancestors[g].descendants[this.descendants[C].id]=this.descendants[C]);return this},addDescendants:function(f){var g;for(g in this.descendants[f.id]=f,f.childElements)f.childElements.hasOwnProperty(g)&&this.addDescendants(f.childElements[g]);return this},addParents:function(f){var g,C,P;for(C=(P=v.Z.isArray(f)?f:arguments).length,g=0;g<C;++g)v.Z.exists(P[g])&&(v.Z.isId(this.board,P[g])?this.parents.push(P[g]):v.Z.exists(P[g].id)&&this.parents.push(P[g].id));this.parents=v.Z.uniqueArray(this.parents)},setParents:function(f){this.parents=[],this.addParents(f)},addParentsFromJCFunctions:function(f){var g,C,P;for(g=0;g<f.length;g++)for(C in f[g].deps)P=f[g].deps[C],this.addParents(P),P.addChild(this);return this},removeChild:function(f){return delete this.childElements[f.id],this.removeDescendants(f),delete f.ancestors[this.id],this},removeDescendants:function(f){var g;for(g in delete this.descendants[f.id],f.childElements)f.childElements.hasOwnProperty(g)&&this.removeDescendants(f.childElements[g]);return this},countChildren:function(){var f,g,C=0;for(f in g=this.childElements)g.hasOwnProperty(f)&&f.indexOf("Label")<0&&C++;return C},getName:function(){return this.name},addTransform:function(f){return this},draggable:function(){return this.isDraggable&&!v.Z.evaluate(this.visProp.fixed)&&this.type!==X.Z.OBJECT_TYPE_GLIDER},setPosition:function(f,g){var C,P,w,T,L=[];if(!v.Z.exists(this.parents))return this;for(w=this.parents.length,P=0;P<w;++P)if(C=this.board.select(this.parents[P]),v.Z.isPoint(C)){if(!C.draggable())return this;L.push(C)}for(g.length===3&&(g=g.slice(1)),T=this.board.create("transform",g,{type:"translate"}),(w=L.length)>0?T.applyOnce(L):this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(T):this.addTransform(T),P=0;P<w;++P)L[P].type===X.Z.OBJECT_TYPE_GLIDER&&L[P].updateGlider();return this},setPositionDirectly:function(f,g,C){var P=new B.Z(f,g,this.board,!1),w=new B.Z(f,C,this.board,!1),T=A.Z.subtract(P.usrCoords,w.usrCoords);return this.setPosition(X.Z.COORDS_BY_USER,T),this},generatePolynomial:function(){return[]},animate:function(f,g,C){C=C||{};var P,w,T,L=this.board.attr.animationdelay,Y=Math.ceil(g/L),j=this,F=function(H,q,K){var at,tt,Q,it,rt;for(at=m.Z.rgb2hsv(H),Q=((tt=m.Z.rgb2hsv(q))[0]-at[0])/Y,it=(tt[1]-at[1])/Y,rt=(tt[2]-at[2])/Y,j.animationData[K]=[],T=0;T<Y;T++)j.animationData[K][Y-T-1]=m.Z.hsv2rgb(at[0]+(T+1)*Q,at[1]+(T+1)*it,at[2]+(T+1)*rt)},G=function(H,q,K,at){var tt,Q;if(H=parseFloat(H),q=parseFloat(q),!isNaN(H)&&!isNaN(q))for(Q=(q-H)/Y,j.animationData[K]=[],T=0;T<Y;T++)tt=H+(T+1)*Q,j.animationData[K][Y-T-1]=at?Math.floor(tt):tt};for(P in this.animationData={},f)if(f.hasOwnProperty(P))switch(w=P.toLowerCase()){case"strokecolor":case"fillcolor":F(this.visProp[w],f[P],w);break;case"size":if(!v.Z.isPoint(this))break;G(this.visProp[w],f[P],w,!0);break;case"strokeopacity":case"strokewidth":case"fillopacity":G(this.visProp[w],f[P],w,!1)}return this.animationCallback=C.callback,this.board.addAnimation(this),this},update:function(){return v.Z.evaluate(this.visProp.trace)&&this.cloneToBackground(),this},updateRenderer:function(){return this},fullUpdate:function(f){return this.prepareUpdate().update().updateVisibility(f).updateRenderer()},setDisplayRendNode:function(f){var g,C,P,w,T;if(f===void 0&&(f=this.visPropCalc.visible),f===this.visPropOld.visible)return this;for(this.board.renderer.display(this,f),C=this.inherits.length,P=0;P<C;P++)if(T=this.inherits[P],v.Z.isArray(T))for(w=T.length,g=0;g<w;g++)v.Z.exists(T[g])&&v.Z.exists(T[g].rendNode)&&v.Z.evaluate(T[g].visProp.visible)==="inherit"&&T[g].setDisplayRendNode(f);else v.Z.exists(T)&&v.Z.exists(T.rendNode)&&v.Z.evaluate(T.visProp.visible)==="inherit"&&T.setDisplayRendNode(f);return this.hasLabel&&v.Z.exists(this.label)&&v.Z.exists(this.label.rendNode)&&v.Z.evaluate(this.label.visProp.visible)==="inherit"&&this.label.setDisplayRendNode(f),this},hide:function(){return this.setAttribute({visible:!1}),this},hideElement:function(){return this.hide(),this},show:function(){return this.setAttribute({visible:!0}),this},showElement:function(){return this.show(),this},updateVisibility:function(f){var g,C,P,w,T,L;if(this.needsUpdate){for(f!==void 0?this.visPropCalc.visible=f:(L=v.Z.evaluate(this.visProp.visible),v.Z.exists(this.hiddenByParent)&&this.hiddenByParent&&(L=!1),L!=="inherit"&&(this.visPropCalc.visible=L)),C=this.inherits.length,P=0;P<C;P++)if(T=this.inherits[P],v.Z.isArray(T))for(w=T.length,g=0;g<w;g++)v.Z.exists(T[g])&&v.Z.evaluate(T[g].visProp.visible)==="inherit"&&T[g].prepareUpdate().updateVisibility(this.visPropCalc.visible);else v.Z.exists(T)&&v.Z.evaluate(T.visProp.visible)==="inherit"&&T.prepareUpdate().updateVisibility(this.visPropCalc.visible);v.Z.exists(this.label)&&v.Z.exists(this.label.visProp)&&v.Z.evaluate(this.label.visProp.visible)&&this.label.prepareUpdate().updateVisibility(this.visPropCalc.visible)}return this},_set:function(f,g){var C;if(f=f.toLocaleLowerCase(),this.visProp.hasOwnProperty(f)&&f.indexOf("color")>=0&&v.Z.isString(g)&&g.length===9&&g.charAt(0)==="#")g=m.Z.rgba2rgbo(g),this.visProp[f]=g[0],this.visProp[f.replace("color","opacity")]=g[1];else if(g===null||!v.Z.isObject(g)||v.Z.exists(g.id)||v.Z.exists(g.name))this.visProp[f]=g;else for(C in this.visProp[f]={},g)g.hasOwnProperty(C)&&(this.visProp[f][C.toLocaleLowerCase()]=g[C])},resolveShortcuts:function(f){var g,C,P,w=["traceattributes","traceAttributes"];for(g in E.Z.shortcuts)if(E.Z.shortcuts.hasOwnProperty(g)){if(v.Z.exists(f[g]))for(C=0;C<E.Z.shortcuts[g].length;C++)v.Z.exists(f[E.Z.shortcuts[g][C]])||(f[E.Z.shortcuts[g][C]]=f[g]);for(P=0;P<w.length;P++)v.Z.isObject(f[w[P]])&&(f[w[P]]=this.resolveShortcuts(f[w[P]]))}return f},setLabel:function(f){this.hasLabel||this.setAttribute({withlabel:!0}),this.setLabelText(f)},setLabelText:function(f){return v.Z.exists(this.label)&&(f=f.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.label.setText(f)),this},setName:function(f){f=f.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.elType!=="slider"&&this.setLabelText(f),this.setAttribute({name:f})},setProperty:function(){a.Z.deprecated("setProperty()","setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(f){var g,C,P,w,T,L,Y,j,F,G={};for(g=0;g<arguments.length;g++)L=arguments[g],v.Z.isString(L)?(j=L.split(":"),G[v.Z.trim(j[0])]=v.Z.trim(j[1])):v.Z.isArray(L)?G[L[0]]=L[1]:a.Z.extend(G,L);for(g in G=this.resolveShortcuts(G))if(G.hasOwnProperty(g)){if(w=g.replace(/\s+/g,"").toLowerCase(),T=G[g],v.Z.isObject(T)&&v.Z.exists(this.visProp[w])){if(this.visProp[w]=v.Z.merge(this.visProp[w],T),this.type===X.Z.OBJECT_TYPE_TICKS&&v.Z.exists(this.labels))for(P=this.labels.length,C=0;C<P;C++)this.labels[C].setAttribute(T);else if(v.Z.exists(this[w]))if(v.Z.isArray(this[w]))for(C=0;C<this[w].length;C++)this[w][C].setAttribute(T);else this[w].setAttribute(T);continue}switch(F=this.visProp[w],w){case"name":F=this.name,delete this.board.elementsByName[this.name],this.name=T,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate=!(T==="false"||T===!1),this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":Y=(T=m.Z.rgba2rgbo(T))[1],T=T[0],Y===0&&v.Z.exists(this.label)&&this.hasLabel&&this.label.hideElement(),v.Z.exists(this.label)&&this.hasLabel&&(this.label.visProp.strokecolor=T,this.board.renderer.setObjectStrokeColor(this.label,T,Y)),this.elementClass===X.Z.OBJECT_CLASS_TEXT&&(this.visProp.strokecolor=T,this.visProp.strokeopacity=Y,this.board.renderer.setObjectStrokeColor(this,T,Y));break;case"infoboxtext":v.Z.isString(T)?this.infoboxText=T:this.infoboxText=!1;break;case"visible":this.visProp.visible=T!=="false"&&(T==="true"||T),this.setDisplayRendNode(v.Z.evaluate(this.visProp.visible)),v.Z.evaluate(this.visProp.visible)&&v.Z.exists(this.updateSize)&&this.updateSize();break;case"face":v.Z.isPoint(this)&&(this.visProp.face=T,this.board.renderer.changePointStyle(this));break;case"trace":T==="false"||T===!1?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=T!=="pause";break;case"gradient":this.visProp.gradient=T,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":T=m.Z.rgba2rgbo(T),this.visProp.gradientsecondcolor=T[0],this.visProp.gradientsecondopacity=T[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=T,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=T,v.Z.evaluate(T)?(this.label||this.createLabel(),this.label.setAttribute({visible:"inherit"})):this.label&&this.hasLabel&&this.label.setAttribute({visible:!1}),this.hasLabel=T;break;case"radius":this.type!==X.Z.OBJECT_TYPE_ANGLE&&this.type!==X.Z.OBJECT_TYPE_SECTOR||this.setRadius(T);break;case"rotate":(this.elementClass===X.Z.OBJECT_CLASS_TEXT&&v.Z.evaluate(this.visProp.display)==="internal"||this.type===X.Z.OBJECT_TYPE_IMAGE)&&this.addRotation(T);break;case"ticksdistance":this.type===X.Z.OBJECT_TYPE_TICKS&&v.Z.isNumber(T)&&(this.ticksFunction=this.makeTicksFunction(T));break;case"generatelabelvalue":this.type===X.Z.OBJECT_TYPE_TICKS&&v.Z.isFunction(T)&&(this.generateLabelValue=T);break;case"onpolygon":this.type===X.Z.OBJECT_TYPE_GLIDER&&(this.onPolygon=!!T);break;case"disabled":v.Z.exists(this.rendNodeTag)&&(this.rendNodeTag.disabled=!!T);break;case"checked":v.Z.exists(this.rendNodeTag)&&(this.rendNodeCheckbox.checked=!!T);break;case"maxlength":v.Z.exists(this.rendNodeTag)&&(this.rendNodeTag.maxlength=!!T);break;case"layer":this.board.renderer.setLayer(this,v.Z.evaluate(T)),this._set(w,T);break;case"tabindex":v.Z.exists(this.rendNode)&&(this.rendNode.setAttribute("tabindex",T),this._set(w,T));break;default:v.Z.exists(this.visProp[w])&&(!a.Z.Validator[w]||a.Z.Validator[w]&&a.Z.Validator[w](T)||a.Z.Validator[w]&&v.Z.isFunction(T)&&a.Z.Validator[w](T()))&&(T=(!T.toLowerCase||T.toLowerCase()!=="false")&&T,this._set(w,T))}this.triggerEventHandlers(["attribute:"+w],[F,T,this])}return this.triggerEventHandlers(["attribute"],[G,this]),v.Z.evaluate(this.visProp.needsregularupdate)?this.board.update(this):this.board.fullUpdate(),this},getProperty:function(){a.Z.deprecated("getProperty()","getAttribute()"),this.getProperty.apply(this,arguments)},getAttribute:function(f){var g;switch(f=f.toLowerCase()){case"needsregularupdate":g=this.needsRegularUpdate;break;case"labelcolor":g=this.label.visProp.strokecolor;break;case"infoboxtext":g=this.infoboxText;break;case"withlabel":g=this.hasLabel;break;default:g=this.visProp[f]}return g},setDash:function(f){return this.setAttribute({dash:f}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.id)),this},getTextAnchor:function(){return new B.Z(X.Z.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new B.Z(X.Z.COORDS_BY_USER,[0,0],this.board)},setArrow:function(f,g){return this.visProp.firstarrow=f,this.visProp.lastarrow=g,g&&(this.type=X.Z.OBJECT_TYPE_VECTOR,this.elType="arrow"),this.prepareUpdate().update().updateVisibility().updateRenderer(),this},createGradient:function(){var f=v.Z.evaluate(this.visProp.gradient);f!=="linear"&&f!=="radial"||this.board.renderer.setGradient(this)},createLabel:function(){var f,g=this;return a.Z.elements.text?((f=v.Z.deepCopy(this.visProp.label,null)).id=this.id+"Label",f.isLabel=!0,f.anchor=this,f.priv=this.visProp.priv,this.visProp.withlabel&&(this.label=a.Z.elements.text(this.board,[0,0,function(){return v.Z.isFunction(g.name)?g.name():g.name}],f),this.label.needsUpdate=!0,this.label.dump=!1,this.label.fullUpdate(),this.hasLabel=!0)):a.Z.debug("JSXGraph: Can't create label: text element is not available. Make sure you include base/text"),this},highlight:function(f){return f=v.Z.def(f,!1),!v.Z.evaluate(this.visProp.highlight)||this.highlighted&&!f||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,delete this.board.highlightedObjects[this.id],this.board.renderer.noHighlight(this)),this},clearTrace:function(){var f;for(f in this.traces)this.traces.hasOwnProperty(f)&&this.board.renderer.remove(this.traces[f]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){return[0,0,0,0]},normalize:function(){return this.stdform=R.Z.normalize(this.stdform),this},toJSON:function(){var f,g,C=['{"name":',this.name];for(g in C.push(', "id":'+this.id),f=[],this.visProp)this.visProp.hasOwnProperty(g)&&v.Z.exists(this.visProp[g])&&f.push('"'+g+'":'+this.visProp[g]);return C.push(', "visProp":{'+f.toString()+"}"),C.push("}"),C.join("")},addRotation:function(f){var g,C,P,w,T,L=this;return(this.elementClass===X.Z.OBJECT_CLASS_TEXT&&v.Z.evaluate(this.visProp.display)==="internal"||this.type===X.Z.OBJECT_TYPE_IMAGE)&&f!==0&&(g=this.board.create("transform",[function(){return-L.X()},function(){return-L.Y()}],{type:"translate"}),C=this.board.create("transform",[function(){return L.X()},function(){return L.Y()}],{type:"translate"}),P=this.board.create("transform",[function(){return L.board.unitX/L.board.unitY},function(){return 1}],{type:"scale"}),w=this.board.create("transform",[function(){return L.board.unitY/L.board.unitX},function(){return 1}],{type:"scale"}),T=this.board.create("transform",[function(){return v.Z.evaluate(f)*Math.PI/180}],{type:"rotate"}),g.bindTo(this),P.bindTo(this),T.bindTo(this),w.bindTo(this),C.bindTo(this)),this},highlightStrokeColor:function(f){return a.Z.deprecated("highlightStrokeColor()","setAttribute()"),this.setAttribute({highlightStrokeColor:f}),this},strokeColor:function(f){return a.Z.deprecated("strokeColor()","setAttribute()"),this.setAttribute({strokeColor:f}),this},strokeWidth:function(f){return a.Z.deprecated("strokeWidth()","setAttribute()"),this.setAttribute({strokeWidth:f}),this},fillColor:function(f){return a.Z.deprecated("fillColor()","setAttribute()"),this.setAttribute({fillColor:f}),this},highlightFillColor:function(f){return a.Z.deprecated("highlightFillColor()","setAttribute()"),this.setAttribute({highlightFillColor:f}),this},labelColor:function(f){return a.Z.deprecated("labelColor()","setAttribute()"),this.setAttribute({labelColor:f}),this},dash:function(f){return a.Z.deprecated("dash()","setAttribute()"),this.setAttribute({dash:f}),this},visible:function(f){return a.Z.deprecated("visible()","setAttribute()"),this.setAttribute({visible:f}),this},shadow:function(f){return a.Z.deprecated("shadow()","setAttribute()"),this.setAttribute({shadow:f}),this},getType:function(){return this.elType},getParents:function(){return v.Z.isArray(this.parents)?this.parents:[]},snapToGrid:function(){return this},snapToPoints:function(){return this},getAttributes:function(){var f,g=v.Z.deepCopy(this.visProp),C=[],P=C.length;for(g.id=this.id,g.name=this.name,f=0;f<P;f++)delete g[C[f]];return g},hasPoint:function(f,g){return!1},addTicks:function(f){return f.id!==""&&v.Z.exists(f.id)||(f.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(f),this.ticks.push(f),f.id},removeAllTicks:function(){var f;if(v.Z.exists(this.ticks)){for(f=this.ticks.length-1;f>=0;f--)this.removeTicks(this.ticks[f]);this.ticks=[],this.board.update()}},removeTicks:function(f){var g,C;if(v.Z.exists(this.defaultTicks)&&this.defaultTicks===f&&(this.defaultTicks=null),v.Z.exists(this.ticks)){for(g=this.ticks.length-1;g>=0;g--)if(this.ticks[g]===f){if(this.board.removeObject(this.ticks[g]),this.ticks[g].ticks)for(C=0;C<this.ticks[g].ticks.length;C++)v.Z.exists(this.ticks[g].labels[C])&&this.board.removeObject(this.ticks[g].labels[C]);delete this.ticks[g];break}}},getSnapSizes:function(){var f,g,C;return f=v.Z.evaluate(this.visProp.snapsizex),g=v.Z.evaluate(this.visProp.snapsizey),f<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(f=(C=this.board.defaultAxes.x.defaultTicks).ticksDelta*(v.Z.evaluate(C.visProp.minorticks)+1)),g<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(g=(C=this.board.defaultAxes.y.defaultTicks).ticksDelta*(v.Z.evaluate(C.visProp.minorticks)+1)),[f,g]},handleSnapToGrid:function(f,g){var C,P,w,T,L,Y,j,F,G,H,q,K=v.Z.evaluate(this.visProp.attracttogrid),at=v.Z.evaluate(this.visProp.attractorunit),tt=v.Z.evaluate(this.visProp.attractordistance);return!v.Z.exists(this.coords)||v.Z.evaluate(this.visProp.fixed)||(v.Z.evaluate(this.visProp.snaptogrid)||K||f===!0)&&(C=this.coords.usrCoords[1],P=this.coords.usrCoords[2],H=(G=this.getSnapSizes())[0],q=G[1],H>0&&q>0&&(F=this.board.getBoundingBox(),w=Math.round(C/H)*H,T=Math.round(P/q)*q,L=new a.Z.Coords(X.Z.COORDS_BY_USER,[w,T],this.board),(!K||L.distance(at==="screen"?X.Z.COORDS_BY_SCREEN:X.Z.COORDS_BY_USER,this.coords)<tt)&&(C=w,P=T,g||(Y=Math.min(F[0],F[2]),j=Math.max(F[0],F[2]),C<Y?C+=H:C>j&&(C-=H),Y=Math.min(F[1],F[3]),j=Math.max(F[1],F[3]),P<Y?P+=q:P>j&&(P-=q)),this.coords.setCoordinates(X.Z.COORDS_BY_USER,[C,P])))),this},getBoundingBox:function(){var f,g,C,P,w,T=[1/0,1/0,-1/0,-1/0];if(this.type===X.Z.OBJECT_TYPE_POLYGON){if((g=this.vertices.length-1)<=0)return T;for(f=0;f<g;f++)C=this.vertices[f].X(),T[0]=C<T[0]?C:T[0],T[2]=C>T[2]?C:T[2],C=this.vertices[f].Y(),T[1]=C<T[1]?C:T[1],T[3]=C>T[3]?C:T[3]}else if(this.elementClass===X.Z.OBJECT_CLASS_CIRCLE)P=this.center.X(),w=this.center.Y(),T=[P-this.radius,w+this.radius,P+this.radius,w-this.radius];else if(this.elementClass===X.Z.OBJECT_CLASS_CURVE){if((g=this.vertices.length)===0)return T;for(f=0;f<g;f++)C=this.points[f].coords.usrCoords[1],T[0]=C<T[0]?C:T[0],T[2]=C>T[2]?C:T[2],C=this.points[f].coords.usrCoords[1],T[1]=C<T[1]?C:T[1],T[3]=C>T[3]?C:T[3]}return T},addEvent:a.Z.shortcut(a.Z.GeometryElement.prototype,"on"),removeEvent:a.Z.shortcut(a.Z.GeometryElement.prototype,"off"),__evt__over:function(f){},__evt__mouseover:function(f){},__evt__out:function(f){},__evt__mouseout:function(f){},__evt__move:function(f){},__evt__mousemove:function(f){},__evt__drag:function(f){},__evt__mousedrag:function(f){},__evt__pendrag:function(f){},__evt__touchdrag:function(f){},__evt__keydrag:function(f){},__evt__down:function(f){},__evt__mousedown:function(f){},__evt__pendown:function(f){},__evt__touchdown:function(f){},__evt__up:function(f){},__evt__mouseup:function(f){},__evt__penup:function(f){},__evt__touchup:function(f){},__evt__attribute:function(f,g){},__evt__attribute_:function(f,g,C){},__evt:function(){}});const _=a.Z.GeometryElement},573:(u,N,S)=>{S.d(N,{Z:()=>_});var a=S(765),X=S(351),B=S(958),R=S(632),A=S(503),E=S(109),c=S(275),m=S(218),v=function(){this._val=parseFloat(this.rendNodeRange.value),this.rendNodeOut.value=this.rendNodeRange.value,this.board.update()};a.Z.Text=function(f,g,C,P){var w;this.constructor(f,C,X.Z.OBJECT_TYPE_TEXT,X.Z.OBJECT_CLASS_TEXT),this.element=this.board.select(C.anchor),this.coordsConstructor(g,E.Z.evaluate(this.visProp.islabel)),this.content="",this.plaintext="",this.plaintextOld=null,this.orgText="",this.needsSizeUpdate=!1,this.hiddenByParent=!1,this.size=[1,1],this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.board.finalizeAdding(this),w=this.visProp.visible,this.visProp.visible=!0,this.setText(P),this.visProp.visible=w,E.Z.isString(this.content)&&this.notifyParents(this.content),this.elType="text",this.methodMap=E.Z.deepCopy(this.methodMap,{setText:"setTextJessieCode",move:"setCoords"})},a.Z.Text.prototype=new B.Z,E.Z.copyPrototypeMethods(a.Z.Text,m.Z,"coordsConstructor"),a.Z.extend(a.Z.Text.prototype,{hasPoint:function(f,g){var C,P,w,T,L,Y,j,F;return E.Z.isObject(E.Z.evaluate(this.visProp.precision))?(j=this.board._inputDevice,F=E.Z.evaluate(this.visProp.precision[j])):F=this.board.options.precision.hasPoint,this.transformations.length>0&&(f=(C=c.Z.matVecMult(c.Z.inverse(this.board.renderer.joinTransforms(this,this.transformations)),[1,f,g]))[1],g=C[2]),P=(C=(L=this.getAnchorX())==="right"?this.coords.scrCoords[1]-this.size[0]:L==="middle"?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1])+this.size[0],w=(T=(Y=this.getAnchorY())==="top"?this.coords.scrCoords[2]+this.size[1]:Y==="middle"?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2])-this.size[1],E.Z.evaluate(this.visProp.dragarea)==="all"?f>=C-F&&f<P+F&&g>=w-F&&g<=T+F:g>=w-F&&g<=T+F&&(f>=C-F&&f<=C+2*F||f>=P-2*F&&f<=P+F)},_createFctUpdateText:function(f){var g,C,P,w=E.Z.evaluate(this.visProp.parse),T=E.Z.evaluate(this.visProp.usemathjax),L=E.Z.evaluate(this.visProp.usekatex),Y=!1;if(this.orgText=f,E.Z.isFunction(f))this.updateText=function(){P=f().toString(),this.plaintext=!w||T||L?P:this.replaceSub(this.replaceSup(this.convertGeonextAndSketchometry2CSS(P,!1)))};else if(E.Z.isNumber(f)?this.content=E.Z.toFixed(f,E.Z.evaluate(this.visProp.digits)):E.Z.isString(f)&&w&&(E.Z.evaluate(this.visProp.useasciimathml)?this.content="'`"+f+"`'":T||L?(this.content=this.valueTagToJessieCode(f),this.content=this.content.replace(/\\/g,"\\\\")):this.content=this.poorMansTeX(this.valueTagToJessieCode(f)),Y=!0),Y){for(C in(g=this.board.jc.snippet(this.content,!0,"",!1)).deps)this.addParents(g.deps[C]),g.deps[C].addChild(this);this.updateText=function(){this.plaintext=this.unescapeTicks(g())}}else this.updateText=function(){this.plaintext=f}},_setText:function(f){return this._createFctUpdateText(f),this.updateText(),this.fullUpdate(),this.board.infobox&&this.id===this.board.infobox.id||this.updateSize(),this},setTextJessieCode:function(f){var g;return this.visProp.castext=f,g=E.Z.isFunction(f)?function(){return E.Z.sanitizeHTML(f())}:E.Z.isNumber(f)?f:E.Z.sanitizeHTML(f),this._setText(g)},setText:function(f){return this._setText(f)},updateSize:function(){var f,g,C,P=E.Z.evaluate(this.visProp.display);return A.Z.isBrowser&&this.board.renderer.type!=="no"?(C=this.rendNode,P==="html"||this.board.renderer.type==="vml"?E.Z.exists(C.offsetWidth)?(g=this,window.setTimeout(function(){g.size=[C.offsetWidth,C.offsetHeight],g.needsUpdate=!0,g.updateRenderer()},0)):this.size=this.crudeSizeEstimate():P==="internal"&&(this.board.renderer.type==="svg"?(g=this,window.setTimeout(function(){try{f=C.getBBox(),g.size=[f.width,f.height],g.needsUpdate=!0,g.updateRenderer()}catch{}},0)):this.board.renderer.type==="canvas"&&(this.size=this.crudeSizeEstimate())),this):this},crudeSizeEstimate:function(){var f=parseFloat(E.Z.evaluate(this.visProp.fontsize));return[f*this.plaintext.length*.45,.9*f]},utf8_decode:function(f){return f.replace(/&#x(\w+);/g,function(g,C){return String.fromCharCode(parseInt(C,16))})},replaceSub:function(f){if(!f.indexOf)return f;for(var g,C=f.indexOf("_{");C>=0;)(g=(f=f.substr(0,C)+f.substr(C).replace(/_\{/,"<sub>")).substr(C).indexOf("}"))>=0&&(f=f.substr(0,g)+f.substr(g).replace(/\}/,"</sub>")),C=f.indexOf("_{");for(C=f.indexOf("_");C>=0;)C=(f=f.substr(0,C)+f.substr(C).replace(/_(.?)/,"<sub>$1</sub>")).indexOf("_");return f},replaceSup:function(f){if(!f.indexOf)return f;for(var g,C=f.indexOf("^{");C>=0;)(g=(f=f.substr(0,C)+f.substr(C).replace(/\^\{/,"<sup>")).substr(C).indexOf("}"))>=0&&(f=f.substr(0,g)+f.substr(g).replace(/\}/,"</sup>")),C=f.indexOf("^{");for(C=f.indexOf("^");C>=0;)C=(f=f.substr(0,C)+f.substr(C).replace(/\^(.?)/,"<sup>$1</sup>")).indexOf("^");return f},getSize:function(){return this.size},setCoords:function(f,g){var C,P,w;return E.Z.isArray(f)&&f.length>1&&(g=f[1],f=f[0]),E.Z.evaluate(this.visProp.islabel)&&E.Z.exists(this.element)?(P=(f-(C=this.element.getLabelAnchor()).usrCoords[1])*this.board.unitX,w=-(g-C.usrCoords[2])*this.board.unitY,this.relativeCoords.setCoordinates(X.Z.COORDS_BY_SCREEN,[P,w])):this.coords.setCoordinates(X.Z.COORDS_BY_USER,[f,g]),this.fullUpdate(),this},update:function(f){return this.needsUpdate?(this.updateCoords(f),this.updateText(),E.Z.evaluate(this.visProp.display)==="internal"&&E.Z.isString(this.plaintext)&&(this.plaintext=this.utf8_decode(this.plaintext)),this.checkForSizeUpdate(),this.needsSizeUpdate&&this.updateSize(),this):this},checkForSizeUpdate:function(){this.board.infobox&&this.id===this.board.infobox.id?this.needsSizeUpdate=!1:(this.needsSizeUpdate=this.plaintextOld!==this.plaintext,this.needsSizeUpdate&&(this.plaintextOld=this.plaintext))},updateRenderer:function(){return E.Z.evaluate(this.visProp.autoposition)&&this.setAutoPosition().updateConstraint(),this.updateRendererGeneric("updateText")},expandShortMath:function(f){return f.replace(/([)0-9.])\s*([(a-zA-Z_])/g,"$1*$2")},generateTerm:function(f,g,C){var P,w,T,L,Y='""';if(T=(f=(f=(f=(f=(f=(f=(f=(f=(f=(f=(f=f||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/"/g,"'")).replace(/'/g,"\\'")).replace(/&amp;arc;/g,"&ang;")).replace(/<arc\s*\/>/g,"&ang;")).replace(/&lt;arc\s*\/&gt;/g,"&ang;")).replace(/&lt;sqrt\s*\/&gt;/g,"&radic;")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),L=f.indexOf("</value>"),T>=0)for(;T>=0;)Y+=' + "'+this.replaceSub(this.replaceSup(f.slice(0,T)))+'"',w=(w=f.slice(T+7,L)).replace(/\s+/g,""),g===!0&&(w=this.expandShortMath(w)),(P=(P=(P=C?w:R.Z.geonext2JS(w,this.board)).replace(/\\"/g,"'")).replace(/\\'/g,"'")).indexOf("toFixed")<0&&E.Z.isNumber(E.Z.bind(this.board.jc.snippet(P,!0,"",!1),this)())?Y+="+("+P+").toFixed("+E.Z.evaluate(this.visProp.digits)+")":Y+="+("+P+")",T=(f=f.slice(L+8)).indexOf("<value>"),L=f.indexOf("</value>");return Y+=' + "'+this.replaceSub(this.replaceSup(f))+'"',Y=(Y=(Y=this.convertGeonextAndSketchometry2CSS(Y)).replace(/&amp;/g,"&")).replace(/"/g,"'")},valueTagToJessieCode:function(f){var g,C,P,w,T=[],L='"';if(P=(f=(f=(f=(f=(f=f||"").replace(/\r/g,"")).replace(/\n/g,"")).replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>")).indexOf("<value>"),w=f.indexOf("</value>"),P>=0)for(;P>=0;)T.push(L+this.escapeTicks(f.slice(0,P))+L),C=(C=f.slice(P+7,w)).replace(/\s+/g,""),(g=(g=C=this.expandShortMath(C)).replace(/\\"/g,"'").replace(/\\'/g,"'")).indexOf("toFixed")<0&&E.Z.isNumber(E.Z.bind(this.board.jc.snippet(g,!0,"",!1),this)())?T.push("("+g+").toFixed("+E.Z.evaluate(this.visProp.digits)+")"):T.push("("+g+")"),P=(f=f.slice(w+8)).indexOf("<value>"),w=f.indexOf("</value>");return T.push(L+this.escapeTicks(f)+L),T.join(" + ").replace(/&amp;/g,"&")},poorMansTeX:function(f){return f=f.replace(/<arc\s*\/*>/g,"&ang;").replace(/&lt;arc\s*\/*&gt;/g,"&ang;").replace(/<sqrt\s*\/*>/g,"&radic;").replace(/&lt;sqrt\s*\/*&gt;/g,"&radic;"),this.convertGeonextAndSketchometry2CSS(this.replaceSub(this.replaceSup(f)),!0)},escapeTicks:function(f){return f.replace(/"/g,"%22").replace(/'/g,"%27")},unescapeTicks:function(f){return f.replace(/%22/g,'"').replace(/%27/g,"'")},convertGeonext2CSS:function(f){return E.Z.isString(f)&&(f=(f=(f=(f=f.replace(/(<|&lt;)overline(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/overline(>|&gt;)/g,"</span>")).replace(/(<|&lt;)arrow(>|&gt;)/g,"<span style=text-decoration:overline;>")).replace(/(<|&lt;)\/arrow(>|&gt;)/g,"</span>")),f},convertSketchometry2CSS:function(f,g){var C='<span class="sketcho sketcho-inherit sketcho-',P='"></span>';return E.Z.isString(f)&&(g&&(C=this.escapeTicks(C),P=this.escapeTicks(P)),f=(f=f.replace(/(<|&lt;)sketchofont(>|&gt;)/g,C)).replace(/(<|&lt;)\/sketchofont(>|&gt;)/g,P)),f},convertGeonextAndSketchometry2CSS:function(f,g){return f=this.convertGeonext2CSS(f),f=this.convertSketchometry2CSS(f,g)},notifyParents:function(f){var g,C=null;f=(f=f.replace(/&lt;value&gt;/g,"<value>")).replace(/&lt;\/value&gt;/g,"</value>");do(C=(g=/<value>([\w\s*/^\-+()[\],<>=!]+)<\/value>/).exec(f))!==null&&(R.Z.findDependencies(this,C[1],this.board),f=(f=f.substr(C.index)).replace(g,""));while(C!==null);return this},getParents:function(){var f;return f=this.relativeCoords!==void 0?[this.relativeCoords.usrCoords[1],this.relativeCoords.usrCoords[2],this.orgText]:[this.Z(),this.X(),this.Y(),this.orgText],this.parents.length!==0&&(f=this.parents),f},bounds:function(){var f=this.coords.usrCoords;return E.Z.evaluate(this.visProp.islabel)||this.board.unitY===0||this.board.unitX===0?[0,0,0,0]:[f[1],f[2]+this.size[1]/this.board.unitY,f[1]+this.size[0]/this.board.unitX,f[2]]},getAnchorX:function(){var f=E.Z.evaluate(this.visProp.anchorx);if(f==="auto")switch(this.visProp.position){case"top":case"bot":return"middle";case"rt":case"lrt":case"urt":return"left";default:return"right"}return f},getAnchorY:function(){var f=E.Z.evaluate(this.visProp.anchory);if(f==="auto")switch(this.visProp.position){case"top":case"ulft":case"urt":return"bottom";case"bot":case"lrt":case"llft":return"top";default:return"middle"}return f},getNumberofConflicts:function(f,g,C,P){var w,T,L,Y,j=0;for(Y=this.board.options.precision.hasPoint,this.board.options.precision.hasPoint=.25*(C+P),w=0,L=this.board.objectsList.length;w<L;w++)(T=this.board.objectsList[w]).visPropCalc.visible&&T.elType!=="axis"&&T.elType!=="ticks"&&T!==this.board.infobox&&T!==this&&T.hasPoint(f,g)&&j++;return this.board.options.precision.hasPoint=Y,j},setAutoPosition:function(){var f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q=this.size[0],it=this.size[1],rt={conflicts:1/0,angle:0,r:0},dt=2*Math.PI/12;if(this===this.board.infobox||!this.visPropCalc.visible||!E.Z.evaluate(this.visProp.islabel)||!this.element)return this;if(F=E.Z.evaluate(this.visProp.offset),C=(w=this.element.getLabelAnchor()).scrCoords[1],P=w.scrCoords[2],q=F[0],K=F[1],(j=this.getNumberofConflicts(C+q,P-K,Q,it))===0)return this;for(Y=.2*(G=12),T=Math.atan2(K,q),rt.conflicts=j,rt.angle=T,rt.r=G;rt.conflicts>0&&G<28;){for(H=1,L=T+dt;H<12&&rt.conflicts>0&&(f=C+G*(at=Math.cos(L)),g=P-G*(tt=Math.sin(L)),(j=this.getNumberofConflicts(f,g,Q,it))<rt.conflicts&&(rt.conflicts=j,rt.angle=L,rt.r=G),rt.conflicts!==0);H++)L+=dt;G+=Y}return G=rt.r,at=Math.cos(rt.angle),tt=Math.sin(rt.angle),this.visProp.offset=[G*at,G*tt],this.visProp.anchorx=at<-.2?"right":at>.2?"left":"middle",this}}),a.Z.createText=function(f,g,C){var P,w=E.Z.copyAttributes(C,f.options,"text"),T=g.slice(0,-1),L=g[g.length-1];if(w.anchor=w.parent||w.anchor,!(P=m.Z.create(a.Z.Text,f,T,w,L)))throw new Error("JSXGraph: Can't create text with parent types '"+typeof g[0]+"' and '"+typeof g[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return w.rotate!==0&&w.display==="internal"&&P.addRotation(w.rotate),P},a.Z.registerElement("text",a.Z.createText),a.Z.createHTMLSlider=function(f,g,C){var P,w,T=E.Z.copyAttributes(C,f.options,"htmlslider");if(g.length!==2||g[0].length!==2||g[1].length!==3)throw new Error("JSXGraph: Can't create htmlslider with parent types '"+typeof g[0]+"' and '"+typeof g[1]+`'.
Possible parents are: [[x,y], [min, start, max]]`);T.anchor=T.parent||T.anchor,T.fixed=T.fixed||!0,w=[g[0][0],g[0][1],'<form style="display:inline"><input type="range" /><span></span><input type="text" /></form>'],(P=a.Z.createText(f,w,T)).type=E.Z.OBJECT_TYPE_HTMLSLIDER,P.rendNodeForm=P.rendNode.childNodes[0],P.rendNodeRange=P.rendNodeForm.childNodes[0],P.rendNodeRange.min=g[1][0],P.rendNodeRange.max=g[1][2],P.rendNodeRange.step=T.step,P.rendNodeRange.value=g[1][1],P.rendNodeLabel=P.rendNodeForm.childNodes[1],P.rendNodeLabel.id=P.rendNode.id+"_label",T.withlabel&&(P.rendNodeLabel.innerHTML=P.name+"="),P.rendNodeOut=P.rendNodeForm.childNodes[2],P.rendNodeOut.value=g[1][1];try{P.rendNodeForm.id=P.rendNode.id+"_form",P.rendNodeRange.id=P.rendNode.id+"_range",P.rendNodeOut.id=P.rendNode.id+"_out"}catch(L){a.Z.debug(L)}return P.rendNodeRange.style.width=T.widthrange+"px",P.rendNodeRange.style.verticalAlign="middle",P.rendNodeOut.style.width=T.widthout+"px",P._val=g[1][1],a.Z.supportsVML()?A.Z.addEvent(P.rendNodeForm,"change",v,P):A.Z.addEvent(P.rendNodeForm,"input",v,P),P.Value=function(){return this._val},P},a.Z.registerElement("htmlslider",a.Z.createHTMLSlider);const _=a.Z.Text},765:(u,N,S)=>{S.d(N,{Z:()=>X});var a={};typeof JXG!="object"||JXG.extend||(a=JXG),a.extend=function(B,R,A,E){var c;for(c in A=A||!1,E=E||!1,R)(!A||A&&R.hasOwnProperty(c))&&(B[E?c.toLowerCase():c]=R[c])},a.defineConstant=function(B,R,A,E){(E=E||!1)&&a.exists(B[R])||Object.defineProperty(B,R,{value:A,writable:!1,enumerable:!0,configurable:!1})},a.extendConstants=function(B,R,A,E){var c,m;for(c in A=A||!1,E=E||!1,R)(!A||A&&R.hasOwnProperty(c))&&(m=E?c.toUpperCase():c,this.defineConstant(B,m,R[c]))},a.extend(a,{boards:{},readers:{},elements:{},registerElement:function(B,R){B=B.toLowerCase(),this.elements[B]=R},registerReader:function(B,R){var A,E;for(A=0;A<R.length;A++)E=R[A].toLowerCase(),typeof this.readers[E]!="function"&&(this.readers[E]=B)},shortcut:function(B,R){return function(){return B[R].apply(this,arguments)}},getRef:function(B,R){return a.deprecated("JXG.getRef()","Board.select()"),B.select(R)},getReference:function(B,R){return a.deprecated("JXG.getReference()","Board.select()"),B.select(R)},getBoardByContainerId:function(B){var R;for(R in JXG.boards)if(JXG.boards.hasOwnProperty(R)&&JXG.boards[R].container===B)return JXG.boards[R];return null},deprecated:function(B,R){var A=B+" is deprecated.";R&&(A+=" Please use "+R+" instead."),a.warn(A)},warn:function(B){typeof window=="object"&&window.console&&console.warn?console.warn("WARNING:",B):typeof document=="object"&&document.getElementById("warning")&&(document.getElementById("debug").innerHTML+="WARNING: "+B+"<br />")},debugInt:function(B){var R,A;for(R=0;R<arguments.length;R++)A=arguments[R],typeof window=="object"&&window.console&&console.log?console.log(A):typeof document=="object"&&document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=A+"<br/>")},debugWST:function(B){var R=new Error;a.debugInt.apply(this,arguments),R&&R.stack&&(a.debugInt("stacktrace"),a.debugInt(R.stack.split(`
`).slice(1).join(`
`)))},debugLine:function(B){var R=new Error;a.debugInt.apply(this,arguments),R&&R.stack&&a.debugInt("Called from",R.stack.split(`
`).slice(2,3).join(`
`))},debug:function(B){a.debugInt.apply(this,arguments)}});const X=a},922:(u,N,S)=>{S.d(N,{Z:()=>m});var a=S(765),X=S(351),B=S(705),R=S(275),A=S(336),E=S(109),c=S(421);R.Z.Geometry={},a.Z.extend(R.Z.Geometry,{angle:function(v,_,f){var g,C,P,w,T=[],L=[],Y=[];return a.Z.deprecated("Geometry.angle()","Geometry.rad()"),v.coords?(T[0]=v.coords.usrCoords[1],T[1]=v.coords.usrCoords[2]):(T[0]=v[0],T[1]=v[1]),_.coords?(L[0]=_.coords.usrCoords[1],L[1]=_.coords.usrCoords[2]):(L[0]=_[0],L[1]=_[1]),f.coords?(Y[0]=f.coords.usrCoords[1],Y[1]=f.coords.usrCoords[2]):(Y[0]=f[0],Y[1]=f[1]),g=T[0]-L[0],C=T[1]-L[1],P=Y[0]-L[0],w=Y[1]-L[1],Math.atan2(g*w-C*P,g*P+C*w)},trueAngle:function(v,_,f){return 57.29577951308232*this.rad(v,_,f)},rad:function(v,_,f){var g,C,P,w,T,L,Y;return v.coords?(g=v.coords.usrCoords[1],C=v.coords.usrCoords[2]):(g=v[0],C=v[1]),_.coords?(P=_.coords.usrCoords[1],w=_.coords.usrCoords[2]):(P=_[0],w=_[1]),f.coords?(T=f.coords.usrCoords[1],L=f.coords.usrCoords[2]):(T=f[0],L=f[1]),(Y=Math.atan2(L-w,T-P)-Math.atan2(C-w,g-P))<0&&(Y+=6.283185307179586),Y},angleBisector:function(v,_,f,g){var C,P,w,T,L,Y=v.coords.usrCoords,j=_.coords.usrCoords,F=f.coords.usrCoords;return E.Z.exists(g)||(g=v.board),j[0]===0?new B.Z(X.Z.COORDS_BY_USER,[1,.5*(Y[1]+F[1]),.5*(Y[2]+F[2])],g):(T=Y[1]-j[1],L=Y[2]-j[2],C=Math.atan2(L,T),T=F[1]-j[1],L=F[2]-j[2],w=.5*(C+(P=Math.atan2(L,T))),C>P&&(w+=Math.PI),T=Math.cos(w)+j[1],L=Math.sin(w)+j[2],new B.Z(X.Z.COORDS_BY_USER,[1,T,L],g))},reflection:function(v,_,f){var g,C,P,w,T,L,Y=_.coords.usrCoords,j=v.point1.coords.usrCoords,F=v.point2.coords.usrCoords;return E.Z.exists(f)||(f=_.board),w=F[1]-j[1],T=F[2]-j[2],g=Y[1]-j[1],L=(w*(Y[2]-j[2])-T*g)/(w*w+T*T),C=Y[1]+2*L*T,P=Y[2]-2*L*w,new B.Z(X.Z.COORDS_BY_USER,[C,P],f)},rotation:function(v,_,f,g){var C,P,w,T,L,Y,j=_.coords.usrCoords,F=v.coords.usrCoords;return E.Z.exists(g)||(g=_.board),C=j[1]-F[1],P=j[2]-F[2],L=C*(w=Math.cos(f))-P*(T=Math.sin(f))+F[1],Y=C*T+P*w+F[2],new B.Z(X.Z.COORDS_BY_USER,[L,Y],g)},perpendicular:function(v,_,f){var g,C,P,w,T,L=v.point1.coords.usrCoords,Y=v.point2.coords.usrCoords,j=_.coords.usrCoords;return E.Z.exists(f)||(f=_.board),_===v.point1?(g=L[1]+Y[2]-L[2],C=L[2]-Y[1]+L[1],T=L[0]*Y[0],Math.abs(T)<R.Z.eps&&(g=Y[2],C=-Y[1]),w=[T,g,C],P=!0):_===v.point2?(g=Y[1]+L[2]-Y[2],C=Y[2]-L[1]+Y[1],T=L[0]*Y[0],Math.abs(T)<R.Z.eps&&(g=L[2],C=-L[1]),w=[T,g,C],P=!1):Math.abs(R.Z.innerProduct(j,v.stdform,3))<R.Z.eps?(g=j[1]+Y[2]-j[2],C=j[2]-Y[1]+j[1],T=Y[0],Math.abs(T)<R.Z.eps&&(g=Y[2],C=-Y[1]),P=!0,Math.abs(T)>R.Z.eps&&Math.abs(g-j[1])<R.Z.eps&&Math.abs(C-j[2])<R.Z.eps&&(g=j[1]+L[2]-j[2],C=j[2]-L[1]+j[1],P=!1),w=[T,g,C]):(w=[0,v.stdform[1],v.stdform[2]],w=R.Z.crossProduct(w,j),w=R.Z.crossProduct(w,v.stdform),P=!0),[new B.Z(X.Z.COORDS_BY_USER,w,f),P]},circumcenterMidpoint:function(){a.Z.deprecated("Geometry.circumcenterMidpoint()","Geometry.circumcenter()"),this.circumcenter.apply(this,arguments)},circumcenter:function(v,_,f,g){var C,P,w,T,L=v.coords.usrCoords,Y=_.coords.usrCoords,j=f.coords.usrCoords;return E.Z.exists(g)||(g=v.board),C=[Y[0]-L[0],-Y[2]+L[2],Y[1]-L[1]],P=[.5*(L[0]+Y[0]),.5*(L[1]+Y[1]),.5*(L[2]+Y[2])],w=R.Z.crossProduct(C,P),C=[j[0]-Y[0],-j[2]+Y[2],j[1]-Y[1]],P=[.5*(Y[0]+j[0]),.5*(Y[1]+j[1]),.5*(Y[2]+j[2])],T=R.Z.crossProduct(C,P),new B.Z(X.Z.COORDS_BY_USER,R.Z.crossProduct(w,T),g)},distance:function(v,_,f){var g,C=0;for(f||(f=Math.min(v.length,_.length)),g=0;g<f;g++)C+=(v[g]-_[g])*(v[g]-_[g]);return Math.sqrt(C)},affineDistance:function(v,_,f){var g;return(g=this.distance(v,_,f))>R.Z.eps&&(Math.abs(v[0])<R.Z.eps||Math.abs(_[0])<R.Z.eps)?1/0:g},affineRatio:function(v,_,f){var g;return E.Z.exists(v.usrCoords)&&(v=v.usrCoords),E.Z.exists(_.usrCoords)&&(_=_.usrCoords),E.Z.exists(f.usrCoords)&&(f=f.usrCoords),g=_[1]-v[1],Math.abs(g)>R.Z.eps?(f[1]-v[1])/g:(f[2]-v[2])/(_[2]-v[2])},sortVertices:function(v){for(var _,f=c.Z.each(v,c.Z.coordsArray),g=f.length,C=null;f[0][0]===f[g-1][0]&&f[0][1]===f[g-1][1]&&f[0][2]===f[g-1][2];)C=f.pop(),g--;return _=f[0],f.sort(function(P,w){return(P[2]===_[2]&&P[1]===_[1]?-1/0:Math.atan2(P[2]-_[2],P[1]-_[1]))-(w[2]===_[2]&&w[1]===_[1]?-1/0:Math.atan2(w[2]-_[2],w[1]-_[1]))}),C!==null&&f.push(C),f},signedTriangle:function(v,_,f){var g=c.Z.coordsArray(v),C=c.Z.coordsArray(_),P=c.Z.coordsArray(f);return .5*((C[1]-g[1])*(P[2]-g[2])-(C[2]-g[2])*(P[1]-g[1]))},signedPolygon:function(v,_){var f,g,C=0,P=c.Z.each(v,c.Z.coordsArray);for(_===void 0&&(_=!0),_?P.unshift(P[P.length-1]):P=this.sortVertices(P),g=P.length,f=1;f<g;f++)C+=P[f-1][1]*P[f][2]-P[f][1]*P[f-1][2];return .5*C},GrahamScan:function(v){var _,f=1,g=c.Z.each(v,c.Z.coordsArray),C=g.length;for(C=(g=this.sortVertices(g)).length,_=2;_<C;_++){for(;this.signedTriangle(g[f-1],g[f],g[_])<=0;){if(f>1)f-=1;else if(_===C-1)break;_+=1}f+=1,g=E.Z.swap(g,f,_)}return g.slice(0,f)},calcStraight:function(v,_,f,g){var C,P,w,T,L,Y,j,F,G,H;if(E.Z.exists(g)||(g=10),Y=E.Z.evaluate(v.visProp.straightfirst),j=E.Z.evaluate(v.visProp.straightlast),Math.abs(_.scrCoords[0])<R.Z.eps&&(Y=!0),Math.abs(f.scrCoords[0])<R.Z.eps&&(j=!0),(Y||j)&&((F=[])[0]=v.stdform[0]-v.stdform[1]*v.board.origin.scrCoords[1]/v.board.unitX+v.stdform[2]*v.board.origin.scrCoords[2]/v.board.unitY,F[1]=v.stdform[1]/v.board.unitX,F[2]=-v.stdform[2]/v.board.unitY,!isNaN(F[0]+F[1]+F[2]))){if(C=!Y&&Math.abs(_.usrCoords[0])>=R.Z.eps&&_.scrCoords[1]>=0&&_.scrCoords[1]<=v.board.canvasWidth&&_.scrCoords[2]>=0&&_.scrCoords[2]<=v.board.canvasHeight,P=!j&&Math.abs(f.usrCoords[0])>=R.Z.eps&&f.scrCoords[1]>=0&&f.scrCoords[1]<=v.board.canvasWidth&&f.scrCoords[2]>=0&&f.scrCoords[2]<=v.board.canvasHeight,T=(w=this.meetLineBoard(F,v.board,g))[0],L=w[1],!C&&!P&&(!Y&&j&&!this.isSameDirection(_,f,T)&&!this.isSameDirection(_,f,L)||Y&&!j&&!this.isSameDirection(f,_,T)&&!this.isSameDirection(f,_,L)))return;C?P||(H=this.isSameDir(_,f,T,L)?L:T):P?G=this.isSameDir(_,f,T,L)?T:L:this.isSameDir(_,f,T,L)?(G=T,H=L):(H=T,G=L),G&&_.setCoordinates(X.Z.COORDS_BY_USER,G.usrCoords),H&&f.setCoordinates(X.Z.COORDS_BY_USER,H.usrCoords)}},calcLineDelimitingPoints:function(v,_,f){var g,C,P,w,T,L,Y,j,F,G,H;if(T=E.Z.evaluate(v.visProp.straightfirst),L=E.Z.evaluate(v.visProp.straightlast),Math.abs(_.scrCoords[0])<R.Z.eps&&(T=!0),Math.abs(f.scrCoords[0])<R.Z.eps&&(L=!0),(Y=[])[0]=v.stdform[0]-v.stdform[1]*v.board.origin.scrCoords[1]/v.board.unitX+v.stdform[2]*v.board.origin.scrCoords[2]/v.board.unitY,Y[1]=v.stdform[1]/v.board.unitX,Y[2]=-v.stdform[2]/v.board.unitY,!isNaN(Y[0]+Y[1]+Y[2])){if(G=!T,H=!L,C=v.board.getBoundingBox(),v.getSlope()>=0?(P=this.projectPointToLine({coords:{usrCoords:[1,C[2],C[1]]}},v,v.board),w=this.projectPointToLine({coords:{usrCoords:[1,C[0],C[3]]}},v,v.board)):(P=this.projectPointToLine({coords:{usrCoords:[1,C[0],C[1]]}},v,v.board),w=this.projectPointToLine({coords:{usrCoords:[1,C[2],C[3]]}},v,v.board)),!G&&!H&&(!T&&!L&&(g=_.distance(X.Z.COORDS_BY_USER,f),Math.abs(_.distance(X.Z.COORDS_BY_USER,P)+P.distance(X.Z.COORDS_BY_USER,f)-g)>R.Z.eps||Math.abs(_.distance(X.Z.COORDS_BY_USER,w)+w.distance(X.Z.COORDS_BY_USER,f)-g)>R.Z.eps)||!T&&L&&!this.isSameDirection(_,f,P)&&!this.isSameDirection(_,f,w)||T&&!L&&!this.isSameDirection(f,_,P)&&!this.isSameDirection(f,_,w)))return;G?H||(F=this.isSameDir(_,f,P,w)?w:P):H?j=this.isSameDir(_,f,P,w)?P:w:this.isSameDir(_,f,P,w)?(j=P,F=w):(F=P,j=w),j&&_.setCoordinates(X.Z.COORDS_BY_USER,j.usrCoords),F&&f.setCoordinates(X.Z.COORDS_BY_USER,F.usrCoords)}},calcLabelQuadrant:function(v){return v<0&&(v+=2*Math.PI),["rt","urt","top","ulft","lft","llft","lrt"][Math.floor((v+Math.PI/8)/(Math.PI/4))%8]},isSameDir:function(v,_,f,g){var C=_.usrCoords[1]-v.usrCoords[1],P=_.usrCoords[2]-v.usrCoords[2],w=g.usrCoords[1]-f.usrCoords[1],T=g.usrCoords[2]-f.usrCoords[2];return Math.abs(_.usrCoords[0])<R.Z.eps&&(C=_.usrCoords[1],P=_.usrCoords[2]),Math.abs(v.usrCoords[0])<R.Z.eps&&(C=-v.usrCoords[1],P=-v.usrCoords[2]),C*w+P*T>=0},isSameDirection:function(v,_,f){var g,C,P,w,T=!1;return g=_.usrCoords[1]-v.usrCoords[1],C=_.usrCoords[2]-v.usrCoords[2],P=f.usrCoords[1]-v.usrCoords[1],w=f.usrCoords[2]-v.usrCoords[2],Math.abs(g)<R.Z.eps&&(g=0),Math.abs(C)<R.Z.eps&&(C=0),Math.abs(P)<R.Z.eps&&(P=0),Math.abs(w)<R.Z.eps&&(w=0),(g>=0&&P>=0||g<=0&&P<=0)&&(T=C>=0&&w>=0||C<=0&&w<=0),T},det3p:function(v,_,f){return(v[1]-f[1])*(_[2]-f[2])-(_[1]-f[1])*(v[2]-f[2])},windingNumber:function(v,_,f){var g,C,P,w,T,L,Y=0,j=_.length,F=v[1],G=v[2],H=0;if(j===0)return 0;if((f=f||!1)&&(H=1),isNaN(F)||isNaN(G)||(E.Z.exists(_[0].coords)?(g=_[0].coords,C=_[j-1].coords):(g=_[0],C=_[j-1]),g.usrCoords[1]===F&&g.usrCoords[2]===G))return 1;for(L=0;L<j-H;L++)if(E.Z.exists(_[L].coords)?(C=_[L].coords.usrCoords,P=_[(L+1)%j].coords.usrCoords):(C=_[L].usrCoords,P=_[(L+1)%j].usrCoords),!(C[0]===0||P[0]===0||isNaN(C[1])||isNaN(P[1])||isNaN(C[2])||isNaN(P[2]))){if(P[2]===G){if(P[1]===F)return 1;if(C[2]===G&&P[1]>F==C[1]<F)return 0}if(C[2]<G!=P[2]<G)if(T=2*(P[2]>C[2]?1:0)-1,C[1]>=F)if(P[1]>F)Y+=T;else{if((w=this.det3p(C,P,v))===0)return 0;w>0+R.Z.eps==P[2]>C[2]&&(Y+=T)}else P[1]>F&&(w=this.det3p(C,P,v))>0+R.Z.eps==P[2]>C[2]&&(Y+=T)}return Y},pnpoly:function(v,_,f,g){var C,P,w,T,L,Y,j,F,G=f,H=!1;for(g===X.Z.COORDS_BY_USER?(T=(Y=new B.Z(X.Z.COORDS_BY_USER,[v,_],this.board)).scrCoords[1],L=Y.scrCoords[2]):(T=v,L=_),C=0,P=(w=f.length)-2;C<w-1;P=C++)j=E.Z.exists(G[C].coords)?G[C].coords:G[C],F=E.Z.exists(G[P].coords)?G[P].coords:G[P],j.scrCoords[2]>L!=F.scrCoords[2]>L&&T<(F.scrCoords[1]-j.scrCoords[1])*(L-j.scrCoords[2])/(F.scrCoords[2]-j.scrCoords[2])+j.scrCoords[1]&&(H=!H);return H},intersectionFunction:function(v,_,f,g,C,P){var w,T,L=this;return w=_.elementClass===X.Z.OBJECT_CLASS_CURVE&&(_.type===X.Z.OBJECT_TYPE_ARC||_.type===X.Z.OBJECT_TYPE_SECTOR),T=f.elementClass===X.Z.OBJECT_CLASS_CURVE&&(f.type===X.Z.OBJECT_TYPE_ARC||f.type===X.Z.OBJECT_TYPE_SECTOR),_.elementClass!==X.Z.OBJECT_CLASS_CURVE&&f.elementClass!==X.Z.OBJECT_CLASS_CURVE||_.elementClass!==X.Z.OBJECT_CLASS_CURVE&&_.elementClass!==X.Z.OBJECT_CLASS_CIRCLE||f.elementClass!==X.Z.OBJECT_CLASS_CURVE&&f.elementClass!==X.Z.OBJECT_CLASS_CIRCLE?_.elementClass===X.Z.OBJECT_CLASS_CURVE&&!w&&f.elementClass===X.Z.OBJECT_CLASS_LINE||f.elementClass===X.Z.OBJECT_CLASS_CURVE&&!T&&_.elementClass===X.Z.OBJECT_CLASS_LINE?function(){return L.meetCurveLine(_,f,g,_.board,E.Z.evaluate(P))}:_.type===X.Z.OBJECT_TYPE_POLYGON||f.type===X.Z.OBJECT_TYPE_POLYGON?_.elementClass===X.Z.OBJECT_CLASS_LINE?function(){var Y,j=E.Z.evaluate(_.visProp.straightfirst),F=E.Z.evaluate(_.visProp.straightlast),G=E.Z.evaluate(f.visProp.straightfirst),H=E.Z.evaluate(f.visProp.straightlast);return Y=!(E.Z.evaluate(P)||j&&F&&G&&H),L.meetPolygonLine(f,_,g,_.board,Y)}:f.elementClass===X.Z.OBJECT_CLASS_LINE?function(){var Y,j=E.Z.evaluate(_.visProp.straightfirst),F=E.Z.evaluate(_.visProp.straightlast),G=E.Z.evaluate(f.visProp.straightfirst),H=E.Z.evaluate(f.visProp.straightlast);return Y=!(E.Z.evaluate(P)||j&&F&&G&&H),L.meetPolygonLine(_,f,g,_.board,Y)}:function(){return L.meetPathPath(_,f,g,_.board)}:_.elementClass===X.Z.OBJECT_CLASS_LINE&&f.elementClass===X.Z.OBJECT_CLASS_LINE?function(){var Y,j,F=E.Z.evaluate(_.visProp.straightfirst),G=E.Z.evaluate(_.visProp.straightlast),H=E.Z.evaluate(f.visProp.straightfirst),q=E.Z.evaluate(f.visProp.straightlast);return E.Z.evaluate(P)||F&&G&&H&&q?L.meet(_.stdform,f.stdform,g,_.board):(Y=L.meetSegmentSegment(_.point1.coords.usrCoords,_.point2.coords.usrCoords,f.point1.coords.usrCoords,f.point2.coords.usrCoords),j=!F&&Y[1]<0||!G&&Y[1]>1||!H&&Y[2]<0||!q&&Y[2]>1?[0,NaN,NaN]:Y[0],new B.Z(X.Z.COORDS_BY_USER,j,_.board))}:function(){var Y,j,F,G=L.meet(_.stdform,f.stdform,g,_.board),H=!0;return E.Z.evaluate(P)?G:(_.elementClass!==X.Z.OBJECT_CLASS_LINE||(Y=E.Z.evaluate(_.visProp.straightfirst),j=E.Z.evaluate(_.visProp.straightlast),Y&&j||(F=L.affineRatio(_.point1.coords,_.point2.coords,G),!(!j&&F>1+R.Z.eps||!Y&&F<0-R.Z.eps))))&&(f.elementClass!==X.Z.OBJECT_CLASS_LINE||(Y=E.Z.evaluate(f.visProp.straightfirst),j=E.Z.evaluate(f.visProp.straightlast),Y&&j||(F=L.affineRatio(f.point1.coords,f.point2.coords,G),!(!j&&F>1+R.Z.eps||!Y&&F<0-R.Z.eps))))?w&&((H=L.coordsOnArc(_,G))&&T&&(H=L.coordsOnArc(f,G)),!H)?new B.Z(a.Z.COORDS_BY_USER,[0,NaN,NaN],_.board):G:new B.Z(a.Z.COORDS_BY_USER,[0,NaN,NaN],_.board)}:function(){return L.meetCurveCurve(_,f,g,C,_.board)}},coordsOnArc:function(v,_){var f=this.rad(v.radiuspoint,v.center,_.usrCoords.slice(1)),g=0,C=this.rad(v.radiuspoint,v.center,v.anglepoint),P=E.Z.evaluate(v.visProp.selection);return(P==="minor"&&C>Math.PI||P==="major"&&C<Math.PI)&&(g=C,C=2*Math.PI),!(f<g||f>C)},meet:function(v,_,f,g){var C=R.Z.eps;return Math.abs(v[3])<C&&Math.abs(_[3])<C?this.meetLineLine(v,_,f,g):Math.abs(v[3])>=C&&Math.abs(_[3])<C?this.meetLineCircle(_,v,f,g):Math.abs(v[3])<C&&Math.abs(_[3])>=C?this.meetLineCircle(v,_,f,g):this.meetCircleCircle(v,_,f,g)},meetLineBoard:function(v,_,f){var g,C,P,w,T=[];for(E.Z.exists(f)||(f=0),T[0]=R.Z.crossProduct(v,[f,0,1]),T[1]=R.Z.crossProduct(v,[f,1,0]),T[2]=R.Z.crossProduct(v,[-f-_.canvasHeight,0,1]),T[3]=R.Z.crossProduct(v,[-f-_.canvasWidth,1,0]),P=0;P<4;P++)if(Math.abs(T[P][0])>R.Z.eps){for(w=2;w>0;w--)T[P][w]/=T[P][0];T[P][0]=1}return Math.abs(T[1][0])<R.Z.eps?(g=T[0],C=T[2]):Math.abs(T[0][0])<R.Z.eps?(g=T[1],C=T[3]):T[1][2]<0?(g=T[0],C=T[3][2]>_.canvasHeight?T[2]:T[3]):T[1][2]>_.canvasHeight?(g=T[2],C=T[3][2]<0?T[0]:T[3]):(g=T[1],C=T[3][2]<0?T[0]:T[3][2]>_.canvasHeight?T[2]:T[3]),[g=new B.Z(X.Z.COORDS_BY_SCREEN,g.slice(1),_),C=new B.Z(X.Z.COORDS_BY_SCREEN,C.slice(1),_)]},meetLineLine:function(v,_,f,g){var C=isNaN(v[5]+_[5])?[0,0,0]:R.Z.crossProduct(v,_);return new B.Z(X.Z.COORDS_BY_USER,C,g)},meetLineCircle:function(v,_,f,g){var C,P,w,T,L,Y,j,F,G;return _[4]<R.Z.eps?Math.abs(R.Z.innerProduct([1,_[6],_[7]],v,3))<R.Z.eps?new B.Z(X.Z.COORDS_BY_USER,_.slice(6,8),g):new B.Z(X.Z.COORDS_BY_USER,[NaN,NaN],g):(w=_[0],P=_.slice(1,3),C=_[3],T=v[0],L=v.slice(1,3),Y=C,(F=(j=P[0]*L[1]-P[1]*L[0])*j-4*Y*(C*T*T-(P[0]*L[0]+P[1]*L[1])*T+w))>-R.Z.eps*R.Z.eps?(G=[(-j+(F=Math.sqrt(Math.abs(F))))/(2*Y),(-j-F)/(2*Y)],E.Z.evaluate(f)===0?new B.Z(X.Z.COORDS_BY_USER,[-G[0]*-L[1]-T*L[0],-G[0]*L[0]-T*L[1]],g):new B.Z(X.Z.COORDS_BY_USER,[-G[1]*-L[1]-T*L[0],-G[1]*L[0]-T*L[1]],g)):new B.Z(X.Z.COORDS_BY_USER,[0,0,0],g))},meetCircleCircle:function(v,_,f,g){var C;return v[4]<R.Z.eps?Math.abs(this.distance(v.slice(6,2),_.slice(6,8))-_[4])<R.Z.eps?new B.Z(X.Z.COORDS_BY_USER,v.slice(6,8),g):new B.Z(X.Z.COORDS_BY_USER,[0,0,0],g):_[4]<R.Z.eps?Math.abs(this.distance(_.slice(6,2),v.slice(6,8))-v[4])<R.Z.eps?new B.Z(X.Z.COORDS_BY_USER,_.slice(6,8),g):new B.Z(X.Z.COORDS_BY_USER,[0,0,0],g):(C=[_[3]*v[0]-v[3]*_[0],_[3]*v[1]-v[3]*_[1],_[3]*v[2]-v[3]*_[2],0,1,1/0,1/0,1/0],C=R.Z.normalize(C),this.meetLineCircle(C,v,f,g))},meetCurveCurve:function(v,_,f,g,C,P){var w;return w=E.Z.exists(P)&&P==="newton"?A.Z.generalizedNewton(v,_,E.Z.evaluate(f),g):v.bezierDegree===3||_.bezierDegree===3?this.meetBezierCurveRedBlueSegments(v,_,f):this.meetCurveRedBlueSegments(v,_,f),new B.Z(X.Z.COORDS_BY_USER,w,C)},meetCurveLine:function(v,_,f,g,C){var P,w;return E.Z.exists(g)||(g=v.board),v.elementClass===X.Z.OBJECT_CLASS_CURVE?(P=v,w=_):(P=_,w=v),this.meetCurveLineDiscrete(P,w,f,g,!C)},meetCurveLineContinuous:function(v,_,f,g,C){var P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q=R.Z.eps,it=R.Z.eps;for(L=this.meetCurveLineDiscrete(v,_,f,g,C),Y=L.usrCoords[1],j=L.usrCoords[2],w=function(rt){var dt,ht;return rt>v.maxX()||rt<v.minX()?1/0:(dt=Y-v.X(rt))*dt+(ht=j-v.Y(rt))*ht},T=function(rt){var dt=_.stdform[0]+_.stdform[1]*v.X(rt)+_.stdform[2]*v.Y(rt);return dt*dt},G=(v.maxX()-v.minX())/50,H=v.minX(),at=1e-4,K=NaN,q=0;q<50&&(P=A.Z.root(w,[Math.max(H,v.minX()),Math.min(H+G,v.maxX())]),!((tt=Math.abs(w(P)))<=at&&(K=P,(at=tt)<Q)));q++)H+=G;return P=K,tt=T(P=A.Z.root(T,[Math.max(P-G,v.minX()),Math.min(P+G,v.maxX())])),F=isNaN(tt)||Math.abs(tt)>it?0:1,new B.Z(X.Z.COORDS_BY_USER,[F,v.X(P),v.Y(P)],g)},meetCurveLineDiscrete:function(v,_,f,g,C){var P,w,T,L,Y,j,F,G=E.Z.evaluate(f),H=_.point1.coords.usrCoords,q=_.point2.coords.usrCoords,K=0,at=v.numberPoints,tt=E.Z.evaluate(_.visProp.straightfirst),Q=E.Z.evaluate(_.visProp.straightlast);for(j=new B.Z(X.Z.COORDS_BY_USER,[0,NaN,NaN],g),H[0]===0?H=[1,q[1]+_.stdform[2],q[2]-_.stdform[1]]:q[0]===0&&(q=[1,H[1]+_.stdform[2],H[2]-_.stdform[1]]),L=v.points[0].usrCoords,P=1;P<at;P+=v.bezierDegree)if(T=L.slice(0),L=v.points[P].usrCoords,this.distance(T,L)>R.Z.eps){for(F=v.bezierDegree===3?this.meetBeziersegmentBeziersegment([v.points[P-1].usrCoords.slice(1),v.points[P].usrCoords.slice(1),v.points[P+1].usrCoords.slice(1),v.points[P+2].usrCoords.slice(1)],[H.slice(1),q.slice(1)],C):[this.meetSegmentSegment(T,L,H,q)],w=0;w<F.length;w++)if(0<=(Y=F[w])[1]&&Y[1]<=1){if(K===G)return C&&(!tt&&Y[2]<0||!Q&&Y[2]>1)?j:j=new B.Z(X.Z.COORDS_BY_USER,Y[0],g);K+=1}}return j},meetCurveRedBlueSegments:function(v,_,f){var g,C,P,w,T,L,Y,j,F,G=E.Z.evaluate(f),H=0,q=_.numberPoints,K=v.numberPoints;if(q<=1||K<=1)return[0,NaN,NaN];for(g=1;g<K;g++)for(P=v.points[g-1].usrCoords,w=v.points[g].usrCoords,j=Math.min(P[1],w[1]),F=Math.max(P[1],w[1]),L=_.points[0].usrCoords,C=1;C<q;C++)if(T=L,L=_.points[C].usrCoords,Math.min(T[1],L[1])<F&&Math.max(T[1],L[1])>j&&(Y=this.meetSegmentSegment(P,w,T,L))[1]>=0&&Y[2]>=0&&(Y[1]<1&&Y[2]<1||g===K-1&&Y[1]===1||C===q-1&&Y[2]===1)){if(H===G)return Y[0];H++}return[0,NaN,NaN]},meetSegmentSegment:function(v,_,f,g){var C,P,w,T=R.Z.crossProduct(v,_),L=R.Z.crossProduct(f,g),Y=R.Z.crossProduct(T,L);return Math.abs(Y[0])<R.Z.eps?[Y,1/0,1/0]:(Y[1]/=Y[0],Y[2]/=Y[0],Y[0]/=Y[0],w=v[P=Math.abs(_[1]-_[0]*v[1])<R.Z.eps?2:1]/v[0],C=(Y[P]-w)/(_[0]!==0?_[P]/_[0]-w:_[P]),w=f[P=Math.abs(g[1]-g[0]*f[1])<R.Z.eps?2:1]/f[0],[Y,C,(Y[P]-w)/(g[0]!==0?g[P]/g[0]-w:g[P])])},meetPathPath:function(v,_,f,g){var C,P,w,T,L=E.Z.evaluate(f);return(w=(C=a.Z.Math.Clip._getPath(v,g)).length)>0&&this.distance(C[0].coords.usrCoords,C[w-1].coords.usrCoords,3)<R.Z.eps&&C.pop(),(w=(P=a.Z.Math.Clip._getPath(_,g)).length)>0&&this.distance(P[0].coords.usrCoords,P[w-1].coords.usrCoords,3)<R.Z.eps*R.Z.eps&&P.pop(),f<0||a.Z.Math.Clip.isEmptyCase(C,P,"intersection")?new B.Z(X.Z.COORDS_BY_USER,[0,0,0],g):(a.Z.Math.Clip.makeDoublyLinkedList(C),a.Z.Math.Clip.makeDoublyLinkedList(P),L<(T=a.Z.Math.Clip.findIntersections(C,P,g)[0]).length?T[L].coords:new B.Z(X.Z.COORDS_BY_USER,[0,0,0],g))},meetPolygonLine:function(v,_,f,g,C){var P,w,T,L=E.Z.evaluate(f),Y=[0,0,0],j=v.borders.length,F=[];for(P=0;P<j;P++)T=v.borders[P],w=this.meetSegmentSegment(T.point1.coords.usrCoords,T.point2.coords.usrCoords,_.point1.coords.usrCoords,_.point2.coords.usrCoords),(!C||w[2]>=0&&w[2]<1)&&w[1]>=0&&w[1]<1&&F.push(w[0]);return L>=0&&L<F.length&&(Y=F[L]),new B.Z(X.Z.COORDS_BY_USER,Y,g)},_bezierSplit:function(v){var _,f,g,C,P,w;return _=[.5*(v[0][0]+v[1][0]),.5*(v[0][1]+v[1][1])],f=[.5*(v[1][0]+v[2][0]),.5*(v[1][1]+v[2][1])],g=[.5*(v[2][0]+v[3][0]),.5*(v[2][1]+v[3][1])],w=[.5*((C=[.5*(_[0]+f[0]),.5*(_[1]+f[1])])[0]+(P=[.5*(f[0]+g[0]),.5*(f[1]+g[1])])[0]),.5*(C[1]+P[1])],[[v[0],_,C,w],[w,P,g,v[3]]]},_bezierBbox:function(v){var _=[];return v.length===4?(_[0]=Math.min(v[0][0],v[1][0],v[2][0],v[3][0]),_[1]=Math.max(v[0][1],v[1][1],v[2][1],v[3][1]),_[2]=Math.max(v[0][0],v[1][0],v[2][0],v[3][0]),_[3]=Math.min(v[0][1],v[1][1],v[2][1],v[3][1])):(_[0]=Math.min(v[0][0],v[1][0]),_[1]=Math.max(v[0][1],v[1][1]),_[2]=Math.max(v[0][0],v[1][0]),_[3]=Math.min(v[0][1],v[1][1])),_},_bezierOverlap:function(v,_){return v[2]>=_[0]&&v[0]<=_[2]&&v[1]>=_[3]&&v[3]<=_[1]},_bezierListConcat:function(v,_,f,g){var C,P=E.Z.exists(g),w=0,T=_.length,L=v.length;for(L>0&&T>0&&(v[L-1][1]===1&&_[0][1]===0||P&&v[L-1][2]===1&&_[0][2]===0)&&(w=1),C=w;C<T;C++)P&&(_[C][2]*=.5,_[C][2]+=g),_[C][1]*=.5,_[C][1]+=f,v.push(_[C])},_bezierMeetSubdivision:function(v,_,f){var g,C,P,w,T,L,Y,j,F,G,H,q,K=[];return C=this._bezierBbox(_),g=this._bezierBbox(v),this._bezierOverlap(C,g)?f<5?(L=(P=this._bezierSplit(v))[0],Y=P[1],w=(P=this._bezierSplit(_))[0],T=P[1],this._bezierListConcat(K,this._bezierMeetSubdivision(L,w,f+1),0,0),this._bezierListConcat(K,this._bezierMeetSubdivision(L,T,f+1),0,.5),this._bezierListConcat(K,this._bezierMeetSubdivision(Y,w,f+1),.5,0),this._bezierListConcat(K,this._bezierMeetSubdivision(Y,T,f+1),.5,.5),K):(H=[1].concat(v[0]),q=[1].concat(v[3]),F=[1].concat(_[0]),G=[1].concat(_[3]),(j=this.meetSegmentSegment(H,q,F,G))[1]>=0&&j[2]>=0&&j[1]<=1&&j[2]<=1?[j]:[]):[]},_bezierLineMeetSubdivision:function(v,_,f,g){var C,P,w,T,L,Y,j,F,G,H,q=[];return C=this._bezierBbox(_),P=this._bezierBbox(v),g&&!this._bezierOverlap(P,C)?[]:f<5?(T=(w=this._bezierSplit(v))[0],L=w[1],this._bezierListConcat(q,this._bezierLineMeetSubdivision(T,_,f+1),0),this._bezierListConcat(q,this._bezierLineMeetSubdivision(L,_,f+1),.5),q):(G=[1].concat(v[0]),H=[1].concat(v[3]),j=[1].concat(_[0]),F=[1].concat(_[1]),(Y=this.meetSegmentSegment(G,H,j,F))[1]>=0&&Y[1]<=1&&(!g||Y[2]>=0&&Y[2]<=1)?[Y]:[])},meetBeziersegmentBeziersegment:function(v,_,f){var g,C,P;for((g=v.length===4&&_.length===4?this._bezierMeetSubdivision(v,_,0):this._bezierLineMeetSubdivision(v,_,0,f)).sort(function(w,T){return 1e7*(w[1]-T[1])+(w[2]-T[2])}),C=[],P=0;P<g.length;P++)P!==0&&g[P][1]===g[P-1][1]&&g[P][2]===g[P-1][2]||C.push(g[P]);return C},meetBezierCurveRedBlueSegments:function(v,_,f){var g,C,P,w,T,L,Y,j,F,G,H=E.Z.evaluate(f),q=0,K=0,at=_.numberPoints,tt=v.numberPoints,Q=[];if(at<_.bezierDegree+1||tt<v.bezierDegree+1)return[0,NaN,NaN];for(at-=_.bezierDegree,tt-=v.bezierDegree,v.type===X.Z.OBJECT_TYPE_SECTOR&&(q=3,tt-=3),_.type===X.Z.OBJECT_TYPE_SECTOR&&(K=3,at-=3),C=q;C<tt;C+=v.bezierDegree)for(L=[(g=v.points)[C].usrCoords.slice(1),g[C+1].usrCoords.slice(1)],v.bezierDegree===3&&(L[2]=g[C+2].usrCoords.slice(1),L[3]=g[C+3].usrCoords.slice(1)),j=this._bezierBbox(L),P=K;P<at;P+=_.bezierDegree)if(Y=[(g=_.points)[P].usrCoords.slice(1),g[P+1].usrCoords.slice(1)],_.bezierDegree===3&&(Y[2]=g[P+2].usrCoords.slice(1),Y[3]=g[P+3].usrCoords.slice(1)),F=this._bezierBbox(Y),this._bezierOverlap(j,F)){if((G=this.meetBeziersegmentBeziersegment(L,Y)).length===0)continue;for(w=0;w<G.length;w++)(T=G[w])[1]<-R.Z.eps||T[1]>1+R.Z.eps||T[2]<-R.Z.eps||T[2]>1+R.Z.eps||Q.push(T);if(Q.length>H)return Q[H][0]}return Q.length>H?Q[H][0]:[0,NaN,NaN]},bezierSegmentEval:function(v,_){var f,g,C,P=1-v;return g=0,C=0,g+=(f=P*P*P)*_[0][0],C+=f*_[0][1],g+=(f=3*v*P*P)*_[1][0],C+=f*_[1][1],g+=(f=3*v*v*P)*_[2][0],C+=f*_[2][1],[1,g+=(f=v*v*v)*_[3][0],C+=f*_[3][1]]},bezierArc:function(v,_,f,g,C){var P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q,it,rt,dt,ht=.5*Math.PI,ut=_[1],_t=_[2],Dt=_[0],Bt=[],Xt=[];for(Y=this.distance(_,v),ut/=Dt,_t/=Dt,j=this.rad(v.slice(1),_.slice(1),f.slice(1)),C===-1&&(j=2*Math.PI-j),(P=v)[1]/=P[0],P[2]/=P[0],P[0]/=P[0],L=P.slice(0),g?(Bt=[ut,ut+.333*(P[1]-ut),ut+.666*(P[1]-ut),P[1]],Xt=[_t,_t+.333*(P[2]-_t),_t+.666*(P[2]-_t),P[2]]):(Bt=[P[1]],Xt=[P[2]]);j>R.Z.eps;)j>ht?(F=ht,j-=ht):(F=j,j=0),dt=[[1,0,0],[ut*(1-(G=Math.cos(C*F)))+_t*(H=Math.sin(C*F)),G,-H],[_t*(1-G)-ut*H,H,G]],L=[(it=R.Z.matVecMult(dt,P))[0]/it[0],it[1]/it[0],it[2]/it[0]],q=P[1]-ut,K=P[2]-_t,at=L[1]-ut,tt=L[2]-_t,rt=Math.sqrt((q+at)*(q+at)+(K+tt)*(K+tt)),Q=Math.abs(tt-K)>R.Z.eps?(q+at)*(Y/rt-.5)/(tt-K)*8/3:(K+tt)*(Y/rt-.5)/(q-at)*8/3,w=[1,P[1]-Q*K,P[2]+Q*q],T=[1,L[1]+Q*tt,L[2]-Q*at],Bt=Bt.concat([w[1],T[1],L[1]]),Xt=Xt.concat([w[2],T[2],L[2]]),P=L.slice(0);return g&&(Bt=Bt.concat([L[1]+.333*(ut-L[1]),L[1]+.666*(ut-L[1]),ut]),Xt=Xt.concat([L[2]+.333*(_t-L[2]),L[2]+.666*(_t-L[2]),_t])),[Bt,Xt]},projectPointToCircle:function(v,_,f){var g,C,P,w,T,L=_.center.coords.usrCoords;return E.Z.exists(f)||(f=v.board),E.Z.isPoint(v)?(g=v.coords.distance(X.Z.COORDS_BY_USER,_.center.coords),C=v.coords.usrCoords):(g=v.distance(X.Z.COORDS_BY_USER,_.center.coords),C=v.usrCoords),Math.abs(g)<R.Z.eps&&(g=R.Z.eps),T=_.Radius()/g,P=L[1]+T*(C[1]-L[1]),w=L[2]+T*(C[2]-L[2]),new B.Z(X.Z.COORDS_BY_USER,[P,w],f)},projectPointToLine:function(v,_,f){var g,C=[0,_.stdform[1],_.stdform[2]];return E.Z.exists(f)||(f=E.Z.exists(v.coords)?v.board:_.board),g=E.Z.exists(v.coords)?v.coords.usrCoords:v.usrCoords,C=R.Z.crossProduct(C,g),new B.Z(X.Z.COORDS_BY_USER,R.Z.crossProduct(C,_.stdform),f)},projectCoordsToSegment:function(v,_,f){var g,C=[f[1]-_[1],f[2]-_[2]],P=[v[1]-_[1],v[2]-_[2]];return Math.abs(C[0])<R.Z.eps&&Math.abs(C[1])<R.Z.eps?[_,0]:(g=R.Z.innerProduct(P,C),[[1,(g/=R.Z.innerProduct(C,C))*C[0]+_[1],g*C[1]+_[2]],g])},projectCoordsToBeziersegment:function(v,_,f){var g;return g=a.Z.Math.Numerics.fminbr(function(C){var P=[1,_.X(f+C),_.Y(f+C)];return P[1]-=v[1],P[2]-=v[2],P[1]*P[1]+P[2]*P[2]},[0,1]),[[1,_.X(g+f),_.Y(g+f)],g]},projectPointToCurve:function(v,_,f){E.Z.exists(f)||(f=v.board);var g=v.X(),C=v.Y(),P=v.position||0;return this.projectCoordsToCurve(g,C,P,_,f)},projectCoordsToCurve:function(v,_,f,g,C){var P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q,it,rt,dt,ht,ut,_t,Dt=Number.POSITIVE_INFINITY;if(E.Z.exists(C)||(C=g.board),E.Z.evaluate(g.visProp.curvetype)==="plot"){if(f=0,Y=Dt,P=g.numberPoints===0?[0,1,1]:[g.Z(0),g.X(0),g.Y(0)],g.numberPoints>1)for(G=[1,v,_],g.bezierDegree===3?L=0:K=[g.Z(0),g.X(0),g.Y(0)],T=0;T<g.numberPoints-1;T++)g.bezierDegree===3?tt=this.projectCoordsToBeziersegment(G,g,L):(at=[g.Z(T+1),g.X(T+1),g.Y(T+1)],tt=this.projectCoordsToSegment(G,K,at)),F=tt[1],H=tt[0],0<=F&&F<=1?(j=this.distance(H,G),q=T+F):F<0?(H=K,j=this.distance(K,G),q=T):F>1&&T===g.numberPoints-2&&(H=at,j=this.distance(H,G),q=g.numberPoints-1),j<Y&&(Y=j,f=q,P=H),g.bezierDegree===3?(L++,T+=2):K=at;w=new B.Z(X.Z.COORDS_BY_USER,P,C)}else{for(Q=function(Bt){var Xt,$t;return Bt<g.minX()||Bt>g.maxX()?1/0:(Xt=v-g.X(Bt))*Xt+($t=_-g.Y(Bt))*$t},dt=Q(f),ut=g.minX(),ht=((_t=g.maxX())-ut)/50,it=ut,T=0;T<50;T++)((rt=Q(it))<dt||dt===1/0||isNaN(dt))&&(f=it,dt=rt),it+=ht;f=(f=(f=A.Z.fminbr(Q,[Math.max(f-ht,ut),Math.min(f+ht,_t)]))<ut?ut:f)>_t?_t:f,w=new B.Z(X.Z.COORDS_BY_USER,[g.X(f),g.Y(f)],C)}return[g.updateTransform(w),f]},projectCoordsToPolygon:function(v,_){var f,g,C,P,w,T=_.vertices.length,L=1/0;for(f=0;f<T-1;f++)0<=(C=a.Z.Math.Geometry.projectCoordsToSegment(v,_.vertices[f].coords.usrCoords,_.vertices[f+1].coords.usrCoords))[1]&&C[1]<=1?(g=a.Z.Math.Geometry.distance(C[0],v,3),P=C[0]):C[1]<0?(g=a.Z.Math.Geometry.distance(_.vertices[f].coords.usrCoords,v,3),P=_.vertices[f].coords.usrCoords):(g=a.Z.Math.Geometry.distance(_.vertices[f+1].coords.usrCoords,v,3),P=_.vertices[f+1].coords.usrCoords),g<L&&(w=P.slice(0),L=g);return w},projectPointToTurtle:function(v,_,f){var g,C,P,w,T,L,Y,j,F,G,H=0,q=0,K=Number.POSITIVE_INFINITY,at=_.objects.length;for(E.Z.exists(f)||(f=v.board),T=0;T<at;T++)(Y=_.objects[T]).elementClass===X.Z.OBJECT_CLASS_CURVE&&(g=(F=this.projectPointToCurve(v,Y))[0],G=F[1],(L=this.distance(g.usrCoords,v.coords.usrCoords))<K&&(P=g.usrCoords[1],w=g.usrCoords[2],C=G,K=L,j=Y,q=H),H+=Y.numberPoints);return g=new B.Z(X.Z.COORDS_BY_USER,[P,w],f),[j.updateTransform(g),C+q]},projectPointToPoint:function(v,_){return _.coords},projectPointToBoard:function(v,_){var f,g,C,P=_||v.board,w=[[1,1,0,0,3,0,1],[-1,2,1,0,1,2,1],[-1,1,2,2,1,2,3],[1,2,3,0,3,2,3]],T=v.coords||v,L=P.getBoundingBox();for(f=0;f<4;f++)(C=w[f])[0]*T.usrCoords[C[1]]<C[0]*L[C[2]]&&((g=R.Z.crossProduct([1,L[C[3]],L[C[4]]],[1,L[C[5]],L[C[6]]]))[3]=0,g=R.Z.normalize(g),T=this.projectPointToLine({coords:T},{stdform:g},P));return T},distPointLine:function(v,_){var f,g=_[1],C=_[2],P=_[0];return Math.abs(g)+Math.abs(C)<R.Z.eps?Number.POSITIVE_INFINITY:(f=g*v[1]+C*v[2]+P,g*=g,C*=C,Math.abs(f)/Math.sqrt(g+C))},reuleauxPolygon:function(v,_){var f,g=2*Math.PI,C=g/_,P=(_-1)/2,w=0,T=function(L,Y){return function(j,F){var G=(j%g+g)%g,H=Math.floor(G/C)%_;return F||(w=v[0].Dist(v[P]),f=R.Z.Geometry.rad([v[0].X()+1,v[0].Y()],v[0],v[P%_])),isNaN(H)?H:(G=.5*G+H*C*.5+f,v[H][L]()+w*Math[Y](G))}};return[T("X","cos"),T("Y","sin"),0,g]},meet3Planes:function(v,_,f,g,C,P){var w,T,L,Y,j,F=[0,0,0];for(w=R.Z.crossProduct(C,v),T=R.Z.crossProduct(v,f),L=R.Z.crossProduct(f,C),Y=R.Z.innerProduct(v,L,3),j=0;j<3;j++)F[j]=(_*L[j]+g*w[j]+P*T[j])/Y;return F},meetPlanePlane:function(v,_,f,g){var C,P,w,T=[0,0,0],L=[0,0,0];for(C=0;C<3;C++)T[C]=E.Z.evaluate(v[C]),L[C]=E.Z.evaluate(_[C]);for(P=R.Z.crossProduct(T,L),C=0;C<3;C++)T[C]=E.Z.evaluate(f[C]),L[C]=E.Z.evaluate(g[C]);return w=R.Z.crossProduct(T,L),R.Z.crossProduct(P,w)},project3DTo3DPlane:function(v,_,f){var g,C;return f=f||[0,0,0],g=R.Z.norm(_),C=(R.Z.innerProduct(v,_,3)-R.Z.innerProduct(f,_,3))/g,R.Z.axpy(-C,_,v)},getPlaneBounds:function(v,_,f,g,C){var P,w,T,L,Y;return v[2]+_[0]!==0?(T=[[v[0],_[0]],[v[1],_[1]]],L=[g-f[0],g-f[1]],P=(Y=A.Z.Gauss(T,L))[0],w=Y[1],L=[C-f[0],C-f[1]],[P,(Y=A.Z.Gauss(T,L))[0],w,Y[1]]):null}});const m=R.Z.Geometry},785:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(275),B=S(109);a.Z.Math.DoubleBits=function(){var c,m,v,_,f,g,C,P,w=new Float64Array(1),T=new Uint32Array(w.buffer);Float64Array!==void 0&&(w[0]=1,T[1]===1072693248?(c=function(L){return w[0]=L,[T[0],T[1]]},m=function(L,Y){return T[0]=L,T[1]=Y,w[0]},v=function(L){return w[0]=L,T[0]},_=function(L){return w[0]=L,T[1]},this.doubleBits=c,this.pack=m,this.lo=v,this.hi=_):T[0]===1072693248&&(f=function(L){return w[0]=L,[T[1],T[0]]},g=function(L,Y){return T[1]=L,T[0]=Y,w[0]},C=function(L){return w[0]=L,T[1]},P=function(L){return w[0]=L,T[0]},this.doubleBits=f,this.pack=g,this.lo=C,this.hi=P))},a.Z.extend(a.Z.Math.DoubleBits.prototype,{sign:function(c){return this.hi(c)>>>31},exponent:function(c){return(this.hi(c)<<1>>>21)-1023},fraction:function(c){var m=this.lo(c),v=this.hi(c),_=1048575&v;return 2146435072&v&&(_+=1<<20),[m,_]},denormalized:function(c){return!(2146435072&this.hi(c))}});var R=new a.Z.Math.DoubleBits,A=function(c,m){if(c!==void 0&&m!==void 0){if(X.Z.IntervalArithmetic.isInterval(c)){if(!X.Z.IntervalArithmetic.isSingleton(c))throw new TypeError("JXG.Math.IntervalArithmetic: interval `lo` must be a singleton");this.lo=c.lo}else this.lo=c;if(X.Z.IntervalArithmetic.isInterval(m)){if(!X.Z.IntervalArithmetic.isSingleton(m))throw new TypeError("JXG.Math.IntervalArithmetic: interval `hi` must be a singleton");this.hi=m.hi}else this.hi=m}else{if(c!==void 0)return Array.isArray(c)?new A(c[0],c[1]):new A(c,c);this.lo=this.hi=0}};a.Z.extend(A.prototype,{print:function(){console.log("[",this.lo,this.hi,"]")},set:function(c,m){return this.lo=c,this.hi=m,this},bounded:function(c,m){return this.set(X.Z.IntervalArithmetic.prev(c),X.Z.IntervalArithmetic.next(m))},boundedSingleton:function(c){return this.bounded(c,c)},assign:function(c,m){if(typeof c!="number"||typeof m!="number")throw new TypeError("JXG.Math.Interval#assign: arguments must be numbers");return isNaN(c)||isNaN(m)||c>m?this.setEmpty():this.set(c,m)},setEmpty:function(){return this.set(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},setWhole:function(){return this.set(Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY)},open:function(c,m){return this.assign(X.Z.IntervalArithmetic.next(c),X.Z.IntervalArithmetic.prev(m))},halfOpenLeft:function(c,m){return this.assign(X.Z.IntervalArithmetic.next(c),m)},halfOpenRight:function(c,m){return this.assign(c,X.Z.IntervalArithmetic.prev(m))},toArray:function(){return[this.lo,this.hi]},clone:function(){return new A().set(this.lo,this.hi)}}),a.Z.Math.IntervalArithmetic={Interval:function(c,m){return new A(c,m)},isInterval:function(c){return c!==null&&typeof c=="object"&&typeof c.lo=="number"&&typeof c.hi=="number"},isSingleton:function(c){return c.lo===c.hi},add:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),new A(this.addLo(c.lo,m.lo),this.addHi(c.hi,m.hi))},sub:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),new A(this.subLo(c.lo,m.hi),this.subHi(c.hi,m.lo))},mul:function(c,m){var v,_,f,g,C;return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),this.isEmpty(c)||this.isEmpty(m)?this.EMPTY.clone():(v=c.lo,_=c.hi,f=m.lo,g=m.hi,C=new A,v<0?_>0?f<0?g>0?(C.lo=Math.min(this.mulLo(v,g),this.mulLo(_,f)),C.hi=Math.max(this.mulHi(v,f),this.mulHi(_,g))):(C.lo=this.mulLo(_,f),C.hi=this.mulHi(v,f)):g>0?(C.lo=this.mulLo(v,g),C.hi=this.mulHi(_,g)):(C.lo=0,C.hi=0):f<0?g>0?(C.lo=this.mulLo(v,g),C.hi=this.mulHi(v,f)):(C.lo=this.mulLo(_,g),C.hi=this.mulHi(v,f)):g>0?(C.lo=this.mulLo(v,g),C.hi=this.mulHi(_,f)):(C.lo=0,C.hi=0):_>0?f<0?g>0?(C.lo=this.mulLo(_,f),C.hi=this.mulHi(_,g)):(C.lo=this.mulLo(_,f),C.hi=this.mulHi(v,g)):g>0?(C.lo=this.mulLo(v,f),C.hi=this.mulHi(_,g)):(C.lo=0,C.hi=0):(C.lo=0,C.hi=0),C)},div:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),this.isEmpty(c)||this.isEmpty(m)?this.EMPTY.clone():this.zeroIn(m)?m.lo!==0?m.hi!==0?this.divZero(c):this.divNegative(c,m.lo):m.hi!==0?this.divPositive(c,m.hi):this.EMPTY.clone():this.divNonZero(c,m)},positive:function(c){return new A(c.lo,c.hi)},negative:function(c){return B.Z.isNumber(c)?new A(-c):new A(-c.hi,-c.lo)},isEmpty:function(c){return c.lo>c.hi},isWhole:function(c){return c.lo===-1/0&&c.hi===1/0},zeroIn:function(c){return this.hasValue(c,0)},hasValue:function(c,m){return!this.isEmpty(c)&&c.lo<=m&&m<=c.hi},hasInterval:function(c,m){return!!this.isEmpty(c)||!this.isEmpty(m)&&m.lo<=c.lo&&c.hi<=m.hi},intervalsOverlap:function(c,m){return!this.isEmpty(c)&&!this.isEmpty(m)&&(c.lo<=m.lo&&m.lo<=c.hi||m.lo<=c.lo&&c.lo<=m.hi)},divNonZero:function(c,m){var v=c.lo,_=c.hi,f=m.lo,g=m.hi,C=new A;return _<0?g<0?(C.lo=this.divLo(_,f),C.hi=this.divHi(v,g)):(C.lo=this.divLo(v,f),C.hi=this.divHi(_,g)):v<0?g<0?(C.lo=this.divLo(_,g),C.hi=this.divHi(v,g)):(C.lo=this.divLo(v,f),C.hi=this.divHi(_,f)):g<0?(C.lo=this.divLo(_,g),C.hi=this.divHi(v,f)):(C.lo=this.divLo(v,g),C.hi=this.divHi(_,f)),C},divPositive:function(c,m){return c.lo===0&&c.hi===0?c:this.zeroIn(c)?this.WHOLE:c.hi<0?new A(Number.NEGATIVE_INFINITY,this.divHi(c.hi,m)):new A(this.divLo(c.lo,m),Number.POSITIVE_INFINITY)},divNegative:function(c,m){return c.lo===0&&c.hi===0?c:this.zeroIn(c)?this.WHOLE:c.hi<0?new A(this.divLo(c.hi,m),Number.POSITIVE_INFINITY):new A(Number.NEGATIVE_INFINITY,this.divHi(c.lo,m))},divZero:function(c){return c.lo===0&&c.hi===0?c:this.WHOLE},fmod:function(c,m){var v,_;return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),this.isEmpty(c)||this.isEmpty(m)?this.EMPTY.clone():(v=c.lo<0?m.lo:m.hi,_=(_=c.lo/v)<0?Math.ceil(_):Math.floor(_),this.sub(c,this.mul(m,new A(_))))},multiplicativeInverse:function(c){return B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c)?this.EMPTY.clone():this.zeroIn(c)?c.lo!==0?c.hi!==0?this.WHOLE:new A(Number.NEGATIVE_INFINITY,this.divHi(1,c.lo)):c.hi!==0?new A(this.divLo(1,c.hi),Number.POSITIVE_INFINITY):this.EMPTY.clone():new A(this.divLo(1,c.hi),this.divHi(1,c.lo))},pow:function(c,m){var v,_;if(B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c))return this.EMPTY.clone();if(this.isInterval(m)){if(!this.isSingleton(m))return this.EMPTY.clone();m=m.lo}return m===0?c.lo===0&&c.hi===0?this.EMPTY.clone():this.ONE.clone():m<0?this.pow(this.multiplicativeInverse(c),-m):m%1==0?c.hi<0?(v=this.powLo(-c.hi,m),_=this.powHi(-c.lo,m),(1&m)==1?new A(-_,-v):new A(v,_)):c.lo<0?(1&m)==1?new A(-this.powLo(-c.lo,m),this.powHi(c.hi,m)):new A(0,this.powHi(Math.max(-c.lo,c.hi),m)):new A(this.powLo(c.lo,m),this.powHi(c.hi,m)):(console.warn("power is not an integer, you should use nth-root instead, returning an empty interval"),this.EMPTY.clone())},sqrt:function(c){return B.Z.isNumber(c)&&(c=this.Interval(c)),this.nthRoot(c,2)},nthRoot:function(c,m){var v,_,f,g,C;if(B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c)||m<0)return this.EMPTY.clone();if(this.isInterval(m)){if(!this.isSingleton(m))return this.EMPTY.clone();m=m.lo}return v=1/m,c.hi<0?m%1==0&&(1&m)==1?(_=this.powHi(-c.lo,v),f=this.powLo(-c.hi,v),new A(-_,-f)):this.EMPTY.clone():c.lo<0?(g=this.powHi(c.hi,v),m%1==0&&(1&m)==1?(C=-this.powHi(-c.lo,v),new A(C,g)):new A(0,g)):new A(this.powLo(c.lo,v),this.powHi(c.hi,v))},exp:function(c){return B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c)?this.EMPTY.clone():new A(this.expLo(c.lo),this.expHi(c.hi))},log:function(c){var m;return B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c)?this.EMPTY.clone():(m=c.lo<=0?Number.NEGATIVE_INFINITY:this.logLo(c.lo),new A(m,this.logHi(c.hi)))},ln:function(c){return this.log(c)},log10:function(c){return this.isEmpty(c)?this.EMPTY.clone():this.div(this.log(c),this.log(new A(10,10)))},log2:function(c){return this.isEmpty(c)?this.EMPTY.clone():this.div(this.log(c),this.log(new A(2,2)))},hull:function(c,m){var v=this.isEmpty(c),_=this.isEmpty(m);return v&&_?this.EMPTY.clone():v?m.clone():_?c.clone():new A(Math.min(c.lo,m.lo),Math.max(c.hi,m.hi))},intersection:function(c,m){var v,_;return this.isEmpty(c)||this.isEmpty(m)?this.EMPTY.clone():(v=Math.max(c.lo,m.lo))<=(_=Math.min(c.hi,m.hi))?new A(v,_):this.EMPTY.clone()},union:function(c,m){if(!this.intervalsOverlap(c,m))throw new Error("Interval#unions do not overlap");return new A(Math.min(c.lo,m.lo),Math.max(c.hi,m.hi))},difference:function(c,m){if(this.isEmpty(c)||this.isWhole(m))return this.EMPTY.clone();if(this.intervalsOverlap(c,m)){if(c.lo<m.lo&&m.hi<c.hi)throw new Error("Interval.difference: difference creates multiple intervals");return m.lo<=c.lo&&m.hi===1/0||m.hi>=c.hi&&m.lo===-1/0?this.EMPTY.clone():m.lo<=c.lo?new A().halfOpenLeft(m.hi,c.hi):new A().halfOpenRight(c.lo,m.lo)}return c.clone()},width:function(c){return this.isEmpty(c)?0:this.subHi(c.hi,c.lo)},abs:function(c){return B.Z.isNumber(c)&&(c=this.Interval(c)),this.isEmpty(c)?this.EMPTY.clone():c.lo>=0?c.clone():c.hi<=0?this.negative(c):new A(0,Math.max(-c.lo,c.hi))},max:function(c,m){var v=this.isEmpty(c),_=this.isEmpty(m);return v&&_?this.EMPTY.clone():v?m.clone():_?c.clone():new A(Math.max(c.lo,m.lo),Math.max(c.hi,m.hi))},min:function(c,m){var v=this.isEmpty(c),_=this.isEmpty(m);return v&&_?this.EMPTY.clone():v?m.clone():_?c.clone():new A(Math.min(c.lo,m.lo),Math.min(c.hi,m.hi))},onlyInfinity:function(c){return!isFinite(c.lo)&&c.lo===c.hi},_handleNegative:function(c){var m;return c.lo<0&&(c.lo===-1/0?(c.lo=0,c.hi=1/0):(m=Math.ceil(-c.lo/this.piTwiceLow),c.lo+=this.piTwiceLow*m,c.hi+=this.piTwiceLow*m)),c},cos:function(c){var m,v,_,f,g,C,P,w;return this.isEmpty(c)||this.onlyInfinity(c)?this.EMPTY.clone():(m=new A().set(c.lo,c.hi),this._handleNegative(m),v=this.PI_TWICE,_=this.fmod(m,v),this.width(_)>=v.lo?new A(-1,1):_.lo>=this.piHigh?(f=this.cos(this.sub(_,this.PI)),this.negative(f)):(g=_.lo,C=_.hi,P=this.cosLo(C),w=this.cosHi(g),C<=this.piLow?new A(P,w):C<=v.lo?new A(-1,Math.max(P,w)):new A(-1,1)))},sin:function(c){return this.isEmpty(c)||this.onlyInfinity(c)?this.EMPTY.clone():this.cos(this.sub(c,this.PI_HALF))},tan:function(c){var m,v,_;return this.isEmpty(c)||this.onlyInfinity(c)?this.EMPTY.clone():(m=new A().set(c.lo,c.hi),this._handleNegative(m),_=this.PI,(v=this.fmod(m,_)).lo>=this.piHalfLow&&(v=this.sub(v,_)),v.lo<=-this.piHalfLow||v.hi>=this.piHalfLow?this.WHOLE.clone():new A(this.tanLo(v.lo),this.tanHi(v.hi)))},asin:function(c){var m,v;return this.isEmpty(c)||c.hi<-1||c.lo>1?this.EMPTY.clone():(m=c.lo<=-1?-this.piHalfHigh:this.asinLo(c.lo),v=c.hi>=1?this.piHalfHigh:this.asinHi(c.hi),new A(m,v))},acos:function(c){var m,v;return this.isEmpty(c)||c.hi<-1||c.lo>1?this.EMPTY.clone():(m=c.hi>=1?0:this.acosLo(c.hi),v=c.lo<=-1?this.piHigh:this.acosHi(c.lo),new A(m,v))},atan:function(c){return this.isEmpty(c)?this.EMPTY.clone():new A(this.atanLo(c.lo),this.atanHi(c.hi))},sinh:function(c){return this.isEmpty(c)?this.EMPTY.clone():new A(this.sinhLo(c.lo),this.sinhHi(c.hi))},cosh:function(c){return this.isEmpty(c)?this.EMPTY.clone():c.hi<0?new A(this.coshLo(c.hi),this.coshHi(c.lo)):c.lo>=0?new A(this.coshLo(c.lo),this.coshHi(c.hi)):new A(1,this.coshHi(-c.lo>c.hi?c.lo:c.hi))},tanh:function(c){return this.isEmpty(c)?this.EMPTY.clone():new A(this.tanhLo(c.lo),this.tanhHi(c.hi))},equal:function(c,m){return this.isEmpty(c)?this.isEmpty(m):!this.isEmpty(m)&&c.lo===m.lo&&c.hi===m.hi},notEqual:function(c,m){return this.isEmpty(c)?!this.isEmpty(m):this.isEmpty(m)||c.hi<m.lo||c.lo>m.hi},lt:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),!this.isEmpty(c)&&!this.isEmpty(m)&&c.hi<m.lo},gt:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),!this.isEmpty(c)&&!this.isEmpty(m)&&c.lo>m.hi},leq:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),!this.isEmpty(c)&&!this.isEmpty(m)&&c.hi<=m.lo},geq:function(c,m){return B.Z.isNumber(c)&&(c=this.Interval(c)),B.Z.isNumber(m)&&(m=this.Interval(m)),!this.isEmpty(c)&&!this.isEmpty(m)&&c.lo>=m.hi},piLow:3.141592653589793,piHigh:3.1415926535897936,piHalfLow:1.5707963267948966,piHalfHigh:1.5707963267948968,piTwiceLow:6.283185307179586,piTwiceHigh:6.283185307179587,identity:function(c){return c},_prev:function(c){return c===1/0?c:this.nextafter(c,-1/0)},_next:function(c){return c===-1/0?c:this.nextafter(c,1/0)},prev:function(c){return this._prev(c)},next:function(c){return this._next(c)},toInteger:function(c){return c<0?Math.ceil(c):Math.floor(c)},addLo:function(c,m){return this.prev(c+m)},addHi:function(c,m){return this.next(c+m)},subLo:function(c,m){return this.prev(c-m)},subHi:function(c,m){return this.next(c-m)},mulLo:function(c,m){return this.prev(c*m)},mulHi:function(c,m){return this.next(c*m)},divLo:function(c,m){return this.prev(c/m)},divHi:function(c,m){return this.next(c/m)},intLo:function(c){return this.toInteger(this.prev(c))},intHi:function(c){return this.toInteger(this.next(c))},logLo:function(c){return this.prev(Math.log(c))},logHi:function(c){return this.next(Math.log(c))},expLo:function(c){return this.prev(Math.exp(c))},expHi:function(c){return this.next(Math.exp(c))},sinLo:function(c){return this.prev(Math.sin(c))},sinHi:function(c){return this.next(Math.sin(c))},cosLo:function(c){return this.prev(Math.cos(c))},cosHi:function(c){return this.next(Math.cos(c))},tanLo:function(c){return this.prev(Math.tan(c))},tanHi:function(c){return this.next(Math.tan(c))},asinLo:function(c){return this.prev(Math.asin(c))},asinHi:function(c){return this.next(Math.asin(c))},acosLo:function(c){return this.prev(Math.acos(c))},acosHi:function(c){return this.next(Math.acos(c))},atanLo:function(c){return this.prev(Math.atan(c))},atanHi:function(c){return this.next(Math.atan(c))},sinhLo:function(c){return this.prev(X.Z.sinh(c))},sinhHi:function(c){return this.next(X.Z.sinh(c))},coshLo:function(c){return this.prev(X.Z.cosh(c))},coshHi:function(c){return this.next(X.Z.cosh(c))},tanhLo:function(c){return this.prev(X.Z.tanh(c))},tanhHi:function(c){return this.next(X.Z.tanh(c))},sqrtLo:function(c){return this.prev(Math.sqrt(c))},sqrtHi:function(c){return this.next(Math.sqrt(c))},powLo:function(c,m){var v;if(m%1!=0)return this.prev(Math.pow(c,m));for(v=(1&m)==1?c:1,m>>=1;m>0;)c=this.mulLo(c,c),(1&m)==1&&(v=this.mulLo(c,v)),m>>=1;return v},powHi:function(c,m){var v;if(m%1!=0)return this.next(Math.pow(c,m));for(v=(1&m)==1?c:1,m>>=1;m>0;)c=this.mulHi(c,c),(1&m)==1&&(v=this.mulHi(c,v)),m>>=1;return v},disable:function(){this.next=this.prev=this.identity},enable:function(){this.prev=function(c){return this._prev(c)},this.next=function(c){return this._next(c)}},SMALLEST_DENORM:Math.pow(2,-1074),UINT_MAX:-1>>>0,nextafter:function(c,m){var v,_;return isNaN(c)||isNaN(m)?NaN:c===m?c:c===0?m<0?-this.SMALLEST_DENORM:this.SMALLEST_DENORM:(_=R.hi(c),v=R.lo(c),m>c==c>0?v===this.UINT_MAX?(_+=1,v=0):v+=1:v===0?(v=this.UINT_MAX,_-=1):v-=1,R.pack(v,_))}},a.Z.Math.IntervalArithmetic.PI=new A(X.Z.IntervalArithmetic.piLow,X.Z.IntervalArithmetic.piHigh),a.Z.Math.IntervalArithmetic.PI_HALF=new A(X.Z.IntervalArithmetic.piHalfLow,X.Z.IntervalArithmetic.piHalfHigh),a.Z.Math.IntervalArithmetic.PI_TWICE=new A(X.Z.IntervalArithmetic.piTwiceLow,X.Z.IntervalArithmetic.piTwiceHigh),a.Z.Math.IntervalArithmetic.ZERO=new A(0),a.Z.Math.IntervalArithmetic.ONE=new A(1),a.Z.Math.IntervalArithmetic.WHOLE=new A().setWhole(),a.Z.Math.IntervalArithmetic.EMPTY=new A().setEmpty();const E=a.Z.Math.IntervalArithmetic},275:(u,N,S)=>{S.d(N,{Z:()=>A});var a,X=S(765),B=S(109),R=function(E){var c,m;return E.memo||(c={},m=Array.prototype.join,E.memo=function(){var v=m.call(arguments);return c[v]!==a?c[v]:c[v]=E.apply(this,arguments)}),E.memo};X.Z.Math={eps:1e-6,relDif:function(E,c){var m=Math.abs(E),v=Math.abs(c);return(v=Math.max(m,v))===0?0:Math.abs(E-c)/v},mod:function(E,c){return E-Math.floor(E/c)*c},vector:function(E,c){var m,v;for(c=c||0,m=[],v=0;v<E;v++)m[v]=c;return m},matrix:function(E,c,m){var v,_,f;for(m=m||0,c=c||E,v=[],_=0;_<E;_++)for(v[_]=[],f=0;f<c;f++)v[_][f]=m;return v},identity:function(E,c){var m,v;for(c===a&&typeof c!="number"&&(c=E),m=this.matrix(E,c),v=0;v<Math.min(E,c);v++)m[v][v]=1;return m},frustum:function(E,c,m,v,_,f){var g=this.matrix(4,4);return g[0][0]=2*_/(c-E),g[0][1]=0,g[0][2]=(c+E)/(c-E),g[0][3]=0,g[1][0]=0,g[1][1]=2*_/(v-m),g[1][2]=(v+m)/(v-m),g[1][3]=0,g[2][0]=0,g[2][1]=0,g[2][2]=-(f+_)/(f-_),g[2][3]=-f*_*2/(f-_),g[3][0]=0,g[3][1]=0,g[3][2]=-1,g[3][3]=0,g},projection:function(E,c,m,v){var _=m*Math.tan(E/2),f=_*c;return this.frustum(-f,f,-_,_,m,v)},matVecMult:function(E,c){var m,v,_,f=E.length,g=c.length,C=[];if(g===3)for(m=0;m<f;m++)C[m]=E[m][0]*c[0]+E[m][1]*c[1]+E[m][2]*c[2];else for(m=0;m<f;m++){for(v=0,_=0;_<g;_++)v+=E[m][_]*c[_];C[m]=v}return C},matMatMult:function(E,c){var m,v,_,f,g=E.length,C=g>0?c[0].length:0,P=c.length,w=this.matrix(g,C);for(m=0;m<g;m++)for(v=0;v<C;v++){for(_=0,f=0;f<P;f++)_+=E[m][f]*c[f][v];w[m][v]=_}return w},transpose:function(E){var c,m,v,_,f;for(_=E.length,f=E.length>0?E[0].length:0,c=this.matrix(f,_),m=0;m<f;m++)for(v=0;v<_;v++)c[m][v]=E[v][m];return c},inverse:function(E){var c,m,v,_,f,g,C,P=E.length,w=[],T=[],L=[];for(c=0;c<P;c++){for(w[c]=[],m=0;m<P;m++)w[c][m]=E[c][m];T[c]=c}for(m=0;m<P;m++){for(f=Math.abs(w[m][m]),g=m,c=m+1;c<P;c++)Math.abs(w[c][m])>f&&(f=Math.abs(w[c][m]),g=c);if(f<=this.eps)return[];if(g>m){for(v=0;v<P;v++)C=w[m][v],w[m][v]=w[g][v],w[g][v]=C;C=T[m],T[m]=T[g],T[g]=C}for(_=1/w[m][m],c=0;c<P;c++)w[c][m]*=_;for(w[m][m]=_,v=0;v<P;v++)if(v!==m){for(c=0;c<P;c++)c!==m&&(w[c][v]-=w[c][m]*w[m][v]);w[m][v]=-_*w[m][v]}}for(c=0;c<P;c++){for(v=0;v<P;v++)L[T[v]]=w[c][v];for(v=0;v<P;v++)w[c][v]=L[v]}return w},innerProduct:function(E,c,m){var v,_=0;for(m!==a&&B.Z.isNumber(m)||(m=E.length),v=0;v<m;v++)_+=E[v]*c[v];return _},crossProduct:function(E,c){return[E[1]*c[2]-E[2]*c[1],E[2]*c[0]-E[0]*c[2],E[0]*c[1]-E[1]*c[0]]},norm:function(E,c){var m,v=0;for(c!==a&&B.Z.isNumber(c)||(c=E.length),m=0;m<c;m++)v+=E[m]*E[m];return Math.sqrt(v)},axpy:function(E,c,m){var v,_=c.length,f=[];for(v=0;v<_;v++)f[v]=E*c[v]+m[v];return f},factorial:R(function(E){return E<0?NaN:(E=Math.floor(E))===0||E===1?1:E*this.factorial(E-1)}),binomial:R(function(E,c){var m,v;if(c>E||c<0)return NaN;if(c=Math.round(c),E=Math.round(E),c===0||c===E)return 1;for(m=1,v=0;v<c;v++)m*=E-v,m/=v+1;return m}),cosh:Math.cosh||function(E){return .5*(Math.exp(E)+Math.exp(-E))},sinh:Math.sinh||function(E){return .5*(Math.exp(E)-Math.exp(-E))},acosh:Math.acosh||function(E){return Math.log(E+Math.sqrt(E*E-1))},asinh:Math.asinh||function(E){return E===-1/0?E:Math.log(E+Math.sqrt(E*E+1))},cot:function(E){return 1/Math.tan(E)},acot:function(E){return(E>=0?.5:-.5)*Math.PI-Math.atan(E)},nthroot:function(E,c){var m=1/c;return c<=0||Math.floor(c)!==c?NaN:E===0?0:E>0?Math.exp(m*Math.log(E)):c%2==1?-Math.exp(m*Math.log(-E)):NaN},cbrt:Math.cbrt||function(E){return this.nthroot(E,3)},pow:function(E,c){return E===0?c===0?1:0:Math.floor(c)===c?Math.pow(E,c):E>0?Math.exp(c*Math.log(E)):NaN},ratpow:function(E,c,m){var v;return c===0?1:m===0?NaN:(v=this.gcd(c,m),this.nthroot(this.pow(E,c/v),m/v))},log10:function(E){return Math.log(E)/Math.log(10)},log2:function(E){return Math.log(E)/Math.log(2)},log:function(E,c){return c!==void 0&&B.Z.isNumber(c)?Math.log(E)/Math.log(c):Math.log(E)},sign:Math.sign||function(E){return(E=+E)==0||isNaN(E)?E:E>0?1:-1},squampow:function(E,c){var m;if(Math.floor(c)===c){for(m=1,c<0&&(E=1/E,c*=-1);c!==0;)1&c&&(m*=E),c>>=1,E*=E;return m}return this.pow(E,c)},gcd:function(E,c){var m;if(E=Math.abs(E),c=Math.abs(c),!B.Z.isNumber(E)||!B.Z.isNumber(c))return NaN;for(c>E&&(m=E,E=c,c=m);;){if((E%=c)===0)return c;if((c%=E)===0)return E}},lcm:function(E,c){var m;return B.Z.isNumber(E)&&B.Z.isNumber(c)?(m=E*c)!==0?m/this.gcd(E,c):0:NaN},erf:function(E){return this.ProbFuncs.erf(E)},erfc:function(E){return this.ProbFuncs.erfc(E)},erfi:function(E){return this.ProbFuncs.erfi(E)},ndtr:function(E){return this.ProbFuncs.ndtr(E)},ndtri:function(E){return this.ProbFuncs.ndtri(E)},lt:function(E,c){return E<c},leq:function(E,c){return E<=c},gt:function(E,c){return E>c},geq:function(E,c){return E>=c},eq:function(E,c){return E===c},neq:function(E,c){return E!==c},and:function(E,c){return E&&c},not:function(E){return!E},or:function(E,c){return E||c},xor:function(E,c){return(E||c)&&!(E&&c)},normalize:function(E){var c,m,v=2*E[3],_=E[4]/v;return E[5]=_,E[6]=-E[1]/v,E[7]=-E[2]/v,isFinite(_)?Math.abs(_)>=1?(E[0]=(E[6]*E[6]+E[7]*E[7]-_*_)/(2*_),E[1]=-E[6]/_,E[2]=-E[7]/_,E[3]=1/(2*_),E[4]=1):(m=_<=0?-1:1,E[0]=m*(E[6]*E[6]+E[7]*E[7]-_*_)*.5,E[1]=-m*E[6],E[2]=-m*E[7],E[3]=m/2,E[4]=m*_):(c=Math.sqrt(E[1]*E[1]+E[2]*E[2]),E[0]/=c,E[1]/=c,E[2]/=c,E[3]=0,E[4]=1),E},toGL:function(E){var c,m,v;if(c=typeof Float32Array=="function"?new Float32Array(16):new Array(16),E.length!==4&&E[0].length!==4)return c;for(m=0;m<4;m++)for(v=0;v<4;v++)c[m+4*v]=E[m][v];return c},Vieta:function(E){var c,m,v,_=E.length,f=[];for(f=E.slice(),c=1;c<_;++c){for(v=f[c],f[c]*=f[c-1],m=c-1;m>=1;--m)f[m]+=f[m-1]*v;f[0]+=v}return f}};const A=X.Z.Math},336:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(109),B=S(503),R=S(275),A={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};R.Z.Numerics={Gauss:function(c,m){var v,_,f,g,C,P=R.Z.eps,w=c.length>0?c[0].length:0;if(w!==m.length||w!==c.length)throw new Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(g=[],C=m.slice(0,w),v=0;v<w;v++)g[v]=c[v].slice(0,w);for(_=0;_<w;_++){for(v=w-1;v>_;v--)if(Math.abs(g[v][_])>P)if(Math.abs(g[_][_])<P)X.Z.swap(g,v,_),X.Z.swap(C,v,_);else for(g[v][_]/=g[_][_],C[v]-=g[v][_]*C[_],f=_+1;f<w;f++)g[v][f]-=g[v][_]*g[_][f];if(Math.abs(g[_][_])<P)throw new Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(g,C,!0),C},backwardSolve:function(c,m,v){var _,f,g,C,P;for(_=v?m:m.slice(0,m.length),f=c.length,g=c.length>0?c[0].length:0,C=f-1;C>=0;C--){for(P=g-1;P>C;P--)_[C]-=c[C][P]*_[P];_[C]/=c[C][C]}return _},gaussBareiss:function(c){var m,v,_,f,g,C,P,w,T,L=R.Z.eps;if((P=c.length)<=0)return 0;for(c[0].length<P&&(P=c[0].length),w=[],f=0;f<P;f++)w[f]=c[f].slice(0,P);for(v=1,_=1,m=0;m<P-1;m++){if(C=w[m][m],Math.abs(C)<L){for(f=m+1;f<P&&!(Math.abs(w[f][m])>=L);f++);if(f===P)return 0;for(g=m;g<P;g++)T=w[f][g],w[f][g]=w[m][g],w[m][g]=T;_=-_,C=w[m][m]}for(f=m+1;f<P;f++)for(g=m+1;g<P;g++)T=C*w[f][g]-w[f][m]*w[m][g],w[f][g]=T/v;v=C}return _*w[P-1][P-1]},det:function(c){return c.length===2&&c[0].length===2?c[0][0]*c[1][1]-c[1][0]*c[0][1]:this.gaussBareiss(c)},Jacobi:function(c){var m,v,_,f,g,C,P,w,T,L=R.Z.eps*R.Z.eps,Y=0,j=c.length,F=[[0,0,0],[0,0,0],[0,0,0]],G=[[0,0,0],[0,0,0],[0,0,0]],H=0;for(m=0;m<j;m++){for(v=0;v<j;v++)F[m][v]=0,G[m][v]=c[m][v],Y+=Math.abs(G[m][v]);F[m][m]=1}if(j===1)return[G,F];if(Y<=0)return[G,F];Y/=j*j;do{for(w=0,T=0,v=1;v<j;v++)for(m=0;m<v;m++)if((f=Math.abs(G[m][v]))>T&&(T=f),w+=f,f>=L){for(f=.5*Math.atan2(2*G[m][v],G[m][m]-G[v][v]),g=Math.sin(f),C=Math.cos(f),_=0;_<j;_++)P=G[_][m],G[_][m]=C*P+g*G[_][v],G[_][v]=-g*P+C*G[_][v],P=F[_][m],F[_][m]=C*P+g*F[_][v],F[_][v]=-g*P+C*F[_][v];for(G[m][m]=C*G[m][m]+g*G[v][m],G[v][v]=-g*G[m][v]+C*G[v][v],G[m][v]=0,_=0;_<j;_++)G[m][_]=G[_][m],G[v][_]=G[_][v]}H+=1}while(Math.abs(w)/Y>L&&H<2e3);return[G,F]},NewtonCotes:function(c,m,v){var _,f,g,C=0,P=v&&X.Z.isNumber(v.number_of_nodes)?v.number_of_nodes:28,w={trapez:!0,simpson:!0,milne:!0},T=v&&v.integration_type&&w.hasOwnProperty(v.integration_type)&&w[v.integration_type]?v.integration_type:"milne",L=(c[1]-c[0])/P;switch(T){case"trapez":for(C=.5*(m(c[0])+m(c[1])),_=c[0],f=0;f<P-1;f++)C+=m(_+=L);C*=L;break;case"simpson":if(P%2>0)throw new Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(g=P/2,C=m(c[0])+m(c[1]),_=c[0],f=0;f<g-1;f++)C+=2*m(_+=2*L);for(_=c[0]-L,f=0;f<g;f++)C+=4*m(_+=2*L);C*=L/3;break;default:if(P%4>0)throw new Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(g=.25*P,C=7*(m(c[0])+m(c[1])),_=c[0],f=0;f<g-1;f++)C+=14*m(_+=4*L);for(_=c[0]-3*L,f=0;f<g;f++)C+=32*(m(_+=4*L)+m(_+2*L));for(_=c[0]-2*L,f=0;f<g;f++)C+=12*m(_+=4*L);C*=2*L/45}return C},Romberg:function(c,m,v){var _,f,g,C,P,w,T,L,Y=[],j=0,F=1/0,G=v&&X.Z.isNumber(v.max_iterations)?v.max_iterations:20,H=v&&X.Z.isNumber(v.eps)?v.eps:v.eps||1e-7;for(_=c[0],g=(f=c[1])-_,P=1,Y[0]=.5*g*(m(_)+m(f)),w=0;w<G;++w){for(C=0,g*=.5,P*=2,L=1,T=1;T<P;T+=2)C+=m(_+T*g);for(Y[w+1]=.5*Y[w]+C*g,j=Y[w+1],T=w-1;T>=0;--T)L*=4,Y[T]=Y[T+1]+(Y[T+1]-Y[T])/(L-1),j=Y[T];if(Math.abs(j-F)<H*Math.abs(j))break;F=j}return j},GaussLegendre:function(c,m,v){var _,f,g,C,P,w,T,L,Y=0,j=[],F=[],G=v&&X.Z.isNumber(v.n)?v.n:12;if(G>18&&(G=18),j[2]=[.5773502691896257],F[2]=[1],j[4]=[.33998104358485626,.8611363115940526],F[4]=[.6521451548625461,.34785484513745385],j[6]=[.2386191860831969,.6612093864662645,.932469514203152],F[6]=[.46791393457269104,.3607615730481386,.17132449237917036],j[8]=[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],F[8]=[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],j[10]=[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],F[10]=[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],j[12]=[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],F[12]=[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],j[14]=[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],F[14]=[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],j[16]=[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499],F[16]=[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096],j[18]=[.0847750130417353,.2518862256915055,.41175116146284263,.5597708310739475,.6916870430603532,.8037049589725231,.8926024664975557,.9558239495713977,.9915651684209309],F[18]=[.1691423829631436,.16427648374583273,.15468467512626524,.14064291467065065,.12255520671147846,.10094204410628717,.07642573025488905,.0497145488949698,.02161601352648331],j[3]=[0,.7745966692414834],F[3]=[.8888888888888888,.5555555555555556],j[5]=[0,.5384693101056831,.906179845938664],F[5]=[.5688888888888889,.47862867049936647,.23692688505618908],j[7]=[0,.4058451513773972,.7415311855993945,.9491079123427585],F[7]=[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],j[9]=[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],F[9]=[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],j[11]=[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],F[11]=[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],j[13]=[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],F[13]=[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],j[15]=[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],F[15]=[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],j[17]=[0,.17848418149584785,.3512317634538763,.5126905370864769,.6576711592166907,.7815140038968014,.8802391537269859,.9506755217687678,.9905754753144174],F[17]=[.17944647035620653,.17656270536699264,.16800410215645004,.15404576107681028,.13513636846852548,.11188384719340397,.08503614831717918,.0554595293739872,.02414830286854793],_=c[0],f=c[1],C=G+1>>1,T=j[G],L=F[G],w=.5*(f-_),P=.5*(f+_),!0&G)for(Y=L[0]*m(P),g=1;g<C;++g)Y+=L[g]*(m(P+w*T[g])+m(P-w*T[g]));else for(Y=0,g=0;g<C;++g)Y+=L[g]*(m(P+w*T[g])+m(P-w*T[g]));return w*Y},_rescale_error:function(c,m,v){var _,f,g=2220446049250313e-31;return c=Math.abs(c),v!==0&&c!==0&&(c=(_=Math.pow(200*c/v,1.5))<1?v*_:v),m>20041683600089728e-310&&(f=50*g*m)>c&&(c=f),c},_gaussKronrod:function(c,m,v,_,f,g,C){var P,w,T,L,Y,j,F,G,H,q,K,at=c[0],tt=c[1],Q=.5*(at+tt),it=.5*(tt-at),rt=Math.abs(it),dt=m(Q),ht=0,ut=dt*g[v-1],_t=Math.abs(ut),Dt=0,Bt=[],Xt=[];for(v%2==0&&(ht=dt*f[v/2-1]),P=Math.floor((v-1)/2),Y=0;Y<P;Y++)q=(G=m(Q-(F=it*_[j=2*Y+1])))+(H=m(Q+F)),Bt[j]=G,Xt[j]=H,ht+=f[Y]*q,ut+=g[j]*q,_t+=g[j]*(Math.abs(G)+Math.abs(H));for(P=Math.floor(v/2),Y=0;Y<P;Y++)G=m(Q-(F=it*_[K=2*Y])),H=m(Q+F),Bt[K]=G,Xt[K]=H,ut+=g[K]*(G+H),_t+=g[K]*(Math.abs(G)+Math.abs(H));for(T=.5*ut,Dt=g[v-1]*Math.abs(dt-T),Y=0;Y<v-1;Y++)Dt+=g[Y]*(Math.abs(Bt[Y]-T)+Math.abs(Xt[Y]-T));return L=(ut-ht)*it,_t*=rt,Dt*=rt,w=ut*=it,C.abserr=this._rescale_error(L,_t,Dt),C.resabs=_t,C.resasc=Dt,w},GaussKronrod15:function(c,m,v){return this._gaussKronrod(c,m,8,[.9914553711208126,.9491079123427585,.8648644233597691,.7415311855993945,.5860872354676911,.4058451513773972,.20778495500789848,0],[.1294849661688697,.27970539148927664,.3818300505051189,.4179591836734694],[.022935322010529224,.06309209262997856,.10479001032225019,.14065325971552592,.1690047266392679,.19035057806478542,.20443294007529889,.20948214108472782],v)},GaussKronrod21:function(c,m,v){return this._gaussKronrod(c,m,11,[.9956571630258081,.9739065285171717,.9301574913557082,.8650633666889845,.7808177265864169,.6794095682990244,.5627571346686047,.4333953941292472,.2943928627014602,.14887433898163122,0],[.06667134430868814,.1494513491505806,.21908636251598204,.26926671930999635,.29552422471475287],[.011694638867371874,.032558162307964725,.054755896574351995,.07503967481091996,.0931254545836976,.10938715880229764,.12349197626206584,.13470921731147334,.14277593857706009,.14773910490133849,.1494455540029169],v)},GaussKronrod31:function(c,m,v){return this._gaussKronrod(c,m,16,[.9980022986933971,.9879925180204854,.9677390756791391,.937273392400706,.8972645323440819,.8482065834104272,.790418501442466,.7244177313601701,.650996741297417,.5709721726085388,.4850818636402397,.3941513470775634,.29918000715316884,.20119409399743451,.1011420669187175,0],[.03075324199611727,.07036604748810812,.10715922046717194,.13957067792615432,.16626920581699392,.1861610000155622,.19843148532711158,.2025782419255613],[.005377479872923349,.015007947329316122,.02546084732671532,.03534636079137585,.04458975132476488,.05348152469092809,.06200956780067064,.06985412131872826,.07684968075772038,.08308050282313302,.08856444305621176,.09312659817082532,.09664272698362368,.09917359872179196,.10076984552387559,.10133000701479154],v)},_workspace:function(c,m){return{limit:m,size:0,nrmax:0,i:0,alist:[c[0]],blist:[c[1]],rlist:[0],elist:[0],order:[0],level:[0],qpsrt:function(){var v,_,f,g,C,P=this.size-1,w=this.limit,T=this.nrmax,L=this.order[T];if(P<2)return this.order[0]=0,this.order[1]=1,void(this.i=L);for(v=this.elist[L];T>0&&v>this.elist[this.order[T-1]];)this.order[T]=this.order[T-1],T--;for(C=P<w/2+2?P:w-P+1,f=T+1;f<C&&v<this.elist[this.order[f]];)this.order[f-1]=this.order[f],f++;for(this.order[f-1]=L,_=this.elist[P],g=C-1;g>f-2&&_>=this.elist[this.order[g]];)this.order[g+1]=this.order[g],g--;this.order[g+1]=P,L=this.order[T],this.i=L,this.nrmax=T},set_initial_result:function(v,_){this.size=1,this.rlist[0]=v,this.elist[0]=_},update:function(v,_,f,g,C,P,w,T){var L=this.i,Y=this.size,j=this.level[this.i]+1;T>g?(this.alist[L]=C,this.rlist[L]=w,this.elist[L]=T,this.level[L]=j,this.alist[Y]=v,this.blist[Y]=_,this.rlist[Y]=f,this.elist[Y]=g,this.level[Y]=j):(this.blist[L]=_,this.rlist[L]=f,this.elist[L]=g,this.level[L]=j,this.alist[Y]=C,this.blist[Y]=P,this.rlist[Y]=w,this.elist[Y]=T,this.level[Y]=j),this.size++,j>this.maximum_level&&(this.maximum_level=j),this.qpsrt()},retrieve:function(){var v=this.i;return{a:this.alist[v],b:this.blist[v],r:this.rlist[v],e:this.elist[v]}},sum_results:function(){var v,_=this.size,f=0;for(v=0;v<_;v++)f+=this.rlist[v];return f},subinterval_too_small:function(v,_,f){var g=1.0000000000000222*(Math.abs(_)+22250738585072014e-321);return Math.abs(v)<=g&&Math.abs(f)<=g}}},Qag:function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q,it=this._workspace(c,1e3),rt=v&&X.Z.isNumber(v.limit)?v.limit:15,dt=v&&X.Z.isNumber(v.epsrel)?v.epsrel:1e-7,ht=v&&X.Z.isNumber(v.epsabs)?v.epsabs:1e-7,ut=v&&X.Z.isFunction(v.q)?v.q:this.GaussKronrod15,_t={},Dt=0,Bt=0,Xt=0,$t=0,se=0,ae=0,le=0,he=0,Gt=0,oe=0;if(rt>it.limit&&a.Z.warn("iteration limit exceeds available workspace"),ht<=0&&(dt<50*R.Z.eps||dt<5e-29)&&a.Z.warn("tolerance cannot be acheived with given epsabs and epsrel"),g=ut.apply(this,[c,m,_t]),C=_t.abserr,P=_t.resabs,w=_t.resasc,it.set_initial_result(g,C),T=Math.max(ht,dt*Math.abs(g)),C<=11102230246251565e-30*P&&C>T)return a.Z.warn("cannot reach tolerance because of roundoff error on first attempt"),-1/0;if(C<=T&&C!==w||C===0)return g;if(rt===1)return a.Z.warn("a maximum of one iteration was insufficient"),-1/0;_=g,f=C,Dt=1;do se=0,ae=0,le=0,he=0,Gt=0,oe=0,G=(tt=it.retrieve()).a,H=tt.b,q=tt.r,K=tt.e,L=G,j=Y=.5*(G+H),F=H,se=ut.apply(this,[[L,Y],m,_t]),he=_t.abserr,at=_t.resasc,ae=ut.apply(this,[[j,F],m,_t]),f+=(oe=he+(Gt=_t.abserr))-K,_+=(le=se+ae)-q,at!==he&&_t.resasc!==Gt&&(Q=q-le,Math.abs(Q)<=1e-5*Math.abs(le)&&oe>=.99*K&&Bt++,Dt>=10&&oe>K&&Xt++),f>(T=Math.max(ht,dt*Math.abs(_)))&&((Bt>=6||Xt>=20)&&($t=2),it.subinterval_too_small(L,j,F)&&($t=3)),it.update(L,Y,se,he,j,F,ae,Gt),G=(tt=it.retrieve()).a_i,H=tt.b_i,q=tt.r_i,K=tt.e_i,Dt++;while(Dt<rt&&!$t&&f>T);return it.sum_results()},I:function(c,m){return this.Qag(c,m,{q:this.GaussKronrod15,limit:15,epsrel:1e-7,epsabs:1e-7})},Newton:function(c,m,v){var _,f=0,g=R.Z.eps,C=c.apply(v,[m]);for(X.Z.isArray(m)&&(m=m[0]);f<50&&Math.abs(C)>g;)_=this.D(c,v)(m),Math.abs(_)>g?m-=C/_:m+=.2*Math.random()-1,C=c.apply(v,[m]),f+=1;return m},root:function(c,m,v){return this.chandrupatla(c,m,v)},generalizedNewton:function(c,m,v,_){var f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at=0;for(this.generalizedNewton.t1memo?(f=this.generalizedNewton.t1memo,g=this.generalizedNewton.t2memo):(f=v,g=_),F=(Y=c.X(f)-m.X(g))*Y+(j=c.Y(f)-m.Y(g))*j,G=this.D(c.X,c),H=this.D(m.X,m),q=this.D(c.Y,c),K=this.D(m.Y,m);F>R.Z.eps&&at<10;)C=G(f),P=-H(g),w=q(f),f-=((T=-K(g))*Y-P*j)/(L=C*T-P*w),g-=(C*j-w*Y)/L,F=(Y=c.X(f)-m.X(g))*Y+(j=c.Y(f)-m.Y(g))*j,at+=1;return this.generalizedNewton.t1memo=f,this.generalizedNewton.t2memo=g,Math.abs(f)<Math.abs(g)?[c.X(f),c.Y(f)]:[m.X(g),m.Y(g)]},Neville:function(c){var m=[],v=function(_){return function(f,g){var C,P,w,T=R.Z.binomial,L=c.length,Y=L-1,j=0,F=0;if(!g)for(w=1,C=0;C<L;C++)m[C]=T(Y,C)*w,w*=-1;for(P=f,C=0;C<L;C++){if(P===0)return c[C][_]();w=m[C]/P,P-=1,j+=c[C][_]()*w,F+=w}return j/F}};return[v("X"),v("Y"),0,function(){return c.length-1}]},splineDef:function(c,m){var v,_,f,g=Math.min(c.length,m.length),C=[],P=[],w=[],T=[],L=[],Y=[];if(g===2)return[0,0];for(_=0;_<g;_++)v={X:c[_],Y:m[_]},w.push(v);for(w.sort(function(j,F){return j.X-F.X}),_=0;_<g;_++)c[_]=w[_].X,m[_]=w[_].Y;for(_=0;_<g-1;_++)T.push(c[_+1]-c[_]);for(_=0;_<g-2;_++)L.push(6*(m[_+2]-m[_+1])/T[_+1]-6*(m[_+1]-m[_])/T[_]);for(C.push(2*(T[0]+T[1])),P.push(L[0]),_=0;_<g-3;_++)f=T[_+1]/C[_],C.push(2*(T[_+1]+T[_+2])-f*T[_+1]),P.push(L[_+1]-f*P[_]);for(Y[g-3]=P[g-3]/C[g-3],_=g-4;_>=0;_--)Y[_]=(P[_]-T[_+1]*Y[_+1])/C[_];for(_=g-3;_>=0;_--)Y[_+1]=Y[_];return Y[0]=0,Y[g-1]=0,Y},splineEval:function(c,m,v,_){var f,g,C,P,w,T,L,Y=Math.min(m.length,v.length),j=1,F=!1,G=[];for(X.Z.isArray(c)?(j=c.length,F=!0):c=[c],f=0;f<j;f++){if(c[f]<m[0]||m[f]>m[Y-1])return NaN;for(g=1;g<Y&&!(c[f]<=m[g]);g++);C=v[g-=1],P=(v[g+1]-v[g])/(m[g+1]-m[g])-(m[g+1]-m[g])/6*(_[g+1]+2*_[g]),w=_[g]/2,T=(_[g+1]-_[g])/(6*(m[g+1]-m[g])),L=c[f]-m[g],G.push(C+(P+(w+T*L)*L)*L)}return F?G:G[0]},generatePolynomialTerm:function(c,m,v,_){var f,g=[];for(f=m;f>=0;f--)g=g.concat(["(",c[f].toPrecision(_),")"]),f>1?g=g.concat(["*",v,"<sup>",f,"<","/sup> + "]):f===1&&(g=g.concat(["*",v," + "]));return g.join("")},lagrangePolynomial:function(c){var m=[],v=this,_=function(f,g){var C,P,w,T,L=c.length,Y=0,j=0;if(!g)for(C=0;C<L;C++){for(m[C]=1,w=c[C].X(),P=0;P<L;P++)P!==C&&(m[C]*=w-c[P].X());m[C]=1/m[C]}for(C=0;C<L;C++){if(f===(w=c[C].X()))return c[C].Y();j+=T=m[C]/(f-w),Y+=T*c[C].Y()}return Y/j};return _.getTerm=function(f,g,C){return v.lagrangePolynomialTerm(c,f,g,C)()},_},lagrangePolynomialTerm:function(c,m,v,_){return function(){var f,g,C,P,w,T,L=c.length,Y=[],j=[],F=[],G=!0;for(v=v||"x",_===void 0&&(_=" * "),f=L-1,P=0;P<L;P++)F[P]=0;for(C=0;C<L;C++){for(w=c[C].Y(),T=c[C].X(),Y=[],P=0;P<L;P++)P!==C&&(w/=T-c[P].X(),Y.push(c[P].X()));for(j=[1].concat(R.Z.Vieta(Y)),P=0;P<j.length;P++)F[P]+=(P%2==1?-1:1)*j[P]*w}for(g="",P=0;P<F.length;P++)w=F[P],Math.abs(w)<R.Z.eps||(a.Z.exists(m)&&(w=B.Z._round10(w,-m)),G?(g+=w>0?w:"-"+-w,G=!1):g+=w>0?" + "+w:" - "+-w,f-P>1?g+=_+v+"^"+(f-P):f-P==1&&(g+=_+v));return g}},_initCubicPoly:function(c,m,v,_){return[c,v,-3*c+3*m-2*v-_,2*c-2*m+v+_]},CardinalSpline:function(c,m,v){var _,f,g,C,P=[],w=this;return C=X.Z.isFunction(m)?m:function(){return m},v===void 0&&(v="uniform"),f=function(T){return function(L,Y){var j,F,G,H,q,K,at,tt,Q,it;if(c.length<2)return NaN;if(!Y)for(g=C(),G={X:function(){return 2*c[0].X()-c[1].X()},Y:function(){return 2*c[0].Y()-c[1].Y()},Dist:function(rt){var dt=this.X()-rt.X(),ht=this.Y()-rt.Y();return Math.sqrt(dt*dt+ht*ht)}},H={X:function(){return 2*c[c.length-1].X()-c[c.length-2].X()},Y:function(){return 2*c[c.length-1].Y()-c[c.length-2].Y()},Dist:function(rt){var dt=this.X()-rt.X(),ht=this.Y()-rt.Y();return Math.sqrt(dt*dt+ht*ht)}},it=(_=[G].concat(c,[H])).length,P[T]=[],j=0;j<it-3;j++)v==="centripetal"?(at=_[j].Dist(_[j+1]),tt=_[j+2].Dist(_[j+1]),Q=_[j+3].Dist(_[j+2]),at=Math.sqrt(at),tt=Math.sqrt(tt),Q=Math.sqrt(Q),tt<R.Z.eps&&(tt=1),at<R.Z.eps&&(at=tt),Q<R.Z.eps&&(Q=tt),q=(_[j+1][T]()-_[j][T]())/at-(_[j+2][T]()-_[j][T]())/(tt+at)+(_[j+2][T]()-_[j+1][T]())/tt,K=(_[j+2][T]()-_[j+1][T]())/tt-(_[j+3][T]()-_[j+1][T]())/(Q+tt)+(_[j+3][T]()-_[j+2][T]())/Q,q*=tt,K*=tt,P[T][j]=w._initCubicPoly(_[j+1][T](),_[j+2][T](),g*q,g*K)):P[T][j]=w._initCubicPoly(_[j+1][T](),_[j+2][T](),g*(_[j+2][T]()-_[j][T]()),g*(_[j+3][T]()-_[j+1][T]()));return isNaN(L)?NaN:(it=c.length,L<=0?c[0][T]():L>=it?c[it-1][T]():(j=Math.floor(L))===L?c[j][T]():(L-=j,(F=P[T][j])===void 0?NaN:((F[3]*L+F[2])*L+F[1])*L+F[0]))}},[f("X"),f("Y"),0,function(){return c.length-1}]},CatmullRomSpline:function(c,m){return this.CardinalSpline(c,.5,m)},regressionPolynomial:function(c,m,v){var _,f,g,C,P,w,T="";if(X.Z.isPoint(c)&&X.Z.isFunction(c.Value))f=function(){return c.Value()};else if(X.Z.isFunction(c))f=c;else{if(!X.Z.isNumber(c))throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof c+"'.");f=function(){return c}}if(arguments.length===3&&X.Z.isArray(m)&&X.Z.isArray(v))P=0;else if(arguments.length===2&&X.Z.isArray(m)&&m.length>0&&X.Z.isPoint(m[0]))P=1;else{if(!(arguments.length===2&&X.Z.isArray(m)&&m.length>0&&m[0].usrCoords&&m[0].scrCoords))throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");P=2}return(w=function(L,Y){var j,F,G,H,q,K,at,tt,Q,it=m.length;if(Q=Math.floor(f()),!Y){if(P===1)for(g=[],C=[],j=0;j<it;j++)g[j]=m[j].X(),C[j]=m[j].Y();if(P===2)for(g=[],C=[],j=0;j<it;j++)g[j]=m[j].usrCoords[1],C[j]=m[j].usrCoords[2];if(P===0)for(g=[],C=[],j=0;j<it;j++)X.Z.isFunction(m[j])?g.push(m[j]()):g.push(m[j]),X.Z.isFunction(v[j])?C.push(v[j]()):C.push(v[j]);for(G=[],F=0;F<it;F++)G.push([1]);for(j=1;j<=Q;j++)for(F=0;F<it;F++)G[F][j]=G[F][j-1]*g[F];q=C,H=R.Z.transpose(G),K=R.Z.matMatMult(H,G),at=R.Z.matVecMult(H,q),_=R.Z.Numerics.Gauss(K,at),T=R.Z.Numerics.generatePolynomialTerm(_,Q,"x",3)}for(tt=_[Q],j=Q-1;j>=0;j--)tt=tt*L+_[j];return tt}).getTerm=function(){return T},w},bezier:function(c){var m,v,_=function(f){return function(g,C){var P=3*Math.floor(g),w=g%1,T=1-w;return C||(v=3*Math.floor((c.length-1)/3),m=Math.floor(v/3)),g<0?c[0][f]():g>=m?c[v][f]():isNaN(g)?NaN:T*T*(T*c[P][f]()+3*w*c[P+1][f]())+(3*T*c[P+2][f]()+w*c[P+3][f]())*w*w}};return[_("X"),_("Y"),0,function(){return Math.floor(c.length/3)}]},bspline:function(c,m){var v,_=function(f){return function(g,C){var P,w,T,L,Y=c.length,j=Y-1,F=m;if(j<=0)return NaN;if(j+2<=F&&(F=j+1),g<=0)return c[0][f]();if(g>=j-F+2)return c[j][f]();for(T=Math.floor(g)+F-1,v=function(G,H){var q,K=[];for(q=0;q<G+H+1;q++)K[q]=q<H?0:q<=G?q-H+1:G-H+2;return K}(j,F),L=function(G,H,q,K){var at,tt,Q,it,rt,dt=[];for(H[K]<=G&&G<H[K+1]?dt[K]=1:dt[K]=0,at=2;at<=q;at++)for(tt=K-at+1;tt<=K;tt++)Q=tt<=K-at+1||tt<0?0:dt[tt],it=tt>=K?0:dt[tt+1],rt=H[tt+at-1]-H[tt],dt[tt]=rt===0?0:(G-H[tt])/rt*Q,(rt=H[tt+at]-H[tt+1])!=0&&(dt[tt]+=(H[tt+at]-G)/rt*it);return dt}(g,v,F,T),P=0,w=T-F+1;w<=T;w++)w<Y&&w>=0&&(P+=c[w][f]()*L[w]);return P}};return[_("X"),_("Y"),0,function(){return c.length-1}]},D:function(c,m){return X.Z.exists(m)?function(v,_){var f=1e-5;return(c.apply(m,[v+f,_])-c.apply(m,[v-f,_]))/2e-5}:function(v,_){var f=1e-5;return(c(v+f,_)-c(v-f,_))/2e-5}},_riemannValue:function(c,m,v,_){var f,g,C,P;if(_<0&&(v!=="trapezoidal"&&(c+=_),_*=-1,v==="lower"?v="upper":v==="upper"&&(v="lower")),P=.01*_,v==="right")f=m(c+_);else if(v==="middle")f=m(c+.5*_);else if(v==="left"||v==="trapezoidal")f=m(c);else if(v==="lower"){for(f=m(c),C=c+P;C<=c+_;C+=P)(g=m(C))<f&&(f=g);(g=m(c+_))<f&&(f=g)}else if(v==="upper"){for(f=m(c),C=c+P;C<=c+_;C+=P)(g=m(C))>f&&(f=g);(g=m(c+_))>f&&(f=g)}else f=v==="random"?m(c+_*Math.random()):v==="simpson"?(m(c)+4*m(c+.5*_)+m(c+_))/6:m(c);return f},riemann:function(c,m,v,_,f){var g,C,P,w,T,L,Y,j=[],F=[],G=0,H=_,q=0;if(X.Z.isArray(c)?(T=c[0],w=c[1]):w=c,(m=Math.floor(m))<=0)return[j,F,q];for(C=(f-_)/m,g=0;g<m;g++)P=this._riemannValue(H,w,v,C),j[G]=H,F[G]=P,G+=1,H+=C,v==="trapezoidal"&&(P=w(H)),j[G]=H,F[G]=P,G+=1;for(g=0;g<m;g++)P=T?this._riemannValue(H,T,v,-C):0,j[G]=H,F[G]=P,G+=1,H-=C,v==="trapezoidal"&&T&&(P=T(H)),j[G]=H,F[G]=P,v!=="trapezoidal"?(L=P,Y=F[2*(m-1)-2*g]):(Y=.5*(w(H+C)+w(H)),L=T?.5*(T(H+C)+T(H)):0),q+=(Y-L)*C,j[G+=1]=H,F[G]=F[2*(m-1)-2*g],G+=1;return[j,F,q]},riemannsum:function(c,m,v,_,f){return a.Z.deprecated("Numerics.riemannsum()","Numerics.riemann()"),this.riemann(c,m,v,_,f)[2]},rungeKutta:function(c,m,v,_,f){var g,C,P,w,T,L,Y=[],j=[],F=(v[1]-v[0])/_,G=v[0],H=m.length,q=[],K=0;for(X.Z.isString(c)&&(c=A[c]||A.euler),L=c.s,g=0;g<H;g++)Y[g]=m[g];for(C=0;C<_;C++){for(q[K]=[],g=0;g<H;g++)q[K][g]=Y[g];for(K+=1,w=[],P=0;P<L;P++){for(g=0;g<H;g++)j[g]=0;for(T=0;T<P;T++)for(g=0;g<H;g++)j[g]+=c.A[P][T]*F*w[T][g];for(g=0;g<H;g++)j[g]+=Y[g];w.push(f(G+c.c[P]*F,j))}for(g=0;g<H;g++)j[g]=0;for(T=0;T<L;T++)for(g=0;g<H;g++)j[g]+=c.b[T]*w[T][g];for(g=0;g<H;g++)Y[g]=Y[g]+F*j[g];G+=F}return q},maxIterationsRoot:80,maxIterationsMinimize:500,findBracket:function(c,m,v){var _,f,g,C,P,w,T,L,Y,j;if(X.Z.isArray(m))return m;for(_=m,g=c.call(v,_),j=(C=[_-.1*(f=_===0?1:_),_+.1*f,_-1,_+1,_-.5*f,_+.5*f,_-.6*f,_+.6*f,_-1*f,_+1*f,_-2*f,_+2*f,_-5*f,_+5*f,_-10*f,_+10*f,_-50*f,_+50*f,_-100*f,_+100*f]).length,Y=0;Y<j&&(P=C[Y],!(g*(w=c.call(v,P))<=0));Y++);return P<_&&(T=_,_=P,P=T,L=g,g=w,w=L),[_,g,P,w]},fzero:function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at=R.Z.eps,tt=this.maxIterationsRoot,Q=0;if(X.Z.isArray(m)){if(m.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");_=m[0],C=c.call(v,_),f=m[1],P=c.call(v,f)}else _=(T=this.findBracket(c,m,v))[0],C=T[1],f=T[2],P=T[3];if(Math.abs(C)<=at)return _;if(Math.abs(P)<=at)return f;if(C*P>0)return X.Z.isArray(m)?this.fminbr(c,[_,f],v):this.Newton(c,_,v);for(g=_,w=C;Q<tt;){if(L=f-_,Math.abs(w)<Math.abs(P)&&(_=f,f=g,g=_,C=P,P=w,w=C),G=2*at*Math.abs(f)+.5*at,K=.5*(g-f),Math.abs(K)<=G||Math.abs(P)<=at)return f;Math.abs(L)>=G&&Math.abs(C)>Math.abs(P)&&(j=g-f,_===g?(H=j*(Y=P/C),q=1-Y):(H=(F=P/C)*(j*(q=C/w)*(q-(Y=P/w))-(f-_)*(Y-1)),q=(q-1)*(Y-1)*(F-1)),H>0?q=-q:H=-H,H<.75*j*q-.5*Math.abs(G*q)&&H<Math.abs(L*q*.5)&&(K=H/q)),Math.abs(K)<G&&(K=K>0?G:-G),_=f,C=P,f+=K,((P=c.call(v,f))>0&&w>0||P<0&&w<0)&&(g=_,w=C),Q++}return f},chandrupatla:function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at,tt,Q,it,rt,dt=0,ht=this.maxIterationsRoot,ut=1+.001*Math.random(),_t=.5*ut,Dt=R.Z.eps;if(X.Z.isArray(m)){if(m.length<2)throw new Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");_=m[0],f=c.call(v,_),g=m[1],C=c.call(v,g)}else _=(P=this.findBracket(c,m,v))[0],f=P[1],g=P[2],C=P[3];if(f*C>0)return X.Z.isArray(m)?this.fminbr(c,[_,g],v):this.Newton(c,_,v);w=_,T=g,j=f,F=C;do{if(Y=w+_t*(T-w),H=c.call(v,Y),Math.sign(H)===Math.sign(j)?(L=w,w=Y,G=j,j=H):(L=T,T=w,G=F,F=j),q=w=Y,K=j=H,Math.abs(F)<Math.abs(j)&&(q=T,K=F),(at=(2*Dt*Math.abs(q)+5e-6)/Math.abs(T-w))>.5||K===0)break;tt=(w-T)/(L-T),Q=(j-F)/(G-F),it=1-Math.sqrt(1-tt),rt=Math.sqrt(tt),(_t=it<Q&&Q<rt?j/(F-j)*(G/(F-G))+j/(G-j)*(F/(G-F))*((L-w)/(T-w)):.5*ut)<at&&(_t=at),_t>1-at&&(_t=1-at),dt++}while(dt<=ht);return q},fminbr:function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F,G,H,q,K,at,tt=.5*(3-Math.sqrt(5)),Q=R.Z.eps,it=R.Z.eps,rt=this.maxIterationsMinimize,dt=0;if(!X.Z.isArray(m)||m.length<2)throw new Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(g=C=(_=m[0])+tt*((f=m[1])-_),P=C,w=T=c.call(v,C),L=T;dt<rt;){if(Y=f-_,j=.5*(_+f),F=it*Math.abs(g)+Q/3,Math.abs(g-j)+.5*Y<=2*F)return g;G=tt*(g<j?f-g:_-g),Math.abs(g-P)>=F&&(H=(g-C)*(q=(g-C)*(w-L))-(g-P)*(K=(g-P)*(w-T)),(q=2*(q-K))>0?H=-H:q=-q,Math.abs(H)<Math.abs(G*q)&&H>q*(_-g+2*F)&&H<q*(f-g-2*F)&&(G=H/q)),Math.abs(G)<F&&(G=G>0?F:-F),K=g+G,(at=c.call(v,K))<=w?(K<g?f=g:_=g,C=P,P=g,g=K,T=L,L=w,w=at):(K<g?_=K:f=K,at<=L||P===g?(C=P,P=K,T=L,L=at):(at<=T||C===g||C===P)&&(C=K,T=at)),dt+=1}return g},RamerDouglasPeucker:function(c,m){var v,_,f,g=[],C=[],P=function(w,T,L,Y,j){var F=function(H,q,K){var at,tt,Q,it,rt,dt,ht,ut,_t,Dt,Bt,Xt=1e4,$t=0,se=q;if(K-q<2)return[-1,0];if(Q=H[q].scrCoords,it=H[K].scrCoords,isNaN(Q[1])||isNaN(Q[2]))return[NaN,q];if(isNaN(it[1])||isNaN(it[2]))return[NaN,K];for(tt=q+1;tt<K;tt++){if(rt=H[tt].scrCoords,isNaN(rt[1])||isNaN(rt[2]))return[NaN,tt];dt=(dt=(dt=rt[1]-Q[1])==1/0?Xt:dt)===-1/0?-Xt:dt,ht=(ht=(ht=rt[2]-Q[2])==1/0?Xt:ht)===-1/0?-Xt:ht,(Dt=(ut=(ut=(ut=it[1]-Q[1])==1/0?Xt:ut)===-1/0?-Xt:ut)*ut+(_t=(_t=(_t=it[2]-Q[2])==1/0?Xt:_t)===-1/0?-Xt:_t)*_t)>=R.Z.eps?((Bt=(dt*ut+ht*_t)/Dt)<0?Bt=0:Bt>1&&(Bt=1),at=(dt-=Bt*ut)*dt+(ht-=Bt*_t)*ht):(Bt=0,at=dt*dt+ht*ht),at>$t&&($t=at,se=tt)}return[Math.sqrt($t),se]}(w,T,L),G=F[1];if(isNaN(F[0])){P(w,T,G-1,Y,j),j.push(w[G]);do++G;while(G<=L&&isNaN(w[G].scrCoords[1]+w[G].scrCoords[2]));G<=L&&j.push(w[G]),P(w,G+1,L,Y,j)}else F[0]>Y?(P(w,T,G,Y,j),P(w,G,L,Y,j)):j.push(w[L])};for(f=c.length,v=0;;){for(;v<f&&isNaN(c[v].scrCoords[1]+c[v].scrCoords[2]);)v+=1;for(_=v+1;_<f&&!isNaN(c[_].scrCoords[1]+c[_].scrCoords[2]);)_+=1;if(_--,v<f&&_>v&&((C=[])[0]=c[v],P(c,v,_,m,C),g=g.concat(C)),v>=f)break;_<f-1&&g.push(c[_+1]),v=_+1}return g},RamerDouglasPeuker:function(c,m){return a.Z.deprecated("Numerics.RamerDouglasPeuker()","Numerics.RamerDouglasPeucker()"),this.RamerDouglasPeucker(c,m)},Visvalingam:function(c,m){var v,_,f,g,C,P,w,T,L,Y=[],j=[],F=[];if((_=c.length)<=2)return c;for(Y[0]={used:!0,lft:null,node:null},C=0,v=1;v<_-1;v++)f=Math.abs(a.Z.Math.Numerics.det([c[v-1].usrCoords,c[v].usrCoords,c[v+1].usrCoords])),isNaN(f)||(L={v:f,idx:v},j.push(L),Y[v]={used:!0,lft:C,node:L},Y[C].rt=v,C=v);for(Y[_-1]={used:!0,rt:null,lft:C,node:null},Y[C].rt=_-1,g=-1/0;j.length>m;)j.sort(function(G,H){return H.v-G.v}),Y[v=j.pop().idx].used=!1,g=Y[v].node.v,C=Y[v].lft,P=Y[v].rt,Y[C].rt=P,Y[P].lft=C,(w=Y[C].lft)!==null&&(f=Math.abs(a.Z.Math.Numerics.det([c[w].usrCoords,c[C].usrCoords,c[P].usrCoords])),Y[C].node.v=f>=g?f:g),(T=Y[P].rt)!==null&&(f=Math.abs(a.Z.Math.Numerics.det([c[C].usrCoords,c[P].usrCoords,c[T].usrCoords])),Y[P].node.v=f>=g?f:g);F=[c[v=0]];do v=Y[v].rt,F.push(c[v]);while(Y[v].rt!==null);return F}};const E=R.Z.Numerics},309:(u,N,S)=>{S.d(N,{Z:()=>R});var a=S(765),X=S(275),B=S(109);X.Z.Statistics={sum:function(A){var E,c=A.length,m=0;for(E=0;E<c;E++)m+=A[E];return m},prod:function(A){var E,c=A.length,m=1;for(E=0;E<c;E++)m*=A[E];return m},mean:function(A){return A.length>0?this.sum(A)/A.length:0},median:function(A){var E,c;return A.length>0?(ArrayBuffer.isView(A)?(E=new Float64Array(A)).sort():(E=A.slice(0)).sort(function(m,v){return m-v}),1&(c=E.length)?E[parseInt(.5*c,10)]:.5*(E[.5*c-1]+E[.5*c])):0},percentile:function(A,E){var c,m,v,_,f,g=[];if(A.length>0){for(ArrayBuffer.isView(A)?(c=new Float64Array(A)).sort():(c=A.slice(0)).sort(function(C,P){return C-P}),m=c.length,_=B.Z.isArray(E)?E:[E],v=0;v<_.length;v++)f=m*_[v]*.01,parseInt(f,10)===f?g.push(.5*(c[f-1]+c[f])):g.push(c[parseInt(f,10)]);return B.Z.isArray(E)?g:g[0]}return 0},variance:function(A){var E,c,m,v=A.length;if(v>1){for(E=this.mean(A),c=0,m=0;m<v;m++)c+=(A[m]-E)*(A[m]-E);return c/(A.length-1)}return 0},sd:function(A){return Math.sqrt(this.variance(A))},weightedMean:function(A,E){if(A.length!==E.length)throw new Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return A.length>0?this.mean(this.multiply(A,E)):0},max:function(A){return Math.max.apply(this,A)},min:function(A){return Math.min.apply(this,A)},range:function(A){return[this.min(A),this.max(A)]},abs:function(A){var E,c,m;if(B.Z.isArray(A))if(A.map)m=A.map(Math.abs);else for(c=A.length,m=[],E=0;E<c;E++)m[E]=Math.abs(A[E]);else m=ArrayBuffer.isView(A)?A.map(Math.abs):Math.abs(A);return m},add:function(A,E){var c,m,v=[];if(A=B.Z.evalSlider(A),E=B.Z.evalSlider(E),B.Z.isArray(A)&&B.Z.isNumber(E))for(m=A.length,c=0;c<m;c++)v[c]=A[c]+E;else if(B.Z.isNumber(A)&&B.Z.isArray(E))for(m=E.length,c=0;c<m;c++)v[c]=A+E[c];else if(B.Z.isArray(A)&&B.Z.isArray(E))for(m=Math.min(A.length,E.length),c=0;c<m;c++)v[c]=A[c]+E[c];else v=A+E;return v},div:function(A,E){var c,m,v=[];if(A=B.Z.evalSlider(A),E=B.Z.evalSlider(E),B.Z.isArray(A)&&B.Z.isNumber(E))for(m=A.length,c=0;c<m;c++)v[c]=A[c]/E;else if(B.Z.isNumber(A)&&B.Z.isArray(E))for(m=E.length,c=0;c<m;c++)v[c]=A/E[c];else if(B.Z.isArray(A)&&B.Z.isArray(E))for(m=Math.min(A.length,E.length),c=0;c<m;c++)v[c]=A[c]/E[c];else v=A/E;return v},divide:function(){a.Z.deprecated("Statistics.divide()","Statistics.div()"),X.Z.Statistics.div.apply(X.Z.Statistics,arguments)},mod:function(A,E,c){var m,v,_=[],f=function(g,C){return g%C};if((c=B.Z.def(c,!1))&&(f=X.Z.mod),A=B.Z.evalSlider(A),E=B.Z.evalSlider(E),B.Z.isArray(A)&&B.Z.isNumber(E))for(v=A.length,m=0;m<v;m++)_[m]=f(A[m],E);else if(B.Z.isNumber(A)&&B.Z.isArray(E))for(v=E.length,m=0;m<v;m++)_[m]=f(A,E[m]);else if(B.Z.isArray(A)&&B.Z.isArray(E))for(v=Math.min(A.length,E.length),m=0;m<v;m++)_[m]=f(A[m],E[m]);else _=f(A,E);return _},multiply:function(A,E){var c,m,v=[];if(A=B.Z.evalSlider(A),E=B.Z.evalSlider(E),B.Z.isArray(A)&&B.Z.isNumber(E))for(m=A.length,c=0;c<m;c++)v[c]=A[c]*E;else if(B.Z.isNumber(A)&&B.Z.isArray(E))for(m=E.length,c=0;c<m;c++)v[c]=A*E[c];else if(B.Z.isArray(A)&&B.Z.isArray(E))for(m=Math.min(A.length,E.length),c=0;c<m;c++)v[c]=A[c]*E[c];else v=A*E;return v},subtract:function(A,E){var c,m,v=[];if(A=B.Z.evalSlider(A),E=B.Z.evalSlider(E),B.Z.isArray(A)&&B.Z.isNumber(E))for(m=A.length,c=0;c<m;c++)v[c]=A[c]-E;else if(B.Z.isNumber(A)&&B.Z.isArray(E))for(m=E.length,c=0;c<m;c++)v[c]=A-E[c];else if(B.Z.isArray(A)&&B.Z.isArray(E))for(m=Math.min(A.length,E.length),c=0;c<m;c++)v[c]=A[c]-E[c];else v=A-E;return v},TheilSenRegression:function(A){var E,c,m=[],v=[],_=[];for(E=0;E<A.length;E++){for(v.length=0,c=0;c<A.length;c++)Math.abs(A[c].usrCoords[1]-A[E].usrCoords[1])>X.Z.eps&&(v[c]=(A[c].usrCoords[2]-A[E].usrCoords[2])/(A[c].usrCoords[1]-A[E].usrCoords[1]));m[E]=this.median(v),_.push(A[E].usrCoords[2]-m[E]*A[E].usrCoords[1])}return[this.median(_),this.median(m),-1]},generateGaussian:function(A,E){var c,m,v;if(this.hasSpare)return this.hasSpare=!1,this.spare*E+A;do v=(c=2*Math.random()-1)*c+(m=2*Math.random()-1)*m;while(v>=1||v===0);return v=Math.sqrt(-2*Math.log(v)/v),this.spare=m*v,this.hasSpare=!0,A+E*c*v}};const R=X.Z.Statistics},766:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(351),B=S(275),R=S(327),A=S(109);a.Z.Options={jc:{enabled:!0,compile:!0},board:{boundingBox:[-5,5,5,-5],maxBoundingBox:[-1/0,1/0,1/0,-1/0],zoomFactor:1,zoomX:1,zoomY:1,title:"",description:"",showCopyright:!0,axis:!1,defaultAxes:{x:{name:"x",fixed:!0,ticks:{label:{visible:"inherit",anchorX:"middle",anchorY:"top",fontSize:12,offset:[0,-3]},tickEndings:[0,1],majorTickEndings:[1,1],drawZero:!1,needsRegularUpdate:!1,visible:"inherit"}},y:{name:"y",fixed:!0,ticks:{label:{visible:"inherit",anchorX:"right",anchorY:"middle",fontSize:12,offset:[-6,0]},tickEndings:[1,0],majorTickEndings:[1,1],drawZero:!1,needsRegularUpdate:!1,visible:"inherit"}}},showNavigation:!0,showZoom:!0,showReload:!1,showScreenshot:!1,screenshot:{scale:1,type:"png",symbol:"",css:"background-color:#eeeeee; opacity:1.0; border:2px solid black; border-radius:10px; text-align:center",cssButton:"padding: 4px 10px; border: solid #356AA0 1px; border-radius: 5px; position: absolute; right: 2ex; top: 2ex; background-color: rgba(255, 255, 255, 0.3);"},showFullscreen:!1,fullscreen:{symbol:'<svg height="1em" width="1em" version="1.1" viewBox="10 10 18 18"><path fill="#666" d="m 10,16 2,0 0,-4 4,0 0,-2 L 10,10 l 0,6 0,0 z"></path><path fill="#666" d="m 20,10 0,2 4,0 0,4 2,0 L 26,10 l -6,0 0,0 z"></path><path fill="#666" d="m 24,24 -4,0 0,2 L 26,26 l 0,-6 -2,0 0,4 0,0 z"></path><path fill="#666" d="M 12,20 10,20 10,26 l 6,0 0,-2 -4,0 0,-4 0,0 z"></path></svg>',scale:.85,id:null},showClearTraces:!1,keepAspectRatio:!1,ignoreLabels:!0,maxNameLength:1,document:!1,takeFirst:!1,takeSizeFromFile:!1,renderer:"auto",animationDelay:35,maxFrameRate:40,registerEvents:!0,registerResizeEvent:!0,registerFullscreenEvent:!0,minimizeReflow:"none",offsetX:0,offsetY:0,zoom:{enabled:!0,factorX:1.25,factorY:1.25,wheel:!0,needShift:!0,min:1e-4,max:1e4,pinchHorizontal:!0,pinchVertical:!0,pinchSensitivity:7},pan:{enabled:!0,needShift:!0,needTwoFingers:!1},browserPan:!1,drag:{enabled:!0},keyboard:{enabled:!0,dx:10,dy:10,panShift:!0,panCtrl:!1},resize:{enabled:!0,throttle:10},moveTarget:null,selection:{enabled:!1,name:"selectionPolygon",needShift:!1,needCtrl:!0,withLines:!1,vertices:{visible:!1},fillColor:"#ffff00",visible:!1},showInfobox:!0,logging:{enabled:!1}},navbar:{strokeColor:"#333333",fillColor:"transparent",highlightFillColor:"#aaaaaa",padding:"2px",position:"absolute",fontSize:"14px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",fillColor:R.Z.palette.red,highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,gradient:null,gradientSecondColor:"#ffffff",gradientSecondOpacity:1,gradientStartOffset:0,gradientEndOffset:1,gradientAngle:0,gradientCX:.5,gradientCY:.5,gradientR:.5,gradientFX:.5,gradientFY:.5,gradientFR:0,transitionDuration:100,transitionProperties:["fill","fill-opacity","stroke","stroke-opacity","stroke-width"],strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:{enabled:!1,color:[0,0,0],opacity:1,blur:3,blend:.1,offset:[5,5]},trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,rotatable:!0,dragToTopOfLayer:!1,precision:"inherit",draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1},isLabel:!1,tabindex:0},ticks:{generateLabelText:null,generateLabelValue:null,drawLabels:!1,label:{},beautifulScientificTickLabels:!1,useUnicodeMinus:!0,anchor:"left",drawZero:!1,insertTicks:!1,minTicksDistance:10,minorHeight:4,majorHeight:10,tickEndings:[1,1],majorTickEndings:[1,1],ignoreInfiniteTickEndings:!0,minorTicks:4,ticksPerLabel:!1,scale:1,scaleSymbol:"",labels:[],maxLabelLength:5,precision:3,digits:3,ticksDistance:1,face:"|",strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"none",highlightFillColor:"none",visible:"inherit",includeBoundaries:!1,type:"linear"},hatch:{drawLabels:!1,drawZero:!0,majorHeight:20,anchor:"middle",face:"|",strokeWidth:2,strokeColor:R.Z.palette.blue,ticksDistance:.2},precision:{touch:30,touchMax:100,mouse:4,pen:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,unused9:19,unused8:18,unused7:17,unused6:16,unused5:15,unused4:14,unused3:13,unused2:12,unused1:11,unused0:10,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,ticks:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:"auto",type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:R.Z.palette.orange,highlightFillColor:R.Z.palette.orange,strokeColor:R.Z.palette.orange,fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"#000000",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:R.Z.palette.blue},arc:{visible:!1,fillColor:"none"}},arc:{selection:"auto",hasInnerPoints:!1,label:{anchorX:"auto",anchorY:"auto"},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",useDirection:!1,center:{},radiusPoint:{},anglePoint:{}},arrow:{firstArrow:!1,lastArrow:{type:1,highlightSize:6,size:6}},axis:{name:"",needsRegularUpdate:!1,strokeWidth:1,lastArrow:{type:1,highlightSize:8,size:8},strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,margin:-4,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9],parse:!1,needsRegularUpdate:!1,display:"internal",visible:"inherit",layer:9},visible:"inherit",needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:5,minorHeight:10,majorHeight:-1,tickEndings:[0,1],majorTickEndings:[1,1],minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1,visible:!1},point2:{needsRegularUpdate:!1,visible:!1},tabindex:-1,label:{position:"lft",offset:[10,10]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"#000000"},line2:{strokeColor:"#000000"}},boxplot:{dir:"vertical",smallWidth:.5,strokeWidth:2,strokeColor:R.Z.palette.blue,fillColor:R.Z.palette.blue,fillOpacity:.2,highlightStrokeWidth:2,highlightStrokeColor:R.Z.palette.blue,highlightFillColor:R.Z.palette.blue,highlightFillOpacity:.1},button:{disabled:!1,display:"html"},cardinalspline:{createPoints:!0,isArrayOfCoordinates:!0,points:{strokeOpacity:.05,fillOpacity:.05,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1,fillOpacity:.6,withLines:!1,label:{}},checkbox:{disabled:!1,checked:!1,display:"html"},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,fillColor:R.Z.palette.red,strokeColor:R.Z.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:R.Z.palette.red,strokeColor:R.Z.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:R.Z.palette.yellow,highlightFillColor:R.Z.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",foci:{fixed:!1,visible:!1,withLabel:!1,name:""},center:{visible:!1,withLabel:!1,name:""},point:{withLabel:!1,name:""},line:{visible:!1}},curve:{strokeWidth:1,strokeColor:R.Z.palette.blue,fillColor:"none",fixed:!0,useQDT:!1,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,recursionDepthHigh:17,recursionDepthLow:15,doAdvancedPlotOld:!1,plotVersion:2,label:{position:"lft"},firstArrow:!1,lastArrow:!1},foreignobject:{attractors:[],fixed:!0,visible:!0},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#c0c0c0",strokeOpacity:.5,strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},group:{needsRegularUpdate:!0},htmlslider:{widthRange:100,widthOut:34,step:.01,frozen:!0,isLabel:!1,strokeColor:"#000000",display:"html",anchorX:"left",anchorY:"middle",withLabel:!1},image:{imageString:null,fillOpacity:1,highlightFillOpacity:.6,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0,snapSizeX:1,snapSizeY:1,attractors:[]},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",center:{visible:!1,fixed:!1,withLabel:!1,fillColor:R.Z.palette.red,strokeColor:R.Z.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",name:""}},inequality:{fillColor:R.Z.palette.red,fillOpacity:.2,strokeColor:"none",inverse:!1},infobox:{distanceX:-20,distanceY:25,fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0,parse:!1,transitionDuration:0,needsRegularUpdate:!1,tabindex:null},integral:{axis:"x",withLabel:!0,fixed:!0,strokeWidth:0,strokeOpacity:0,fillColor:R.Z.palette.red,fillOpacity:.3,highlightFillColor:R.Z.palette.red,highlightFillOpacity:.2,curveLeft:{visible:!0,withLabel:!1,color:R.Z.palette.red,fillOpacity:.8,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,withLabel:!1,color:R.Z.palette.red,fillOpacity:.8,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},input:{disabled:!1,maxlength:524288,display:"html"},intersection:{alwaysIntersect:!0},label:{visible:"inherit",strokeColor:"#000000",strokeOpacity:1,highlightStrokeOpacity:.666666,highlightStrokeColor:"#000000",fixed:!0,position:"urt",offset:[10,10],autoPosition:!1},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#c3d9ff","#4096EE","#008C00"],rowHeight:20,strokeWidth:5},line:{firstArrow:!1,lastArrow:!1,margin:0,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:R.Z.palette.blue,highlightStrokeColor:"#c3d9ff",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3,visible:"inherit"},label:{position:"llft"},snapToGrid:!1,snapSizeX:1,snapSizeY:1,touchFirstPoint:!1,touchLastPoint:!1,lineCap:"butt"},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},metapostspline:{createPoints:!0,isArrayOfCoordinates:!0,points:{strokeOpacity:.5,fillOpacity:.5,highlightStrokeOpacity:1,highlightFillOpacity:1,withLabel:!1,name:"",fixed:!1}},mirrorelement:{fixed:!0,point:{},center:{},type:"Euclidean"},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{position:"llft"}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,sizeUnit:"screen",strokeWidth:2,transitionProperties:["fill","fill-opacity","stroke","stroke-opacity","stroke-width","width","height","rx","ry"],fillColor:R.Z.palette.red,strokeColor:R.Z.palette.red,highlightFillColor:"#c3d9ff",highlightStrokeColor:"#c3d9ff",zoom:!1,showInfobox:"inherit",infoboxDigits:"auto",draft:!1,attractors:[],attractorUnit:"user",attractorDistance:0,snatchDistance:0,snapToGrid:!1,attractToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1,ignoredSnapToPoints:[]},polygon:{hasInnerPoints:!1,fillColor:R.Z.palette.yellow,highlightFillColor:R.Z.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"},visible:"inherit"},vertices:{layer:9,withLabel:!1,name:"",strokeColor:R.Z.palette.red,fillColor:R.Z.palette.red,fixed:!1,visible:"inherit"},label:{offset:[0,0]}},polygonalchain:{fillColor:"none",highlightFillColor:"none"},prescribedangle:{anglePoint:{size:2,visible:!1,withLabel:!1}},reflection:{fixed:!0,center:{},type:"Euclidean"},regularpolygon:{hasInnerPoints:!1,fillColor:R.Z.palette.yellow,highlightFillColor:R.Z.palette.yellow,fillOpacity:.3,highlightFillOpacity:.2,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5,label:{position:"top"}},vertices:{layer:9,withLabel:!0,strokeColor:R.Z.palette.red,fillColor:R.Z.palette.red,fixed:!1},label:{offset:[0,0]}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:R.Z.palette.yellow},sector:{fillColor:R.Z.palette.yellow,highlightFillColor:R.Z.palette.yellow,fillOpacity:.3,highlightFillOpacity:.3,highlightOnSector:!1,highlightStrokeWidth:0,selection:"auto",arc:{visible:!1,fillColor:"none"},radiusPoint:{visible:!1,withLabel:!1},center:{visible:!1,withLabel:!1},anglePoint:{visible:!1,withLabel:!1},label:{offset:[0,0],anchorX:"auto",anchorY:"auto"}},segment:{label:{position:"top"}},semicircle:{center:{visible:!1,withLabel:!1,fixed:!1,fillColor:R.Z.palette.red,strokeColor:R.Z.palette.red,highlightFillColor:"#eeeeee",highlightStrokeColor:R.Z.palette.red,name:""}},slider:{snapWidth:-1,precision:2,digits:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,suffixLabel:null,unitLabel:null,postLabel:null,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,visible:"inherit",fixed:!0,scalable:!1,tabindex:null,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,fixed:!0,drawLabels:!1,digits:2,includeBoundaries:1,drawZero:!0,label:{offset:[-4,-14],display:"internal"},minTicksDistance:30,insertTicks:!0,minorHeight:4,majorHeight:5,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,tickEndings:[0,1],majortickEndings:[0,1],strokeColor:"#000000",visible:"inherit"},highline:{strokeWidth:3,visible:"inherit",fixed:!0,tabindex:null,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{visible:"inherit",strokeColor:"#000000"},moveOnUp:!0},comb:{frequency:.2,width:.4,angle:Math.PI/3,reverse:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},curve:{strokeWidth:1,strokeColor:"#000000",fillColor:"none"}},slopetriangle:{fillColor:R.Z.palette.red,fillOpacity:.4,highlightFillColor:R.Z.palette.red,highlightFillOpacity:.3,borders:{lastArrow:{type:1,size:6}},glider:{fixed:!0,visible:!1,withLabel:!1},baseline:{visible:!1,withLabel:!1,name:""},basepoint:{visible:!1,withLabel:!1,name:""},tangent:{visible:!1,withLabel:!1,name:""},toppoint:{visible:!1,withLabel:!1,name:""},label:{visible:!0}},stepfunction:{},tapemeasure:{strokeColor:"#000000",strokeWidth:2,highlightStrokeColor:"#000000",withTicks:!0,withLabel:!0,precision:2,digits:2,point1:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},point2:{visible:"inherit",strokeColor:"#000000",fillColor:"#ffffff",fillOpacity:0,highlightFillOpacity:.1,size:6,snapToPoints:!0,attractorUnit:"screen",attractorDistance:20,showInfobox:!1,withLabel:!1,name:""},ticks:{drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:8,majorHeight:16,minorTicks:4,tickEndings:[0,1],majorTickEndings:[0,1],defaultDistance:.1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000",visible:"inherit"},label:{position:"top"}},text:{fontSize:12,fontUnit:"px",digits:2,parse:!0,useCaja:!1,isLabel:!1,strokeColor:"#000000",highlightStrokeColor:"#000000",highlightStrokeOpacity:.666666,cssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",highlightCssDefaultStyle:"font-family: Arial, Helvetica, Geneva, sans-serif;",cssStyle:"",highlightCssStyle:"",transitionProperties:["color","opacity"],useASCIIMathML:!1,useMathJax:!1,useKatex:!1,katexMacros:{},display:"html",anchor:null,anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",dragArea:"all",withLabel:!1,rotate:0,visible:!0,snapSizeX:1,snapSizeY:1,attractors:[]},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:R.Z.palette.red,lastArrow:!0}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},a.Z.Validator=function(){var c,m=function(w){return A.Z.isString(w)},v=function(w){return Math.abs(w-Math.round(w))<B.Z.eps},_=function(w){return v(w)&&w>0},f=function(w){return w>0},g=function(w){return w>=0},C={},P={attractorDistance:g,color:m,defaultDistance:A.Z.isNumber,display:function(w){return w==="html"||w==="internal"},doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:function(w){return A.Z.exists(a.Z.normalizePointFace(w))},factor:A.Z.isNumber,fillColor:m,fillOpacity:A.Z.isNumber,firstArrow:!1,fontSize:v,dash:v,gridX:A.Z.isNumber,gridY:A.Z.isNumber,hasGrid:!1,highlightFillColor:m,highlightFillOpacity:A.Z.isNumber,highlightStrokeColor:m,highlightStrokeOpacity:A.Z.isNumber,insertTicks:!1,lastArrow:!1,layer:function(w){return v(w)&&w>=0},majorHeight:v,minorHeight:v,minorTicks:g,minTicksDistance:_,numberPointsHigh:_,numberPointsLow:_,opacity:A.Z.isNumber,radius:A.Z.isNumber,RDPsmoothing:!1,renderer:function(w){return w==="vml"||w==="svg"||w==="canvas"||w==="no"},right:function(w){return/^[0-9]+px$/.test(w)},showCopyright:!1,showInfobox:!1,showNavigation:!1,size:g,snapSizeX:f,snapSizeY:f,snapWidth:A.Z.isNumber,snapToGrid:!1,snatchDistance:g,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:m,strokeOpacity:A.Z.isNumber,strokeWidth:g,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(c in P)P.hasOwnProperty(c)&&(C[c.toLowerCase()]=P[c]);return C}(),a.Z.normalizePointFace=function(c){return{cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",divide:"|","|":"|",minus:"-","-":"-",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"}[c]},a.Z.useStandardOptions=function(c){var m,v,_,f,g=a.Z.Options,C=c.hasGrid;for(m in c.options.grid.hasGrid=g.grid.hasGrid,c.options.grid.gridX=g.grid.gridX,c.options.grid.gridY=g.grid.gridY,c.options.grid.gridColor=g.grid.gridColor,c.options.grid.gridOpacity=g.grid.gridOpacity,c.options.grid.gridDash=g.grid.gridDash,c.options.grid.snapToGrid=g.grid.snapToGrid,c.options.grid.snapSizeX=g.grid.SnapSizeX,c.options.grid.snapSizeY=g.grid.SnapSizeY,c.takeSizeFromFile=g.takeSizeFromFile,f=function(P,w){P.visProp.fillcolor=w.fillColor,P.visProp.highlightfillcolor=w.highlightFillColor,P.visProp.strokecolor=w.strokeColor,P.visProp.highlightstrokecolor=w.highlightStrokeColor},c.objects)if(c.objects.hasOwnProperty(m))if((_=c.objects[m]).elementClass===X.Z.OBJECT_CLASS_POINT)f(_,g.point);else if(_.elementClass===X.Z.OBJECT_CLASS_LINE)for(f(_,g.line),v=0;v<_.ticks.length;v++)_.ticks[v].majorTicks=g.line.ticks.majorTicks,_.ticks[v].minTicksDistance=g.line.ticks.minTicksDistance,_.ticks[v].visProp.minorheight=g.line.ticks.minorHeight,_.ticks[v].visProp.majorheight=g.line.ticks.majorHeight;else _.elementClass===X.Z.OBJECT_CLASS_CIRCLE?f(_,g.circle):_.type===X.Z.OBJECT_TYPE_ANGLE?f(_,g.angle):_.type===X.Z.OBJECT_TYPE_ARC?f(_,g.arc):_.type===X.Z.OBJECT_TYPE_POLYGON?f(_,g.polygon):_.type===X.Z.OBJECT_TYPE_CONIC?f(_,g.conic):_.type===X.Z.OBJECT_TYPE_CURVE?f(_,g.curve):_.type===X.Z.OBJECT_TYPE_SECTOR&&(_.arc.visProp.fillcolor=g.sector.fillColor,_.arc.visProp.highlightfillcolor=g.sector.highlightFillColor,_.arc.visProp.fillopacity=g.sector.fillOpacity,_.arc.visProp.highlightfillopacity=g.sector.highlightFillOpacity);c.fullUpdate(),C&&!c.hasGrid?c.removeGrids(c):!C&&c.hasGrid&&c.create("grid",[])},a.Z.useBlackWhiteOptions=function(c){var m=a.Z.Options;m.point.fillColor=R.Z.rgb2bw(m.point.fillColor),m.point.highlightFillColor=R.Z.rgb2bw(m.point.highlightFillColor),m.point.strokeColor=R.Z.rgb2bw(m.point.strokeColor),m.point.highlightStrokeColor=R.Z.rgb2bw(m.point.highlightStrokeColor),m.line.fillColor=R.Z.rgb2bw(m.line.fillColor),m.line.highlightFillColor=R.Z.rgb2bw(m.line.highlightFillColor),m.line.strokeColor=R.Z.rgb2bw(m.line.strokeColor),m.line.highlightStrokeColor=R.Z.rgb2bw(m.line.highlightStrokeColor),m.circle.fillColor=R.Z.rgb2bw(m.circle.fillColor),m.circle.highlightFillColor=R.Z.rgb2bw(m.circle.highlightFillColor),m.circle.strokeColor=R.Z.rgb2bw(m.circle.strokeColor),m.circle.highlightStrokeColor=R.Z.rgb2bw(m.circle.highlightStrokeColor),m.arc.fillColor=R.Z.rgb2bw(m.arc.fillColor),m.arc.highlightFillColor=R.Z.rgb2bw(m.arc.highlightFillColor),m.arc.strokeColor=R.Z.rgb2bw(m.arc.strokeColor),m.arc.highlightStrokeColor=R.Z.rgb2bw(m.arc.highlightStrokeColor),m.polygon.fillColor=R.Z.rgb2bw(m.polygon.fillColor),m.polygon.highlightFillColor=R.Z.rgb2bw(m.polygon.highlightFillColor),m.sector.fillColor=R.Z.rgb2bw(m.sector.fillColor),m.sector.highlightFillColor=R.Z.rgb2bw(m.sector.highlightFillColor),m.curve.strokeColor=R.Z.rgb2bw(m.curve.strokeColor),m.grid.gridColor=R.Z.rgb2bw(m.grid.gridColor),a.Z.useStandardOptions(c)},a.Z.Options.normalizePointFace=a.Z.normalizePointFace;const E=a.Z.Options},632:(u,N,S)=>{S.d(N,{Z:()=>R});var a=S(765),X=S(351),B=S(109);a.Z.GeonextParser={replacePow:function(A){var E,c,m,v,_,f,g,C,P,w,T,L;for(w=(A=A.replace(/(\s*)\^(\s*)/g,"^")).indexOf("^"),v=-1;w>=0&&w<A.length-1;){if(v===w)throw new Error("JSXGraph: Error while parsing expression '"+A+"'");if(v=w,P=A.slice(0,w),T=A.slice(w+1),P.charAt(P.length-1)===")"){for(E=1,c=P.length-2;c>=0&&E>0;)(m=P.charAt(c))===")"?E++:m==="("&&(E-=1),c-=1;if(E!==0)throw new Error("JSXGraph: Missing '(' in expression");for(_="",g=P.substring(0,c+1),C=c;C>=0&&g.substr(C,1).match(/([\w.]+)/);)_=RegExp.$1+_,C-=1;_=(_+=P.substring(c+1,P.length)).replace(/([()+*%^\-/\][])/g,"\\$1")}else _="[\\w\\.]+";if(T.match(/^([\w.]*\()/)){for(E=1,c=RegExp.$1.length;c<T.length&&E>0;)(m=T.charAt(c))===")"?E-=1:m==="("&&(E+=1),c+=1;if(E!==0)throw new Error("JSXGraph: Missing ')' in expression");f=(f=T.substring(0,c)).replace(/([()+*%^\-/[\]])/g,"\\$1")}else f="[\\w\\.]+";L=new RegExp("("+_+")\\^("+f+")"),w=(A=A.replace(L,"pow($1,$2)")).indexOf("^")}return A},replaceIf:function(A){var E,c,m,v,_,f,g,C,P,w="",T=null,L=null,Y=null;if((m=A.indexOf("If("))<0)return A;for(A=A.replace(/""/g,"0");m>=0;){for(E=A.slice(0,m),c=A.slice(m+3),_=1,v=0,f=-1,g=-1;v<c.length&&_>0;)(C=c.charAt(v))===")"?_-=1:C==="("?_+=1:C===","&&_===1&&(f<0?f=v:g=v),v+=1;if(P=c.slice(0,v-1),c=c.slice(v),f<0||g<0)return"";T=P.slice(0,f),L=P.slice(f+1,g),Y=P.slice(g+1),w+=E+"(("+(T=this.replaceIf(T))+")?("+(L=this.replaceIf(L))+"):("+(Y=this.replaceIf(Y))+"))",T=null,L=null,m=(A=c).indexOf("If(")}return w+=c},replaceNameById:function(A,E,c){var m,v,_,f,g=0,C=["X","Y","L","V"],P=function(w){return c?"$('"+w+"')":w};for(f=0;f<C.length;f++)for(g=A.indexOf(C[f]+"(");g>=0;)g>=0&&(m=A.indexOf(")",g+2))>=0&&(v=(v=A.slice(g+2,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+2)+(c?"$('":"")+P(_.id)+A.slice(m))),m=A.indexOf(")",g+2),g=A.indexOf(C[f]+"(",m);for(g=A.indexOf("Dist(");g>=0;)g>=0&&(m=A.indexOf(",",g+5))>=0&&(v=(v=A.slice(g+5,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+5)+P(_.id)+A.slice(m))),m=A.indexOf(",",g+5),g=A.indexOf(",",m),(m=A.indexOf(")",g+1))>=0&&(v=(v=A.slice(g+1,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+1)+P(_.id)+A.slice(m))),m=A.indexOf(")",g+1),g=A.indexOf("Dist(",m);for(C=["Deg","Rad"],f=0;f<C.length;f++)for(g=A.indexOf(C[f]+"(");g>=0;)g>=0&&(m=A.indexOf(",",g+4))>=0&&(v=(v=A.slice(g+4,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+4)+P(_.id)+A.slice(m))),m=A.indexOf(",",g+4),g=A.indexOf(",",m),(m=A.indexOf(",",g+1))>=0&&(v=(v=A.slice(g+1,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+1)+P(_.id)+A.slice(m))),m=A.indexOf(",",g+1),g=A.indexOf(",",m),(m=A.indexOf(")",g+1))>=0&&(v=(v=A.slice(g+1,m)).replace(/\\(['"])?/g,"$1"),(_=E.elementsByName[v])&&(A=A.slice(0,g+1)+P(_.id)+A.slice(m))),m=A.indexOf(")",g+1),g=A.indexOf(C[f]+"(",m);return A},replaceIdByObj:function(A){var E=/(X|Y|L)\(([\w_]+)\)/g;return A=A.replace(E,"$('$2').$1()"),E=/(V)\(([\w_]+)\)/g,A=A.replace(E,"$('$2').Value()"),E=/(Dist)\(([\w_]+),([\w_]+)\)/g,A=A.replace(E,"dist($('$2'), $('$3'))"),E=/(Deg)\(([\w_]+),([ \w[\w_]+),([\w_]+)\)/g,A=A.replace(E,"deg($('$2'),$('$3'),$('$4'))"),E=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,A=A.replace(E,"rad($('$1'),$('$2'),$('$3'))"),E=/N\((.+)\)/g,A=A.replace(E,"($1)")},geonext2JS:function(A,E){var c,m,v,_=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],f=["abs","acos","asin","atan","ceil","cos","exp","factorial","floor","log","max","min","random","round","sin","sqrt","tan","ceil"];for(m=A=(A=(A=A.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),m=this.replaceNameById(m,E),m=this.replaceIf(m),m=this.replacePow(m),m=this.replaceIdByObj(m),v=0;v<_.length;v++)c=new RegExp(["(\\W|^)(",_[v],")"].join(""),"ig"),m=m.replace(c,["$1",f[v]].join(""));return m=(m=(m=(m=(m=m.replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")).replace(/Pi/g,"PI")).replace(/"/g,"'")},findDependencies:function(A,E,c){var m,v,_,f;for(v in B.Z.exists(c)||(c=A.board),m=c.elementsByName)m.hasOwnProperty(v)&&v!==A.name&&(m[v].elementClass===X.Z.OBJECT_CLASS_TEXT&&B.Z.evaluate(m[v].visProp.islabel)||(f=(f=v.replace(/\[/g,"\\[")).replace(/\]/g,"\\]"),_=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+f+")(,[\\w\\[\\]'_ ]+)*\\)","g"),E.search(_)>=0&&m[v].addChild(A)))},gxt2jc:function(A,E){var c;return c=A=(A=(A=A.replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&amp;/g,"&"),c=(c=(c=(c=this.replaceNameById(c,E,!0)).replace(/True/g,"true")).replace(/False/g,"false")).replace(/fasle/g,"false")}};const R=a.Z.GeonextParser},254:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _jxg__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(765),_base_constants__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(351),_base_text__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(573),_math_math__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(275),_math_ia__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(785),_math_geometry__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(922),_math_statistics__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(309),_utils_type__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(109),_utils_env__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(503);Object.create||(Object.create=function(u,N){if(typeof u!="object"&&typeof u!="function")throw new TypeError("Object prototype may only be an Object: "+u);if(u===null)throw new Error("This browser's implementation of Object.create is a shim and doesn't support 'null' as the first argument.");if(N!==void 0)throw new Error("This browser's implementation of Object.create is a shim and doesn't support a second argument.");function S(){}return S.prototype=u,new S});var priv={modules:{math:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z,"math/geometry":_math_geometry__WEBPACK_IMPORTED_MODULE_5__.Z,"math/statistics":_math_statistics__WEBPACK_IMPORTED_MODULE_6__.Z,"math/numerics":_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.Numerics}},r,_ccache;_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.JessieCode=function(u,N){this.scope={id:0,hasChild:!0,args:[],locals:{},context:null,previous:null},this.scopes=[],this.scopes.push(this.scope),this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.$log=[],this.builtIn=this.defineBuiltIn(),this.operands=this.getPossibleOperands(),this.board=null,this.lineToElement={},this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.CA&&(this.CA=new _jxg__WEBPACK_IMPORTED_MODULE_0__.Z.CA(this.node,this.createNode,this)),this.code="",typeof u=="string"&&this.parse(u,N)},_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.extend(_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.JessieCode.prototype,{node:function(u,N,S){return{type:u,value:N,children:S}},createNode:function(u,N,S){var a,X=this.node(u,N,[]);for(a=2;a<arguments.length;a++)X.children.push(arguments[a]);return X.type=="node_const"&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(X.value)&&(X.isMath=!0),X.line=this.parCurLine,X.col=this.parCurColumn,X},pushScope:function(u){var N={args:u,locals:{},context:null,previous:this.scope};return this.scope.hasChild=!0,this.scope=N,N.id=this.scopes.push(N)-1,N},popScope:function(){var u=this.scope.previous;return this.scope=u!==null?u:this.scope,this.scope},getElementById:function(u){return this.board.objects[u]},log:function(){this.$log.push(arguments),typeof console=="object"&&console.log&&console.log.apply(console,arguments)},creator:(_ccache={},(r=function(u){var N,S;return typeof _ccache[this.board.id+u]=="function"?N=_ccache[this.board.id+u]:(S=this,(N=function(a,X){var B;return(B=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(X)?X:{}).name===void 0&&B.id===void 0&&(B.name=S.lhs[S.scope.id]!==0?S.lhs[S.scope.id]:""),S.board.create(u,a,B)}).creator=!0,_ccache[this.board.id+u]=N),N}).clearCache=function(){_ccache={}},r),letvar:function(u,N){this.builtIn[u]&&this._warn('"'+u+'" is a predefined value.'),this.scope.locals[u]=N},isLocalVariable:function(u){for(var N=this.scope;N!==null;){if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(N.locals[u]))return N;N=N.previous}return null},isParameter:function(u){for(var N=this.scope;N!==null;){if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.indexOf(N.args,u)>-1)return N;N=N.previous}return null},isCreator:function(u){return!!_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.elements[u]},isMathMethod:function(u){return u!=="E"&&!!Math[u]},isBuiltIn:function(u){return!!this.builtIn[u]},getvar:function(u,N,S){var a;if(N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(N,!1),(a=this.isLocalVariable(u))!==null)return a.locals[u];if(u==="$board"||u==="EULER"||u==="PI")return this.builtIn[u];if(S){if(this.isBuiltIn(u))return this.builtIn[u];if(this.isMathMethod(u))return Math[u];if(this.isCreator(u))return this.creator(u)}return N||(a=this.board.select(u))===u?void 0:a},resolve:function(u){for(var N=this.scope;N!==null;){if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(N.locals[u]))return N.locals[u];N=N.previous}},getvarJS:function(u,N,S){var a,X="";return N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(N,!1),S=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(S,!1),this.isParameter(u)!==null?u:this.isLocalVariable(u)===null||S?this.isCreator(u)?"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(S?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+u+"'].concat([a, props])); })":(S&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isBuiltIn(u)?(X=this.builtIn[u].src||this.builtIn[u],_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(X)||X.match(/board\.select/)?X:(u=X.split(".").pop(),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(this.board.mathLib)&&(a=new RegExp("^Math."+u)).exec(X)!==null?X.replace(a,"$jc$.board.mathLib."+u):_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(this.board.mathLibJXG)&&(a=new RegExp("^JXG.Math.")).exec(X)!==null?X.replace(a,"$jc$.board.mathLibJXG."):X)):this.isMathMethod(u)?"$jc$.board.mathLib."+u:N?"":(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isId(this.board,u)?(X="$jc$.board.objects['"+u+"']",this.board.objects[u].elType==="slider"&&(X+=".Value()")):_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isName(this.board,u)?(X="$jc$.board.elementsByName['"+u+"']",this.board.elementsByName[u].elType==="slider"&&(X+=".Value()")):_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isGroup(this.board,u)&&(X="$jc$.board.groups['"+u+"']"),X)):"$jc$.resolve('"+u+"')"},makeMap:function(u){return u.isMap=!0,u},functionCodeJS:function(u){var N=u.children[0].join(", "),S="",a="";return u.value==="op_map"&&(S="{ return  ",a=" }"),"function ("+N+`) {
var $oldscope$ = $jc$.scope;
$jc$.scope = $jc$.scopes[`+this.scope.id+`];
var r = (function () `+S+this.compile(u.children[1],!0)+a+`)();
$jc$.scope = $oldscope$;
return r;
}`},defineFunction:function(node){var fun,i,that=this,list=node.children[0],scope=this.pushScope(list),_that;if(this.board.options.jc.compile){for(this.isLHS=!1,i=0;i<list.length;i++)scope.locals[list[i]]=list[i];this.replaceNames(node.children[1]),fun=function(jc){var fun,str="var f = function($jc$) { return "+jc.functionCodeJS(node)+"}; f;";try{for(fun=eval(str)(jc),scope.argtypes=[],i=0;i<list.length;i++)scope.argtypes.push(that.resolveType(list[i],node));return fun}catch(u){return jc._warn(`error compiling function

`+str+`

`+u.toString()),function(){}}}(this),this.popScope()}else fun=function(u,N,S){return function(){var a,X;for(X=N.scope,N.scope=N.scopes[S],a=0;a<u.length;a++)N.scope.locals[u[a]]=arguments[a];return a=N.execute(node.children[1]),N.scope=X,a}}(list,this,scope.id);return fun.node=node,fun.scope=scope,fun.toJS=fun.toString,fun.toString=(_that=this,function(){return _that.compile(_that.replaceIDs(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.deepCopy(node)))}),fun.deps={},this.collectDependencies(node.children[1],fun.deps),fun},mergeAttributes:function(u){var N,S={};for(N=0;N<arguments.length;N++)S=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.deepCopy(S,arguments[N],!0);return S},setProp:function(u,N,S){var a,X,B={};u.elementClass!==_base_constants__WEBPACK_IMPORTED_MODULE_1__.Z.OBJECT_CLASS_POINT||N!=="X"&&N!=="Y"?u.elementClass!==_base_constants__WEBPACK_IMPORTED_MODULE_1__.Z.OBJECT_CLASS_TEXT||N!=="X"&&N!=="Y"?u.type&&u.elementClass&&u.visProp?_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u[u.methodMap[N]])&&typeof u[u.methodMap[N]]!="function"?u[u.methodMap[N]]=S:(B[N]=S,u.setAttribute(B)):u[N]=S:(typeof S=="number"?u[N]=function(){return S}:typeof S=="function"?(u.isDraggable=!1,u[N]=S):typeof S=="string"&&(u.isDraggable=!1,u[N]=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.createFunction(S,this.board,null,!0),u[N+"jc"]=S),u[N].origin=S,this.board.update()):(N=N.toLowerCase(),u.isDraggable&&typeof S=="number"?(a=N==="x"?S:u.X(),X=N==="y"?S:u.Y(),u.setPosition(_base_constants__WEBPACK_IMPORTED_MODULE_1__.Z.COORDS_BY_USER,[a,X])):!u.isDraggable||typeof S!="function"&&typeof S!="string"?u.isDraggable||(a=N==="x"?S:u.XEval.origin,X=N==="y"?S:u.YEval.origin,u.addConstraint([a,X])):(a=N==="x"?S:u.coords.usrCoords[1],X=N==="y"?S:u.coords.usrCoords[2],u.addConstraint([a,X])),this.board.update())},_genericParse:function(u,N,S,a){var X,B,R,A,E=u.replace(/\r\n/g,`
`).split(`
`),c=[];a||(this.code+=u+`
`),_base_text__WEBPACK_IMPORTED_MODULE_2__.Z&&(B=_base_text__WEBPACK_IMPORTED_MODULE_2__.Z.prototype.setText,_base_text__WEBPACK_IMPORTED_MODULE_2__.Z.prototype.setText=_base_text__WEBPACK_IMPORTED_MODULE_2__.Z.prototype.setTextJessieCode);try{for(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(S)||(S=!1),X=0;X<E.length;X++)S&&(E[X]=_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.GeonextParser.geonext2JS(E[X],this.board)),c.push(E[X]);switch(u=c.join(`
`),R=parser.parse(u),this.CA&&(R=this.CA.expandDerivatives(R,null,R),R=this.CA.removeTrivialNodes(R)),N){case"parse":A=this.execute(R);break;case"manipulate":A=this.compile(R);break;case"getAst":A=R;break;default:A=!1}}catch(m){throw m}finally{_base_text__WEBPACK_IMPORTED_MODULE_2__.Z&&(_base_text__WEBPACK_IMPORTED_MODULE_2__.Z.prototype.setText=B)}return A},parse:function(u,N,S){return this._genericParse(u,"parse",N,S)},manipulate:function(u,N,S){return this._genericParse(u,"manipulate",N,S)},getAST:function(u,N,S){return this._genericParse(u,"getAst",N,S)},snippet:function(u,N,S,a){var X;return N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(N,!0),S=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(S,""),a=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(a,!1),X=(N?" function ("+S+") { return ":"")+u+(N?"; }":"")+";",this.parse(X,a,!0)},replaceIDs:function(u){var N,S;if(u.replaced&&(S=this.board.objects[u.children[1][0].value],_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(S)&&S.name!==""&&(u.type="node_var",u.value=S.name,u.children.length=0,delete u.replaced)),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u))for(N=0;N<u.length;N++)u[N]=this.replaceIDs(u[N]);if(u.children)for(N=u.children.length;N>0;N--)_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.children[N-1])&&(u.children[N-1]=this.replaceIDs(u.children[N-1]));return u},replaceNames:function(u){var N,S;if(S=u.value,u.type==="node_op"&&S==="op_lhs"&&u.children.length===1?this.isLHS=!0:u.type==="node_var"&&(this.isLHS?this.letvar(S,!0):!_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(this.getvar(S,!0))&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(this.board.elementsByName[S])&&(u=this.createReplacementNode(u))),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u))for(N=0;N<u.length;N++)u[N]=this.replaceNames(u[N]);if(u.children)for(N=u.children.length;N>0;N--)_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.children[N-1])&&(u.children[N-1]=this.replaceNames(u.children[N-1]));return u.type==="node_op"&&u.value==="op_lhs"&&u.children.length===1&&(this.isLHS=!1),u},createReplacementNode:function(u){var N=u.value,S=this.board.elementsByName[N];return(u=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),[this.createNode("node_str",S.id)])).replaced=!0,u},collectDependencies:function(u,N){var S,a,X,B;if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u))for(B=u.length,S=0;S<B;S++)this.collectDependencies(u[S],N);else if(a=u.value,u.type==="node_var"&&(X=this.getvar(a))&&X.visProp&&X.type&&X.elementClass&&X.id&&(N[X.id]=X),u.type==="node_op"&&u.value==="op_execfun"&&u.children.length>1&&u.children[0].value==="$"&&u.children[1].length>0&&(N[X=u.children[1][0].value]=this.board.objects[X]),u.children)for(S=u.children.length;S>0;S--)_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.children[S-1])&&this.collectDependencies(u.children[S-1],N)},resolveProperty:function(u,N,S){return S=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(S,!1),u&&u.methodMap&&(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.subs)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.subs[N])?u=u.subs:_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.methodMap[N])?N=u.methodMap[N]:(u=u.visProp,N=N.toLowerCase())),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isFunction(u)&&this._error("Accessing function properties is not allowed."),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u)||this._error(u+" is not an object"),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u[N])||this._error("unknown property "+N),S&&typeof u[N]=="function"?function(){return u[N].apply(u,arguments)}:u[N]},resolveType:function(u,N){var S,a;if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(N)){for(S=0;S<N.length;S++)if((a=this.resolveType(u,N[S]))!=="any")return a}if(N.type==="node_op"&&N.value==="op_execfun"&&N.children[0].type==="node_var"&&N.children[0].value===u)return"function";if(N.type==="node_op"){for(S=0;S<N.children.length;S++)if(N.children[0].type==="node_var"&&N.children[0].value===u&&(N.value==="op_add"||N.value==="op_sub"||N.value==="op_mul"||N.value==="op_div"||N.value==="op_mod"||N.value==="op_exp"||N.value==="op_neg"))return"any";for(S=0;S<N.children.length;S++)if((a=this.resolveType(u,N.children[S]))!=="any")return a}return"any"},getLHS:function(u){var N;if(u.type==="node_var")N={o:this.scope.locals,what:u.value};else if(u.type==="node_op"&&u.value==="op_property")N={o:this.execute(u.children[0]),what:u.children[1]};else{if(u.type!=="node_op"||u.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");N={o:this.execute(u.children[0]),what:this.execute(u.children[1])}}return N},getLHSCompiler:function(u,N){var S;if(u.type==="node_var")S=u.value;else if(u.type==="node_op"&&u.value==="op_property")S=[this.compile(u.children[0],N),"'"+u.children[1]+"'"];else{if(u.type!=="node_op"||u.value!=="op_extvalue")throw new Error("Syntax error: Invalid left-hand side of assignment.");S=[this.compile(u.children[0],N),u.children[1].type==="node_const"?u.children[1].value:this.compile(u.children[1],N)]}return S},execute:function(u){var N,S,a,X,B,R,A,E,c,m,v=[];if(N=0,!u)return N;switch(this.line=u.line,this.col=u.col,u.type){case"node_op":switch(u.value){case"op_none":u.children[0]&&this.execute(u.children[0]),u.children[1]&&(N=this.execute(u.children[1]));break;case"op_assign":S=this.getLHS(u.children[0]),this.lhs[this.scope.id]=S.what,S.o.type&&S.o.elementClass&&S.o.methodMap&&S.what==="label"&&this._error("Left-hand side of assignment is read-only."),N=this.execute(u.children[1]),S.o!==this.scope.locals||_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(S.o)&&typeof S.what=="number"?this.setProp(S.o,S.what,N):this.letvar(S.what,N),this.lhs[this.scope.id]=0;break;case"op_if":this.execute(u.children[0])&&(N=this.execute(u.children[1]));break;case"op_conditional":case"op_if_else":N=this.execute(u.children[0])?this.execute(u.children[1]):this.execute(u.children[2]);break;case"op_while":for(;this.execute(u.children[0]);)this.execute(u.children[1]);break;case"op_do":do this.execute(u.children[0]);while(this.execute(u.children[1]));break;case"op_for":for(this.execute(u.children[0]);this.execute(u.children[1]);this.execute(u.children[2]))this.execute(u.children[3]);break;case"op_proplst":u.children[0]&&this.execute(u.children[0]),u.children[1]&&this.execute(u.children[1]);break;case"op_emptyobject":N={};break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(u.children[0]),N=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][u.children[0]]=this.execute(u.children[1]);break;case"op_array":for(N=[],B=u.children[0].length,a=0;a<B;a++)N.push(this.execute(u.children[0][a]));break;case"op_extvalue":N=this.execute(u.children[0]),N=typeof(a=this.execute(u.children[1]))=="number"&&Math.abs(Math.round(a)-a)<_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.eps?N[a]:void 0;break;case"op_return":if(this.scope!==0)return this.execute(u.children[0]);this._error("Unexpected return.");break;case"op_map":u.children[1].isMath||u.children[1].type==="node_var"||this._error("execute: In a map only function calls and mathematical expressions are allowed."),(E=this.defineFunction(u)).isMap=!0,N=E;break;case"op_function":(E=this.defineFunction(u)).isMap=!1,N=E;break;case"op_execfun":if(this.dpstack.push([]),this.pscope++,R=u.children[1],_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.children[2]))if(u.children[3])for(A=u.children[2],c={},a=0;a<A.length;a++)c=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.deepCopy(c,this.execute(A[a]),!0);else c=this.execute(u.children[2]);for(u.children[0]._isFunctionName=!0,E=this.execute(u.children[0]),delete u.children[0]._isFunctionName,m=E&&E.sc?E.sc:this,!E.creator&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.children[2])&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),a=0;a<R.length;a++)_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(E.scope)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(E.scope.argtypes)&&E.scope.argtypes[a]==="function"?(R[a]._isFunctionName=!0,v[a]=this.execute(R[a]),delete R[a]._isFunctionName):v[a]=this.execute(R[a]),this.dpstack[this.pscope].push({line:u.children[1][a].line,col:u.children[1][a].ecol});if(typeof E!="function"||E.creator)if(typeof E=="function"&&E.creator){X=this.line;try{for((N=E(v,c)).jcLineStart=X,N.jcLineEnd=u.eline,a=X;a<=u.line;a++)this.lineToElement[a]=N;N.debugParents=this.dpstack[this.pscope]}catch(_){this._error(_.toString())}}else this._error("Function '"+E+"' is undefined.");else N=E.apply(m,v);this.dpstack.pop(),this.pscope--;break;case"op_property":X=this.execute(u.children[0]),S=u.children[1],N=this.resolveProperty(X,S,!1),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(N)&&(N.sc=X);break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),this.use(u.children[0].toString());break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),S=this.getvar(u.children[0]),N=this.del(S);break;case"op_eq":N=this.execute(u.children[0])==this.execute(u.children[1]);break;case"op_neq":N=this.execute(u.children[0])!=this.execute(u.children[1]);break;case"op_approx":N=Math.abs(this.execute(u.children[0])-this.execute(u.children[1]))<_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.eps;break;case"op_gt":N=this.execute(u.children[0])>this.execute(u.children[1]);break;case"op_lt":N=this.execute(u.children[0])<this.execute(u.children[1]);break;case"op_geq":N=this.execute(u.children[0])>=this.execute(u.children[1]);break;case"op_leq":N=this.execute(u.children[0])<=this.execute(u.children[1]);break;case"op_or":N=this.execute(u.children[0])||this.execute(u.children[1]);break;case"op_and":N=this.execute(u.children[0])&&this.execute(u.children[1]);break;case"op_not":N=!this.execute(u.children[0]);break;case"op_add":N=this.add(this.execute(u.children[0]),this.execute(u.children[1]));break;case"op_sub":N=this.sub(this.execute(u.children[0]),this.execute(u.children[1]));break;case"op_div":N=this.div(this.execute(u.children[0]),this.execute(u.children[1]));break;case"op_mod":N=this.mod(this.execute(u.children[0]),this.execute(u.children[1]),!0);break;case"op_mul":N=this.mul(this.execute(u.children[0]),this.execute(u.children[1]));break;case"op_exp":N=this.pow(this.execute(u.children[0]),this.execute(u.children[1]));break;case"op_neg":N=this.neg(this.execute(u.children[0]))}break;case"node_var":N=this.getvar(u.value,!1,u._isFunctionName);break;case"node_const":N=u.value===null?null:Number(u.value);break;case"node_const_bool":N=u.value;break;case"node_str":N=u.value.replace(/\\(.)/g,"$1")}return N},compile:function(u,N){var S,a,X,B="";if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(N)||(N=!1),!u)return B;switch(u.type){case"node_op":switch(u.value){case"op_none":u.children[0]&&(B=this.compile(u.children[0],N)),u.children[1]&&(B+=this.compile(u.children[1],N));break;case"op_assign":N?(S=this.getLHSCompiler(u.children[0],N),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(S)?B="$jc$.setProp("+S[0]+", "+S[1]+", "+this.compile(u.children[1],N)+`);
`:(this.isLocalVariable(S)!==this.scope&&(this.scope.locals[S]=!0),B="$jc$.scopes["+this.scope.id+"].locals['"+S+"'] = "+this.compile(u.children[1],N)+`;
`)):B=(S=this.compile(u.children[0]))+" = "+this.compile(u.children[1],N)+`;
`;break;case"op_if":B=" if ("+this.compile(u.children[0],N)+") "+this.compile(u.children[1],N);break;case"op_if_else":B=" if ("+this.compile(u.children[0],N)+")"+this.compile(u.children[1],N),B+=" else "+this.compile(u.children[2],N);break;case"op_conditional":B="(("+this.compile(u.children[0],N)+")?("+this.compile(u.children[1],N),B+="):("+this.compile(u.children[2],N)+"))";break;case"op_while":B=" while ("+this.compile(u.children[0],N)+`) {
`+this.compile(u.children[1],N)+`}
`;break;case"op_do":B=` do {
`+this.compile(u.children[0],N)+"} while ("+this.compile(u.children[1],N)+`);
`;break;case"op_for":B=" for ("+this.compile(u.children[0],N)+this.compile(u.children[1],N)+"; "+this.compile(u.children[2],N).slice(0,-2)+`) {
`+this.compile(u.children[3],N)+`
}
`;break;case"op_proplst":u.children[0]&&(B=this.compile(u.children[0],N)+", "),B+=this.compile(u.children[1],N);break;case"op_prop":B=u.children[0]+": "+this.compile(u.children[1],N);break;case"op_emptyobject":B=N?"{}":"<< >>";break;case"op_proplst_val":B=this.compile(u.children[0],N);break;case"op_array":for(X=[],a=0;a<u.children[0].length;a++)X.push(this.compile(u.children[0][a],N));B="["+X.join(", ")+"]";break;case"op_extvalue":B=this.compile(u.children[0],N)+"["+this.compile(u.children[1],N)+"]";break;case"op_return":B=" return "+this.compile(u.children[0],N)+`;
`;break;case"op_map":u.children[1].isMath||u.children[1].type==="node_var"||this._error("compile: In a map only function calls and mathematical expressions are allowed."),X=u.children[0],B=N?" $jc$.makeMap(function ("+X.join(", ")+") { return "+this.compile(u.children[1],N)+"; })":"map ("+X.join(", ")+") -> "+this.compile(u.children[1],N);break;case"op_function":X=u.children[0],this.pushScope(X),B=N?this.functionCodeJS(u):" function ("+X.join(", ")+") "+this.compile(u.children[1],N),this.popScope();break;case"op_execfunmath":console.log("op_execfunmath: TODO"),B="-1";break;case"op_execfun":if(u.children[2]){for(X=[],a=0;a<u.children[2].length;a++)X.push(this.compile(u.children[2][a],N));S=N?"$jc$.mergeAttributes("+X.join(", ")+")":X.join(", ")}for(u.children[0].withProps=!!u.children[2],X=[],a=0;a<u.children[1].length;a++)X.push(this.compile(u.children[1][a],N));B=this.compile(u.children[0],N)+"("+X.join(", ")+(u.children[2]&&N?", "+S:"")+")"+(u.children[2]&&!N?" "+S:""),N&&(B+=`
`),N&&u.children[0].value==="$"&&(B="$jc$.board.objects["+this.compile(u.children[1][0],N)+"]");break;case"op_property":B=N&&u.children[1]!=="X"&&u.children[1]!=="Y"?"$jc$.resolveProperty("+this.compile(u.children[0],N)+", '"+u.children[1]+"', true)":this.compile(u.children[0],N)+"."+u.children[1];break;case"op_use":this._warn("Use of the 'use' operator is deprecated."),B=N?"$jc$.use('":"use('",B+=u.children[0].toString()+"');";break;case"op_delete":this._warn("Use of the 'delete' operator is deprecated. Please use the remove() function."),B=N?"$jc$.del(":"remove(",B+=this.compile(u.children[0],N)+")";break;case"op_eq":B="("+this.compile(u.children[0],N)+" === "+this.compile(u.children[1],N)+")";break;case"op_neq":B="("+this.compile(u.children[0],N)+" !== "+this.compile(u.children[1],N)+")";break;case"op_approx":B="("+this.compile(u.children[0],N)+" ~= "+this.compile(u.children[1],N)+")";break;case"op_gt":B=N?"$jc$.gt("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" > "+this.compile(u.children[1],N)+")";break;case"op_lt":B=N?"$jc$.lt("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" < "+this.compile(u.children[1],N)+")";break;case"op_geq":B=N?"$jc$.geq("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" >= "+this.compile(u.children[1],N)+")";break;case"op_leq":B=N?"$jc$.leq("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" <= "+this.compile(u.children[1],N)+")";break;case"op_or":B="("+this.compile(u.children[0],N)+" || "+this.compile(u.children[1],N)+")";break;case"op_and":B="("+this.compile(u.children[0],N)+" && "+this.compile(u.children[1],N)+")";break;case"op_not":B="!("+this.compile(u.children[0],N)+")";break;case"op_add":B=N?"$jc$.add("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" + "+this.compile(u.children[1],N)+")";break;case"op_sub":B=N?"$jc$.sub("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" - "+this.compile(u.children[1],N)+")";break;case"op_div":B=N?"$jc$.div("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" / "+this.compile(u.children[1],N)+")";break;case"op_mod":B=N?"$jc$.mod("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+", true)":"("+this.compile(u.children[0],N)+" % "+this.compile(u.children[1],N)+")";break;case"op_mul":B=N?"$jc$.mul("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+" * "+this.compile(u.children[1],N)+")";break;case"op_exp":B=N?"$jc$.pow("+this.compile(u.children[0],N)+", "+this.compile(u.children[1],N)+")":"("+this.compile(u.children[0],N)+"^"+this.compile(u.children[1],N)+")";break;case"op_neg":B=N?"$jc$.neg("+this.compile(u.children[0],N)+")":"(-"+this.compile(u.children[0],N)+")"}break;case"node_var":B=N?this.getvarJS(u.value,!1,u.withProps):u.value;break;case"node_const":case"node_const_bool":B=u.value;break;case"node_str":B="'"+u.value+"'"}return u.needsBrackets&&(B=N?`{
`+B+`
}
`:"<< "+B+" >>"),B},getName:function(u,N){var S="";return _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.getName)?(S=u.getName(),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(S)&&S!==""||!N||(S=u.id)):N&&(S=u.id),S},X:function(u){return u.X()},Y:function(u){return u.Y()},V:function(u){return u.Value()},L:function(u){return u.L()},area:function(u){return _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.Area)||this._error("Error: Can't calculate area."),u.Area()},dist:function(u,N){return _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.Dist)||this._error("Error: Can't calculate distance."),u.Dist(N)},radius:function(u){return _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(u.Radius)||this._error("Error: Can't calculate radius."),u.Radius()},add:function(u,N){var S,a,X;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N))X=_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.add(u,N);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(N))for(a=Math.min(u.length,N.length),X=[],S=0;S<a;S++)X[S]=u[S]+N[S];else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)?X=u+N:_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isString(u)||_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isString(N)?X=u.toString()+N.toString():this._error("Operation + not defined on operands "+typeof u+" and "+typeof N);return X},sub:function(u,N){var S,a,X;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N))X=_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.sub(u,N);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(N))for(a=Math.min(u.length,N.length),X=[],S=0;S<a;S++)X[S]=u[S]-N[S];else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)?X=u-N:this._error("Operation - not defined on operands "+typeof u+" and "+typeof N);return X},neg:function(u){var N,S,a;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u))a=_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.negative(u);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u))for(S=u.length,a=[],N=0;N<S;N++)a[N]=-u[N];else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)?a=-u:this._error("Unary operation - not defined on operand "+typeof u);return a},mul:function(u,N){var S,a,X;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)&&(S=u,N=u=N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N))X=_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.mul(u,N);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(N))a=Math.min(u.length,N.length),X=_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.innerProduct(u,N,a);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(N))for(a=N.length,X=[],S=0;S<a;S++)X[S]=u*N[S];else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)?X=u*N:this._error("Operation * not defined on operands "+typeof u+" and "+typeof N);return X},div:function(u,N){var S,a,X;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N))X=_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.div(u,N);else if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N))for(a=u.length,X=[],S=0;S<a;S++)X[S]=u[S]/N;else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)?X=u/N:this._error("Operation * not defined on operands "+typeof u+" and "+typeof N);return X},mod:function(u,N){var S,a,X;if(u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N))return _math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.fmod(u,N);if(_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isArray(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N))for(a=u.length,X=[],S=0;S<a;S++)X[S]=_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.mod(u[S],N,!0);else _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(u)&&_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.isNumber(N)?X=_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.mod(u,N,!0):this._error("Operation * not defined on operands "+typeof u+" and "+typeof N);return X},pow:function(u,N){return u=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(u),N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.evalSlider(N),_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N)?_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.pow(u,N):_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.pow(u,N)},lt:function(u,N){return _math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N)?_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.lt(u,N):u<N},leq:function(u,N){return _math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N)?_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.leq(u,N):u<=N},gt:function(u,N){return _math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N)?_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.gt(u,N):u>N},geq:function(u,N){return _math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(u)||_math_ia__WEBPACK_IMPORTED_MODULE_4__.Z.isInterval(N)?Intervalt.geq(u,N):u>=N},randint:function(u,N,S){return _utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.exists(S)||(S=1),Math.round(Math.random()*(N-u)/S)*S+u},DDD:function(u){console.log("Dummy derivative function. This should never appear!")},ifthen:function(u,N,S){return u?N:S},del:function(u){typeof u=="object"&&_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(u.type)&&_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(u.elementClass)&&this.board.removeObject(u)},use:function(u){var N,S,a=!1;if(typeof u=="string"){for(N in _jxg__WEBPACK_IMPORTED_MODULE_0__.Z.boards)if(_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.boards.hasOwnProperty(N)&&_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.boards[N].container===u){S=_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.boards[N],a=!0;break}}else S=u,a=!0;a?(this.board=S,this.builtIn.$board=S,this.builtIn.$board.src="$jc$.board"):this._error("Board '"+u+"' not found!")},findSymbol:function(u,N){var S,a;for(a=(N=_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.def(N,-1))===-1?this.scope:this.scopes[N];a!==null;){for(S in a.locals)if(a.locals.hasOwnProperty(S)&&a.locals[S]===u)return[S,a];a=a.previous}return[]},importModule:function(u){return priv.modules[u.toLowerCase()]},defineBuiltIn:function(){var u=this,N={PI:Math.PI,EULER:Math.E,D:u.DDD,X:u.X,Y:u.Y,V:u.V,L:u.L,acosh:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.acosh,acot:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.acot,asinh:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.asinh,binomial:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.binomial,cbrt:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.cbrt,cosh:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.cosh,cot:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.cot,deg:_math_geometry__WEBPACK_IMPORTED_MODULE_5__.Z.trueAngle,A:u.area,area:u.area,dist:u.dist,R:u.radius,radius:u.radius,erf:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.erf,erfc:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.erfc,erfi:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.erfi,factorial:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.factorial,gcd:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.gcd,lb:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log2,lcm:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.lcm,ld:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log2,lg:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log10,ln:Math.log,log:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log,log10:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log10,log2:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.log2,ndtr:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.ndtr,ndtri:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.ndtri,nthroot:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.nthroot,pow:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.pow,rad:_math_geometry__WEBPACK_IMPORTED_MODULE_5__.Z.rad,ratpow:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.ratpow,trunc:_utils_type__WEBPACK_IMPORTED_MODULE_7__.Z.trunc,sinh:_math_math__WEBPACK_IMPORTED_MODULE_3__.Z.sinh,randint:u.randint,IfThen:u.ifthen,import:u.importModule,use:u.use,remove:u.del,$:u.getElementById,getName:u.getName,name:u.getName,$board:u.board,$log:u.log};return N.rad.sc=_math_geometry__WEBPACK_IMPORTED_MODULE_5__.Z,N.deg.sc=_math_geometry__WEBPACK_IMPORTED_MODULE_5__.Z,N.factorial.sc=_math_math__WEBPACK_IMPORTED_MODULE_3__.Z,N.X.src="$jc$.X",N.Y.src="$jc$.Y",N.V.src="$jc$.V",N.L.src="$jc$.L",N.acosh.src="JXG.Math.acosh",N.acot.src="JXG.Math.acot",N.asinh.src="JXG.Math.asinh",N.binomial.src="JXG.Math.binomial",N.cbrt.src="JXG.Math.cbrt",N.cot.src="JXG.Math.cot",N.cosh.src="JXG.Math.cosh",N.deg.src="JXG.Math.Geometry.trueAngle",N.erf.src="JXG.Math.erf",N.erfc.src="JXG.Math.erfc",N.erfi.src="JXG.Math.erfi",N.A.src="$jc$.area",N.area.src="$jc$.area",N.dist.src="$jc$.dist",N.R.src="$jc$.radius",N.radius.src="$jc$.radius",N.factorial.src="JXG.Math.factorial",N.gcd.src="JXG.Math.gcd",N.lb.src="JXG.Math.log2",N.lcm.src="JXG.Math.lcm",N.ld.src="JXG.Math.log2",N.lg.src="JXG.Math.log10",N.ln.src="Math.log",N.log.src="JXG.Math.log",N.log10.src="JXG.Math.log10",N.log2.src="JXG.Math.log2",N.ndtr.src="JXG.Math.ndtr",N.ndtri.src="JXG.Math.ndtri",N.nthroot.src="JXG.Math.nthroot",N.pow.src="JXG.Math.pow",N.rad.src="JXG.Math.Geometry.rad",N.ratpow.src="JXG.Math.ratpow",N.trunc.src="JXG.trunc",N.sinh.src="JXG.Math.sinh",N.randint.src="$jc$.randint",N.import.src="$jc$.importModule",N.use.src="$jc$.use",N.remove.src="$jc$.del",N.IfThen.src="$jc$.ifthen",N.$.src="(function (n) { return $jc$.board.select(n); })",N.getName.src="$jc$.getName",N.name.src="$jc$.getName",N.$board&&(N.$board.src="$jc$.board"),N.$log.src="$jc$.log",N},getPossibleOperands:function(){var u,N,S,a,X,B,R,A,E,c,m,v,_,f,g=["E"],C=this.defineBuiltIn(),P=Math;for(_=function(w,T){return w.toLowerCase().localeCompare(T.toLowerCase())},f=function(w,T){var L=null;if(T==="jc")L=C[w];else{if(T!=="Math")return;L=P[w]}if(!(g.indexOf(w)>=0))return _jxg__WEBPACK_IMPORTED_MODULE_0__.Z.isFunction(L)?{name:w,type:"function",numParams:L.length,origin:T}:_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.isNumber(L)?{name:w,type:"constant",value:L,origin:T}:void(L!==void 0&&console.error("undefined type",L))},u=Object.getOwnPropertyNames(C).sort(_),N=Object.getOwnPropertyNames(P).sort(_),S=[],a=0,X=0;a<u.length||X<N.length;)u[a]===N[X]?(B=f(N[X],"Math"),_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(B)&&S.push(B),a++,X++):!_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(N[X])||u[a].toLowerCase().localeCompare(N[X].toLowerCase())<0?(B=f(u[a],"jc"),_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(B)&&S.push(B),a++):(B=f(N[X],"Math"),_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.exists(B)&&S.push(B),X++);for(E=[],c=[],m=[],v={},R=S.length,a=0;a<R;a++){switch((A=S[a]).type){case"function":E.push(A.name),A.origin==="jc"&&c.push(A.name);break;case"constant":m.push(A.name)}v[A.name]=A}return{all:v,list:S,functions:E,functions_jessiecode:c,constants:m}},_debug:function(u){typeof console=="object"?console.log(u):_utils_env__WEBPACK_IMPORTED_MODULE_8__.Z.isBrowser&&document&&document.getElementById("debug")!==null&&(document.getElementById("debug").innerHTML+=u+"<br />")},_error:function(u){var N=new Error("Error("+this.line+"): "+u);throw N.line=this.line,N},_warn:function(u){typeof console=="object"?console.log("Warning("+this.line+"): "+u):_utils_env__WEBPACK_IMPORTED_MODULE_8__.Z.isBrowser&&document&&document.getElementById(this.warnLog)!==null&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+u+"<br />")},_log:function(u){typeof window!="object"&&typeof self=="object"&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+u.toString()}):console.log("Log: ",arguments)}});var parser=function(){var u=function(Ht,Ct,Mt,Ut){for(Mt=Mt||{},Ut=Ht.length;Ut--;Mt[Ht[Ut]]=Ct);return Mt},N=[2,14],S=[1,13],a=[1,37],X=[1,14],B=[1,15],R=[1,21],A=[1,16],E=[1,17],c=[1,33],m=[1,18],v=[1,19],_=[1,12],f=[1,59],g=[1,60],C=[1,58],P=[1,46],w=[1,48],T=[1,49],L=[1,50],Y=[1,51],j=[1,52],F=[1,53],G=[1,54],H=[1,45],q=[1,38],K=[1,39],at=[5,7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],tt=[5,7,8,12,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],Q=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],it=[2,48],rt=[1,72],dt=[10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,66,83,86],ht=[1,78],ut=[8,10,16,32,34,35,37,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],_t=[1,82],Dt=[8,10,16,32,34,35,37,39,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],Bt=[1,83],Xt=[1,84],$t=[1,85],se=[8,10,16,32,34,35,37,39,41,42,43,50,51,53,54,55,57,64,65,66,83,86],ae=[1,89],le=[1,90],he=[1,91],Gt=[1,92],oe=[1,97],_e=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,53,54,55,57,64,65,66,83,86],pe=[1,103],ge=[1,104],Ce=[8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,57,64,65,66,83,86],ye=[1,105],Pe=[1,106],Ee=[1,107],Re=[1,126],Ae=[1,139],Oe=[83,86],De=[1,150],Le=[10,66,86],ke=[8,10,16,20,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,82,83,86],Be=[1,167],Ie=[10,86],Se={trace:function(){},yy:{},symbols_:{error:2,Program:3,StatementList:4,EOF:5,IfStatement:6,IF:7,"(":8,Expression:9,")":10,Statement:11,ELSE:12,LoopStatement:13,WHILE:14,FOR:15,";":16,DO:17,UnaryStatement:18,USE:19,IDENTIFIER:20,DELETE:21,ReturnStatement:22,RETURN:23,EmptyStatement:24,StatementBlock:25,"{":26,"}":27,ExpressionStatement:28,AssignmentExpression:29,ConditionalExpression:30,LeftHandSideExpression:31,"=":32,LogicalORExpression:33,"?":34,":":35,LogicalANDExpression:36,"||":37,EqualityExpression:38,"&&":39,RelationalExpression:40,"==":41,"!=":42,"~=":43,AdditiveExpression:44,"<":45,">":46,"<=":47,">=":48,MultiplicativeExpression:49,"+":50,"-":51,UnaryExpression:52,"*":53,"/":54,"%":55,ExponentExpression:56,"^":57,"!":58,MemberExpression:59,CallExpression:60,PrimaryExpression:61,FunctionExpression:62,MapExpression:63,".":64,"[":65,"]":66,BasicLiteral:67,ObjectLiteral:68,ArrayLiteral:69,NullLiteral:70,BooleanLiteral:71,StringLiteral:72,NumberLiteral:73,NULL:74,TRUE:75,FALSE:76,STRING:77,NUMBER:78,NAN:79,INFINITY:80,ElementList:81,"<<":82,">>":83,PropertyList:84,Property:85,",":86,PropertyName:87,Arguments:88,AttributeList:89,Attribute:90,FUNCTION:91,ParameterDefinitionList:92,MAP:93,"->":94,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IF",8:"(",10:")",12:"ELSE",14:"WHILE",15:"FOR",16:";",17:"DO",19:"USE",20:"IDENTIFIER",21:"DELETE",23:"RETURN",26:"{",27:"}",32:"=",34:"?",35:":",37:"||",39:"&&",41:"==",42:"!=",43:"~=",45:"<",46:">",47:"<=",48:">=",50:"+",51:"-",53:"*",54:"/",55:"%",57:"^",58:"!",64:".",65:"[",66:"]",74:"NULL",75:"TRUE",76:"FALSE",77:"STRING",78:"NUMBER",79:"NAN",80:"INFINITY",82:"<<",83:">>",86:",",91:"FUNCTION",93:"MAP",94:"->"},productions_:[0,[3,2],[6,5],[6,7],[13,5],[13,9],[13,7],[18,2],[18,2],[22,2],[22,3],[24,1],[25,3],[4,2],[4,0],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[11,1],[28,2],[9,1],[29,1],[29,3],[30,1],[30,5],[33,1],[33,3],[36,1],[36,3],[38,1],[38,3],[38,3],[38,3],[40,1],[40,3],[40,3],[40,3],[40,3],[44,1],[44,3],[44,3],[49,1],[49,3],[49,3],[49,3],[56,1],[56,3],[52,1],[52,2],[52,2],[52,2],[31,1],[31,1],[59,1],[59,1],[59,1],[59,3],[59,4],[61,1],[61,1],[61,1],[61,1],[61,3],[67,1],[67,1],[67,1],[67,1],[70,1],[71,1],[71,1],[72,1],[73,1],[73,1],[73,1],[69,2],[69,3],[68,2],[68,3],[84,1],[84,3],[85,3],[87,1],[87,1],[87,1],[60,2],[60,3],[60,2],[60,4],[60,3],[88,2],[88,3],[89,1],[89,3],[90,1],[90,1],[81,1],[81,3],[62,4],[62,5],[63,5],[63,6],[92,1],[92,3]],performAction:function(Ht,Ct,Mt,Ut,Nt,ct,Zt){var st=ct.length-1;switch(Nt){case 1:return ct[st-1];case 2:this.$=St.createNode(xt(Zt[st-4]),"node_op","op_if",ct[st-2],ct[st]);break;case 3:this.$=St.createNode(xt(Zt[st-6]),"node_op","op_if_else",ct[st-4],ct[st-2],ct[st]);break;case 4:this.$=St.createNode(xt(Zt[st-4]),"node_op","op_while",ct[st-2],ct[st]);break;case 5:this.$=St.createNode(xt(Zt[st-8]),"node_op","op_for",ct[st-6],ct[st-4],ct[st-2],ct[st]);break;case 6:this.$=St.createNode(xt(Zt[st-6]),"node_op","op_do",ct[st-5],ct[st-2]);break;case 7:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_use",ct[st]);break;case 8:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_delete",ct[st]);break;case 9:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_return",void 0);break;case 10:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_return",ct[st-1]);break;case 11:case 14:this.$=St.createNode(xt(Zt[st]),"node_op","op_none");break;case 12:this.$=ct[st-1],this.$.needsBrackets=!0;break;case 13:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_none",ct[st-1],ct[st]);break;case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 23:case 24:case 26:case 28:case 30:case 32:case 36:case 41:case 44:case 48:case 50:case 52:case 54:case 55:case 56:case 58:case 62:case 81:case 84:case 85:case 86:this.$=ct[st];break;case 22:case 65:case 93:this.$=ct[st-1];break;case 25:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_assign",ct[st-2],ct[st]),this.$.isMath=!1;break;case 27:this.$=St.createNode(xt(Zt[st-4]),"node_op","op_conditional",ct[st-4],ct[st-2],ct[st]),this.$.isMath=!1;break;case 29:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_or",ct[st-2],ct[st]),this.$.isMath=!1;break;case 31:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_and",ct[st-2],ct[st]),this.$.isMath=!1;break;case 33:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_eq",ct[st-2],ct[st]),this.$.isMath=!1;break;case 34:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_neq",ct[st-2],ct[st]),this.$.isMath=!1;break;case 35:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_approx",ct[st-2],ct[st]),this.$.isMath=!1;break;case 37:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_lt",ct[st-2],ct[st]),this.$.isMath=!1;break;case 38:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_gt",ct[st-2],ct[st]),this.$.isMath=!1;break;case 39:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_leq",ct[st-2],ct[st]),this.$.isMath=!1;break;case 40:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_geq",ct[st-2],ct[st]),this.$.isMath=!1;break;case 42:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_add",ct[st-2],ct[st]),this.$.isMath=!0;break;case 43:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_sub",ct[st-2],ct[st]),this.$.isMath=!0;break;case 45:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_mul",ct[st-2],ct[st]),this.$.isMath=!0;break;case 46:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_div",ct[st-2],ct[st]),this.$.isMath=!0;break;case 47:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_mod",ct[st-2],ct[st]),this.$.isMath=!0;break;case 49:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_exp",ct[st-2],ct[st]),this.$.isMath=!0;break;case 51:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_not",ct[st]),this.$.isMath=!1;break;case 53:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_neg",ct[st]),this.$.isMath=!0;break;case 57:case 63:case 64:case 66:case 67:case 68:case 97:this.$=ct[st],this.$.isMath=!1;break;case 59:case 91:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_property",ct[st-2],ct[st]),this.$.isMath=!0;break;case 60:case 90:this.$=St.createNode(xt(Zt[st-3]),"node_op","op_extvalue",ct[st-3],ct[st-1]),this.$.isMath=!0;break;case 61:this.$=St.createNode(xt(Zt[st]),"node_var",ct[st]);break;case 69:this.$=ct[st],this.$.isMath=!0;break;case 70:this.$=St.createNode(xt(Zt[st]),"node_const",null);break;case 71:this.$=St.createNode(xt(Zt[st]),"node_const_bool",!0);break;case 72:this.$=St.createNode(xt(Zt[st]),"node_const_bool",!1);break;case 73:this.$=St.createNode(xt(Zt[st]),"node_str",ct[st].substring(1,ct[st].length-1));break;case 74:this.$=St.createNode(xt(Zt[st]),"node_const",parseFloat(ct[st]));break;case 75:this.$=St.createNode(xt(Zt[st]),"node_const",NaN);break;case 76:this.$=St.createNode(xt(Zt[st]),"node_const",1/0);break;case 77:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_array",[]);break;case 78:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_array",ct[st-1]);break;case 79:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_emptyobject",{}),this.$.needsBrackets=!0;break;case 80:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_proplst_val",ct[st-1]),this.$.needsBrackets=!0;break;case 82:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_proplst",ct[st-2],ct[st]);break;case 83:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_prop",ct[st-2],ct[st]);break;case 87:case 89:this.$=St.createNode(xt(Zt[st-1]),"node_op","op_execfun",ct[st-1],ct[st]),this.$.isMath=!0;break;case 88:this.$=St.createNode(xt(Zt[st-2]),"node_op","op_execfun",ct[st-2],ct[st-1],ct[st],!0),this.$.isMath=!1;break;case 92:this.$=[];break;case 94:case 98:case 104:this.$=[ct[st]];break;case 95:case 99:case 105:this.$=ct[st-2].concat(ct[st]);break;case 96:this.$=St.createNode(xt(Zt[st]),"node_var",ct[st]),this.$.isMath=!0;break;case 100:this.$=St.createNode(xt(Zt[st-3]),"node_op","op_function",[],ct[st]),this.$.isMath=!1;break;case 101:this.$=St.createNode(xt(Zt[st-4]),"node_op","op_function",ct[st-2],ct[st]),this.$.isMath=!1;break;case 102:this.$=St.createNode(xt(Zt[st-4]),"node_op","op_map",[],ct[st]);break;case 103:this.$=St.createNode(xt(Zt[st-5]),"node_op","op_map",ct[st-3],ct[st])}},table:[u([5,7,8,14,15,16,17,19,20,21,23,26,50,51,58,65,74,75,76,77,78,79,80,82,91,93],N,{3:1,4:2}),{1:[3]},{5:[1,3],6:6,7:S,8:a,9:20,11:4,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{1:[2,1]},u(at,[2,13]),u(tt,[2,15]),u(tt,[2,16]),u(tt,[2,17]),u(tt,[2,18]),u(tt,[2,19]),u(tt,[2,20]),u(tt,[2,21]),u([7,8,14,15,16,17,19,20,21,23,26,27,50,51,58,65,74,75,76,77,78,79,80,82,91,93],N,{4:61}),{8:[1,62]},{8:[1,63]},{8:[1,64]},{6:6,7:S,8:a,9:20,11:65,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{20:[1,66]},{20:[1,67]},{8:a,9:69,16:[1,68],20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{16:[1,70]},u(tt,[2,11]),u(Q,[2,23]),u(Q,[2,24]),u([8,10,16,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],it,{32:[1,71],57:rt}),u([8,10,16,32,35,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83,86],[2,26],{34:[1,73],37:[1,74]}),u(dt,[2,54],{88:77,8:ht,64:[1,75],65:[1,76]}),u(dt,[2,55],{88:79,8:ht,64:[1,81],65:[1,80]}),u(ut,[2,28],{39:_t}),u(Q,[2,56]),u(Q,[2,57]),u(Q,[2,58]),u(Dt,[2,30],{41:Bt,42:Xt,43:$t}),u(Q,[2,61]),u(Q,[2,62]),u(Q,[2,63]),u(Q,[2,64]),{8:a,9:86,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:[1,87]},{8:[1,88]},u(se,[2,32],{45:ae,46:le,47:he,48:Gt}),u(Q,[2,66]),u(Q,[2,67]),u(Q,[2,68]),u(Q,[2,69]),{20:oe,72:98,73:99,77:Y,78:j,79:F,80:G,83:[1,93],84:94,85:95,87:96},{8:a,20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,66:[1,100],67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,81:101,82:H,91:q,93:K},u(_e,[2,36],{50:pe,51:ge}),u(Q,[2,70]),u(Q,[2,71]),u(Q,[2,72]),u(Q,[2,73]),u(Q,[2,74]),u(Q,[2,75]),u(Q,[2,76]),u(Ce,[2,41],{53:ye,54:Pe,55:Ee}),u(Q,[2,44]),u(Q,[2,50]),{8:a,20:c,31:109,50:f,51:g,52:108,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:110,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:111,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{6:6,7:S,8:a,9:20,11:4,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,27:[1,112],28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:113,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:114,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:115,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{14:[1,116]},u(tt,[2,7]),u(tt,[2,8]),u(tt,[2,9]),{16:[1,117]},u(tt,[2,22]),{8:a,20:c,29:118,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:119,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,29:120,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,36:121,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{20:[1,122]},{8:a,9:123,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Q,[2,87],{89:124,90:125,68:127,20:Re,82:H}),{8:a,10:[1,128],20:c,29:102,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,81:129,82:H,91:q,93:K},u(Q,[2,89]),{8:a,9:130,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{20:[1,131]},{8:a,20:c,31:109,38:132,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,40:133,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,40:134,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,40:135,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{10:[1,136]},{10:[1,137],20:Ae,92:138},{10:[1,140],20:Ae,92:141},{8:a,20:c,31:109,44:142,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,44:143,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,44:144,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,44:145,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Q,[2,79]),{83:[1,146],86:[1,147]},u(Oe,[2,81]),{35:[1,148]},{35:[2,84]},{35:[2,85]},{35:[2,86]},u(Q,[2,77]),{66:[1,149],86:De},u(Le,[2,98]),{8:a,20:c,31:109,49:151,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,49:152,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:153,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:154,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,31:109,50:f,51:g,52:155,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Q,[2,51]),u([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,64,65,66,83,86],it,{57:rt}),u(Q,[2,52]),u(Q,[2,53]),u([5,7,8,10,12,14,15,16,17,19,20,21,23,26,27,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,58,64,65,66,74,75,76,77,78,79,80,82,83,86,91,93],[2,12]),{10:[1,156]},{10:[1,157]},{16:[1,158]},{8:[1,159]},u(tt,[2,10]),u(Q,[2,25]),u(Q,[2,49]),{35:[1,160]},u(ut,[2,29],{39:_t}),u(Q,[2,59]),{66:[1,161]},u([8,10,16,32,34,35,37,39,41,42,43,45,46,47,48,50,51,53,54,55,57,64,65,66,83],[2,88],{86:[1,162]}),u(Q,[2,94]),u(Q,[2,96]),u(Q,[2,97]),u(ke,[2,92]),{10:[1,163],86:De},{66:[1,164]},u(Q,[2,91]),u(Dt,[2,31],{41:Bt,42:Xt,43:$t}),u(se,[2,33],{45:ae,46:le,47:he,48:Gt}),u(se,[2,34],{45:ae,46:le,47:he,48:Gt}),u(se,[2,35],{45:ae,46:le,47:he,48:Gt}),u(Q,[2,65]),{25:165,26:_},{10:[1,166],86:Be},u(Ie,[2,104]),{94:[1,168]},{10:[1,169],86:Be},u(_e,[2,37],{50:pe,51:ge}),u(_e,[2,38],{50:pe,51:ge}),u(_e,[2,39],{50:pe,51:ge}),u(_e,[2,40],{50:pe,51:ge}),u(Q,[2,80]),{20:oe,72:98,73:99,77:Y,78:j,79:F,80:G,85:170,87:96},{8:a,20:c,29:171,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Q,[2,78]),{8:a,20:c,29:172,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Ce,[2,42],{53:ye,54:Pe,55:Ee}),u(Ce,[2,43],{53:ye,54:Pe,55:Ee}),u(Q,[2,45]),u(Q,[2,46]),u(Q,[2,47]),{6:6,7:S,8:a,9:20,11:173,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{6:6,7:S,8:a,9:20,11:174,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:175,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:176,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,20:c,29:177,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(Q,[2,60]),{20:Re,68:127,82:H,90:178},u(ke,[2,93]),u(Q,[2,90]),u(Q,[2,100]),{25:179,26:_},{20:[1,180]},{8:a,9:181,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{94:[1,182]},u(Oe,[2,82]),u(Oe,[2,83]),u(Le,[2,99]),u(at,[2,2],{12:[1,183]}),u(tt,[2,4]),{16:[1,184]},{10:[1,185]},u(Q,[2,27]),u(Q,[2,95]),u(Q,[2,101]),u(Ie,[2,105]),u(Q,[2,102]),{8:a,9:186,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{6:6,7:S,8:a,9:20,11:187,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{8:a,9:188,20:c,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},{16:[1,189]},u(Q,[2,103]),u(tt,[2,3]),{10:[1,190]},u(tt,[2,6]),{6:6,7:S,8:a,9:20,11:191,13:7,14:X,15:B,16:R,17:A,18:8,19:E,20:c,21:m,22:9,23:v,24:11,25:5,26:_,28:10,29:22,30:23,31:24,33:25,36:28,38:32,40:40,44:47,49:55,50:f,51:g,52:56,56:57,58:C,59:26,60:27,61:29,62:30,63:31,65:P,67:34,68:35,69:36,70:41,71:42,72:43,73:44,74:w,75:T,76:L,77:Y,78:j,79:F,80:G,82:H,91:q,93:K},u(tt,[2,5])],defaultActions:{3:[2,1],97:[2,84],98:[2,85],99:[2,86]},parseError:function(Ht,Ct){if(!Ct.recoverable){var Mt=new Error(Ht);throw Mt.hash=Ct,Mt}this.trace(Ht)},parse:function(Ht){var Ct=this,Mt=[0],Ut=[null],Nt=[],ct=this.table,Zt="",st=0,Ye=0,ze=0,He=2,je=1,We=Nt.slice.call(arguments,1),Qt=Object.create(this.lexer),ue={yy:{}};for(var we in this.yy)Object.prototype.hasOwnProperty.call(this.yy,we)&&(ue.yy[we]=this.yy[we]);Qt.setInput(Ht,ue.yy),ue.yy.lexer=Qt,ue.yy.parser=this,Qt.yylloc===void 0&&(Qt.yylloc={});var Te=Qt.yylloc;Nt.push(Te);var Ve=Qt.options&&Qt.options.ranges;typeof ue.yy.parseError=="function"?this.parseError=ue.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var re,Me,de,ne,Xe,be,ce,Ue,Ze,qe=function(){var ve;return typeof(ve=Qt.lex()||je)!="number"&&(ve=Ct.symbols_[ve]||ve),ve},fe={};;){if(de=Mt[Mt.length-1],this.defaultActions[de]?ne=this.defaultActions[de]:(re==null&&(re=qe()),ne=ct[de]&&ct[de][re]),ne===void 0||!ne.length||!ne[0]){var Fe="";for(be in Ze=[],ct[de])this.terminals_[be]&&be>He&&Ze.push("'"+this.terminals_[be]+"'");Fe=Qt.showPosition?"Parse error on line "+(st+1)+`:
`+Qt.showPosition()+`
Expecting `+Ze.join(", ")+", got '"+(this.terminals_[re]||re)+"'":"Parse error on line "+(st+1)+": Unexpected "+(re==je?"end of input":"'"+(this.terminals_[re]||re)+"'"),this.parseError(Fe,{text:Qt.match,token:this.terminals_[re]||re,line:Qt.yylineno,loc:Te,expected:Ze})}if(ne[0]instanceof Array&&ne.length>1)throw new Error("Parse Error: multiple actions possible at state: "+de+", token: "+re);switch(ne[0]){case 1:Mt.push(re),Ut.push(Qt.yytext),Nt.push(Qt.yylloc),Mt.push(ne[1]),re=null,Me?(re=Me,Me=null):(Ye=Qt.yyleng,Zt=Qt.yytext,st=Qt.yylineno,Te=Qt.yylloc,ze>0);break;case 2:if(ce=this.productions_[ne[1]][1],fe.$=Ut[Ut.length-ce],fe._$={first_line:Nt[Nt.length-(ce||1)].first_line,last_line:Nt[Nt.length-1].last_line,first_column:Nt[Nt.length-(ce||1)].first_column,last_column:Nt[Nt.length-1].last_column},Ve&&(fe._$.range=[Nt[Nt.length-(ce||1)].range[0],Nt[Nt.length-1].range[1]]),(Xe=this.performAction.apply(fe,[Zt,Ye,st,ue.yy,ne[1],Ut,Nt].concat(We)))!==void 0)return Xe;ce&&(Mt=Mt.slice(0,-1*ce*2),Ut=Ut.slice(0,-1*ce),Nt=Nt.slice(0,-1*ce)),Mt.push(this.productions_[ne[1]][0]),Ut.push(fe.$),Nt.push(fe._$),Ue=ct[Mt[Mt.length-2]][Mt[Mt.length-1]],Mt.push(Ue);break;case 3:return!0}}return!0}},St={node:function(Ht,Ct,Mt){return{type:Ht,value:Ct,children:Mt}},createNode:function(Ht,Ct,Mt,Ut){var Nt,ct=this.node(Ct,Mt,[]);for(Nt=3;Nt<arguments.length;Nt++)ct.children.push(arguments[Nt]);return ct.line=Ht[0],ct.col=Ht[1],ct.eline=Ht[2],ct.ecol=Ht[3],ct}},xt=function(Ht){return[Ht.first_line,Ht.first_column,Ht.last_line,Ht.last_column]},Ge=function(){var Ht={EOF:1,parseError:function(Ct,Mt){if(!this.yy.parser)throw new Error(Ct);this.yy.parser.parseError(Ct,Mt)},setInput:function(Ct,Mt){return this.yy=Mt||this.yy||{},this._input=Ct,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var Ct=this._input[0];return this.yytext+=Ct,this.yyleng++,this.offset++,this.match+=Ct,this.matched+=Ct,Ct.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),Ct},unput:function(Ct){var Mt=Ct.length,Ut=Ct.split(/(?:\r\n?|\n)/g);this._input=Ct+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Mt),this.offset-=Mt;var Nt=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Ut.length-1&&(this.yylineno-=Ut.length-1);var ct=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Ut?(Ut.length===Nt.length?this.yylloc.first_column:0)+Nt[Nt.length-Ut.length].length-Ut[0].length:this.yylloc.first_column-Mt},this.options.ranges&&(this.yylloc.range=[ct[0],ct[0]+this.yyleng-Mt]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(Ct){this.unput(this.match.slice(Ct))},pastInput:function(){var Ct=this.matched.substr(0,this.matched.length-this.match.length);return(Ct.length>20?"...":"")+Ct.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var Ct=this.match;return Ct.length<20&&(Ct+=this._input.substr(0,20-Ct.length)),(Ct.substr(0,20)+(Ct.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var Ct=this.pastInput(),Mt=new Array(Ct.length+1).join("-");return Ct+this.upcomingInput()+`
`+Mt+"^"},test_match:function(Ct,Mt){var Ut,Nt,ct;if(this.options.backtrack_lexer&&(ct={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ct.yylloc.range=this.yylloc.range.slice(0))),(Nt=Ct[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=Nt.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Nt?Nt[Nt.length-1].length-Nt[Nt.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+Ct[0].length},this.yytext+=Ct[0],this.match+=Ct[0],this.matches=Ct,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(Ct[0].length),this.matched+=Ct[0],Ut=this.performAction.call(this,this.yy,this,Mt,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Ut)return Ut;if(this._backtrack){for(var Zt in ct)this[Zt]=ct[Zt];return!1}return!1},next:function(){if(this.done)return this.EOF;var Ct,Mt,Ut,Nt;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var ct=this._currentRules(),Zt=0;Zt<ct.length;Zt++)if((Ut=this._input.match(this.rules[ct[Zt]]))&&(!Mt||Ut[0].length>Mt[0].length)){if(Mt=Ut,Nt=Zt,this.options.backtrack_lexer){if((Ct=this.test_match(Ut,ct[Zt]))!==!1)return Ct;if(this._backtrack){Mt=!1;continue}return!1}if(!this.options.flex)break}return Mt?(Ct=this.test_match(Mt,ct[Nt]))!==!1&&Ct:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Ct=this.next();return Ct||this.lex()},begin:function(Ct){this.conditionStack.push(Ct)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Ct){return(Ct=this.conditionStack.length-1-Math.abs(Ct||0))>=0?this.conditionStack[Ct]:"INITIAL"},pushState:function(Ct){this.begin(Ct)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Ct,Mt,Ut,Nt){switch(Ut){case 0:case 5:case 6:break;case 1:case 2:return 78;case 3:case 4:return 77;case 7:return 7;case 8:return 12;case 9:return 14;case 10:return 17;case 11:return 15;case 12:return 91;case 13:return 93;case 14:return 19;case 15:return 23;case 16:return 21;case 17:return 75;case 18:return 76;case 19:return 74;case 20:return 80;case 21:case 22:return 94;case 23:return 82;case 24:return 83;case 25:return 26;case 26:return 27;case 27:return 16;case 28:return"#";case 29:return 34;case 30:return 35;case 31:return 79;case 32:return 64;case 33:return 65;case 34:return 66;case 35:return 8;case 36:return 10;case 37:return 58;case 38:return 57;case 39:return 53;case 40:return 54;case 41:return 55;case 42:return 50;case 43:return 51;case 44:return 47;case 45:return 45;case 46:return 48;case 47:return 46;case 48:return 41;case 49:return 43;case 50:return 42;case 51:return 39;case 52:return 37;case 53:return 32;case 54:return 86;case 55:return 5;case 56:return 20;case 57:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:[0-9]+\.[0-9]*|[0-9]*\.[0-9]+\b)/,/^(?:[0-9]+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:\/\/.*)/,/^(?:\/\*(.|\n|\r)*?\*\/)/,/^(?:if\b)/,/^(?:else\b)/,/^(?:while\b)/,/^(?:do\b)/,/^(?:for\b)/,/^(?:function\b)/,/^(?:map\b)/,/^(?:use\b)/,/^(?:return\b)/,/^(?:delete\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:Infinity\b)/,/^(?:->)/,/^(?:=>)/,/^(?:<<)/,/^(?:>>)/,/^(?:\{)/,/^(?:\})/,/^(?:;)/,/^(?:#)/,/^(?:\?)/,/^(?::)/,/^(?:NaN\b)/,/^(?:\.)/,/^(?:\[)/,/^(?:\])/,/^(?:\()/,/^(?:\))/,/^(?:!)/,/^(?:\^)/,/^(?:\*)/,/^(?:\/)/,/^(?:%)/,/^(?:\+)/,/^(?:-)/,/^(?:<=)/,/^(?:<)/,/^(?:>=)/,/^(?:>)/,/^(?:==)/,/^(?:~=)/,/^(?:!=)/,/^(?:&&)/,/^(?:\|\|)/,/^(?:=)/,/^(?:,)/,/^(?:$)/,/^(?:[A-Za-z_\$][A-Za-z0-9_]*)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57],inclusive:!0}}};return Ht}();function xe(){this.yy={}}return Se.lexer=Ge,xe.prototype=Se,Se.Parser=xe,new xe}();parser.yy.parseError=parser.parseError;const __WEBPACK_DEFAULT_EXPORT__=_jxg__WEBPACK_IMPORTED_MODULE_0__.Z.JessieCode},327:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(109),B=S(275),R={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},A=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(c){return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10)]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}];a.Z.rgbParser=function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F=c;if(!X.Z.exists(c))return[];if(X.Z.exists(m)&&X.Z.exists(v)&&(F=[c,m,v]),_=F,j=!1,X.Z.isArray(_)){for(w=0;w<3;w++)j=j||/\./.test(F[w].toString());for(w=0;w<3;w++)j=j&&F[w]>=0&&F[w]<=1;return j?[Math.ceil(255*F[0]),Math.ceil(255*F[1]),Math.ceil(255*F[2])]:F}for(typeof F=="string"&&(_=F),_.charAt(0)==="#"&&(_=_.substr(1,6)),_=_.replace(/ /g,"").toLowerCase(),_=R[_]||_,w=0;w<A.length;w++)g=A[w].re,C=A[w].process,(P=g.exec(_))&&(T=(f=C(P))[0],L=f[1],Y=f[2]);return isNaN(T)||isNaN(L)||isNaN(Y)?[]:[T=T<0||isNaN(T)?0:T>255?255:T,L=L<0||isNaN(L)?0:L>255?255:L,Y=Y<0||isNaN(Y)?0:Y>255?255:Y]},a.Z.rgb2css=function(c,m,v){var _;return"rgb("+(_=a.Z.rgbParser(c,m,v))[0]+", "+_[1]+", "+_[2]+")"},a.Z.rgb2hex=function(c,m,v){var _,f,g;return f=(_=a.Z.rgbParser(c,m,v))[1],g=_[2],_=(_=_[0]).toString(16),f=f.toString(16),g=g.toString(16),_.length===1&&(_="0"+_),f.length===1&&(f="0"+f),g.length===1&&(g="0"+g),"#"+_+f+g},a.Z.hex2rgb=function(c){return a.Z.deprecated("JXG.hex2rgb()","JXG.rgb2css()"),a.Z.rgb2css(c)},a.Z.hsv2rgb=function(c,m,v){var _,f,g,C,P,w,T,L,Y;if(c=(c%360+360)%360,m===0){if(!(isNaN(c)||c<B.Z.eps))return"#ffffff";_=v,f=v,g=v}else switch(w=c>=360?0:c,T=v*(1-m),L=v*(1-m*(C=(w/=60)-(P=Math.floor(w)))),Y=v*(1-m*(1-C)),P){case 0:_=v,f=Y,g=T;break;case 1:_=L,f=v,g=T;break;case 2:_=T,f=v,g=Y;break;case 3:_=T,f=L,g=v;break;case 4:_=Y,f=T,g=v;break;case 5:_=v,f=T,g=L}return["#",_=(_=Math.round(255*_).toString(16)).length===2?_:_.length===1?"0"+_:"00",f=(f=Math.round(255*f).toString(16)).length===2?f:f.length===1?"0"+f:"00",g=(g=Math.round(255*g).toString(16)).length===2?g:g.length===1?"0"+g:"00"].join("")},a.Z.rgb2hsv=function(c,m,v){var _,f,g,C,P,w,T,L,Y,j,F,G,H;return f=(_=a.Z.rgbParser(c,m,v))[1],g=_[2],C=(_=_[0])/255,P=f/255,w=g/255,G=Math.max(_,f,g),L=(H=Math.min(_,f,g))/255,j=0,(F=T=G/255)>0&&(j=(F-L)/F),Y=1/(T-L),j>0&&(G===_?Y*=P-w:Y=G===f?2+(w-C)*Y:4+(C-P)*Y),(Y*=60)<0&&(Y+=360),G===H&&(Y=0),[Y,j,F]},a.Z.rgb2LMS=function(c,m,v){var _,f,g,C,P,w,T,L=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return f=(_=a.Z.rgbParser(c,m,v))[1],g=_[2],_=_[0],_=Math.pow(_,.476190476),f=Math.pow(f,.476190476),g=Math.pow(g,.476190476),(T=[C=_*L[0][0]+f*L[0][1]+g*L[0][2],P=_*L[1][0]+f*L[1][1]+g*L[1][2],w=_*L[2][0]+f*L[2][1]+g*L[2][2]]).l=C,T.m=P,T.s=w,T},a.Z.LMS2rgb=function(c,m,v){var _,f,g,C,P=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]],w=function(T){for(var L=127,Y=64;Y>0;){if(Math.pow(L,.476190476)>T)L-=Y;else{if(Math.pow(L+1,.476190476)>T)return L;L+=Y}Y/=2}return L===254&&13.994955247<T?255:L};return _=c*P[0][0]+m*P[0][1]+v*P[0][2],f=c*P[1][0]+m*P[1][1]+v*P[1][2],g=c*P[2][0]+m*P[2][1]+v*P[2][2],(C=[_=w(_),f=w(f),g=w(g)]).r=_,C.g=f,C.b=g,C},a.Z.rgba2rgbo=function(c){var m;return c.length===9&&c.charAt(0)==="#"?(m=parseInt(c.substr(7,2).toUpperCase(),16)/255,c=c.substr(0,7)):m=1,[c,m]},a.Z.rgbo2rgba=function(c,m){var v;return c==="none"?c:((v=Math.round(255*m).toString(16)).length===1&&(v="0"+v),c+v)},a.Z.rgb2bw=function(c){var m,v,_,f="0123456789ABCDEF";return c==="none"?c:(_=a.Z.rgbParser(c),m=Math.floor(.3*_[0]+.59*_[1]+.11*_[2]),c="#"+(v=f.charAt(m>>4&15)+f.charAt(15&m))+v+v)},a.Z.rgb2cb=function(c,m){var v,_,f,g,C,P,w,T,L,Y,j,F="0123456789ABCDEF";if(c==="none")return c;switch(_=(C=a.Z.rgb2LMS(c))[0],f=C[1],g=C[2],m=m.toLowerCase()){case"protanopia":P=-.06150039994295001,w=.08277001656812001,T=-.013200141220000003,L=.05858939668799999,Y=-.07934519995360001,j=.013289415272000003,_=g/f<.6903216543277437?-(w*f+T*g)/P:-(Y*f+j*g)/L;break;case"tritanopia":P=-.00058973116217,w=.007690316482,T=-.01011703519052,L=.025495080838999994,Y=-.0422740347,j=.017005316784,g=f/_<.8349489908460004?-(P*_+w*f)/T:-(L*_+Y*f)/j;break;default:P=-.06150039994295001,w=.08277001656812001,T=-.013200141220000003,L=.05858939668799999,Y=-.07934519995360001,j=.013289415272000003,f=g/_<.5763833686400911?-(P*_+T*g)/w:-(L*_+j*g)/Y}return v=a.Z.LMS2rgb(_,f,g),c="#"+(F.charAt(v[0]>>4&15)+F.charAt(15&v[0])),c+=F.charAt(v[1]>>4&15)+F.charAt(15&v[1]),c+=F.charAt(v[2]>>4&15)+F.charAt(15&v[2])},a.Z.autoHighlight=function(c){var m=a.Z.rgba2rgbo(c),v=m[0],_=m[1];return c.charAt(0)==="#"?(_*=_<.3?1.8:.4,a.Z.rgbo2rgba(v,_)):c},a.Z.contrast=function(c,m,v,_){var f,g,C,P,w;return m=m||"#000000",v=v||"#ffffff",_=_||7,f=a.Z.rgbParser(c),g=a.Z.rgbParser("#000000"),w=(C=.2126*Math.pow(f[0]/255,2.2)+.7152*Math.pow(f[1]/255,2.2)+.0722*Math.pow(f[2]/255,2.2))>(P=.2126*Math.pow(g[0]/255,2.2)+.7152*Math.pow(g[1]/255,2.2)+.0722*Math.pow(g[2]/255,2.2))?Math.floor((C+.05)/(P+.05)):Math.floor((P+.05)/(C+.05)),(w-=1)>_?m:v},a.Z.setClassicColors=function(){a.Z.Options.elements.strokeColor="blue",a.Z.Options.elements.fillColor="red",a.Z.Options.hatch.strokeColor="blue",a.Z.Options.angle.fillColor="#ff7f00",a.Z.Options.angle.highlightFillColor="#ff7f00",a.Z.Options.angle.strokeColor="#ff7f00",a.Z.Options.angle.label.strokeColor="blue",a.Z.Options.arc.strokeColor="blue",a.Z.Options.circle.center.fillColor="red",a.Z.Options.circle.center.strokeColor="blue",a.Z.Options.circumcircle.strokeColor="blue",a.Z.Options.circumcircle.center.fillColor="red",a.Z.Options.circumcircle.center.strokeColor="blue",a.Z.Options.circumcirclearc.strokeColor="blue",a.Z.Options.circumcirclesector.strokeColor="blue",a.Z.Options.circumcirclesector.fillColor="green",a.Z.Options.circumcirclesector.highlightFillColor="green",a.Z.Options.conic.strokeColor="blue",a.Z.Options.curve.strokeColor="blue",a.Z.Options.incircle.strokeColor="blue",a.Z.Options.incircle.center.fillColor="red",a.Z.Options.incircle.center.strokeColor="blue",a.Z.Options.inequality.fillColor="red",a.Z.Options.integral.fillColor="red",a.Z.Options.integral.curveLeft.color="red",a.Z.Options.integral.curveRight.color="red",a.Z.Options.line.strokeColor="blue",a.Z.Options.point.fillColor="red",a.Z.Options.point.strokeColor="red",a.Z.Options.polygon.fillColor="green",a.Z.Options.polygon.highlightFillColor="green",a.Z.Options.polygon.vertices.strokeColor="red",a.Z.Options.polygon.vertices.fillColor="red",a.Z.Options.regularpolygon.fillColor="green",a.Z.Options.regularpolygon.highlightFillColor="green",a.Z.Options.regularpolygon.vertices.strokeColor="red",a.Z.Options.regularpolygon.vertices.fillColor="red",a.Z.Options.riemannsum.fillColor="yellow",a.Z.Options.sector.fillColor="green",a.Z.Options.sector.highlightFillColor="green",a.Z.Options.semicircle.center.fillColor="red",a.Z.Options.semicircle.center.strokeColor="blue",a.Z.Options.slopetriangle.fillColor="red",a.Z.Options.slopetriangle.highlightFillColor="red",a.Z.Options.turtle.arrow.strokeColor="blue"},a.Z.extend(a.Z,{paletteWong:{black:"#000000",orange:"#E69F00",skyblue:"#56B4E9",bluishgreen:"#009E73",yellow:"#F0E442",darkblue:"#0072B2",vermillion:"#D55E00",reddishpurple:"#CC79A7",blue:"#0072B2",red:"#D55E00",green:"#009E73",purple:"#CC79A7",white:"#ffffff"}}),a.Z.palette=a.Z.paletteWong;const E=a.Z},503:(u,N,S)=>{S.d(N,{Z:()=>B});var a=S(765),X=S(109);a.Z.extendConstants(a.Z,{touchProperty:"touches"}),a.Z.extend(a.Z,{isTouchEvent:function(R){return a.Z.exists(R[a.Z.touchProperty])},isPointerEvent:function(R){return a.Z.exists(R.pointerId)},isMouseEvent:function(R){return!a.Z.isTouchEvent(R)&&!a.Z.isPointerEvent(R)},getNumberOfTouchPoints:function(R){var A=-1;return a.Z.isTouchEvent(R)&&(A=R[a.Z.touchProperty].length),A},isFirstTouch:function(R){var A=a.Z.getNumberOfTouchPoints(R);return a.Z.isPointerEvent(R)?R.isPrimary:A===1},isBrowser:typeof window=="object"&&typeof document=="object",supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch{return!1}},supportsVML:function(){return this.isBrowser&&!!document.namespaces},supportsSVG:function(){return!!this.isBrowser&&!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect},supportsCanvas:function(){var R=!1;return this.isNode()&&(R=!0),R||this.isBrowser&&!!document.createElement("canvas").getContext},isNode:function(){return!this.isBrowser&&typeof process<"u"&&process.release.name.search(/node|io.js/)!==-1},isWebWorker:function(){return!this.isBrowser&&typeof self=="object"&&typeof self.postMessage=="function"},supportsPointerEvents:function(){return!!(this.isBrowser&&window.navigator&&(window.PointerEvent||window.navigator.pointerEnabled||window.navigator.msPointerEnabled))},isTouchDevice:function(){return this.isBrowser&&window.ontouchstart!==void 0},isAndroid:function(){return X.Z.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.indexOf(" AppleWebKit/")>-1},isApple:function(){return X.Z.exists(navigator)&&(navigator.userAgent.indexOf("iPad")>-1||navigator.userAgent.indexOf("iPhone")>-1)},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile\/[0-9A-Za-z.]*Safari/)>-1},isMetroApp:function(){return typeof window=="object"&&window.clientInformation&&window.clientInformation.appVersion&&window.clientInformation.appVersion.indexOf("MSAppHost")>-1},isMozilla:function(){return X.Z.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1},isFirefoxOS:function(){return X.Z.exists(navigator)&&navigator.userAgent.toLowerCase().indexOf("android")===-1&&navigator.userAgent.toLowerCase().indexOf("apple")===-1&&navigator.userAgent.toLowerCase().indexOf("mobile")>-1&&navigator.userAgent.toLowerCase().indexOf("mozilla")>-1},ieVersion:function(){var R,A,E=3;if(typeof document!="object")return 0;A=(R=document.createElement("div")).getElementsByTagName("i");do R.innerHTML="<!--[if gt IE "+ ++E+"]><i></i><![endif]-->";while(A[0]);return E>4?E:void 0}(),getDimensions:function(R,A){var E,c,m,v,_,f,g,C,P,w=/\d+(\.\d*)?px/;if(!this.isBrowser||R===null)return{width:500,height:500};if(E=(A=A||document).getElementById(R),!X.Z.exists(E))throw new Error(`
JSXGraph: HTML container element '`+R+"' not found.");return(c=E.style.display)!=="none"&&c!==null?E.clientWidth>0&&E.clientHeight>0?{width:E.clientWidth,height:E.clientHeight}:(P=window.getComputedStyle?window.getComputedStyle(E):E.style,{width:w.test(P.width)?parseFloat(P.width):0,height:w.test(P.height)?parseFloat(P.height):0}):(v=(m=E.style).visibility,_=m.position,f=m.display,m.visibility="hidden",m.position="absolute",m.display="block",g=E.clientWidth,C=E.clientHeight,m.display=f,m.position=_,m.visibility=v,{width:g,height:C})},addEvent:function(R,A,E,c,m){var v=function(){return E.apply(c,arguments)};v.origin=E,typeof c=="object"&&X.Z.exists(c.BOARD_MODE_NONE)&&(c["x_internal"+A]=c["x_internal"+A]||[],c["x_internal"+A].push(v)),X.Z.exists(R)&&X.Z.exists(R.addEventListener)&&(m=m||!1,R.addEventListener(A,v,m)),X.Z.exists(R)&&X.Z.exists(R.attachEvent)&&R.attachEvent("on"+A,v)},removeEvent:function(R,A,E,c){var m;if(X.Z.exists(c))if(X.Z.exists(c["x_internal"+A]))if(X.Z.isArray(c["x_internal"+A]))if((m=X.Z.indexOf(c["x_internal"+A],E,"origin"))!==-1){try{X.Z.exists(R)&&X.Z.exists(R.removeEventListener)&&R.removeEventListener(A,c["x_internal"+A][m],!1),X.Z.exists(R)&&X.Z.exists(R.detachEvent)&&R.detachEvent("on"+A,c["x_internal"+A][m])}catch{a.Z.debug("event not registered in browser: ("+A+" -- "+E+")")}c["x_internal"+A].splice(m,1)}else a.Z.debug("removeEvent: no such event function in internal list: "+E);else a.Z.debug("owner[x_internal + "+A+"] is not an array");else a.Z.debug("no such type: "+A);else a.Z.debug("no such owner")},removeAllEvents:function(R,A,E){var c;if(E["x_internal"+A]){for(c=E["x_internal"+A].length-1;c>=0;c--)a.Z.removeEvent(R,A,E["x_internal"+A][c].origin,E);E["x_internal"+A].length>0&&a.Z.debug("removeAllEvents: Not all events could be removed.")}},getPosition:function(R,A,E){var c,m,v,_=0,f=0;if(R||(R=window.event),v=R[a.Z.touchProperty],X.Z.exists(v)&&v.length===0&&(v=R.changedTouches),X.Z.exists(A)&&X.Z.exists(v))if(A===-1){for(m=v.length,c=0;c<m;c++)if(v[c]){R=v[c];break}}else R=v[A];return R.clientX&&(_=R.clientX,f=R.clientY),[_,f]},getOffset:function(R){var A,E=R,c=R,m=E.offsetLeft-E.scrollLeft,v=E.offsetTop-E.scrollTop;for(m=(A=this.getCSSTransform([m,v],E))[0],v=A[1],E=E.offsetParent;E;){for(m+=E.offsetLeft,v+=E.offsetTop,E.offsetParent&&(m+=E.clientLeft-E.scrollLeft,v+=E.clientTop-E.scrollTop),m=(A=this.getCSSTransform([m,v],E))[0],v=A[1],c=c.parentNode;c!==E;)m+=c.clientLeft-c.scrollLeft,v+=c.clientTop-c.scrollTop,m=(A=this.getCSSTransform([m,v],c))[0],v=A[1],c=c.parentNode;E=E.offsetParent}return[m,v]},getStyle:function(R,A){var E,c=R.ownerDocument;return c.defaultView&&c.defaultView.getComputedStyle?E=c.defaultView.getComputedStyle(R,null).getPropertyValue(A):R.currentStyle&&a.Z.ieVersion>=9?E=R.currentStyle[A]:R.style&&(A=A.replace(/-([a-z]|[0-9])/gi,function(m,v){return v.toUpperCase()}),E=R.style[A]),E},getProp:function(R,A){var E=parseInt(this.getStyle(R,A),10);return isNaN(E)?0:E},getCSSTransform:function(R,A){var E,c,m,v,_,f,g,C=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(_=C.length,E=0,m="";E<_;E++)if(X.Z.exists(A.style[C[E]])){m=A.style[C[E]];break}if(m!==""&&(v=m.indexOf("("))>0){for(_=m.length,c=0,f=(g=m.substring(v+1,_-1).split(",")).length;c<f;c++)g[c]=parseFloat(g[c]);m.indexOf("matrix")===0?(R[0]+=g[4],R[1]+=g[5]):m.indexOf("translateX")===0?R[0]+=g[0]:m.indexOf("translateY")===0?R[1]+=g[0]:m.indexOf("translate")===0&&(R[0]+=g[0],R[1]+=g[1])}return X.Z.exists(A.style.zoom)&&(m=A.style.zoom)!==""&&(R[0]*=parseFloat(m),R[1]*=parseFloat(m)),R},getCSSTransformMatrix:function(R){var A,E,c,m,v,_,f,g,C=R.ownerDocument,P=["transform","webkitTransform","MozTransform","msTransform","oTransform"],w=[[1,0,0],[0,1,0],[0,0,1]];if(C.defaultView&&C.defaultView.getComputedStyle)c=(g=C.defaultView.getComputedStyle(R,null)).getPropertyValue("-webkit-transform")||g.getPropertyValue("-moz-transform")||g.getPropertyValue("-ms-transform")||g.getPropertyValue("-o-transform")||g.getPropertyValue("transform");else for(v=P.length,A=0,c="";A<v;A++)if(X.Z.exists(R.style[P[A]])){c=R.style[P[A]];break}if(c!==""&&(m=c.indexOf("("))>0){for(v=c.length,E=0,_=(f=c.substring(m+1,v-1).split(",")).length;E<_;E++)f[E]=parseFloat(f[E]);c.indexOf("matrix")===0?w=[[1,0,0],[0,f[0],f[1]],[0,f[2],f[3]]]:c.indexOf("scaleX")===0?w[1][1]=f[0]:c.indexOf("scaleY")===0?w[2][2]=f[0]:c.indexOf("scale")===0&&(w[1][1]=f[0],w[2][2]=f[1])}return X.Z.exists(R.style.zoom)&&(c=R.style.zoom)!==""&&(w[1][1]*=parseFloat(c),w[2][2]*=parseFloat(c)),w},timedChunk:function(R,A,E,c){var m=R.concat(),v=function(){var _=+new Date;do A.call(E,m.shift());while(m.length>0&&+new Date-_<300);m.length>0?window.setTimeout(v,1):c(R)};window.setTimeout(v,1)},scaleJSXGraphDiv:function(R,A,E,c){var m,v,_,f,g,C,P,w,T,L,Y,j=E.styleSheets.length,F=c,G=[":fullscreen",":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"],H=G.length,q=new RegExp(".*#"+R+":.*full.*screen.*#"+A+".*auto;.*transform:.*matrix");for(f=(g=E.getElementById(R).getBoundingClientRect()).height,_=g.width,P=(w=E.getElementById(A).getBoundingClientRect()).height,L="{margin:0 auto;transform:matrix("+(T=(C=w.width)/P>=_/f?F*_/C:F*f/P)+",0,0,"+T+",0,"+.5*(f-P)+");}",j===0&&((m=document.createElement("style")).appendChild(document.createTextNode("")),E.appendChild(m),j=E.styleSheets.length),E.styleSheets[j-1].cssRules.length>0&&q.test(E.styleSheets[j-1].cssRules[0].cssText)&&E.styleSheets[j-1].deleteRule&&E.styleSheets[j-1].deleteRule(0),Y=0;Y<H;Y++)try{v="#"+R+G[Y]+" #"+A+L,E.styleSheets[j-1].insertRule(v,0);break}catch{}Y===H&&(console.log("JXG.scaleJSXGraphDiv: Could not add any CSS rule."),console.log("One possible reason could be that the id of the JSXGraph container does not start with a letter."))}});const B=a.Z},88:(u,N,S)=>{S.d(N,{Z:()=>B});var a=S(765),X=S(109);a.Z.EventEmitter={eventHandlers:{},suspended:{},trigger:function(R,A){var E,c,m,v,_,f;for(_=R.length,c=0;c<_;c++)if(v=this.eventHandlers[R[c]],!this.suspended[R[c]]){if(this.suspended[R[c]]=!0,v)for(f=v.length,E=0;E<f;E++)(m=v[E]).handler.apply(m.context,A);this.suspended[R[c]]=!1}return this},on:function(R,A,E){return X.Z.isArray(this.eventHandlers[R])||(this.eventHandlers[R]=[]),E=X.Z.def(E,this),this.eventHandlers[R].push({handler:A,context:E}),this},off:function(R,A){var E;return R&&X.Z.isArray(this.eventHandlers[R])?(A?((E=X.Z.indexOf(this.eventHandlers[R],A,"handler"))>-1&&this.eventHandlers[R].splice(E,1),this.eventHandlers[R].length===0&&delete this.eventHandlers[R]):delete this.eventHandlers[R],this):this},eventify:function(R){R.eventHandlers={},R.on=this.on,R.off=this.off,R.triggerEventHandlers=this.trigger,R.trigger=this.trigger,R.suspended={}}};const B=a.Z.EventEmitter},421:(u,N,S)=>{S.d(N,{Z:()=>E});var a=S(765),X=S(109),B=S(351),R=S(705),A={each:function(c,m,v){var _,f,g=[];if(X.Z.exists(c.length))for(f=c.length,_=0;_<f;_++)g.push(m.call(this,c[_],v));return g},coords:function(c,m){var v=c;return c&&c.elementClass===B.Z.OBJECT_CLASS_POINT?v=c.coords:c.usrCoords&&c.scrCoords&&c.usr2screen&&(v=c),m&&(v=new R.Z(B.Z.COORDS_BY_USER,v.usrCoords,v.board)),v},coordsArray:function(c,m){var v;return(v=X.Z.isArray(c)?c:this.coords(c).usrCoords).length<3&&v.unshift(1),m&&(v=[v[0],v[1],v[2]]),v}};a.Z.Expect=A;const E=A},109:(u,N,S)=>{S.d(N,{Z:()=>B});var a=S(765),X=S(351);a.Z.extend(a.Z,{isId:function(R,A){return typeof A=="string"&&!!R.objects[A]},isName:function(R,A){return typeof A=="string"&&!!R.elementsByName[A]},isGroup:function(R,A){return typeof A=="string"&&!!R.groups[A]},isString:function(R){return typeof R=="string"},isNumber:function(R){return typeof R=="number"||Object.prototype.toString.call(R)==="[Object Number]"},isFunction:function(R){return typeof R=="function"},isArray:function(R){return Array.isArray?Array.isArray(R):R!==null&&typeof R=="object"&&typeof R.splice=="function"&&typeof R.join=="function"},isObject:function(R){return typeof R=="object"&&!this.isArray(R)},isDocumentOrFragment:function(R){return this.isObject(R)&&(R.nodeType===9||R.nodeType===11)},isPoint:function(R){return!(R===null||typeof R!="object"||!this.exists(R.elementClass))&&R.elementClass===X.Z.OBJECT_CLASS_POINT},isPoint3D:function(R){return!(R===null||typeof R!="object"||!this.exists(R.elType))&&R.elType==="point3d"},isPointType:function(R,A){var E,c;return!!this.isArray(A)||!!(this.isFunction(A)&&(E=A(),this.isArray(E)&&E.length>1))||(c=R.select(A),this.isPoint(c))},isTransformationOrArray:function(R){if(R!==null){if(this.isArray(R)&&R.length>0)return this.isTransformationOrArray(R[0]);if(typeof R=="object")return R.type===X.Z.OBJECT_TYPE_TRANSFORMATION}return!1},isEmpty:function(R){return Object.keys(R).length===0},exists:function(R,A){var E=!(R==null||R===null);return(A=A||!1)?E&&R!=="":E},def:function(R,A){return this.exists(R)?R:A},str2Bool:function(R){return!this.exists(R)||(typeof R=="boolean"?R:!!this.isString(R)&&R.toLowerCase()==="true")},createEvalFunction:function(R,A,E){var c,m,v,_=[],f={};for(m=0;m<E;m++)for(v in _[m]=a.Z.createFunction(A[m],R,"",!0),_[m].deps)f[v]=_[m].deps;return(c=function(g){return _[g]()}).deps=f,c},createFunction:function(R,A,E,c){var m=null;return this.exists(c)&&!c||!this.isString(R)?this.isFunction(R)?(m=R).deps={}:(this.isNumber(R)||this.isString(R))&&((m=function(){return R}).deps={}):m=A.jc.snippet(R,!0,E,!0),m!==null&&(m.origin=R),m},providePoints:function(R,A,E,c,m){var v,_,f,g,C,P=0,w=[];for(this.isArray(A)||(A=[A]),f=A.length,this.exists(m)&&(P=m.length),P===0&&(g=this.copyAttributes(E,R.options,c)),v=0;v<f;++v)if(P>0&&(_=Math.min(v,P-1),g=this.copyAttributes(E,R.options,c,m[_])),this.isArray(A[v])&&A[v].length>1?(w.push(R.create("point",A[v],g)),w[w.length-1]._is_new=!0):this.isFunction(A[v])?(C=A[v](),this.isArray(C)&&C.length>1&&(w.push(R.create("point",[A[v]],g)),w[w.length-1]._is_new=!0)):w.push(R.select(A[v])),!this.isPoint(w[v]))return!1;return w},providePoints3D:function(R,A,E,c,m){var v,_,f,g,C,P=0,w=[];for(this.isArray(A)||(A=[A]),f=A.length,this.exists(m)&&(P=m.length),P===0&&(g=this.copyAttributes(E,R.board.options,c)),v=0;v<f;++v)if(P>0&&(_=Math.min(v,P-1),g=this.copyAttributes(E,R.board.options,c,m[_])),this.isArray(A[v])&&A[v].length>1?(w.push(R.create("point3d",A[v],g)),w[w.length-1]._is_new=!0):this.isFunction(A[v])?(C=A[v](),this.isArray(C)&&C.length>1&&(w.push(R.create("point3d",[A[v]],g)),w[w.length-1]._is_new=!0)):w.push(R.select(A[v])),!this.isPoint3D(w[v]))return!1;return w},bind:function(R,A){return function(){return R.apply(A,arguments)}},evaluate:function(R){return this.isFunction(R)?R():R},indexOf:function(R,A,E){var c,m=this.exists(E);if(Array.indexOf&&!m)return R.indexOf(A);for(c=0;c<R.length;c++)if(m&&R[c][E]===A||!m&&R[c]===A)return c;return-1},eliminateDuplicates:function(R){var A,E=R.length,c=[],m={};for(A=0;A<E;A++)m[R[A]]=0;for(A in m)m.hasOwnProperty(A)&&c.push(A);return c},swap:function(R,A,E){var c;return c=R[A],R[A]=R[E],R[E]=c,R},uniqueArray:function(R){var A,E,c,m=[];if(R.length===0)return[];for(A=0;A<R.length;A++)if(c=this.isArray(R[A]),this.exists(R[A]))for(E=A+1;E<R.length;E++)c&&a.Z.cmpArrays(R[A],R[E])?R[A]=[]:c||R[A]!==R[E]||(R[A]="");else R[A]="";for(E=0,A=0;A<R.length;A++)(c=this.isArray(R[A]))||R[A]===""?c&&R[A].length!==0&&(m[E]=R[A].slice(0),E++):(m[E]=R[A],E++);return R=m,m},isInArray:function(R,A){return a.Z.indexOf(R,A)>-1},coordsArrayToMatrix:function(R,A){var E,c=[],m=[];for(E=0;E<R.length;E++)A?(c.push(R[E].usrCoords[1]),m.push(R[E].usrCoords[2])):m.push([R[E].usrCoords[1],R[E].usrCoords[2]]);return A&&(m=[c,m]),m},cmpArrays:function(R,A){var E;if(R===A)return!0;if(R.length!==A.length)return!1;for(E=0;E<R.length;E++)if(this.isArray(R[E])&&this.isArray(A[E])){if(!this.cmpArrays(R[E],A[E]))return!1}else if(R[E]!==A[E])return!1;return!0},removeElementFromArray:function(R,A){var E;for(E=0;E<R.length;E++)if(R[E]===A)return R.splice(E,1),R;return R},trunc:function(R,A){return A=a.Z.def(A,0),this.toFixed(R,A)},_decimalAdjust:function(R,A,E){return E===void 0||+E==0?Math[R](A):(A=+A,E=+E,isNaN(A)||typeof E!="number"||E%1!=0?NaN:(A=A.toString().split("e"),+((A=(A=Math[R](+(A[0]+"e"+(A[1]?+A[1]-E:-E)))).toString().split("e"))[0]+"e"+(A[1]?+A[1]+E:E))))},_round10:function(R,A){return this._decimalAdjust("round",R,A)},_floor10:function(R,A){return this._decimalAdjust("floor",R,A)},_ceil10:function(R,A){return this._decimalAdjust("ceil",R,A)},toFixed:function(R,A){return this._round10(R,-A).toFixed(A)},autoDigits:function(R){var A=Math.abs(R);return A>=.1?this.toFixed(R,2):A>=.01?this.toFixed(R,4):A>=1e-4?this.toFixed(R,6):R},keys:function(R,A){var E,c=[];for(E in R)A?R.hasOwnProperty(E)&&c.push(E):c.push(E);return c},clone:function(R){var A={};return A.prototype=R,A},cloneAndCopy:function(R,A){var E,c=function(){};for(E in c.prototype=R,A)c[E]=A[E];return c},merge:function(R,A){var E,c,m,v;for(E in A)if(A.hasOwnProperty(E))if(m=A[E],this.isArray(m))for(R[E]||(R[E]=[]),c=0;c<m.length;c++)v=A[E][c],typeof A[E][c]=="object"?R[E][c]=this.merge(R[E][c],v):R[E][c]=A[E][c];else typeof m=="object"?(R[E]||(R[E]={}),R[E]=this.merge(R[E],m)):R[E]=m;return R},deepCopy:function(R,A,E){var c,m,v,_;if(E=E||!1,typeof R!="object"||R===null)return R;if(this.isArray(R))for(c=[],m=0;m<R.length;m++)typeof(v=R[m])=="object"?this.exists(v.board)?c[m]=v.id:c[m]=this.deepCopy(v):c[m]=v;else{for(m in c={},R)R.hasOwnProperty(m)&&(_=E?m.toLowerCase():m,(v=R[m])!==null&&typeof v=="object"?this.exists(v.board)?c[_]=v.id:c[_]=this.deepCopy(v):c[_]=v);for(m in A)A.hasOwnProperty(m)&&(_=E?m.toLowerCase():m,typeof(v=A[m])=="object"?this.isArray(v)||!this.exists(c[_])?c[_]=this.deepCopy(v):c[_]=this.deepCopy(c[_],v,E):c[_]=v)}return c},mergeAttr:function(R,A,E){var c,m,v;for(c in E=E||!0,A)A.hasOwnProperty(c)&&(m=E?c.toLowerCase():c,v=A[c],!this.isObject(v)||v===null||this.isDocumentOrFragment(v)||this.exists(v.board)||typeof v.valueOf()=="string"?R[m]=v:(R[m]!==void 0&&R[m]!==null&&this.isObject(R[m])||(R[m]={}),this.mergeAttr(R[m],v,E)))},copyAttributes:function(R,A,E){var c,m,v,_,f,g={circle:1,curve:1,foreignobject:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(c=(v=arguments.length)<3||g[E]?a.Z.deepCopy(A.elements,null,!0):{},v<4&&this.exists(E)&&this.exists(A.layer[E])&&(c.layer=A.layer[E]),_=A,f=!0,m=2;m<v;m++){if(!this.exists(_[arguments[m]])){f=!1;break}_=_[arguments[m]]}for(f&&(c=a.Z.deepCopy(c,_,!0)),_=typeof R=="object"?R:{},f=!0,m=3;m<v;m++){if(!this.exists(_[arguments[m]])){f=!1;break}_=_[arguments[m]]}if(f&&this.mergeAttr(c,_,!0),arguments[2]==="board")return c;for(_=A,f=!0,m=2;m<v;m++){if(!this.exists(_[arguments[m]])){f=!1;break}_=_[arguments[m]]}return f&&this.exists(_.label)&&(c.label=a.Z.deepCopy(_.label,c.label)),c.label=a.Z.deepCopy(A.label,c.label),c},copyPrototypeMethods:function(R,A,E){var c;for(c in R.prototype[E]=A.prototype.constructor,A.prototype)A.prototype.hasOwnProperty(c)&&(R.prototype[c]=A.prototype[c])},toJSON:function(R,A){var E,c,m,v;if(A=a.Z.def(A,!1),JSON.stringify&&!A)try{return JSON.stringify(R)}catch{}switch(typeof R){case"object":if(R){if(E=[],this.isArray(R)){for(m=0;m<R.length;m++)E.push(a.Z.toJSON(R[m],A));return"["+E.join(",")+"]"}for(c in R)if(R.hasOwnProperty(c)){try{v=a.Z.toJSON(R[c],A)}catch{v=""}A?E.push(c+":"+v):E.push('"'+c+'":'+v)}return"{"+E.join(",")+"} "}return"null";case"string":return"'"+R.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return R.toString()}return"0"},clearVisPropOld:function(R){return R.visPropOld={cssclass:"",cssdefaultstyle:"",cssstyle:"",fillcolor:"",fillopacity:"",firstarrow:!1,fontsize:-1,lastarrow:!1,left:-1e5,linecap:"",shadow:!1,strokecolor:"",strokeopacity:"",strokewidth:"",tabindex:-1e5,transitionduration:0,top:-1e5,visible:null},R},isInObject:function(R,A){var E;for(E in R)if(R.hasOwnProperty(E)&&R[E]===A)return!0;return!1},escapeHTML:function(R){return R.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(R){return R.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},capitalize:function(R){return R.charAt(0).toUpperCase()+R.substring(1).toLowerCase()},trimNumber:function(R){return(R=(R=R.replace(/^0+/,"")).replace(/0+$/,""))[R.length-1]!=="."&&R[R.length-1]!==","||(R=R.slice(0,-1)),R[0]!=="."&&R[0]!==","||(R="0"+R),R},filterElements:function(R,A){var E,c,m,v,_,f,g,C=R.length,P=[];if(typeof A!="function"&&typeof A!="object")return P;for(E=0;E<C;E++){if(g=!0,m=R[E],typeof A=="object"){for(c in A)if(A.hasOwnProperty(c)&&(v=c.toLowerCase(),_=typeof m[c]=="function"?m[c]():m[c],f=m.visProp&&typeof m.visProp[v]=="function"?m.visProp[v]():m.visProp&&m.visProp[v],!(g=typeof A[c]=="function"?A[c](_)||A[c](f):_===A[c]||f===A[c])))break}else typeof A=="function"&&(g=A(m));g&&P.push(m)}return P},trim:function(R){return R.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},sanitizeHTML:function(R,A){return typeof html_sanitize=="function"&&A?html_sanitize(R,function(){},function(E){return E}):(R&&typeof R=="string"&&(R=R.replace(/</g,"&lt;").replace(/>/g,"&gt;")),R)},evalSlider:function(R){return R&&R.type===X.Z.OBJECT_TYPE_GLIDER&&typeof R.Value=="function"?R.Value():R}});const B=a.Z}},__webpack_module_cache__={};function __webpack_require__(u){var N=__webpack_module_cache__[u];if(N!==void 0)return N.exports;var S=__webpack_module_cache__[u]={exports:{}};return __webpack_modules__[u](S,S.exports,__webpack_require__),S.exports}__webpack_require__.d=(u,N)=>{for(var S in N)__webpack_require__.o(N,S)&&!__webpack_require__.o(u,S)&&Object.defineProperty(u,S,{enumerable:!0,get:N[S]})},__webpack_require__.o=(u,N)=>Object.prototype.hasOwnProperty.call(u,N);var __webpack_exports__={};(()=>{__webpack_require__.d(__webpack_exports__,{$l:()=>xe,fy:()=>Oe,JU:()=>De,kL:()=>Ht,Cd:()=>Ct,Zz:()=>Mt,fS:()=>Ut,mZ:()=>Nt,L6:()=>ct,Hy:()=>Zt,iG:()=>Le,QK:()=>st,ZA:()=>Ye,Ee:()=>ze,Nn:()=>ke,n1:()=>He,IY:()=>Me,x1:()=>je,ZX:()=>Be,Ei:()=>Ie,E9:()=>We,mg:()=>Qt,xv:()=>ue,vb:()=>we,zA:()=>Te,l8:()=>Ve,nY:()=>re,vP:()=>de,lZ:()=>ne,I0:()=>Xe,ak:()=>be,tj:()=>Se,kC:()=>ce,HM:()=>Ue,d9:()=>Ze,V$:()=>qe,DV:()=>fe,fG:()=>Fe,DM:()=>ve,OD:()=>Qe,o5:()=>ti,JI:()=>ei,fF:()=>ii,Ql:()=>si,yl:()=>ri,lU:()=>oi,p$:()=>ni,Nj:()=>ai,ZP:()=>Os,x9:()=>hi,Rm:()=>St,XH:()=>li,r:()=>ci,Lw:()=>ui,ku:()=>di,a2:()=>pi,vn:()=>fi,wx:()=>gi,zL:()=>_i,t_:()=>vi,os:()=>mi,bt:()=>bi,WJ:()=>Zi,wK:()=>Ci,XG:()=>yi,Dt:()=>Pi,mL:()=>Ei,kJ:()=>Oi,dB:()=>Si,oG:()=>xi,EE:()=>wi,oP:()=>Ti,K9:()=>Mi,UG:()=>Ni,hj:()=>Ri,Kn:()=>Ai,EJ:()=>Di,HD:()=>Li,b1:()=>ki,iI:()=>Bi,n2:()=>Ii,E:()=>Yi,Ju:()=>ji,XP:()=>Xi,TS:()=>Ui,ZL:()=>Fi,DG:()=>xt,od:()=>Ge,bU:()=>Ji,ui:()=>Gi,yt:()=>zi,aC:()=>Hi,sL:()=>Wi,xC:()=>Vi,OK:()=>qi,OW:()=>Ki,KJ:()=>$i,dq:()=>Qi,CO:()=>ts,tu:()=>es,KW:()=>rs,uh:()=>ss,cE:()=>is,jW:()=>os,Xl:()=>ns,uw:()=>as,Fm:()=>hs,kK:()=>ls,n:()=>cs,SJ:()=>us,LF:()=>ds,J6:()=>ps,FH:()=>fs,Ls:()=>_s,au:()=>gs,A8:()=>vs,_V:()=>ms,$G:()=>bs,Uo:()=>Zs,Nb:()=>Cs,zz:()=>ys,W6:()=>Ps,ZK:()=>Es});var u=__webpack_require__(765),N=__webpack_require__(503),S=__webpack_require__(351),a=__webpack_require__(109);u.Z.XML={cleanWhitespace:function(t){for(var e=t.firstChild;a.Z.exists(e);)e.nodeType!==3||/\S/.test(e.nodeValue)?e.nodeType===1&&this.cleanWhitespace(e):t.removeChild(e),e=e.nextSibling},parse:function(t){var e,o;return o=typeof DOMParser=="function"||typeof DOMParser=="object"?DOMParser:function(){this.parseFromString=function(s){var n;return typeof ActiveXObject=="function"&&(n=new ActiveXObject("MSXML.DomDocument")).loadXML(s),n}},e=new o().parseFromString(t,"text/xml"),this.cleanWhitespace(e),e}},u.Z.XML;var X=__webpack_require__(88),B=(__webpack_require__(421),__webpack_require__(275));B.Z.ProbFuncs={MAXNUM:17014118346046923e22,SQRTH:.7071067811865476,SQRT2:1.4142135623730951,MAXLOG:708.3964185322641,P:[2461969814735305e-25,.5641895648310689,7.463210564422699,48.63719709856814,196.5208329560771,526.4451949954773,934.5285271719576,1027.5518868951572,557.5353353693994],Q:[13.228195115474499,86.70721408859897,354.9377788878199,975.7085017432055,1823.9091668790973,2246.3376081871097,1656.6630919416134,557.5353408177277],R:[.5641895835477551,1.275366707599781,5.019050422511805,6.160210979930536,7.4097426995044895,2.9788666537210022],S:[2.2605286322011726,9.396035249380015,12.048953980809666,17.08144507475659,9.608968090632859,3.369076451000815],T:[9.604973739870516,90.02601972038427,2232.005345946843,7003.325141128051,55592.30130103949],U:[33.56171416475031,521.3579497801527,4594.323829709801,22629.000061389095,49267.39426086359],M:128,MINV:.0078125,expx2:function(t,e){var o,s,n,h;return t=Math.abs(t),e<0&&(t=-t),o=(n=this.MINV*Math.floor(this.M*t+.5))*n,s=2*n*(h=t-n)+h*h,e<0&&(o=-o,s=-s),o+s>this.MAXLOG?1/0:o=Math.exp(o)*Math.exp(s)},polevl:function(t,e,o){var s,n;if(a.Z.exists(e.reduce))return e.reduce(function(h,l){return h*t+l},0);for(n=0,s=0;n<=o;n++)s=s*t+e[n];return s},p1evl:function(t,e,o){var s,n;if(a.Z.exists(e.reduce))return e.reduce(function(h,l){return h*t+l},1);for(n=0,s=1;n<o;n++)s=s*t+e[n];return s},ndtr:function(t){var e,o,s;return e=t*this.SQRTH,(s=Math.abs(e))<1?o=.5+.5*this.erf(e):(o=.5*this.erfce(s),s=this.expx2(t,-1),o*=Math.sqrt(s),e>0&&(o=1-o)),o},_underflow:function(t){return console.log("erfc","UNDERFLOW"),t<0?2:0},erfc:function(t){var e,o,s,n,h;return(s=t<0?-t:t)<1?1-this.erf(t):(h=-t*t)<-this.MAXLOG?this._underflow(t):(h=this.expx2(t,-1),s<8?(e=this.polevl(s,this.P,8),o=this.p1evl(s,this.Q,8)):(e=this.polevl(s,this.R,5),o=this.p1evl(s,this.S,6)),n=h*e/o,t<0&&(n=2-n),n===0?this._underflow(t):n)},erfce:function(t){var e,o;return t<8?(e=this.polevl(t,this.P,8),o=this.p1evl(t,this.Q,8)):(e=this.polevl(t,this.R,5),o=this.p1evl(t,this.S,6)),e/o},erf:function(t){var e;return Math.abs(t)>1?1-this.erfc(t):(e=t*t,t*this.polevl(e,this.T,4)/this.p1evl(e,this.U,5))},s2pi:2.5066282746310007,P0:[-59.96335010141079,98.00107541859997,-56.67628574690703,13.931260938727968,-1.2391658386738125],Q0:[1.9544885833814176,4.676279128988815,86.36024213908905,-225.46268785411937,200.26021238006066,-82.03722561683334,15.90562251262117,-1.1833162112133],P1:[4.0554489230596245,31.525109459989388,57.16281922464213,44.08050738932008,14.684956192885803,2.1866330685079025,-.1402560791713545,-.03504246268278482,-.0008574567851546854],Q1:[15.779988325646675,45.39076351288792,41.3172038254672,15.04253856929075,2.504649462083094,-.14218292285478779,-.03808064076915783,-.0009332594808954574],P2:[3.2377489177694603,6.915228890689842,3.9388102529247444,1.3330346081580755,.20148538954917908,.012371663481782003,.00030158155350823543,26580697468673755e-22,6239745391849833e-24],Q2:[6.02427039364742,3.6798356385616087,1.3770209948908132,.21623699359449663,.013420400608854318,.00032801446468212774,28924786474538068e-22,6790194080099813e-24],ndtri:function(t){var e,o,s,n,h;return t<=0?-1/0:t>=1?1/0:(h=1,(o=t)>.8646647167633873&&(o=1-o,h=0),o>.1353352832366127?(e=(o-=.5)+o*((n=o*o)*this.polevl(n,this.P0,4)/this.p1evl(n,this.Q0,8)),e*=this.s2pi):(s=1/(e=Math.sqrt(-2*Math.log(o))),e=e-Math.log(e)/e-(e<8?s*this.polevl(s,this.P1,8)/this.p1evl(s,this.Q1,8):s*this.polevl(s,this.P2,8)/this.p1evl(s,this.Q2,8)),h!==0&&(e=-e),e))},erfi:function(t){return this.ndtri(.5*(t+1))*this.SQRTH}},B.Z.ProbFuncs;var R=__webpack_require__(785);B.Z.Extrapolate={upper:15,infty:1e4,wynnEps:function(t,e,o){var s,n,h,l,p;if(o[e]=t,e===0)p=t;else{for(h=0,s=e;s>0;s--)n=h,h=o[s-1],l=o[s]-h,Math.abs(l)<=1e-15?o[s-1]=1e20:o[s-1]=1*n+1/l;p=o[e%2]}return p},aitken:function(t,e,o){var s,n,h,l,p,d;if(o[e]=t,e<2)s=t;else{for(l=e/2,p=1;p<=l;p++)n=o[(d=e-2*p)+2]-2*o[d+1]+o[d],Math.abs(n)<1e-15?o[d]=1e20:(h=o[d]-o[d+1],o[d]-=h*h/n);s=o[e%2]}return s},brezinski:function(t,e,o){var s,n,h,l,p,d,b,Z;if(o[e]=t,e<3)s=t;else{for(d=e/3,Z=e,b=1;b<=d;b++)h=o[(Z-=3)+1]-o[Z],l=o[Z+2]-o[Z+1],n=(p=o[Z+3]-o[Z+2])*(l-h)-h*(p-l),Math.abs(n)<1e-15?o[Z]=1e20:o[Z]=o[Z+1]-h*l*(p-l)/n;s=o[e%3]}return s},iteration:function(t,e,o,s,n){var h,l,p,d,b=NaN,Z=[],y="finite",O=e;for(n=n||0,h=1;h<=this.upper;h++){if(l=o(t+(O=n===0?e/(h+1):.5*O),!0),p=this[s](l,h-1,Z),isNaN(p)){y="NaN";break}if(l!==0&&p/l>this.infty){b=p,y="infinite";break}if(d=p-b,Math.abs(d)<1e-7)break;b=p}return[b,y,1-(h-1)/this.upper]},levin:function(t,e,o,s,n,h){var l,p,d,b;if(b=1/(s+e),n[e]=t/o,h[e]=1/o,e>0&&(n[e-1]=n[e]-n[e-1],h[e-1]=h[e]-h[e-1],e>1))for(d=(s+e-1)*b,l=2;l<=e;l++)p=(s+e-l)*Math.pow(d,l-2)*b,n[e-l]=n[e-l+1]-p*n[e-l],h[e-l]=h[e-l+1]-p*h[e-l],b*=d;return Math.abs(h[0])<1e-15?1e20:n[0]/h[0]},iteration_levin:function(t,e,o,s){var n,h,l,p,d,b,Z,y=NaN,O=[],x=[],D="finite",k=e;for(s=s||0,p=o(t+e,!0),n=1;n<=this.upper;n++){if(d=(h=o(t+(k=s===0?e/(n+1):.5*k),!0))-p,Z=(Math.abs(d)<1?"u":"t")=="u"?(1+n)*d:d,p=h,b=(l=this.levin(h,n-1,Z,1,O,x))-y,isNaN(l)){D="NaN";break}if(h!==0&&l/h>this.infty){y=l,D="infinite";break}if(Math.abs(b)<1e-7)break;y=l}return[y,D,1-(n-1)/this.upper]},limit:function(t,e,o){return this.iteration_levin(t,e,o,0)}};const A=B.Z.Extrapolate;B.Z.Quadtree=function(t){this.capacity=10,this.points=[],this.xlb=t[0],this.xub=t[2],this.ylb=t[3],this.yub=t[1],this.northWest=null,this.northEast=null,this.southEast=null,this.southWest=null},a.Z.extend(B.Z.Quadtree.prototype,{contains:function(t,e){return this.xlb<t&&t<=this.xub&&this.ylb<e&&e<=this.yub},insert:function(t){return!!this.contains(t.usrCoords[1],t.usrCoords[2])&&(this.points.length<this.capacity?(this.points.push(t),!0):(this.northWest===null&&this.subdivide(),!!this.northWest.insert(t)||!!this.northEast.insert(t)||!!this.southEast.insert(t)||!!this.southWest.insert(t)))},subdivide:function(){var t,e=this.points.length,o=this.xlb+(this.xub-this.xlb)/2,s=this.ylb+(this.yub-this.ylb)/2;for(this.northWest=new B.Z.Quadtree([this.xlb,this.yub,o,s]),this.northEast=new B.Z.Quadtree([o,this.yub,this.xub,s]),this.southEast=new B.Z.Quadtree([this.xlb,s,o,this.ylb]),this.southWest=new B.Z.Quadtree([o,s,this.xub,this.ylb]),t=0;t<e;t+=1)this.northWest.insert(this.points[t]),this.northEast.insert(this.points[t]),this.southEast.insert(this.points[t]),this.southWest.insert(this.points[t])},_query:function(t,e){var o;if(this.contains(t,e)){if(this.northWest===null)return this;if((o=this.northWest._query(t,e))||(o=this.northEast._query(t,e))||(o=this.southEast._query(t,e))||(o=this.southWest._query(t,e)))return o}return!1},query:function(t,e){var o,s;return a.Z.exists(e)?(o=t,s=e):(o=t.usrCoords[1],s=t.usrCoords[2]),this._query(o,s)}});const E=B.Z.Quadtree;var c=__webpack_require__(336);u.Z.Math.Nlp={arr:function(t){return new Float64Array(t)},arr2:function(t,e){for(var o=0,s=new Array(t);o<t;)s[o]=this.arr(e),o++;return s},arraycopy:function(t,e,o,s,n){for(var h=0;h<n;)o[h+s]=t[h+e],h++},lastNumberOfEvaluations:0,GetLastNumberOfEvaluations:function(){return this.lastNumberOfEvaluations},Normal:0,MaxIterationsReached:1,DivergingRoundingErrors:2,FindMinimum:function(t,e,o,s,n,h,l,p,d){var b,Z,y=o+2,O=this.arr(e+1),x=this;return this.lastNumberOfEvaluations=0,d&&console.log("Experimental feature 'testForRoundingErrors' is activated."),O[0]=0,this.arraycopy(s,0,O,1,e),Z=function(D,k,I,U){var J,z,V=x.arr(D);return x.lastNumberOfEvaluations=x.lastNumberOfEvaluations+1,x.arraycopy(I,1,V,0,D),J=x.arr(k),z=t(D,k,V,J),x.arraycopy(J,0,U,1,k),z},b=this.cobylb(Z,e,o,y,O,n,h,l,p,d),this.arraycopy(O,1,s,0,e),b},cobylb:function(t,e,o,s,n,h,l,p,d,b){var Z,y,O,x,D,k,I,U,J,z,V,W,$,nt,et,lt,ot,gt,vt,Tt,Rt,kt,Ft,te,qt,Pt,yt,mt,bt,pt=-1,At=0,zt=0,ft=e+1,wt=o+1,Ot=h,Lt=0,Wt=!1,Vt=!1,jt=0,It=0,Et=0,ee=this.arr(1+s),Jt=this.arr2(1+e,1+ft),Kt=this.arr2(1+e,1+e),Yt=this.arr2(1+s,1+ft),Je=this.arr2(1+e,1+wt),me=this.arr(1+e),Ne=this.arr(1+e),Ke=this.arr(1+e),ie=this.arr(1+e),$e=this.arr(1+e);for(p>=2&&console.log("The initial value of RHO is "+Ot+" and PARMU is set to zero."),U=0,k=1/Ot,y=1;y<=e;++y)Jt[y][ft]=n[y],Jt[y][y]=Ot,Kt[y][y]=k;J=ft,z=!1;t:for(;;){if(U>=d&&U>0){pt=this.MaxIterationsReached;break t}for(++U,At=t(e,o,n,ee),zt=0,x=1;x<=o;++x)zt=Math.max(zt,-ee[x]);if(U!==p-1&&p!==3||this.PrintIterationResult(U,At,zt,n,e,p),ee[wt]=At,ee[s]=zt,V=!0,!z){for(V=!1,y=1;y<=s;++y)Yt[y][J]=ee[y];if(U<=ft){if(J<=e)if(Yt[wt][ft]<=At)n[J]=Jt[J][ft];else{for(Jt[J][ft]=n[J],x=1;x<=s;++x)Yt[x][J]=Yt[x][ft],Yt[x][ft]=ee[x];for(x=1;x<=J;++x){for(Jt[J][x]=-Ot,k=0,y=x;y<=J;++y)k-=Kt[y][x];Kt[J][x]=k}}if(U<=e){n[J=U]+=Ot;continue t}}z=!0}e:for(;;){i:do{if(!V){for(W=Yt[wt][ft]+Lt*Yt[s][ft],$=ft,O=1;O<=e;++O)(k=Yt[wt][O]+Lt*Yt[s][O])<W?($=O,W=k):k===W&&Lt===0&&Yt[s][O]<Yt[s][$]&&($=O);if($<=e){for(y=1;y<=s;++y)k=Yt[y][ft],Yt[y][ft]=Yt[y][$],Yt[y][$]=k;for(y=1;y<=e;++y){for(k=Jt[y][$],Jt[y][$]=0,Jt[y][ft]+=k,I=0,x=1;x<=e;++x)Jt[y][x]-=k,I-=Kt[x][y];Kt[$][y]=I}}if(nt=0,b)for(y=1;y<=e;++y)for(O=1;O<=e;++O)k=this.DOT_PRODUCT_ROW_COL(Kt,y,Jt,O,1,e)-(y===O?1:0),nt=Math.max(nt,Math.abs(k));if(nt>.1){pt=this.DivergingRoundingErrors;break t}for(x=1;x<=wt;++x){for(ee[x]=-Yt[x][ft],O=1;O<=e;++O)$e[O]=Yt[x][O]+ee[x];for(y=1;y<=e;++y)Je[y][x]=(x===wt?-1:1)*this.DOT_PRODUCT_ROW_COL($e,-1,Kt,y,1,e)}for(Wt=!0,jt=.25*Ot,et=2.1*Ot,O=1;O<=e;++O){for(lt=0,ot=0,x=1;x<=e;++x)lt+=Kt[O][x]*Kt[O][x],ot+=Jt[x][O]*Jt[x][O];me[O]=1/Math.sqrt(lt),Ne[O]=Math.sqrt(ot),(me[O]<jt||Ne[O]>et)&&(Wt=!1)}if(!z&&!Wt){for(J=0,k=et,O=1;O<=e;++O)Ne[O]>k&&(J=O,k=Ne[O]);if(J===0)for(O=1;O<=e;++O)me[O]<k&&(J=O,k=me[O]);for(k=.5*Ot*me[J],x=1;x<=e;++x)ie[x]=k*Kt[J][x];for(gt=0,vt=0,Z=0,x=1;x<=wt;++x)Z=this.DOT_PRODUCT_ROW_COL(ie,-1,Je,x,1,e),x<wt&&(k=Yt[x][ft],gt=Math.max(gt,-Z-k),vt=Math.max(vt,Z-k));for(Tt=Lt*(gt-vt)>2*Z?-1:1,k=0,y=1;y<=e;++y)ie[y]=Tt*ie[y],Jt[y][J]=ie[y],k+=Kt[J][y]*ie[y];for(x=1;x<=e;++x)Kt[J][x]/=k;for(O=1;O<=e;++O){if(O!==J)for(k=this.DOT_PRODUCT_ROW_COL(Kt,O,ie,-1,1,e),x=1;x<=e;++x)Kt[O][x]-=k*Kt[J][x];n[O]=Jt[O][ft]+ie[O]}continue t}if(!(Vt=this.trstlp(e,o,Je,ee,Ot,ie))){for(k=0,x=1;x<=e;++x)k+=ie[x]*ie[x];if(k<.25*Ot*Ot){z=!0;break i}}for(Z=0,Rt=0,ee[wt]=0,x=1;x<=wt;++x)Z=ee[x]-this.DOT_PRODUCT_ROW_COL(ie,-1,Je,x,1,e),x<wt&&(Rt=Math.max(Rt,Z));if(Lt<1.5*(kt=(It=Yt[s][ft]-Rt)>0?Z/It:0)){for(Lt=2*kt,p>=2&&console.log("Increase in PARMU to "+Lt),Ft=Yt[wt][ft]+Lt*Yt[s][ft],O=1;O<=e;++O)if((k=Yt[wt][O]+Lt*Yt[s][O])<Ft||k===Ft&&Lt===0&&Yt[s][O]<Yt[s][ft])continue e}for(Et=Lt*It-Z,x=1;x<=e;++x)n[x]=Jt[x][ft]+ie[x];z=!0;continue t}for(V=!1,te=Yt[wt][ft]+Lt*Yt[s][ft]-(At+Lt*zt),Lt===0&&At===Yt[wt][ft]&&(Et=It,te=Yt[s][ft]-zt),qt=te<=0?1:0,J=0,O=1;O<=e;++O)(k=Math.abs(this.DOT_PRODUCT_ROW_COL(Kt,O,ie,-1,1,e)))>qt&&(J=O,qt=k),Ke[O]=k*me[O];for(Pt=1.1*Ot,D=0,O=1;O<=e;++O)if(Ke[O]>=jt||Ke[O]>=me[O]){if(k=Ne[O],te>0){for(k=0,x=1;x<=e;++x)k+=Math.pow(ie[x]-Jt[x][O],2);k=Math.sqrt(k)}k>Pt&&(D=O,Pt=k)}if(D>0&&(J=D),J!==0){for(k=0,y=1;y<=e;++y)Jt[y][J]=ie[y],k+=Kt[J][y]*ie[y];for(x=1;x<=e;++x)Kt[J][x]/=k;for(O=1;O<=e;++O)if(O!==J)for(k=this.DOT_PRODUCT_ROW_COL(Kt,O,ie,-1,1,e),x=1;x<=e;++x)Kt[O][x]-=k*Kt[J][x];for(x=1;x<=s;++x)Yt[x][J]=ee[x];if(te>0&&te>=.1*Et)continue e}}while(0);if(Wt){if(Ot<=l){pt=this.Normal;break t}if(yt=0,mt=0,(Ot*=.5)<=1.5*l&&(Ot=l),Lt>0){for(bt=0,x=1;x<=wt;++x){for(mt=yt=Yt[x][ft],y=1;y<=e;++y)yt=Math.min(yt,Yt[x][y]),mt=Math.max(mt,Yt[x][y]);x<=o&&yt<.5*mt&&(k=Math.max(mt,0)-yt,bt=bt<=0?k:Math.min(bt,k))}bt===0?Lt=0:mt-yt<Lt*bt&&(Lt=(mt-yt)/bt)}p>=2&&console.log("Reduction in RHO to "+Ot+"  and PARMU = "+Lt),p===2&&this.PrintIterationResult(U,Yt[wt][ft],Yt[s][ft],this.COL(Jt,ft),e,p)}else z=!1}}switch(pt){case this.Normal:if(p>=1&&console.log("%nNormal return from subroutine COBYLA%n"),Vt)return p>=1&&this.PrintIterationResult(U,At,zt,n,e,p),pt;break;case this.MaxIterationsReached:p>=1&&console.log("%nReturn from subroutine COBYLA because the MAXFUN limit has been reached.%n");break;case this.DivergingRoundingErrors:p>=1&&console.log("%nReturn from subroutine COBYLA because rounding errors are becoming damaging.%n")}for(x=1;x<=e;++x)n[x]=Jt[x][ft];return At=Yt[wt][ft],zt=Yt[s][ft],p>=1&&this.PrintIterationResult(U,At,zt,n,e,p),pt},trstlp:function(t,e,o,s,n,h){var l,p,d,b,Z,y,O,x,D,k,I,U,J,z,V,W,$,nt,et,lt,ot,gt,vt,Tt,Rt,kt,Ft,te,qt,Pt,yt,mt,bt,pt=0,At=0,zt=0,ft=this.arr2(1+t,1+t),wt=this.arr(2+e),Ot=this.arr(2+e),Lt=this.arr(1+t),Wt=this.arr(1+t),Vt=this.arr(2+e),jt=this.arr(2+e),It=e,Et=0;for(d=1;d<=t;++d)ft[d][d]=1,h[d]=0;if(l=0,p=0,e>=1){for(b=1;b<=e;++b)s[b]>p&&(p=s[b],l=b);for(b=1;b<=e;++b)jt[b]=b,Ot[b]=p-s[b]}Z=!0;do t:for(;;){(!Z||Z&&p===0)&&(l=It=e+1,jt[It]=It,Ot[It]=0),Z=!1,y=0,O=0,x=0,D=0;e:do{if(k=It===e?p:-this.DOT_PRODUCT_ROW_COL(h,-1,o,It,1,t),O===0||k<y?(y=k,At=Et,O=3):Et>At?(At=Et,O=3):--O,O===0)break t;if(I=0,l<=Et){if(l<Et){U=jt[l],J=Ot[l],b=l;do{for(W=jt[V=b+1],$=this.DOT_PRODUCT(this.PART(this.COL(ft,b),1,t),this.PART(this.COL(o,W),1,t)),pt=Math.sqrt($*$+wt[V]*wt[V]),nt=wt[V]/pt,et=$/pt,wt[V]=nt*wt[b],wt[b]=pt,d=1;d<=t;++d)pt=nt*ft[d][V]+et*ft[d][b],ft[d][V]=nt*ft[d][b]-et*ft[d][V],ft[d][b]=pt;jt[b]=W,Ot[b]=Ot[V],b=V}while(b<Et);jt[b]=U,Ot[b]=J}if(--Et,It>e)for(pt=1/wt[Et],b=1;b<=t;++b)Lt[b]=pt*ft[b][Et];else for(pt=this.DOT_PRODUCT_ROW_COL(Lt,-1,ft,Et+1,1,t),b=1;b<=t;++b)Lt[b]-=pt*ft[b][Et+1]}else{for(W=jt[l],b=1;b<=t;++b)Wt[b]=o[b][W];for(lt=0,b=t;b>Et;){for($=0,ot=0,d=1;d<=t;++d)$+=pt=ft[d][b]*Wt[d],ot+=Math.abs(pt);if(gt=ot+.1*Math.abs($),vt=ot+.2*Math.abs($),(ot>=gt||gt>=vt)&&($=0),lt===0)lt=$;else for(V=b+1,nt=$/(pt=Math.sqrt($*$+lt*lt)),et=lt/pt,lt=pt,d=1;d<=t;++d)pt=nt*ft[d][b]+et*ft[d][V],ft[d][V]=nt*ft[d][V]-et*ft[d][b],ft[d][b]=pt;--b}if(lt===0){I=-1,b=Et;do{for(Tt=0,Rt=0,d=1;d<=t;++d)Tt+=pt=ft[d][b]*Wt[d],Rt+=Math.abs(pt);if(gt=Rt+.1*Math.abs(Tt),vt=Rt+.2*Math.abs(Tt),Rt<gt&&gt<vt){if((pt=Tt/wt[b])>0&&jt[b]<=e&&(bt=Ot[b]/pt,(I<0||bt<I)&&(I=bt)),b>=2)for(kt=jt[b],d=1;d<=t;++d)Wt[d]-=pt*o[d][kt];Vt[b]=pt}else Vt[b]=0}while(--b>0);if(I<0)break t;for(b=1;b<=Et;++b)Ot[b]=Math.max(0,Ot[b]-I*Vt[b]);if(l<Et){U=jt[l],J=Ot[l],b=l;do{for(kt=jt[V=b+1],$=this.DOT_PRODUCT(this.PART(this.COL(ft,b),1,t),this.PART(this.COL(o,kt),1,t)),pt=Math.sqrt($*$+wt[V]*wt[V]),nt=wt[V]/pt,et=$/pt,wt[V]=nt*wt[b],wt[b]=pt,d=1;d<=t;++d)pt=nt*ft[d][V]+et*ft[d][b],ft[d][V]=nt*ft[d][b]-et*ft[d][V],ft[d][b]=pt;jt[b]=kt,Ot[b]=Ot[V],b=V}while(b<Et);jt[b]=U,Ot[b]=J}if((pt=this.DOT_PRODUCT(this.PART(this.COL(ft,Et),1,t),this.PART(this.COL(o,W),1,t)))===0)break t;wt[Et]=pt,Ot[l]=0,Ot[Et]=I}else wt[++Et]=lt,Ot[l]=Ot[Et],Ot[Et]=0;if(jt[l]=jt[Et],jt[Et]=W,It>e&&W!==It){for(b=Et-1,$=this.DOT_PRODUCT(this.PART(this.COL(ft,b),1,t),this.PART(this.COL(o,W),1,t)),pt=Math.sqrt($*$+wt[Et]*wt[Et]),nt=wt[Et]/pt,et=$/pt,wt[Et]=nt*wt[b],wt[b]=pt,d=1;d<=t;++d)pt=nt*ft[d][Et]+et*ft[d][b],ft[d][Et]=nt*ft[d][b]-et*ft[d][Et],ft[d][b]=pt;jt[Et]=jt[b],jt[b]=W,pt=Ot[b],Ot[b]=Ot[Et],Ot[Et]=pt}if(It>e)for(pt=1/wt[Et],b=1;b<=t;++b)Lt[b]=pt*ft[b][Et];else for(W=jt[Et],pt=(this.DOT_PRODUCT_ROW_COL(Lt,-1,o,W,1,t)-1)/wt[Et],b=1;b<=t;++b)Lt[b]-=pt*ft[b][Et]}for(Ft=n*n,qt=0,te=0,d=1;d<=t;++d)Math.abs(h[d])>=1e-6*n&&(Ft-=h[d]*h[d]),qt+=h[d]*Lt[d],te+=Lt[d]*Lt[d];if(Ft<=0)break t;if(pt=Math.sqrt(te*Ft),Math.abs(qt)>=1e-6*pt&&(pt=Math.sqrt(te*Ft+qt*qt)),x=D=Ft/(pt+qt),It===e){if(vt=x+.2*p,x>=(gt=x+.1*p)||gt>=vt)break e;x=Math.min(x,p)}for(b=1;b<=t;++b)Wt[b]=h[b]+x*Lt[b];if(It===e)for(zt=p,p=0,b=1;b<=Et;++b)pt=s[W=jt[b]]-this.DOT_PRODUCT_ROW_COL(Wt,-1,o,W,1,t),p=Math.max(p,pt);b=Et;do{for(Pt=0,yt=0,d=1;d<=t;++d)Pt+=pt=ft[d][b]*Wt[d],yt+=Math.abs(pt);if(gt=yt+.1*Math.abs(Pt),vt=yt+.2*Math.abs(Pt),(yt>=gt||gt>=vt)&&(Pt=0),Vt[b]=Pt/wt[b],b>=2)for(W=jt[b],d=1;d<=t;++d)Wt[d]-=Vt[b]*o[d][W]}while(b-->=2);for(It>e&&(Vt[Et]=Math.max(0,Vt[Et])),b=1;b<=t;++b)Wt[b]=h[b]+x*Lt[b];if(It>Et)for(b=Et+1;b<=It;++b){for(z=p-s[W=jt[b]],mt=p+Math.abs(s[W]),d=1;d<=t;++d)z+=pt=o[d][W]*Wt[d],mt+=Math.abs(pt);gt=mt+.1*Math.abs(z),vt=mt+.2*Math.abs(z),(mt>=gt||gt>=vt)&&(z=0),Vt[b]=z}for(I=1,l=0,b=1;b<=It;++b)Vt[b]<0&&(pt=Ot[b]/(Ot[b]-Vt[b]))<I&&(I=pt,l=b);for(pt=1-I,b=1;b<=t;++b)h[b]=pt*h[b]+I*Wt[b];for(b=1;b<=It;++b)Ot[b]=Math.max(0,pt*Ot[b]+I*Vt[b]);It===e&&(p=zt+I*(p-zt))}while(l>0);if(x===D)return!0}while(It===e);return!1},PrintIterationResult:function(t,e,o,s,n,h){h>1&&console.log("NFVALS = "+t+"  F = "+e+"  MAXCV = "+o),h>1&&console.log("X = "+this.PART(s,1,n))},ROW:function(t,e){return t[e].slice()},COL:function(t,e){var o,s=t.length,n=[];for(o=0;o<s;++o)n[o]=t[o][e];return n},PART:function(t,e,o){return t.slice(e,o+1)},FORMAT:function(t){return t.join(",")},DOT_PRODUCT:function(t,e){var o,s=0,n=t.length;for(o=0;o<n;++o)s+=t[o]*e[o];return s},DOT_PRODUCT_ROW_COL:function(t,e,o,s,n,h){var l,p=0;if(e===-1)for(l=n;l<=h;++l)p+=t[l]*o[l][s];else if(s===-1)for(l=n;l<=h;++l)p+=t[e][l]*o[l];else for(l=n;l<=h;++l)p+=t[e][l]*o[l][s];return p}},u.Z.Math.Nlp;var m=__webpack_require__(705),v=__webpack_require__(309),_=__webpack_require__(922);B.Z.Plot={checkReal:function(t){var e,o,s=!1,n=t.length;for(e=0;e<n;e++)if(o=t[e].usrCoords,!isNaN(o[1])&&!isNaN(o[2])&&Math.abs(o[0])>B.Z.eps){s=!0;break}return s},updateParametricCurveNaive:function(t,e,o,s){var n,h,l=!1,p=(o-e)/s;for(n=0;n<s;n++)h=e+n*p,t.points[n].setCoordinates(S.Z.COORDS_BY_USER,[t.X(h,l),t.Y(h,l)],!1),t.points[n]._t=h,l=!0;return t},isSegmentOutside:function(t,e,o,s,n){return e<0&&s<0||e>n.canvasHeight&&s>n.canvasHeight||t<0&&o<0||t>n.canvasWidth&&o>n.canvasWidth},isDistOK:function(t,e,o,s){return Math.abs(t)<o&&Math.abs(e)<s&&!isNaN(t+e)},isSegmentDefined:function(t,e,o,s){return!(isNaN(t+e)&&isNaN(o+s))},updateParametricCurveOld:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D=!1,k=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),I=[],U=[],J=[],z=[],V=!1,W=0,$=function(nt,et,lt){var ot,gt,vt=lt[1]-nt[1],Tt=lt[2]-nt[2],Rt=et[0]-nt[1],kt=et[1]-nt[2],Ft=Rt*Rt+kt*kt;return Ft>=B.Z.eps&&(ot=(vt*Rt+Tt*kt)/Ft)>0&&(ot<=1?(vt-=ot*Rt,Tt-=ot*kt):(vt-=Rt,Tt-=kt)),gt=vt*vt+Tt*Tt,Math.sqrt(gt)};for(u.Z.deprecated("Curve.updateParametricCurveOld()"),t.board.updateQuality===t.board.BOARD_QUALITY_LOW?(y=15,O=10,x=10):(y=21,O=.7,x=.7),z[0]=o-e,s=1;s<y;s++)z[s]=.5*z[s-1];s=1,I[0]=1,U[0]=0,n=e,k.setCoordinates(S.Z.COORDS_BY_USER,[t.X(n,D),t.Y(n,D)],!1),D=!0,p=k.scrCoords[1],d=k.scrCoords[2],n=o,k.setCoordinates(S.Z.COORDS_BY_USER,[t.X(n,D),t.Y(n,D)],!1),h=k.scrCoords[1],l=k.scrCoords[2],J[0]=[h,l],b=1,Z=0,t.points=[],t.points[W++]=new m.Z(S.Z.COORDS_BY_SCREEN,[p,d],t.board,!1);do{for(V=this.isDistOK(h-p,l-d,O,x)||this.isSegmentOutside(p,d,h,l,t.board);Z<y&&(!V||Z<6)&&(Z<=7||this.isSegmentDefined(p,d,h,l));)I[b]=s,U[b]=Z,J[b]=[h,l],b+=1,n=e+(s=2*s-1)*z[++Z],k.setCoordinates(S.Z.COORDS_BY_USER,[t.X(n,D),t.Y(n,D)],!1,!0),h=k.scrCoords[1],l=k.scrCoords[2],V=this.isDistOK(h-p,l-d,O,x)||this.isSegmentOutside(p,d,h,l,t.board);W>1&&$(t.points[W-2].scrCoords,[h,l],t.points[W-1].scrCoords)<.015&&(W-=1),t.points[W]=new m.Z(S.Z.COORDS_BY_SCREEN,[h,l],t.board,!1),t.points[W]._t=n,W+=1,p=h,d=l,h=J[b-=1][0],l=J[b][1],Z=U[b]+1,s=2*I[b]}while(b>0&&W<5e5);return t.numberPoints=t.points.length,t},_insertPoint_v2:function(t,e,o){var s=!isNaN(this._lastCrds[1]+this._lastCrds[2]),n=!isNaN(e.scrCoords[1]+e.scrCoords[2]),h=t.board.canvasWidth,l=t.board.canvasHeight,p=500;(!(n=n&&e.scrCoords[1]>-500&&e.scrCoords[2]>-500&&e.scrCoords[1]<h+p&&e.scrCoords[2]<l+p)&&s||n&&(!s||Math.abs(e.scrCoords[1]-this._lastCrds[1])>.7||Math.abs(e.scrCoords[2]-this._lastCrds[2])>.7))&&(e._t=o,t.points.push(e),this._lastCrds=e.copy("scrCoords"))},neighborhood_isNaN_v2:function(t,e){var o,s,n=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1);return o=e+B.Z.eps,n.setCoordinates(S.Z.COORDS_BY_USER,[t.X(o,!0),t.Y(o,!0)],!1),s=n.usrCoords,!!(isNaN(s[1]+s[2])||(o=e-B.Z.eps,n.setCoordinates(S.Z.COORDS_BY_USER,[t.X(o,!0),t.Y(o,!0)],!1),s=n.usrCoords,isNaN(s[1]+s[2])))},_borderCase:function(t,e,o,s,n,h,l,p){var d,b,Z,y,O,x,D,k=null,I=!1;if(p<=1){if(b=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),isNaN(e[1]+e[2])&&!isNaN(s[1]+s[2])&&!this.neighborhood_isNaN_v2(t,n)||isNaN(o[1]+o[2])&&!isNaN(s[1]+s[2])&&!this.neighborhood_isNaN_v2(t,h)||isNaN(s[1]+s[2])&&(!isNaN(e[1]+e[2])||!isNaN(o[1]+o[2]))&&!this.neighborhood_isNaN_v2(t,l))return!1;y=0;do{if(isNaN(e[1]+e[2])&&!isNaN(s[1]+s[2]))O=n,x=l,D=h;else if(isNaN(o[1]+o[2])&&!isNaN(s[1]+s[2]))O=h,x=l,D=n;else if(isNaN(s[1]+s[2])&&!isNaN(o[1]+o[2]))O=l,x=h,D=h+(h-l);else{if(!isNaN(s[1]+s[2])||isNaN(e[1]+e[2]))return!1;O=l,x=n,D=n-(l-n)}d=.5*(O+x),b.setCoordinates(S.Z.COORDS_BY_USER,[t.X(d,!0),t.Y(d,!0)],!1),Z=b.usrCoords,(I=isNaN(Z[1]+Z[2]))?O=d:(D=x,x=d),++y}while(I&&y<30);if(y<30&&(k=Z.slice(),s=Z.slice(),x=d),(t.X(x,!0)-t.X(D,!0))/(x-D),(t.Y(x,!0)-t.Y(D,!0))/(x-D),k!==null)return this._insertPoint_v2(t,new m.Z(S.Z.COORDS_BY_USER,k,t.board,!1)),!0}return!1},_plotRecursive_v2:function(t,e,o,s,n,h,l){var p,d,b,Z,y,O=0,x=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1);if(!(t.numberPoints>65536))return h<this.nanLevel&&this._isUndefined(t,e,o,s,n)||h<this.nanLevel&&this._isOutside(e,o,s,n,t.board)?this:(p=.5*(o+n),x.setCoordinates(S.Z.COORDS_BY_USER,[t.X(p,!0),t.Y(p,!0)],!1),d=x.scrCoords,this._borderCase(t,e,s,d,o,n,p,h)||(b=this._triangleDists(e,s,d),Z=h<this.smoothLevel&&b[3]<l,y=h<this.jumpLevel&&(b[2]>.99*b[0]||b[1]>.99*b[0]||b[0]===1/0||b[1]===1/0||b[2]===1/0),h<this.smoothLevel+2&&b[0]<.5*(b[1]+b[2])&&(O=0,Z=!1),--h,y?this._insertPoint_v2(t,new m.Z(S.Z.COORDS_BY_SCREEN,[NaN,NaN],t.board,!1),p):h<=O||Z?this._insertPoint_v2(t,x,p):(this._plotRecursive_v2(t,e,o,d,p,h,l),isNaN(x.scrCoords[1]+x.scrCoords[2])||this._insertPoint_v2(t,x,p),this._plotRecursive_v2(t,d,p,s,n,h,l))),this)},updateParametricCurve_v2:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O=!1,x=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),D=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1);return t.board.updateQuality===t.board.BOARD_QUALITY_LOW?(p=a.Z.evaluate(t.visProp.recursiondepthlow)||13,d=2,this.smoothLevel=p-6,this.jumpLevel=3):(p=a.Z.evaluate(t.visProp.recursiondepthhigh)||17,d=2,this.smoothLevel=p-9,this.jumpLevel=2),this.nanLevel=p-4,t.points=[],this.xterm==="x"?(b=.3*((Z=t.board.getBoundingBox())[2]-Z[0]),.3*(Z[1]-Z[3]),s=Math.max(e,Z[0]-b),n=Math.min(o,Z[2]+b)):(s=e,n=o),x.setCoordinates(S.Z.COORDS_BY_USER,[t.X(s,O),t.Y(s,O)],!1),O=!0,D.setCoordinates(S.Z.COORDS_BY_USER,[t.X(n,O),t.Y(n,O)],!1),y=this._findStartPoint(t,x.scrCoords,s,D.scrCoords,n),x.setCoordinates(S.Z.COORDS_BY_SCREEN,y[0],!1),s=y[1],y=this._findStartPoint(t,D.scrCoords,n,x.scrCoords,s),D.setCoordinates(S.Z.COORDS_BY_SCREEN,y[0],!1),n=y[1],this._visibleArea=[s,n],h=x.copy("scrCoords"),l=D.copy("scrCoords"),x._t=s,t.points.push(x),this._lastCrds=x.copy("scrCoords"),this._plotRecursive_v2(t,h,s,l,n,p,d),D._t=n,t.points.push(D),t.numberPoints=t.points.length,t},_insertLimesPoint:function(t,e,o,s,n){var h,l,p;Math.abs(this._lastUsrCrds[1])===1/0&&Math.abs(n.left_x)===1/0||Math.abs(this._lastUsrCrds[2])===1/0&&Math.abs(n.left_y)===1/0||((h=new m.Z(S.Z.COORDS_BY_USER,[n.left_x,n.left_y],t.board))._t=o,t.points.push(h),isNaN(n.left_x)||isNaN(n.left_y)||isNaN(n.right_x)||isNaN(n.right_y)||!(Math.abs(n.left_x-n.right_x)>B.Z.eps||Math.abs(n.left_y-n.right_y)>B.Z.eps)||((l=new m.Z(S.Z.COORDS_BY_SCREEN,e,t.board))._t=o,t.points.push(l)),(p=new m.Z(S.Z.COORDS_BY_USER,[n.right_x,n.right_y],t.board))._t=o,t.points.push(p),this._lastScrCrds=p.copy("scrCoords"),this._lastUsrCrds=p.copy("usrCoords"))},_insertPoint:function(t,e,o,s,n){var h,l=!isNaN(this._lastScrCrds[1]+this._lastScrCrds[2]),p=!isNaN(e[1]+e[2]),d=t.board.canvasWidth,b=t.board.canvasHeight,Z=500;a.Z.exists(n)?this._insertLimesPoint(t,e,o,s,n):(p=p&&e[1]>-500&&e[2]>-500&&e[1]<d+Z&&e[2]<b+Z,(l||p)&&(p&&l&&Math.abs(e[1]-this._lastScrCrds[1])<.8&&Math.abs(e[2]-this._lastScrCrds[2])<.8||Math.abs(e[1])===1/0&&Math.abs(this._lastUsrCrds[1])===1/0||Math.abs(e[2])===1/0&&Math.abs(this._lastUsrCrds[2])===1/0||((h=new m.Z(S.Z.COORDS_BY_SCREEN,e,t.board))._t=o,t.points.push(h),this._lastScrCrds=h.copy("scrCoords"),this._lastUsrCrds=h.copy("usrCoords"))))},_triangleDists:function(t,e,o){var s;return s=[t[0]*e[0],.5*(t[1]+e[1]),.5*(t[2]+e[2])],[_.Z.distance(t,e,3),_.Z.distance(t,o,3),_.Z.distance(o,e,3),_.Z.distance(o,s,3)]},_isUndefined:function(t,e,o,s,n){var h,l,p;if(!isNaN(e[1]+e[2])||!isNaN(s[1]+s[2]))return!1;for(p=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),l=0;l<20;++l)if(h=o+Math.random()*(n-o),p.setCoordinates(S.Z.COORDS_BY_USER,[t.X(h,!0),t.Y(h,!0)],!1),!isNaN(p.scrCoords[0]+p.scrCoords[1]+p.scrCoords[2]))return!1;return!0},_isOutside:function(t,e,o,s,n){var h=500,l=n.canvasWidth,p=n.canvasHeight;return t[1]<-500&&o[1]<-500||t[2]<-500&&o[2]<-500||t[1]>l+h&&o[1]>l+h||t[2]>p+h&&o[2]>p+h},_isOutsidePoint:function(t,e){var o=500,s=e.canvasWidth,n=e.canvasHeight;return t[1]<-500||t[2]<-500||t[1]>s+o||t[2]>n+o},_findStartPoint:function(t,e,o,s,n){return[e,o]},_getBorderPos:function(t,e,o,s,n,h,l){var p,d,b,Z,y,O;if(d=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),Z=0,isNaN(o[1]+o[2])&&!isNaN(n[1]+n[2]))O=e,y=s;else if(isNaN(l[1]+l[2])&&!isNaN(n[1]+n[2]))O=h,y=s;else if(isNaN(n[1]+n[2])&&!isNaN(l[1]+l[2]))O=s,y=h;else{if(!isNaN(n[1]+n[2])||isNaN(o[1]+o[2]))return!1;O=s,y=e}do p=.5*(y+O),d.setCoordinates(S.Z.COORDS_BY_USER,[t.X(p,!0),t.Y(p,!0)],!1),b=d.usrCoords,isNaN(b[1]+b[2])?O=p:y=p,++Z;while(Z<30&&Math.abs(y-O)>B.Z.eps);return p},_getCuspPos:function(t,e,o){var s=[t.X(e,!0),t.Y(e,!0)],n=[t.X(o,!0),t.Y(o,!0)];return c.Z.fminbr(function(h){var l=[t.X(h,!0),t.Y(h,!0)];return-(Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))+Math.sqrt((n[0]-l[0])*(n[0]-l[0])+(n[1]-l[1])*(n[1]-l[1])))},[e,o],t)},_getJumpPos:function(t,e,o){return c.Z.fminbr(function(s){var n=B.Z.eps*B.Z.eps,h=[t.X(s,!0),t.Y(s,!0)],l=[t.X(s+n,!0),t.Y(s+n,!0)];return-Math.abs((l[1]-h[1])/(l[0]-h[0]))},[e,o],t)},_getLimits:function(t,e){var o,s,n,h,l,p=2/(t.maxX()-t.minX());return s=(o=A.limit(e,-p,t.X))[0],o[1]==="infinite"&&(s=Math.sign(s)*(1/0)),h=(o=A.limit(e,-p,t.Y))[0],o[1]==="infinite"&&(h=Math.sign(h)*(1/0)),n=(o=A.limit(e,p,t.X))[0],o[1]==="infinite"&&(n=Math.sign(n)*(1/0)),l=(o=A.limit(e,p,t.Y))[0],o[1]==="infinite"&&(l=Math.sign(l)*(1/0)),{left_x:s,left_y:h,right_x:n,right_y:l,t:e}},_getLimes:function(t,e,o,s,n,h,l,p,d){var b;return p==="border"?b=this._getBorderPos(t,e,o,s,n,h,l):p==="cusp"?b=this._getCuspPos(t,e,h):p==="jump"&&(b=this._getJumpPos(t,e,h)),this._getLimits(t,b)},_plotNonRecursive:function(t,e,o,s,n,h){var l,p,d,b,Z,y,O,x,D,k,I,U=null,J=!1,z="",V=[],W=0;for(x=t.board.origin.scrCoords,V[W++]=[e,o,s,n,h,1/0];W>0;){if(e=(I=V[--W])[0],o=I[1],s=I[2],n=I[3],D=I[4],k=I[5],J=!1,z="",U=null,t.points.length>65536)return;D<this.nanLevel&&(this._isUndefined(t,e,o,s,n)||this._isOutside(e,o,s,n,t.board))||(l=.5*(o+n),y=t.X(l,!0),O=t.Y(l,!0),p=[1,x[1]+y*t.board.unitX,x[2]-O*t.board.unitY],d=this._triangleDists(e,s,p),b=isNaN(e[1]+e[2]),Z=isNaN(s[1]+s[2]),b&&!Z||!b&&Z?z="border":d[0]>.66*k||d[0]<this.cusp_threshold*(d[1]+d[2])||d[1]>5*d[2]||d[2]>5*d[1]?z="cusp":(d[2]>this.jump_threshold*d[0]||d[1]>this.jump_threshold*d[0]||d[0]===1/0||d[1]===1/0||d[2]===1/0)&&(z="jump"),J=z===""&&D<this.smoothLevel&&d[3]<this.smooth_threshold,D<this.testLevel&&!J&&(z===""?J=!0:U=this._getLimes(t,o,e,l,p,n,s,z,D)),U!==null?(p=[1,NaN,NaN],this._insertPoint(t,p,l,D,U)):D<=0||J?this._insertPoint(t,p,l,D,null):(V[W++]=[p,l,s,n,D-1,d[0]],V[W++]=[e,o,p,l,D-1,d[0]]))}return this},updateParametricCurve_v3:function(t,e,o){var s,n,h,l,p,d,b,Z,y=!1,O=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1),x=new m.Z(S.Z.COORDS_BY_USER,[0,0],t.board,!1);return p=t.board.updateQuality===t.board.BOARD_QUALITY_LOW?a.Z.evaluate(t.visProp.recursiondepthlow)||14:a.Z.evaluate(t.visProp.recursiondepthhigh)||17,this.smoothLevel=7,this.nanLevel=p-4,this.testLevel=4,this.cusp_threshold=.5,this.jump_threshold=.99,this.smooth_threshold=2,t.points=[],t.xterm==="x"?(d=.3*((b=t.board.getBoundingBox())[2]-b[0]),s=Math.max(e,b[0]-d),n=Math.min(o,b[2]+d)):(s=e,n=o),O.setCoordinates(S.Z.COORDS_BY_USER,[t.X(s,y),t.Y(s,y)],!1),y=!0,x.setCoordinates(S.Z.COORDS_BY_USER,[t.X(n,y),t.Y(n,y)],!1),Z=this._findStartPoint(t,O.scrCoords,s,x.scrCoords,n),O.setCoordinates(S.Z.COORDS_BY_SCREEN,Z[0],!1),s=Z[1],Z=this._findStartPoint(t,x.scrCoords,n,O.scrCoords,s),x.setCoordinates(S.Z.COORDS_BY_SCREEN,Z[0],!1),n=Z[1],this._visibleArea=[s,n],h=O.copy("scrCoords"),l=x.copy("scrCoords"),O._t=s,t.points.push(O),this._lastScrCrds=O.copy("scrCoords"),this._lastUsrCrds=O.copy("usrCoords"),this._plotNonRecursive(t,h,s,l,n,p),x._t=n,t.points.push(x),t.numberPoints=t.points.length,t},_criticalInterval:function(t,e,o){var s,n,h,l,p,d,b,Z=!1,y=-1/0,O=!1,x=!1,D=0,k=[],I=[],U=[];for(b=v.Z.abs(t),(l=v.Z.median(b))<1e-7?(l=1e-7,O=!0):l*=this.criticalThreshold,s=0;s<e;s++)b[s]>l?(U.push({i:s,v:t[s],group:D}),y=s,Z||(Z=!0)):Z&&s>y+4&&(U.length>0&&k.push(U.slice(0)),U=[],Z=!1,D++);for(Z&&U.length>1&&k.push(U.slice(0)),O&&k.length===0&&(x=!0),n=0;n<k.length;n++)if(I[n]="point",!((h=k[n].length)<64)){for(d=0,p=Math.sign(k[n][0].v),s=1;s<h;s++)Math.sign(k[n][s].v)!==p&&(d++,p=Math.sign(k[n][s].v));6*d>h&&(I[n]="interval")}return{smooth:x,groups:k,types:I}},Component:function(){this.left_isNaN=!1,this.right_isNaN=!1,this.left_t=null,this.right_t=null,this.t_values=[],this.x_values=[],this.y_values=[],this.len=0},findComponents:function(t,e,o,s){var n,h,l,p,d,b,Z=[],y=0,O=0,x=0,D=!1,k=!1;for(l=(o-e)/s,Z[y]=new this.Component,b=Z[y],n=0,h=e;n<=s;n++,h+=l)p=t.X(h,k),d=t.Y(h,k),isNaN(p)||isNaN(d)?++x>1&&D&&(b.right_isNaN=!0,b.right_t=h-l,b.len=O,D=!1,Z[++y]=new this.Component,b=Z[y],x=0):(D||(D=!0,O=0,x>0&&(b.left_t=h-l,b.left_isNaN=!0)),x=0,b.t_values[O]=h,b.x_values[O]=p,b.y_values[O]=d,O++),n===0&&(k=!0);return D?b.len=O:Z.pop(),Z},getPointType:function(t,e,o,s,n,h,l){var p=n[0],d=h[0],b=s.length,Z={idx:e,t:o,x:p[e],y:d[e],type:"other"};return e<5?(Z.type="borderleft",Z.idx=0,Z.t=s[0],Z.x=p[0],Z.y=d[0],Z):(e>l-6&&(Z.type="borderright",Z.idx=b-1,Z.t=s[b-1],Z.x=p[b-1],Z.y=d[b-1]),Z)},newtonApprox:function(t,e,o,s,n){var h,l=0;for(h=s;h>0;h--)l=(l+n[h][t])*(e-(h-1)*o)/h;return l+n[0][t]},thiele:function(t,e,o,s,n){var h,l=0;for(h=n;h>1;h--)l=(t-o[s+h])/(e[h][s+1]-e[h-2][s+1]+l);return e[0][s+1]+(t-o[s+1])/(e[1][s+1]+l)},differenceMethodExperiments:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O,x=t.t_values,D=t.x_values,k=t.y_values,I=[],U=[],J=[],z=[],V=[],W=[],$=[],nt=[],et=0,lt=[];for(l=x[1]-x[0],V.push([]),W.push([]),$.push([]),nt.push([]),n=k.length,o=0;o<n;o++)V[0][o]=D[o],W[0][o]=k[o],$[0][o]=D[o],nt[0][o]=k[o];for(V.push([]),W.push([]),$.push([]),nt.push([]),p=l,n=k.length-1,o=0;o<n;o++)I[o]=D[o+1]-D[o],U[o]=k[o+1]-k[o],J[o]=I[o],z[o]=U[o],V[1][o]=I[o],W[1][o]=U[o],$[1][o]=p/I[o],nt[1][o]=p/U[o];for(n--,h=Math.min(8,k.length-1),s=1;s<h;s++){for(V.push([]),W.push([]),$.push([]),nt.push([]),p*=l,o=0;o<n;o++)I[o]=I[o+1]-I[o],U[o]=U[o+1]-U[o],V[s+1][o]=I[o],W[s+1][o]=U[o],$[s+1][o]=p/($[s][o+1]-$[s][o])+$[s-1][o+1],nt[s+1][o]=p/(nt[s][o+1]-nt[s][o])+nt[s-1][o+1];if((O=this._criticalPoints(U,n,s))===!1){console.log("Polynomial of degree",s),O=[];break}if(O.length>0&&++et>1&&s%2==0)break;n--}for(o=0;o<O.length;o++){for(b=-1/0,Z=0;Z<O[o].length;Z++)(y=Math.abs(O[o][Z].v))>b&&(b=y,d=Z);d=Math.floor(O[o][d].i+s/2),lt.push(this.getPointType(e,d,x,D,k,J,z,n+1))}return[lt,V,W,$,nt]},getCenterOfCriticalInterval:function(t,e,o){var s,n,h,l,p,d=0,b=0,Z=o[1]-o[0],y=[];for(s=-1/0,y=[],n=0;n<t.length;n++)(l=Math.abs(t[n].v))>s?(y=[n],s=l,h=n):s===l&&y.push(n);if(y.length>0&&(p=y.reduce(function(O,x){return O+x},0)/y.length,h=Math.floor(p),p+=t[0].i),s<1/0){for(n=0;n<t.length;n++)d+=Math.abs(t[n].v)*t[n].i,b+=Math.abs(t[n].v);p=d/b}return p+=e/2,[t[h].i+e/2,p,o[Math.floor(p)]+Z*(p-Math.floor(p))]},differenceMethod:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O=t.t_values,x=t.x_values,D=t.y_values,k=[],I=[],U=0,J=-1,z=-1,V=[],W=[];for(n=D.length,k.push(new Float64Array(x)),I.push(new Float64Array(D)),n--,h=Math.min(12,n),s=0;s<h&&(k.push(new Float64Array(n)),I.push(new Float64Array(n)),k[s+1]=k[s].map(function($,nt,et){return et[nt+1]-$}),I[s+1]=I[s].map(function($,nt,et){return et[nt+1]-$}),(b=this._criticalInterval(I[s+1],n,s)).smooth===!0&&(z=s,V=[]),d=this._criticalInterval(k[s+1],n,s),J===-1&&d.smooth===!0&&(J=s),!(z>=0));s++){if(b.groups.length>0&&++U>2&&(s+1)%2==0){V=b.groups,y=b.types;break}n--}for(o=0;o<V.length;o++)y[o]!=="interval"&&(p=this.getCenterOfCriticalInterval(V[o],s+1,O),b[0],l=Math.floor(p[1]),Z=p[2],W.push(this.getPointType(e,l,Z,O,k,I,n+1)));return[W,k,I,J,z]},_insertPoint_v4:function(t,e,o,s){var n,h,l,p=null;t.points.length>0&&(p=t.points[t.points.length-1].scrCoords),n=new m.Z(S.Z.COORDS_BY_USER,e,t.board),p!==null&&(h=n.scrCoords[1]-p[1])*h+(l=n.scrCoords[2]-p[2])*l<.8*.8||(n._t=o,t.points.push(n))},getInterval:function(t,e,o){var s,n;return R.Z.disable(),s=R.Z.Interval(e,o),t.board.mathLib=R.Z,t.board.mathLibJXG=R.Z,t.X(s,!0),n=t.Y(s,!0),t.board.mathLib=Math,t.board.mathLibJXG=u.Z.Math,n},sign:function(t){return t<0?-1:t>0?1:0},handleBorder:function(t,e,o,s,n){var h,l,p,d,b,Z,y,O,x,D,k,I,U=o.idx;if(I=e.t_values[1]-e.t_values[0],o.type==="borderleft"?p=(l=h=e.left_isNaN?e.left_t:o.t-I)+I:o.type==="borderright"?l=(p=h=e.right_isNaN?e.right_t:o.t+I)-I:console.log("No bordercase!!!"),(D=this.findComponents(t,l,p,32)).length!==0){for(o.type==="borderleft"&&(l=D[0].left_t,p=D[0].t_values[0],I=D[0].t_values[1]-D[0].t_values[0],h=l=l===null?p-I:l,d=this.getInterval(t,l,p),a.Z.isObject(d)&&(y=d.lo,O=d.hi,b=t.X(h,!0),Z=n[1][U]<0?O:y,this._insertPoint_v4(t,[1,b,Z],h))),k=D[0].t_values.length,x=0;x<k;x++)h=D[0].t_values[x],b=D[0].x_values[x],Z=D[0].y_values[x],this._insertPoint_v4(t,[1,b,Z],h);o.type==="borderright"&&(l=D[0].t_values[k-1],p=D[0].right_t,I=D[0].t_values[1]-D[0].t_values[0],h=p=p===null?l+I:p,d=this.getInterval(t,l,p),a.Z.isObject(d)&&(y=d.lo,O=d.hi,b=t.X(h,!0),Z=n[1][U]>0?O:y,this._insertPoint_v4(t,[1,b,Z],h)))}},_seconditeration_v4:function(t,e,o,s,n){var h,l,p,d,b,Z,y,O,x,D,k,I,U;for(l=e.t_values[o.idx-2],p=e.t_values[o.idx+2],b=this.findComponents(t,l,p,64),y=0;y<b.length;y++){for(Z=b[y],O=(d=this.differenceMethod(Z,t))[0],D=d[1],k=d[2],I=0,x=0;x<=O.length;x++){for(U=x===O.length?Z.len:O[x].idx,h=I;h<U;h++)isNaN(Z.x_values[h])||isNaN(Z.y_values[h])||this._insertPoint_v4(t,[1,Z.x_values[h],Z.y_values[h]],Z.t_values[h]);x<O.length&&(this.handleSingularity(t,Z,O[x],D,k),I=O[x].idx+1)}U=Z.len,y<b.length-1&&this._insertPoint_v4(t,[1,NaN,NaN],Z.right_t)}return this},_recurse_v4:function(t,e,o,s,n,h,l,p){var d,b,Z=.5*(e+o),y=t.X(Z,!0),O=t.Y(Z,!0);p!==0?(d=(y-s)*t.board.unitX,b=(O-n)*t.board.unitY,Math.sqrt(d*d+b*b)>2?this._recurse_v4(t,e,Z,s,n,y,O,p-1):this._insertPoint_v4(t,[1,y,O],Z),d=(y-h)*t.board.unitX,b=(O-l)*t.board.unitY,Math.sqrt(d*d+b*b)>2?this._recurse_v4(t,Z,o,y,O,h,l,p-1):this._insertPoint_v4(t,[1,y,O],Z)):this._insertPoint_v4(t,[1,NaN,NaN],Z)},handleSingularity:function(t,e,o,s,n){var h,l,p,d,b,Z,y,O,x,D,k,I=o.idx,U=100;h=o.t,console.log("HandleSingularity at t =",h),l=e.t_values[I-5],p=e.t_values[I+5],d=this.getInterval(t,l,p),a.Z.isObject(d)?(O=d.lo,x=d.hi):n[0][I-1]<n[0][I+1]?(O=n[0][I-1],x=n[0][I+1]):(O=n[0][I+1],x=n[0][I-1]),y=t.X(h,!0),D=(n[0][I-3]-n[0][I-5])/(e.t_values[I-3]-e.t_values[I-5]),k=(n[0][I+3]-n[0][I+5])/(e.t_values[I+3]-e.t_values[I+5]),console.log(":::",D,k),D<-100?(this._insertPoint_v4(t,[1,y,O],h,!0),k<=U&&this._insertPoint_v4(t,[1,NaN,NaN],h)):D>U?(this._insertPoint_v4(t,[1,y,x],h),k>=-100&&this._insertPoint_v4(t,[1,NaN,NaN],h)):(O===-1/0&&(this._insertPoint_v4(t,[1,y,O],h,!0),this._insertPoint_v4(t,[1,NaN,NaN],h)),x===1/0&&(this._insertPoint_v4(t,[1,NaN,NaN],h),this._insertPoint_v4(t,[1,y,x],h,!0)),o.t<e.t_values[I]?(b=I-1,Z=I):(b=I,Z=I+1),l=e.t_values[b],p=e.t_values[Z],this._recurse_v4(t,l,p,s[0][b],n[0][b],s[0][Z],n[0][Z],10)),k<-100?this._insertPoint_v4(t,[1,y,x],h):k>U&&this._insertPoint_v4(t,[1,y,O],h)},steps:1021,criticalThreshold:1e3,plot_v4:function(t,e,o,s){var n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z=(o-e)/s,V=function(nt){return t.Y(nt,!0)},W=function(nt){return-t.Y(nt,!0)},$=.5*z;for(l=this.findComponents(t,e,o,s),p=0;p<l.length;p++){for(d=l[p],b=(O=this.differenceMethod(d,t))[0],x=O[1],D=O[2],O[3],O[4],b.length!==0&&b[0].type==="borderleft"||b.unshift({idx:0,t:d.t_values[0],x:d.x_values[0],y:d.y_values[0],type:"borderleft"}),b[b.length-1].type!=="borderright"&&(h=d.t_values.length,b.push({idx:h-1,t:d.t_values[h-1],x:d.x_values[h-1],y:d.y_values[h-1],type:"borderright"})),y=0,Z=0;Z<=b.length;Z++){for(h=Z===b.length?d.len:b[Z].idx-1,n=y;n<h-2;n++)this._insertPoint_v4(t,[1,d.x_values[n],d.y_values[n]],d.t_values[n]),n>=y+3&&n<h-3&&D.length>3&&Math.abs(D[2][n])>.2*Math.abs(D[0][n])&&(k=d.t_values[n],$=.25*z,J=this.getInterval(t,k,k+z),a.Z.isObject(J)?D[2][n]>0?this._insertPoint_v4(t,[1,k+$,J.lo],k+$):this._insertPoint_v4(t,[1,k+z-$,J.hi],k+z-$):(I=c.Z.fminbr(V,[k,k+z]))<(U=c.Z.fminbr(W,[k,k+z]))?(this._insertPoint_v4(t,[1,t.X(I,!0),t.Y(I,!0)],I),this._insertPoint_v4(t,[1,t.X(U,!0),t.Y(U,!0)],U)):(this._insertPoint_v4(t,[1,t.X(U,!0),t.Y(U,!0)],U),this._insertPoint_v4(t,[1,t.X(I,!0),t.Y(I,!0)],I)));Z<b.length&&(n=b[Z].idx,b[Z].type==="borderleft"||b[Z].type==="borderright"?this.handleBorder(t,d,b[Z],x,D):this._seconditeration_v4(t,d,b[Z],x,D),y=b[Z].idx+1+1)}h=d.len,p<l.length-1&&this._insertPoint_v4(t,[1,NaN,NaN],d.right_t)}},updateParametricCurve_v4:function(t,e,o){var s,n,h,l;t.xterm==="x"?(h=.3*((l=t.board.getBoundingBox())[2]-l[0]),s=Math.max(e,l[0]-h),n=Math.min(o,l[2]+h)):(s=e,n=o),t.points=[],this.plot_v4(t,s,n,this.steps),t.numberPoints=t.points.length},updateParametricCurve:function(t,e,o){return this.updateParametricCurve_v2(t,e,o)}};const f=B.Z.Plot;B.Z.Metapost={MP_ENDPOINT:0,MP_EXPLICIT:1,MP_GIVEN:2,MP_CURL:3,MP_OPEN:4,MP_END_CYCLE:5,UNITY:1,FRACTION_ONE:1,FRACTION_THREE:3,ONE_EIGHTY_DEG:Math.PI,THREE_SIXTY_DEG:2*Math.PI,EPS_SQ:1e-5*1e-5,make_choices:function(t){var e,o,s,n,h,l,p,d,b,Z,y,O,x,D,k;p=t[0];do{if(!p)break;l=p.next,p.rtype>this.MP_EXPLICIT&&(p.x-l.x)*(p.x-l.x)+(p.y-l.y)*(p.y-l.y)<this.EPS_SQ&&(p.rtype=this.MP_EXPLICIT,p.ltype===this.MP_OPEN&&(p.ltype=this.MP_CURL,p.set_left_curl(this.UNITY)),l.ltype=this.MP_EXPLICIT,l.rtype===this.MP_OPEN&&(l.rtype=this.MP_CURL,l.set_right_curl(this.UNITY)),p.rx=p.x,l.lx=p.x,p.ry=p.y,l.ly=p.y),p=l}while(p!==t[0]);for(o=t[0];o.ltype===this.MP_OPEN&&o.rtype===this.MP_OPEN;)if((o=o.next)===t[0]){o.ltype=this.MP_END_CYCLE;break}for(p=o;p;){if(l=p.next,p.rtype>=this.MP_GIVEN){for(;l.ltype===this.MP_OPEN&&l.rtype===this.MP_OPEN;)l=l.next;for(s=0,d=p,h=t.length,O=[],x=[],D=[],k=[null];Z=d.next,O.push(Z.x-d.x),x.push(Z.y-d.y),D.push(this.mp_pyth_add(O[s],x[s])),s>0&&(y=x[s-1]/D[s-1],b=O[s-1]/D[s-1],k.push(Math.atan2(x[s]*b-O[s]*y,O[s]*b+x[s]*y))),s++,(d=Z)===l&&(h=s),!(s>=h&&d.ltype!==this.MP_END_CYCLE););s===h?k.push(0):k.push(k[1]),l.ltype===this.MP_OPEN&&((n=l.rx-l.x)*n+(e=l.ry-l.y)*e<this.EPS_SQ?(l.ltype=this.MP_CURL,l.set_left_curl(this.UNITY)):(l.ltype=this.MP_GIVEN,l.set_left_given(Math.atan2(e,n)))),p.rtype===this.MP_OPEN&&p.ltype===this.MP_EXPLICIT&&((n=p.x-p.lx)*n+(e=p.y-p.ly)*e<this.EPS_SQ?(p.rtype=this.MP_CURL,p.set_right_curl(this.UNITY)):(p.rtype=this.MP_GIVEN,p.set_right_given(Math.atan2(e,n)))),this.mp_solve_choices(p,l,h,O,x,D,k)}else p.rtype===this.MP_ENDPOINT&&(p.rx=p.x,p.ry=p.y,l.lx=l.x,l.ly=l.y);if((p=l)===o)break}},mp_solve_choices:function(t,e,o,s,n,h,l){var p,d,b,Z,y,O,x,D,k,I,U,J,z,V,W,$,nt,et,lt,ot,gt,vt,Tt,Rt,kt,Ft;for(y=h.length+1,I=new Array(y),k=new Array(y),b=new Array(y),W=new Array(y),kt=0;kt<y;kt++)W[kt]=b[kt]=k[kt]=I[kt]=0;for(x=0,D=t,J=0;;){if(z=D.next,x===0)if(D.rtype===this.MP_GIVEN){if(z.ltype===this.MP_GIVEN)return p=Math.atan2(n[0],s[0]),ot=(lt=this.mp_n_sin_cos(t.right_given()-p))[0],gt=lt[1],Tt=(vt=this.mp_n_sin_cos(e.left_given()-p))[0],Rt=vt[1],void this.mp_set_controls(t,e,s[0],n[0],gt,ot,-Rt,Tt);b[0]=D.right_given()-Math.atan2(n[0],s[0]),b[0]=this.reduce_angle(b[0]),I[0]=0,k[0]=0}else if(D.rtype===this.MP_CURL){if(z.ltype===this.MP_CURL)return t.rtype=this.MP_EXPLICIT,e.ltype=this.MP_EXPLICIT,U=Math.abs(e.left_tension()),$=Math.abs(t.right_tension()),V=this.UNITY/(3*$),t.rx=t.x+s[0]*V,t.ry=t.y+n[0]*V,V=this.UNITY/(3*U),e.lx=e.x-s[0]*V,void(e.ly=e.y-n[0]*V);et=D.right_curl(),U=Math.abs(z.left_tension()),$=Math.abs(D.right_tension()),I[0]=this.mp_curl_ratio(et,$,U),b[0]=-l[1]*I[0],k[0]=0}else D.rtype===this.MP_OPEN&&(I[0]=0,b[0]=0,k[0]=this.FRACTION_ONE);else if(D.ltype===this.MP_END_CYCLE||D.ltype===this.MP_OPEN){if(p=this.UNITY/(3*Math.abs(J.right_tension())-this.UNITY),nt=h[x]*(this.FRACTION_THREE-this.UNITY/Math.abs(J.right_tension())),Z=this.UNITY/(3*Math.abs(z.left_tension())-this.UNITY),O=h[x-1]*(this.FRACTION_THREE-this.UNITY/Math.abs(z.left_tension())),nt*=et=this.FRACTION_ONE-I[x-1]*p,(U=Math.abs(D.left_tension()))<($=Math.abs(D.right_tension()))?nt*=Math.pow(U/$,2):U>$&&(O*=Math.pow($/U,2)),V=O/(O+nt),I[x]=V*Z,d=-l[x+1]*I[x],J.rtype===this.MP_CURL?(k[x]=0,b[x]=d-l[1]*(this.FRACTION_ONE-V)):(V=(this.FRACTION_ONE-V)/et,d-=l[x]*V,V*=p,b[x]=d-b[x-1]*V,k[x]=-k[x-1]*V),D.ltype===this.MP_END_CYCLE){for(p=0,Z=this.FRACTION_ONE;(x-=1)===0&&(x=o),p=b[x]-p*I[x],Z=k[x]-Z*I[x],x!==o;);for(p/=this.FRACTION_ONE-Z,W[o]=p,b[0]=p,Ft=1;Ft<o;Ft++)b[Ft]=b[Ft]+p*k[Ft];break}}else{if(D.ltype===this.MP_CURL){et=D.left_curl(),U=Math.abs(D.left_tension()),$=Math.abs(J.right_tension()),V=this.mp_curl_ratio(et,U,$),W[o]=-b[o-1]*V/(this.FRACTION_ONE-V*I[o-1]);break}if(D.ltype===this.MP_GIVEN){W[o]=D.left_given()-Math.atan2(n[o-1],s[o-1]),W[o]=this.reduce_angle(W[o]);break}}J=D,D=z,x+=1}for(x=o-1;x>-1;x--)W[x]=b[x]-W[x+1]*I[x];for(D=t,x=0;z=D.next,ot=(lt=this.mp_n_sin_cos(W[x]))[0],gt=lt[1],Tt=(vt=this.mp_n_sin_cos(-l[x+1]-W[x+1]))[0],Rt=vt[1],this.mp_set_controls(D,z,s[x],n[x],gt,ot,Rt,Tt),D=z,++x!==o;);},mp_n_sin_cos:function(t){return[Math.cos(t),Math.sin(t)]},mp_set_controls:function(t,e,o,s,n,h,l,p){var d,b,Z,y,O;Z=Math.abs(e.left_tension()),d=Math.abs(t.right_tension()),O=this.mp_velocity(n,h,l,p,d),b=this.mp_velocity(l,p,n,h,Z),(t.right_tension()<0||e.left_tension()<0)&&(n>=0&&l>=0||n<=0&&l<=0)&&(y=Math.abs(n)*p+Math.abs(l)*h)>0&&(y*=1.00024414062,t.right_tension()<0&&this.mp_ab_vs_cd(Math.abs(l),this.FRACTION_ONE,O,y)<0&&(O=Math.abs(l)/y),e.left_tension()<0&&this.mp_ab_vs_cd(Math.abs(n),this.FRACTION_ONE,b,y)<0&&(b=Math.abs(n)/y)),t.rx=t.x+(o*h-s*n)*O,t.ry=t.y+(s*h+o*n)*O,e.lx=e.x-(o*p+s*l)*b,e.ly=e.y-(s*p-o*l)*b,t.rtype=this.MP_EXPLICIT,e.ltype=this.MP_EXPLICIT},mp_pyth_add:function(t,e){return Math.sqrt(t*t+e*e)},mp_curl_ratio:function(t,e,o){var s=1/e,n=1/o;return Math.min(4,((3-s)*s*s*t+n*n*n)/(s*s*s*t+(3-n)*n*n))},mp_ab_vs_cd:function(t,e,o,s){return t*e==o*s?0:t*e>o*s?1:-1},mp_velocity:function(t,e,o,s,n){return Math.min(4,(2+Math.sqrt(2)*(t-o/16)*(o-t/16)*(e-s))/(1.5*n*(2+(Math.sqrt(5)-1)*e+(3-Math.sqrt(5))*s)))},reduce_angle:function(t){return Math.abs(t)>this.ONE_EIGHTY_DEG&&(t>0?t-=this.THREE_SIXTY_DEG:t+=this.THREE_SIXTY_DEG),t},makeknots:function(t,e){var o,s,n=[];for(s=t.length,o=0;o<s;o++)n.push({x:t[o][0],y:t[o][1],ltype:this.MP_OPEN,rtype:this.MP_OPEN,lx:!1,rx:!1,ly:e,ry:e,left_curl:function(){return this.lx||0},right_curl:function(){return this.rx||0},left_tension:function(){return this.ly||1},right_tension:function(){return this.ry||1},set_right_curl:function(h){this.rx=h||0},set_left_curl:function(h){this.lx=h||0}});for(s=n.length,o=0;o<s;o++)n[o].next=n[o+1]||n[o],n[o].set_right_given=n[o].set_right_curl,n[o].set_left_given=n[o].set_left_curl,n[o].right_given=n[o].right_curl,n[o].left_given=n[o].left_curl;return n[s-1].next=n[0],n},curve:function(t,e){var o,s,n,h,l,p,d=!1,b=[],Z=[];for(h in l=1,(e=e||{tension:1,direction:{},curl:{},isClosed:!1}).hasOwnProperty("tension")&&(l=a.Z.evaluate(e.tension)),s=(o=this.makeknots(t,l)).length,a.Z.exists(e.isClosed)&&a.Z.evaluate(e.isClosed)&&(d=!0),d||(o[0].ltype=this.MP_ENDPOINT,o[0].rtype=this.MP_CURL,o[s-1].rtype=this.MP_ENDPOINT,o[s-1].ltype=this.MP_CURL),e)if(e.hasOwnProperty(h)){if(n=parseInt(h,10),isNaN(n)||n<0||n>=s)continue;p=e[n],a.Z.exists(p.type)&&p.type==="curl"&&(l=a.Z.evaluate(p.curl),n===0?(o[n].rtype=this.MP_CURL,o[n].set_right_curl(l)):n===s-1?(o[n].ltype=this.MP_CURL,o[n].set_left_curl(l)):(o[n].ltype=this.MP_CURL,o[n].rtype=this.MP_CURL,o[n].lx=l,o[n].rx=l)),a.Z.exists(p.direction)&&(l=a.Z.evaluate(p.direction),a.Z.isArray(l)?(l[0]!==!1&&(o[n].lx=l[0]*Math.PI/180,o[n].ltype=this.MP_GIVEN),l[1]!==!1&&(o[n].rx=l[1]*Math.PI/180,o[n].rtype=this.MP_GIVEN)):(o[n].lx=l*Math.PI/180,o[n].rx=l*Math.PI/180,o[n].ltype=o[n].rtype=this.MP_GIVEN)),a.Z.exists(p.tension)&&(l=a.Z.evaluate(p.tension),a.Z.isArray(l)?(l[0]!==!1&&(o[n].ly=a.Z.evaluate(l[0])),l[1]!==!1&&(o[n].ry=a.Z.evaluate(l[1]))):(o[n].ly=l,o[n].ry=l))}for(this.make_choices(o),n=0;n<s-1;n++)b.push(o[n].x),b.push(o[n].rx),b.push(o[n+1].lx),Z.push(o[n].y),Z.push(o[n].ry),Z.push(o[n+1].ly);return b.push(o[s-1].x),Z.push(o[s-1].y),d&&(b.push(o[s-1].rx),Z.push(o[s-1].ry),b.push(o[0].lx),Z.push(o[0].ly),b.push(o[0].x),Z.push(o[0].y)),[b,Z]}},B.Z.Metapost;var g=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],C=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],P=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];u.Z.Util=u.Z.Util||{},u.Z.Util.Unzip=function(t){var e,o,s,n,h=[],l=0,p=[],d=new Array(32768),b=0,Z=!1,y=t.length,O=0,x=1,D=new Array(288),k=new Array(32),I=0,U=null,J=(new Array(64),new Array(64),0),z=new Array(17),V=[];function W(){return O<y?t[O++]:-1}function $(){x=1}function nt(){var Pt;try{Pt=1&x,(x>>=1)===0&&(Pt=1&(x=W()),x=x>>1|128)}catch(yt){throw console.log("Probably problems on iOS7 with >>"),yt}return Pt}function et(Pt){var yt=0,mt=Pt;try{for(;mt--;)yt=yt<<1|nt();Pt&&(yt=g[yt]>>8-Pt)}catch(bt){throw console.log("Probably problems on iOS7 with >>"),bt}return yt}function lt(){b=0}function ot(Pt){d[b++]=Pt,h.push(String.fromCharCode(Pt)),b===32768&&(b=0)}function gt(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function vt(){for(;;){if(z[J]>=n)return-1;if(s[z[J]]===J)return z[J]++;z[J]++}}function Tt(){var Pt,yt=U[I];if(J===17)return-1;if(I++,J++,(Pt=vt())>=0)yt.b0=Pt;else if(yt.b0=32768,Tt())return-1;if((Pt=vt())>=0)yt.b1=Pt,yt.jump=null;else if(yt.b1=32768,yt.jump=U[I],yt.jumppos=I,Tt())return-1;return J--,0}function Rt(Pt,yt,mt,bt){var pt;for(U=Pt,I=0,s=mt,n=yt,pt=0;pt<17;pt++)z[pt]=0;return J=0,Tt()?-1:0}function kt(Pt){for(var yt,mt,bt=0,pt=Pt[bt];;)if(nt()){if(!(32768&pt.b1))return pt.b1;for(pt=pt.jump,yt=Pt.length,mt=0;mt<yt;mt++)if(Pt[mt]===pt){bt=mt;break}}else{if(!(32768&pt.b0))return pt.b0;pt=Pt[++bt]}}function Ft(){var Pt,yt,mt,bt,pt,At,zt,ft,wt,Ot,Lt,Wt,Vt,jt,It;do if(Pt=nt(),(yt=et(2))===0)for($(),wt=W(),wt|=W()<<8,Lt=W(),65535&(wt^~(Lt|=W()<<8))&&u.Z.debug(`BlockLen checksum mismatch
`);wt--;)ot(W());else if(yt===1)for(;;)if((bt=g[et(7)]>>1)>23?(bt=bt<<1|nt())>199?bt=(bt-=128)<<1|nt():(bt-=48)>143&&(bt+=136):bt+=256,bt<256)ot(bt);else{if(bt===256)break;for(ft=et(P[bt-=257])+C[bt],bt=g[et(5)]>>3,T[bt]>8?(Ot=et(8),Ot|=et(T[bt]-8)<<8):Ot=et(T[bt]),Ot+=w[bt],bt=0;bt<ft;bt++)ot(d[b-Ot&32767])}else if(yt===2){for(At=new Array(320),Vt=257+et(5),jt=1+et(5),It=4+et(4),bt=0;bt<19;bt++)At[bt]=0;for(bt=0;bt<It;bt++)At[L[bt]]=et(3);for(ft=k.length,mt=0;mt<ft;mt++)k[mt]=new gt;if(Rt(k,19,At))return lt(),1;for(Wt=Vt+jt,mt=0,-1;mt<Wt;)if((bt=kt(k))<16)At[mt++]=bt;else if(bt===16){if(mt+(bt=3+et(2))>Wt)return lt(),1;for(pt=mt?At[mt-1]:0;bt--;)At[mt++]=pt}else{if(mt+(bt=bt===17?3+et(3):11+et(7))>Wt)return lt(),1;for(;bt--;)At[mt++]=0}for(ft=D.length,mt=0;mt<ft;mt++)D[mt]=new gt;if(Rt(D,Vt,At))return lt(),1;for(ft=D.length,mt=0;mt<ft;mt++)k[mt]=new gt;for(zt=[],mt=Vt;mt<At.length;mt++)zt[mt-Vt]=At[mt];if(Rt(k,jt,zt))return lt(),1;for(;;)if((bt=kt(D))>=256){if((bt-=256)===0)break;for(ft=et(P[bt-=1])+C[bt],bt=kt(k),T[bt]>8?(Ot=et(8),Ot|=et(T[bt]-8)<<8):Ot=et(T[bt]),Ot+=w[bt];ft--;)ot(d[b-Ot&32767])}else ot(bt)}while(!Pt);return lt(),$(),0}function te(){var Pt,yt,mt,bt,pt,At=[];try{if(h=[],Z=!1,At[0]=W(),At[1]=W(),At[0]===120&&At[1]===218&&(Ft(),p[l]=[h.join(""),"geonext.gxt"],l++),At[0]===31&&At[1]===139&&(qt(),p[l]=[h.join(""),"file"],l++),At[0]===80&&At[1]===75){if(Z=!0,At[2]=W(),At[3]=W(),At[2]===3&&At[3]===4){for(At[0]=W(),At[1]=W(),e=W(),e|=W()<<8,pt=W(),pt|=W()<<8,W(),W(),W(),W(),W(),W()<<8,W()<<16,W()<<24,W(),W()<<8,W()<<16,W()<<24,W(),W()<<8,W()<<16,W()<<24,bt=W(),bt|=W()<<8,mt=W(),mt|=W()<<8,Pt=0,V=[];bt--;)(yt=W())==="/"|yt===":"?Pt=0:Pt<255&&(V[Pt++]=String.fromCharCode(yt));for(o||(o=V),Pt=0;Pt<mt;)yt=W(),Pt++;if(pt===8&&(Ft(),p[l]=new Array(2),p[l][0]=h.join(""),p[l][1]=V.join(""),l++),qt())return!1}return!0}}catch(zt){throw console.log("Probably problems on iOS7 with >>"),zt}return!1}function qt(){var Pt,yt,mt=[];if(8&e&&(mt[0]=W(),mt[1]=W(),mt[2]=W(),mt[3]=W(),mt[0]===80&&mt[1]===75&&mt[2]===7&&mt[3]===8?(W(),W()<<8,W()<<16,W()<<24):mt[0]|mt[1]<<8|mt[2]<<16|mt[3]<<24,W(),W()<<8,W()<<16,W()<<24,W(),W()<<8,W()<<16,W()<<24),Z&&te())return!1;if(mt[0]=W(),mt[0]!==8)return!0;if(e=W(),W(),W(),W(),W(),W(),W(),4&e)for(mt[0]=W(),mt[2]=W(),J=mt[0]+256*mt[1],Pt=0;Pt<J;Pt++)W();if(8&e)for(Pt=0,V=[],yt=W();yt;)yt!=="7"&&yt!==":"||(Pt=0),Pt<255&&(V[Pt++]=yt),yt=W();if(16&e)for(yt=W();yt;)yt=W();return 2&e&&(W(),W()),Ft(),W(),W()<<8,W()<<16,W()<<24,W(),W()<<8,W()<<16,W()<<24,Z&&te(),!1}z[0]=0,u.Z.Util.Unzip.prototype.unzipFile=function(Pt){var yt;for(this.unzip(),yt=0;yt<p.length;yt++)if(p[yt][1]===Pt)return p[yt][0];return""},u.Z.Util.Unzip.prototype.unzip=function(){return te(),p}};const Y=u.Z.Util;var j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,3,3,3,3,3,3,3,3,3,3,3,3,4,3,3,11,6,6,6,5,8,8,8,8,8,8,8,8,8,8,8,0,12,24,36,60,96,84,12,12,12,48,72,12,12,12,12,12,12,12,12,12,12,12,12,12,0,12,12,12,12,12,0,12,0,12,12,12,24,12,12,12,12,12,24,12,24,12,12,12,12,12,12,12,12,12,24,12,12,12,12,12,24,12,12,12,12,12,12,12,24,12,12,12,12,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,36,12,36,12,12,12,36,12,12,12,12,12,12,12,12,12,12];u.Z.Util=u.Z.Util||{},u.Z.Util.UTF8={encode:function(t){var e,o,s="",n=t.length;if(t=t.replace(/\r\n/g,`
`),typeof unescape=="function"&&typeof encodeURIComponent=="function")return unescape(encodeURIComponent(t));for(e=0;e<n;e++)(o=t.charCodeAt(e))<128?s+=String.fromCharCode(o):o>127&&o<2048?(s+=String.fromCharCode(o>>6|192),s+=String.fromCharCode(63&o|128)):(s+=String.fromCharCode(o>>12|224),s+=String.fromCharCode(o>>6&63|128),s+=String.fromCharCode(63&o|128));return s},decode:function(t){var e,o,s,n=0,h=0,l=0,p=[],d=t.length,b=[];for(e=0;e<d;e++)o=t.charCodeAt(e),s=j[o],h=l!==0?63&o|h<<6:255>>s&o,(l=j[256+l+s])===0&&(h>65535?p.push(55232+(h>>10),56320+(1023&h)):p.push(h),++n%1e4==0&&(b.push(String.fromCharCode.apply(null,p)),p=[]));return b.push(String.fromCharCode.apply(null,p)),b.join("")},asciiCharCodeAt:function(t,e){var o=t.charCodeAt(e);if(o>255)switch(o){case 8364:o=128;break;case 8218:o=130;break;case 402:o=131;break;case 8222:o=132;break;case 8230:o=133;break;case 8224:o=134;break;case 8225:o=135;break;case 710:o=136;break;case 8240:o=137;break;case 352:o=138;break;case 8249:o=139;break;case 338:o=140;break;case 381:o=142;break;case 8216:o=145;break;case 8217:o=146;break;case 8220:o=147;break;case 8221:o=148;break;case 8226:o=149;break;case 8211:o=150;break;case 8212:o=151;break;case 732:o=152;break;case 8482:o=153;break;case 353:o=154;break;case 8250:o=155;break;case 339:o=156;break;case 382:o=158;break;case 376:o=159}return o}};const F=u.Z.Util.UTF8;var G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",H="=";u.Z.Util=u.Z.Util||{},u.Z.Util.Base64={_getByte:function(t,e){return 255&t.charCodeAt(e)},_getIndex:function(t,e){return G.indexOf(t.charAt(e))},encode:function(t){var e,o,s,n,h,l=[];for(n=(s=(h=F.encode(t)).length)%3,e=0;e<s-n;e+=3)o=this._getByte(h,e)<<16|this._getByte(h,e+1)<<8|this._getByte(h,e+2),l.push(G.charAt(o>>18),G.charAt(o>>12&63),G.charAt(o>>6&63),G.charAt(63&o));switch(n){case 1:o=this._getByte(h,s-1),l.push(G.charAt(o>>2),G.charAt(o<<4&63),H,H);break;case 2:o=this._getByte(h,s-2)<<8|this._getByte(h,s-1),l.push(G.charAt(o>>10),G.charAt(o>>4&63),G.charAt(o<<2&63),H)}return l.join("")},decode:function(t,e){var o,s,n,h,l,p,d=[],b=[];if((n=(o=t.replace(/[^A-Za-z0-9+/=]/g,"")).length)%4!=0)throw new Error("JSXGraph/utils/base64: Can't decode string (invalid input length).");for(o.charAt(n-1)===H&&(h=1,o.charAt(n-2)===H&&(h=2),n-=4),s=0;s<n;s+=4)l=this._getIndex(o,s)<<18|this._getIndex(o,s+1)<<12|this._getIndex(o,s+2)<<6|this._getIndex(o,s+3),b.push(l>>16,l>>8&255,255&l),s%1e4==0&&(d.push(String.fromCharCode.apply(null,b)),b=[]);switch(h){case 1:l=this._getIndex(o,n)<<12|this._getIndex(o,n+1)<<6|this._getIndex(o,n+2),b.push(l>>10,l>>2&255);break;case 2:l=this._getIndex(o,s)<<6|this._getIndex(o,s+1),b.push(l>>4)}return d.push(String.fromCharCode.apply(null,b)),p=d.join(""),e&&(p=F.decode(p)),p},decodeAsArray:function(t){var e,o=this.decode(t),s=[],n=o.length;for(e=0;e<n;e++)s[e]=o.charCodeAt(e);return s}};const q=u.Z.Util.Base64;u.Z.Server={modules:{},runningCalls:{},handleError:function(t){u.Z.debug("error occured, server says: "+t.message)},callServer:function(t,e,o,s){var n,h,l,p,d,b,Z;for(b in s=s||!1,o)o.hasOwnProperty(b)&&""+escape(b)+escape(o[b]);d=a.Z.toJSON(o);do p=t+Math.floor(4096*Math.random());while(a.Z.exists(this.runningCalls[p]));return this.runningCalls[p]={action:t},a.Z.exists(o.module)&&(this.runningCalls[p].module=o.module),n=u.Z.serverBase+"JXGServer.py",h="action="+escape(t)+"&id="+p+"&dataJSON="+escape(q.encode(d)),this.cbp=function(y){var O,x,D,k,I,U,J,z;if(O=new Y.Unzip(q.decodeAsArray(y)).unzip(),a.Z.isArray(O)&&O.length>0&&(O=O[0][0]),a.Z.exists(O)){if((x=window.JSON&&window.JSON.parse?window.JSON.parse(O):new Function("return "+O)()).type==="error")this.handleError(x);else if(x.type==="response"){for(U=x.id,J=0;J<x.fields.length;J++)k=(D=x.fields[J]).namespace+(typeof new Function("return "+D.namespace)()=="object"?".":".prototype.")+D.name+" = "+D.value,new Function(k)();for(J=0;J<x.handler.length;J++){for(D=x.handler[J],I=[],z=0;z<D.parameters.length;z++)I[z]='"'+D.parameters[z]+'": '+D.parameters[z];k="if(typeof JXG.Server.modules."+this.runningCalls[U].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[U].module+" = {};",k+="JXG.Server.modules."+this.runningCalls[U].module+"."+D.name+"_cb = "+D.callback+";",k+="JXG.Server.modules."+this.runningCalls[U].module+"."+D.name+" = function ("+D.parameters.join(",")+', __JXGSERVER_CB__, __JXGSERVER_SYNC) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[U].module+"."+D.name+"_cb;var __JXGSERVER_PAR__ = {"+I.join(",")+', "module": "'+this.runningCalls[U].module+'", "handler": "'+D.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);};',new Function(k)()}delete this.runningCalls[U],e(x.data)}}},this.cb=u.Z.bind(this.cbp,this),window.XMLHttpRequest?(l=new XMLHttpRequest).overrideMimeType("text/plain; charset=iso-8859-1"):l=new ActiveXObject("Microsoft.XMLHTTP"),!(!l||(l.open("POST",n,!s),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s||(l.onreadystatechange=(Z=this.cb,function(){return l.readyState===4&&l.status===200&&(Z(l.responseText),!0)})),l.send(h),!s))&&(this.cb(l.responseText),!0)},loadModule_cb:function(t){var e;for(e=0;e<t.length;e++)u.Z.debug(t[e].name+": "+t[e].value)},loadModule:function(t){return u.Z.Server.callServer("load",u.Z.Server.loadModule_cb,{module:t},!0)}},u.Z.Server.load=u.Z.Server.loadModule;const K=u.Z.Server;var at;B.Z.Symbolic={generateSymbolicCoordinatesPartial:function(t,e,o,s){var n,h,l,p=e.ancestors,d=0,b=function(Z){return s==="underscore"?o+"_{"+Z+"}":s==="brace"?o+"["+Z+"]":o+Z};for(h in t.listOfFreePoints=[],t.listOfDependantPoints=[],p)if(p.hasOwnProperty(h)&&(n=0,a.Z.isPoint(p[h]))){for(l in p[h].ancestors)p[h].ancestors.hasOwnProperty(l)&&n++;n===0?(p[h].symbolic.x=p[h].coords.usrCoords[1],p[h].symbolic.y=p[h].coords.usrCoords[2],t.listOfFreePoints.push(p[h])):(d+=1,p[h].symbolic.x=b(d),d+=1,p[h].symbolic.y=b(d),t.listOfDependantPoints.push(p[h]))}return a.Z.isPoint(e)&&(e.symbolic.x="x",e.symbolic.y="y"),d},clearSymbolicCoordinates:function(t){var e=function(o){var s,n=o&&o.length||0;for(s=0;s<n;s++)a.Z.isPoint(o[s])&&(o[s].symbolic.x="",o[s].symbolic.y="")};e(t.listOfFreePoints),e(t.listOfDependantPoints),delete t.listOfFreePoints,delete t.listOfDependantPoints},generatePolynomials:function(t,e,o){var s,n,h,l,p=e.ancestors,d=[],b=[];for(s in o&&this.generateSymbolicCoordinatesPartial(t,e,"u","brace"),p[e.id]=e,p)if(p.hasOwnProperty(s)&&(l=0,d=[],a.Z.isPoint(p[s]))){for(n in p[s].ancestors)p[s].ancestors.hasOwnProperty(n)&&l++;if(l>0)for(d=p[s].generatePolynomial(),h=0;h<d.length;h++)b.push(d[h])}return o&&this.clearSymbolicCoordinates(t),b},geometricLocusByGroebnerBase:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O,x,D=t.options.locus,k={},I=this.generateSymbolicCoordinatesPartial(t,e,"u","brace"),U=new m.Z(S.Z.COORDS_BY_USR,[0,0],t),J=new m.Z(S.Z.COORDS_BY_USR,[t.canvasWidth,t.canvasHeight],t),z=1,V=0,W=0,$=0;if(K.modules.geoloci===at&&K.loadModule("geoloci"),K.modules.geoloci===at)throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(p=U.usrCoords[1],d=J.usrCoords[1],b=J.usrCoords[2],Z=U.usrCoords[2],D.translateToOrigin&&t.listOfFreePoints.length>0){for(V=(n=D.toOrigin!==at&&D.toOrigin!==null&&a.Z.isInArray(t.listOfFreePoints,D.toOrigin.id)?D.toOrigin:t.listOfFreePoints[0]).symbolic.x,W=n.symbolic.y,l=0;l<t.listOfFreePoints.length;l++)t.listOfFreePoints[l].symbolic.x-=V,t.listOfFreePoints[l].symbolic.y-=W;if(p-=V,d-=V,b-=W,Z-=W,D.translateTo10&&t.listOfFreePoints.length>1){for(h=D.to10!==at&&D.to10!==null&&D.to10.id!==D.toOrigin.id&&a.Z.isInArray(t.listOfFreePoints,D.to10.id)?D.to10:t.listOfFreePoints[0].id===n.id?t.listOfFreePoints[1]:t.listOfFreePoints[0],$=_.Z.rad([1,0],[0,0],[h.symbolic.x,h.symbolic.y]),y=Math.cos(-$),O=Math.sin(-$),l=0;l<t.listOfFreePoints.length;l++)x=t.listOfFreePoints[l].symbolic.x,t.listOfFreePoints[l].symbolic.x=y*t.listOfFreePoints[l].symbolic.x-O*t.listOfFreePoints[l].symbolic.y,t.listOfFreePoints[l].symbolic.y=O*x+y*t.listOfFreePoints[l].symbolic.y;if(h.symbolic.y=0,x=p,p=y*p-O*b,b=O*x+y*b,x=d,d=y*d-O*Z,Z=O*x+y*Z,D.stretch&&Math.abs(h.symbolic.x)>B.Z.eps){for(z=h.symbolic.x,l=0;l<t.listOfFreePoints.length;l++)t.listOfFreePoints[l].symbolic.x/=z,t.listOfFreePoints[l].symbolic.y/=z;for(l=0;l<t.objectsList.length;l++)t.objectsList[l].elementClass===S.Z.OBJECT_CLASS_CIRCLE&&t.objectsList[l].method==="pointRadius"&&(k[l]=t.objectsList[l].radius,t.objectsList[l].radius/=z);p/=z,d/=z,b/=z,Z/=z,h.symbolic.x=1}}for(l=0;l<t.listOfFreePoints.length;l++)x=t.listOfFreePoints[l].symbolic.x,Math.abs(x)<B.Z.eps&&(t.listOfFreePoints[l].symbolic.x=0),Math.abs(x-Math.round(x))<B.Z.eps&&(t.listOfFreePoints[l].symbolic.x=Math.round(x)),x=t.listOfFreePoints[l].symbolic.y,Math.abs(x)<B.Z.eps&&(t.listOfFreePoints[l].symbolic.y=0),Math.abs(x-Math.round(x))<B.Z.eps&&(t.listOfFreePoints[l].symbolic.y=Math.round(x))}for(l in o=this.generatePolynomials(t,e).join(","),this.cbp=function(nt){s=nt},this.cb=a.Z.bind(this.cbp,this),K.modules.geoloci.lociCoCoA(p,d,b,Z,I,o,z,$,V,W,this.cb,!0),this.clearSymbolicCoordinates(t),k)k.hasOwnProperty(l)&&(t.objects[l].radius=k[l]);return s}};const tt=B.Z.Symbolic;B.Z.Clip={_isSeparator:function(t){return isNaN(t.coords.usrCoords[1])&&isNaN(t.coords.usrCoords[2])},makeDoublyLinkedList:function(t){var e,o=null,s=[],n=t.length;if(n>0)for(e=0;e<n;e++)this._isSeparator(t[e])?(t[e]._next=t[(e+1)%n],t[e]._prev=t[(n+e-1)%n]):(o===null&&(o=e,s.push(o)),this._isSeparator(t[(e+1)%n])||e===n-1?(t[e]._next=t[o],t[o]._prev=t[e],t[e]._end=!0,o=null):(t[e]._next=t[(e+1)%n],t[o]._prev=t[e]),this._isSeparator(t[(n+e-1)%n])||(t[e]._prev=t[(n+e-1)%n]));return s},Vertex:function(t,e,o,s,n,h){this.pos=e,this.intersection=!0,this.coords=t,this.elementClass=S.Z.OBJECT_CLASS_POINT,this.data={alpha:o,path:s,pathname:n,done:!1,type:h,idx:0},this.neighbour=null,this.entry_exit=!1},_addToList:function(t,e,o){var s=t.length,n=B.Z.eps*B.Z.eps;s>0&&Math.abs(t[s-1].coords.usrCoords[0]-e.usrCoords[0])<n&&Math.abs(t[s-1].coords.usrCoords[1]-e.usrCoords[1])<n&&Math.abs(t[s-1].coords.usrCoords[2]-e.usrCoords[2])<n||t.push({pos:o,intersection:!1,coords:e,elementClass:S.Z.OBJECT_CLASS_POINT})},sortIntersections:function(t){var e,o,s,n,h,l,p=[],d=t.length;for(e=0;e<d;e++)if(t[e].sort(function(b,Z){return b.data.alpha>Z.data.alpha?1:-1}),t[e].length>0){for(h=t[e].length-1,l=(n=(s=t[e][0]).data.path[s.pos])._next,e===d-1&&(n._end=!1),s.data.alpha===0&&s.data.type==="T"?(n.intersection=!0,n.data=s.data,n.neighbour=s.neighbour,n.neighbour.neighbour=n,n.entry_exit=!1,t[e][0]=n):(s._prev=n,s._prev._next=s),o=1;o<=h;o++)(s=t[e][o])._prev=t[e][o-1],s._prev._next=s;(s=t[e][h])._next=l,s._next._prev=s,e===d-1&&(s._end=!0),p=p.concat(t[e])}return p},_inbetween:function(t,e,o){var s,n=B.Z.eps*B.Z.eps,h=o[1]-e[1],l=o[2]-e[2],p=t[1]-e[1],d=t[2]-e[2];return h===0&&l===0&&p===0&&d===0||(s=Math.abs(p)<n&&Math.abs(h)<n?d/l:p/h,Math.abs(s)<n&&(s=0),s)},_print_array:function(t){var e,o;for(e=0;e<t.length;e++)try{o="",t[e]._end&&(o=" end"),console.log(e,t[e].coords.usrCoords,t[e].data.type,"	","prev",t[e]._prev.coords.usrCoords,"next",t[e]._next.coords.usrCoords+o)}catch{console.log(e,t[e].coords.usrCoords)}},_print_list:function(t){for(var e,o=0;o<100&&(e=t.data?t.data.alpha:"-",console.log("	",t.coords.usrCoords,`
		is:`,t.intersection,"end:",t._end,e,`
		-:`,t._prev.coords.usrCoords,`
		+:`,t._next.coords.usrCoords,`
		n:`,t.intersection?t.neighbour.coords.usrCoords:"-"),!t._end);)t=t._next,o++},_noOverlap:function(t,e,o,s){var n,h,l,p,d,b=Math.sqrt(B.Z.eps),Z=!1;for(n=0;n<3;n++)if(h=Math.min(t[n],e[n]),l=Math.max(t[n],e[n]),p=Math.min(o[n],s[n]),d=Math.max(o[n],s[n]),l<p-b||h>d+b){Z=!0;break}return Z},findIntersections:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I=[],U=100*B.Z.eps,J=t.length,z=e.length,V=[],W=[],$=[],nt=!1,et=!1;for(n=0;n<z;n++)$.push([]);for(s=0;s<J;s++)if(W.push([]),this._isSeparator(t[s])||this._isSeparator(t[(s+1)%J]))nt=!0;else{if(nt&&s===J-1)break;for(l=t[s].coords.usrCoords,p=t[(s+1)%J].coords.usrCoords,n=0;n<z;n++)if(this._isSeparator(e[n])||this._isSeparator(e[(n+1)%z]))et=!0;else{if(et&&n===z-1)break;if(d=e[n].coords.usrCoords,b=e[(n+1)%z].coords.usrCoords,!this._noOverlap(l,p,d,b)&&(I=_.Z.meetSegmentSegment(l,p,d,b),Z=_.Z.distance(l,p,3),y=_.Z.distance(d,b,3),I[1]*Z>-U&&I[1]<1-U/Z&&I[2]*y>-U&&I[2]<1-U/y||I[1]===1/0&&I[2]===1/0&&B.Z.norm(I[0],3)<U)){if(h=new m.Z(S.Z.COORDS_BY_USER,I[0],o),x="X",Math.abs(I[1])*Z<U||Math.abs(I[2])*y<U)x="T",Math.abs(I[1])*Z<U&&(I[1]=0),Math.abs(I[2])*y<U&&(I[2]=0),h=I[1]===0?new m.Z(S.Z.COORDS_BY_USER,l,o):new m.Z(S.Z.COORDS_BY_USER,d,o);else if(I[1]===1/0&&I[2]===1/0&&B.Z.norm(I[0],3)<U){(O=this._inbetween(l,d,b))>=0&&O<1&&(x="T",h=new m.Z(S.Z.COORDS_BY_USER,l,o),I[1]=0,I[2]=O,D=new this.Vertex(h,s,I[1],t,"S",x),k=new this.Vertex(h,n,I[2],e,"C",x),D.neighbour=k,k.neighbour=D,W[s].push(D),$[n].push(k)),O=this._inbetween(d,l,p),_.Z.distance(l,d,3)>U&&O>=0&&O<1&&(x="T",h=new m.Z(S.Z.COORDS_BY_USER,d,o),I[1]=O,I[2]=0,D=new this.Vertex(h,s,I[1],t,"S",x),k=new this.Vertex(h,n,I[2],e,"C",x),D.neighbour=k,k.neighbour=D,W[s].push(D),$[n].push(k));continue}D=new this.Vertex(h,s,I[1],t,"S",x),k=new this.Vertex(h,n,I[2],e,"C",x),D.neighbour=k,k.neighbour=D,W[s].push(D),$[n].push(k)}}}for(V=this.sortIntersections(W),s=0;s<V.length;s++)V[s].data.idx=s,V[s].neighbour.data.idx=s;return[V,this.sortIntersections($)]},_getPosition:function(t,e,o,s){var n=_.Z.det3p(t,e,o),h=_.Z.det3p(t,o,s);return _.Z.det3p(e,o,s)>=0?n>=0&&h>=0?"left":"right":n>=0||h>=0?"left":"right"},_classifyDegenerateIntersections:function(t){var e,o,s,n,h,l,p,d,b,Z,y,O,x,D;for(b=_.Z.det3p,p=0,t._tours=0;;){if(t.intersection&&t.data.type==="T"&&(e=t._next.coords.usrCoords,o=t._prev.coords.usrCoords,_.Z.distance(t.coords.usrCoords,e,3)<B.Z.eps&&(e=t._next._next.coords.usrCoords),_.Z.distance(t.coords.usrCoords,o,3)<B.Z.eps&&(o=t._prev._prev.coords.usrCoords),n=(h=t.neighbour)._prev.coords.usrCoords,s=h._next.coords.usrCoords,_.Z.distance(h.coords.usrCoords,s,3)<B.Z.eps&&(s=h._next._next.coords.usrCoords),_.Z.distance(h.coords.usrCoords,n,3)<B.Z.eps&&(n=h._prev._prev.coords.usrCoords),y=b(t.coords.usrCoords,o,n),O=b(t.coords.usrCoords,e,s),x=b(t.coords.usrCoords,o,s),D=b(t.coords.usrCoords,e,n),y===0&&O===0&&x===0&&D===0&&(t.coords.usrCoords[1]*=1+Math.random()*B.Z.eps,t.coords.usrCoords[2]*=1+Math.random()*B.Z.eps,h.coords.usrCoords[1]=t.coords.usrCoords[1],h.coords.usrCoords[2]=t.coords.usrCoords[2],y=b(t.coords.usrCoords,o,n),O=b(t.coords.usrCoords,e,s),x=b(t.coords.usrCoords,o,s),D=b(t.coords.usrCoords,e,n)),Z=!1,y===0?_.Z.affineRatio(t.coords.usrCoords,o,n)<0&&(Z=!0):O===0?_.Z.affineRatio(t.coords.usrCoords,e,s)<0&&(Z=!0):x===0?_.Z.affineRatio(t.coords.usrCoords,o,s)>0&&(Z=!0):D===0&&_.Z.affineRatio(t.coords.usrCoords,e,n)>0&&(Z=!0),Z&&(d=n,n=s,s=d,d=y,y=x,x=d,d=O,O=D,D=d),a.Z.exists(t.delayedStatus)||(t.delayedStatus=[]),y===0&&O===0?t.delayedStatus=["on","on"]:y===0?(l=this._getPosition(e,n,h.coords.usrCoords,s),t.delayedStatus=["on",l]):O===0?(l=this._getPosition(o,n,h.coords.usrCoords,s),t.delayedStatus=[l,"on"]):t.delayedStatus.length===0&&(this._getPosition(o,n,h.coords.usrCoords,s)!==this._getPosition(e,n,h.coords.usrCoords,s)?t.data.type="X":t.data.type="B")),a.Z.exists(t._tours)&&t._tours++,t._tours>3||t._end||p>1e3){p>1e3&&console.log("Clipping: _classifyDegenerateIntersections exit"),a.Z.exists(t._tours)&&delete t._tours;break}t.intersection&&p++,t=t._next}},_handleIntersectionChains:function(t){var e,o=0,s="Null",n=!1,h=!1,l=!1;for(l;t.intersection===!0&&(t.data.type==="T"&&(t.delayedStatus[0]!=="on"&&t.delayedStatus[1]==="on"?(n=!0,e=t,s=t.delayedStatus[0]):n&&t.delayedStatus[0]==="on"&&t.delayedStatus[1]==="on"?t.data.type="B":n&&t.delayedStatus[0]==="on"&&t.delayedStatus[1]!=="on"&&(n=!1,s===t.delayedStatus[1]?(e.data.type="DB",t.data.type="DB"):(e.data.type="DX",t.data.type="DX"))),o++),t._end&&(h=!0),!h||n;){if(o>1e3){console.log("Warning: _handleIntersectionChains: intersection chain reached maximum numbers of iterations");break}t=t._next}},_handleFullyDegenerateCase:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U=[t,e];for(h=0;h<2;h++){for(O=(s=U[h]).length,Z=0,I=!0;Z<O;Z++)if(!s[Z].intersection){I=!1;break}if(I)for(x=(n=U[(h+1)%2]).length,Z=0;Z<O;Z++){for(p=s[Z].coords.usrCoords,d=s[Z]._next.coords.usrCoords,l=[.5*(p[0]+d[0]),.5*(p[1]+d[1]),.5*(p[2]+d[2])],y=0,D=!1;y<x;y++)if(Math.abs(_.Z.det3p(n[y].coords.usrCoords,n[(y+1)%x].coords.usrCoords,l))<B.Z.eps){D=!0;break}if(!D){b={pos:Z,intersection:!1,coords:new m.Z(S.Z.COORDS_BY_USER,l,o),elementClass:S.Z.OBJECT_CLASS_POINT},k=s[Z]._next,s[Z]._next=b,b._prev=s[Z],b._next=k,k._prev=b,s[Z]._end&&(s[Z]._end=!1,b._end=!0);break}}}},_getStatus:function(t,e){for(;t.intersection&&!t._end;)t=t._next;return[t,_.Z.windingNumber(t.coords.usrCoords,e)===0?"entry":"exit"]},markEntryExit:function(t,e,o){var s,n,h,l,p,d,b,Z=null,y=0;for(d=o.length,p=0;p<d;p++)for(b=o[p],this._classifyDegenerateIntersections(t[b]),this._handleIntersectionChains(t[b]),n=(l=this._getStatus(t[b],e))[0],s=l[1],n._starter=!0,h=0,Z=null,y=0;n.intersection===!0&&(n.data.type==="X"&&y===1&&(Z.entry_exit=s,s==="exit"&&(Z.data.type="X"),y=2),n.data.type!=="X"&&n.data.type!=="DB"||(n.entry_exit=s,s=s==="entry"?"exit":"entry"),n.data.type==="DX"&&(y===0?(Z=n,y=1):y===1?(n.entry_exit=s,Z.entry_exit=s,s==="exit"?Z.data.type="X":n.data.type="X",s=s==="entry"?"exit":"entry",Z=null,y=0):y===2&&(n.entry_exit=s,n.data.type="X",s=s==="entry"?"exit":"entry",Z=null,y=0))),n=n._next,!(a.Z.exists(n._starter)||h>1e4);)h++},_stayOnPath:function(t,e){var o=!0;return t.intersection&&t.data.type!=="B"&&(o=e===t.entry_exit),o},_addVertex:function(t,e,o){return isNaN(e.coords.usrCoords[1])||isNaN(e.coords.usrCoords[2])||t.push(e),e.intersection&&e.data.done?(o&&console.log("Add last intersection point",e.coords.usrCoords,"on",e.data.pathname,e.entry_exit,e.data.type),!0):(e.intersection&&(e.data.done=!0,o&&console.log("Add intersection point",e.coords.usrCoords,"on",e.data.pathname,e.entry_exit,e.data.type)),!1)},tracing:function(t,e,o){var s,n,h,l,p=0,d=1e4,b=0,Z=[],y=!1,O=!1;for(O;b<e.length&&p<d;)if((h=e[b]).data.done||h.data.type!=="X")b++;else{Z.length>0&&Z.push([NaN,NaN]),l=h.data.idx,s=t,y=this._addVertex(Z,h,O),n=h.entry_exit;do{if(y)break;if(o==="intersection"&&h.entry_exit==="entry"||o==="union"&&h.entry_exit==="exit"||o==="difference"&&s===t==(h.entry_exit==="exit")){do if(h=h._next,y=this._addVertex(Z,h,O))break;while(this._stayOnPath(h,n));p++}else{do if(h=h._prev,y=this._addVertex(Z,h,O))break;while(this._stayOnPath(h,n));p++}if(y)break;if(!h.neighbour)return console.log("Tracing: emergency break - no neighbour!!!!!!!!!!!!!!!!!",p),[[0],[0]];if((h=h.neighbour).data.done)break;h.data.done=!0,n=h.entry_exit,s=h.data.path}while(h.data.idx!==l&&p<d);p>=d&&console.log("Tracing: stopping an infinite loop!",p),b++}return this._getCoordsArrays(Z,!1)},isEmptyCase:function(t,e,o){return o==="intersection"&&(t.length===0||e.length===0)||o==="union"&&t.length===0&&e.length===0||o==="difference"&&t.length===0},_getCoordsArrays:function(t,e){var o,s=[],n=[],h=t.length;for(o=0;o<h;o++)t[o].coords?(s.push(t[o].coords.usrCoords[1]),n.push(t[o].coords.usrCoords[2])):(s.push(t[o][0]),n.push(t[o][1]));return e&&h>0&&(t[0].coords?(s.push(t[0].coords.usrCoords[1]),n.push(t[0].coords.usrCoords[2])):(s.push(t[0][0]),n.push(t[0][1]))),[s,n]},handleEmptyIntersection:function(t,e,o){var s,n,h=!1,l=[];if(t.length===0)return l=o==="union"?e:[],this._getCoordsArrays(l,!0);if(e.length===0)return l=o==="intersection"?[]:t,this._getCoordsArrays(l,!0);if(t.length>0)for(s=t[0];s.intersection&&!(s=s._next)._end;);if(e.length>0)for(n=e[0];n.intersection&&!(n=n._next)._end;);return _.Z.windingNumber(s.coords.usrCoords,e)===0?_.Z.windingNumber(n.coords.usrCoords,t)!==0?(o==="union"?(l=l.concat(t)).push(t[0]):o==="difference"&&((l=l.concat(t)).push(t[0]),_.Z.signedPolygon(t)*_.Z.signedPolygon(e)>0&&l.reverse(),l.push([NaN,NaN])),o!=="difference"&&o!=="intersection"||((l=l.concat(e)).push(e[0]),h=!1)):o==="difference"?(l=l.concat(t),h=!0):o==="union"&&((l=l.concat(t)).push(t[0]),l.push([NaN,NaN]),(l=l.concat(e)).push(e[0])):o==="intersection"?(l=l.concat(t),h=!0):o==="union"&&(l=l.concat(e)).push(e[0]),this._getCoordsArrays(l,h)},_countCrossingIntersections:function(t){var e,o=t.length,s=0;for(e=0;e<o;e++)t[e].data.type==="X"&&s++;return s},_getPath:function(t,e){var o,s,n,h,l,p,d,b=[];if(t.elementClass!==S.Z.OBJECT_CLASS_CURVE||t.type!==S.Z.OBJECT_TYPE_ARC&&t.type!==S.Z.OBJECT_TYPE_SECTOR){if(t.elementClass===S.Z.OBJECT_CLASS_CURVE&&a.Z.exists(t.points))for(s=t.numberPoints,o=0;o<s;o++)this._addToList(b,t.points[o],o);else if(t.type===S.Z.OBJECT_TYPE_POLYGON)for(o=0;o<t.vertices.length;o++)this._addToList(b,t.vertices[o].coords,o);else if(t.elementClass===S.Z.OBJECT_CLASS_CIRCLE)for(d=359,n=t.Radius(),h=2*Math.PI/d,o=0;o<=d;o++)this._addToList(b,new m.Z(S.Z.COORDS_BY_USER,[t.center.coords.usrCoords[0],t.center.coords.usrCoords[1]+Math.cos(o*h)*n,t.center.coords.usrCoords[2]+Math.sin(o*h)*n],e),o);else if(a.Z.isArray(t))for(s=t.length,o=0;o<s;o++)a.Z.exists(t[o].coords)?this._addToList(b,t[o].coords,o):a.Z.isArray(t[o])?this._addToList(b,new m.Z(S.Z.COORDS_BY_USER,t[o],e),o):a.Z.exists(t[o].usrCoords)&&this._addToList(b,t[o],o)}else{for(l=_.Z.rad(t.radiuspoint,t.center,t.anglepoint),d=Math.floor(180*l/Math.PI),n=t.Radius(),h=l/d,p=Math.atan2(t.radiuspoint.coords.usrCoords[2]-t.center.coords.usrCoords[2],t.radiuspoint.coords.usrCoords[1]-t.center.coords.usrCoords[1]),t.type===S.Z.OBJECT_TYPE_SECTOR&&this._addToList(b,t.center.coords,0),o=0;o<=d;o++)this._addToList(b,new m.Z(S.Z.COORDS_BY_USER,[t.center.coords.usrCoords[0],t.center.coords.usrCoords[1]+Math.cos(o*h+p)*n,t.center.coords.usrCoords[2]+Math.sin(o*h+p)*n],e),o+1);t.type===S.Z.OBJECT_TYPE_SECTOR&&this._addToList(b,t.center.coords,d+2)}return b},greinerHormann:function(t,e,o,s){var n,h,l,p,d=[],b=[];return(n=(d=this._getPath(t,s)).length)>0&&_.Z.distance(d[0].coords.usrCoords,d[n-1].coords.usrCoords,3)<B.Z.eps&&d.pop(),(n=(b=this._getPath(e,s)).length)>0&&_.Z.distance(b[0].coords.usrCoords,b[n-1].coords.usrCoords,3)<B.Z.eps*B.Z.eps&&b.pop(),this.isEmptyCase(d,b,o)?[[],[]]:(l=this.makeDoublyLinkedList(d),p=this.makeDoublyLinkedList(b),h=this.findIntersections(d,b,s)[0],this._handleFullyDegenerateCase(d,b,s),this.markEntryExit(d,b,l),this.markEntryExit(b,d,p),this._countCrossingIntersections(h)===0?this.handleEmptyIntersection(d,b,o):this.tracing(d,h,o))},union:function(t,e,o){return this.greinerHormann(t,e,"union",o)},intersection:function(t,e,o){return this.greinerHormann(t,e,"intersection",o)},difference:function(t,e,o){return this.greinerHormann(t,e,"difference",o)}},u.Z.extend(B.Z.Clip,{}),B.Z.Clip,B.Z.Poly={},B.Z.Poly.Ring=function(t){this.vars=t},u.Z.extend(B.Z.Poly.Ring.prototype,{}),B.Z.Poly.Monomial=function(t,e,o){var s;if(!a.Z.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(a.Z.isArray(o)||(o=[]),s=(o=o.slice(0,t.vars.length)).length;s<t.vars.length;s++)o.push(0);this.ring=t,this.coefficient=e||0,this.exponents=a.Z.deepCopy(o)},u.Z.extend(B.Z.Poly.Monomial.prototype,{copy:function(){return new B.Z.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var t,e=[];for(t=0;t<this.ring.vars.length;t++)e.push(this.ring.vars[t]+"^"+this.exponents[t]);return this.coefficient+"*"+e.join("*")}}),B.Z.Poly.Polynomial=function(t,e){var o;if(!a.Z.exists(t))throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");o=a.Z.exists(e)&&a.Z.isString(e)?void 0:[],this.ring=t,this.monomials=o},u.Z.extend(B.Z.Poly.Polynomial.prototype,{findSignature:function(t){var e;for(e=0;e<this.monomials.length;e++)if(a.Z.cmpArrays(this.monomials[e].exponents,t))return e;return-1},addSubMonomial:function(t,e){var o;(o=this.findSignature(t.exponents))>-1?this.monomials[o].coefficient+=e*t.coefficient:(t.coefficient*=e,this.monomials.push(t))},add:function(t){var e;if(!a.Z.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(a.Z.isArray(t.exponents))this.addSubMonomial(t,1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],1)},sub:function(t){var e;if(!a.Z.exists(t)||t.ring!==this.ring)throw new Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(a.Z.isArray(t.exponents))this.addSubMonomial(t,-1);else for(e=0;e<t.monomials.length;e++)this.addSubMonomial(t.monomials[e],-1)},copy:function(){var t,e;for(e=new B.Z.Poly.Polynomial(this.ring),t=0;t<this.monomials.length;t++)e.monomials.push(this.monomials[t].copy());return e},print:function(){var t,e=[];for(t=0;t<this.monomials.length;t++)e.push("("+this.monomials[t].print()+")");return e.join("+")}}),B.Z.Poly,u.Z.Complex=function(t,e){this.isComplex=!0,t&&t.isComplex&&(e=t.imaginary,t=t.real),this.real=t||0,this.imaginary=e||0,this.absval=0,this.angle=0},u.Z.extend(u.Z.Complex.prototype,{toString:function(){return this.real+" + "+this.imaginary+"i"},add:function(t){return a.Z.isNumber(t)?this.real+=t:(this.real+=t.real,this.imaginary+=t.imaginary),this},sub:function(t){return a.Z.isNumber(t)?this.real-=t:(this.real-=t.real,this.imaginary-=t.imaginary),this},mult:function(t){var e,o;return a.Z.isNumber(t)?(this.real*=t,this.imaginary*=t):(e=this.real,o=this.imaginary,this.real=e*t.real-o*t.imaginary,this.imaginary=e*t.imaginary+o*t.real),this},div:function(t){var e,o,s;if(a.Z.isNumber(t)){if(Math.abs(t)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;this.real/=t,this.imaginary/=t}else{if(Math.abs(t.real)<Math.eps&&Math.abs(t.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,this;e=t.real*t.real+t.imaginary*t.imaginary,s=this.real,o=this.imaginary,this.real=(s*t.real+o*t.imaginary)/e,this.imaginary=(o*t.real-s*t.imaginary)/e}return this},conj:function(){return this.imaginary*=-1,this}}),u.Z.C={},u.Z.C.add=function(t,e){var o=new u.Z.Complex(t);return o.add(e),o},u.Z.C.sub=function(t,e){var o=new u.Z.Complex(t);return o.sub(e),o},u.Z.C.mult=function(t,e){var o=new u.Z.Complex(t);return o.mult(e),o},u.Z.C.div=function(t,e){var o=new u.Z.Complex(t);return o.div(e),o},u.Z.C.conj=function(t){var e=new u.Z.Complex(t);return e.conj(),e},u.Z.C.abs=function(t){var e=new u.Z.Complex(t);return e.conj(),e.mult(t),Math.sqrt(e.real)},u.Z.Complex.C=u.Z.C;const Q=u.Z.Complex;var it=__webpack_require__(766);u.Z.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type="",this.supportsForeignObject=!1},u.Z.extend(u.Z.AbstractRenderer.prototype,{_updateVisual:function(t,e,o){(o||this.enhancedRendering)&&(e=e||{},this.setObjectTransition(t),a.Z.evaluate(t.visProp.draft)?this.setDraft(t):(e.stroke||(t.highlighted?(this.setObjectStrokeColor(t,t.visProp.highlightstrokecolor,t.visProp.highlightstrokeopacity),this.setObjectStrokeWidth(t,t.visProp.highlightstrokewidth)):(this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))),e.fill||(t.highlighted?this.setObjectFillColor(t,t.visProp.highlightfillcolor,t.visProp.highlightfillopacity):this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity)),e.dash||this.setDashStyle(t,t.visProp),e.shadow||this.setShadow(t),e.gradient||this.setShadow(t),e.tabindex||this.setTabindex(t)))},_getHighlighted:function(t){var e=!1;return a.Z.exists(t.board)&&a.Z.exists(t.board.highlightedObjects)||(e=!0),!e&&a.Z.exists(t.board.highlightedObjects[t.id])?"highlight":""},drawPoint:function(t){var e,o=it.Z.normalizePointFace(a.Z.evaluate(t.visProp.face));e=o==="o"?"ellipse":o==="[]"?"rect":"path",t.rendNode=this.appendChildPrim(this.createPrim(e,t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,e),this._updateVisual(t,{dash:!0,shadow:!0},!0),this.updatePoint(t)},updatePoint:function(t){var e,o=a.Z.evaluate(t.visProp.size),s=it.Z.normalizePointFace(a.Z.evaluate(t.visProp.face)),n=a.Z.evaluate(t.visProp.sizeunit),h=a.Z.evaluate(t.visProp.zoom);isNaN(t.coords.scrCoords[2]+t.coords.scrCoords[1])||(n==="user"&&(o*=Math.sqrt(t.board.unitX*t.board.unitY)),e=(o*=t.board&&h?Math.sqrt(t.board.zoomX*t.board.zoomY):1)===0?0:o+1,s==="o"?this.updateEllipsePrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2],e,e):s==="[]"?this.updateRectPrim(t.rendNode,t.coords.scrCoords[1]-o,t.coords.scrCoords[2]-o,2*o,2*o):this.updatePathPrim(t.rendNode,this.updatePathStringPoint(t,o,s),t.board),this._updateVisual(t,{dash:!1,shadow:!1}),this.setShadow(t))},changePointStyle:function(t){var e=this.getElementById(t.id);a.Z.exists(e)&&this.remove(e),this.drawPoint(t),a.Z.clearVisPropOld(t),t.visPropCalc.visible||this.display(t,!1),a.Z.evaluate(t.visProp.draft)&&this.setDraft(t)},drawLine:function(t){t.rendNode=this.appendChildPrim(this.createPrim("line",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"lines"),this.updateLine(t)},updateLine:function(t){this._updateVisual(t),this.updatePathWithArrowHeads(t),this.setLineCap(t)},drawCurve:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path"),this.updateCurve(t)},updateCurve:function(t){this._updateVisual(t),this.updatePathWithArrowHeads(t),this.setLineCap(t)},updatePathWithArrowHeads:function(t,e){var o,s,n=t.visProp,h=e?"highlight":"";o=e&&n.highlightstrokewidth?Math.max(a.Z.evaluate(n.highlightstrokewidth),a.Z.evaluate(n.strokewidth)):a.Z.evaluate(n.strokewidth),s=this.getArrowHeadData(t,o,h),this.makeArrows(t,s),t.elementClass===S.Z.OBJECT_CLASS_LINE?this.updateLineWithEndings(t,s):t.elementClass===S.Z.OBJECT_CLASS_CURVE&&this.updatePath(t),this.setArrowSize(t,s)},getArrowHeadData:function(t,e,o){var s,n,h,l,p=B.Z.eps,d=0,b=0,Z=0,y=0,O=a.Z.evaluate(t.visProp.firstarrow),x=a.Z.evaluate(t.visProp.lastarrow);return(O||x)&&(s=a.Z.exists(O.type)?a.Z.evaluate(O.type):t.elementClass===S.Z.OBJECT_CLASS_LINE?1:7,n=a.Z.exists(x.type)?a.Z.evaluate(x.type):t.elementClass===S.Z.OBJECT_CLASS_LINE?1:7,O&&(l=6,a.Z.exists(O.size)&&(l=a.Z.evaluate(O.size)),o!==""&&a.Z.exists(O[o+"size"])&&(l=a.Z.evaluate(O[o+"size"])),h=e*l,s===2?(h*=.5,p+=e*l):s===3?(h=e*l/3,p+=e):s===4||s===5||s===6?(h=e*l/1.5,p+=e*l):s===7?(h=0,l=10,p+=e):p+=e*l,d+=h,Z=l),x&&(l=6,a.Z.exists(x.size)&&(l=a.Z.evaluate(x.size)),o!==""&&a.Z.exists(x[o+"size"])&&(l=a.Z.evaluate(x[o+"size"])),h=e*l,n===2?(h*=.5,p+=e*l):n===3?(h=e*l/3,p+=e):n===4||n===5||n===6?(h=e*l/1.5,p+=e*l):n===7?(h=0,l=10,p+=e):p+=e*l,b+=h,y=l)),t.visPropCalc.typeFirst=s,t.visPropCalc.typeLast=n,{evFirst:O,evLast:x,typeFirst:s,typeLast:n,offFirst:d,offLast:b,sizeFirst:Z,sizeLast:y,showFirst:1,showLast:1,minLen:p,strokeWidth:e}},updateLineWithEndings:function(t,e){var o,s,n;return o=new m.Z(S.Z.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),s=new m.Z(S.Z.COORDS_BY_USER,t.point2.coords.usrCoords,t.board),n=a.Z.evaluate(t.visProp.margin),_.Z.calcStraight(t,o,s,n),this.handleTouchpoints(t,o,s,e),this.getPositionArrowHead(t,o,s,e),this.updateLinePrim(t.rendNode,o.scrCoords[1],o.scrCoords[2],s.scrCoords[1],s.scrCoords[2],t.board),this},updatePath:function(t){return a.Z.evaluate(t.visProp.handdrawing)?this.updatePathPrim(t.rendNode,this.updatePathStringBezierPrim(t),t.board):this.updatePathPrim(t.rendNode,this.updatePathStringPrim(t),t.board),this},getPositionArrowHead:function(t,e,o,s){var n,h,l,p,d;return(s.evFirst||s.evLast)&&(h=l=p=d=0,n=e.distance(S.Z.COORDS_BY_SCREEN,o),s.evFirst&&t.board.renderer.type!=="vml"&&(n>=s.minLen?(h=(o.scrCoords[1]-e.scrCoords[1])*s.offFirst/n,l=(o.scrCoords[2]-e.scrCoords[2])*s.offFirst/n):s.showFirst=0),s.evLast&&t.board.renderer.type!=="vml"&&(n>=s.minLen?(p=(o.scrCoords[1]-e.scrCoords[1])*s.offLast/n,d=(o.scrCoords[2]-e.scrCoords[2])*s.offLast/n):s.showLast=0),e.setCoordinates(S.Z.COORDS_BY_SCREEN,[e.scrCoords[1]+h,e.scrCoords[2]+l],!1,!0),o.setCoordinates(S.Z.COORDS_BY_SCREEN,[o.scrCoords[1]-p,o.scrCoords[2]-d],!1,!0)),this},handleTouchpoints:function(t,e,o,s){var n,h,l,p,d,b,Z;return(s.evFirst||s.evLast)&&(l=p=d=b=Z=0,n=a.Z.evaluate(t.point1.visProp.size)+a.Z.evaluate(t.point1.visProp.strokewidth),h=a.Z.evaluate(t.point2.visProp.size)+a.Z.evaluate(t.point2.visProp.strokewidth),s.evFirst&&a.Z.evaluate(t.visProp.touchfirstpoint)&&(l=e.distance(S.Z.COORDS_BY_SCREEN,o),p=(o.scrCoords[1]-e.scrCoords[1])*n/l,d=(o.scrCoords[2]-e.scrCoords[2])*n/l),s.evLast&&a.Z.evaluate(t.visProp.touchlastpoint)&&(l=e.distance(S.Z.COORDS_BY_SCREEN,o),b=(o.scrCoords[1]-e.scrCoords[1])*h/l,Z=(o.scrCoords[2]-e.scrCoords[2])*h/l),e.setCoordinates(S.Z.COORDS_BY_SCREEN,[e.scrCoords[1]+p,e.scrCoords[2]+d],!1,!0),o.setCoordinates(S.Z.COORDS_BY_SCREEN,[o.scrCoords[1]-b,o.scrCoords[2]-Z],!1,!0)),this},setArrowSize:function(t,e){return e.evFirst&&this._setArrowWidth(t.rendNodeTriangleStart,e.showFirst*e.strokeWidth,t.rendNode,e.sizeFirst),e.evLast&&this._setArrowWidth(t.rendNodeTriangleEnd,e.showLast*e.strokeWidth,t.rendNode,e.sizeLast),this},setLineCap:function(t){},drawTicks:function(t){t.rendNode=this.appendChildPrim(this.createPrim("path",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"path")},updateTicks:function(t){},drawEllipse:function(t){t.rendNode=this.appendChildPrim(this.createPrim("ellipse",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"ellipse"),this.updateEllipse(t)},updateEllipse:function(t){this._updateVisual(t);var e=t.Radius();Math.abs(t.center.coords.usrCoords[0])>B.Z.eps&&!isNaN(e+t.center.coords.scrCoords[1]+t.center.coords.scrCoords[2])&&e*t.board.unitX<2e6&&this.updateEllipsePrim(t.rendNode,t.center.coords.scrCoords[1],t.center.coords.scrCoords[2],e*t.board.unitX,e*t.board.unitY)},drawPolygon:function(t){t.rendNode=this.appendChildPrim(this.createPrim("polygon",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"polygon"),this.updatePolygon(t)},updatePolygon:function(t){this._updateVisual(t,{stroke:!0,dash:!0}),this.updatePolygonPrim(t.rendNode,t)},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){var e,o,s,n;a.Z.evaluate(t.visProp.display)==="html"&&N.Z.isBrowser&&this.type!=="no"?((e=this.container.ownerDocument.createElement("div")).style.position="absolute",e.className=a.Z.evaluate(t.visProp.cssclass),s=a.Z.evaluate(t.visProp.layer),a.Z.exists(s)||(s=0),o=this.container.style.zIndex===""?0:parseInt(this.container.style.zIndex,10),e.style.zIndex=o+s,this.container.appendChild(e),e.setAttribute("id",this.container.id+"_"+t.id)):e=this.drawInternalText(t),t.rendNode=e,t.htmlStr="",t.visProp.islabel&&a.Z.exists(t.visProp.anchor)?(n=a.Z.evaluate(t.visProp.anchor.visProp.visible),t.prepareUpdate().updateVisibility(n)):t.prepareUpdate().updateVisibility(),this.updateText(t)},updateText:function(t){var e,o,s,n,h,l,p,d,b,Z=t.plaintext;if(t.visPropCalc.visible)if(this.updateTextStyle(t,!1),a.Z.evaluate(t.visProp.display)==="html"&&this.type!=="no"){if(isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])||(o=t.coords.scrCoords[1],o=Math.abs(o)<1e6?o:1e6,e=(d=t.getAnchorX())==="right"?t.board.canvasWidth-o:d==="middle"?o-.5*t.size[0]:o,t.visPropOld.left!==d+e&&(d==="right"?(t.rendNode.style.right=e+"px",t.rendNode.style.left="auto"):(t.rendNode.style.left=e+"px",t.rendNode.style.right="auto"),t.visPropOld.left=d+e),o=t.coords.scrCoords[2]+this.vOffsetText,o=Math.abs(o)<1e6?o:1e6,e=(b=t.getAnchorY())==="bottom"?t.board.canvasHeight-o:b==="middle"?o-.5*t.size[1]:o,t.visPropOld.top!==b+e&&(b==="bottom"?(t.rendNode.style.top="auto",t.rendNode.style.bottom=e+"px"):(t.rendNode.style.bottom="auto",t.rendNode.style.top=e+"px"),t.visPropOld.top=b+e)),t.htmlStr!==Z){try{t.type===a.Z.OBJECT_TYPE_BUTTON?t.rendNodeButton.innerHTML=Z:t.type===a.Z.OBJECT_TYPE_CHECKBOX||t.type===a.Z.OBJECT_TYPE_INPUT?t.rendNodeLabel.innerHTML=Z:t.rendNode.innerHTML=Z}catch{s=t.rendNode.parentNode,t.rendNode.parentNode.removeChild(t.rendNode),t.rendNode.innerHTML=Z,s.appendChild(t.rendNode)}if(t.htmlStr=Z,a.Z.evaluate(t.visProp.usemathjax))try{MathJax.typeset?MathJax.typeset([t.rendNode]):MathJax.Hub.Queue(["Typeset",MathJax.Hub,t.rendNode]),p="fullscreenwrap_"+(l=t.board.container),document.getElementById(p)&&(n=t.board.containerObj._cssFullscreenStore.scale,h=t.board.containerObj._cssFullscreenStore.vshift,N.Z.scaleJSXGraphDiv("#"+p,"#"+l,n,h))}catch{u.Z.debug("MathJax (not yet) loaded")}else if(a.Z.evaluate(t.visProp.usekatex))try{katex.render(Z,t.rendNode,{macros:a.Z.evaluate(t.visProp.katexmacros),throwOnError:!1})}catch{u.Z.debug("KaTeX not loaded (yet)")}else if(a.Z.evaluate(t.visProp.useasciimathml))try{AMprocessNode(t.rendNode,!1)}catch{u.Z.debug("AsciiMathML not loaded (yet)")}}this.transformImage(t,t.transformations)}else this.updateInternalText(t)},_css2js:function(t){var e,o,s,n,h,l=[],p=a.Z.trim(t).replace(/;$/,"").split(";");for(o=p.length,e=0;e<o;++e)a.Z.trim(p[e])!==""&&(h=p[e].split(":"),s=a.Z.trim(h[0].replace(/-([a-z])/gi,function(d,b){return b.toUpperCase()})),n=a.Z.trim(h[1]),l.push({key:s,val:n}));return l},updateTextStyle:function(t,e){var o,s,n,h,l,p,d,b,Z,y=t.visProp,O=N.Z.isBrowser?y.display:"internal",x=["rendNode","rendNodeTag","rendNodeLabel"],D=x.length,k=a.Z.evaluate(y.fontunit),I=["cssdefaultstyle","cssstyle"],U=I.length;if(e?(n=y.highlightstrokecolor,s=y.highlightstrokeopacity,h=y.highlightcssclass):(n=y.strokecolor,s=y.strokeopacity,h=y.cssclass),this.type!=="no"&&(O==="html"||this.type!=="canvas")){for(b=0;b<U;b++)if((Z=a.Z.evaluate(y[(e?"highlight":"")+I[b]]))!==""&&t.visPropOld[I[b]]!==Z){for(p=this._css2js(Z),l=0;l<D;l++)if(a.Z.exists(t[x[l]]))for(d in p)p.hasOwnProperty(d)&&(t[x[l]].style[p[d].key]=p[d].val);t.visPropOld[I[b]]=Z}if(o=a.Z.evaluate(y.fontsize),t.visPropOld.fontsize!==o){t.needsSizeUpdate=!0;try{for(l=0;l<D;l++)a.Z.exists(t[x[l]])&&(t[x[l]].style.fontSize=o+k)}catch{for(l=0;l<D;l++)a.Z.exists(t[x[l]])&&(t[x[l]].style.fontSize=o)}t.visPropOld.fontsize=o}}return this.setTabindex(t),this.setObjectTransition(t),O==="html"&&this.type!=="no"?(t.visPropOld.cssclass!==h&&(t.rendNode.className=h,t.visPropOld.cssclass=h,t.needsSizeUpdate=!0),this.setObjectStrokeColor(t,n,s)):this.updateInternalTextStyle(t,n,s),this},updateInternalTextStyle:function(t,e,o){this.setObjectStrokeColor(t,e,o)},drawImage:function(t){},updateImage:function(t){this.updateRectPrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),this.updateImageURL(t),this.transformImage(t,t.transformations),this._updateVisual(t,{stroke:!0,dash:!0},!0)},joinTransforms:function(t,e){var o,s=t.board.origin.scrCoords[1],n=t.board.origin.scrCoords[2],h=t.board.unitX,l=t.board.unitY,p=e.length,d=[[1,0,0],[-s/h,1/h,0],[n/l,0,-1/l]];for(o=0;o<p;o++)d=B.Z.matMatMult(e[o].matrix,d);return d=B.Z.matMatMult([[1,0,0],[s,h,0],[n,0,-l]],d)},transformImage:function(t,e){},updateImageURL:function(t){},updateImageStyle:function(t,e){t.rendNode.className=a.Z.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass)},drawForeignObject:function(t){},updateForeignObject:function(t){},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t,e){},_setArrowWidth:function(t,e,o){},updateEllipsePrim:function(t,e,o,s,n){},updateLinePrim:function(t,e,o,s,n,h){},updatePathPrim:function(t,e,o){},updatePathStringPoint:function(t,e,o){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,o,s,n){},setPropertyPrim:function(t,e,o){},setTabindex:function(t){var e;t.board.attr.keyboard.enabled&&a.Z.exists(t.rendNode)&&(e=a.Z.evaluate(t.visProp.tabindex),t.visPropCalc.visible&&!a.Z.evaluate(t.visProp.fixed)||(e=null),e!==t.visPropOld.tabindex&&(t.rendNode.setAttribute("tabindex",e),t.visPropOld.tabindex=e))},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){if(a.Z.evaluate(t.visProp.draft)){var e=t.board.options.elements.draft.color,o=t.board.options.elements.draft.opacity;this.setObjectTransition(t),t.type===S.Z.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,e,o):(t.elementClass===S.Z.OBJECT_CLASS_POINT?this.setObjectFillColor(t,e,o):this.setObjectFillColor(t,"none",0),this.setObjectStrokeColor(t,e,o),this.setObjectStrokeWidth(t,t.board.options.elements.draft.strokeWidth))}},removeDraft:function(t){this.setObjectTransition(t),t.type===S.Z.OBJECT_TYPE_POLYGON?this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity):(t.type===S.Z.OBJECT_CLASS_POINT&&this.setObjectFillColor(t,t.visProp.fillcolor,t.visProp.fillopacity),this.setObjectStrokeColor(t,t.visProp.strokecolor,t.visProp.strokeopacity),this.setObjectStrokeWidth(t,t.visProp.strokewidth))},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,o){},setObjectStrokeColor:function(t,e,o){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){var e,o,s=t.visProp;if(this.setObjectTransition(t),!s.draft){if(t.type===S.Z.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,s.highlightfillcolor,s.highlightfillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.highlightstrokecolor,t.borders[e].visProp.highlightstrokeopacity);else t.elementClass===S.Z.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!0):t.type===S.Z.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!0),this.setObjectFillColor(t,s.highlightfillcolor,s.highlightfillopacity)):(this.setObjectStrokeColor(t,s.highlightstrokecolor,s.highlightstrokeopacity),this.setObjectFillColor(t,s.highlightfillcolor,s.highlightfillopacity));s.highlightstrokewidth&&(o=Math.max(a.Z.evaluate(s.highlightstrokewidth),a.Z.evaluate(s.strokewidth)),this.setObjectStrokeWidth(t,o),t.elementClass!==S.Z.OBJECT_CLASS_LINE&&t.elementClass!==S.Z.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(t,!0))}return this},noHighlight:function(t){var e,o,s=t.visProp;if(this.setObjectTransition(t),!a.Z.evaluate(t.visProp.draft)){if(t.type===S.Z.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(t,s.fillcolor,s.fillopacity),e=0;e<t.borders.length;e++)this.setObjectStrokeColor(t.borders[e],t.borders[e].visProp.strokecolor,t.borders[e].visProp.strokeopacity);else t.elementClass===S.Z.OBJECT_CLASS_TEXT?this.updateTextStyle(t,!1):t.type===S.Z.OBJECT_TYPE_IMAGE?(this.updateImageStyle(t,!1),this.setObjectFillColor(t,s.fillcolor,s.fillopacity)):(this.setObjectStrokeColor(t,s.strokecolor,s.strokeopacity),this.setObjectFillColor(t,s.fillcolor,s.fillopacity));o=a.Z.evaluate(s.strokewidth),this.setObjectStrokeWidth(t,o),t.elementClass!==S.Z.OBJECT_CLASS_LINE&&t.elementClass!==S.Z.OBJECT_CLASS_CURVE||this.updatePathWithArrowHeads(t,!1)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t,e){var o,s,n=function(l){l||(l=window.event),l.stopPropagation?l.stopPropagation():l.cancelBubble=!0},h=function(l,p,d){var b;d=d||"",(b=o.createElement("span")).innerHTML=l,b.style.paddingLeft="7px",b.style.paddingRight="7px",b.classList!==void 0&&b.classList.add("JXG_navigation_button"),b.setAttribute("id",d),s.appendChild(b),N.Z.addEvent(b,"click",function(Z){return a.Z.bind(p,t)(),!1},t),N.Z.addEvent(b,"mouseup",n,t),N.Z.addEvent(b,"mousedown",n,t),N.Z.addEvent(b,"touchend",n,t),N.Z.addEvent(b,"touchstart",n,t)};N.Z.isBrowser&&this.type!=="no"&&(o=t.containerObj.ownerDocument,(s=o.createElement("div")).setAttribute("id",t.container+"_navigationbar"),s.style.color=e.strokecolor,s.style.backgroundColor=e.fillcolor,s.style.padding=e.padding,s.style.position=e.position,s.style.fontSize=e.fontsize,s.style.cursor=e.cursor,s.style.zIndex=e.zindex,t.containerObj.appendChild(s),s.style.right=e.right,s.style.bottom=e.bottom,s.classList!==void 0&&s.classList.add("JXG_navigation"),t.attr.showfullscreen&&h(t.attr.fullscreen.symbol,function(){t.toFullscreen(t.attr.fullscreen.id)},t.container+"_navigation_fullscreen"),t.attr.showscreenshot&&h(t.attr.screenshot.symbol,function(){window.setTimeout(function(){t.renderer.screenshot(t,"",!1)},330)},t.container+"_navigation_screenshot"),t.attr.showreload&&h("",function(){t.reload()},t.container+"_navigation_reload"),t.attr.showcleartraces&&h("",function(){t.clearTraces()},t.container+"_navigation_cleartraces"),t.attr.shownavigation&&(t.attr.showzoom&&(h("",t.zoomOut,t.container+"_navigation_out"),h("o",t.zoom100,t.container+"_navigation_100"),h("+",t.zoomIn,t.container+"_navigation_in")),h("",t.clickLeftArrow,t.container+"_navigation_left"),h("",t.clickUpArrow,t.container+"_navigation_down"),h("",t.clickDownArrow,t.container+"_navigation_up"),h("",t.clickRightArrow,t.container+"_navigation_right")))},getElementById:function(t){var e;return a.Z.exists(this.container)?(e=this.container.id+"_"+t,a.Z.exists(CSS)&&a.Z.exists(CSS.escape)&&(e=CSS.escape(e)),this.container.querySelector("#"+e)):""},removeToInsertLater:function(t){var e=t.parentNode,o=t.nextSibling;if(e!==null)return e.removeChild(t),function(){o?e.insertBefore(t,o):e.appendChild(t)}},resize:function(t,e){},createTouchpoints:function(t){},showTouchpoint:function(t){},hideTouchpoint:function(t){},updateTouchpoint:function(t,e){},dumpToDataURI:function(t){},dumpToCanvas:function(t,e,o,s){},screenshot:function(t){},setLayer:function(t,e){}});const rt=u.Z.AbstractRenderer;u.Z.FileReader={handleRemoteFile:function(t,e,o,s,n,h){var l=!1;try{l=new XMLHttpRequest,o.toLowerCase()==="raw"?l.overrideMimeType("text/plain; charset="+n):l.overrideMimeType("text/xml; charset="+n)}catch{try{l=new ActiveXObject("Msxml2.XMLHTTP")}catch{try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch{l=!1}}}if(l){l.open("GET",t,s),o.toLowerCase()==="raw"?this.cbp=function(){var p=l;p.readyState===4&&e(p.responseText)}:this.cbp=function(){var p=l,d="";p.readyState===4&&(d=!a.Z.exists(p.responseStream)||p.responseText.slice(0,2)!=="PK"&&F.asciiCharCodeAt(p.responseText.slice(0,1),0)!==31?p.responseText:q.decode(jxgBinFileReader(p)),this.parseString(d,e,o,h))},this.cb=a.Z.bind(this.cbp,this),l.onreadystatechange=this.cb;try{l.send(null)}catch{throw new Error("JSXGraph: A problem occurred while trying to read remote file '"+t+"'.")}}else u.Z.debug("AJAX not activated!")},handleLocalFile:function(t,e,o,s,n,h){a.Z.exists(s)||(s=!0),o.toLowerCase()==="raw"?this.cbp=function(p){e(p.target.result)}:this.cbp=function(p){var d=p.target.result;this.parseString(d,e,o,h)},this.cb=a.Z.bind(this.cbp,this);var l=new FileReader;l.onload=this.cb,o.toLowerCase()==="raw"?l.readAsText(t):l.readAsText(t,n)},parseFileContent:function(t,e,o,s,n,h){a.Z.isString(t)||FileReader===void 0?this.handleRemoteFile(t,e,o,s,n,h):this.handleLocalFile(t,e,o,s,n,h)},parseString:function(t,e,o,s){var n;if(o=o.toLowerCase(),n=u.Z.readers[o],a.Z.exists(n))new n(e,t).read();else if(o!=="jessiecode")throw new Error("JSXGraph: There is no reader available for '"+o+"'.");a.Z.isFunction(s)&&s(e)}},!N.Z.isMetroApp()&&N.Z.isBrowser&&typeof navigator=="object"&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)&&document&&document.write&&document.write(`<script type="text/vbscript">
Function Base64Encode(inData)
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim cOut, sOut, I
  For I = 1 To LenB(inData) Step 3
    Dim nGroup, pOut, sGroup
    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _
      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))
    nGroup = Oct(nGroup)
    nGroup = String(8 - Len(nGroup), "0") & nGroup
    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _
      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)
    sOut = sOut + pOut
  Next
  Select Case LenB(inData) Mod 3
    Case 1: '8 bit final
      sOut = Left(sOut, Len(sOut) - 2) + "=="
    Case 2: '16 bit final
      sOut = Left(sOut, Len(sOut) - 1) + "="
  End Select
  Base64Encode = sOut
End Function

Function MyASC(OneChar)
  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)
End Function

Function jxgBinFileReader(xhr)
    Dim byteString
    Dim b64String
    Dim i
    byteString = xhr.responseBody
    ReDim byteArray(LenB(byteString))
    For i = 1 To LenB(byteString)
        byteArray(i-1) = AscB(MidB(byteString, i, 1))
    Next
    b64String = Base64Encode(byteString)
    jxgBinFileReader = b64String
End Function
<\/script>
`);const dt=u.Z.FileReader;var ht=__webpack_require__(632),ut=__webpack_require__(254),_t=__webpack_require__(327);u.Z.Composition=function(t){var e,o=this,s=["setAttribute","setParents","prepareUpdate","updateRenderer","update","fullUpdate","highlight","noHighlight"],n=function(h){return function(){var l;for(l in o.elements)o.elements.hasOwnProperty(l)&&a.Z.exists(o.elements[l][h])&&o.elements[l][h].apply(o.elements[l],arguments);return o}};for(e=0;e<s.length;e++)this[s[e]]=n(s[e]);for(e in this.elements={},this.objects=this.elements,this.elementsByName={},this.objectsList=[],this.groups={},this.methodMap={setAttribute:"setAttribute",setProperty:"setAttribute",setParents:"setParents",add:"add",remove:"remove",select:"select"},t)t.hasOwnProperty(e)&&this.add(e,t[e]);this.dump=!0,this.subs={}},u.Z.extend(u.Z.Composition.prototype,{add:function(t,e){return!(a.Z.exists(this[t])||!a.Z.exists(e))&&(a.Z.exists(e.id)?this.elements[e.id]=e:this.elements[t]=e,a.Z.exists(e.name)&&(this.elementsByName[e.name]=e),e.on("attribute:name",this.nameListener,this),this.objectsList.push(e),this[t]=e,this.methodMap[t]=e,!0)},remove:function(t){var e,o=!1;for(e in this.elements)if(this.elements.hasOwnProperty(e)&&this.elements[e].id===this[t].id){o=!0;break}return o&&(delete this.elements[this[t].id],delete this[t]),o},nameListener:function(t,e,o){delete this.elementsByName[t],this.elementsByName[e]=o},select:function(t){return a.Z.exists(u.Z.Board)?u.Z.Board.prototype.select.call(this,t):new u.Z.Composition},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var t;for(t in this.subs)this.subs.hasOwnProperty(t)&&this.subs[t].visProp;return this.attr}});const Dt=u.Z.Composition;u.Z.Board=function(t,e,o,s,n,h,l,p,d,b,Z){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_MODE_ZOOM=17,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,a.Z.exists(Z.document)&&Z.document!==!1?this.document=Z.document:N.Z.isBrowser&&(this.document=document),this.container=t,this.containerObj=N.Z.isBrowser?this.document.getElementById(this.container):null,N.Z.isBrowser&&e.type!=="no"&&this.containerObj===null)throw new Error(`
JSXGraph: HTML container element '`+t+"' not found.");this.renderer=e,this.grids=[],this.options=a.Z.deepCopy(it.Z),this.attr=Z,this.dimension=2,this.jc=new ut.Z,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,s[0],s[1]],this.zoomX=n,this.zoomY=h,this.unitX=l*this.zoomX,this.unitY=p*this.zoomY,this.keepaspectratio=!1,this.canvasWidth=d,this.canvasHeight=b,a.Z.exists(o)&&o!==""&&N.Z.isBrowser&&!a.Z.exists(this.document.getElementById(o))?this.id=o:this.id=this.generateId(),X.Z.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.drag_position=[0,0],this.mouse={},this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.touchMoveLastId=1/0,this.positionAccessLast=0,this.downObjects=[],this.focusObjects=[],this.attr.showcopyright&&this.renderer.displayCopyright(S.Z.licenseText,parseInt(this.options.text.fontSize,10)),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasPointerHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.hasPointerUp=!1,this._drag_offset=[0,0],this._inputDevice="mouse",this._board_touches=[],this.selectingMode=!1,this.isSelecting=!1,this._isScrolling=!1,this._isResizing=!1,this.selectingBox=[[0,0],[0,0]],this.userLog=[],this.mathLib=Math,this.mathLibJXG=u.Z.Math,this.attr.registerevents&&this.addEventHandlers(),this.attr.registerresizeevent&&this.addResizeEventHandlers(),this.attr.registerfullscreenevent&&this.addFullscreenEventHandlers(),this.methodMap={update:"update",fullUpdate:"fullUpdate",on:"on",off:"off",trigger:"trigger",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness",suspendUpdate:"suspendUpdate",unsuspendUpdate:"unsuspendUpdate",clearTraces:"clearTraces",left:"clickLeftArrow",right:"clickRightArrow",up:"clickUpArrow",down:"clickDownArrow",zoomIn:"zoomIn",zoomOut:"zoomOut",zoom100:"zoom100",zoomElements:"zoomElements",remove:"removeObject",removeObject:"removeObject"}},u.Z.extend(u.Z.Board.prototype,{generateName:function(t){var e,o,s=this.attr.maxnamelength,n="",h="",l=[],p="";if(t.type===S.Z.OBJECT_TYPE_TICKS)return"";for(e=a.Z.isPoint(t)||a.Z.isPoint3D(t)?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:t.type===S.Z.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a.Z.isPoint(t)||t.elementClass===S.Z.OBJECT_CLASS_LINE||t.type===S.Z.OBJECT_TYPE_ANGLE||(n=t.type===S.Z.OBJECT_TYPE_POLYGON?"P_{":t.elementClass===S.Z.OBJECT_CLASS_CIRCLE?"k_{":t.elementClass===S.Z.OBJECT_CLASS_TEXT?"t_{":"s_{",h="}"),o=0;o<s;o++)l[o]=0;for(;l[s-1]<e.length;){for(l[0]=1;l[0]<e.length;l[0]++){for(p=n,o=s;o>0;o--)p+=e[l[o-1]];if(!a.Z.exists(this.elementsByName[p+h]))return p+h}for(l[0]=e.length,o=1;o<s;o++)l[o-1]===e.length&&(l[o-1]=1,l[o]+=1)}return""},generateId:function(){for(var t=1;a.Z.exists(u.Z.boards["jxgBoard"+t]);)t=Math.round(65535*Math.random());return"jxgBoard"+t},setId:function(t,e){var o,s=this.numObjects,n=t.id;if(this.numObjects+=1,n===""||!a.Z.exists(n))for(n=this.id+e+s;a.Z.exists(this.objects[n]);)o=Math.round(65535*Math.random()),n=this.id+e+s+"-"+o;return t.id=n,this.objects[n]=t,t._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=t,n},finalizeAdding:function(t){a.Z.evaluate(t.visProp.visible)===!1&&this.renderer.display(t,!1)},finalizeLabel:function(t){t.hasLabel&&!a.Z.evaluate(t.label.visProp.islabel)&&a.Z.evaluate(t.label.visProp.visible)===!1&&this.renderer.display(t.label,!1)},checkFrameRate:function(t){var e=!1,o=new Date().getTime();return a.Z.exists(t.pointerId)&&this.touchMoveLastId!==t.pointerId&&(e=!0,this.touchMoveLastId=t.pointerId),!e&&(o-this.touchMoveLast)*this.attr.maxframerate>=1e3&&(e=!0),e&&(this.touchMoveLast=o),e},getCoordsTopLeftCorner:function(){var t,e,o,s,n,h=this.document.ownerDocument||this.document,l=h.documentElement||this.document.body.parentNode,p=h.body,d=this.containerObj;if(this.cPos.length>0&&(this.mode===this.BOARD_MODE_DRAG||this.mode===this.BOARD_MODE_MOVE_ORIGIN||new Date().getTime()-this.positionAccessLast<1e3))return this.cPos;if(this.positionAccessLast=new Date().getTime(),d.getBoundingClientRect){for(o=d.getBoundingClientRect(),s=1,n=d;n&&a.Z.exists(n.parentNode);)a.Z.exists(n.style)&&a.Z.exists(n.style.zoom)&&n.style.zoom!==""&&(s*=parseFloat(n.style.zoom)),n=n.parentNode;return(t=[o.left*s,o.top*s])[0]+=N.Z.getProp(d,"border-left-width"),t[1]+=N.Z.getProp(d,"border-top-width"),this.renderer.type!=="vml"&&(t[0]+=N.Z.getProp(d,"padding-left"),t[1]+=N.Z.getProp(d,"padding-top")),this.cPos=t.slice(),this.cPos}return t=N.Z.getOffset(d),e=this.document.documentElement.ownerDocument,!this.containerObj.currentStyle&&e.defaultView&&(t[0]+=N.Z.getProp(l,"margin-left"),t[1]+=N.Z.getProp(l,"margin-top"),t[0]+=N.Z.getProp(l,"border-left-width"),t[1]+=N.Z.getProp(l,"border-top-width"),t[0]+=N.Z.getProp(l,"padding-left"),t[1]+=N.Z.getProp(l,"padding-top")),p&&(t[0]+=N.Z.getProp(p,"left"),t[1]+=N.Z.getProp(p,"top")),typeof google=="object"&&google.translate&&(t[0]+=10,t[1]+=25),t[0]+=N.Z.getProp(d,"border-left-width"),t[1]+=N.Z.getProp(d,"border-top-width"),this.renderer.type!=="vml"&&(t[0]+=N.Z.getProp(d,"padding-left"),t[1]+=N.Z.getProp(d,"padding-top")),t[0]+=this.attr.offsetx,t[1]+=this.attr.offsety,this.cPos=t.slice(),this.cPos},getMousePosition:function(t,e){var o,s,n=this.getCoordsTopLeftCorner();return o=N.Z.getPosition(t,e,this.document),a.Z.exists(this.cssTransMat)||this.updateCSSTransforms(),s=[1,o[0]-n[0],o[1]-n[1]],(s=B.Z.matVecMult(this.cssTransMat,s))[1]/=s[0],s[2]/=s[0],[s[1],s[2]]},initMoveOrigin:function(t,e){this.drag_dx=t-this.origin.scrCoords[1],this.drag_dy=e-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN,this.updateQuality=this.BOARD_QUALITY_LOW},initMoveObject:function(t,e,o,s){var n,h,l,p=[],d=[],b=this.objectsList.length,Z={visProp:{layer:-1e4}};for(h=0;h<b;h++)l=(n=this.objectsList[h]).hasPoint&&n.hasPoint(t,e),n.visPropCalc.visible&&l&&(n.triggerEventHandlers([s+"down","down"],[o]),this.downObjects.push(n)),l&&n.isDraggable&&n.visPropCalc.visible&&(this.geonextCompatibilityMode&&(a.Z.isPoint(n)||n.elementClass===S.Z.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!a.Z.evaluate(n.visProp.fixed)&&(n.visProp.layer>Z.visProp.layer||n.visProp.layer===Z.visProp.layer&&n.lastDragTime.getTime()>=Z.lastDragTime.getTime())&&(this.attr.ignorelabels&&a.Z.exists(Z.label)&&n===Z.label||(Z=n,p.push(Z),a.Z.exists(Z.coords)?d.push(v.Z.subtract(Z.coords.scrCoords.slice(1),[t,e])):d.push([0,0])));return this.attr.drag.enabled&&p.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.attr.takefirst?(p.length=1,this._drag_offset=d[0]):(p=p.slice(-1),this._drag_offset=d[d.length-1]),this._drag_offset||(this._drag_offset=[0,0]),this.renderer.type==="svg"&&a.Z.exists(p[0])&&a.Z.evaluate(p[0].visProp.dragtotopoflayer)&&p.length===1&&a.Z.exists(p[0].rendNode)&&p[0].rendNode.parentNode.appendChild(p[0].rendNode),this.previousRotation=0,this.previousScale=1,p.length>=1&&(p[0].highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[o,p[0]])),p},moveObject:function(t,e,o,s,n){var h,l,p,d=new m.Z(S.Z.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t,e),this);o&&o.obj&&((h=o.obj).coords&&(l=h.coords.scrCoords.slice()),this.addLogEntry("drag",h,d.usrCoords.slice(1)),this.drag_position=[d.scrCoords[1],d.scrCoords[2]],this.drag_position=v.Z.add(this.drag_position,this._drag_offset),a.Z.exists(h.coords)?h.setPositionDirectly(S.Z.COORDS_BY_SCREEN,this.drag_position):(this.displayInfobox(!1),isNaN(o.targets[0].Xprev+o.targets[0].Yprev)||h.setPositionDirectly(S.Z.COORDS_BY_SCREEN,[d.scrCoords[1],d.scrCoords[2]],[o.targets[0].Xprev,o.targets[0].Yprev]),o.targets[0].Xprev=d.scrCoords[1],o.targets[0].Yprev=d.scrCoords[2]),a.Z.exists(h.coords)&&(h.prepareUpdate().update(!1).updateRenderer(),this.updateInfobox(h),h.prepareUpdate().update(!0).updateRenderer()),h.coords&&(p=h.coords.scrCoords),h.coords&&l[1]===p[1]&&l[2]===p[2]||(h.triggerEventHandlers([n+"drag","drag"],[s]),this.update()),h.highlight(!0),this.triggerEventHandlers(["mousehit","hit"],[s,h]),h.lastDragTime=new Date)},twoFingerMove:function(t,e,o){var s;a.Z.exists(t)&&a.Z.exists(t.obj)&&((s=t.obj).elementClass===S.Z.OBJECT_CLASS_LINE||s.type===S.Z.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(t.targets,s,e):s.elementClass===S.Z.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(t.targets,s,e),o&&s.triggerEventHandlers(["touchdrag","drag"],[o]))},twoFingerTouchObject:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z=0;if(a.Z.exists(t[0])&&a.Z.exists(t[1])&&!isNaN(t[0].Xprev+t[0].Yprev+t[1].Xprev+t[1].Yprev)){if(o===t[0].num?(I=t[1],U=t[0]):(I=t[0],U=t[1]),J=new m.Z(S.Z.COORDS_BY_SCREEN,[I.Xprev,I.Yprev],this).usrCoords,n=new m.Z(S.Z.COORDS_BY_SCREEN,[U.Xprev,U.Yprev],this).usrCoords,s=new m.Z(S.Z.COORDS_BY_SCREEN,[U.X,U.Y],this).usrCoords,l=B.Z.crossProduct(J,n),h=B.Z.crossProduct(J,s),d=B.Z.crossProduct(l,h),Math.abs(d[0])<B.Z.eps)return;if(a.Z.evaluate(e.visProp.rotatable)&&(z=_.Z.rad(n.slice(1),J.slice(1),s.slice(1))),(b=this.create("transform",[z,[J[1],J[2]]],{type:"rotate"})).update(),a.Z.evaluate(e.visProp.scalable)&&(p=_.Z.distance(s,J)/_.Z.distance(n,J),Z=this.create("transform",[-J[1],-J[2]],{type:"translate"}),y=this.create("transform",[p,p],{type:"scale"}),O=this.create("transform",[J[1],J[2]],{type:"translate"}),b.melt(Z).melt(y).melt(O)),e.elementClass===S.Z.OBJECT_CLASS_LINE)x=[],e.point1.draggable()&&x.push(e.point1),e.point2.draggable()&&x.push(e.point2),b.applyOnce(x);else if(e.type===S.Z.OBJECT_TYPE_POLYGON){for(x=[],k=e.vertices.length-1,D=0;D<k;++D)e.vertices[D].draggable()&&x.push(e.vertices[D]);b.applyOnce(x)}this.update(),e.highlight(!0)}},twoFingerTouchCircle:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x;e.method!=="pointCircle"&&e.method!=="pointLine"&&a.Z.exists(t[0])&&a.Z.exists(t[1])&&!isNaN(t[0].Xprev+t[0].Yprev+t[1].Xprev+t[1].Yprev)&&(o===t[0].num?(s=t[1],n=t[0]):(s=t[0],n=t[1]),p=new m.Z(S.Z.COORDS_BY_SCREEN,[s.Xprev,s.Yprev],this).usrCoords,l=new m.Z(S.Z.COORDS_BY_SCREEN,[n.Xprev,n.Yprev],this).usrCoords,h=new m.Z(S.Z.COORDS_BY_SCREEN,[n.X,n.Y],this).usrCoords,b=_.Z.rad(l.slice(1),p.slice(1),h.slice(1)),Z=this.create("transform",[-p[1],-p[2]],{type:"translate"}),y=this.create("transform",[b],{type:"rotate"}),Z.melt(y),a.Z.evaluate(e.visProp.scalable)&&(d=_.Z.distance(p,h)/_.Z.distance(p,l),O=this.create("transform",[d,d],{type:"scale"}),Z.melt(O)),x=this.create("transform",[p[1],p[2]],{type:"translate"}),Z.melt(x),e.center.draggable()&&Z.applyOnce([e.center]),e.method==="twoPoints"?e.point2.draggable()&&Z.applyOnce([e.point2]):e.method==="pointRadius"&&a.Z.isNumber(e.updateRadius.origin)&&e.setRadius(e.radius*d),this.update(e.center),e.highlight(!0))},highlightElements:function(t,e,o,s){var n,h,l,p={},d=this.objectsList.length;for(n=0;n<d;n++)l=(h=this.objectsList[n]).id,a.Z.exists(h.hasPoint)&&h.visPropCalc.visible&&h.hasPoint(t,e)&&(this.updateInfobox(h),a.Z.exists(this.highlightedObjects[l])||(p[l]=h,h.highlight(),this.triggerEventHandlers(["mousehit","hit"],[o,h,s])),h.mouseover?h.triggerEventHandlers(["mousemove","move"],[o]):(h.triggerEventHandlers(["mouseover","over"],[o]),h.mouseover=!0));for(n=0;n<d;n++)l=(h=this.objectsList[n]).id,h.mouseover&&(p[l]||(h.triggerEventHandlers(["mouseout","out"],[o]),h.mouseover=!1))},saveStartPos:function(t,e){var o,s,n=[];if(t.type===S.Z.OBJECT_TYPE_TICKS)n.push([1,NaN,NaN]);else if(t.elementClass===S.Z.OBJECT_CLASS_LINE)n.push(t.point1.coords.usrCoords),n.push(t.point2.coords.usrCoords);else if(t.elementClass===S.Z.OBJECT_CLASS_CIRCLE)n.push(t.center.coords.usrCoords),t.method==="twoPoints"&&n.push(t.point2.coords.usrCoords);else if(t.type===S.Z.OBJECT_TYPE_POLYGON)for(s=t.vertices.length-1,o=0;o<s;o++)n.push(t.vertices[o].coords.usrCoords);else if(t.type===S.Z.OBJECT_TYPE_SECTOR)n.push(t.point1.coords.usrCoords),n.push(t.point2.coords.usrCoords),n.push(t.point3.coords.usrCoords);else if(a.Z.isPoint(t)||t.type===S.Z.OBJECT_TYPE_GLIDER)n.push(t.coords.usrCoords);else if(t.elementClass===S.Z.OBJECT_CLASS_CURVE)t.points.length>0&&n.push(t.points[0].usrCoords);else try{n.push(t.coords.usrCoords)}catch(h){u.Z.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+h)}for(s=n.length,o=0;o<s;o++)e.Zstart.push(n[o][0]),e.Xstart.push(n[o][1]),e.Ystart.push(n[o][2])},mouseOriginMoveStart:function(t){var e,o;return(e=this._isRequiredKeyPressed(t,"pan"))&&(o=this.getMousePosition(t),this.initMoveOrigin(o[0],o[1])),e},mouseOriginMove:function(t){var e,o=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return o&&(e=this.getMousePosition(t),this.moveOrigin(e[0],e[1],!0)),o},touchStartMoveOriginOneFinger:function(t){var e,o,s=t[u.Z.touchProperty];return(e=this.attr.pan.enabled&&!this.attr.pan.needtwofingers&&s.length===1)&&(o=this.getMousePosition(t,0),this.initMoveOrigin(o[0],o[1])),e},touchOriginMove:function(t){var e,o=this.mode===this.BOARD_MODE_MOVE_ORIGIN;return o&&(e=this.getMousePosition(t,0),this.moveOrigin(e[0],e[1],!0)),o},originMoveEnd:function(){this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){N.Z.supportsPointerEvents()?this.addPointerEventHandlers():(this.addMouseEventHandlers(),this.addTouchEventHandlers()),this.containerObj!==null&&(this.containerObj.oncontextmenu=function(t){return a.Z.exists(t)&&t.preventDefault(),!1}),this.addKeyboardEventHandlers()},addResizeEventHandlers:function(){if(N.Z.isBrowser){try{this.startResizeObserver()}catch{N.Z.addEvent(window,"resize",this.resizeListener,this),this.startIntersectionObserver()}N.Z.addEvent(window,"scroll",this.scrollListener,this)}},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers(),this.removePointerEventHandlers(),this.removeFullscreenEventHandlers(),this.removeKeyboardEventHandlers(),N.Z.isBrowser&&(a.Z.exists(this.resizeObserver)?this.stopResizeObserver():(N.Z.removeEvent(window,"resize",this.resizeListener,this),this.stopIntersectionObserver()),N.Z.removeEvent(window,"scroll",this.scrollListener,this))},addPointerEventHandlers:function(){if(!this.hasPointerHandlers&&N.Z.isBrowser){var t=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(N.Z.addEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),N.Z.addEvent(t,"MSPointerMove",this.pointerMoveListener,this)):(N.Z.addEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),N.Z.addEvent(t,"pointermove",this.pointerMoveListener,this)),N.Z.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),N.Z.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.containerObj!==null&&(this.containerObj.style.touchAction="none"),this.hasPointerHandlers=!0}},addMouseEventHandlers:function(){if(!this.hasMouseHandlers&&N.Z.isBrowser){var t=this.attr.movetarget||this.containerObj;N.Z.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),N.Z.addEvent(t,"mousemove",this.mouseMoveListener,this),N.Z.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),N.Z.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0}},addTouchEventHandlers:function(t){if(!this.hasTouchHandlers&&N.Z.isBrowser){var e=this.attr.movetarget||this.containerObj;N.Z.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),N.Z.addEvent(e,"touchmove",this.touchMoveListener,this),this.hasTouchHandlers=!0}},addFullscreenEventHandlers:function(){var t,e=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],o=e.length;if(!this.hasFullscreenEventHandlers&&N.Z.isBrowser){for(t=0;t<o;t++)N.Z.addEvent(this.document,e[t],this.fullscreenListener,this);this.hasFullscreenEventHandlers=!0}},addKeyboardEventHandlers:function(){this.attr.keyboard.enabled&&!this.hasKeyboardHandlers&&N.Z.isBrowser&&(N.Z.addEvent(this.containerObj,"keydown",this.keyDownListener,this),N.Z.addEvent(this.containerObj,"focusin",this.keyFocusInListener,this),N.Z.addEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!0)},removeKeyboardEventHandlers:function(){this.hasKeyboardHandlers&&N.Z.isBrowser&&(N.Z.removeEvent(this.containerObj,"keydown",this.keyDownListener,this),N.Z.removeEvent(this.containerObj,"focusin",this.keyFocusInListener,this),N.Z.removeEvent(this.containerObj,"focusout",this.keyFocusOutListener,this),this.hasKeyboardHandlers=!1)},removeFullscreenEventHandlers:function(){var t,e=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"],o=e.length;if(this.hasFullscreenEventHandlers&&N.Z.isBrowser){for(t=0;t<o;t++)N.Z.removeEvent(this.document,e[t],this.fullscreenListener,this);this.hasFullscreenEventHandlers=!1}},removePointerEventHandlers:function(){if(this.hasPointerHandlers&&N.Z.isBrowser){var t=this.attr.movetarget||this.containerObj;window.navigator.msPointerEnabled?(N.Z.removeEvent(this.containerObj,"MSPointerDown",this.pointerDownListener,this),N.Z.removeEvent(t,"MSPointerMove",this.pointerMoveListener,this)):(N.Z.removeEvent(this.containerObj,"pointerdown",this.pointerDownListener,this),N.Z.removeEvent(t,"pointermove",this.pointerMoveListener,this)),N.Z.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),N.Z.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasPointerUp&&(window.navigator.msPointerEnabled?N.Z.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(N.Z.removeEvent(this.document,"pointerup",this.pointerUpListener,this),N.Z.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),this.hasPointerHandlers=!1}},removeMouseEventHandlers:function(){if(this.hasMouseHandlers&&N.Z.isBrowser){var t=this.attr.movetarget||this.containerObj;N.Z.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),N.Z.removeEvent(t,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(N.Z.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),N.Z.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),N.Z.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1}},removeTouchEventHandlers:function(){if(this.hasTouchHandlers&&N.Z.isBrowser){var t=this.attr.movetarget||this.containerObj;N.Z.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),N.Z.removeEvent(t,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(N.Z.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.hasTouchHandlers=!1}},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(t){var e,o,s,n,h,l,p,d,b,Z,y,O,x=!1,D=this.attr.zoom.factorx,k=this.attr.zoom.factory;return this.mode!==this.BOARD_MODE_ZOOM||(t.preventDefault(),l=_.Z.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),t.scale===void 0&&(t.scale=l/this.prevDist),!!a.Z.exists(this.prevCoords)&&(o=[t.touches[0].clientX-this.prevCoords[0][0],t.touches[0].clientY-this.prevCoords[0][1]],s=[t.touches[1].clientX-this.prevCoords[1][0],t.touches[1].clientY-this.prevCoords[1][1]],o[0]*o[0]+o[1]*o[1]<100&&s[0]*s[0]+s[1]*s[1]<100||(n=_.Z.rad(o,[0,0],s),this.isPreviousGesture!=="pan"&&Math.abs(n)>.2*Math.PI&&Math.abs(n)<1.8*Math.PI&&(x=!0),this.isPreviousGesture==="pan"||x||(Math.abs(t.scale)<.77||Math.abs(t.scale)>1.3)&&(x=!0),h=t.scale/this.prevScale,this.prevScale=t.scale,this.prevCoords=[[t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY]],e=new m.Z(S.Z.COORDS_BY_SCREEN,this.getMousePosition(t,0),this),this.attr.pan.enabled&&this.attr.pan.needtwofingers&&!x?(this.isPreviousGesture="pan",this.moveOrigin(e.scrCoords[1],e.scrCoords[2],!0)):this.attr.zoom.enabled&&Math.abs(h-1)<.5&&((this.attr.zoom.pinchhorizontal||this.attr.zoom.pinchvertical)&&(p=Math.abs(t.touches[0].clientX-t.touches[1].clientX),d=Math.abs(t.touches[0].clientY-t.touches[1].clientY),b=Math.abs(Math.atan2(d,p)),O=Math.PI*this.attr.zoom.pinchsensitivity/90),this.attr.zoom.pinchhorizontal&&b<O?(this.attr.zoom.factorx=h,this.attr.zoom.factory=1,Z=0,y=0):this.attr.zoom.pinchvertical&&Math.abs(b-.5*Math.PI)<O?(this.attr.zoom.factorx=1,this.attr.zoom.factory=h,Z=0,y=0):(this.attr.zoom.factorx=h,this.attr.zoom.factory=h,Z=e.usrCoords[1],y=e.usrCoords[2]),this.zoomIn(Z,y),this.attr.zoom.factorx=D,this.attr.zoom.factory=k)),!1))},gestureStartListener:function(t){var e;return t.preventDefault(),this.prevScale=1,this.prevDist=_.Z.distance([t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY],2),this.prevCoords=[[t.touches[0].clientX,t.touches[0].clientY],[t.touches[1].clientX,t.touches[1].clientY]],this.isPreviousGesture="none",e=this.getMousePosition(t,0),this.initMoveOrigin(e[0],e[1]),this.mode=this.BOARD_MODE_ZOOM,!1},_isRequiredKeyPressed:function(t,e){var o=this.attr[e];return!!o.enabled&&!(!(o.needshift&&t.shiftKey||!o.needshift&&!t.shiftKey)||!(o.needctrl&&t.ctrlKey||!o.needctrl&&!t.ctrlKey))},_isPointerRegistered:function(t){var e,o=this._board_touches.length;for(e=0;e<o;e++)if(this._board_touches[e].pointerId===t.pointerId)return!0;return!1},_pointerStorePosition:function(t){var e,o;for(e=0,o=!1;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches[e].clientX=t.clientX,this._board_touches[e].clientY=t.clientY,o=!0;break}return!o&&this._board_touches.length<2&&this._board_touches.push({pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY}),this},_pointerRemoveTouches:function(t){var e;for(e=0;e<this._board_touches.length;e++)if(this._board_touches[e].pointerId===t.pointerId){this._board_touches.splice(e,1);break}return this},_pointerClearTouches:function(){this._board_touches.length>0&&this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode=this.BOARD_MODE_NONE,this._board_touches=[],this.touches=[]},_getPointerInputDevice:function(t){if(N.Z.isBrowser){if(t.pointerType==="touch"||window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>1)return"touch";if(t.pointerType==="mouse")return"mouse";if(t.pointerType==="pen")return"pen"}return"mouse"},pointerDownListener:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O;if(!e&&this._isPointerRegistered(t))return!1;if(!e&&t.isPrimary&&this._pointerClearTouches(),this.hasPointerUp||(window.navigator.msPointerEnabled?N.Z.addEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(N.Z.addEvent(this.document,"pointerup",this.pointerUpListener,this),N.Z.addEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),this.hasTouchHandlers&&this.removeTouchEventHandlers(),this.document.selection&&a.Z.isFunction(this.document.selection.empty))this.document.selection.empty();else if(window.getSelection&&(p=window.getSelection()).removeAllRanges)try{p.removeAllRanges()}catch{}if(this._inputDevice=this._getPointerInputDevice(t),b=this._inputDevice,this.options.precision.hasPoint=this.options.precision[b],h=this.getMousePosition(t),this._testForSelection(t),this.selectingMode)return this._startSelecting(h),void this.triggerEventHandlers(["touchstartselecting","pointerstartselecting","startselecting"],[t]);if(this.attr.drag.enabled&&e?(l=[e],this.mode=this.BOARD_MODE_DRAG):l=this.initMoveObject(h[0],h[1],t,b),d={num:t.pointerId,X:h[0],Y:h[1],Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},l.length>0){for(y=l[l.length-1],Z=!1,o=0;o<this.touches.length;o++)if(this.touches[o].obj===y){s=o,n=this.touches[o].targets.push(d)-1,Z=!0;break}Z||(n=0,s=this.touches.push({obj:y,targets:[d]})-1),this.dehighlightAll(),y.highlight(!0),this.saveStartPos(y,this.touches[s].targets[n]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)}return this.touches.length>0&&(t.preventDefault(),t.stopPropagation()),!!N.Z.isBrowser&&(this._getPointerInputDevice(t)!=="touch"?this.mode===this.BOARD_MODE_NONE&&this.mouseOriginMoveStart(t):(this._pointerStorePosition(t),t.touches=this._board_touches,t.touches.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(t)||t.touches.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(t))),O="none",this.mode!==this.BOARD_MODE_NONE||!a.Z.evaluate(this.attr.browserpan)||a.Z.evaluate(this.attr.pan.enabled)&&!a.Z.evaluate(this.attr.pan.needtwofingers)||(O="pan-x pan-y"),this.containerObj.style.touchAction=O,this.triggerEventHandlers(["touchstart","down","pointerdown","MSPointerDown"],[t]),!0)},pointerMoveListener:function(t){var e,o,s,n,h;if(this._getPointerInputDevice(t)==="touch"&&!this._isPointerRegistered(t))return this.BOARD_MODE_NONE;if(!this.checkFrameRate(t))return!1;if(this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.mode!==this.BOARD_MODE_NONE&&(t.preventDefault(),t.stopPropagation()),this.updateQuality=this.BOARD_QUALITY_LOW,this._inputDevice=this._getPointerInputDevice(t),h=this._inputDevice,this.options.precision.hasPoint=this.options.precision[h],this.selectingMode)s=this.getMousePosition(t),this._moveSelecting(s),this.triggerEventHandlers(["touchmoveselecting","moveselecting","pointermoveselecting"],[t,this.mode]);else if(!this.mouseOriginMove(t))if(this.mode===this.BOARD_MODE_DRAG){for(e=0;e<this.touches.length;e++)for(n=this.touches[e].targets,o=0;o<n.length;o++)if(n[o].num===t.pointerId){s=this.getMousePosition(t),n[o].X=s[0],n[o].Y=s[1],n.length===1?this.moveObject(s[0],s[1],this.touches[e],t,h):n.length===2&&(this.twoFingerMove(this.touches[e],t.pointerId,t),n[o].Xprev=s[0],n[o].Yprev=s[1]);break}}else this._getPointerInputDevice(t)==="touch"&&(this._pointerStorePosition(t),this._board_touches.length===2&&(t.touches=this._board_touches,this.gestureChangeListener(t))),s=this.getMousePosition(t),this.highlightElements(s[0],s[1],t,-1);return this.triggerEventHandlers(["pointermove","MSPointerMove","move"],[t,this.mode]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},pointerUpListener:function(t){var e,o,s,n,h=!1;if(this.triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),this.displayInfobox(!1),t){for(e=0;e<this.touches.length;e++)for(n=this.touches[e].targets,o=0;o<n.length;o++)if(n[o].num===t.pointerId){n.splice(o,1),n.length===0&&this.touches.splice(e,1);break}}if(this.originMoveEnd(),this.update(),this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["touchstopselecting","pointerstopselecting","stopselecting"],[t]),this.stopSelectionMode();else for(e=this.downObjects.length-1;e>-1;e--){for(s=!1,o=0;o<this.touches.length;o++)this.touches[o].obj.id===this.downObjects[e].id&&(s=!0);s||(this.downObjects[e].triggerEventHandlers(["touchend","up","pointerup","MSPointerUp"],[t]),a.Z.exists(this.downObjects[e].coords)||(this.downObjects[e].snapToGrid(),this.downObjects[e].snapToPoints(),h=!0),this.downObjects.splice(e,1))}return this.hasPointerUp&&(window.navigator.msPointerEnabled?N.Z.removeEvent(this.document,"MSPointerUp",this.pointerUpListener,this):(N.Z.removeEvent(this.document,"pointerup",this.pointerUpListener,this),N.Z.removeEvent(this.document,"pointercancel",this.pointerUpListener,this)),this.hasPointerUp=!1),h&&this.update(),this._pointerClearTouches(),!0},touchStartListener:function(t){var e,o,s,n,h,l,p,d,b,Z,y=this.options.precision.touch,O=t[u.Z.touchProperty];for(this.hasTouchEnd||(N.Z.addEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.document.selection&&a.Z.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,e=0;e<O.length;e++)O[e].jxg_isused=!1;for(e=0;e<this.touches.length;e++)for(Z=this.touches[e].targets,n=0;n<Z.length;n++){Z[n].num=-1,y=this.options.precision.touch;do{for(h=0;h<O.length;h++)if(Math.abs(Math.pow(O[h].screenX-Z[n].X,2)+Math.pow(O[h].screenY-Z[n].Y,2))<y*y){Z[n].num=h,Z[n].X=O[h].screenX,Z[n].Y=O[h].screenY,O[h].jxg_isused=!0;break}y*=2}while(Z[n].num===-1&&y<this.options.precision.touchMax);Z[n].num===-1&&(u.Z.debug("i couldn't find a targettouches for target no "+n+" on "+this.touches[e].obj.name+" ("+this.touches[e].obj.id+"). Removed the target."),u.Z.debug("eps = "+y+", touchMax = "+it.Z.precision.touchMax),Z.splice(e,1))}for(e=0;e<O.length;e++)if(!O[e].jxg_isused){if(o=this.getMousePosition(t,e),this.selectingMode)return this._startSelecting(o),this.triggerEventHandlers(["touchstartselecting","startselecting"],[t]),t.preventDefault(),t.stopPropagation(),this.options.precision.hasPoint=this.options.precision.mouse,this.touches.length>0;if((s=this.initMoveObject(o[0],o[1],t,"touch")).length!==0){if(l=s[s.length-1],b={num:e,X:O[e].screenX,Y:O[e].screenY,Xprev:NaN,Yprev:NaN,Xstart:[],Ystart:[],Zstart:[]},a.Z.isPoint(l)||l.elementClass===S.Z.OBJECT_CLASS_TEXT||l.type===S.Z.OBJECT_TYPE_TICKS||l.type===S.Z.OBJECT_TYPE_IMAGE)d=[b],this.saveStartPos(l,d[0]),this.touches.push({obj:l,targets:d}),l.highlight(!0);else if(l.elementClass===S.Z.OBJECT_CLASS_LINE||l.elementClass===S.Z.OBJECT_CLASS_CIRCLE||l.elementClass===S.Z.OBJECT_CLASS_CURVE||l.type===S.Z.OBJECT_TYPE_POLYGON){for(p=!1,n=0;n<this.touches.length;n++)l.id===this.touches[n].obj.id&&(p=!0,this.touches[n].targets.length===1&&(this.saveStartPos(l,b),this.touches[n].targets.push(b)),O[e].jxg_isused=!0);p||(d=[b],this.saveStartPos(l,d[0]),this.touches.push({obj:l,targets:d}),l.highlight(!0))}}O[e].jxg_isused=!0}return this.touches.length>0&&(t.preventDefault(),t.stopPropagation()),O.length===1&&this.mode===this.BOARD_MODE_NONE&&this.touchStartMoveOriginOneFinger(t)||O.length!==2||this.mode!==this.BOARD_MODE_NONE&&this.mode!==this.BOARD_MODE_MOVE_ORIGIN||(this.mode===this.BOARD_MODE_MOVE_ORIGIN&&this.originMoveEnd(),this.gestureStartListener(t)),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],[t]),!1},touchMoveListener:function(t){var e,o,s,n,h=t[u.Z.touchProperty];if(!this.checkFrameRate(t))return!1;if(this.mode!==this.BOARD_MODE_NONE&&(t.preventDefault(),t.stopPropagation()),this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this._inputDevice="touch",this.options.precision.hasPoint=this.options.precision.touch,this.updateQuality=this.BOARD_QUALITY_LOW,this.selectingMode){for(e=0;e<h.length;e++)if(!h[e].jxg_isused){o=this.getMousePosition(t,e),this._moveSelecting(o),this.triggerEventHandlers(["touchmoves","moveselecting"],[t,this.mode]);break}}else if(!this.touchOriginMove(t))if(this.mode===this.BOARD_MODE_DRAG){for(e=0;e<this.touches.length;e++)if((n=this.touches[e].targets).length===1){if(h[n[0].num]){if((o=this.getMousePosition(t,n[0].num))[0]<0||o[0]>this.canvasWidth||o[1]<0||o[1]>this.canvasHeight)return;n[0].X=o[0],n[0].Y=o[1],this.moveObject(o[0],o[1],this.touches[e],t,"touch")}}else if(n.length===2&&n[0].num>-1&&n[1].num>-1&&h[n[0].num]&&h[n[1].num]){if(o=this.getMousePosition(t,n[0].num),s=this.getMousePosition(t,n[1].num),o[0]<0||o[0]>this.canvasWidth||o[1]<0||o[1]>this.canvasHeight||s[0]<0||s[0]>this.canvasWidth||s[1]<0||s[1]>this.canvasHeight)return;n[0].X=o[0],n[0].Y=o[1],n[1].X=s[0],n[1].Y=s[1],this.twoFingerMove(this.touches[e],n[0].num,t),this.twoFingerMove(this.touches[e],n[1].num),n[0].Xprev=o[0],n[0].Yprev=o[1],n[1].Xprev=s[0],n[1].Yprev=s[1]}}else h.length===2&&this.gestureChangeListener(t),o=this.getMousePosition(t,0),this.highlightElements(o[0],o[1],t,-1);return this.mode!==this.BOARD_MODE_DRAG&&this.displayInfobox(!1),this.triggerEventHandlers(["touchmove","move"],[t,this.mode]),this.options.precision.hasPoint=this.options.precision.mouse,this.updateQuality=this.BOARD_QUALITY_HIGH,this.mode===this.BOARD_MODE_NONE},touchEndListener:function(t){var e,o,s,n,h,l,p=this.options.precision.touch,d=[],b=t&&t[u.Z.touchProperty],Z=!1;if(this.triggerEventHandlers(["touchend","up"],[t]),this.displayInfobox(!1),this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["touchstopselecting","stopselecting"],[t]),this.stopSelectionMode();else if(b&&b.length>0){for(e=0;e<this.touches.length;e++)d[e]=this.touches[e];for(this.touches.length=0,e=0;e<b.length;e++)b[e].jxg_isused=!1;for(e=0;e<d.length;e++){for(n=!1,h=0,l=d[e].targets,o=0;o<l.length;o++)for(l[o].found=!1,s=0;s<b.length;s++)if(Math.abs(Math.pow(b[s].screenX-l[o].X,2)+Math.pow(b[s].screenY-l[o].Y,2))<p*p){l[o].found=!0,l[o].num=s,l[o].X=b[s].screenX,l[o].Y=b[s].screenY,h+=1;break}if(a.Z.isPoint(d[e].obj)?n=l[0]&&l[0].found:d[e].obj.elementClass===S.Z.OBJECT_CLASS_LINE?n=l[0]&&l[0].found||l[1]&&l[1].found:d[e].obj.elementClass===S.Z.OBJECT_CLASS_CIRCLE&&(n=h===1||h===3),n)for(this.touches.push({obj:d[e].obj,targets:[]}),o=0;o<l.length;o++)l[o].found&&this.touches[this.touches.length-1].targets.push({num:l[o].num,X:l[o].screenX,Y:l[o].screenY,Xprev:NaN,Yprev:NaN,Xstart:l[o].Xstart,Ystart:l[o].Ystart,Zstart:l[o].Zstart});else d[e].obj.noHighlight()}}else this.touches.length=0;for(e=this.downObjects.length-1;e>-1;e--){for(n=!1,o=0;o<this.touches.length;o++)this.touches[o].obj.id===this.downObjects[e].id&&(n=!0);n||(this.downObjects[e].triggerEventHandlers(["touchup","up"],[t]),a.Z.exists(this.downObjects[e].coords)||(this.downObjects[e].snapToGrid(),this.downObjects[e].snapToPoints(),Z=!0),this.downObjects.splice(e,1))}return b&&b.length!==0||(this.hasTouchEnd&&(N.Z.removeEvent(this.document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),Z&&this.update()),!0},mouseDownListener:function(t){var e,o,s;if(this.document.selection&&a.Z.isFunction(this.document.selection.empty)?this.document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!this.hasMouseUp)return N.Z.addEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0,this._inputDevice="mouse",this.options.precision.hasPoint=this.options.precision.mouse,e=this.getMousePosition(t),this._testForSelection(t),this.selectingMode?(this._startSelecting(e),void this.triggerEventHandlers(["mousestartselecting","startselecting"],[t])):((o=this.initMoveObject(e[0],e[1],t,"mouse")).length===0?(this.mode=this.BOARD_MODE_NONE,s=!0):(this.mouse={obj:null,targets:[{X:e[0],Y:e[1],Xprev:NaN,Yprev:NaN}]},this.mouse.obj=o[o.length-1],this.dehighlightAll(),this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),t&&t.preventDefault?t.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(s=this.mouseOriginMoveStart(t)),this.triggerEventHandlers(["mousedown","down"],[t]),s)},mouseMoveListener:function(t){var e;if(!this.checkFrameRate(t))return!1;e=this.getMousePosition(t),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!==this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.displayInfobox(!1)),this.selectingMode?(this._moveSelecting(e),this.triggerEventHandlers(["mousemoveselecting","moveselecting"],[t,this.mode])):this.mouseOriginMove(t)||(this.mode===this.BOARD_MODE_DRAG?this.moveObject(e[0],e[1],this.mouse,t,"mouse"):this.highlightElements(e[0],e[1],t,-1),this.triggerEventHandlers(["mousemove","move"],[t,this.mode])),this.updateQuality=this.BOARD_QUALITY_HIGH},mouseUpListener:function(t){var e;if(this.selectingMode===!1&&this.triggerEventHandlers(["mouseup","up"],[t]),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&(a.Z.exists(this.mouse.obj.coords)||(this.mouse.obj.snapToGrid(this.mouse.targets[0]),this.mouse.obj.snapToPoints())),this.originMoveEnd(),this.dehighlightAll(),this.update(),this.selectingMode)this._stopSelecting(t),this.triggerEventHandlers(["mousestopselecting","stopselecting"],[t]),this.stopSelectionMode();else for(e=0;e<this.downObjects.length;e++)this.downObjects[e].triggerEventHandlers(["mouseup","up"],[t]);this.downObjects.length=0,this.hasMouseUp&&(N.Z.removeEvent(this.document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseWheelListener:function(t){if(!this.attr.zoom.wheel||!this._isRequiredKeyPressed(t,"zoom"))return!0;var e=(t=t||window.event).detail?-t.detail:t.wheelDelta/40,o=new m.Z(S.Z.COORDS_BY_SCREEN,this.getMousePosition(t),this);return e>0?this.zoomIn(o.usrCoords[1],o.usrCoords[2]):this.zoomOut(o.usrCoords[1],o.usrCoords[2]),this.triggerEventHandlers(["mousewheel"],[t]),t.preventDefault(),!1},keyDownListener:function(t){var e,o,s,n,h,l,p=t.target.id,d=0,b=0,Z=a.Z.evaluate(this.attr.keyboard.dx)/this.unitX,y=a.Z.evaluate(this.attr.keyboard.dy)/this.unitY,O=!1,x=!0;return!(!this.attr.keyboard.enabled||p==="")&&(!(n=this.containerObj.shadowRoot||document).activeElement||(o=n.activeElement).tagName!=="INPUT"&&o.tagName!=="textarea")&&(e=p.replace(this.containerObj.id+"_",""),o=this.select(e),a.Z.exists(o.coords)&&(l=o.coords.usrCoords.slice(1)),a.Z.evaluate(this.attr.keyboard.panshift)&&t.shiftKey||a.Z.evaluate(this.attr.keyboard.panctrl)&&t.ctrlKey?(a.Z.evaluate(this.attr.zoom.enabled)===!0&&(O=!0),t.keyCode===38?this.clickUpArrow():t.keyCode===40?this.clickDownArrow():t.keyCode===37?this.clickLeftArrow():t.keyCode===39?this.clickRightArrow():O&&t.keyCode===171?this.zoomIn():O&&t.keyCode===173?this.zoomOut():O&&t.keyCode===79?this.zoom100():x=!1):(a.Z.exists(o.visProp)&&(a.Z.exists(o.visProp.snaptogrid)&&o.visProp.snaptogrid&&a.Z.evaluate(o.visProp.snapsizex)&&a.Z.evaluate(o.visProp.snapsizey)?(d=(s=o.getSnapSizes())[0],b=s[1],Z=Math.max(d,Z),y=Math.max(b,y)):a.Z.exists(o.visProp.attracttogrid)&&o.visProp.attracttogrid&&a.Z.evaluate(o.visProp.attractordistance)&&a.Z.evaluate(o.visProp.attractorunit)&&(b=d=1.1*a.Z.evaluate(o.visProp.attractordistance),a.Z.evaluate(o.visProp.attractorunit)==="screen"&&(d/=this.unitX,b/=this.unitX),Z=Math.max(d,Z),y=Math.max(b,y))),t.keyCode===38?h=[0,y]:t.keyCode===40?h=[0,-y]:t.keyCode===37?h=[-Z,0]:t.keyCode===39?h=[Z,0]:x=!1,h&&o.isDraggable&&o.visPropCalc.visible&&(this.geonextCompatibilityMode&&(a.Z.isPoint(o)||o.elementClass===S.Z.OBJECT_CLASS_TEXT)||!this.geonextCompatibilityMode)&&!a.Z.evaluate(o.visProp.fixed)&&(this.mode=this.BOARD_MODE_DRAG,a.Z.exists(o.coords)&&(h[0]+=l[0],h[1]+=l[1]),a.Z.exists(o.coords)?(o.setPosition(u.Z.COORDS_BY_USER,h),this.updateInfobox(o)):(this.displayInfobox(!1),o.setPositionDirectly(S.Z.COORDS_BY_USER,h,[0,0])),this.triggerEventHandlers(["keymove","move"],[t,this.mode]),o.triggerEventHandlers(["keydrag","drag"],[t]),this.mode=this.BOARD_MODE_NONE)),this.update(),x&&a.Z.exists(t.preventDefault)&&t.preventDefault(),x)},keyFocusInListener:function(t){var e,o,s=t.target.id;if(!this.attr.keyboard.enabled||s==="")return!1;e=s.replace(this.containerObj.id+"_",""),o=this.select(e),a.Z.exists(o.highlight)&&(o.highlight(!0),this.focusObjects=[e],o.triggerEventHandlers(["hit"],[t])),a.Z.exists(o.coords)&&this.updateInfobox(o)},keyFocusOutListener:function(t){if(!this.attr.keyboard.enabled)return!1;this.focusObjects=[],this.dehighlightAll(),this.displayInfobox(!1)},updateContainerDims:function(){var t,e,o,s,n,h;t=(o=this.containerObj.getBoundingClientRect()).width,e=o.height,window&&window.getComputedStyle&&(s=window.getComputedStyle(this.containerObj,null),n=parseFloat(s.getPropertyValue("border-left-width"))+parseFloat(s.getPropertyValue("border-right-width")),isNaN(n)||(t-=n),h=parseFloat(s.getPropertyValue("border-top-width"))+parseFloat(s.getPropertyValue("border-bottom-width")),isNaN(h)||(e-=h)),t<=0||e<=0||isNaN(t)||isNaN(e)||(isNaN(this.getBoundingBox()[0])&&this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"keep"),a.Z.exists(this._prevDim)&&this._prevDim.w===t&&this._prevDim.h===e||(this.resizeContainer(t,e,!0),this._prevDim={w:t,h:e}))},startResizeObserver:function(){var t=this;N.Z.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this.resizeObserver=new ResizeObserver(function(e){t._isResizing||(t._isResizing=!0,window.setTimeout(function(){try{t.updateContainerDims()}catch{t.stopResizeObserver()}finally{t._isResizing=!1}},t.attr.resize.throttle))}),this.resizeObserver.observe(this.containerObj))},stopResizeObserver:function(){N.Z.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&a.Z.exists(this.resizeObserver)&&this.resizeObserver.unobserve(this.containerObj)},resizeListener:function(){var t=this;N.Z.isBrowser&&this.attr.resize&&this.attr.resize.enabled&&(this._isScrolling||this._isResizing||(this._isResizing=!0,window.setTimeout(function(){t.updateContainerDims(),t._isResizing=!1},this.attr.resize.throttle)))},scrollListener:function(t){var e=this;N.Z.isBrowser&&(this._isScrolling||(this._isScrolling=!0,window.setTimeout(function(){e._isScrolling=!1},66)))},startIntersectionObserver:function(){var t=this;try{this.intersectionObserver=new IntersectionObserver(function(e){isNaN(t.getBoundingBox()[0])&&t.updateContainerDims()},{root:null,rootMargin:"0px",threshold:.8}),this.intersectionObserver.observe(t.containerObj)}catch{console.log("JSXGraph: IntersectionObserver not available in this browser.")}},stopIntersectionObserver:function(){a.Z.exists(this.intersectionObserver)&&this.intersectionObserver.unobserve(this.containerObj)},initInfobox:function(){var t=a.Z.copyAttributes({},this.options,"infobox");return t.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],t),this.infobox.dump=!1,this.displayInfobox(!1),this},updateInfobox:function(t){var e,o,s,n,h,l,p,d=a.Z.evaluate(t.visProp.showinfobox);return!a.Z.evaluate(this.attr.showinfobox)&&d==="inherit"||!d||a.Z.isPoint(t)&&(s=t.coords.usrCoords[1],n=t.coords.usrCoords[2],l=a.Z.evaluate(this.infobox.visProp.distancex),p=a.Z.evaluate(this.infobox.visProp.distancey),h=a.Z.evaluate(t.visProp.infoboxdigits),this.infobox.setCoords(s+l/this.unitX,n+p/this.unitY),typeof t.infoboxText!="string"?(h==="auto"?(e=a.Z.autoDigits(s),o=a.Z.autoDigits(n)):a.Z.isNumber(h)?(e=a.Z.toFixed(s,h),o=a.Z.toFixed(n,h)):(e=s,o=n),this.highlightInfobox(e,o,t)):this.highlightCustomInfobox(t.infoboxText,t),this.displayInfobox(!0)),this},displayInfobox:function(t){return!t&&this.focusObjects.length>0&&this.select(this.focusObjects[0]).elementClass===S.Z.OBJECT_CLASS_POINT||this.infobox.hiddenByParent===t&&(this.infobox.hiddenByParent=!t,this.infobox.prepareUpdate().updateVisibility(t).updateRenderer()),this},showInfobox:function(t){return this.displayInfobox(t)},highlightInfobox:function(t,e,o){return this.highlightCustomInfobox("("+t+", "+e+")",o),this},highlightCustomInfobox:function(t,e){return this.infobox.setText(t),this},dehighlightAll:function(){var t,e,o={},s=!1;for(t in this.highlightedObjects)this.highlightedObjects.hasOwnProperty(t)&&(e=this.highlightedObjects[t],this.focusObjects.indexOf(t)<0?((this.hasMouseHandlers||this.hasPointerHandlers)&&e.noHighlight(),s=!0):o[t]=e);return this.highlightedObjects=o,this.renderer.type==="canvas"&&s&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(t,e){return[t,e]},getUsrCoordsOfMouse:function(t){var e=this.getCoordsTopLeftCorner(),o=N.Z.getPosition(t,null,this.document),s=o[0]-e[0],n=o[1]-e[1];return new m.Z(S.Z.COORDS_BY_SCREEN,[s,n],this).usrCoords.slice(1)},getAllUnderMouse:function(t){var e=this.getAllObjectsUnderMouse(t);return e.push(this.getUsrCoordsOfMouse(t)),e},getAllObjectsUnderMouse:function(t){var e,o,s=this.getCoordsTopLeftCorner(),n=N.Z.getPosition(t,null,this.document),h=n[0]-s[0],l=n[1]-s[1],p=[],d=this.objectsList.length;for(e=0;e<d;e++)(o=this.objectsList[e]).visPropCalc.visible&&o.hasPoint&&o.hasPoint(h,l)&&(p[p.length]=o);return p},updateCoords:function(){var t,e,o=this.objectsList.length;for(e=0;e<o;e++)t=this.objectsList[e],a.Z.exists(t.coords)&&(a.Z.evaluate(t.visProp.frozen)?t.coords.screen2usr():t.coords.usr2screen());return this},moveOrigin:function(t,e,o){var s,n,h,l;return a.Z.exists(t)&&a.Z.exists(e)&&(s=this.origin.scrCoords[1],n=this.origin.scrCoords[2],this.origin.scrCoords[1]=t,this.origin.scrCoords[2]=e,o&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy),h=new m.Z(S.Z.COORDS_BY_SCREEN,[0,0],this).usrCoords,l=new m.Z(S.Z.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords,(h[1]<this.maxboundingbox[0]||h[2]>this.maxboundingbox[1]||l[1]>this.maxboundingbox[2]||l[2]<this.maxboundingbox[3])&&(this.origin.scrCoords[1]=s,this.origin.scrCoords[2]=n)),this.updateCoords().clearTraces().fullUpdate(),this.triggerEventHandlers(["boundingbox"]),this},addConditions:function(t){var e,o,s,n,h,l,p,d=[],b=t.indexOf("<data>"),Z=t.indexOf("</data>"),y=function(I,U,J,z){return function(){var V,W;W=(V=I.select(U.id)).coords.usrCoords[z],z===2?V.setPositionDirectly(S.Z.COORDS_BY_USER,[J(),W]):V.setPositionDirectly(S.Z.COORDS_BY_USER,[W,J()]),V.prepareUpdate().update()}},O=function(I,U,J){return function(){var z,V;z=I.select(U.id),V=J(),z.setAttribute({visible:V})}},x=function(I,U,J,z){return function(){var V,W;V=I.select(U.id),W=J(),z==="strokewidth"?V.visProp.strokewidth=W:(W=_t.Z.rgba2rgbo(W),V.visProp[z+"color"]=W[0],V.visProp[z+"opacity"]=W[1])}},D=function(I,U,J){return function(){I.select(U.id).position=J()}},k=function(I,U,J){return function(){I.select(U.id).setStyle(J())}};if(!(b<0)){for(;b>=0;){if(o=(e=t.slice(b+6,Z)).indexOf("="),s=e.slice(0,o),n=e.slice(o+1),o=s.indexOf("."),h=s.slice(0,o),l=this.elementsByName[a.Z.unescapeHTML(h)],p=s.slice(o+1).replace(/\s+/g,"").toLowerCase(),n=a.Z.createFunction(n,this,"",!0),a.Z.exists(this.elementsByName[h]))switch(p){case"x":d.push(y(this,l,n,2));break;case"y":d.push(y(this,l,n,1));break;case"visible":d.push(O(this,l,n));break;case"position":d.push(D(this,l,n));break;case"stroke":d.push(x(this,l,n,"stroke"));break;case"style":d.push(k(this,l,n));break;case"strokewidth":d.push(x(this,l,n,"strokewidth"));break;case"fill":d.push(x(this,l,n,"fill"));break;case"label":break;default:u.Z.debug("property '"+p+"' in conditions not yet implemented:"+n)}else u.Z.debug("debug conditions: |"+h+"| undefined");b=(t=t.slice(Z+7)).indexOf("<data>"),Z=t.indexOf("</data>")}this.updateConditions=function(){var I;for(I=0;I<d.length;I++)d[I]();return this.prepareUpdate().updateElements(),!0},this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var t=new m.Z(S.Z.COORDS_BY_USER,[0,0],this),e=new m.Z(S.Z.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),o=t.scrCoords[1]-e.scrCoords[1],s=t.scrCoords[2]-e.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(o)>25;)this.options.grid.snapSizeX*=2,o/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(s)>25;)this.options.grid.snapSizeY*=2,s/=2;return this},applyZoom:function(){return this.updateCoords().calculateSnapSizes().clearTraces().fullUpdate(),this},zoomIn:function(t,e){var o=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,h=(o[2]-o[0])*(1-1/s),l=(o[1]-o[3])*(1-1/n),p=.5,d=.5,b=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX>this.attr.zoom.max&&s>1||this.zoomY>this.attr.zoom.max&&n>1||this.zoomX<b&&s<1||this.zoomY<b&&n<1?this:(a.Z.isNumber(t)&&a.Z.isNumber(e)&&(p=(t-o[0])/(o[2]-o[0]),d=(o[1]-e)/(o[1]-o[3])),this.setBoundingBox([o[0]+h*p,o[1]-l*d,o[2]-h*(1-p),o[3]+l*(1-d)],this.keepaspectratio,"update"),this.applyZoom())},zoomOut:function(t,e){var o=this.getBoundingBox(),s=this.attr.zoom.factorx,n=this.attr.zoom.factory,h=(o[2]-o[0])*(1-s),l=(o[1]-o[3])*(1-n),p=.5,d=.5,b=this.attr.zoom.eps||this.attr.zoom.min||.001;return this.zoomX<b||this.zoomY<b?this:(a.Z.isNumber(t)&&a.Z.isNumber(e)&&(p=(t-o[0])/(o[2]-o[0]),d=(o[1]-e)/(o[1]-o[3])),this.setBoundingBox([o[0]+h*p,o[1]-l*d,o[2]-h*(1-p),o[3]+l*(1-d)],this.keepaspectratio,"update"),this.applyZoom())},zoom100:function(){var t,e,o;return a.Z.exists(this.attr.boundingbox)?this.setBoundingBox(this.attr.boundingbox,this.keepaspectratio,"reset"):(e=((t=this.getBoundingBox())[2]-t[0])*(1-this.zoomX)*.5,o=(t[1]-t[3])*(1-this.zoomY)*.5,this.setBoundingBox([t[0]+e,t[1]-o,t[2]-e,t[3]+o],this.keepaspectratio,"reset")),this.applyZoom()},zoomAllPoints:function(){var t,e,o,s,n=0,h=0,l=0,p=0,d=this.objectsList.length;for(t=0;t<d;t++)s=this.objectsList[t],a.Z.isPoint(s)&&s.visPropCalc.visible&&(s.coords.usrCoords[1]<n?n=s.coords.usrCoords[1]:s.coords.usrCoords[1]>h&&(h=s.coords.usrCoords[1]),s.coords.usrCoords[2]>p?p=s.coords.usrCoords[2]:s.coords.usrCoords[2]<l&&(l=s.coords.usrCoords[2]));return e=50/this.unitX,o=50/this.unitY,this.setBoundingBox([n-e,p+o,h+e,l-o],this.keepaspectratio,"update"),this.applyZoom()},zoomElements:function(t){var e,o,s,n,h,l,p,d=[1/0,-1/0,-1/0,1/0];if(!a.Z.isArray(t)||t.length===0)return this;for(e=0;e<t.length;e++)o=this.select(t[e]).bounds(),a.Z.isArray(o)&&(o[0]<d[0]&&(d[0]=o[0]),o[1]>d[1]&&(d[1]=o[1]),o[2]>d[2]&&(d[2]=o[2]),o[3]<d[3]&&(d[3]=o[3]));return a.Z.isArray(d)&&(s=.5*(d[0]+d[2]),n=.5*(d[1]+d[3]),h=1.5*(d[2]-d[0])*.5,l=1.5*(d[1]-d[3])*.5,p=Math.max(h,l),this.setBoundingBox([s-p,n+p,s+p,n-p],this.keepaspectratio,"update")),this},setZoom:function(t,e){var o=this.attr.zoom.factorx,s=this.attr.zoom.factory;return this.attr.zoom.factorx=t/this.zoomX,this.attr.zoom.factory=e/this.zoomY,this.zoomIn(),this.attr.zoom.factorx=o,this.attr.zoom.factory=s,this},removeObject:function(t,e){var o,s;if(a.Z.isArray(t)){for(s=0;s<t.length;s++)this.removeObject(t[s]);return this}if(t=this.select(t),!a.Z.exists(t)||a.Z.isString(t))return this;try{for(o in t.childElements)t.childElements.hasOwnProperty(o)&&t.childElements[o].board.removeObject(t.childElements[o]);for(o in t.objects)t.objects.hasOwnProperty(o)&&t.objects[o].board.removeObject(t.objects[o]);if(e)for(o in this.objects)this.objects.hasOwnProperty(o)&&a.Z.exists(this.objects[o].childElements)&&a.Z.exists(this.objects[o].childElements.hasOwnProperty(t.id))&&(delete this.objects[o].childElements[t.id],delete this.objects[o].descendants[t.id]);else if(a.Z.exists(t.ancestors))for(o in t.ancestors)t.ancestors.hasOwnProperty(o)&&a.Z.exists(t.ancestors[o].childElements)&&a.Z.exists(t.ancestors[o].childElements.hasOwnProperty(t.id))&&(delete t.ancestors[o].childElements[t.id],delete t.ancestors[o].descendants[t.id]);if(t._pos>-1)for(this.objectsList.splice(t._pos,1),o=t._pos;o<this.objectsList.length;o++)this.objectsList[o]._pos--;else t.type!==S.Z.OBJECT_TYPE_TURTLE&&u.Z.debug("Board.removeObject: object "+t.id+" not found in list.");delete this.objects[t.id],delete this.elementsByName[t.name],t.visProp&&a.Z.evaluate(t.visProp.trace)&&t.clearTrace(),a.Z.exists(t.remove)&&t.remove()}catch(n){u.Z.debug(t.id+": Could not be removed: "+n)}return this.update(),this},removeAncestors:function(t){var e;for(e in t.ancestors)t.ancestors.hasOwnProperty(e)&&this.removeAncestors(t.ancestors[e]);return this.removeObject(t),this},initGeonextBoard:function(){var t,e,o;return t=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),e=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),o=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),this.create("line",[t,e],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),this.create("line",[t,o],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},resizeContainer:function(t,e,o,s){var n,h,l,p,d;return h=this.canvasWidth,l=this.canvasHeight,s||(n=this.getBoundingBox()),this.canvasWidth=parseFloat(t),this.canvasHeight=parseFloat(e),o||(this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px"),this.renderer.resize(this.canvasWidth,this.canvasHeight),s?(p=(this.canvasWidth-h)/2,d=(this.canvasHeight-l)/2,this.moveOrigin(this.origin.scrCoords[1]+p,this.origin.scrCoords[2]+d)):this.setBoundingBox(n,this.keepaspectratio,"keep"),this},showDependencies:function(){var t,e,o,s,n;for(t in e=`<p>
`,this.objects)if(this.objects.hasOwnProperty(t)){for(o in n=0,this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(o)&&(n+=1);for(o in n>=0&&(e+="<strong>"+this.objects[t].id+":</strong> "),this.objects[t].childElements)this.objects[t].childElements.hasOwnProperty(o)&&(e+=this.objects[t].childElements[o].id+"("+this.objects[t].childElements[o].name+"), ");e+=`<p>
`}return e+=`</p>
`,(s=window.open()).document.open(),s.document.write(e),s.document.close(),this},showXML:function(){var t=window.open("");return t.document.open(),t.document.write("<pre>"+a.Z.escapeHTML(this.xmlString)+"</pre>"),t.document.close(),this},prepareUpdate:function(){var t,e,o=this.objectsList.length;for(t=0;t<o;t++)(e=this.objectsList[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate;for(t in this.groups)this.groups.hasOwnProperty(t)&&((e=this.groups[t]).needsUpdate=e.needsRegularUpdate||this.needsFullUpdate);return this},updateElements:function(t){var e,o;for(t=this.select(t),e=0;e<this.objectsList.length;e++)o=this.objectsList[e],this.needsFullUpdate&&o.elementClass===S.Z.OBJECT_CLASS_TEXT&&o.updateSize(),o.update(!a.Z.exists(t)||o.id!==t.id).updateVisibility();for(e in this.groups)this.groups.hasOwnProperty(e)&&this.groups[e].update(t);return this},updateRenderer:function(){var t,e=this.objectsList.length;if(this.renderer){if(this.renderer.type==="canvas")this.updateRendererCanvas();else for(t=0;t<e;t++)this.objectsList[t].updateRenderer();return this}},updateRendererCanvas:function(){var t,e,o,s,n,h=this.objectsList.length,l=this.options.layer,p=this.options.layer.numlayers,d=Number.NEGATIVE_INFINITY;for(o=0;o<p;o++){for(n in s=Number.POSITIVE_INFINITY,l)l.hasOwnProperty(n)&&l[n]>d&&l[n]<s&&(s=l[n]);for(d=s,t=0;t<h;t++)(e=this.objectsList[t]).visProp.layer===s&&e.prepareUpdate().updateRenderer()}return this},addHook:function(t,e,o){return u.Z.deprecated("Board.addHook()","Board.on()"),e=a.Z.def(e,"update"),o=a.Z.def(o,this),this.hooks.push([e,t]),this.on(e,t,o),this.hooks.length-1},addEvent:u.Z.shortcut(u.Z.Board.prototype,"on"),removeHook:function(t){return u.Z.deprecated("Board.removeHook()","Board.off()"),this.hooks[t]&&(this.off(this.hooks[t][0],this.hooks[t][1]),this.hooks[t]=null),this},removeEvent:u.Z.shortcut(u.Z.Board.prototype,"off"),updateHooks:function(t){var e=Array.prototype.slice.call(arguments,0);return u.Z.deprecated("Board.updateHooks()","Board.triggerEventHandlers()"),e[0]=a.Z.def(e[0],"update"),this.triggerEventHandlers([e[0]],arguments),this},addChild:function(t){return a.Z.exists(t)&&a.Z.exists(t.containerObj)&&(this.dependentBoards.push(t),this.update()),this},removeChild:function(t){var e;for(e=this.dependentBoards.length-1;e>=0;e--)this.dependentBoards[e]===t&&this.dependentBoards.splice(e,1);return this},update:function(t){var e,o,s,n,h;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.attr.minimizereflow==="all"&&this.containerObj&&this.renderer.type!=="vml"&&(h=this.document.activeElement,n=this.renderer.removeToInsertLater(this.containerObj)),this.attr.minimizereflow==="svg"&&this.renderer.type==="svg"&&(h=this.document.activeElement,n=this.renderer.removeToInsertLater(this.renderer.svgRoot)),this.prepareUpdate().updateElements(t).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw(),this.triggerEventHandlers(["update"],[]),n&&(n(),h.focus()),o=this.dependentBoards.length,e=0;e<o;e++)s=this.dependentBoards[e],a.Z.exists(s)&&s!==this&&(s.updateQuality=this.updateQuality,s.prepareUpdate().updateElements().updateConditions(),s.renderer.suspendRedraw(),s.updateRenderer(),s.renderer.unsuspendRedraw(),s.triggerEventHandlers(["update"],[]));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var t;for(t=0;t<this.grids.length;t++)this.removeObject(this.grids[t]);return this.grids.length=0,this.update(),this},create:function(t,e,o){var s,n;for(t=t.toLowerCase(),a.Z.exists(e)||(e=[]),a.Z.exists(o)||(o={}),n=0;n<e.length;n++)!a.Z.isString(e[n])||t==="text"&&n===2||t==="solidofrevolution3d"&&n===2||!(t!=="input"&&t!=="checkbox"&&t!=="button"||n!==2&&n!==3)||t==="curve"&&n>0||(e[n]=this.select(e[n]));if(!a.Z.isFunction(u.Z.elements[t]))throw new Error("JSXGraph: create: Unknown element type given: "+t);return s=u.Z.elements[t](this,e,o),a.Z.exists(s)?(s.prepareUpdate&&s.update&&s.updateRenderer&&s.fullUpdate(),s):(u.Z.debug("JSXGraph: create: failure creating "+t),s)},createElement:function(){return u.Z.deprecated("Board.createElement()","Board.create()"),this.create.apply(this,arguments)},clearTraces:function(){var t;for(t=0;t<this.objectsList.length;t++)this.objectsList[t].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.inUpdate||(this.isSuspendedUpdate=!0),this},unsuspendUpdate:function(){return this.isSuspendedUpdate&&(this.isSuspendedUpdate=!1,this.fullUpdate()),this},setBoundingBox:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O=0,x=0,D=1,k=N.Z.getDimensions(this.container,this.document);return a.Z.isArray(t)?(t[0]<this.maxboundingbox[0]||t[1]>this.maxboundingbox[1]||t[2]>this.maxboundingbox[2]||t[3]<this.maxboundingbox[3]||(a.Z.exists(o)||(o="reset"),h=this.unitX,l=this.unitY,this.canvasWidth=parseFloat(k.width),this.canvasHeight=parseFloat(k.height),n=this.canvasWidth,s=this.canvasHeight,e?(p=h/l,o==="keep"&&(D=this.zoomX/this.zoomY),Z=h*(d=t[2]-t[0]),y=l*(b=t[1]-t[3]),n>=s?Z>=y?(this.unitY=s/b,this.unitX=this.unitY*p):(this.unitY=s/Math.abs(d)*B.Z.sign(b)/D,this.unitX=this.unitY*p):y>Z?(this.unitX=n/d,this.unitY=this.unitX/p):(this.unitX=n/Math.abs(b)*B.Z.sign(d)*D,this.unitY=this.unitX/p),O=.5*(n/this.unitX-d),x=.5*(s/this.unitY-b),this.keepaspectratio=!0):(this.unitX=n/(t[2]-t[0]),this.unitY=s/(t[1]-t[3]),this.keepaspectratio=!1),this.moveOrigin(-this.unitX*(t[0]-O),this.unitY*(t[1]+x)),o==="update"?(this.zoomX*=this.unitX/h,this.zoomY*=this.unitY/l):o==="reset"&&(this.zoomX=a.Z.exists(this.attr.zoomx)?this.attr.zoomx:1,this.zoomY=a.Z.exists(this.attr.zoomy)?this.attr.zoomy:1)),this):this},getBoundingBox:function(){var t=new m.Z(S.Z.COORDS_BY_SCREEN,[0,0],this).usrCoords,e=new m.Z(S.Z.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this).usrCoords;return[t[1],t[2],e[1],e[2]]},addAnimation:function(t){var e=this;return this.animationObjects[t.id]=t,this.animationIntervalCode||(this.animationIntervalCode=window.setInterval(function(){e.animate()},t.board.attr.animationdelay)),this},stopAllAnimation:function(){var t;for(t in this.animationObjects)this.animationObjects.hasOwnProperty(t)&&a.Z.exists(this.animationObjects[t])&&(this.animationObjects[t]=null,delete this.animationObjects[t]);return window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var t,e,o,s,n,h,l,p,d=0,b=null;for(e in this.animationObjects)if(this.animationObjects.hasOwnProperty(e)&&a.Z.exists(this.animationObjects[e])){if(d+=1,(o=this.animationObjects[e]).animationPath&&(s=a.Z.isFunction(o.animationPath)?o.animationPath(new Date().getTime()-o.animationStart):o.animationPath.pop(),!a.Z.exists(s)||!a.Z.isArray(s)&&isNaN(s)?delete o.animationPath:(o.setPositionDirectly(S.Z.COORDS_BY_USER,s),o.fullUpdate(),b=o)),o.animationData){for(n in l=0,o.animationData)o.animationData.hasOwnProperty(n)&&(h=o.animationData[n].pop(),a.Z.exists(h)?(l+=1,(t={})[n]=h,o.setAttribute(t)):delete o.animationData[h]);l===0&&delete o.animationData}a.Z.exists(o.animationData)||a.Z.exists(o.animationPath)||(this.animationObjects[e]=null,delete this.animationObjects[e],a.Z.exists(o.animationCallback)&&(p=o.animationCallback,o.animationCallback=null,p()))}return d===0?(window.clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(b),this},migratePoint:function(t,e,o){var s,n,h,l,p,d,b=!1;for(n in t=this.select(t),e=this.select(e),a.Z.exists(t.label)&&(d=t.label.id,b=!0,this.removeObject(t.label)),t.childElements)if(t.childElements.hasOwnProperty(n)){for(h in l=!1,s=t.childElements[n])s.hasOwnProperty(h)&&s[h]===t&&(s[h]=e,l=!0);for(l&&delete t.childElements[n],p=0;p<s.parents.length;p++)s.parents[p]===t.id&&(s.parents[p]=e.id);e.addChild(s)}return o&&(b&&(delete e.childElements[d],delete e.descendants[d]),e.label&&this.removeObject(e.label),delete this.elementsByName[e.name],e.name=t.name,b&&e.createLabel()),this.removeObject(t),a.Z.exists(e.name)&&e.name!==""&&(this.elementsByName[e.name]=e),this.fullUpdate(),this},emulateColorblindness:function(t){var e,o;if(a.Z.exists(t)||(t="none"),this.currentCBDef===t)return this;for(e in this.objects)this.objects.hasOwnProperty(e)&&(o=this.objects[e],t!=="none"?(this.currentCBDef==="none"&&(o.visPropOriginal={strokecolor:o.visProp.strokecolor,fillcolor:o.visProp.fillcolor,highlightstrokecolor:o.visProp.highlightstrokecolor,highlightfillcolor:o.visProp.highlightfillcolor}),o.setAttribute({strokecolor:_t.Z.rgb2cb(a.Z.evaluate(o.visPropOriginal.strokecolor),t),fillcolor:_t.Z.rgb2cb(a.Z.evaluate(o.visPropOriginal.fillcolor),t),highlightstrokecolor:_t.Z.rgb2cb(a.Z.evaluate(o.visPropOriginal.highlightstrokecolor),t),highlightfillcolor:_t.Z.rgb2cb(a.Z.evaluate(o.visPropOriginal.highlightfillcolor),t)})):a.Z.exists(o.visPropOriginal)&&u.Z.extend(o.visProp,o.visPropOriginal));return this.currentCBDef=t,this.update(),this},select:function(t,e){var o,s,n,h,l=t;if(l===null)return l;if(a.Z.isString(l)&&l!=="")a.Z.exists(this.objects[l])?l=this.objects[l]:a.Z.exists(this.elementsByName[l])?l=this.elementsByName[l]:a.Z.exists(this.groups[l])&&(l=this.groups[l]);else if(!e&&(a.Z.isFunction(l)||a.Z.isObject(l)&&!a.Z.isFunction(l.setAttribute))){for(s={},h=(o=a.Z.filterElements(this.objectsList,l)).length,n=0;n<h;n++)s[o[n].id]=o[n];l=new Dt(s)}else a.Z.isObject(l)&&a.Z.exists(l.id)&&!a.Z.exists(this.objects[l.id])&&(l=null);return l},hasPoint:function(t,e){var o=t,s=e,n=this.getBoundingBox();return a.Z.exists(t)&&a.Z.isArray(t.usrCoords)&&(o=t.usrCoords[1],s=t.usrCoords[2]),!!(a.Z.isNumber(o)&&a.Z.isNumber(s)&&n[0]<o&&o<n[2]&&n[1]>s&&s>n[3])},updateCSSTransforms:function(){var t=this.containerObj,e=t,o=t;if(this.cssTransMat=N.Z.getCSSTransformMatrix(e),a.Z.exists(e.getRootNode)){for(e=e.parentNode===e.getRootNode()?e.parentNode.host:e.parentNode;e;)this.cssTransMat=B.Z.matMatMult(N.Z.getCSSTransformMatrix(e),this.cssTransMat),e=e.parentNode===e.getRootNode()?e.parentNode.host:e.parentNode;this.cssTransMat=B.Z.inverse(this.cssTransMat)}else{for(e=e.offsetParent;e;){for(this.cssTransMat=B.Z.matMatMult(N.Z.getCSSTransformMatrix(e),this.cssTransMat),o=o.parentNode;o!==e;)this.cssTransMat=B.Z.matMatMult(N.Z.getCSSTransformMatrix(e),this.cssTransMat),o=o.parentNode;e=e.offsetParent}this.cssTransMat=B.Z.inverse(this.cssTransMat)}return this},startSelectionMode:function(){this.selectingMode=!0,this.selectionPolygon.setAttribute({visible:!0}),this.selectingBox=[[0,0],[0,0]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate()},stopSelectionMode:function(){return this.selectingMode=!1,this.selectionPolygon.setAttribute({visible:!1}),[this.selectionPolygon.vertices[0].coords,this.selectionPolygon.vertices[2].coords]},_startSelecting:function(t){this.isSelecting=!0,this.selectingBox=[[t[0],t[1]],[t[0],t[1]]],this._setSelectionPolygonFromBox()},_moveSelecting:function(t){this.isSelecting&&(this.selectingBox[1]=[t[0],t[1]],this._setSelectionPolygonFromBox(),this.selectionPolygon.fullUpdate())},_stopSelecting:function(t){var e=this.getMousePosition(t);this.isSelecting=!1,this.selectingBox[1]=[e[0],e[1]],this._setSelectionPolygonFromBox()},_setSelectionPolygonFromBox:function(){var t=this.selectingBox[0],e=this.selectingBox[1];this.selectionPolygon.vertices[0].setPositionDirectly(u.Z.COORDS_BY_SCREEN,[t[0],t[1]]),this.selectionPolygon.vertices[1].setPositionDirectly(u.Z.COORDS_BY_SCREEN,[t[0],e[1]]),this.selectionPolygon.vertices[2].setPositionDirectly(u.Z.COORDS_BY_SCREEN,[e[0],e[1]]),this.selectionPolygon.vertices[3].setPositionDirectly(u.Z.COORDS_BY_SCREEN,[e[0],t[1]])},_testForSelection:function(t){this._isRequiredKeyPressed(t,"selection")&&(a.Z.exists(this.selectionPolygon)||this._createSelectionPolygon(this.attr),this.startSelectionMode())},_createSelectionPolygon:function(t){var e;return a.Z.exists(this.selectionPolygon)||(e=a.Z.copyAttributes(t,it.Z,"board","selection")).enabled===!0&&(this.selectionPolygon=this.create("polygon",[[0,0],[0,0],[0,0],[0,0]],e)),this},__evt__down:function(t){},__evt__mousedown:function(t){},__evt__pendown:function(t){},__evt__pointerdown:function(t){},__evt__touchstart:function(t){},__evt__up:function(t){},__evt__mouseup:function(t){},__evt__pointerup:function(t){},__evt__touchend:function(t){},__evt__move:function(t,e){},__evt__mousemove:function(t,e){},__evt__penmove:function(t,e){},__evt__pointermove:function(t,e){},__evt__touchmove:function(t,e){},__evt__keymove:function(t,e){},__evt__hit:function(t,e,o){},__evt__mousehit:function(t,e,o){},__evt__update:function(){},__evt__boundingbox:function(){},__evt__startselecting:function(){},__evt__mousestartselecting:function(){},__evt__pointerstartselecting:function(){},__evt__touchstartselecting:function(){},__evt__stopselecting:function(){},__evt__mousestopselecting:function(){},__evt__pointerstopselecting:function(){},__evt__touchstopselecting:function(){},__evt__moveselecting:function(){},__evt__mousemoveselecting:function(){},__evt__pointermoveselecting:function(){},__evt__touchmoveselecting:function(){},__evt:function(){},toFullscreen:function(t){var e,o,s,n=this.document;return t=t||this.container,this._fullscreen_inner_id=t,s=n.getElementById(t),e="fullscreenwrap_"+t,n.getElementById(e)?o=n.getElementById(e):((o=document.createElement("div")).classList.add("JXG_wrap_private"),o.setAttribute("id",e),s.parentNode.insertBefore(o,s),o.appendChild(s)),o.requestFullscreen=o.requestFullscreen||o.webkitRequestFullscreen||o.mozRequestFullScreen||o.msRequestFullscreen,(n.fullscreenElement!==void 0?n.fullscreenElement:n.webkitFullscreenElement!==void 0?n.webkitFullscreenElement:n.msFullscreenElement)===null?o.requestFullscreen&&o.requestFullscreen():a.Z.exists(document.exitFullscreen)?document.exitFullscreen():a.Z.exists(document.webkitExitFullscreen)&&document.webkitExitFullscreen(),this},fullscreenListener:function(t){var e,o,s,n=this.document;if(e=this._fullscreen_inner_id,a.Z.exists(e)){if(s=n.fullscreenElement!==void 0?n.fullscreenElement:n.webkitFullscreenElement!==void 0?n.webkitFullscreenElement:n.msFullscreenElement,o=n.getElementById(e),s)o._cssFullscreenStore={id:s.id,isFullscreen:!0,margin:o.style.margin},o.style.margin="",N.Z.scaleJSXGraphDiv(s.id,e,n,a.Z.evaluate(this.attr.fullscreen.scale)),s=null;else if(a.Z.exists(o._cssFullscreenStore)){try{n.styleSheets[n.styleSheets.length-1].deleteRule(0)}catch{console.log("JSXGraph: Could not remove CSS rules for full screen mode")}o._cssFullscreenStore.isFullscreen=!1,o.style.margin=o._cssFullscreenStore.margin}this.updateCSSTransforms()}},addLogEntry:function(t,e,o){var s,n,h=this.userLog.length-1;return a.Z.exists(e.elementClass)&&(n=e.id),a.Z.evaluate(this.attr.logging.enabled)&&(s=new Date().getTime(),h>=0&&this.userLog[h].type===t&&this.userLog[h].id===n&&s-this.userLog[h].end<500?(this.userLog[h].end=s,this.userLog[h].endpos=o):this.userLog.push({type:t,id:n,start:s,startpos:o,end:s,endpos:o,bbox:this.getBoundingBox(),canvas:[this.canvasWidth,this.canvasHeight],zoom:[this.zoomX,this.zoomY]})),this},createRoulette:function(t,e,o,s,n,h,l){var p=this;return new function(){var d,b=0,Z=0,y=0,O=o,x=c.Z.root(function(et){var lt=t.X(O),ot=t.Y(O),gt=e.X(et),vt=e.Y(et);return(lt-gt)*(lt-gt)+(ot-vt)*(ot-vt)},[0,2*Math.PI]),D=0,k=0,I=p.create("transform",[function(){return b}],{type:"rotate"}),U=p.create("transform",[function(){return b},function(){return t.X(O)},function(){return t.Y(O)}],{type:"rotate"}),J=p.create("transform",[function(){return Z},function(){return y}],{type:"translate"}),z=function(et,lt,ot){var gt=c.Z.D(et.X)(lt),vt=c.Z.D(et.Y)(lt),Tt=c.Z.D(et.X)(ot),Rt=c.Z.D(et.Y)(ot),kt=c.Z.D(et.X)(.5*(lt+ot)),Ft=c.Z.D(et.Y)(.5*(lt+ot)),te=Math.sqrt(gt*gt+vt*vt),qt=Math.sqrt(Tt*Tt+Rt*Rt);return(te+4*Math.sqrt(kt*kt+Ft*Ft)+qt)*(ot-lt)/6},V=function(et){return d-z(e,x,et)},W=Math.PI/18,$=9*W,nt=null;return this.rolling=function(){var et,lt,ot,gt,vt;d=z(t,O,D=O+n*s),k=c.Z.root(V,x),et=new Q(t.X(D),t.Y(D)),lt=new Q(e.X(k),e.Y(k)),ot=new Q(c.Z.D(t.X)(D),c.Z.D(t.Y)(D)),gt=new Q(c.Z.D(e.X)(k),c.Z.D(e.Y)(k)),vt=Q.C.div(ot,gt),b=Math.atan2(vt.imaginary,vt.real),vt.div(Q.C.abs(vt)),vt.mult(lt),Z=et.real-vt.real,y=et.imaginary-vt.imaginary,b<-W&&b>-$?(b=-W,U.applyOnce(l)):b>W&&b<$?(b=W,U.applyOnce(l)):(I.applyOnce(l),J.applyOnce(l),O=D,x=k),p.update()},this.start=function(){return h>0&&(nt=window.setInterval(this.rolling,h)),this},this.stop=function(){return window.clearInterval(nt),this},this}}});const Bt=u.Z.Board;u.Z.SVGRenderer=function(t,e){var o;for(this.type="svg",this.isIE=navigator.appVersion.indexOf("MSIE")!==-1||navigator.userAgent.match(/Trident\//),this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.display="block",this.resize(e.width,e.height),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.createShadowFilter=function(s,n,h,l,p,d){var b,Z,y,O,x,D=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter");return D.setAttributeNS(null,"id",s),D.setAttributeNS(null,"width","300%"),D.setAttributeNS(null,"height","300%"),D.setAttributeNS(null,"filterUnits","userSpaceOnUse"),(b=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset")).setAttributeNS(null,"in","SourceGraphic"),b.setAttributeNS(null,"result","offOut"),b.setAttributeNS(null,"dx",d[0]),b.setAttributeNS(null,"dy",d[1]),D.appendChild(b),(Z=this.container.ownerDocument.createElementNS(this.svgNamespace,"feColorMatrix")).setAttributeNS(null,"in","offOut"),Z.setAttributeNS(null,"result","colorOut"),Z.setAttributeNS(null,"type","matrix"),n==="none"||!a.Z.isArray(n)||n.length<3?Z.setAttributeNS(null,"values","0.1 0 0 0 0  0 0.1 0 0 0  0 0 0.1 0 0  0 0 0 "+h+" 0"):(n[0]/=255,n[1]/=255,n[2]/=255,x=l+" 0 0 0 "+n[0]+"  0 "+l+" 0 0 "+n[1]+"  0 0 "+l+" 0 "+n[2]+"  0 0 0 "+h+" 0",Z.setAttributeNS(null,"values",x)),D.appendChild(Z),(y=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur")).setAttributeNS(null,"in","colorOut"),y.setAttributeNS(null,"result","blurOut"),y.setAttributeNS(null,"stdDeviation",p),D.appendChild(y),(O=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend")).setAttributeNS(null,"in","SourceGraphic"),O.setAttributeNS(null,"in2","blurOut"),O.setAttributeNS(null,"mode","normal"),D.appendChild(O),D},this.defs.appendChild(this.createShadowFilter(this.container.id+"_f1","none",1,.1,3,[5,5])),this.toURL=function(){var s=Array.prototype.slice.call(arguments).join("");return a.Z.exists(CSS)&&a.Z.exists(CSS.escape)&&(s=CSS.escape(s)),"url(#"+s+")"},this.layer=[],o=0;o<it.Z.layer.numlayers;o++)this.layer[o]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[o]);try{this.foreignObjLayer=this.container.ownerDocument.createElementNS(this.svgNamespace,"foreignObject"),this.foreignObjLayer.setAttribute("display","none"),this.foreignObjLayer.setAttribute("x",0),this.foreignObjLayer.setAttribute("y",0),this.foreignObjLayer.setAttribute("width","100%"),this.foreignObjLayer.setAttribute("height","100%"),this.foreignObjLayer.setAttribute("id",this.container.id+"_foreignObj"),this.svgRoot.appendChild(this.foreignObjLayer),this.supportsForeignObject=!0}catch{this.supportsForeignObject=!1}this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},u.Z.SVGRenderer.prototype=new rt,u.Z.extend(u.Z.SVGRenderer.prototype,{_createArrowHead:function(t,e,o){var s,n,h,l,p=t.id+"Triangle";return a.Z.exists(e)&&(p+=e),(s=this.createPrim("marker",p)).setAttributeNS(null,"stroke",a.Z.evaluate(t.visProp.strokecolor)),s.setAttributeNS(null,"stroke-opacity",a.Z.evaluate(t.visProp.strokeopacity)),s.setAttributeNS(null,"fill",a.Z.evaluate(t.visProp.strokecolor)),s.setAttributeNS(null,"fill-opacity",a.Z.evaluate(t.visProp.strokeopacity)),s.setAttributeNS(null,"stroke-width",0),s.setAttributeNS(null,"orient","auto"),s.setAttributeNS(null,"markerUnits","strokeWidth"),n=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),l=5,e==="End"?(h=0,o===2?n.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 L 5,5 z"):o===3?n.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z"):o===4?(l=3.31,n.setAttributeNS(null,"d","M 0.00,3.31 C 3.53,3.84 7.13,4.50 10.00,6.63 C 9.33,5.52 8.67,4.42 8.00,3.31 C 8.67,2.21 9.33,1.10 10.00,0.00 C 7.13,2.13 3.53,2.79 0.00,3.31")):o===5?(l=3.28,n.setAttributeNS(null,"d","M 0.00,3.28 C 3.39,4.19 6.81,5.07 10.00,6.55 C 9.38,5.56 9.00,4.44 9.00,3.28 C 9.00,2.11 9.38,0.99 10.00,0.00 C 6.81,1.49 3.39,2.37 0.00,3.28")):o===6?(l=2.84,n.setAttributeNS(null,"d","M 0.00,2.84 C 3.39,3.59 6.79,4.35 10.00,5.68 C 9.67,4.73 9.33,3.78 9.00,2.84 C 9.33,1.89 9.67,0.95 10.00,0.00 C 6.79,1.33 3.39,2.09 0.00,2.84")):o===7?(l=5.2,n.setAttributeNS(null,"d","M 0.00,5.20 C 4.04,5.20 7.99,6.92 10.00,10.39 M 10.00,0.00 C 7.99,3.47 4.04,5.20 0.00,5.20")):n.setAttributeNS(null,"d","M 10,0 L 0,5 L 10,10 z"),t.elementClass===S.Z.OBJECT_CLASS_LINE&&(h=o===2?4.9:o===3?3.3:o===4||o===5||o===6?6.66:o===7?0:10)):(h=10,o===2?n.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 L 5,5 z"):o===3?(h=3.3,n.setAttributeNS(null,"d","M 0,0 L 3.33,0 L 3.33,10 L 0,10 z")):o===4?(l=3.31,n.setAttributeNS(null,"d","M 10.00,3.31 C 6.47,3.84 2.87,4.50 0.00,6.63 C 0.67,5.52 1.33,4.42 2.00,3.31 C 1.33,2.21 0.67,1.10 0.00,0.00 C 2.87,2.13 6.47,2.79 10.00,3.31")):o===5?(l=3.28,n.setAttributeNS(null,"d","M 10.00,3.28 C 6.61,4.19 3.19,5.07 0.00,6.55 C 0.62,5.56 1.00,4.44 1.00,3.28 C 1.00,2.11 0.62,0.99 0.00,0.00 C 3.19,1.49 6.61,2.37 10.00,3.28")):o===6?(l=2.84,n.setAttributeNS(null,"d","M 10.00,2.84 C 6.61,3.59 3.21,4.35 0.00,5.68 C 0.33,4.73 0.67,3.78 1.00,2.84 C 0.67,1.89 0.33,0.95 0.00,0.00 C 3.21,1.33 6.61,2.09 10.00,2.84")):o===7?(l=5.2,n.setAttributeNS(null,"d","M 10.00,5.20 C 5.96,5.20 2.01,6.92 0.00,10.39 M 0.00,0.00 C 2.01,3.47 5.96,5.20 10.00,5.20")):n.setAttributeNS(null,"d","M 0,0 L 10,5 L 0,10 z"),t.elementClass===S.Z.OBJECT_CLASS_LINE&&(h=o===2?5.1:o===3?.02:o===4||o===5||o===6?3.33:o===7?10:.05)),o===7&&(s.setAttributeNS(null,"fill","none"),s.setAttributeNS(null,"stroke-width",1)),s.setAttributeNS(null,"refY",l),s.setAttributeNS(null,"refX",h),s.appendChild(n),s},_setArrowColor:function(t,e,o,s,n){t&&(a.Z.isString(e)&&(n!==7?this._setAttribute(function(){t.setAttributeNS(null,"stroke",e),t.setAttributeNS(null,"fill",e),t.setAttributeNS(null,"stroke-opacity",o),t.setAttributeNS(null,"fill-opacity",o)},s.visPropOld.fillcolor):this._setAttribute(function(){t.setAttributeNS(null,"fill","none"),t.setAttributeNS(null,"stroke",e),t.setAttributeNS(null,"stroke-opacity",o)},s.visPropOld.fillcolor)),this.isIE&&s.rendNode.parentNode.insertBefore(s.rendNode,s.rendNode))},_setArrowWidth:function(t,e,o,s){var n,h;t&&(h=(n=e)*s,t.setAttributeNS(null,"viewBox","0 0 "+10*n+" "+10*n),t.setAttributeNS(null,"markerHeight",h),t.setAttributeNS(null,"markerWidth",h),t.setAttributeNS(null,"display","inherit"),this.isIE&&o.parentNode.insertBefore(o,o))},updateTicks:function(t){var e,o,s,n,h,l,p,d,b="",Z=t.ticks.length,y=!0;for(e=0;e<Z;e++){for(h=(s=t.ticks[e])[0],l=s[1],p=h.length,d=" M "+h[0]+" "+l[0],a.Z.isNumber(h[0])||(y=!1),o=1;y&&o<p;++o)a.Z.isNumber(h[o])?d+=" L "+h[o]+" "+l[o]:y=!1;y&&(b+=d)}n=t.rendNode,a.Z.exists(n)||(n=this.createPrim("path",t.id),this.appendChildPrim(n,a.Z.evaluate(t.visProp.layer)),t.rendNode=n),n.setAttributeNS(null,"stroke",a.Z.evaluate(t.visProp.strokecolor)),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"stroke-opacity",a.Z.evaluate(t.visProp.strokeopacity)),n.setAttributeNS(null,"stroke-width",a.Z.evaluate(t.visProp.strokewidth)),this.updatePathPrim(n,b,t.board)},displayCopyright:function(t,e){var o,s=this.createPrim("text","licenseText");s.setAttributeNS(null,"x","20px"),s.setAttributeNS(null,"y",2+e+"px"),s.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+e+"px; fill:#356AA0;  opacity:0.3;"),o=this.container.ownerDocument.createTextNode(t),s.appendChild(o),this.appendChildPrim(s,0)},drawInternalText:function(t){var e=this.createPrim("text",t.id);return e.style.whiteSpace="nowrap",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,a.Z.evaluate(t.visProp.layer)),e},updateInternalText:function(t){var e,o=t.plaintext,s=t.getAnchorX(),n=t.getAnchorY();t.rendNode.getAttributeNS(null,"class")!==t.visProp.cssclass&&(t.rendNode.setAttributeNS(null,"class",a.Z.evaluate(t.visProp.cssclass)),t.needsSizeUpdate=!0),isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])||(e=t.coords.scrCoords[1],t.visPropOld.left!==s+e&&(t.rendNode.setAttributeNS(null,"x",e+"px"),s==="left"?t.rendNode.setAttributeNS(null,"text-anchor","start"):s==="right"?t.rendNode.setAttributeNS(null,"text-anchor","end"):s==="middle"&&t.rendNode.setAttributeNS(null,"text-anchor","middle"),t.visPropOld.left=s+e),e=t.coords.scrCoords[2],t.visPropOld.top!==n+e&&(t.rendNode.setAttributeNS(null,"y",e+.5*this.vOffsetText+"px"),n==="bottom"?t.rendNode.setAttributeNS(null,"dominant-baseline","text-after-edge"):n==="top"?t.rendNode.setAttributeNS(null,"dy","1.6ex"):n==="middle"&&t.rendNode.setAttributeNS(null,"dy","0.6ex"),t.visPropOld.top=n+e)),t.htmlStr!==o&&(t.rendNodeText.data=o,t.htmlStr=o),this.transformImage(t,t.transformations)},updateInternalTextStyle:function(t,e,o,s){this.setObjectFillColor(t,e,o)},drawImage:function(t){var e=this.createPrim("image",t.id);e.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(e,a.Z.evaluate(t.visProp.layer)),t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var o,s=t.rendNode,n="";e.length>0&&(n+=" matrix("+[(o=this.joinTransforms(t,e))[1][1],o[2][1],o[1][2],o[2][2],o[1][0],o[2][0]].join(",")+") ",s.setAttributeNS(null,"transform",n))},updateImageURL:function(t){var e=a.Z.evaluate(t.url);return t._src!==e&&(t.imgIsLoaded=!1,t.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",e),t._src=e,!0)},updateImageStyle:function(t,e){var o=a.Z.evaluate(e?t.visProp.highlightcssclass:t.visProp.cssclass);t.rendNode.setAttributeNS(null,"class",o)},drawForeignObject:function(t){t.rendNode=this.appendChildPrim(this.createPrim("foreignObject",t.id),a.Z.evaluate(t.visProp.layer)),this.appendNodesToElement(t,"foreignObject"),this.updateForeignObject(t)},updateForeignObject:function(t){t._useUserSize?t.rendNode.style.overflow="hidden":t.rendNode.style.overflow="visible",this.updateRectPrim(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),t.rendNode.innerHTML=t.content,this._updateVisual(t,{stroke:!0,dash:!0},!0)},appendChildPrim:function(t,e){return a.Z.exists(e)?e>=it.Z.layer.numlayers&&(e=it.Z.layer.numlayers-1):e=0,this.layer[e].appendChild(t),t},createPrim:function(t,e){var o=this.container.ownerDocument.createElementNS(this.svgNamespace,t);return o.setAttributeNS(null,"id",this.container.id+"_"+e),o.style.position="absolute",t==="path"&&(o.setAttributeNS(null,"stroke-linecap","round"),o.setAttributeNS(null,"stroke-linejoin","round"),o.setAttributeNS(null,"fill-rule","evenodd")),o},remove:function(t){a.Z.exists(t)&&a.Z.exists(t.parentNode)&&t.parentNode.removeChild(t)},setLayer:function(t,e){a.Z.exists(e)?e>=it.Z.layer.numlayers&&(e=it.Z.layer.numlayers-1):e=0,this.layer[e].appendChild(t.rendNode)},makeArrows:function(t,e){var o,s=e.evFirst,n=e.evLast;t.visPropOld.firstarrow!==s||t.visPropOld.lastarrow!==n?(s?(o=t.rendNodeTriangleStart,a.Z.exists(o)?this.defs.appendChild(o):(o=this._createArrowHead(t,"End",e.typeFirst),this.defs.appendChild(o),t.rendNodeTriangleStart=o,t.rendNode.setAttributeNS(null,"marker-start",this.toURL(this.container.id,"_",t.id,"TriangleEnd")))):(o=t.rendNodeTriangleStart,a.Z.exists(o)&&this.remove(o)),n?(o=t.rendNodeTriangleEnd,a.Z.exists(o)?this.defs.appendChild(o):(o=this._createArrowHead(t,"Start",e.typeLast),this.defs.appendChild(o),t.rendNodeTriangleEnd=o,t.rendNode.setAttributeNS(null,"marker-end",this.toURL(this.container.id,"_",t.id,"TriangleStart")))):(o=t.rendNodeTriangleEnd,a.Z.exists(o)&&this.remove(o)),t.visPropOld.firstarrow=s,t.visPropOld.lastarrow=n):this.isIE&&t.visPropCalc.visible&&(s||n)&&t.rendNode.parentNode.insertBefore(t.rendNode,t.rendNode)},updateEllipsePrim:function(t,e,o,s,n){var h;h=2e5,e=Math.abs(e)<h?e:h*e/Math.abs(e),o=Math.abs(o)<h?o:h*o/Math.abs(o),s=Math.abs(s)<h?s:h*s/Math.abs(s),n=Math.abs(n)<h?n:h*n/Math.abs(n),t.setAttributeNS(null,"cx",e),t.setAttributeNS(null,"cy",o),t.setAttributeNS(null,"rx",Math.abs(s)),t.setAttributeNS(null,"ry",Math.abs(n))},updateLinePrim:function(t,e,o,s,n){var h;h=2e5,isNaN(e+o+s+n)||(e=Math.abs(e)<h?e:h*e/Math.abs(e),o=Math.abs(o)<h?o:h*o/Math.abs(o),s=Math.abs(s)<h?s:h*s/Math.abs(s),n=Math.abs(n)<h?n:h*n/Math.abs(n),t.setAttributeNS(null,"x1",e),t.setAttributeNS(null,"y1",o),t.setAttributeNS(null,"x2",s),t.setAttributeNS(null,"y2",n))},updatePathPrim:function(t,e){e===""&&(e="M 0 0"),t.setAttributeNS(null,"d",e)},updatePathStringPoint:function(t,e,o){var s="",n=t.coords.scrCoords,h=e*Math.sqrt(3)*.5,l=.5*e;return o==="x"?s=" M "+(n[1]-e)+" "+(n[2]-e)+" L "+(n[1]+e)+" "+(n[2]+e)+" M "+(n[1]+e)+" "+(n[2]-e)+" L "+(n[1]-e)+" "+(n[2]+e):o==="+"?s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+e)+" "+n[2]+" M "+n[1]+" "+(n[2]-e)+" L "+n[1]+" "+(n[2]+e):o==="|"?s=" M "+n[1]+" "+(n[2]-e)+" L "+n[1]+" "+(n[2]+e):o==="-"?s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+e)+" "+n[2]:o==="<>"?s=" M "+(n[1]-e)+" "+n[2]+" L "+n[1]+" "+(n[2]+e)+" L "+(n[1]+e)+" "+n[2]+" L "+n[1]+" "+(n[2]-e)+" Z ":o==="^"?s=" M "+n[1]+" "+(n[2]-e)+" L "+(n[1]-h)+" "+(n[2]+l)+" L "+(n[1]+h)+" "+(n[2]+l)+" Z ":o==="v"?s=" M "+n[1]+" "+(n[2]+e)+" L "+(n[1]-h)+" "+(n[2]-l)+" L "+(n[1]+h)+" "+(n[2]-l)+" Z ":o===">"?s=" M "+(n[1]+e)+" "+n[2]+" L "+(n[1]-l)+" "+(n[2]-h)+" L "+(n[1]-l)+" "+(n[2]+h)+" Z ":o==="<"&&(s=" M "+(n[1]-e)+" "+n[2]+" L "+(n[1]+l)+" "+(n[2]-h)+" L "+(n[1]+l)+" "+(n[2]+h)+" Z "),s},updatePathStringPrim:function(t){var e,o,s,n=" M ",h=n,l=5e3,p="";if(t.numberPoints<=0)return"";if(s=Math.min(t.points.length,t.numberPoints),t.bezierDegree===1)for(e=0;e<s;e++)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?h=n:(o[1]=Math.max(Math.min(o[1],l),-5e3),o[2]=Math.max(Math.min(o[2],l),-5e3),p+=h+o[1]+" "+o[2],h=" L ");else if(t.bezierDegree===3)for(e=0;e<s;)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?h=n:(p+=h+o[1]+" "+o[2],h===" C "&&(e+=1,p+=" "+(o=t.points[e].scrCoords)[1]+" "+o[2],e+=1,p+=" "+(o=t.points[e].scrCoords)[1]+" "+o[2]),h=" C "),e+=1;return p},updatePathStringBezierPrim:function(t){var e,o,s,n,h,l,p,d=" M ",b=d,Z=5e3,y="",O=a.Z.evaluate(t.visProp.strokewidth),x=a.Z.evaluate(t.visProp.curvetype)!=="plot";if(t.numberPoints<=0)return"";for(x&&t.board.options.curve.RDPsmoothing&&(t.points=c.Z.RamerDouglasPeucker(t.points,.5)),p=Math.min(t.points.length,t.numberPoints),o=1;o<3;o++)for(b=d,e=0;e<p;e++)n=t.points[e].scrCoords,isNaN(n[1])||isNaN(n[2])?b=d:(n[1]=Math.max(Math.min(n[1],Z),-5e3),n[2]=Math.max(Math.min(n[2],Z),-5e3),b===d?y+=b+n[1]+" "+n[2]:(s=2*o,y+=[b,h+.333*(n[1]-h)+O*(s*Math.random()-o)," ",l+.333*(n[2]-l)+O*(s*Math.random()-o)," ",h+.666*(n[1]-h)+O*(s*Math.random()-o)," ",l+.666*(n[2]-l)+O*(s*Math.random()-o)," ",n[1]," ",n[2]].join("")),b=" C ",h=n[1],l=n[2]);return y},updatePolygonPrim:function(t,e){var o,s,n="",h=e.vertices.length;for(t.setAttributeNS(null,"stroke","none"),t.setAttributeNS(null,"fill-rule","evenodd"),e.elType==="polygonalchain"&&h++,o=0;o<h-1;o++){if(!e.vertices[o].isReal)return void t.setAttributeNS(null,"points","");n=n+(s=e.vertices[o].coords.scrCoords)[1]+","+s[2],o<h-2&&(n+=" ")}n.indexOf("NaN")===-1&&t.setAttributeNS(null,"points",n)},updateRectPrim:function(t,e,o,s,n){t.setAttributeNS(null,"x",e),t.setAttributeNS(null,"y",o),t.setAttributeNS(null,"width",s),t.setAttributeNS(null,"height",n)},setPropertyPrim:function(t,e,o){e!=="stroked"&&t.setAttributeNS(null,e,o)},display:function(t,e){var o;t&&t.rendNode&&(t.visPropOld.visible=e,o=t.rendNode,e?(o.setAttributeNS(null,"display","inline"),o.style.visibility="inherit"):(o.setAttributeNS(null,"display","none"),o.style.visibility="hidden"))},show:function(t){u.Z.deprecated("Board.renderer.show()","Board.renderer.display()"),this.display(t,!0)},hide:function(t){u.Z.deprecated("Board.renderer.hide()","Board.renderer.display()"),this.display(t,!1)},setBuffering:function(t,e){t.rendNode.setAttribute("buffered-rendering",e)},setDashStyle:function(t){var e=a.Z.evaluate(t.visProp.dash),o=t.rendNode;e>0?o.setAttributeNS(null,"stroke-dasharray",this.dashArray[e-1]):o.hasAttributeNS(null,"stroke-dasharray")&&o.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(t){var e,o,s,n=t.rendNode,h=a.Z.evaluate(t.visProp.gradient);h==="linear"||h==="radial"?(e=this.createPrim(h+"Gradient",t.id+"_gradient"),o=this.createPrim("stop",t.id+"_gradient1"),s=this.createPrim("stop",t.id+"_gradient2"),e.appendChild(o),e.appendChild(s),this.defs.appendChild(e),n.setAttributeNS(null,"style","fill:"+this.toURL(this.container.id+"_"+t.id+"_gradient")),t.gradNode1=o,t.gradNode2=s,t.gradNode=e):n.removeAttributeNS(null,"style")},updateGradientAngle:function(t,e){var o=1,s=Math.cos(e),n=Math.sin(e);Math.abs(s)>Math.abs(n)?o/=Math.abs(s):o/=Math.abs(n),s>=0?(t.setAttributeNS(null,"x1",0),t.setAttributeNS(null,"x2",s*o)):(t.setAttributeNS(null,"x1",-s*o),t.setAttributeNS(null,"x2",0)),n>=0?(t.setAttributeNS(null,"y1",0),t.setAttributeNS(null,"y2",n*o)):(t.setAttributeNS(null,"y1",-n*o),t.setAttributeNS(null,"y2",0))},updateGradientCircle:function(t,e,o,s,n,h,l){t.setAttributeNS(null,"cx",100*e+"%"),t.setAttributeNS(null,"cy",100*o+"%"),t.setAttributeNS(null,"r",100*s+"%"),t.setAttributeNS(null,"fx",100*n+"%"),t.setAttributeNS(null,"fy",100*h+"%"),t.setAttributeNS(null,"fr",100*l+"%")},updateGradient:function(t){var e,o,s=t.gradNode1,n=t.gradNode2,h=a.Z.evaluate(t.visProp.gradient);a.Z.exists(s)&&a.Z.exists(n)&&(o=(o=a.Z.evaluate(t.visProp.fillopacity))>0?o:0,e=a.Z.evaluate(t.visProp.fillcolor),s.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+o),n.setAttributeNS(null,"style","stop-color:"+a.Z.evaluate(t.visProp.gradientsecondcolor)+";stop-opacity:"+a.Z.evaluate(t.visProp.gradientsecondopacity)),s.setAttributeNS(null,"offset",100*a.Z.evaluate(t.visProp.gradientstartoffset)+"%"),n.setAttributeNS(null,"offset",100*a.Z.evaluate(t.visProp.gradientendoffset)+"%"),h==="linear"?this.updateGradientAngle(t.gradNode,a.Z.evaluate(t.visProp.gradientangle)):h==="radial"&&this.updateGradientCircle(t.gradNode,a.Z.evaluate(t.visProp.gradientcx),a.Z.evaluate(t.visProp.gradientcy),a.Z.evaluate(t.visProp.gradientr),a.Z.evaluate(t.visProp.gradientfx),a.Z.evaluate(t.visProp.gradientfy),a.Z.evaluate(t.visProp.gradientfr)))},setObjectTransition:function(t,e){var o,s,n,h=[],l=0,p=["rendNode","rendNodeTriangleStart","rendNodeTriangleEnd"];if(e===void 0&&(e=a.Z.evaluate(t.visProp.transitionduration)),o=a.Z.evaluate(t.visProp.transitionproperties),e!==t.visPropOld.transitionduration||o!==t.visPropOld.transitionproperties){for(a.Z.exists(o)&&(l=o.length),n=0;n<l;n++)h.push(o[n]+" "+e+"ms");for(s=h.join(", "),l=p.length,n=0;n<l;++n)t[p[n]]&&(t[p[n]].style.transition=s);t.visPropOld.transitionduration=e,t.visPropOld.transitionproperties=o}},_setAttribute:function(t,e){e===""?t():window.setTimeout(t,1)},setObjectFillColor:function(t,e,o,s){var n,h,l,p,d=a.Z.evaluate(e),b=a.Z.evaluate(o),Z=a.Z.evaluate(t.visProp.gradient);b=b>0?b:0,t.visPropOld.fillcolor===d&&t.visPropOld.fillopacity===b&&Z===null||(a.Z.exists(d)&&d!==!1&&(d.length!==9?(h=d,p=b):(l=_t.Z.rgba2rgbo(d),h=l[0],p=b*l[1]),n=s===void 0?t.rendNode:s,h!=="none"&&this._setAttribute(function(){n.setAttributeNS(null,"fill",h)},t.visPropOld.fillcolor),t.type===u.Z.OBJECT_TYPE_IMAGE?this._setAttribute(function(){n.setAttributeNS(null,"opacity",p)},t.visPropOld.fillopacity):(h==="none"?(p=0,n.setAttributeNS(null,"pointer-events","visibleStroke")):n.setAttributeNS(null,"pointer-events","visiblePainted"),this._setAttribute(function(){n.setAttributeNS(null,"fill-opacity",p)},t.visPropOld.fillopacity)),Z!=="linear"&&Z!=="radial"||this.updateGradient(t)),t.visPropOld.fillcolor=d,t.visPropOld.fillopacity=b)},setObjectStrokeColor:function(t,e,o){var s,n,h,l,p=a.Z.evaluate(e),d=a.Z.evaluate(o);d=d>0?d:0,t.visPropOld.strokecolor===p&&t.visPropOld.strokeopacity===d||(a.Z.exists(p)&&p!==!1&&(p.length!==9?(s=p,h=d):(n=_t.Z.rgba2rgbo(p),s=n[0],h=d*n[1]),l=t.rendNode,t.elementClass===S.Z.OBJECT_CLASS_TEXT?a.Z.evaluate(t.visProp.display)==="html"?this._setAttribute(function(){l.style.color=s,l.style.opacity=h},t.visPropOld.strokecolor):this._setAttribute(function(){l.setAttributeNS(null,"style","fill:"+s),l.setAttributeNS(null,"style","fill-opacity:"+h)},t.visPropOld.strokecolor):this._setAttribute(function(){l.setAttributeNS(null,"stroke",s),l.setAttributeNS(null,"stroke-opacity",h)},t.visPropOld.strokecolor),t.elementClass!==S.Z.OBJECT_CLASS_CURVE&&t.elementClass!==S.Z.OBJECT_CLASS_LINE||(a.Z.evaluate(t.visProp.firstarrow)&&this._setArrowColor(t.rendNodeTriangleStart,s,h,t,t.visPropCalc.typeFirst),a.Z.evaluate(t.visProp.lastarrow)&&this._setArrowColor(t.rendNodeTriangleEnd,s,h,t,t.visPropCalc.typeLast))),t.visPropOld.strokecolor=p,t.visPropOld.strokeopacity=d)},setObjectStrokeWidth:function(t,e){var o,s=a.Z.evaluate(e);isNaN(s)||t.visPropOld.strokewidth===s||(o=t.rendNode,this.setPropertyPrim(o,"stroked","true"),a.Z.exists(s)&&this.setPropertyPrim(o,"stroke-width",s+"px"),t.visPropOld.strokewidth=s)},setLineCap:function(t){var e=a.Z.evaluate(t.visProp.linecap);e!==void 0&&e!==""&&t.visPropOld.linecap!==e&&a.Z.exists(t.rendNode)&&(this.setPropertyPrim(t.rendNode,"stroke-linecap",e),t.visPropOld.linecap=e)},setShadow:function(t){var e,o,s,n,h,l,p,d,b=a.Z.evaluate(t.visProp.shadow),Z=!0,y=!1;(e=JSON.stringify(b))!==t.visPropOld.shadow&&(typeof b=="boolean"?(Z=!0,y=b,o="none",s=3,n=.1,h=[5,5],l=1):a.Z.evaluate(b.enabled)?(Z=!1,y=!0,o=u.Z.rgbParser(a.Z.evaluate(b.color)),s=a.Z.evaluate(b.blur),n=a.Z.evaluate(b.blend),h=a.Z.evaluate(b.offset),l=a.Z.evaluate(b.opacity)):y=!1,a.Z.exists(t.rendNode)&&(y?Z?t.rendNode.setAttributeNS(null,"filter",this.toURL(this.container.id+"_f1")):((d=this.container.ownerDocument.getElementById(p))&&this.defs.removeChild(d),p=t.rendNode.id+"_f1",this.defs.appendChild(this.createShadowFilter(p,o,l,n,s,h)),t.rendNode.setAttributeNS(null,"filter",this.toURL(p))):t.rendNode.removeAttributeNS(null,"filter")),t.visPropOld.shadow=e)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(t,e){this.svgRoot.setAttribute("width",parseFloat(t)),this.svgRoot.setAttribute("height",parseFloat(e))},createTouchpoints:function(t){var e,o,s,n;for(this.touchpoints=[],e=0;e<t;e++)o="touchpoint1_"+e,n=this.createPrim("path",o),this.appendChildPrim(n,19),n.setAttributeNS(null,"d","M 0 0"),this.touchpoints.push(n),this.setPropertyPrim(n,"stroked","true"),this.setPropertyPrim(n,"stroke-width","1px"),n.setAttributeNS(null,"stroke","#000000"),n.setAttributeNS(null,"stroke-opacity",1),n.setAttributeNS(null,"display","none"),s="touchpoint2_"+e,n=this.createPrim("ellipse",s),this.appendChildPrim(n,19),this.updateEllipsePrim(n,0,0,0,0),this.touchpoints.push(n),this.setPropertyPrim(n,"stroked","true"),this.setPropertyPrim(n,"stroke-width","1px"),n.setAttributeNS(null,"stroke","#000000"),n.setAttributeNS(null,"stroke-opacity",1),n.setAttributeNS(null,"fill","#ffffff"),n.setAttributeNS(null,"fill-opacity",0),n.setAttributeNS(null,"display","none")},showTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","inline"),this.touchpoints[2*t+1].setAttributeNS(null,"display","inline"))},hideTouchpoint:function(t){this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(this.touchpoints[2*t].setAttributeNS(null,"display","none"),this.touchpoints[2*t+1].setAttributeNS(null,"display","none"))},updateTouchpoint:function(t,e){var o,s;this.touchpoints&&t>=0&&2*t<this.touchpoints.length&&(o=e[0],s=e[1],this.touchpoints[2*t].setAttributeNS(null,"d","M "+(o-37)+" "+s+" L "+(o+37)+" "+s+" M "+o+" "+(s-37)+" L "+o+" "+(s+37)),this.updateEllipsePrim(this.touchpoints[2*t+1],e[0],e[1],25,25))},_getValuesOfDOMElements:function(t){var e=[];if(t.nodeType===1)for(t=t.firstChild;t;)t.id!==void 0&&t.value!==void 0&&e.push([t.id,t.value]),e=e.concat(this._getValuesOfDOMElements(t)),t=t.nextSibling;return e},_getDataUri:function(t,e){var o=new Image;o.onload=function(){var s=document.createElement("canvas");s.width=this.naturalWidth,s.height=this.naturalHeight,s.getContext("2d").drawImage(this,0,0),e(s.toDataURL("image/png")),s.remove()},o.src=t},_getImgDataURL:function(t){var e,o,s,n,h,l;if((o=(e=t.getElementsByTagName("image")).length)>0)for(s=document.createElement("canvas"),l=0;l<o;l++){e[l].setAttribute("crossorigin","anonymous"),n=s.getContext("2d"),s.width=e[l].getAttribute("width"),s.height=e[l].getAttribute("height");try{n.drawImage(e[l],0,0,s.width,s.height),h=s.toDataURL(),e[l].setAttribute("xlink:href",h)}catch(p){console.log("CORS problem! Image can not be used",p)}}return!0},dumpToDataURI:function(t){var e,o,s,n=this.svgRoot,h=window.btoa||q.encode,l=[];if(this.container.hasChildNodes()&&a.Z.exists(this.foreignObjLayer))for(t||this.foreignObjLayer.setAttribute("display","inline");n.nextSibling;)l=l.concat(this._getValuesOfDOMElements(n.nextSibling)),this.foreignObjLayer.appendChild(n.nextSibling);if(this._getImgDataURL(n),n.setAttribute("xmlns","http://www.w3.org/2000/svg"),e=new XMLSerializer().serializeToString(n),t!==!0)for(s=l.length,o=0;o<s;o++)e=e.replace('id="'+l[o][0]+'"','id="'+l[o][0]+'" value="'+l[o][1]+'"');if((e.match(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g)||[]).length>1&&(e=e.replace(/xmlns="http:\/\/www.w3.org\/2000\/svg"/g,"")),e=e.replace(/&nbsp;/g," "),a.Z.exists(this.foreignObjLayer)&&this.foreignObjLayer.hasChildNodes()){for(;this.foreignObjLayer.firstChild;)this.container.appendChild(this.foreignObjLayer.firstChild);this.foreignObjLayer.setAttribute("display","none")}return"data:image/svg+xml;base64,"+h(unescape(encodeURIComponent(e)))},dumpToCanvas:function(t,e,o,s){var n,h,l,p;return(l=this.container.ownerDocument.getElementById(t)).width=l.width,p=l.getContext("2d"),e!==void 0&&o!==void 0&&(l.style.width=parseFloat(e)+"px",l.style.height=parseFloat(o)+"px",l.setAttribute("width",parseFloat(e)),l.setAttribute("height",parseFloat(o))),h=new Image,n=this.dumpToDataURI(s),h.src=n,"Promise"in window?new Promise(function(d,b){try{h.onload=function(){p.drawImage(h,0,0,e,o),d()}}catch(Z){b(Z)}}):(h.onload=function(){window.setTimeout(function(){try{p.drawImage(h,0,0,e,o)}catch{console.log("screenshots not longer supported on IE")}},200)},this)},screenshot:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D=this.container.ownerDocument,k=this.container.parentNode,I=t.attr.screenshot,U=!1;return this.type==="no"||(b=I.scale*this.container.getBoundingClientRect().width,Z=I.scale*this.container.getBoundingClientRect().height,e===void 0||e===""?(U=!0,(l=new Image).style.width=b+"px",l.style.height=Z+"px"):(U=!1,l=D.getElementById(e)),U&&((s=D.createElement("div")).style.cssText=I.css,s.style.width=b+"px",s.style.height=Z+"px",s.style.zIndex=this.container.style.zIndex+120,s.style.position="absolute",s.style.top=this.container.offsetTop+"px",s.style.left=this.container.offsetLeft+"px"),n=D.createElement("canvas"),h=Math.random().toString(36).substr(2,5),n.setAttribute("id",h),n.setAttribute("width",b),n.setAttribute("height",Z),n.style.width=b+"px",n.style.height=b+"px",n.style.display="none",k.appendChild(n),U&&(p=D.createElement("span"),d=D.createTextNode(""),p.style.cssText=I.cssButton,p.appendChild(d),p.onclick=function(){s.parentNode.removeChild(s)},s.appendChild(l),s.appendChild(p),k.insertBefore(s,this.container.nextSibling)),y=D.getElementById(this.container.id+"_navigationbar"),a.Z.exists(y)&&(O=y.style.display,y.style.display="none"),x=function(){l.src=n.toDataURL("image/png"),k.removeChild(n)},"Promise"in window?this.dumpToCanvas(h,b,Z,o).then(x):(this.dumpToCanvas(h,b,Z,o),window.setTimeout(x,200)),a.Z.exists(y)&&(y.style.display=O)),this}});const Xt=u.Z.SVGRenderer;u.Z.VMLRenderer=function(t){this.type="vml",this.container=t,this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.onselectstart=function(){return!1},this.resolution=10,a.Z.exists(u.Z.vmlStylesheet)||(t.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),u.Z.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),u.Z.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{t.ownerDocument.namespaces.jxgvml||t.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(e){return t.ownerDocument.createElement("<jxgvml:"+e+' class="jxgvml">')}}catch{this.createNode=function(e){return t.ownerDocument.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},u.Z.VMLRenderer.prototype=new rt,u.Z.extend(u.Z.VMLRenderer.prototype,{_setAttr:function(t,e,o,s){try{this.container.ownerDocument.documentMode===8?t[e]=o:t.setAttribute(e,o,s)}catch{u.Z.debug("_setAttr: "+e+" "+o+`<br>
`)}},updateTicks:function(t){var e,o,s,n,h,l=this.resolution,p=[];for(o=t.ticks.length,e=0;e<o;e++)n=(s=t.ticks[e])[0],h=s[1],a.Z.isNumber(n[0])&&a.Z.isNumber(n[1])&&p.push(" m "+Math.round(l*n[0])+", "+Math.round(l*h[0])+" l "+Math.round(l*n[1])+", "+Math.round(l*h[1])+" ");a.Z.exists(t.rendNode)||(t.rendNode=this.createPrim("path",t.id),this.appendChildPrim(t.rendNode,a.Z.evaluate(t.visProp.layer))),this._setAttr(t.rendNode,"stroked","true"),this._setAttr(t.rendNode,"strokecolor",a.Z.evaluate(t.visProp.strokecolor),1),this._setAttr(t.rendNode,"strokeweight",a.Z.evaluate(t.visProp.strokewidth)),this._setAttr(t.rendNodeStroke,"opacity",100*a.Z.evaluate(t.visProp.strokeopacity)+"%"),this.updatePathPrim(t.rendNode,p,t.board)},displayCopyright:function(t,e){var o,s;(o=this.createNode("textbox")).style.position="absolute",this._setAttr(o,"id",this.container.id+"_licenseText"),o.style.left=20,o.style.top=2,o.style.fontSize=e,o.style.color="#356AA0",o.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(o,"opacity","30%"),o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 30, enabled = true)",s=this.container.ownerDocument.createTextNode(t),o.appendChild(s),this.appendChildPrim(o,0)},drawInternalText:function(t){var e;return(e=this.createNode("textbox")).style.position="absolute",t.rendNodeText=this.container.ownerDocument.createTextNode(""),e.appendChild(t.rendNodeText),this.appendChildPrim(e,9),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand', enabled = false) progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",e},updateInternalText:function(t){var e,o,s,n,h,l,p=t.plaintext,d=this.joinTransforms(t,t.transformations),b=[0,0],Z=t.rendNode,y=[],O=t.getAnchorX(),x=t.getAnchorY();if(!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])){for(O==="right"?b[0]=1:O==="middle"&&(b[0]=.5),x==="bottom"?b[1]=1:x==="middle"&&(b[1]=.5),y[0]=B.Z.matVecMult(d,[1,t.coords.scrCoords[1]-b[0]*t.size[0],t.coords.scrCoords[2]+(1-b[1])*t.size[1]+this.vOffsetText]),y[0][1]/=y[0][0],y[0][2]/=y[0][0],y[1]=B.Z.matVecMult(d,[1,t.coords.scrCoords[1]+(1-b[0])*t.size[0],t.coords.scrCoords[2]+(1-b[1])*t.size[1]+this.vOffsetText]),y[1][1]/=y[1][0],y[1][2]/=y[1][0],y[2]=B.Z.matVecMult(d,[1,t.coords.scrCoords[1]+(1-b[0])*t.size[0],t.coords.scrCoords[2]-b[1]*t.size[1]+this.vOffsetText]),y[2][1]/=y[2][0],y[2][2]/=y[2][0],y[3]=B.Z.matVecMult(d,[1,t.coords.scrCoords[1]-b[0]*t.size[0],t.coords.scrCoords[2]-b[1]*t.size[1]+this.vOffsetText]),y[3][1]/=y[3][0],y[3][2]/=y[3][0],o=y[0][1],n=y[0][1],s=y[0][2],h=y[0][2],l=1;l<4;l++)o=Math.max(o,y[l][1]),n=Math.min(n,y[l][1]),s=Math.max(s,y[l][2]),h=Math.min(h,y[l][2]);e=b[0]===1?Math.floor(t.board.canvasWidth-o):Math.floor(n),t.visPropOld.left!==O+e&&(b[0]===1?(t.rendNode.style.right=e+"px",t.rendNode.style.left="auto"):(t.rendNode.style.left=e+"px",t.rendNode.style.right="auto"),t.visPropOld.left=O+e),e=b[1]===1?Math.floor(t.board.canvasHeight-s):Math.floor(h),t.visPropOld.top!==x+e&&(b[1]===1?(t.rendNode.style.bottom=e+"px",t.rendNode.style.top="auto"):(t.rendNode.style.top=e+"px",t.rendNode.style.bottom="auto"),t.visPropOld.top=x+e)}t.htmlStr!==p&&(t.rendNodeText.data=p,t.htmlStr=p),Z.filters.item(0).M11=d[1][1],Z.filters.item(0).M12=d[1][2],Z.filters.item(0).M21=d[2][1],Z.filters.item(0).M22=d[2][2],Z.filters.item(0).enabled=!0},drawImage:function(t){var e;(e=this.container.ownerDocument.createElement("img")).style.position="absolute",this._setAttr(e,"id",this.container.id+"_"+t.id),this.container.appendChild(e),this.appendChildPrim(e,a.Z.evaluate(t.visProp.layer)),e.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') progid:DXImageTransform.Microsoft.Alpha(opacity = 100, enabled = false)",t.rendNode=e,this.updateImage(t)},transformImage:function(t,e){var o,s,n,h,l,p,d=t.rendNode,b=[];if(e.length>0){for(o=this.joinTransforms(t,e),b[0]=B.Z.matVecMult(o,t.coords.scrCoords),b[0][1]/=b[0][0],b[0][2]/=b[0][0],b[1]=B.Z.matVecMult(o,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]]),b[1][1]/=b[1][0],b[1][2]/=b[1][0],b[2]=B.Z.matVecMult(o,[1,t.coords.scrCoords[1]+t.size[0],t.coords.scrCoords[2]-t.size[1]]),b[2][1]/=b[2][0],b[2][2]/=b[2][0],b[3]=B.Z.matVecMult(o,[1,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1]]),b[3][1]/=b[3][0],b[3][2]/=b[3][0],s=b[0][1],h=b[0][1],n=b[0][2],l=b[0][2],p=1;p<4;p++)s=Math.max(s,b[p][1]),h=Math.min(h,b[p][1]),n=Math.max(n,b[p][2]),l=Math.min(l,b[p][2]);d.style.left=Math.floor(h)+"px",d.style.top=Math.floor(l)+"px",d.filters.item(0).M11=o[1][1],d.filters.item(0).M12=o[1][2],d.filters.item(0).M21=o[2][1],d.filters.item(0).M22=o[2][2],d.filters.item(0).enabled=!0}},updateImageURL:function(t){var e=a.Z.evaluate(t.url);this._setAttr(t.rendNode,"src",e)},appendChildPrim:function(t,e){return a.Z.exists(e)||(e=0),t.style.zIndex=e,this.container.appendChild(t),t},appendNodesToElement:function(t,e){e!=="shape"&&e!=="path"&&e!=="polygon"||(t.rendNodePath=this.getElementById(t.id+"_path")),t.rendNodeFill=this.getElementById(t.id+"_fill"),t.rendNodeStroke=this.getElementById(t.id+"_stroke"),t.rendNodeShadow=this.getElementById(t.id+"_shadow"),t.rendNode=this.getElementById(t.id)},createPrim:function(t,e){var o,s,n=this.createNode("fill"),h=this.createNode("stroke"),l=this.createNode("shadow");return this._setAttr(n,"id",this.container.id+"_"+e+"_fill"),this._setAttr(h,"id",this.container.id+"_"+e+"_stroke"),this._setAttr(l,"id",this.container.id+"_"+e+"_shadow"),t==="circle"||t==="ellipse"?((o=this.createNode("oval")).appendChild(n),o.appendChild(h),o.appendChild(l)):t==="polygon"||t==="path"||t==="shape"||t==="line"?((o=this.createNode("shape")).appendChild(n),o.appendChild(h),o.appendChild(l),s=this.createNode("path"),this._setAttr(s,"id",this.container.id+"_"+e+"_path"),o.appendChild(s)):((o=this.createNode(t)).appendChild(n),o.appendChild(h),o.appendChild(l)),o.style.position="absolute",o.style.left="0px",o.style.top="0px",this._setAttr(o,"id",this.container.id+"_"+e),o},remove:function(t){a.Z.exists(t)&&t.removeNode(!0)},makeArrows:function(t){var e,o=a.Z.evaluate(t.visProp.firstarrow),s=a.Z.evaluate(t.visProp.lastarrow);t.visPropOld.firstarrow===o&&t.visPropOld.lastarrow===s||(o?(e=t.rendNodeStroke,this._setAttr(e,"startarrow","block"),this._setAttr(e,"startarrowlength","long")):(e=t.rendNodeStroke,a.Z.exists(e)&&this._setAttr(e,"startarrow","none")),s?(e=t.rendNodeStroke,this._setAttr(e,"id",this.container.id+"_"+t.id+"stroke"),this._setAttr(e,"endarrow","block"),this._setAttr(e,"endarrowlength","long")):(e=t.rendNodeStroke,a.Z.exists(e)&&this._setAttr(e,"endarrow","none")),t.visPropOld.firstarrow=o,t.visPropOld.lastarrow=s)},updateEllipsePrim:function(t,e,o,s,n){t.style.left=Math.floor(e-s)+"px",t.style.top=Math.floor(o-n)+"px",t.style.width=Math.floor(2*Math.abs(s))+"px",t.style.height=Math.floor(2*Math.abs(n))+"px"},updateLinePrim:function(t,e,o,s,n,h){var l,p=this.resolution;isNaN(e+o+s+n)||(l=["m ",Math.floor(p*e),", ",Math.floor(p*o)," l ",Math.floor(p*s),", ",Math.floor(p*n)],this.updatePathPrim(t,l,h))},updatePathPrim:function(t,e,o){var s=o.canvasWidth,n=o.canvasHeight;e.length<=0&&(e=["m 0,0"]),t.style.width=s,t.style.height=n,this._setAttr(t,"coordsize",[Math.floor(this.resolution*s),Math.floor(this.resolution*n)].join(",")),this._setAttr(t,"path",e.join(""))},updatePathStringPoint:function(t,e,o){var s=[],n=Math.round,h=t.coords.scrCoords,l=e*Math.sqrt(3)*.5,p=.5*e,d=this.resolution;return o==="x"?s.push([" m ",n(d*(h[1]-e)),", ",n(d*(h[2]-e))," l ",n(d*(h[1]+e)),", ",n(d*(h[2]+e))," m ",n(d*(h[1]+e)),", ",n(d*(h[2]-e))," l ",n(d*(h[1]-e)),", ",n(d*(h[2]+e))].join("")):o==="+"?s.push([" m ",n(d*(h[1]-e)),", ",n(d*h[2])," l ",n(d*(h[1]+e)),", ",n(d*h[2])," m ",n(d*h[1]),", ",n(d*(h[2]-e))," l ",n(d*h[1]),", ",n(d*(h[2]+e))].join("")):o==="<>"?s.push([" m ",n(d*(h[1]-e)),", ",n(d*h[2])," l ",n(d*h[1]),", ",n(d*(h[2]+e))," l ",n(d*(h[1]+e)),", ",n(d*h[2])," l ",n(d*h[1]),", ",n(d*(h[2]-e))," x e "].join("")):o==="^"?s.push([" m ",n(d*h[1]),", ",n(d*(h[2]-e))," l ",n(d*(h[1]-l)),", ",n(d*(h[2]+p))," l ",n(d*(h[1]+l)),", ",n(d*(h[2]+p))," x e "].join("")):o==="v"?s.push([" m ",n(d*h[1]),", ",n(d*(h[2]+e))," l ",n(d*(h[1]-l)),", ",n(d*(h[2]-p))," l ",n(d*(h[1]+l)),", ",n(d*(h[2]-p))," x e "].join("")):o===">"?s.push([" m ",n(d*(h[1]+e)),", ",n(d*h[2])," l ",n(d*(h[1]-p)),", ",n(d*(h[2]-l))," l ",n(d*(h[1]-p)),", ",n(d*(h[2]+l))," l ",n(d*(h[1]+e)),", ",n(d*h[2])].join("")):o==="<"&&s.push([" m ",n(d*(h[1]-e)),", ",n(d*h[2])," l ",n(d*(h[1]+p)),", ",n(d*(h[2]-l))," l ",n(d*(h[1]+p)),", ",n(d*(h[2]+l))," x e "].join("")),s},updatePathStringPrim:function(t){var e,o,s=[],n=this.resolution,h=Math.round,l=" m ",p=l,d=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";if(d=Math.min(d,t.points.length),t.bezierDegree===1)for(e=0;e<d;e++)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?p=l:(o[1]>2e4?o[1]=2e4:o[1]<-2e4&&(o[1]=-2e4),o[2]>2e4?o[2]=2e4:o[2]<-2e4&&(o[2]=-2e4),s.push([p,h(n*o[1]),", ",h(n*o[2])].join("")),p=" l ");else if(t.bezierDegree===3)for(e=0;e<d;)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?p=l:(s.push([p,h(n*o[1]),", ",h(n*o[2])].join("")),p===" c "&&(e+=1,o=t.points[e].scrCoords,s.push([" ",h(n*o[1]),", ",h(n*o[2])].join("")),e+=1,o=t.points[e].scrCoords,s.push([" ",h(n*o[1]),", ",h(n*o[2])].join(""))),p=" c "),e+=1;return s.push(" e"),s},updatePathStringBezierPrim:function(t){var e,o,s,n,h,l,p=[],d=a.Z.evaluate(t.visProp.strokewidth),b=this.resolution,Z=Math.round,y=" m ",O=y,x=a.Z.evaluate(t.visProp.curvetype)!=="plot",D=Math.min(t.numberPoints,8192);if(t.numberPoints<=0)return"";for(x&&t.board.options.curve.RDPsmoothing&&(t.points=c.Z.RamerDouglasPeucker(t.points,1)),D=Math.min(D,t.points.length),o=1;o<3;o++)for(O=y,e=0;e<D;e++)n=t.points[e].scrCoords,isNaN(n[1])||isNaN(n[2])?O=y:(n[1]>2e4?n[1]=2e4:n[1]<-2e4&&(n[1]=-2e4),n[2]>2e4?n[2]=2e4:n[2]<-2e4&&(n[2]=-2e4),O===y?p.push([O,Z(b*n[1])," ",Z(b*n[2])].join("")):(s=2*o,p.push([O,Z(b*(h+.333*(n[1]-h)+d*(s*Math.random()-o)))," ",Z(b*(l+.333*(n[2]-l)+d*(s*Math.random()-o)))," ",Z(b*(h+.666*(n[1]-h)+d*(s*Math.random()-o)))," ",Z(b*(l+.666*(n[2]-l)+d*(s*Math.random()-o)))," ",Z(b*n[1])," ",Z(b*n[2])].join(""))),O=" c ",h=n[1],l=n[2]);return p.push(" e"),p},updatePolygonPrim:function(t,e){var o,s,n=e.vertices.length,h=this.resolution,l=[];if(this._setAttr(t,"stroked","false"),s=e.vertices[0].coords.scrCoords,!isNaN(s[1]+s[2])){for(l.push(["m ",Math.floor(h*s[1]),",",Math.floor(h*s[2])," l "].join("")),o=1;o<n-1;o++){if(!e.vertices[o].isReal)return void this.updatePathPrim(t,"",e.board);if(s=e.vertices[o].coords.scrCoords,isNaN(s[1]+s[2]))return;l.push(Math.floor(h*s[1])+","+Math.floor(h*s[2])),o<n-2&&l.push(", ")}l.push(" x e"),this.updatePathPrim(t,l,e.board)}},updateRectPrim:function(t,e,o,s,n){t.style.left=Math.floor(e)+"px",t.style.top=Math.floor(o)+"px",s>=0&&(t.style.width=s+"px"),n>=0&&(t.style.height=n+"px")},setPropertyPrim:function(t,e,o){var s,n="";switch(e){case"stroke":n="strokecolor";break;case"stroke-width":n="strokeweight";break;case"stroke-dasharray":n="dashstyle"}n!==""&&(s=a.Z.evaluate(o),this._setAttr(t,n,s))},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(t){u.Z.deprecated("Board.renderer.show()","Board.renderer.display()"),t&&t.rendNode&&(t.rendNode.style.visibility="inherit")},hide:function(t){u.Z.deprecated("Board.renderer.hide()","Board.renderer.display()"),t&&t.rendNode&&(t.rendNode.style.visibility="hidden")},setDashStyle:function(t,e){var o;e.dash>=0&&(o=t.rendNodeStroke,this._setAttr(o,"dashstyle",this.dashArray[e.dash]))},setGradient:function(t){var e=t.rendNodeFill,o=a.Z.evaluate(t.visProp.gradient);o==="linear"?(this._setAttr(e,"type","gradient"),this._setAttr(e,"color2",a.Z.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",a.Z.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"angle",a.Z.evaluate(t.visProp.gradientangle))):o==="radial"?(this._setAttr(e,"type","gradientradial"),this._setAttr(e,"color2",a.Z.evaluate(t.visProp.gradientsecondcolor)),this._setAttr(e,"opacity2",a.Z.evaluate(t.visProp.gradientsecondopacity)),this._setAttr(e,"focusposition",100*a.Z.evaluate(t.visProp.gradientpositionx)+"%,"+100*a.Z.evaluate(t.visProp.gradientpositiony)+"%"),this._setAttr(e,"focussize","0,0")):this._setAttr(e,"type","solid")},setObjectFillColor:function(t,e,o){var s,n,h,l=a.Z.evaluate(e),p=a.Z.evaluate(o),d=t.rendNode;p=p>0?p:0,t.visPropOld.fillcolor===l&&t.visPropOld.fillopacity===p||(a.Z.exists(l)&&l!==!1&&(l.length!==9?(s=l,h=p):(s=(n=_t.Z.rgba2rgbo(l))[0],h=p*n[1]),s==="none"||s===!1?this._setAttr(t.rendNode,"filled","false"):(this._setAttr(t.rendNode,"filled","true"),this._setAttr(t.rendNode,"fillcolor",s),a.Z.exists(h)&&t.rendNodeFill&&this._setAttr(t.rendNodeFill,"opacity",100*h+"%")),t.type===S.Z.OBJECT_TYPE_IMAGE&&d.filters.length>1&&(d.filters.item(1).opacity=Math.round(100*h),d.filters.item(1).enabled=!0)),t.visPropOld.fillcolor=l,t.visPropOld.fillopacity=p)},setObjectStrokeColor:function(t,e,o){var s,n,h,l,p=a.Z.evaluate(e),d=a.Z.evaluate(o),b=t.rendNode;d=d>0?d:0,t.visPropOld.strokecolor===p&&t.visPropOld.strokeopacity===d||(a.Z.exists(p)&&p!==!1&&(p.length!==9?(s=p,h=d):(s=(n=e.rgba2rgbo(p))[0],h=d*n[1]),t.elementClass===S.Z.OBJECT_CLASS_TEXT?(b.filters.length>1&&(b.filters.item(1).opacity=Math.round(100*h),b.filters.item(1).enabled=!0),b.style.color=s):(s!==!1&&(this._setAttr(b,"stroked","true"),this._setAttr(b,"strokecolor",s)),l=t.rendNodeStroke,a.Z.exists(h)&&t.type!==S.Z.OBJECT_TYPE_IMAGE&&this._setAttr(l,"opacity",100*h+"%"))),t.visPropOld.strokecolor=p,t.visPropOld.strokeopacity=d)},setObjectStrokeWidth:function(t,e){var o,s=a.Z.evaluate(e);isNaN(s)||t.visPropOld.strokewidth===s||(o=t.rendNode,this.setPropertyPrim(o,"stroked","true"),a.Z.exists(s)&&(this.setPropertyPrim(o,"stroke-width",s),s===0&&a.Z.exists(t.rendNodeStroke)&&this._setAttr(o,"stroked","false")),t.visPropOld.strokewidth=s)},setShadow:function(t){var e=t.rendNodeShadow,o=a.Z.evaluate(t.visProp.shadow);e&&t.visPropOld.shadow!==o&&(o?(this._setAttr(e,"On","True"),this._setAttr(e,"Offset","3pt,3pt"),this._setAttr(e,"Opacity","60%"),this._setAttr(e,"Color","#aaaaaa")):this._setAttr(e,"On","False"),t.visPropOld.shadow=o)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}});const $t=u.Z.VMLRenderer;var se="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");u.Z.Util=u.Z.Util||{},u.Z.Util.genUUID=function(t){var e,o,s=[],n=0;for((t=t||"")!==""&&t.substr(t.length-1)!=="-"&&(t+="-"),o=0;o<36;o++)o===8||o===13||o===18||o===23?s[o]="-":o===14?s[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),e=15&n,n>>=4,s[o]=se[o===19?3&e|8:e]);return t+s.join("")};const ae=u.Z.Util;u.Z.CanvasRenderer=function(t,e){if(this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=ae.genUUID(),this.canvasNamespace=null,N.Z.isBrowser)this.container=t,this.container.style.MozUserSelect="none",this.container.style.userSelect="none",this.container.style.overflow="hidden",this.container.style.position===""&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',e.width,'px" height="',e.height,'px"><',"/canvas>"].join(""),this.canvasRoot=this.container.ownerDocument.getElementById(this.canvasId),this.canvasRoot.style.display="block",this.context=this.canvasRoot.getContext("2d");else if(N.Z.isNode())try{this.canvasRoot=u.Z.createCanvas(500,500),this.context=this.canvasRoot.getContext("2d")}catch{throw new Error(`JXG.createCanvas not available.
Install the npm package \`canvas\`
and call:
    import { createCanvas } from "canvas";
    JXG.createCanvas = createCanvas;
`)}this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},u.Z.CanvasRenderer.prototype=new rt,u.Z.extend(u.Z.CanvasRenderer.prototype,{_drawPolygon:function(t,e,o){var s,n=t.length,h=this.context;if(n>0){if(o&&(h.lineWidth=0),h.beginPath(),h.moveTo(t[0][0],t[0][1]),e===1)for(s=1;s<n;s++)h.lineTo(t[s][0],t[s][1]);else for(s=1;s<n;s+=3)h.bezierCurveTo(t[s][0],t[s][1],t[s+1][0],t[s+1][1],t[s+2][0],t[s+2][1]);o?(h.lineTo(t[0][0],t[0][1]),h.closePath(),h.fill("evenodd")):h.stroke()}},_fill:function(t){var e=this.context;e.save(),this._setColor(t,"fill")&&e.fill("evenodd"),e.restore()},_rotatePoint:function(t,e,o){return[e*Math.cos(t)-o*Math.sin(t),e*Math.sin(t)+o*Math.cos(t)]},_rotateShape:function(t,e){var o,s=[],n=t.length;if(n<=0)return t;for(o=0;o<n;o++)s.push(this._rotatePoint(e,t[o][0],t[o][1]));return s},updateGradientAngle:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O,x,D=1,k=Math.cos(-e),I=Math.sin(-e),U=t.getBoundingBox();return Math.abs(k)>Math.abs(I)?D/=Math.abs(k):D/=Math.abs(I),k>=0?(n=0,h=k*D):(n=-k*D,h=0),I>=0?(l=0,p=I*D):(l=-I*D,p=0),o=new m.Z(S.Z.COORDS_BY_USER,[U[0],U[1]],t.board),O=(s=new m.Z(S.Z.COORDS_BY_USER,[U[2],U[3]],t.board)).scrCoords[1]-o.scrCoords[1],x=s.scrCoords[2]-o.scrCoords[2],d=o.scrCoords[1]+O*n,Z=o.scrCoords[2]+x*l,b=o.scrCoords[1]+O*h,y=o.scrCoords[2]+x*p,this.context.createLinearGradient(d,Z,b,y)},updateGradientCircle:function(t,e,o,s,n,h,l){var p,d,b,Z,y,O,x,D,k,I,U=t.getBoundingBox();return p=new m.Z(S.Z.COORDS_BY_USER,[U[0],U[1]],t.board),k=(d=new m.Z(S.Z.COORDS_BY_USER,[U[2],U[3]],t.board)).scrCoords[1]-p.scrCoords[1],I=p.scrCoords[2]-d.scrCoords[2],b=p.scrCoords[1]+k*e,Z=d.scrCoords[2]+I*o,O=p.scrCoords[1]+k*n,x=d.scrCoords[2]+I*h,y=s*(k+I)*.5,D=l*(k+I)*.5,this.context.createRadialGradient(O,x,D,b,Z,y)},updateGradient:function(t){var e,o,s,n=a.Z.evaluate(t.visProp.gradient);return o=(o=a.Z.evaluate(t.visProp.fillopacity))>0?o:0,e=a.Z.evaluate(t.visProp.fillcolor),n==="linear"?s=this.updateGradientAngle(t,a.Z.evaluate(t.visProp.gradientangle)):n==="radial"&&(s=this.updateGradientCircle(t,a.Z.evaluate(t.visProp.gradientcx),a.Z.evaluate(t.visProp.gradientcy),a.Z.evaluate(t.visProp.gradientr),a.Z.evaluate(t.visProp.gradientfx),a.Z.evaluate(t.visProp.gradientfy),a.Z.evaluate(t.visProp.gradientfr))),s.addColorStop(a.Z.evaluate(t.visProp.gradientstartoffset),e),s.addColorStop(a.Z.evaluate(t.visProp.gradientendoffset),a.Z.evaluate(t.visProp.gradientsecondcolor)),s},_setColor:function(t,e,o){var s,n,h,l,p,d,b,Z,y=!0,O=t.visProp;return e=e||"stroke",o=o||e,s=this._getHighlighted(t),(Z=a.Z.evaluate(t.visProp.gradient))==="linear"||Z==="radial"?(this.context[o+"Style"]=this.updateGradient(t),y):((h=a.Z.evaluate(O[s+e+"color"]))!=="none"&&h!==!1?(d=(d=a.Z.evaluate(O[s+e+"opacity"]))>0?d:0,h.length!==9?(p=h,b=d):(p=(l=_t.Z.rgba2rgbo(h))[0],b=d*l[1]),this.context.globalAlpha=b,this.context[o+"Style"]=p):y=!1,n=parseFloat(a.Z.evaluate(O[s+"strokewidth"])),e!=="stroke"||isNaN(n)||(n===0?this.context.globalAlpha=0:this.context.lineWidth=n),e==="stroke"&&O.linecap!==void 0&&O.linecap!==""&&(this.context.lineCap=O.linecap),y)},_stroke:function(t){var e=this.context,o=a.Z.evaluate(t.visProp.dash);e.save(),o>0?e.setLineDash&&e.setLineDash(this.dashArray[o]):this.context.lineDashArray=[],this._setColor(t,"stroke")&&e.stroke(),e.restore()},_translateShape:function(t,e,o){var s,n=[],h=t.length;if(h<=0)return t;for(s=0;s<h;s++)n.push([t[s][0]+e,t[s][1]+o]);return n},drawPoint:function(t){var e=a.Z.evaluate(t.visProp.face),o=a.Z.evaluate(t.visProp.size),s=t.coords.scrCoords,n=o*Math.sqrt(3)*.5,h=.5*o,l=parseFloat(a.Z.evaluate(t.visProp.strokewidth))/2,p=this.context;if(t.visPropCalc.visible)switch(e){case"cross":case"x":p.beginPath(),p.moveTo(s[1]-o,s[2]-o),p.lineTo(s[1]+o,s[2]+o),p.moveTo(s[1]+o,s[2]-o),p.lineTo(s[1]-o,s[2]+o),p.lineCap="round",p.lineJoin="round",p.closePath(),this._stroke(t);break;case"circle":case"o":p.beginPath(),p.arc(s[1],s[2],o+1+l,0,2*Math.PI,!1),p.closePath(),this._fill(t),this._stroke(t);break;case"square":case"[]":if(o<=0)break;p.save(),this._setColor(t,"stroke","fill")&&p.fillRect(s[1]-o-l,s[2]-o-l,2*o+3*l,2*o+3*l),p.restore(),p.save(),this._setColor(t,"fill"),p.fillRect(s[1]-o+l,s[2]-o+l,2*o-l,2*o-l),p.restore();break;case"plus":case"+":p.beginPath(),p.moveTo(s[1]-o,s[2]),p.lineTo(s[1]+o,s[2]),p.moveTo(s[1],s[2]-o),p.lineTo(s[1],s[2]+o),p.lineCap="round",p.lineJoin="round",p.closePath(),this._stroke(t);break;case"divide":case"|":p.beginPath(),p.moveTo(s[1],s[2]-o),p.lineTo(s[1],s[2]+o),p.lineCap="round",p.lineJoin="round",p.closePath(),this._stroke(t);break;case"minus":case"-":p.beginPath(),p.moveTo(s[1]-o,s[2]),p.lineTo(s[1]+o,s[2]),p.lineCap="round",p.lineJoin="round",p.closePath(),this._stroke(t);break;case"diamond":case"<>":p.beginPath(),p.moveTo(s[1]-o,s[2]),p.lineTo(s[1],s[2]+o),p.lineTo(s[1]+o,s[2]),p.lineTo(s[1],s[2]-o),p.closePath(),this._fill(t),this._stroke(t);break;case"triangleup":case"a":case"^":p.beginPath(),p.moveTo(s[1],s[2]-o),p.lineTo(s[1]-n,s[2]+h),p.lineTo(s[1]+n,s[2]+h),p.closePath(),this._fill(t),this._stroke(t);break;case"triangledown":case"v":p.beginPath(),p.moveTo(s[1],s[2]+o),p.lineTo(s[1]-n,s[2]-h),p.lineTo(s[1]+n,s[2]-h),p.closePath(),this._fill(t),this._stroke(t);break;case"triangleleft":case"<":p.beginPath(),p.moveTo(s[1]-o,s[2]),p.lineTo(s[1]+h,s[2]-n),p.lineTo(s[1]+h,s[2]+n),p.closePath(),this._fill(t),this._stroke(t);break;case"triangleright":case">":p.beginPath(),p.moveTo(s[1]+o,s[2]),p.lineTo(s[1]-h,s[2]-n),p.lineTo(s[1]-h,s[2]+n),p.closePath(),this._fill(t),this._stroke(t)}},updatePoint:function(t){this.drawPoint(t)},drawArrows:function(t,e,o,s,n){var h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z,V,W,$,nt,et,lt=this.context,ot=1,gt=1,vt=1,Tt=n.evFirst,Rt=n.evLast;if(a.Z.evaluate(t.visProp.strokecolor)!=="none"&&(Tt||Rt)){if(t.elementClass===S.Z.OBJECT_CLASS_LINE)h=e.scrCoords[1],l=e.scrCoords[2],p=o.scrCoords[1],d=o.scrCoords[2],nt=et=Math.atan2(d-l,p-h);else{if(h=t.points[0].scrCoords[1],l=t.points[0].scrCoords[2],($=t.points.length-1)<1)return;p=t.points[t.points.length-1].scrCoords[1],d=t.points[t.points.length-1].scrCoords[2],J=t.points[1].scrCoords[1]-t.points[0].scrCoords[1],z=t.points[1].scrCoords[2]-t.points[0].scrCoords[2],V=t.points[$].scrCoords[1]-t.points[$-1].scrCoords[1],W=t.points[$].scrCoords[2]-t.points[$-1].scrCoords[2],Tt&&(nt=Math.atan2(z,J)),Rt&&(et=Math.atan2(W,V))}if(b=a.Z.evaluate(t.visProp[s+"strokewidth"]),Tt)if(Z=b*n.sizeFirst,x=ot=n.typeFirst,ot===2)O=[[Z,.5*-Z],[0,0],[Z,.5*Z],[.5*Z,0]];else if(ot===3)O=[[Z/3,.5*-Z],[0,.5*-Z],[0,.5*Z],[Z/3,.5*Z]];else if(ot===4)for(Z/=10,gt=3,U=(O=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,I=0;I<U;I++)O[I][0]*=-Z,O[I][1]*=Z,O[I][0]+=10*Z,O[I][1]-=3.31*Z;else if(ot===5)for(Z/=10,gt=3,U=(O=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,I=0;I<U;I++)O[I][0]*=-Z,O[I][1]*=Z,O[I][0]+=10*Z,O[I][1]-=3.28*Z;else if(ot===6)for(Z/=10,gt=3,U=(O=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,I=0;I<U;I++)O[I][0]*=-Z,O[I][1]*=Z,O[I][0]+=10*Z,O[I][1]-=2.84*Z;else if(ot===7)for(Z=b,gt=3,U=(O=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,I=0;I<U;I++)O[I][0]*=-Z,O[I][1]*=Z,O[I][0]+=10*Z,O[I][1]-=5.2*Z;else O=[[Z,.5*-Z],[0,0],[Z,.5*Z]];if(Rt)if(Z=b*n.sizeLast,D=ot=n.typeLast,ot===2)y=[[-Z,.5*-Z],[0,0],[-Z,.5*Z],[.5*-Z,0]];else if(ot===3)y=[[-Z/3,.5*-Z],[0,.5*-Z],[0,.5*Z],[-Z/3,.5*Z]];else if(ot===4)for(Z/=10,vt=3,U=(y=[[10,3.31],[6.47,3.84],[2.87,4.5],[0,6.63],[.67,5.52],[1.33,4.42],[2,3.31],[1.33,2.21],[.67,1.1],[0,0],[2.87,2.13],[6.47,2.79],[10,3.31]]).length,I=0;I<U;I++)y[I][0]*=Z,y[I][1]*=Z,y[I][0]-=10*Z,y[I][1]-=3.31*Z;else if(ot===5)for(Z/=10,vt=3,U=(y=[[10,3.28],[6.61,4.19],[3.19,5.07],[0,6.55],[.62,5.56],[1,4.44],[1,3.28],[1,2.11],[.62,.99],[0,0],[3.19,1.49],[6.61,2.37],[10,3.28]]).length,I=0;I<U;I++)y[I][0]*=Z,y[I][1]*=Z,y[I][0]-=10*Z,y[I][1]-=3.28*Z;else if(ot===6)for(Z/=10,vt=3,U=(y=[[10,2.84],[6.61,3.59],[3.21,4.35],[0,5.68],[.33,4.73],[.67,3.78],[1,2.84],[.67,1.89],[.33,.95],[0,0],[3.21,1.33],[6.61,2.09],[10,2.84]]).length,I=0;I<U;I++)y[I][0]*=Z,y[I][1]*=Z,y[I][0]-=10*Z,y[I][1]-=2.84*Z;else if(ot===7)for(Z=b,vt=3,U=(y=[[0,10.39],[2.01,6.92],[5.96,5.2],[10,5.2],[5.96,5.2],[2.01,3.47],[0,0]]).length,I=0;I<U;I++)y[I][0]*=Z,y[I][1]*=Z,y[I][0]-=10*Z,y[I][1]-=5.2*Z;else y=[[-Z,.5*-Z],[0,0],[-Z,.5*Z]];lt.save(),this._setColor(t,"stroke","fill")&&(this._setColor(t,"stroke"),Tt&&(k=x!==7,this._drawPolygon(this._translateShape(this._rotateShape(O,nt),h,l),gt,k)),Rt&&(k=D!==7,this._drawPolygon(this._translateShape(this._rotateShape(y,et),p,d),vt,k))),lt.restore()}},drawLine:function(t){var e,o,s,n,h,l=new m.Z(S.Z.COORDS_BY_USER,t.point1.coords.usrCoords,t.board),p=new m.Z(S.Z.COORDS_BY_USER,t.point2.coords.usrCoords,t.board),d=null;t.visPropCalc.visible&&(s=this._getHighlighted(t),n=a.Z.evaluate(t.visProp[s+"strokewidth"]),((h=this.getArrowHeadData(t,n,s)).evFirst||h.evLast)&&(d=-4),_.Z.calcStraight(t,l,p,d),this.handleTouchpoints(t,l,p,h),e=new m.Z(S.Z.COORDS_BY_USER,l.usrCoords,t.board),o=new m.Z(S.Z.COORDS_BY_USER,p.usrCoords,t.board),this.getPositionArrowHead(t,l,p,h),this.context.beginPath(),this.context.moveTo(l.scrCoords[1],l.scrCoords[2]),this.context.lineTo(p.scrCoords[1],p.scrCoords[2]),this._stroke(t),(h.evFirst||h.evLast)&&this.drawArrows(t,e,o,s,h))},updateLine:function(t){this.drawLine(t)},drawTicks:function(){},updateTicks:function(t){var e,o,s,n,h,l,p=t.ticks.length,d=this.context;for(d.beginPath(),e=0;e<p;e++)for(s=(o=t.ticks[e])[0],n=o[1],h=s.length,d.moveTo(s[0],n[0]),l=1;l<h;++l)d.lineTo(s[l],n[l]);d.lineCap="round",this._stroke(t)},drawCurve:function(t){var e,o,s;a.Z.evaluate(t.visProp.handdrawing)?this.updatePathStringBezierPrim(t):this.updatePathStringPrim(t),t.numberPoints>1&&(e=this._getHighlighted(t),o=a.Z.evaluate(t.visProp[e+"strokewidth"]),((s=this.getArrowHeadData(t,o,e)).evFirst||s.evLast)&&this.drawArrows(t,null,null,e,s))},updateCurve:function(t){this.drawCurve(t)},drawEllipse:function(t){var e=t.center.coords.scrCoords[1],o=t.center.coords.scrCoords[2],s=t.board.unitX,n=t.board.unitY,h=2*t.Radius(),l=2*t.Radius(),p=h*s,d=l*n,b=e-p/2,Z=o-d/2,y=p/2*.5522848,O=d/2*.5522848,x=b+p,D=Z+d,k=b+p/2,I=Z+d/2,U=this.context;h>0&&l>0&&!isNaN(e+o)&&(U.beginPath(),U.moveTo(b,I),U.bezierCurveTo(b,I-O,k-y,Z,k,Z),U.bezierCurveTo(k+y,Z,x,I-O,x,I),U.bezierCurveTo(x,I+O,k+y,D,k,D),U.bezierCurveTo(k-y,D,b,I+O,b,I),U.closePath(),this._fill(t),this._stroke(t))},updateEllipse:function(t){return this.drawEllipse(t)},displayCopyright:function(t,e){var o=this.context;o.save(),o.font=e+"px Arial",o.fillStyle="#aaa",o.lineWidth=.5,o.fillText(t,10,2+e),o.restore()},drawInternalText:function(t){var e=a.Z.evaluate(t.visProp.fontsize),o=a.Z.evaluate(t.visProp.fontunit),s=t.getAnchorX(),n=t.getAnchorY(),h=this.context;return h.save(),this._setColor(t,"stroke","fill")&&!isNaN(t.coords.scrCoords[1]+t.coords.scrCoords[2])&&(h.font=(e>0?e:0)+o+" Arial",this.transformImage(t,t.transformations),s==="left"?h.textAlign="left":s==="right"?h.textAlign="right":s==="middle"&&(h.textAlign="center"),n==="bottom"?h.textBaseline="bottom":n==="top"?h.textBaseline="top":n==="middle"&&(h.textBaseline="middle"),h.fillText(t.plaintext,t.coords.scrCoords[1],t.coords.scrCoords[2])),h.restore(),null},updateInternalText:function(t){this.drawInternalText(t)},setObjectStrokeColor:function(t,e,o){var s,n,h,l,p=a.Z.evaluate(e),d=a.Z.evaluate(o);d=d>0?d:0,t.visPropOld.strokecolor===p&&t.visPropOld.strokeopacity===d||(a.Z.exists(p)&&p!==!1&&(p.length!==9?(s=p,h=d):(s=(n=_t.Z.rgba2rgbo(p))[0],h=d*n[1]),l=t.rendNode,t.elementClass===S.Z.OBJECT_CLASS_TEXT&&a.Z.evaluate(t.visProp.display)==="html"&&(l.style.color=s,l.style.opacity=h)),t.visPropOld.strokecolor=p,t.visPropOld.strokeopacity=d)},drawImage:function(t){t.rendNode=new Image,t._src="",this.updateImage(t)},updateImage:function(t){var e=this.context,o=a.Z.evaluate(t.visProp.fillopacity),s=a.Z.bind(function(){t.imgIsLoaded=!0,t.size[0]<=0||t.size[1]<=0||(e.save(),e.globalAlpha=o,this.transformImage(t,t.transformations),e.drawImage(t.rendNode,t.coords.scrCoords[1],t.coords.scrCoords[2]-t.size[1],t.size[0],t.size[1]),e.restore())},this);this.updateImageURL(t)?t.rendNode.onload=s:t.imgIsLoaded&&s()},transformImage:function(t,e){var o,s=e.length,n=this.context;s>0&&(o=this.joinTransforms(t,e),Math.abs(c.Z.det(o))>=B.Z.eps&&n.transform(o[1][1],o[2][1],o[1][2],o[2][2],o[1][0],o[2][0]))},updateImageURL:function(t){var e;return e=a.Z.evaluate(t.url),t._src!==e&&(t.imgIsLoaded=!1,t.rendNode.src=e,t._src=e,!0)},remove:function(t){a.Z.exists(t)&&a.Z.exists(t.parentNode)&&t.parentNode.removeChild(t)},updatePathStringPrim:function(t){var e,o,s,n,h,l="M",p=l,d=5e3,b=this.context;if(!(t.numberPoints<=0)){if(h=Math.min(t.points.length,t.numberPoints),b.beginPath(),t.bezierDegree===1)for(e=0;e<h;e++)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?p=l:(o[1]>d?o[1]=d:o[1]<-5e3&&(o[1]=-5e3),o[2]>d?o[2]=d:o[2]<-5e3&&(o[2]=-5e3),p===l?b.moveTo(o[1],o[2]):b.lineTo(o[1],o[2]),p="L");else if(t.bezierDegree===3)for(e=0;e<h;)o=t.points[e].scrCoords,isNaN(o[1])||isNaN(o[2])?p=l:(p===l?b.moveTo(o[1],o[2]):(e+=1,s=t.points[e].scrCoords,e+=1,n=t.points[e].scrCoords,b.bezierCurveTo(o[1],o[2],s[1],s[2],n[1],n[2])),p="C"),e+=1;b.lineCap="round",this._fill(t),this._stroke(t)}},updatePathStringBezierPrim:function(t){var e,o,s,n,h,l,p,d="M",b=d,Z=5e3,y=a.Z.evaluate(t.visProp.strokewidth),O=a.Z.evaluate(t.visProp.curvetype)!=="plot",x=this.context;if(!(t.numberPoints<=0)){for(O&&t.board.options.curve.RDPsmoothing&&(t.points=c.Z.RamerDouglasPeucker(t.points,.5)),p=Math.min(t.points.length,t.numberPoints),x.beginPath(),o=1;o<3;o++)for(b=d,e=0;e<p;e++)n=t.points[e].scrCoords,isNaN(n[1])||isNaN(n[2])?b=d:(n[1]>Z?n[1]=Z:n[1]<-5e3&&(n[1]=-5e3),n[2]>Z?n[2]=Z:n[2]<-5e3&&(n[2]=-5e3),b===d?x.moveTo(n[1],n[2]):(s=2*o,x.bezierCurveTo(h+.333*(n[1]-h)+y*(s*Math.random()-o),l+.333*(n[2]-l)+y*(s*Math.random()-o),h+.666*(n[1]-h)+y*(s*Math.random()-o),l+.666*(n[2]-l)+y*(s*Math.random()-o),n[1],n[2])),b="C",h=n[1],l=n[2]);x.lineCap="round",this._fill(t),this._stroke(t)}},updatePolygonPrim:function(t,e){var o,s,n,h=e.vertices.length,l=this.context,p=!0;if(!(h<=0)&&e.visPropCalc.visible){for(e.elType==="polygonalchain"&&h++,l.beginPath(),s=0;!e.vertices[s].isReal&&s<h-1;)s++,p=!1;for(o=e.vertices[s].coords.scrCoords,l.moveTo(o[1],o[2]),n=s;n<h-1;n++)e.vertices[n].isReal||(p=!1),o=e.vertices[n].coords.scrCoords,l.lineTo(o[1],o[2]);l.closePath(),p&&this._fill(e)}},display:function(t,e){t&&t.rendNode&&(t.visPropOld.visible=e,t.rendNode.style.visibility=e?"inherit":"hidden")},show:function(t){u.Z.deprecated("Board.renderer.show()","Board.renderer.display()"),a.Z.exists(t.rendNode)&&(t.rendNode.style.visibility="inherit")},hide:function(t){u.Z.deprecated("Board.renderer.hide()","Board.renderer.display()"),a.Z.exists(t.rendNode)&&(t.rendNode.style.visibility="hidden")},setGradient:function(t){var e;e=(e=a.Z.evaluate(t.visProp.fillopacity))>0?e:0},setShadow:function(t){t.visPropOld.shadow!==t.visProp.shadow&&(t.visPropOld.shadow=t.visProp.shadow)},highlight:function(t){return t.elementClass===S.Z.OBJECT_CLASS_TEXT&&a.Z.evaluate(t.visProp.display)==="html"?this.updateTextStyle(t,!0):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},noHighlight:function(t){return t.elementClass===S.Z.OBJECT_CLASS_TEXT&&a.Z.evaluate(t.visProp.display)==="html"?this.updateTextStyle(t,!1):(t.board.prepareUpdate(),t.board.renderer.suspendRedraw(t.board),t.board.updateRenderer(),t.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(t){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),t&&t.attr.showcopyright&&this.displayCopyright(u.Z.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(t,e){this.container?(this.canvasRoot.style.width=parseFloat(t)+"px",this.canvasRoot.style.height=parseFloat(e)+"px",this.canvasRoot.setAttribute("width",2*parseFloat(t)+"px"),this.canvasRoot.setAttribute("height",2*parseFloat(e)+"px")):(this.canvasRoot.width=2*parseFloat(t),this.canvasRoot.height=2*parseFloat(e)),this.context=this.canvasRoot.getContext("2d"),this.context.scale(2,2)},removeToInsertLater:function(){return function(){}}});const le=u.Z.CanvasRenderer;u.Z.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},u.Z.extend(u.Z.NoRenderer.prototype,{drawPoint:function(t){},updatePoint:function(t){},changePointStyle:function(t){},drawLine:function(t){},updateLine:function(t){},drawTicks:function(t){},updateTicks:function(t){},drawCurve:function(t){},updateCurve:function(t){},drawEllipse:function(t){},updateEllipse:function(t){},drawPolygon:function(t){},updatePolygon:function(t){},displayCopyright:function(t,e){},drawInternalText:function(t){},updateInternalText:function(t){},drawText:function(t){},updateText:function(t){},updateTextStyle:function(t,e){},updateInternalTextStyle:function(t,e,o){},drawImage:function(t){},updateImage:function(t){},transformImage:function(t,e){},updateImageURL:function(t){},appendChildPrim:function(t,e){},appendNodesToElement:function(t,e){},createPrim:function(t,e){return null},remove:function(t){},makeArrows:function(t){},updateEllipsePrim:function(t,e,o,s,n){},updateLinePrim:function(t,e,o,s,n,h){},updatePathPrim:function(t,e,o){},updatePathStringPoint:function(t,e,o){},updatePathStringPrim:function(t){},updatePathStringBezierPrim:function(t){},updatePolygonPrim:function(t,e){},updateRectPrim:function(t,e,o,s,n){},setPropertyPrim:function(t,e,o){},display:function(t,e){t&&(t.visPropOld.visible=e)},show:function(t){},hide:function(t){},setBuffering:function(t,e){},setDashStyle:function(t){},setDraft:function(t){},removeDraft:function(t){},setGradient:function(t){},updateGradient:function(t){},setObjectTransition:function(t,e){},setObjectFillColor:function(t,e,o){},setObjectStrokeColor:function(t,e,o){},setObjectStrokeWidth:function(t,e){},setShadow:function(t){},highlight:function(t){},noHighlight:function(t){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(t){},getElementById:function(t){return null},resize:function(t,e){},removeToInsertLater:function(){return function(){}}}),u.Z.NoRenderer.prototype=new rt;const he=u.Z.NoRenderer;u.Z.JSXGraph={rendererType:(it.Z.board.renderer="no",N.Z.supportsVML()&&(it.Z.board.renderer="vml",document.onmousemove=function(){var t;return document.body&&(t=document.body.scrollLeft,t+=document.body.scrollTop),t}),N.Z.supportsCanvas()&&(it.Z.board.renderer="canvas"),N.Z.supportsSVG()&&(it.Z.board.renderer="svg"),N.Z.isNode()&&N.Z.supportsCanvas()&&(it.Z.board.renderer="canvas"),(N.Z.isNode()||it.Z.renderer==="no")&&(it.Z.text.display="internal",it.Z.infobox.display="internal"),it.Z.board.renderer),initRenderer:function(t,e,o,s){var n;if(a.Z.exists(o)&&o!==!1||typeof document!="object"||(o=document),typeof o=="object"&&t!==null)for(n=o.getElementById(t);n.firstChild;)n.removeChild(n.firstChild);else n=t;return s!==void 0&&s!=="auto"||(s=this.rendererType),s==="svg"?new Xt(n,e):s==="vml"?new $t(n):s==="canvas"?new le(n,e):new he},_setAttributes:function(t){var e=a.Z.copyAttributes(t,it.Z,"board");return e.zoom=a.Z.copyAttributes(e,it.Z,"board","zoom"),e.pan=a.Z.copyAttributes(e,it.Z,"board","pan"),e.drag=a.Z.copyAttributes(e,it.Z,"board","drag"),e.keyboard=a.Z.copyAttributes(e,it.Z,"board","keyboard"),e.selection=a.Z.copyAttributes(e,it.Z,"board","selection"),e.navbar=a.Z.copyAttributes(e.navbar,it.Z,"navbar"),e.screenshot=a.Z.copyAttributes(e,it.Z,"board","screenshot"),e.resize=a.Z.copyAttributes(e,it.Z,"board","resize"),e.fullscreen=a.Z.copyAttributes(e,it.Z,"board","fullscreen"),e.logging=a.Z.copyAttributes(e,it.Z,"board","logging"),e.movetarget=t.moveTarget||t.movetarget||it.Z.board.moveTarget,e},_fillBoard:function(t,e,o){t.initInfobox(),t.maxboundingbox=e.maxboundingbox,t.resizeContainer(o.width,o.height,!0,!0),t._createSelectionPolygon(e),t.renderer.drawZoomBar(t,e.navbar),u.Z.boards[t.id]=t},_setARIA:function(t,e){var o,s,n,h,l,p,d=e.document;if(typeof d!="object"){if(!N.Z.isBrowser)return;d=document}o=(s=d.getElementById(t)).ownerDocument,h=s.parentNode,l=t+"_ARIAlabel",p=t+"_ARIAdescription",(n=o.createElement("div")).innerHTML=e.title,n.setAttribute("id",l),n.style.display="none",h.insertBefore(n,s),(n=o.createElement("div")).innerHTML=e.description,n.setAttribute("id",p),n.style.display="none",h.insertBefore(n,s),s.setAttribute("aria-labelledby",l),s.setAttribute("aria-describedby",p)},_removeARIANodes:function(t){var e,o,s;typeof(s=t.document||document)=="object"&&(o=t.containerObj.getAttribute("aria-labelledby"),(e=s.getElementById(o))&&e.parentNode&&e.parentNode.removeChild(e),o=t.containerObj.getAttribute("aria-describedby"),(e=s.getElementById(o))&&e.parentNode&&e.parentNode.removeChild(e))},initBoard:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O,x,D,k,I=0,U=0;return e=e||{},y=this._setAttributes(e),b=N.Z.getDimensions(t,y.document),y.unitx||y.unity?(o=a.Z.def(y.originx,150),s=a.Z.def(y.originy,150),n=a.Z.def(y.unitx,50),h=a.Z.def(y.unity,50)):((Z=y.boundingbox)[0]<y.maxboundingbox[0]&&(Z[0]=y.maxboundingbox[0]),Z[1]>y.maxboundingbox[1]&&(Z[1]=y.maxboundingbox[1]),Z[2]>y.maxboundingbox[2]&&(Z[2]=y.maxboundingbox[2]),Z[3]<y.maxboundingbox[3]&&(Z[3]=y.maxboundingbox[3]),p=parseInt(b.width,10),d=parseInt(b.height,10),a.Z.exists(Z)&&y.keepaspectratio?(n=p/(Z[2]-Z[0]),h=d/(Z[1]-Z[3]),Math.abs(n)<Math.abs(h)?U=.5*(d/(h=Math.abs(n)*h/Math.abs(h))-(Z[1]-Z[3])):I=.5*(p/(n=Math.abs(h)*n/Math.abs(n))-(Z[2]-Z[0]))):(n=p/(Z[2]-Z[0]),h=d/(Z[1]-Z[3])),o=-n*(Z[0]-I),s=h*(Z[1]+U)),l=this.initRenderer(t,b,y.document,y.renderer),this._setARIA(t,y),(k=new Bt(t,l,y.id,[o,s],y.zoomfactor*y.zoomx,y.zoomfactor*y.zoomy,n,h,b.width,b.height,y)).keepaspectratio=y.keepaspectratio,this._fillBoard(k,y,b),k.suspendUpdate(),y.axis&&(O=typeof y.axis=="object"?y.axis:{},x=a.Z.deepCopy(it.Z.board.defaultAxes.x,O),D=a.Z.deepCopy(it.Z.board.defaultAxes.y,O),y.defaultaxes.x&&(x=a.Z.deepCopy(x,y.defaultaxes.x)),y.defaultaxes.y&&(D=a.Z.deepCopy(D,y.defaultaxes.y)),k.defaultAxes={},k.defaultAxes.x=k.create("axis",[[0,0],[1,0]],x),k.defaultAxes.y=k.create("axis",[[0,0],[0,1]],D)),y.grid&&k.create("grid",[],typeof y.grid=="object"?y.grid:{}),k.unsuspendUpdate(),k},loadBoardFromFile:function(t,e,o,s,n){var h,l,p,d,b;return s=s||{},h=this._setAttributes(s),d=N.Z.getDimensions(t,h.document),l=this.initRenderer(t,d,h.document,h.renderer),this._setARIA(t,h),p=new Bt(t,l,"",[150,150],1,1,50,50,d.width,d.height,h),this._fillBoard(p,h,d),b=h.encoding||"iso-8859-1",dt.parseFileContent(e,p,o,!0,b,n),p},loadBoardFromString:function(t,e,o,s,n){var h,l,p,d;return s=s||{},h=this._setAttributes(s),d=N.Z.getDimensions(t,h.document),l=this.initRenderer(t,d,h.document,h.renderer),this._setARIA(t,h),p=new Bt(t,l,"",[150,150],1,1,50,50,d.width,d.height,h),this._fillBoard(p,h,d),dt.parseString(e,p,o,!0,n),p},freeBoard:function(t){var e;for(e in typeof t=="string"&&(t=u.Z.boards[t]),this._removeARIANodes(t),t.removeEventHandlers(),t.suspendUpdate(),t.objects)t.objects.hasOwnProperty(e)&&t.objects[e].remove();for(;t.containerObj.firstChild;)t.containerObj.removeChild(t.containerObj.firstChild);for(e in t.objects)t.objects.hasOwnProperty(e)&&delete t.objects[e];delete t.renderer,t.jc.creator.clearCache(),delete t.jc,delete u.Z.boards[t.id]},registerElement:function(t,e){u.Z.deprecated("JXG.JSXGraph.registerElement()","JXG.registerElement()"),u.Z.registerElement(t,e)}},N.Z.isBrowser&&typeof window=="object"&&typeof document=="object"&&N.Z.addEvent(window,"load",function(){var t,e,o,s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J=!1,z=document.getElementsByTagName("script"),V=function($,nt,et){var lt=u.Z.JSXGraph.initBoard(n,{boundingbox:et,keepaspectratio:!0,grid:D,axis:x,showReload:!0});if(nt.toLowerCase().indexOf("script")>-1)lt.construct($);else try{lt.jc.parse($)}catch(ot){u.Z.debug(ot)}return lt},W=function($,nt,et,lt){return function(){var ot;u.Z.JSXGraph.freeBoard($),(ot=V(nt,et,lt)).reload=W(ot,nt,et,lt)}};for(e=0;e<z.length;e++)if(t=z[e].getAttribute("type",!1),a.Z.exists(t)&&(t.toLowerCase()==="text/jessiescript"||t.toLowerCase()==="jessiescript"||t.toLowerCase()==="text/jessiecode"||t.toLowerCase()==="jessiecode")){if(y=z[e].getAttribute("class",!1)||"",p=z[e].getAttribute("width",!1)||"",d=z[e].getAttribute("height",!1)||"",b=z[e].getAttribute("maxwidth",!1)||"100%",Z=z[e].getAttribute("aspectratio",!1)||"1/1",O=z[e].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",n=z[e].getAttribute("container",!1),I=z[e].getAttribute("src",!1),(O=O.split(",")).length!==4)O=[-5,5,5,-5];else for(o=0;o<O.length;o++)O[o]=parseFloat(O[o]);if(x=a.Z.str2Bool(z[e].getAttribute("axis",!1)||"false"),D=a.Z.str2Bool(z[e].getAttribute("grid",!1)||"false"),a.Z.exists(n))s=document.getElementById(n);else{n="jessiescript_autgen_jxg_"+e,(s=document.createElement("div")).setAttribute("id",n),l=p!==""?"width:"+p+";":"",l+=d!==""?"height:"+d+";":"",l+=b!==""?"max-width:"+b+";":"",l+=Z!==""?"aspect-ratio:"+Z+";":"",s.setAttribute("style",l),s.setAttribute("class","jxgbox "+y);try{document.body.insertBefore(s,z[e])}catch{typeof jQuery=="object"&&jQuery(s).insertBefore(z[e])}}k="",a.Z.exists(I)?(J=!0,(U=new XMLHttpRequest).open("GET",I),U.overrideMimeType("text/plain; charset=x-user-defined"),U.addEventListener("load",function(){if(!(this.status<400))throw new Error(`
JSXGraph: failed to load file`,I,":",this.responseText);k=this.responseText+`
`+k,(h=V(k,t,O)).reload=W(h,k,t,O)}),U.addEventListener("error",function($){throw new Error(`
JSXGraph: failed to load file`,I,":",$)}),U.send()):J=!1,document.getElementById(n)?(k=(k=z[e].innerHTML).replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),z[e].innerHTML=k,J||((h=V(k,t,O)).reload=W(h,k,t,O))):u.Z.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),u.Z.JSXGraph;var Gt=__webpack_require__(958),oe=__webpack_require__(218);u.Z.Point=function(t,e,o){this.constructor(t,o,S.Z.OBJECT_TYPE_POINT,S.Z.OBJECT_CLASS_POINT),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createGradient(),this.createLabel()},u.Z.Point.prototype=new Gt.Z,a.Z.copyPrototypeMethods(u.Z.Point,oe.Z,"coordsConstructor"),u.Z.extend(u.Z.Point.prototype,{hasPoint:function(t,e){var o,s,n,h=this.coords.scrCoords,l=a.Z.evaluate(this.visProp.sizeunit);return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(n=this.board._inputDevice,s=a.Z.evaluate(this.visProp.precision[n])):s=this.board.options.precision.hasPoint,o=parseFloat(a.Z.evaluate(this.visProp.size)),l==="user"&&(o*=Math.sqrt(this.board.unitX*this.board.unitY)),(o+=.5*parseFloat(a.Z.evaluate(this.visProp.strokewidth)))<s&&(o=s),Math.abs(h[1]-t)<o+2&&Math.abs(h[2]-e)<o+2},update:function(t){return this.needsUpdate?(this.updateCoords(t),a.Z.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateTransform:function(t){var e,o;if(this.transformations.length===0||this.baseElement===null)return this;for(this===this.baseElement?(e=this.transformations[0].apply(this.baseElement,"self"),this.coords.setCoordinates(S.Z.COORDS_BY_USER,e)):e=this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(S.Z.COORDS_BY_USER,e),o=1;o<this.transformations.length;o++)this.coords.setCoordinates(S.Z.COORDS_BY_USER,this.transformations[o].apply(this));return this},updateRenderer:function(){return this.updateRendererGeneric("updatePoint"),this},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},makeIntersection:function(t,e,o,s){var n;t=this.board.select(t),e=this.board.select(e),n=_.Z.intersectionFunction(this.board,t,e,o,s,this.visProp.alwaysintersect),this.addConstraint([n]);try{t.addChild(this),e.addChild(this)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof t+"' and '"+typeof e+"'.")}this.type=S.Z.OBJECT_TYPE_INTERSECTION,this.elType="intersection",this.parents=[t.id,e.id,o,s],this.generatePolynomial=function(){var h=t.generatePolynomial(this),l=e.generatePolynomial(this);return h.length===0||l.length===0?[]:[h[0],l[0]]},this.prepareUpdate().update()},setStyle:function(t){return this.visProp.face=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"][t],this.visProp.size=[2,3,4,1,2,3,4,2,3,4,2,3,4][t],this.board.renderer.changePointStyle(this),this},normalizeFace:function(t){return u.Z.deprecated("Point.normalizeFace()","JXG.normalizePointFace()"),it.Z.normalizePointFace(t)},face:function(t){u.Z.deprecated("Point.face()","Point.setAttribute()"),this.setAttribute({face:t})},size:function(t){u.Z.deprecated("Point.size()","Point.setAttribute()"),this.setAttribute({size:t})},isOn:function(t,e){var o,s;return e=e||B.Z.eps,a.Z.isPoint(t)?this.Dist(t)<e:t.elementClass===S.Z.OBJECT_CLASS_LINE?(t.elType!=="segment"||a.Z.evaluate(this.visProp.alwaysintersect)||(o=u.Z.Math.Geometry.projectCoordsToSegment(this.coords.usrCoords,t.point1.coords.usrCoords,t.point2.coords.usrCoords))[1]>=0&&o[1]<=1)&&_.Z.distPointLine(this.coords.usrCoords,t.stdform)<e:t.elementClass===S.Z.OBJECT_CLASS_CIRCLE?a.Z.evaluate(t.visProp.hasinnerpoints)?this.Dist(t.center)<t.Radius()+e:Math.abs(this.Dist(t.center)-t.Radius())<e:t.elementClass===S.Z.OBJECT_CLASS_CURVE?(s=_.Z.projectPointToCurve(this,t,this.board)[0],_.Z.distance(this.coords.usrCoords,s.usrCoords,3)<e):t.type===S.Z.OBJECT_TYPE_POLYGON?!(!a.Z.evaluate(t.visProp.hasinnerpoints)||!t.pnpoly(this.coords.usrCoords[1],this.coords.usrCoords[2],u.Z.COORDS_BY_USER))||(o=_.Z.projectCoordsToPolygon(this.coords.usrCoords,t),_.Z.distance(this.coords.usrCoords,o,3)<e):t.type===S.Z.OBJECT_TYPE_TURTLE&&(s=_.Z.projectPointToTurtle(this,t,this.board),_.Z.distance(this.coords.usrCoords,s.usrCoords,3)<e)},cloneToBackground:function(){var t={};return t.id=this.id+"T"+this.numTraces,this.numTraces+=1,t.coords=this.coords,t.visProp=a.Z.deepCopy(this.visProp,this.visProp.traceattributes,!0),t.visProp.layer=this.board.options.layer.trace,t.elementClass=S.Z.OBJECT_CLASS_POINT,t.board=this.board,a.Z.clearVisPropOld(t),t.visPropCalc={visible:a.Z.evaluate(t.visProp.visible)},this.board.renderer.drawPoint(t),this.traces[t.id]=t.rendNode,this}}),u.Z.createPoint=function(t,e,o){var s,n;if(n=a.Z.copyAttributes(o,t.options,"point"),!(s=oe.Z.create(u.Z.Point,t,e,n)))throw new Error("JSXGraph: Can't create point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return s},u.Z.createGlider=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"glider");return n=e.length===1?[0,0]:e.slice(0,2),(s=t.create("point",n,h)).makeGlider(e[e.length-1]),s},u.Z.createIntersectionPoint=function(t,e,o){var s,n,h,l,p,d,b=a.Z.copyAttributes(o,t.options,"intersection");e.push(0,0),n=t.select(e[0]),h=t.select(e[1]),p=e[2]||0,d=e[3]||0,s=t.create("point",[0,0,0],b),l=_.Z.intersectionFunction(t,n,h,p,d,s.visProp.alwaysintersect),s.addConstraint([l]);try{n.addChild(s),h.addChild(s)}catch{throw new Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'.")}return s.type=S.Z.OBJECT_TYPE_INTERSECTION,s.elType="intersection",s.setParents([n.id,h.id]),s.intersectionNumbers=[p,d],s.getParents=function(){return this.parents.concat(this.intersectionNumbers)},s.generatePolynomial=function(){var Z=n.generatePolynomial(s),y=h.generatePolynomial(s);return Z.length===0||y.length===0?[]:[Z[0],y[0]]},s},u.Z.createOtherIntersectionPoint=function(t,e,o){var s,n,h,l;if(e.length!==3||!a.Z.isPoint(e[2])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[0].elementClass!==S.Z.OBJECT_CLASS_CIRCLE||e[1].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[1].elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof e[0]+"',  '"+typeof e[1]+"'and  '"+typeof e[2]+`'.
Possible parent types: [circle|line,circle|line,point]`);return n=t.select(e[0]),h=t.select(e[1]),l=t.select(e[2]),(s=t.create("point",[function(){var p=_.Z.meet(n.stdform,h.stdform,0,n.board);return Math.abs(l.X()-p.usrCoords[1])>B.Z.eps||Math.abs(l.Y()-p.usrCoords[2])>B.Z.eps||Math.abs(l.Z()-p.usrCoords[0])>B.Z.eps?p:_.Z.meet(n.stdform,h.stdform,1,n.board)}],o)).type=S.Z.OBJECT_TYPE_INTERSECTION,s.elType="otherintersection",s.setParents([n.id,h.id,l]),n.addChild(s),h.addChild(s),s.generatePolynomial=function(){var p=n.generatePolynomial(s),d=h.generatePolynomial(s);return p.length===0||d.length===0?[]:[p[0],d[0]]},s},u.Z.createPolePoint=function(t,e,o){var s,n,h,l,p,d,b;if(e.length>1&&(l=e[0].type===S.Z.OBJECT_TYPE_CONIC||e[0].elementClass===S.Z.OBJECT_CLASS_CIRCLE,p=e[1].type===S.Z.OBJECT_TYPE_CONIC||e[1].elementClass===S.Z.OBJECT_CLASS_CIRCLE,d=e[0].elementClass===S.Z.OBJECT_CLASS_LINE,b=e[1].elementClass===S.Z.OBJECT_CLASS_LINE),e.length!==2||!(l&&b||d&&p))throw new Error("JSXGraph: Can't create 'pole point' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent type: [conic|circle,line], [line,conic|circle]`);return b?(n=t.select(e[0]),h=t.select(e[1])):(n=t.select(e[1]),h=t.select(e[0])),(s=t.create("point",[function(){var Z=n.quadraticform,y=h.stdform.slice(0,3);return[u.Z.Math.Numerics.det([y,Z[1],Z[2]]),u.Z.Math.Numerics.det([Z[0],y,Z[2]]),u.Z.Math.Numerics.det([Z[0],Z[1],y])]}],o)).elType="polepoint",s.setParents([n.id,h.id]),n.addChild(s),h.addChild(s),s},u.Z.registerElement("point",u.Z.createPoint),u.Z.registerElement("glider",u.Z.createGlider),u.Z.registerElement("intersection",u.Z.createIntersectionPoint),u.Z.registerElement("otherintersection",u.Z.createOtherIntersectionPoint),u.Z.registerElement("polepoint",u.Z.createPolePoint);const _e=u.Z.Point;u.Z.Line=function(t,e,o,s){this.constructor(t,s,S.Z.OBJECT_TYPE_LINE,S.Z.OBJECT_CLASS_LINE),this.point1=this.board.select(e),this.point2=this.board.select(o),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1._is_new?(this.addChild(this.point1),delete this.point1._is_new):this.point1.addChild(this),this.point2._is_new?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this),this.inherits.push(this.point1,this.point2),this.updateStdform(),this.createLabel(),this.methodMap=u.Z.deepCopy(this.methodMap,{point1:"point1",point2:"point2",getSlope:"getSlope",getRise:"getRise",getYIntersect:"getRise",getAngle:"getAngle",L:"L",length:"L"})},u.Z.Line.prototype=new Gt.Z,u.Z.extend(u.Z.Line.prototype,{hasPoint:function(t,e){var o,s,n,h,l,p,d,b,Z,y=[],O=[1,t,e],x=a.Z.evaluate(this.visProp.strokewidth);return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(Z=this.board._inputDevice,b=a.Z.evaluate(this.visProp.precision[Z])):b=this.board.options.precision.hasPoint,b+=.5*x,y[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,y[1]=this.stdform[1]/this.board.unitX,y[2]=this.stdform[2]/-this.board.unitY,o=_.Z.distPointLine(O,y),!(isNaN(o)||o>b)&&(!(!a.Z.evaluate(this.visProp.straightfirst)||!a.Z.evaluate(this.visProp.straightlast))||(n=this.point1.coords,h=this.point2.coords,s=[0,y[1],y[2]],s=B.Z.crossProduct(s,O),(s=B.Z.crossProduct(s,y))[1]/=s[0],s[2]/=s[0],s[0]=1,s=new m.Z(S.Z.COORDS_BY_SCREEN,s.slice(1),this.board).usrCoords,l=n.distance(S.Z.COORDS_BY_USER,h),n=n.usrCoords.slice(0),h=h.usrCoords.slice(0),l<B.Z.eps?p=0:(l===Number.POSITIVE_INFINITY&&(l=1/B.Z.eps,Math.abs(h[0])<B.Z.eps?(l/=_.Z.distance([0,0,0],h),h=[1,n[1]+h[1]*l,n[2]+h[2]*l]):(l/=_.Z.distance([0,0,0],n),n=[1,h[1]+n[1]*l,h[2]+n[2]*l])),l=h[d=1]-n[d],Math.abs(l)<B.Z.eps&&(l=h[d=2]-n[d]),p=(s[d]-n[d])/l),!(!a.Z.evaluate(this.visProp.straightfirst)&&p<0)&&!(!a.Z.evaluate(this.visProp.straightlast)&&p>1)))},update:function(){var t;return this.needsUpdate?(this.constrained&&(a.Z.isFunction(this.funps)?(t=this.funps())&&t.length&&t.length===2&&(this.point1=t[0],this.point2=t[1]):(a.Z.isFunction(this.funp1)&&(t=this.funp1(),a.Z.isPoint(t)?this.point1=t:t&&t.length&&t.length===2&&this.point1.setPositionDirectly(S.Z.COORDS_BY_USER,t)),a.Z.isFunction(this.funp2)&&(t=this.funp2(),a.Z.isPoint(t)?this.point2=t:t&&t.length&&t.length===2&&this.point2.setPositionDirectly(S.Z.COORDS_BY_USER,t)))),this.updateSegmentFixedLength(),this.updateStdform(),a.Z.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var t,e,o,s,n,h,l,p;return this.hasFixedLength?(t=this.point1.Dist(this.point2),e=this.fixedLength(),o=this.fixedLengthOldCoords[0].distance(S.Z.COORDS_BY_USER,this.point1.coords),s=this.fixedLengthOldCoords[1].distance(S.Z.COORDS_BY_USER,this.point2.coords),(o>B.Z.eps||s>B.Z.eps||t!==e)&&(n=this.point1.isDraggable&&this.point1.type!==S.Z.OBJECT_TYPE_GLIDER&&!a.Z.evaluate(this.point1.visProp.fixed),h=this.point2.isDraggable&&this.point2.type!==S.Z.OBJECT_TYPE_GLIDER&&!a.Z.evaluate(this.point2.visProp.fixed),t>B.Z.eps?o>s&&h||o<=s&&h&&!n?(this.point2.setPositionDirectly(S.Z.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*e/t,this.point1.Y()+(this.point2.Y()-this.point1.Y())*e/t]),this.point2.fullUpdate()):(o<=s&&n||o>s&&n&&!h)&&(this.point1.setPositionDirectly(S.Z.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*e/t,this.point2.Y()+(this.point1.Y()-this.point2.Y())*e/t]),this.point1.fullUpdate()):(l=Math.random()-.5,p=Math.random()-.5,t=Math.sqrt(l*l+p*p),h?(this.point2.setPositionDirectly(S.Z.COORDS_BY_USER,[this.point1.X()+l*e/t,this.point1.Y()+p*e/t]),this.point2.fullUpdate()):n&&(this.point1.setPositionDirectly(S.Z.COORDS_BY_USER,[this.point2.X()+l*e/t,this.point2.Y()+p*e/t]),this.point1.fullUpdate())),this.fixedLengthOldCoords[0].setCoordinates(S.Z.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(S.Z.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var t=B.Z.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=t[0],this.stdform[1]=t[1],this.stdform[2]=t[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&B.Z.innerProduct(this.stdform,this.stdform,3)>=B.Z.eps*B.Z.eps,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateLine(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},generatePolynomial:function(t){var e=this.point1.symbolic.x,o=this.point1.symbolic.y,s=this.point2.symbolic.x,n=this.point2.symbolic.y,h=t.symbolic.x,l=t.symbolic.y;return[["(",o,")*(",h,")-(",o,")*(",s,")+(",l,")*(",s,")-(",e,")*(",l,")+(",e,")*(",n,")-(",h,")*(",n,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=B.Z.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=B.Z.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(-this.stdform[1],this.stdform[2])},setStraight:function(t,e){return this.visProp.straightfirst=t,this.visProp.straightlast=e,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new m.Z(S.Z.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(t){a.Z.exists(this.label)&&(this.label.relativeCoords=new m.Z(S.Z.COORDS_BY_SCREEN,[t[0],-t[1]],this.board))},getLabelAnchor:function(){var t,e,o=0,s=new m.Z(S.Z.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),n=new m.Z(S.Z.COORDS_BY_USER,this.point2.coords.usrCoords,this.board),h=a.Z.evaluate(this.visProp.straightfirst),l=a.Z.evaluate(this.visProp.straightlast);if((h||l)&&_.Z.calcStraight(this,s,n,0),s=s.scrCoords,n=n.scrCoords,!a.Z.exists(this.label))return new m.Z(S.Z.COORDS_BY_SCREEN,[NaN,NaN],this.board);switch(a.Z.evaluate(this.label.visProp.position)){case"last":t=n[1],e=n[2];break;case"first":t=s[1],e=s[2];break;case"lft":case"llft":case"ulft":s[1]<=n[1]?(t=s[1],e=s[2]):(t=n[1],e=n[2]);break;case"rt":case"lrt":case"urt":s[1]>n[1]?(t=s[1],e=s[2]):(t=n[1],e=n[2]);break;default:t=.5*(s[1]+n[1]),e=.5*(s[2]+n[2])}return(h||l)&&(a.Z.exists(this.label)&&(o=a.Z.evaluate(this.label.visProp.fontsize)),Math.abs(t)<B.Z.eps?t=o:this.board.canvasWidth+B.Z.eps>t&&t>this.board.canvasWidth-o-B.Z.eps&&(t=this.board.canvasWidth-o),B.Z.eps+o>e&&e>-B.Z.eps?e=o:this.board.canvasHeight+B.Z.eps>e&&e>this.board.canvasHeight-o-B.Z.eps&&(e=this.board.canvasHeight-o)),new m.Z(S.Z.COORDS_BY_SCREEN,[t,e],this.board)},cloneToBackground:function(){var t,e,o,s={};return s.id=this.id+"T"+this.numTraces,s.elementClass=S.Z.OBJECT_CLASS_LINE,this.numTraces++,s.point1=this.point1,s.point2=this.point2,s.stdform=this.stdform,s.board=this.board,s.visProp=a.Z.deepCopy(this.visProp,this.visProp.traceattributes,!0),s.visProp.layer=this.board.options.layer.trace,a.Z.clearVisPropOld(s),s.visPropCalc={visible:a.Z.evaluate(s.visProp.visible)},e=this.getSlope(),t=this.getRise(),s.getSlope=function(){return e},s.getRise=function(){return t},o=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(s),this.board.renderer.enhancedRendering=o,this.traces[s.id]=s.rendNode,this},addTransform:function(t){var e,o=a.Z.isArray(t)?t:[t],s=o.length;for(e=0;e<s;e++)this.point1.transformations.push(o[e]),this.point2.transformations.push(o[e]);return this},snapToGrid:function(t){var e,o,s,n,h,l,p,d;return a.Z.evaluate(this.visProp.snaptogrid)?this.parents.length<3?(this.point1.handleSnapToGrid(!0,!0),this.point2.handleSnapToGrid(!0,!0)):a.Z.exists(t)&&(p=a.Z.evaluate(this.visProp.snapsizex),d=a.Z.evaluate(this.visProp.snapsizey),h=(e=new m.Z(S.Z.COORDS_BY_SCREEN,[t.Xprev,t.Yprev],this.board)).usrCoords[1],l=e.usrCoords[2],p<=0&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(p=(n=this.board.defaultAxes.x.defaultTicks).ticksDelta*(a.Z.evaluate(n.visProp.minorticks)+1)),d<=0&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(d=(n=this.board.defaultAxes.y.defaultTicks).ticksDelta*(a.Z.evaluate(n.visProp.minorticks)+1)),p>0&&d>0&&(o=_.Z.projectPointToLine({coords:e},this,this.board),s=v.Z.subtract([1,Math.round(h/p)*p,Math.round(l/d)*d],o.usrCoords),this.board.create("transform",s.slice(1),{type:"translate"}).applyOnce([this.point1,this.point2]))):(this.point1.handleSnapToGrid(!1,!0),this.point2.handleSnapToGrid(!1,!0)),this},snapToPoints:function(){var t=a.Z.evaluate(this.visProp.snaptopoints);return this.parents.length<3&&(this.point1.handleSnapToPoints(t),this.point2.handleSnapToPoints(t)),this},X:function(t){var e,o=this.stdform[2];return e=Math.abs(this.point1.coords.usrCoords[0])>B.Z.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],t=2*(t-.5),(1-Math.abs(t))*e-t*o},Y:function(t){var e,o=this.stdform[1];return e=Math.abs(this.point1.coords.usrCoords[0])>B.Z.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],t=2*(t-.5),(1-Math.abs(t))*e+t*o},Z:function(t){var e=Math.abs(this.point1.coords.usrCoords[0])>B.Z.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return t=2*(t-.5),(1-Math.abs(t))*e},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var t=this.point1.coords.usrCoords,e=this.point2.coords.usrCoords;return[Math.min(t[1],e[1]),Math.max(t[2],e[2]),Math.max(t[1],e[1]),Math.min(t[2],e[2])]},remove:function(){this.removeAllTicks(),Gt.Z.prototype.remove.call(this)}}),u.Z.createLine=function(t,e,o){var s,n,h,l,p,d,b,Z=[],y=!1,O=!1;if(e.length===2){if(a.Z.isArray(e[0])&&e[0].length>1)d=a.Z.copyAttributes(o,t.options,"line","point1"),h=t.create("point",e[0],d);else if(a.Z.isString(e[0])||a.Z.isPoint(e[0]))h=t.select(e[0]);else if(a.Z.isFunction(e[0])&&a.Z.isPoint(e[0]()))h=e[0](),O=!0;else if(a.Z.isFunction(e[0])&&e[0]().length&&e[0]().length>=2)d=a.Z.copyAttributes(o,t.options,"line","point1"),h=u.Z.createPoint(t,e[0](),d),O=!0;else{if(!a.Z.isObject(e[0])||!a.Z.isTransformationOrArray(e[1]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);y=!0,d=a.Z.copyAttributes(o,t.options,"line","point1"),h=t.create("point",[e[0].point1,e[1]],d)}if(y)d=a.Z.copyAttributes(o,t.options,"line","point2"),l=t.create("point",[e[0].point2,e[1]],d);else if(a.Z.isArray(e[1])&&e[1].length>1)d=a.Z.copyAttributes(o,t.options,"line","point2"),l=t.create("point",e[1],d);else if(a.Z.isString(e[1])||a.Z.isPoint(e[1]))l=t.select(e[1]);else if(a.Z.isFunction(e[1])&&a.Z.isPoint(e[1]()))l=e[1](),O=!0;else{if(!(a.Z.isFunction(e[1])&&e[1]().length&&e[1]().length>=2))throw new Error("JSXGraph: Can't create line with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);d=a.Z.copyAttributes(o,t.options,"line","point2"),l=u.Z.createPoint(t,e[1](),d),O=!0}d=a.Z.copyAttributes(o,t.options,"line"),n=new u.Z.Line(t,h,l,d),O?(n.constrained=!0,n.funp1=e[0],n.funp2=e[1]):y||(n.isDraggable=!0),n.setParents([h.id,l.id])}else if(e.length===3){for(b=!0,p=0;p<3;p++)if(a.Z.isNumber(e[p]))Z[p]=a.Z.createFunction(e[p]);else{if(!a.Z.isFunction(e[p]))throw new Error("JSXGraph: Can't create line with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);Z[p]=e[p],b=!1}d=a.Z.copyAttributes(o,t.options,"line","point1"),h=b?t.create("point",[Z[2]()*Z[2]()+Z[1]()*Z[1](),Z[2]()-Z[1]()*Z[0]()+Z[2](),-Z[1]()-Z[2]()*Z[0]()-Z[1]()],d):t.create("point",[function(){return .5*(Z[2]()*Z[2]()+Z[1]()*Z[1]())},function(){return .5*(Z[2]()-Z[1]()*Z[0]()+Z[2]())},function(){return .5*(-Z[1]()-Z[2]()*Z[0]()-Z[1]())}],d),d=a.Z.copyAttributes(o,t.options,"line","point2"),l=b?t.create("point",[Z[2]()*Z[2]()+Z[1]()*Z[1](),-Z[1]()*Z[0]()+Z[2](),-Z[2]()*Z[0]()-Z[1]()],d):t.create("point",[function(){return Z[2]()*Z[2]()+Z[1]()*Z[1]()},function(){return-Z[1]()*Z[0]()+Z[2]()},function(){return-Z[2]()*Z[0]()-Z[1]()}],d),h.prepareUpdate().update(),l.prepareUpdate().update(),d=a.Z.copyAttributes(o,t.options,"line"),(n=new u.Z.Line(t,h,l,d)).isDraggable=b,n.setParents([h,l])}else if(e.length===1&&a.Z.isFunction(e[0])&&e[0]().length===2&&a.Z.isPoint(e[0]()[0])&&a.Z.isPoint(e[0]()[1]))s=e[0](),d=a.Z.copyAttributes(o,t.options,"line"),(n=new u.Z.Line(t,s[0],s[1],d)).constrained=!0,n.funps=e[0],n.setParents(s);else{if(!(e.length===1&&a.Z.isFunction(e[0])&&e[0]().length===3&&a.Z.isNumber(e[0]()[0])&&a.Z.isNumber(e[0]()[1])&&a.Z.isNumber(e[0]()[2])))throw new Error("JSXGraph: Can't create line with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]`);s=e[0],d=a.Z.copyAttributes(o,t.options,"line","point1"),h=t.create("point",[function(){var x=s();return[.5*(x[2]*x[2]+x[1]*x[1]),.5*(x[2]-x[1]*x[0]+x[2]),.5*(-x[1]-x[2]*x[0]-x[1])]}],d),d=a.Z.copyAttributes(o,t.options,"line","point2"),l=t.create("point",[function(){var x=s();return[x[2]*x[2]+x[1]*x[1],-x[1]*x[0]+x[2],-x[2]*x[0]-x[1]]}],d),d=a.Z.copyAttributes(o,t.options,"line"),(n=new u.Z.Line(t,h,l,d)).constrained=!0,n.funps=e[0],n.setParents([h,l])}return n},u.Z.registerElement("line",u.Z.createLine),u.Z.createSegment=function(t,e,o){var s,n;if(o.straightFirst=!1,o.straightLast=!1,n=a.Z.copyAttributes(o,t.options,"segment"),s=t.create("line",e.slice(0,2),n),e.length===3){if(s.hasFixedLength=!0,a.Z.isNumber(e[2]))s.fixedLength=function(){return e[2]};else{if(!a.Z.isFunction(e[2]))throw new Error("JSXGraph: Can't create segment with third parent type '"+typeof e[2]+`'.
Possible third parent types: number or function`);s.fixedLength=e[2]}s.getParents=function(){return this.parents.concat(this.fixedLength())},s.fixedLengthOldCoords=[],s.fixedLengthOldCoords[0]=new m.Z(S.Z.COORDS_BY_USER,s.point1.coords.usrCoords.slice(1,3),t),s.fixedLengthOldCoords[1]=new m.Z(S.Z.COORDS_BY_USER,s.point2.coords.usrCoords.slice(1,3),t)}return s.elType="segment",s},u.Z.registerElement("segment",u.Z.createSegment),u.Z.createArrow=function(t,e,o){var s,n;return o.straightFirst=!1,o.straightLast=!1,n=a.Z.copyAttributes(o,t.options,"arrow"),(s=t.create("line",e,n)).type=S.Z.OBJECT_TYPE_VECTOR,s.elType="arrow",s},u.Z.registerElement("arrow",u.Z.createArrow),u.Z.createAxis=function(t,e,o){var s,n,h,l,p;if(!a.Z.isArray(e[0])&&!a.Z.isPoint(e[0])||!a.Z.isArray(e[1])&&!a.Z.isPoint(e[1]))throw new Error("JSXGraph: Can't create axis with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);for(l in s=a.Z.copyAttributes(o,t.options,"axis"),(h=t.create("line",e,s)).type=S.Z.OBJECT_TYPE_AXIS,h.isDraggable=!1,h.point1.isDraggable=!1,h.point2.isDraggable=!1,h.ancestors)h.ancestors.hasOwnProperty(l)&&(h.ancestors[l].type=S.Z.OBJECT_TYPE_AXISPOINT);return n=a.Z.copyAttributes(o,t.options,"axis","ticks"),p=a.Z.exists(n.ticksdistance)?n.ticksdistance:a.Z.isArray(n.ticks)?n.ticks:1,h.defaultTicks=t.create("ticks",[h,p],n),h.defaultTicks.dump=!1,h.elType="axis",h.subs={ticks:h.defaultTicks},h.inherits.push(h.defaultTicks),h},u.Z.registerElement("axis",u.Z.createAxis),u.Z.createTangent=function(t,e,o){var s,n,h,l,p;if(e.length===1)s=e[0],n=s.slideObject;else{if(e.length!==2)throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);if(a.Z.isPoint(e[0]))s=e[0],n=e[1];else{if(!a.Z.isPoint(e[1]))throw new Error("JSXGraph: Can't create tangent with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [glider], [point,line|curve|circle|conic]`);n=e[0],s=e[1]}}if(n.elementClass===S.Z.OBJECT_CLASS_LINE?(p=t.create("line",[n.point1,n.point2],o)).glider=s:n.elementClass===S.Z.OBJECT_CLASS_CURVE&&n.type!==S.Z.OBJECT_TYPE_CONIC?a.Z.evaluate(n.visProp.curvetype)!=="plot"?(p=t.create("line",[function(){var d=n.X,b=n.Y;return-s.X()*c.Z.D(b)(s.position)+s.Y()*c.Z.D(d)(s.position)},function(){return c.Z.D(n.Y)(s.position)},function(){return-c.Z.D(n.X)(s.position)}],o),s.addChild(p),p.glider=s):(p=t.create("line",[function(){var d,b,Z,y,O,x,D,k,I,U,J=Math.floor(s.position);if(n.bezierDegree===1)J===n.numberPoints-1&&J--;else{if(n.bezierDegree!==3)return 0;J=3*Math.floor(s.position*(n.numberPoints-1)/3),Z=(s.position*(n.numberPoints-1)-J)/3,J>=n.numberPoints-1&&(J=n.numberPoints-4,Z=1)}return J<0?1:(n.bezierDegree===1?(d=n.points[J].usrCoords,b=n.points[J+1].usrCoords):(y=n.points[J].usrCoords,O=n.points[J+1].usrCoords,x=n.points[J+2].usrCoords,D=n.points[J+3].usrCoords,k=(1-Z)*(1-Z)*(O[1]-y[1])+2*(1-Z)*Z*(x[1]-O[1])+Z*Z*(D[1]-x[1]),I=(1-Z)*(1-Z)*(O[2]-y[2])+2*(1-Z)*Z*(x[2]-O[2])+Z*Z*(D[2]-x[2]),k/=U=Math.sqrt(k*k+I*I),I/=U,b=[1,(d=s.coords.usrCoords)[1]+k,d[2]+I]),d[2]*b[1]-d[1]*b[2])},function(){var d,b,Z,y,O,x,D,k,I,U,J=Math.floor(s.position);if(n.bezierDegree===1)J===n.numberPoints-1&&J--;else{if(n.bezierDegree!==3)return 0;J=3*Math.floor(s.position*(n.numberPoints-1)/3),Z=(s.position*(n.numberPoints-1)-J)/3,J>=n.numberPoints-1&&(J=n.numberPoints-4,Z=1)}return J<0?0:(n.bezierDegree===1?(d=n.points[J].usrCoords,b=n.points[J+1].usrCoords):(y=n.points[J].usrCoords,O=n.points[J+1].usrCoords,x=n.points[J+2].usrCoords,D=n.points[J+3].usrCoords,k=(1-Z)*(1-Z)*(O[1]-y[1])+2*(1-Z)*Z*(x[1]-O[1])+Z*Z*(D[1]-x[1]),I=(1-Z)*(1-Z)*(O[2]-y[2])+2*(1-Z)*Z*(x[2]-O[2])+Z*Z*(D[2]-x[2]),k/=U=Math.sqrt(k*k+I*I),I/=U,b=[1,(d=s.coords.usrCoords)[1]+k,d[2]+I]),b[2]-d[2])},function(){var d,b,Z,y,O,x,D,k,I,U,J=Math.floor(s.position);if(n.bezierDegree===1)J===n.numberPoints-1&&J--;else{if(n.bezierDegree!==3)return 0;J=3*Math.floor(s.position*(n.numberPoints-1)/3),Z=(s.position*(n.numberPoints-1)-J)/3,J>=n.numberPoints-1&&(J=n.numberPoints-4,Z=1)}return J<0?0:(n.bezierDegree===1?(d=n.points[J].usrCoords,b=n.points[J+1].usrCoords):(y=n.points[J].usrCoords,O=n.points[J+1].usrCoords,x=n.points[J+2].usrCoords,D=n.points[J+3].usrCoords,k=(1-Z)*(1-Z)*(O[1]-y[1])+2*(1-Z)*Z*(x[1]-O[1])+Z*Z*(D[1]-x[1]),I=(1-Z)*(1-Z)*(O[2]-y[2])+2*(1-Z)*Z*(x[2]-O[2])+Z*Z*(D[2]-x[2]),k/=U=Math.sqrt(k*k+I*I),I/=U,b=[1,(d=s.coords.usrCoords)[1]+k,d[2]+I]),d[1]-b[1])}],o),s.addChild(p),p.glider=s):n.type===S.Z.OBJECT_TYPE_TURTLE?(p=t.create("line",[function(){var d=Math.floor(s.position);for(h=0;h<n.objects.length;h++)if((l=n.objects[h]).type===S.Z.OBJECT_TYPE_CURVE){if(d<l.numberPoints)break;d-=l.numberPoints}return d===l.numberPoints-1&&d--,d<0?1:l.Y(d)*l.X(d+1)-l.X(d)*l.Y(d+1)},function(){var d=Math.floor(s.position);for(h=0;h<n.objects.length;h++)if((l=n.objects[h]).type===S.Z.OBJECT_TYPE_CURVE){if(d<l.numberPoints)break;d-=l.numberPoints}return d===l.numberPoints-1&&d--,d<0?0:l.Y(d+1)-l.Y(d)},function(){var d=Math.floor(s.position);for(h=0;h<n.objects.length;h++)if((l=n.objects[h]).type===S.Z.OBJECT_TYPE_CURVE){if(d<l.numberPoints)break;d-=l.numberPoints}return d===l.numberPoints-1&&d--,d<0?0:l.X(d)-l.X(d+1)}],o),s.addChild(p),p.glider=s):n.elementClass!==S.Z.OBJECT_CLASS_CIRCLE&&n.type!==S.Z.OBJECT_TYPE_CONIC||(p=t.create("line",[function(){return B.Z.matVecMult(n.quadraticform,s.coords.usrCoords)[0]},function(){return B.Z.matVecMult(n.quadraticform,s.coords.usrCoords)[1]},function(){return B.Z.matVecMult(n.quadraticform,s.coords.usrCoords)[2]}],o),s.addChild(p),p.glider=s),!a.Z.exists(p))throw new Error("JSXGraph: Couldn't create tangent with the given parents.");return p.elType="tangent",p.type=S.Z.OBJECT_TYPE_TANGENT,p.setParents(e),p},u.Z.createRadicalAxis=function(t,e,o){var s,n,h;if(e.length!==2||e[0].elementClass!==S.Z.OBJECT_CLASS_CIRCLE||e[1].elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create 'radical axis' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent type: [circle,circle]`);return n=t.select(e[0]),h=t.select(e[1]),(s=t.create("line",[function(){var l=n.stdform,p=h.stdform;return B.Z.matVecMult(B.Z.transpose([l.slice(0,3),p.slice(0,3)]),[p[3],-l[3]])}],o)).elType="radicalaxis",s.setParents([n.id,h.id]),n.addChild(s),h.addChild(s),s},u.Z.createPolarLine=function(t,e,o){var s,n,h,l,p,d,b;if(e.length>1&&(l=e[0].type===S.Z.OBJECT_TYPE_CONIC||e[0].elementClass===S.Z.OBJECT_CLASS_CIRCLE,p=e[1].type===S.Z.OBJECT_TYPE_CONIC||e[1].elementClass===S.Z.OBJECT_CLASS_CIRCLE,d=a.Z.isPoint(e[0]),b=a.Z.isPoint(e[1])),e.length!==2||!(l&&b||d&&p))throw new Error("JSXGraph: Can't create 'polar line' with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent type: [conic|circle,point], [point,conic|circle]`);return b?(n=t.select(e[0]),h=t.select(e[1])):(n=t.select(e[1]),h=t.select(e[0])),(s=t.create("tangent",[n,h],o)).elType="polarline",s},u.Z.registerElement("tangent",u.Z.createTangent),u.Z.registerElement("polar",u.Z.createTangent),u.Z.registerElement("radicalaxis",u.Z.createRadicalAxis),u.Z.registerElement("polarline",u.Z.createPolarLine),u.Z.Line,u.Z.Group=function(t,e,o,s,n){var h,l,p,d;for(this.board=t,this.objects={},h=this.board.numObjects,this.board.numObjects+=1,e!==""&&a.Z.exists(e)?this.id=e:this.id=this.board.id+"Group"+h,this.board.groups[this.id]=this,this.type=S.Z.OBJECT_TYPE_POINT,this.elementClass=S.Z.OBJECT_CLASS_POINT,o!==""&&a.Z.exists(o)?this.name=o:this.name="group_"+this.board.generateName(this),delete this.type,this.coords={},this.needsRegularUpdate=n.needsregularupdate,this.rotationCenter="centroid",this.scaleCenter=null,this.rotationPoints=[],this.translationPoints=[],this.scalePoints=[],this.scaleDirections={},this.parents=[],l=a.Z.isArray(s)?s:Array.prototype.slice.call(arguments,3),p=0;p<l.length;p++)d=this.board.select(l[p]),!a.Z.evaluate(d.visProp.fixed)&&a.Z.exists(d.coords)&&this.addPoint(d);this.methodMap={ungroup:"ungroup",add:"addPoint",addPoint:"addPoint",addPoints:"addPoints",addGroup:"addGroup",remove:"removePoint",removePoint:"removePoint",setAttribute:"setAttribute",setProperty:"setAttribute"}},u.Z.extend(u.Z.Group.prototype,{ungroup:function(){var t,e,o;for(t in this.objects)this.objects.hasOwnProperty(t)&&(e=this.objects[t].point,a.Z.isArray(e.groups)&&(o=a.Z.indexOf(e.groups,this.id))>=0&&delete e.groups[o]);return this.objects={},this},addParents:function(t){var e,o,s;for(o=(s=a.Z.isArray(t)?t:arguments).length,e=0;e<o;++e)a.Z.isId(this.board,s[e])?this.parents.push(s[e]):a.Z.exists(s[e].id)&&this.parents.push(s[e].id);this.parents=a.Z.uniqueArray(this.parents)},setParents:function(t){return this.parents=[],this.addParents(t),this},getParents:function(){return a.Z.isArray(this.parents)?this.parents:[]},_updateCoordsCache:function(t){var e;t!==""&&a.Z.exists(this.objects[t])&&(e=this.objects[t].point,this.coords[e.id]={usrCoords:e.coords.usrCoords.slice(0)})},update:function(){var t,e,o,s,n,h,l,p,d,b,Z=null;if(!this.needsUpdate)return this;if((t=this._update_find_drag_type()).action==="nothing")return this._updateCoordsCache(t.id),this;if(Z=this.objects[t.id].point,t.action==="translation")d=[Z.coords.usrCoords[1]-this.coords[t.id].usrCoords[1],Z.coords.usrCoords[2]-this.coords[t.id].usrCoords[2]];else if(t.action==="rotation"||t.action==="scaling"){if(o=t.action==="rotation"?"rotationCenter":"scaleCenter",a.Z.isPoint(this[o]))b=this[o].coords.usrCoords.slice(1);else if(this[o]==="centroid")b=this._update_centroid_center();else if(a.Z.isArray(this[o]))b=this[o];else{if(!a.Z.isFunction(this[o]))return this;b=this[o]()}if(t.action==="rotation")p=_.Z.rad(this.coords[t.id].usrCoords.slice(1),b,this.objects[t.id].point),(d=this.board.create("transform",[p,b[0],b[1]],{type:"rotate"})).update();else{if(t.action!=="scaling")return this;if(n=_.Z.distance(this.coords[t.id].usrCoords.slice(1),b),Math.abs(n)<B.Z.eps)return this;n=_.Z.distance(Z.coords.usrCoords.slice(1),b)/n,h=this.scaleDirections[t.id].indexOf("x")>=0?n:1,l=this.scaleDirections[t.id].indexOf("y")>=0?n:1,(d=this.board.create("transform",[1,0,0,b[0]*(1-h),h,0,b[1]*(1-l),0,l],{type:"generic"})).update()}}for(e in this._update_apply_transformation(t,d),this.needsUpdate=!1,this.objects)if(this.objects.hasOwnProperty(e))for(s in this.objects[e].descendants)this.objects[e].descendants.hasOwnProperty(s)&&(this.objects[e].descendants.needsUpdate=this.objects[e].descendants.needsRegularUpdate||this.board.needsFullUpdate);for(e in this.board.updateElements(t),this.objects)this.objects.hasOwnProperty(e)&&this._updateCoordsCache(e);return this},_update_find_drag_type:function(){var t,e,o,s="nothing",n=[];for(t in this.objects)this.objects.hasOwnProperty(t)&&(e=this.objects[t].point).coords.distance(S.Z.COORDS_BY_USER,this.coords[t])>B.Z.eps&&n.push(e.id);return n.length===0?{action:s,id:"",changed:n}:(o=n[0],e=this.objects[o].point,n.length>1?s="translation":a.Z.isInArray(this.rotationPoints,e)&&a.Z.exists(this.rotationCenter)?s="rotation":a.Z.isInArray(this.scalePoints,e)&&a.Z.exists(this.scaleCenter)?s="scaling":a.Z.isInArray(this.translationPoints,e)&&(s="translation"),{action:s,id:o,changed:n})},_update_centroid_center:function(){var t,e,o;for(o in t=[0,0],e=0,this.coords)this.coords.hasOwnProperty(o)&&(t[0]+=this.coords[o].usrCoords[1],t[1]+=this.coords[o].usrCoords[2],++e);return e>0&&(t[0]/=e,t[1]/=e),t},_update_apply_transformation:function(t,e){var o,s;for(o in this.objects)this.objects.hasOwnProperty(o)&&(a.Z.exists(this.board.objects[o])?(s=this.objects[o].point).id!==t.id?t.action==="translation"?a.Z.isInArray(t.changed,s.id)||s.coords.setCoordinates(S.Z.COORDS_BY_USER,[this.coords[o].usrCoords[1]+e[0],this.coords[o].usrCoords[2]+e[1]]):t.action!=="rotation"&&t.action!=="scaling"||e.applyOnce([s]):t.action!=="rotation"&&t.action!=="scaling"||s.coords.setCoordinates(S.Z.COORDS_BY_USER,B.Z.matVecMult(e.matrix,this.coords[s.id].usrCoords)):delete this.objects[o])},addPoint:function(t){return this.objects[t.id]={point:this.board.select(t)},this._updateCoordsCache(t.id),this.translationPoints.push(t),t.groups.push(this.id),t.groups=a.Z.uniqueArray(t.groups),this},addPoints:function(t){var e;for(e=0;e<t.length;e++)this.addPoint(t[e]);return this},addGroup:function(t){var e;for(e in t.objects)t.objects.hasOwnProperty(e)&&this.addPoint(t.objects[e].point);return this},removePoint:function(t){return delete this.objects[t.id],this},setRotationCenter:function(t){return this.rotationCenter=t,this},setRotationPoints:function(t){return this._setActionPoints("rotation",t)},addRotationPoint:function(t){return this._addActionPoint("rotation",t)},removeRotationPoint:function(t){return this._removeActionPoint("rotation",t)},setTranslationPoints:function(t){return this._setActionPoints("translation",t)},addTranslationPoint:function(t){return this._addActionPoint("translation",t)},removeTranslationPoint:function(t){return this._removeActionPoint("translation",t)},setScaleCenter:function(t){return this.scaleCenter=t,this},setScalePoints:function(t,e){var o,s,n;for(n=(o=a.Z.isArray(t)?t:arguments).length,s=0;s<n;++s)this.scaleDirections[this.board.select(o[s]).id]=e||"xy";return this._setActionPoints("scale",t)},addScalePoint:function(t,e){return this._addActionPoint("scale",t),this.scaleDirections[this.board.select(t).id]=e||"xy",this},removeScalePoint:function(t){return this._removeActionPoint("scale",t)},_setActionPoints:function(t,e){var o,s,n;for(n=(o=a.Z.isArray(e)?e:arguments).length,this[t+"Points"]=[],s=0;s<n;++s)this._addActionPoint(t,o[s]);return this},_addActionPoint:function(t,e){return this[t+"Points"].push(this.board.select(e)),this},_removeActionPoint:function(t,e){var o=this[t+"Points"].indexOf(this.board.select(e));return o>-1&&this[t+"Points"].splice(o,1),this},setProperty:function(){u.Z.deprecated("Group.setProperty","Group.setAttribute()"),this.setAttribute.apply(this,arguments)},setAttribute:function(){var t;for(t in this.objects)this.objects.hasOwnProperty(t)&&this.objects[t].point.setAttribute.apply(this.objects[t].point,arguments);return this}}),u.Z.createGroup=function(t,e,o){var s=a.Z.copyAttributes(o,t.options,"group"),n=new u.Z.Group(t,s.id,s.name,e,s);return n.elType="group",n.setParents(e),n},u.Z.registerElement("group",u.Z.createGroup),u.Z.Group,u.Z.Circle=function(t,e,o,s,n){this.constructor(t,n,S.Z.OBJECT_TYPE_CIRCLE,S.Z.OBJECT_CLASS_CIRCLE),this.method=e,this.midpoint=this.board.select(o),this.center=this.board.select(o),this.point2=null,this.radius=0,this.line=null,this.circle=null,this.points=[],e==="twoPoints"?(this.point2=t.select(s),this.radius=this.Radius()):e==="pointRadius"?(this.gxtterm=s,this.updateRadius=a.Z.createFunction(s,this.board,null,!0),this.updateRadius(),this.addParentsFromJCFunctions([this.updateRadius])):e==="pointLine"?(this.line=t.select(s),this.radius=this.line.point1.coords.distance(S.Z.COORDS_BY_USER,this.line.point2.coords)):e==="pointCircle"&&(this.circle=t.select(s),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),a.Z.exists(this.center._is_new)?(this.addChild(this.center),delete this.center._is_new):this.center.addChild(this),e==="pointRadius"?this.notifyParents(s):e==="pointLine"?this.line.addChild(this):e==="pointCircle"?this.circle.addChild(this):e==="twoPoints"&&(a.Z.exists(this.point2._is_new)?(this.addChild(this.point2),delete this.point2._is_new):this.point2.addChild(this)),this.methodMap=a.Z.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",Area:"Area",area:"Area",radius:"Radius",center:"center",line:"line",point2:"point2"})},u.Z.Circle.prototype=new Gt.Z,u.Z.extend(u.Z.Circle.prototype,{hasPoint:function(t,e){var o,s,n,h,l,p=this.center.coords.usrCoords,d=new m.Z(S.Z.COORDS_BY_SCREEN,[t,e],this.board),b=this.Radius();return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(s=this.board._inputDevice,o=a.Z.evaluate(this.visProp.precision[s])):o=this.board.options.precision.hasPoint,n=p[1]-d.usrCoords[1],h=p[2]-d.usrCoords[2],l=Math.sqrt(n*n+h*h),o+=.5*a.Z.evaluate(this.visProp.strokewidth),o/=Math.sqrt(this.board.unitX*this.board.unitY),a.Z.evaluate(this.visProp.hasinnerpoints)?l<b+o:Math.abs(l-b)<o},generatePolynomial:function(t){var e=this.center.symbolic.x,o=this.center.symbolic.y,s=t.symbolic.x,n=t.symbolic.y,h=this.generateRadiusSquared();return h===""?[]:["(("+s+")-("+e+"))^2 + (("+n+")-("+o+"))^2 - ("+h+")"]},generateRadiusSquared:function(){var t,e,o,s,n="";return this.method==="twoPoints"?(t=this.center.symbolic.x,e=this.center.symbolic.y,n="(("+(o=this.point2.symbolic.x)+")-("+t+"))^2 + (("+(s=this.point2.symbolic.y)+")-("+e+"))^2"):this.method==="pointRadius"?a.Z.isNumber(this.radius)&&(n=(this.radius*this.radius).toString()):this.method==="pointLine"?(o=this.line.point1.symbolic.x,s=this.line.point1.symbolic.y,n="(("+o+")-("+this.line.point2.symbolic.x+"))^2 + (("+s+")-("+this.line.point2.symbolic.y+"))^2"):this.method==="pointCircle"&&(n=this.circle.Radius()),n},update:function(){var t,e,o,s,n,h;if(this.needsUpdate)for(a.Z.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.method==="pointLine"?this.radius=this.line.point1.coords.distance(S.Z.COORDS_BY_USER,this.line.point2.coords):this.method==="pointCircle"?this.radius=this.circle.Radius():this.method==="pointRadius"&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform(),o=this.center.coords.usrCoords[0],t=this.center.coords.usrCoords[1]/o,e=this.center.coords.usrCoords[2]/o,o/=o,s=this.Radius(),n=.551915024494,this.numberPoints=13,this.dataX=[t+s,t+s,t+s*n,t,t-s*n,t-s,t-s,t-s,t-s*n,t,t+s*n,t+s,t+s],this.dataY=[e,e+s*n,e+s,e+s,e+s,e+s*n,e,e-s*n,e-s,e-s,e-s,e-s*n,e],this.bezierDegree=3,h=0;h<this.numberPoints;h++)this.points[h]=new m.Z(S.Z.COORDS_BY_USER,[this.dataX[h],this.dataY[h]],this.board);return this},updateQuadraticform:function(){var t=this.center,e=t.X(),o=t.Y(),s=this.Radius();this.quadraticform=[[e*e+o*o-s*s,-e,-o],[-e,1,0],[-o,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],isFinite(this.stdform[4])||(this.stdform[0]=a.Z.exists(this.point2)?-(this.stdform[1]*this.point2.coords.usrCoords[1]+this.stdform[2]*this.point2.coords.usrCoords[2]):0),this.normalize()},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateEllipse(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},notifyParents:function(t){a.Z.isString(t)&&ht.Z.findDependencies(this,t,this.board)},setRadius:function(t){return this.updateRadius=a.Z.createFunction(t,this.board,null,!0),this.addParentsFromJCFunctions([this.updateRadius]),this.board.update(),this},Radius:function(t){return a.Z.exists(t)?(this.setRadius(t),this.Radius()):this.method==="twoPoints"?a.Z.cmpArrays(this.point2.coords.usrCoords,[0,0,0])||a.Z.cmpArrays(this.center.coords.usrCoords,[0,0,0])?NaN:this.center.Dist(this.point2):this.method==="pointLine"||this.method==="pointCircle"?this.radius:this.method==="pointRadius"?this.updateRadius():NaN},getRadius:function(){return u.Z.deprecated("Circle.getRadius()","Circle.Radius()"),this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var t,e,o=this.Radius(),s=this.center.coords.usrCoords,n=.7071067811865;switch(a.Z.evaluate(this.visProp.label.position)){case"lft":t=s[1]-o,e=s[2];break;case"llft":t=s[1]-n*o,e=s[2]-n*o;break;case"rt":t=s[1]+o,e=s[2];break;case"lrt":t=s[1]+n*o,e=s[2]-n*o;break;case"urt":t=s[1]+n*o,e=s[2]+n*o;break;case"top":t=s[1],e=s[2]+o;break;case"bot":t=s[1],e=s[2]-o;break;default:t=s[1]-n*o,e=s[2]+n*o}return new m.Z(S.Z.COORDS_BY_USER,[t,e],this.board)},cloneToBackground:function(){var t,e=this.Radius(),o={id:this.id+"T"+this.numTraces,elementClass:S.Z.OBJECT_CLASS_CIRCLE,center:{coords:this.center.coords},Radius:function(){return e},getRadius:function(){return e},board:this.board,visProp:a.Z.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return o.visProp.layer=this.board.options.layer.trace,this.numTraces++,a.Z.clearVisPropOld(o),o.visPropCalc={visible:a.Z.evaluate(o.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(o),this.board.renderer.enhancedRendering=t,this.traces[o.id]=o.rendNode,this},addTransform:function(t){var e,o=a.Z.isArray(t)?t:[t],s=o.length;for(e=0;e<s;e++)this.center.transformations.push(o[e]),this.method==="twoPoints"&&this.point2.transformations.push(o[e]);return this},snapToGrid:function(){var t=a.Z.evaluate(this.visProp.snaptogrid);return this.center.handleSnapToGrid(t,!0),this.method==="twoPoints"&&this.point2.handleSnapToGrid(t,!0),this},snapToPoints:function(){var t=a.Z.evaluate(this.visProp.snaptopoints);return this.center.handleSnapToPoints(t),this.method==="twoPoints"&&this.point2.handleSnapToPoints(t),this},X:function(t){return this.Radius()*Math.cos(2*t*Math.PI)+this.center.coords.usrCoords[1]},Y:function(t){return this.Radius()*Math.sin(2*t*Math.PI)+this.center.coords.usrCoords[2]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var t=this.Radius();return t*t*Math.PI},bounds:function(){var t=this.center.coords.usrCoords,e=this.Radius();return[t[1]-e,t[2]+e,t[1]+e,t[2]-e]},getParents:function(){return this.parents.length===1?this.parents.concat(this.radius):this.parents}}),u.Z.createCircle=function(t,e,o){var s,n,h,l,p,d=["center","point2"];if(n=[],p=t.select(e[0]),a.Z.isObject(p)&&p.elementClass===S.Z.OBJECT_CLASS_CIRCLE&&a.Z.isTransformationOrArray(e[1]))return l=a.Z.copyAttributes(o,t.options,"circle"),(s=u.Z.createEllipse(t,[p.center,p.center,function(){return 2*p.Radius()}],l)).addTransform(e[1]),s;for(h=0;h<e.length;h++)if(a.Z.isPointType(t,e[h])){if((n=n.concat(a.Z.providePoints(t,[e[h]],o,"circle",[d[h]])))[n.length-1]===!1)throw new Error("JSXGraph: Can't create circle from this type. Please provide a point type.")}else n.push(e[h]);if(l=a.Z.copyAttributes(o,t.options,"circle"),n.length===2&&a.Z.isPoint(n[0])&&a.Z.isPoint(n[1]))s=new u.Z.Circle(t,"twoPoints",n[0],n[1],l);else if((a.Z.isNumber(n[0])||a.Z.isFunction(n[0])||a.Z.isString(n[0]))&&a.Z.isPoint(n[1]))s=new u.Z.Circle(t,"pointRadius",n[1],n[0],l);else if((a.Z.isNumber(n[1])||a.Z.isFunction(n[1])||a.Z.isString(n[1]))&&a.Z.isPoint(n[0]))s=new u.Z.Circle(t,"pointRadius",n[0],n[1],l);else if(n[0].elementClass===S.Z.OBJECT_CLASS_CIRCLE&&a.Z.isPoint(n[1]))s=new u.Z.Circle(t,"pointCircle",n[1],n[0],l);else if(n[1].elementClass===S.Z.OBJECT_CLASS_CIRCLE&&a.Z.isPoint(n[0]))s=new u.Z.Circle(t,"pointCircle",n[0],n[1],l);else if(n[0].elementClass===S.Z.OBJECT_CLASS_LINE&&a.Z.isPoint(n[1]))s=new u.Z.Circle(t,"pointLine",n[1],n[0],l);else if(n[1].elementClass===S.Z.OBJECT_CLASS_LINE&&a.Z.isPoint(n[0]))s=new u.Z.Circle(t,"pointLine",n[0],n[1],l);else{if(!(e.length===3&&a.Z.isPoint(n[0])&&a.Z.isPoint(n[1])&&a.Z.isPoint(n[2])))throw new Error("JSXGraph: Can't create circle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point], [circle,transformation]`);if(!u.Z.elements.circumcircle)throw new Error("JSXGraph: Can't create circle with three points. Please include the circumcircle element (element/composition).");s=u.Z.elements.circumcircle(t,n,l)}for(s.isDraggable=!0,s.setParents(n),s.elType="circle",h=0;h<n.length;h++)a.Z.isPoint(n[h])&&s.inherits.push(n[h]);return s},u.Z.registerElement("circle",u.Z.createCircle);const pe=u.Z.Circle;u.Z.createEllipse=function(t,e,o){var s,n,h,l,p,d,b,Z=[],y=a.Z.copyAttributes(o,t.options,"conic","foci"),O=a.Z.copyAttributes(o,t.options,"conic","center"),x=a.Z.copyAttributes(o,t.options,"conic");for(d=0;d<2;d++)if(e[d].length>1)Z[d]=t.create("point",e[d],y);else if(a.Z.isPoint(e[d]))Z[d]=t.select(e[d]);else if(a.Z.isFunction(e[d])&&a.Z.isPoint(e[d]()))Z[d]=e[d]();else{if(!a.Z.isString(e[d]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);Z[d]=t.select(e[d])}if(a.Z.isNumber(e[2]))p=a.Z.createFunction(e[2],t);else if(a.Z.isFunction(e[2])&&a.Z.isNumber(e[2]()))p=e[2];else{if(a.Z.isPoint(e[2]))l=t.select(e[2]);else if(e[2].length>1)l=t.create("point",e[2],y);else if(a.Z.isFunction(e[2])&&a.Z.isPoint(e[2]()))l=e[2]();else{if(!a.Z.isString(e[2]))throw new Error("JSXGraph: Can't create Ellipse with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);l=t.select(e[2])}p=function(){return l.Dist(Z[0])+l.Dist(Z[1])}}for(a.Z.exists(e[4])||(e[4]=2*Math.PI),a.Z.exists(e[3])||(e[3]=0),h=t.create("point",[function(){return .5*(Z[0].X()+Z[1].X())},function(){return .5*(Z[0].Y()+Z[1].Y())}],O),(n=t.create("curve",[function(D){return 0},function(D){return 0},e[3],e[4]],x)).majorAxis=p,b=n.hasPoint,s=function(D,k){var I,U,J,z,V,W,$,nt,et;k||(U=(I=p())*I,J=Z[0].X(),z=Z[0].Y(),$=J-(V=Z[1].X()),nt=z-(W=Z[1].Y()),et=(U-J*J-z*z+V*V+W*W)/(2*I),n.quadraticform=[[et*et-V*V-W*W,et*$/I+V,et*nt/I+W],[et*$/I+V,$*$/U-1,$*nt/U],[et*nt/I+W,$*nt/U,nt*nt/U-1]])},n.X=function(D,k){var I=p(),U=Z[1].Dist(Z[0]),J=.5*(U*U-I*I)/(U*Math.cos(D)-I),z=Math.atan2(Z[1].Y()-Z[0].Y(),Z[1].X()-Z[0].X());return k||s(0,k),Z[0].X()+Math.cos(z+D)*J},n.Y=function(D,k){var I=p(),U=Z[1].Dist(Z[0]),J=.5*(U*U-I*I)/(U*Math.cos(D)-I),z=Math.atan2(Z[1].Y()-Z[0].Y(),Z[1].X()-Z[0].X());return Z[0].Y()+Math.sin(z+D)*J},n.midpoint=n.center=h,n.type=S.Z.OBJECT_TYPE_CONIC,n.subs={center:n.center},n.inherits.push(n.center,Z[0],Z[1]),a.Z.isPoint(l)&&n.inherits.push(l),n.hasPoint=function(D,k){var I,U,J,z;return a.Z.evaluate(this.visProp.hasinnerpoints)?(I=Z[0].coords,U=Z[1].coords,J=this.majorAxis(),(z=new m.Z(S.Z.COORDS_BY_SCREEN,[D,k],this.board)).distance(S.Z.COORDS_BY_USER,I)+z.distance(S.Z.COORDS_BY_USER,U)<=J):b.apply(this,arguments)},h.addChild(n),d=0;d<2;d++)a.Z.isPoint(Z[d])&&Z[d].addChild(n);return a.Z.isPoint(l)&&l.addChild(n),n.setParents(e),n},u.Z.createHyperbola=function(t,e,o){var s,n,h,l,p,d,b=[],Z=a.Z.copyAttributes(o,t.options,"conic","foci"),y=a.Z.copyAttributes(o,t.options,"conic","center"),O=a.Z.copyAttributes(o,t.options,"conic");for(d=0;d<2;d++)if(e[d].length>1)b[d]=t.create("point",e[d],Z);else if(a.Z.isPoint(e[d]))b[d]=t.select(e[d]);else if(a.Z.isFunction(e[d])&&a.Z.isPoint(e[d]()))b[d]=e[d]();else{if(!a.Z.isString(e[d]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);b[d]=t.select(e[d])}if(a.Z.isNumber(e[2]))p=a.Z.createFunction(e[2],t);else if(a.Z.isFunction(e[2])&&a.Z.isNumber(e[2]()))p=e[2];else{if(a.Z.isPoint(e[2]))l=t.select(e[2]);else if(e[2].length>1)l=t.create("point",e[2],Z);else if(a.Z.isFunction(e[2])&&a.Z.isPoint(e[2]()))l=e[2]();else{if(!a.Z.isString(e[2]))throw new Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [point,point,number|function]`);l=t.select(e[2])}p=function(){return l.Dist(b[0])-l.Dist(b[1])}}for(a.Z.exists(e[4])||(e[4]=1.0001*Math.PI),a.Z.exists(e[3])||(e[3]=-1.0001*Math.PI),h=t.create("point",[function(){return .5*(b[0].X()+b[1].X())},function(){return .5*(b[0].Y()+b[1].Y())}],y),(n=t.create("curve",[function(x){return 0},function(x){return 0},e[3],e[4]],O)).majorAxis=p,s=function(x,D){var k,I,U,J,z,V,W,$,nt;D||(I=(k=p())*k,U=b[0].X(),J=b[0].Y(),W=U-(z=b[1].X()),$=J-(V=b[1].Y()),nt=(I-U*U-J*J+z*z+V*V)/(2*k),n.quadraticform=[[nt*nt-z*z-V*V,nt*W/k+z,nt*$/k+V],[nt*W/k+z,W*W/I-1,W*$/I],[nt*$/k+V,W*$/I,$*$/I-1]])},n.X=function(x,D){var k=p(),I=b[1].Dist(b[0]),U=.5*(I*I-k*k)/(I*Math.cos(x)+k),J=Math.atan2(b[1].Y()-b[0].Y(),b[1].X()-b[0].X());return D||s(0,D),b[0].X()+Math.cos(J+x)*U},n.Y=function(x,D){var k=p(),I=b[1].Dist(b[0]),U=.5*(I*I-k*k)/(I*Math.cos(x)+k),J=Math.atan2(b[1].Y()-b[0].Y(),b[1].X()-b[0].X());return b[0].Y()+Math.sin(J+x)*U},n.midpoint=n.center=h,n.subs={center:n.center},n.inherits.push(n.center,b[0],b[1]),a.Z.isPoint(l)&&n.inherits.push(l),n.type=S.Z.OBJECT_TYPE_CONIC,h.addChild(n),d=0;d<2;d++)a.Z.isPoint(b[d])&&b[d].addChild(n);return a.Z.isPoint(l)&&l.addChild(n),n.setParents(e),n},u.Z.createParabola=function(t,e,o){var s,n,h,l,p=e[0],d=e[1],b=a.Z.copyAttributes(o,t.options,"conic","foci"),Z=a.Z.copyAttributes(o,t.options,"conic","center"),y=a.Z.copyAttributes(o,t.options,"conic");if(e[0].length>1)p=t.create("point",e[0],b);else if(a.Z.isPoint(e[0]))p=t.select(e[0]);else if(a.Z.isFunction(e[0])&&a.Z.isPoint(e[0]()))p=e[0]();else{if(!a.Z.isString(e[0]))throw new Error("JSXGraph: Can't create Parabola with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line]`);p=t.select(e[0])}return a.Z.isArray(d)&&d.length===2&&(l=a.Z.copyAttributes(o,t.options,"conic","line"),d=t.create("line",d,l)),a.Z.exists(e[3])||(e[3]=2*Math.PI),a.Z.exists(e[2])||(e[2]=0),h=t.create("point",[function(){return _.Z.projectPointToLine(p,d,t).usrCoords}],Z),(n=t.create("curve",[function(O){return 0},function(O){return 0},e[2],e[3]],y)).midpoint=n.center=h,n.subs={center:n.center},n.inherits.push(n.center),s=function(O,x){var D,k,I,U,J,z;x||(D=d.stdform[1],k=d.stdform[2],I=d.stdform[0],U=D*D+k*k,J=p.X(),z=p.Y(),n.quadraticform=[[I*I-U*(J*J+z*z),I*D+U*J,I*k+U*z],[I*D+U*J,-k*k,D*k],[I*k+U*z,D*k,-D*D]])},n.X=function(O,x){var D,k=d.getAngle(),I=_.Z.distPointLine(p.coords.usrCoords,d.stdform),U=d.point1.coords.usrCoords,J=d.point2.coords.usrCoords,z=p.coords.usrCoords;return U[0]===0?U=[1,J[1]+d.stdform[2],J[2]-d.stdform[1]]:J[0]===0&&(J=[1,U[1]+d.stdform[2],U[2]-d.stdform[1]]),D=((J[1]-U[1])*(z[2]-U[2])-(J[2]-U[2])*(z[1]-U[1])>=0?1:-1)*I/(1-Math.sin(O)),x||s(0,x),p.X()+Math.cos(O+k)*D},n.Y=function(O,x){var D,k=d.getAngle(),I=_.Z.distPointLine(p.coords.usrCoords,d.stdform),U=d.point1.coords.usrCoords,J=d.point2.coords.usrCoords,z=p.coords.usrCoords;return U[0]===0?U=[1,J[1]+d.stdform[2],J[2]-d.stdform[1]]:J[0]===0&&(J=[1,U[1]+d.stdform[2],U[2]-d.stdform[1]]),D=((J[1]-U[1])*(z[2]-U[2])-(J[2]-U[2])*(z[1]-U[1])>=0?1:-1)*I/(1-Math.sin(O)),p.Y()+Math.sin(O+k)*D},n.type=S.Z.OBJECT_TYPE_CONIC,h.addChild(n),a.Z.isPoint(p)&&(p.addChild(n),n.inherits.push(p)),d.addChild(n),n.setParents(e),n},u.Z.createConic=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U=[[1,0,0],[0,1,0],[0,0,1]],J=[[1,0,0],[0,1,0],[0,0,1]],z=[],V=[],W=a.Z.copyAttributes(o,t.options,"conic","point"),$=a.Z.copyAttributes(o,t.options,"conic","center"),nt=a.Z.copyAttributes(o,t.options,"conic");if(e.length===5)I=!0;else{if(e.length!==6)throw new Error("JSXGraph: Can't create generic Conic with "+e.length+" parameters.");I=!1}if(I)for(D=0;D<5;D++)if(e[D].length>1)z[D]=t.create("point",e[D],W);else if(a.Z.isPoint(e[D]))z[D]=t.select(e[D]);else if(a.Z.isFunction(e[D])&&a.Z.isPoint(e[D]()))z[D]=e[D]();else{if(!a.Z.isString(e[D]))throw new Error("JSXGraph: Can't create Conic section with parent types '"+typeof e[D]+`'.
Possible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]`);z[D]=t.select(e[D])}else(k=[[0,0,0],[0,0,0],[0,0,0]])[0][0]=a.Z.isFunction(e[2])?function(){return e[2]()}:function(){return e[2]},k[0][1]=a.Z.isFunction(e[4])?function(){return e[4]()}:function(){return e[4]},k[0][2]=a.Z.isFunction(e[5])?function(){return e[5]()}:function(){return e[5]},k[1][1]=a.Z.isFunction(e[0])?function(){return e[0]()}:function(){return e[0]},k[1][2]=a.Z.isFunction(e[3])?function(){return e[3]()}:function(){return e[3]},k[2][2]=a.Z.isFunction(e[1])?function(){return e[1]()}:function(){return e[1]};if(p=function(et){var lt,ot;for(lt=0;lt<3;lt++)for(ot=lt;ot<3;ot++)et[lt][ot]+=et[ot][lt];for(lt=0;lt<3;lt++)for(ot=0;ot<lt;ot++)et[lt][ot]=et[ot][lt];return et},l=function(et,lt){var ot,gt,vt=[[0,0,0],[0,0,0],[0,0,0]];for(ot=0;ot<3;ot++)for(gt=0;gt<3;gt++)vt[ot][gt]=et[ot]*lt[gt];return p(vt)},h=function(et,lt,ot){var gt,vt,Tt,Rt,kt,Ft=[[0,0,0],[0,0,0],[0,0,0]];for(kt=B.Z.matVecMult(lt,ot),Tt=B.Z.innerProduct(ot,kt),kt=B.Z.matVecMult(et,ot),Rt=B.Z.innerProduct(ot,kt),gt=0;gt<3;gt++)for(vt=0;vt<3;vt++)Ft[gt][vt]=Tt*et[gt][vt]-Rt*lt[gt][vt];return Ft},n=t.create("curve",[function(et){return 0},function(et){return 0},0,2*Math.PI],nt),s=function(et,lt){var ot,gt,vt,Tt;if(!lt){if(I){for(ot=0;ot<5;ot++)V[ot]=z[ot].coords.usrCoords;O=l(B.Z.crossProduct(V[0],V[1]),B.Z.crossProduct(V[2],V[3])),x=l(B.Z.crossProduct(V[0],V[2]),B.Z.crossProduct(V[1],V[3])),J=h(O,x,V[4])}else for(ot=0;ot<3;ot++)for(gt=ot;gt<3;gt++)J[ot][gt]=k[ot][gt](),gt>ot&&(J[gt][ot]=J[ot][gt]);for(n.quadraticform=J,(d=c.Z.Jacobi(J))[0][0][0]<0&&(d[0][0][0]*=-1,d[0][1][1]*=-1,d[0][2][2]*=-1),ot=0;ot<3;ot++){for(vt=0,gt=0;gt<3;gt++)vt+=d[1][gt][ot]*d[1][gt][ot];vt=Math.sqrt(vt)}U=d[1],y=Math.sqrt(Math.abs(d[0][0][0])),b=Math.sqrt(Math.abs(d[0][1][1])),Z=Math.sqrt(Math.abs(d[0][2][2]))}return d[0][1][1]<=0&&d[0][2][2]<=0?Tt=B.Z.matVecMult(U,[1/y,Math.cos(et)/b,Math.sin(et)/Z]):d[0][1][1]<=0&&d[0][2][2]>0?Tt=B.Z.matVecMult(U,[Math.cos(et)/y,1/b,Math.sin(et)/Z]):d[0][2][2]<0&&(Tt=B.Z.matVecMult(U,[Math.sin(et)/y,Math.cos(et)/b,1/Z])),a.Z.exists(Tt)?(Tt[1]/=Tt[0],Tt[2]/=Tt[0],Tt[0]=1):Tt=[1,NaN,NaN],Tt},n.X=function(et,lt){return s(et,lt)[1]},n.Y=function(et,lt){return s(et,lt)[2]},n.midpoint=t.create("point",[function(){var et=n.quadraticform;return[et[1][1]*et[2][2]-et[1][2]*et[1][2],et[1][2]*et[0][2]-et[2][2]*et[0][1],et[0][1]*et[1][2]-et[1][1]*et[0][2]]}],$),n.type=S.Z.OBJECT_TYPE_CONIC,n.center=n.midpoint,n.subs={center:n.center},n.inherits.push(n.center),n.inherits=n.inherits.concat(z),I){for(D=0;D<5;D++)a.Z.isPoint(z[D])&&z[D].addChild(n);n.setParents(e)}return n.addChild(n.center),n},u.Z.registerElement("ellipse",u.Z.createEllipse),u.Z.registerElement("hyperbola",u.Z.createHyperbola),u.Z.registerElement("parabola",u.Z.createParabola),u.Z.registerElement("conic",u.Z.createConic),u.Z.Polygon=function(t,e,o){this.constructor(t,o,S.Z.OBJECT_TYPE_POLYGON,S.Z.OBJECT_CLASS_AREA);var s,n,h,l,p,d=a.Z.copyAttributes(o,t.options,"polygon","borders");for(this.withLines=o.withlines,this.attr_line=d,this.vertices=[],s=0;s<e.length;s++)this.vertices[s]=this.board.select(e[s]),this.vertices[s]._is_new&&(delete this.vertices[s]._is_new,this.vertices[s]._is_new_pol=!0);if(this.vertices.length>0&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(h=this.vertices.length-1,l=0;l<h;l++)s=(l+1)%h,d.id=d.ids&&d.ids[s],d.name=d.names&&d.names[s],d.strokecolor=a.Z.isArray(d.colors)&&d.colors[s%d.colors.length]||d.strokecolor,d.visible=a.Z.exists(o.borders.visible)?o.borders.visible:o.visible,d.strokecolor===!1&&(d.strokecolor="none"),(n=t.create("segment",[this.vertices[s],this.vertices[s+1]],d)).dump=!1,this.borders[s]=n,n.parentPolygon=this;for(this.inherits.push(this.vertices,this.borders),this.id=this.board.setId(this,"Py"),s=0;s<this.vertices.length-1;s++)p=this.board.select(this.vertices[s]),a.Z.exists(p._is_new_pol)?(this.addChild(p),delete p._is_new_pol):p.addChild(this);this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="polygon",this.createLabel(),this.methodMap=u.Z.deepCopy(this.methodMap,{borders:"borders",vertices:"vertices",A:"Area",Area:"Area",Perimeter:"Perimeter",L:"Perimeter",Length:"Perimeter",boundingBox:"boundingBox",bounds:"bounds",addPoints:"addPoints",insertPoints:"insertPoints",removePoints:"removePoints"})},u.Z.Polygon.prototype=new Gt.Z,u.Z.extend(u.Z.Polygon.prototype,{pnpoly:function(t,e,o){return _.Z.pnpoly(t,e,this.vertices,o)},hasPoint:function(t,e){var o,s;if(a.Z.evaluate(this.visProp.hasinnerpoints)&&this.pnpoly(t,e))return!0;for(s=this.borders.length,o=0;o<s;o++)if(this.borders[o].hasPoint(t,e))return!0;return!1},updateRenderer:function(){var t,e;if(!this.needsUpdate)return this;if(this.visPropCalc.visible){for(e=this.vertices.length,this.isReal=!0,t=0;t<e;++t)if(!this.vertices[t].isReal){this.isReal=!1;break}this.isReal||this.updateVisibility(!1)}return this.visPropCalc.visible&&this.board.renderer.updatePolygon(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this},getTextAnchor:function(){var t,e,o,s,n;if(this.vertices.length===0)return new m.Z(S.Z.COORDS_BY_USER,[1,0,0],this.board);for(o=t=this.vertices[0].X(),s=e=this.vertices[0].Y(),n=0;n<this.vertices.length;n++)this.vertices[n].X()<t&&(t=this.vertices[n].X()),this.vertices[n].X()>o&&(o=this.vertices[n].X()),this.vertices[n].Y()>e&&(e=this.vertices[n].Y()),this.vertices[n].Y()<s&&(s=this.vertices[n].Y());return new m.Z(S.Z.COORDS_BY_USER,[.5*(t+o),.5*(e+s)],this.board)},getLabelAnchor:u.Z.shortcut(u.Z.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var t,e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.vertices=this.vertices,e.visProp=a.Z.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.board=this.board,a.Z.clearVisPropOld(e),e.visPropCalc={visible:a.Z.evaluate(e.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(e),this.board.renderer.enhancedRendering=t,this.traces[e.id]=e.rendNode,this},hideElement:function(t){var e;if(u.Z.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),!t)for(e=0;e<this.borders.length;e++)this.borders[e].hideElement();this.hasLabel&&a.Z.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.visPropCalc.visible&&this.label.hideElement())},showElement:function(t){var e;if(u.Z.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!0),!t)for(e=0;e<this.borders.length;e++)this.borders[e].showElement().updateRenderer();return a.Z.exists(this.label)&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.visPropCalc.visible||this.label.showElement().updateRenderer()),this},Area:function(){return Math.abs(_.Z.signedPolygon(this.vertices,!0))},Perimeter:function(){var t,e=this.vertices.length,o=0;for(t=1;t<e;++t)o+=this.vertices[t].Dist(this.vertices[t-1]);return o},boundingBox:function(){var t,e,o=[0,0,0,0],s=this.vertices.length-1;if(s===0)return o;for(o[0]=this.vertices[0].X(),o[2]=o[0],o[1]=this.vertices[0].Y(),o[3]=o[1],t=1;t<s;++t)(e=this.vertices[t].X())<o[0]?o[0]=e:e>o[2]&&(o[2]=e),(e=this.vertices[t].Y())>o[1]?o[1]=e:e<o[3]&&(o[3]=e);return o},bounds:function(){return this.boundingBox()},remove:function(){var t;for(t=0;t<this.borders.length;t++)this.board.removeObject(this.borders[t]);Gt.Z.prototype.remove.call(this)},findPoint:function(t){var e;if(!a.Z.isPoint(t))return-1;for(e=0;e<this.vertices.length;e++)if(this.vertices[e].id===t.id)return e;return-1},addPoints:function(t){var e,o=Array.prototype.slice.call(arguments);return e=this.elType==="polygonalchain"?this.vertices.length-1:this.vertices.length-2,this.insertPoints.apply(this,[e].concat(o))},insertPoints:function(t,e){var o,s,n,h,l;if(arguments.length===0)return this;if(n=this.vertices.length-1,this.elType==="polygon"&&n--,t<-1||t>n)return this;for(s=arguments.length-1,o=1;o<s+1;o++)(l=a.Z.providePoints(this.board,[arguments[o]],{},"polygon",["vertices"])[0])._is_new&&(this.addChild(l),delete l._is_new),this.vertices.splice(t+o,0,l);if(this.withLines)for(h=t+1,this.elType==="polygon"?t<0?(this.vertices[this.vertices.length-1]=this.vertices[0],this.borders[this.borders.length-1].point2=this.vertices[this.vertices.length-1]):this.borders[t].point2=this.vertices[h]:t>=0&&(t<this.borders.length?this.borders[t].point2=this.vertices[h]:h=t),o=h;o<h+s;o++)this.borders.splice(o,0,this.board.create("segment",[this.vertices[o],this.vertices[o+1]],this.attr_line));return this.inherits=[],this.inherits.push(this.vertices,this.borders),this.board.update(),this},removePoints:function(t){var e,o,s,n,h=[],l=[],p=[],d=[];for(this.elType==="polygon"&&(n=this.vertices.pop()),e=0;e<arguments.length;e++)s=arguments[e],a.Z.isPoint(s)&&(s=this.findPoint(s)),a.Z.isNumber(s)&&s>-1&&s<this.vertices.length&&a.Z.indexOf(p,s)===-1&&p.push(s);if(p.length===0)return this.elType==="polygon"&&this.vertices.push(n),this;for(e=0;e<p.length;e++)this.vertices[p[e]].removeChild(this);for(p=p.sort(),h=this.vertices.slice(),l=this.borders.slice(),this.withLines&&d.push([p[p.length-1]]),e=p.length-1;e>-1;e--)h[p[e]]=-1,this.withLines&&p.length>1&&p[e]-1>p[e-1]&&(d[d.length-1][1]=p[e],d.push([p[e-1]]));for(this.withLines&&(d[d.length-1][1]=p[0]),this.vertices=[],e=0;e<h.length;e++)a.Z.isPoint(h[e])&&this.vertices.push(h[e]);if(this.elType==="polygon"&&this.vertices.length>1&&this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;e<d.length;e++){for(o=d[e][1]-1;o<d[e][0]+1;o++)o<0?this.elType==="polygon"&&(this.board.removeObject(this.borders[l.length-1]),l[l.length-1]=-1):o<l.length&&(this.board.removeObject(this.borders[o]),l[o]=-1);d[e][1]!==0&&d[e][0]!==h.length-1&&(l[d[e][0]-1]=this.board.create("segment",[h[d[e][1]-1],h[d[e][0]+1]],this.attr_line))}for(this.borders=[],e=0;e<l.length;e++)l[e]!==-1&&this.borders.push(l[e]);this.elType==="polygon"&&this.vertices.length>2&&(d[0][1]===this.vertices.length-1||d[d.length-1][1]===0)&&this.borders.push(this.board.create("segment",[this.vertices[this.vertices.length-2],this.vertices[0]],this.attr_line))}return this.inherits=[],this.inherits.push(this.vertices,this.borders),this.board.update(),this},getParents:function(){return this.setParents(this.vertices),this.parents},getAttributes:function(){var t,e=Gt.Z.prototype.getAttributes.call(this);if(this.withLines)for(e.lines=e.lines||{},e.lines.ids=[],e.lines.colors=[],t=0;t<this.borders.length;t++)e.lines.ids.push(this.borders[t].id),e.lines.colors.push(this.borders[t].visProp.strokecolor);return e},snapToGrid:function(){var t,e;for(e=!!a.Z.evaluate(this.visProp.snaptogrid),t=0;t<this.vertices.length;t++)this.vertices[t].handleSnapToGrid(e,!0)},setPositionDirectly:function(t,e,o){var s,n,h,l=new m.Z(t,e,this.board),p=new m.Z(t,o,this.board);for(h=this.vertices.length-1,n=0;n<h;n++)if(!this.vertices[n].draggable())return this;return s=v.Z.subtract(l.usrCoords,p.usrCoords),this.board.create("transform",s.slice(1),{type:"translate"}).applyOnce(this.vertices.slice(0,-1)),this},sutherlandHodgman:function(t){var e,o,s,n,h,l,p,d=u.Z.Math.Geometry.sortVertices(this.vertices),b=u.Z.Math.Geometry.sortVertices(t.vertices),Z=d.length-1,y=b.length-1,O=[],x=function(D,k,I){return(k[1]-D[1])*(I[2]-D[2])-(k[2]-D[2])*(I[1]-D[1])>=0};for(s=0;s<y;s++)O.push(b[s]);for(s=0;s<Z;s++)for(o=O.slice(0),O=[],h=o[(e=o.length)-1],n=0;n<e;n++)l=o[n],x(d[s],d[s+1],l)?(x(d[s],d[s+1],h)||((p=u.Z.Math.Geometry.meetSegmentSegment(h,l,d[s],d[s+1]))[0][1]/=p[0][0],p[0][2]/=p[0][0],p[0][0]=1,O.push(p[0])),O.push(l)):x(d[s],d[s+1],h)&&((p=u.Z.Math.Geometry.meetSegmentSegment(h,l,d[s],d[s+1]))[0][1]/=p[0][0],p[0][2]/=p[0][0],p[0][0]=1,O.push(p[0])),h=l;return O},intersect:function(t){return this.sutherlandHodgman(t)}}),u.Z.createPolygon=function(t,e,o){var s,n,h,l,p,d,b=[],Z=!1;if(a.Z.copyAttributes(o,t.options,"polygon"),(l=t.select(e[0]))===null&&(l=e[0]),a.Z.isObject(l)&&l.type===S.Z.OBJECT_TYPE_POLYGON&&a.Z.isTransformationOrArray(e[1]))for(Z=!0,h=l.vertices.length-1,d=a.Z.copyAttributes(o,t.options,"polygon","vertices"),n=0;n<h;n++)d.withlabel&&(d.name=l.vertices[n].name===""?"":l.vertices[n].name+"'"),b.push(t.create("point",[l.vertices[n],e[1]],d));else if((b=a.Z.providePoints(t,e,o,"polygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create polygon / polygonalchain with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates. Alternatively, a polygon and a transformation can be supplied");if(p=a.Z.copyAttributes(o,t.options,"polygon"),(s=new u.Z.Polygon(t,b,p)).isDraggable=!0,Z)for(s.prepareUpdate().update().updateVisibility().updateRenderer(),h=l.vertices.length-1,n=0;n<h;n++)b[n].prepareUpdate().update().updateVisibility().updateRenderer();return s},u.Z.createRegularPolygon=function(t,e,o){var s,n,h,l,p,d,b,Z=[];if(h=e[(p=e.length)-1],a.Z.isNumber(h)&&(e.length!==3||h<3))throw new Error("JSXGraph: A regular polygon needs two point types and a number > 2 as input.");if(a.Z.isNumber(t.select(h))?(p--,d=!1):(h=p,d=!0),(Z=a.Z.providePoints(t,e.slice(0,p),o,"regularpolygon",["vertices"]))===!1)throw new Error("JSXGraph: Can't create regular polygon with parent types other than 'point' and 'coordinate arrays' or a function returning an array of coordinates");for(b=a.Z.copyAttributes(o,t.options,"regularpolygon","vertices"),n=2;n<h;n++)l=t.create("transform",[Math.PI*(2-(h-2)/h),Z[n-1]],{type:"rotate"}),d?(Z[n].addTransform(Z[n-2],l),Z[n].fullUpdate()):(a.Z.isArray(b.ids)&&b.ids.length>=h-2&&(b.id=b.ids[n-2]),Z[n]=t.create("point",[Z[n-2],l],b),Z[n].type=S.Z.OBJECT_TYPE_CAS,Z[n].isDraggable=!0,Z[n].visProp.fixed=!1);return b=a.Z.copyAttributes(o,t.options,"regularpolygon"),(s=t.create("polygon",Z,b)).elType="regularpolygon",s},u.Z.createPolygonalChain=function(t,e,o){var s,n;return s=a.Z.copyAttributes(o,t.options,"polygonalchain"),(n=t.create("polygon",e,s)).elType="polygonalchain",n.vertices.pop(),t.removeObject(n.borders[n.borders.length-1]),n.borders.pop(),n},u.Z.registerElement("polygon",u.Z.createPolygon),u.Z.registerElement("regularpolygon",u.Z.createRegularPolygon),u.Z.registerElement("polygonalchain",u.Z.createPolygonalChain);const ge=u.Z.Polygon;u.Z.Curve=function(t,e,o){this.constructor(t,o,S.Z.OBJECT_TYPE_CURVE,S.Z.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=a.Z.evaluate(this.visProp.numberpointshigh),this.bezierDegree=1,this.dataX=null,this.dataY=null,this.ticks=[],this.qdt=null,a.Z.exists(e[0])?this.varname=e[0]:this.varname="x",this.xterm=e[1],this.yterm=e[2],this.generateTerm(this.varname,this.xterm,this.yterm,e[3],e[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),a.Z.isString(this.xterm)&&this.notifyParents(this.xterm),a.Z.isString(this.yterm)&&this.notifyParents(this.yterm),this.methodMap=a.Z.deepCopy(this.methodMap,{generateTerm:"generateTerm",setTerm:"generateTerm",move:"moveTo",moveTo:"moveTo"})},u.Z.Curve.prototype=new Gt.Z,u.Z.extend(u.Z.Curve.prototype,{minX:function(){return a.Z.evaluate(this.visProp.curvetype)==="polar"?0:new m.Z(S.Z.COORDS_BY_SCREEN,[.1*-this.board.canvasWidth,0],this.board,!1).usrCoords[1]},maxX:function(){return a.Z.evaluate(this.visProp.curvetype)==="polar"?2*Math.PI:new m.Z(S.Z.COORDS_BY_SCREEN,[1.1*this.board.canvasWidth,0],this.board,!1).usrCoords[1]},X:function(t){return NaN},Y:function(t){return NaN},Z:function(t){return 1},hasPoint:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z=[],V=a.Z.evaluate(this.visProp.numberpointslow),W=(this.maxX()-this.minX())/V,$=1/0;if(a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(D=this.board._inputDevice,x=a.Z.evaluate(this.visProp.precision[D])):x=this.board.options.precision.hasPoint,t=(n=new m.Z(S.Z.COORDS_BY_SCREEN,[t,e],this.board,!1)).usrCoords[1],e=n.usrCoords[2],this.bezierDegree===1&&a.Z.evaluate(this.visProp.hasinnerpoints)&&_.Z.windingNumber([1,t,e],this.points,!0)!==0)return!0;if(x+=.5*a.Z.evaluate(this.visProp.strokewidth),x*=x,k=this.board.unitX*this.board.unitX,I=this.board.unitY*this.board.unitY,J=this.minX(),this.maxX(),a.Z.exists(this._visibleArea)&&(J=this._visibleArea[0],W=(this._visibleArea[1]-J)/V),(U=a.Z.evaluate(this.visProp.curvetype))==="parameter"||U==="polar")for(this.transformations.length>0&&(this.updateTransformMatrix(),l=B.Z.inverse(this.transformMat),t=(p=B.Z.matVecMult(l,[1,t,e]))[1],e=p[2]),d=0,s=J;d<V;d++){if(($=(t-(b=this.X(s,!0)))*(t-b)*k+(e-(Z=this.Y(s,!0)))*(e-Z)*I)<=x)return!0;s+=W}else if(U==="plot"||U==="functiongraph"){for((!a.Z.exists(o)||o<0)&&(o=0),a.Z.exists(this.qdt)&&a.Z.evaluate(this.visProp.useqdt)&&this.bezierDegree!==3?h=(y=(O=this.qdt.query(new m.Z(S.Z.COORDS_BY_USER,[t,e],this.board))).points).length:(y=this.points,h=this.numberPoints-1),d=o;d<h;d++)if(this.bezierDegree===3?z=_.Z.projectCoordsToBeziersegment([1,t,e],this,d):O?(y[d].prev&&(z=_.Z.projectCoordsToSegment([1,t,e],y[d].prev.usrCoords,y[d].usrCoords)),y[d].next&&y[d+1]!==y[d].next&&(z=_.Z.projectCoordsToSegment([1,t,e],y[d].usrCoords,y[d].next.usrCoords))):z=_.Z.projectCoordsToSegment([1,t,e],y[d].usrCoords,y[d+1].usrCoords),z[1]>=0&&z[1]<=1&&(t-z[0][1])*(t-z[0][1])*k+(e-z[0][2])*(e-z[0][2])*I<=x)return!0;return!1}return $<x},allocatePoints:function(){var t,e;if(e=this.numberPoints,this.points.length<this.numberPoints)for(t=this.points.length;t<e;t++)this.points[t]=new m.Z(S.Z.COORDS_BY_USER,[0,0],this.board,!1)},update:function(){return this.needsUpdate&&(a.Z.evaluate(this.visProp.trace)&&this.cloneToBackground(!0),this.updateCurve()),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&(this.isReal=f.checkReal(this.points),this.isReal||this.updateVisibility(!1)),this.visPropCalc.visible&&this.board.renderer.updateCurve(this),this.hasLabel&&this.visPropCalc.visible&&this.label&&this.label.visPropCalc.visible&&this.isReal&&(this.label.update(),this.board.renderer.updateText(this.label)),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateDataArray:function(){},updateCurve:function(){var t,e,o,s,n,h,l=this.visProp.plotversion,p=!1;if(this.updateTransformMatrix(),this.updateDataArray(),e=this.minX(),o=this.maxX(),a.Z.exists(this.dataX))for(this.numberPoints=this.dataX.length,t=this.numberPoints,this.allocatePoints(),h=0;h<t;h++)s=h,a.Z.exists(this.dataY)?(n=h,this.points[h].setCoordinates(S.Z.COORDS_BY_USER,[this.dataX[h],this.dataY[h]],!1)):(n=this.X(s),this.points[h].setCoordinates(S.Z.COORDS_BY_USER,[this.dataX[h],this.Y(n,p)],!1)),this.points[h]._t=h,p=!0;else if(a.Z.evaluate(this.visProp.doadvancedplot)?l===1||a.Z.evaluate(this.visProp.doadvancedplotold)?f.updateParametricCurveOld(this,e,o):l===2?f.updateParametricCurve_v2(this,e,o):l===3?f.updateParametricCurve_v3(this,e,o):l===4?f.updateParametricCurve_v4(this,e,o):f.updateParametricCurve_v2(this,e,o):(this.board.updateQuality===this.board.BOARD_QUALITY_HIGH?this.numberPoints=a.Z.evaluate(this.visProp.numberpointshigh):this.numberPoints=a.Z.evaluate(this.visProp.numberpointslow),this.allocatePoints(),f.updateParametricCurveNaive(this,e,o,this.numberPoints)),t=this.numberPoints,a.Z.evaluate(this.visProp.useqdt)&&this.board.updateQuality===this.board.BOARD_QUALITY_HIGH)for(this.qdt=new E(this.board.getBoundingBox()),h=0;h<this.points.length;h++)this.qdt.insert(this.points[h]),h>0&&(this.points[h].prev=this.points[h-1]),h<t-1&&(this.points[h].next=this.points[h+1]);for(a.Z.evaluate(this.visProp.curvetype)!=="plot"&&a.Z.evaluate(this.visProp.rdpsmoothing)&&(this.points=c.Z.RamerDouglasPeucker(this.points,.2),this.numberPoints=this.points.length),t=this.numberPoints,h=0;h<t;h++)this.updateTransform(this.points[h]);return this},updateTransformMatrix:function(){var t,e,o=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],e=0;e<o;e++)(t=this.transformations[e]).update(),this.transformMat=B.Z.matMatMult(t.matrix,this.transformMat);return this},updateTransform:function(t){var e;return this.transformations.length>0&&(e=B.Z.matVecMult(this.transformMat,t.usrCoords),t.setCoordinates(S.Z.COORDS_BY_USER,e,!1,!0)),t},addTransform:function(t){var e,o=a.Z.isArray(t)?t:[t],s=o.length;for(e=0;e<s;e++)this.transformations.push(o[e]);return this},interpolationFunctionFromArray:function(t){var e="data"+t,o=this;return function(s,n){var h,l,p,d,b=o[e],Z=b.length,y=[];if(isNaN(s))return NaN;if(s<0)return a.Z.isFunction(b[0])?b[0]():b[0];if(o.bezierDegree===3){if(s>=(Z-1)/3)return a.Z.isFunction(b[b.length-1])?b[b.length-1]():b[b.length-1];for(h=3*Math.floor(s),d=1-(p=s%1),l=0;l<4;l++)a.Z.isFunction(b[h+l])?y[l]=b[h+l]():y[l]=b[h+l];return d*d*(d*y[0]+3*p*y[1])+(3*d*y[2]+p*y[3])*p*p}if((h=s>Z-2?Z-2:parseInt(Math.floor(s),10))===s)return a.Z.isFunction(b[h])?b[h]():b[h];for(l=0;l<2;l++)a.Z.isFunction(b[h+l])?y[l]=b[h+l]():y[l]=b[h+l];return y[0]+(y[1]-y[0])*(s-h)}},generateTerm:function(t,e,o,s,n){var h,l;a.Z.isArray(e)?(this.dataX=e,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray.apply(this,["X"]),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=a.Z.createFunction(e,this.board,t),a.Z.isString(e)?this.visProp.curvetype="functiongraph":(a.Z.isFunction(e)||a.Z.isNumber(e))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),a.Z.isArray(o)?(this.dataY=o,this.Y=this.interpolationFunctionFromArray.apply(this,["Y"])):this.Y=a.Z.createFunction(o,this.board,t),a.Z.isFunction(e)&&a.Z.isArray(o)&&(h=a.Z.createFunction(o[0],this.board,""),l=a.Z.createFunction(o[1],this.board,""),this.X=function(p){return e(p)*Math.cos(p)+h()},this.X.deps=h.deps,this.Y=function(p){return e(p)*Math.sin(p)+l()},this.Y.deps=l.deps,this.visProp.curvetype="polar"),a.Z.exists(s)&&(this.minX=a.Z.createFunction(s,this.board,"")),a.Z.exists(n)&&(this.maxX=a.Z.createFunction(n,this.board,"")),this.addParentsFromJCFunctions([this.X,this.Y,this.minX,this.maxX])},notifyParents:function(t){var e,o,s,n=!1;for(e in s={xterm:1,yterm:1})if(s.hasOwnProperty(e)&&this.hasOwnProperty(e)&&this[e].origin)for(o in n=!0,this[e].origin.deps)this[e].origin.deps.hasOwnProperty(o)&&this[e].origin.deps[o].addChild(this);n||ht.Z.findDependencies(this,t,this.board)},getLabelAnchor:function(){var t,e,o,s=.05*this.board.canvasWidth,n=.05*this.board.canvasHeight,h=.95*this.board.canvasWidth,l=.95*this.board.canvasHeight;switch(a.Z.evaluate(this.visProp.label.position)){case"ulft":e=s,o=n;break;case"llft":e=s,o=l;break;case"rt":e=h,o=.5*l;break;case"lrt":e=h,o=l;break;case"urt":e=h,o=n;break;case"top":e=.5*h,o=n;break;case"bot":e=.5*h,o=l;break;default:e=s,o=.5*l}return t=new m.Z(S.Z.COORDS_BY_SCREEN,[e,o],this.board,!1),_.Z.projectCoordsToCurve(t.usrCoords[1],t.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var t,e={id:this.id+"T"+this.numTraces,elementClass:S.Z.OBJECT_CLASS_CURVE,points:this.points.slice(0),bezierDegree:this.bezierDegree,numberPoints:this.numberPoints,board:this.board,visProp:a.Z.deepCopy(this.visProp,this.visProp.traceattributes,!0)};return e.visProp.layer=this.board.options.layer.trace,e.visProp.curvetype=this.visProp.curvetype,this.numTraces++,a.Z.clearVisPropOld(e),e.visPropCalc={visible:a.Z.evaluate(e.visProp.visible)},t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(e),this.board.renderer.enhancedRendering=t,this.traces[e.id]=e.rendNode,this},bounds:function(){var t,e,o,s=1/0,n=-1/0,h=1/0,l=-1/0,p=this.points.length;if(this.bezierDegree===3){for(t=0;t<p;t++)this.points[t].X=a.Z.bind(function(){return this.usrCoords[1]},this.points[t]),this.points[t].Y=a.Z.bind(function(){return this.usrCoords[2]},this.points[t]);return o=(e=c.Z.bezier(this.points))[3](),s=c.Z.fminbr(function(d){return e[0](d)},[0,o]),n=c.Z.fminbr(function(d){return-e[0](d)},[0,o]),h=c.Z.fminbr(function(d){return e[1](d)},[0,o]),l=c.Z.fminbr(function(d){return-e[1](d)},[0,o]),s=e[0](s),n=e[0](n),h=e[1](h),[s,l=e[1](l),n,h]}for(t=0;t<p;t++)s>this.points[t].usrCoords[1]&&(s=this.points[t].usrCoords[1]),n<this.points[t].usrCoords[1]&&(n=this.points[t].usrCoords[1]),h>this.points[t].usrCoords[2]&&(h=this.points[t].usrCoords[2]),l<this.points[t].usrCoords[2]&&(l=this.points[t].usrCoords[2]);return[s,l,n,h]},getParents:function(){var t=[this.xterm,this.yterm,this.minX(),this.maxX()];return this.parents.length!==0&&(t=this.parents),t},moveTo:function(t){var e,o=[];return this.points.length>0&&!a.Z.evaluate(this.visProp.fixed)&&(e=this.points[0],o=t.length===3?[t[0]-e.usrCoords[0],t[1]-e.usrCoords[1],t[2]-e.usrCoords[2]]:[t[0]-e.usrCoords[1],t[1]-e.usrCoords[2]],this.setPosition(S.Z.COORDS_BY_USER,o)),this},getTransformationSource:function(){var t,e;return a.Z.exists(this._transformationSource)&&(e=this._transformationSource).elementClass===S.Z.OBJECT_CLASS_CURVE&&(t=!0),[t,e]},pnpoly:function(t,e,o){var s,n,h,l,p,d,b=this.points,Z=!1;for(o===S.Z.COORDS_BY_USER?(l=(d=new m.Z(S.Z.COORDS_BY_USER,[t,e],this.board)).scrCoords[1],p=d.scrCoords[2]):(l=t,p=e),s=0,n=(h=this.points.length)-2;s<h-1;n=s++)b[s].scrCoords[2]>p!=b[n].scrCoords[2]>p&&l<(b[n].scrCoords[1]-b[s].scrCoords[1])*(p-b[s].scrCoords[2])/(b[n].scrCoords[2]-b[s].scrCoords[2])+b[s].scrCoords[1]&&(Z=!Z);return Z}}),u.Z.createCurve=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"curve");return s=t.select(e[0],!0),a.Z.isTransformationOrArray(e[1])&&a.Z.isObject(s)&&(s.type===S.Z.OBJECT_TYPE_CURVE||s.type===S.Z.OBJECT_TYPE_ANGLE||s.type===S.Z.OBJECT_TYPE_ARC||s.type===S.Z.OBJECT_TYPE_CONIC||s.type===S.Z.OBJECT_TYPE_SECTOR)?(s.type===S.Z.OBJECT_TYPE_SECTOR?h=a.Z.copyAttributes(o,t.options,"sector"):s.type===S.Z.OBJECT_TYPE_ARC?h=a.Z.copyAttributes(o,t.options,"arc"):s.type===S.Z.OBJECT_TYPE_ANGLE?(a.Z.exists(o.withLabel)||(o.withLabel=!1),h=a.Z.copyAttributes(o,t.options,"angle")):h=a.Z.copyAttributes(o,t.options,"curve"),h=a.Z.copyAttributes(h,t.options,"curve"),(n=new u.Z.Curve(t,["x",[],[]],h)).updateDataArray=function(){var l,p=s.numberPoints;for(this.bezierDegree=s.bezierDegree,this.dataX=[],this.dataY=[],l=0;l<p;l++)this.dataX.push(s.points[l].usrCoords[1]),this.dataY.push(s.points[l].usrCoords[2]);return this},n.addTransform(e[1]),s.addChild(n),n.setParents([s]),n._transformationSource=s,n):(h=a.Z.copyAttributes(o,t.options,"curve"),new u.Z.Curve(t,["x"].concat(e),h))},u.Z.registerElement("curve",u.Z.createCurve),u.Z.createFunctiongraph=function(t,e,o){var s,n=["x","x"].concat(e);return(s=a.Z.copyAttributes(o,t.options,"curve")).curvetype="functiongraph",new u.Z.Curve(t,n,s)},u.Z.registerElement("functiongraph",u.Z.createFunctiongraph),u.Z.registerElement("plot",u.Z.createFunctiongraph),u.Z.createSpline=function(t,e,o){var s,n,h;return n=function(){var l,p=[],d=[];return[function(b,Z){var y,O,x;if(!Z){if(p=[],d=[],e.length===2&&a.Z.isArray(e[0])&&a.Z.isArray(e[1])&&e[0].length===e[1].length)for(y=0;y<e[0].length;y++)a.Z.isFunction(e[0][y])?p.push(e[0][y]()):p.push(e[0][y]),a.Z.isFunction(e[1][y])?d.push(e[1][y]()):d.push(e[1][y]);else for(y=0;y<e.length;y++)if(a.Z.isPoint(e[y]))p.push(e[y].X()),d.push(e[y].Y());else if(a.Z.isArray(e[y])&&e[y].length===2)for(O=0;O<e.length;O++)a.Z.isFunction(e[O][0])?p.push(e[O][0]()):p.push(e[O][0]),a.Z.isFunction(e[O][1])?d.push(e[O][1]()):d.push(e[O][1]);else a.Z.isFunction(e[y])&&e[y]().length===2&&(x=e[y](),p.push(x[0]),d.push(x[1]));l=c.Z.splineDef(p,d)}return c.Z.splineEval(b,p,d,l)},function(){return p[0]},function(){return p[p.length-1]}]},(o=a.Z.copyAttributes(o,t.options,"curve")).curvetype="functiongraph",h=n(),(s=new u.Z.Curve(t,["x","x",h[0],h[1],h[2]],o)).setParents(e),s.elType="spline",s},u.Z.registerElement("spline",u.Z.createSpline),u.Z.createCardinalSpline=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x=`
Possible parent types: [points:array, tau:number|function, type:string]`;if(!a.Z.exists(e[0])||!a.Z.isArray(e[0]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 1 'points' has to be array of points or coordinate pairs"+x);if(!a.Z.exists(e[1])||!a.Z.isNumber(e[1])&&!a.Z.isFunction(e[1]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 2 'tau' has to be number between [0,1] or function'"+x);if(!a.Z.exists(e[2])||!a.Z.isString(e[2]))throw new Error("JSXGraph: JXG.createCardinalSpline: argument 3 'type' has to be string 'uniform' or 'centripetal'"+x);if(o=a.Z.copyAttributes(o,t.options,"curve"),(o=a.Z.copyAttributes(o,t.options,"cardinalspline")).curvetype="parameter",d=e[0],b=[],!o.isarrayofcoordinates&&d.length===2&&a.Z.isArray(d[0])&&a.Z.isArray(d[1])&&d[0].length===d[1].length)for(Z=0;Z<d[0].length;Z++)b[Z]=[],a.Z.isFunction(d[0][Z])?b[Z].push(d[0][Z]()):b[Z].push(d[0][Z]),a.Z.isFunction(d[1][Z])?b[Z].push(d[1][Z]()):b[Z].push(d[1][Z]);else for(Z=0;Z<d.length;Z++)a.Z.isString(d[Z])?b.push(t.select(d[Z])):a.Z.isPoint(d[Z])?b.push(d[Z]):a.Z.isArray(d[Z])&&d[Z].length===2?(b[Z]=[],a.Z.isFunction(d[Z][0])?b[Z].push(d[Z][0]()):b[Z].push(d[Z][0]),a.Z.isFunction(d[Z][1])?b[Z].push(d[Z][1]()):b[Z].push(d[Z][1])):a.Z.isFunction(d[Z])&&d[Z]().length===2&&b.push(e[Z]());if(o.createpoints===!0)h=a.Z.providePoints(t,b,o,"cardinalspline",["points"]);else for(h=[],n=function(D){return{X:function(){return b[D][0]},Y:function(){return b[D][1]},Dist:function(k){var I=this.X()-k.X(),U=this.Y()-k.Y();return Math.sqrt(I*I+U*U)}}},Z=0;Z<b.length;Z++)a.Z.isPoint(b[Z])?h.push(b[Z]):h.push(n(Z));for(l=e[1],p=e[2],O=["x"].concat(c.Z.CardinalSpline(h,l,p)),s=new u.Z.Curve(t,O,o),y=h.length,s.setParents(h),Z=0;Z<y;Z++)d=h[Z],a.Z.isPoint(d)&&(a.Z.exists(d._is_new)?(s.addChild(d),delete d._is_new):d.addChild(s));return s.elType="cardinalspline",s},u.Z.registerElement("cardinalspline",u.Z.createCardinalSpline),u.Z.createMetapostSpline=function(t,e,o){var s,n,h,l,p,d,b,Z,y=`
Possible parent types: [points:array, controls:object`;if(!a.Z.exists(e[0])||!a.Z.isArray(e[0]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 1 'points' has to be array of points or coordinate pairs"+y);if(!a.Z.exists(e[1])||!a.Z.isObject(e[1]))throw new Error("JSXGraph: JXG.createMetapostSpline: argument 2 'controls' has to be a JavaScript object'"+y);if(o=a.Z.copyAttributes(o,t.options,"curve"),(o=a.Z.copyAttributes(o,t.options,"metapostspline")).curvetype="parameter",p=e[0],d=[],!o.isarrayofcoordinates&&p.length===2&&a.Z.isArray(p[0])&&a.Z.isArray(p[1])&&p[0].length===p[1].length)for(b=0;b<p[0].length;b++)d[b]=[],a.Z.isFunction(p[0][b])?d[b].push(p[0][b]()):d[b].push(p[0][b]),a.Z.isFunction(p[1][b])?d[b].push(p[1][b]()):d[b].push(p[1][b]);else for(b=0;b<p.length;b++)a.Z.isString(p[b])?d.push(t.select(p[b])):a.Z.isPoint(p[b])?d.push(p[b]):a.Z.isArray(p[b])&&p[b].length===2?(d[b]=[],a.Z.isFunction(p[b][0])?d[b].push(p[b][0]()):d[b].push(p[b][0]),a.Z.isFunction(p[b][1])?d[b].push(p[b][1]()):d[b].push(p[b][1])):a.Z.isFunction(p[b])&&p[b]().length===2&&d.push(e[b]());if(o.createpoints===!0)h=a.Z.providePoints(t,d,o,"metapostspline",["points"]);else for(h=[],n=function(O){return{X:function(){return d[O][0]},Y:function(){return d[O][1]}}},b=0;b<d.length;b++)a.Z.isPoint(d[b])?h.push(d[b]):h.push(n);for(l=e[1],(s=new u.Z.Curve(t,["t",[],[],0,p.length-1],o)).updateDataArray=function(){var O,x,D=h.length,k=[];for(x=0;x<D;x++)k.push([h[x].X(),h[x].Y()]);O=u.Z.Math.Metapost.curve(k,l),this.dataX=O[0],this.dataY=O[1]},s.bezierDegree=3,Z=h.length,s.setParents(h),b=0;b<Z;b++)a.Z.isPoint(h[b])&&h[b].addChild(s);return s.elType="metapostspline",s},u.Z.registerElement("metapostspline",u.Z.createMetapostSpline),u.Z.createRiemannsum=function(t,e,o){var s,n,h,l,p,d;if((d=a.Z.copyAttributes(o,t.options,"riemannsum")).curvetype="plot",h=e[0],s=a.Z.createFunction(e[1],t,""),!a.Z.exists(s))throw new Error(`JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);if(n=a.Z.createFunction(e[2],t,"",!1),!a.Z.exists(n))throw new Error(`JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.
Possible parent types: [function,n:number|function,type,start:number|function,end:number|function]`);return l=[[0],[0]].concat(e.slice(3)),(p=t.create("curve",l,d)).sum=0,p.Value=function(){return this.sum},p.updateDataArray=function(){var b=c.Z.riemann(h,s(),n(),this.minX(),this.maxX());this.dataX=b[0],this.dataY=b[1],this.sum=b[2]},p.addParentsFromJCFunctions([s,n]),p},u.Z.registerElement("riemannsum",u.Z.createRiemannsum),u.Z.createTracecurve=function(t,e,o){var s,n,h,l;if(e.length!==2)throw new Error(`JSXGraph: Can't create trace curve with given parent'
Possible parent types: [glider, point]`);if(n=t.select(e[0]),h=t.select(e[1]),n.type!==S.Z.OBJECT_TYPE_GLIDER||!a.Z.isPoint(h))throw new Error("JSXGraph: Can't create trace curve with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [glider, point]`);return(l=a.Z.copyAttributes(o,t.options,"tracecurve")).curvetype="plot",(s=t.create("curve",[[0],[0]],l)).updateDataArray=function(){var p,d,b,Z,y,O,x,D,k,I=l.numberpoints,U=n.position,J=n.slideObject,z=J.minX();for(d=(J.maxX()-z)/I,this.dataX=[],this.dataY=[],J.elementClass!==S.Z.OBJECT_CLASS_CURVE&&I++,p=0;p<I;p++){for(Z in b=z+p*d,O=J.X(b)/J.Z(b),x=J.Y(b)/J.Z(b),n.setPositionDirectly(S.Z.COORDS_BY_USER,[O,x]),D=!1,this.board.objects)if(this.board.objects.hasOwnProperty(Z)&&((y=this.board.objects[Z])===n&&(D=!0),D&&y.needsRegularUpdate&&(k=y.visProp.trace,y.visProp.trace=!1,y.needsUpdate=!0,y.update(!0),y.visProp.trace=k,y===h)))break;this.dataX[p]=h.X(),this.dataY[p]=h.Y()}for(Z in n.position=U,D=!1,this.board.objects)if(this.board.objects.hasOwnProperty(Z)&&((y=this.board.objects[Z])===n&&(D=!0),D&&y.needsRegularUpdate&&(k=y.visProp.trace,y.visProp.trace=!1,y.needsUpdate=!0,y.update(!0),y.visProp.trace=k,y===h)))break},s},u.Z.registerElement("tracecurve",u.Z.createTracecurve),u.Z.createStepfunction=function(t,e,o){var s,n;if(e.length!==2)throw new Error(`JSXGraph: Can't create step function with given parent'
Possible parent types: [array, array|function]`);return n=a.Z.copyAttributes(o,t.options,"stepfunction"),(s=t.create("curve",e,n)).updateDataArray=function(){var h,l=0,p=this.xterm.length;if(this.dataX=[],this.dataY=[],p!==0)for(this.dataX[l]=this.xterm[0],this.dataY[l]=this.yterm[0],++l,h=1;h<p;++h)this.dataX[l]=this.xterm[h],this.dataY[l]=this.dataY[l-1],++l,this.dataX[l]=this.xterm[h],this.dataY[l]=this.yterm[h],++l},s},u.Z.registerElement("stepfunction",u.Z.createStepfunction),u.Z.createDerivative=function(t,e,o){var s,n,h,l,p;if(e.length!==1&&e[0].class!==S.Z.OBJECT_CLASS_CURVE)throw new Error(`JSXGraph: Can't create derivative curve with given parent'
Possible parent types: [curve]`);return p=a.Z.copyAttributes(o,t.options,"curve"),n=e[0],h=c.Z.D(n.X),l=c.Z.D(n.Y),(s=t.create("curve",[function(d){return n.X(d)},function(d){return l(d)/h(d)},n.minX(),n.maxX()],p)).setParents(n),s},u.Z.registerElement("derivative",u.Z.createDerivative),u.Z.createCurveIntersection=function(t,e,o){var s;if(e.length!==2)throw new Error(`JSXGraph: Can't create curve intersection with given parent'
Possible parent types: [array, array|function]`);return(s=t.create("curve",[[],[]],o)).updateDataArray=function(){var n=u.Z.Math.Clip.intersection(e[0],e[1],this.board);this.dataX=n[0],this.dataY=n[1]},s},u.Z.createCurveUnion=function(t,e,o){var s;if(e.length!==2)throw new Error(`JSXGraph: Can't create curve union with given parent'
Possible parent types: [array, array|function]`);return(s=t.create("curve",[[],[]],o)).updateDataArray=function(){var n=u.Z.Math.Clip.union(e[0],e[1],this.board);this.dataX=n[0],this.dataY=n[1]},s},u.Z.createCurveDifference=function(t,e,o){var s;if(e.length!==2)throw new Error(`JSXGraph: Can't create curve difference with given parent'
Possible parent types: [array, array|function]`);return(s=t.create("curve",[[],[]],o)).updateDataArray=function(){var n=u.Z.Math.Clip.difference(e[0],e[1],this.board);this.dataX=n[0],this.dataY=n[1]},s},u.Z.registerElement("curvedifference",u.Z.createCurveDifference),u.Z.registerElement("curveintersection",u.Z.createCurveIntersection),u.Z.registerElement("curveunion",u.Z.createCurveUnion),u.Z.createBoxPlot=function(t,e,o){var s,n,h,l=a.Z.copyAttributes(o,t.options,"boxplot");if(e.length!==3)throw new Error(`JSXGraph: Can't create box plot with given parent'
Possible parent types: [array, number|function, number|function] containing quantiles, axis, width`);if(e[0].length<5)throw new Error(`JSXGraph: Can't create box plot with given parent[0]'
parent[0] has to conatin at least 5 quantiles.`);for(s=t.create("curve",[[],[]],l),h=e[0].length,s.Q=[],n=0;n<h;n++)s.Q[n]=a.Z.createFunction(e[0][n],t,null,!0);return s.x=a.Z.createFunction(e[1],t,null,!0),s.w=a.Z.createFunction(e[2],t,null,!0),s.updateDataArray=function(){var p,d,b,Z,y,O,x,D,k;x=a.Z.evaluate(this.visProp.smallwidth),D=a.Z.evaluate(this.visProp.dir),b=(k=this.x())-.5*this.w(),Z=k-.5*this.w()*x,y=k+.5*this.w(),p=[k,Z,O=k+.5*this.w()*x,k,k,b,b,y,y,k,NaN,b,y,NaN,k,k,Z,O,k],d=[this.Q[0](),this.Q[0](),this.Q[0](),this.Q[0](),this.Q[1](),this.Q[1](),this.Q[3](),this.Q[3](),this.Q[1](),this.Q[1](),NaN,this.Q[2](),this.Q[2](),NaN,this.Q[3](),this.Q[4](),this.Q[4](),this.Q[4](),this.Q[4]()],D==="vertical"?(this.dataX=p,this.dataY=d):(this.dataX=d,this.dataY=p)},s.addParentsFromJCFunctions([s.Q,s.x,s.w]),s},u.Z.registerElement("boxplot",u.Z.createBoxPlot),u.Z.Curve,u.Z.createArc=function(t,e,o){var s,n,h;if((h=a.Z.providePoints(t,e,o,"arc",["center","radiusPoint","anglePoint"]))===!1||h.length<3)throw new Error("JSXGraph: Can't create Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point], [arc, transformation]`);return n=a.Z.copyAttributes(o,t.options,"arc"),(s=t.create("curve",[[0],[0]],n)).elType="arc",s.setParents(h),s.type=S.Z.OBJECT_TYPE_ARC,s.center=h[0],s.radiuspoint=h[1],s.point2=s.radiuspoint,s.anglepoint=h[2],s.point3=s.anglepoint,a.Z.exists(s.center._is_new)?(s.addChild(s.center),delete s.center._is_new):s.center.addChild(s),a.Z.exists(s.radiuspoint._is_new)?(s.addChild(s.radiuspoint),delete s.radiuspoint._is_new):s.radiuspoint.addChild(s),a.Z.exists(s.anglepoint._is_new)?(s.addChild(s.anglepoint),delete s.anglepoint._is_new):s.anglepoint.addChild(s),s.useDirection=n.usedirection,s.updateDataArray=function(){var l,p,d,b,Z,y=1,O=this.radiuspoint,x=this.center,D=this.anglepoint,k=a.Z.evaluate(this.visProp.selection);p=_.Z.rad(O,x,D),(k==="minor"&&p>Math.PI||k==="major"&&p<Math.PI)&&(y=-1),this.useDirection&&(d=h[1].coords.usrCoords,b=h[3].coords.usrCoords,Z=h[2].coords.usrCoords,(d[1]-Z[1])*(d[2]-b[2])-(d[2]-Z[2])*(d[1]-b[1])<0?(this.radiuspoint=h[1],this.anglepoint=h[2]):(this.radiuspoint=h[2],this.anglepoint=h[1])),O=O.coords.usrCoords,x=x.coords.usrCoords,D=D.coords.usrCoords,l=_.Z.bezierArc(O,x,D,!1,y),this.dataX=l[0],this.dataY=l[1],this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},s.Radius=function(){return this.radiuspoint.Dist(this.center)},s.getRadius=function(){return u.Z.deprecated("Arc.getRadius()","Arc.Radius()"),this.Radius()},s.Value=function(){return this.Radius()*_.Z.rad(this.radiuspoint,this.center,this.anglepoint)},s.hasPoint=function(l,p){var d,b,Z,y,O,x,D,k=this.Radius();return a.Z.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(l,p):(a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(D=this.board._inputDevice,x=a.Z.evaluate(this.visProp.precision[D])):x=this.board.options.precision.hasPoint,x/=Math.min(this.board.unitX,this.board.unitY),b=new m.Z(S.Z.COORDS_BY_SCREEN,[l,p],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),y=B.Z.inverse(this.transformMat),O=B.Z.matVecMult(y,b.usrCoords),b=new m.Z(S.Z.COORDS_BY_USER,O,this.board)),d=this.center.coords.distance(S.Z.COORDS_BY_USER,b),(Z=Math.abs(d-k)<x)&&(Z=_.Z.coordsOnArc(this,b)),Z)},s.hasPointSector=function(l,p){var d=new m.Z(S.Z.COORDS_BY_SCREEN,[l,p],this.board),b=this.Radius(),Z=this.center.coords.distance(S.Z.COORDS_BY_USER,d)<b;return Z&&(Z=_.Z.coordsOnArc(this,d)),Z},s.getTextAnchor=function(){return this.center.coords},s.getLabelAnchor=function(){var l,p,d,b,Z,y=_.Z.rad(this.radiuspoint,this.center,this.anglepoint),O=10/this.board.unitX,x=10/this.board.unitY,D=this.point2.coords.usrCoords,k=this.center.coords.usrCoords,I=D[1]-k[1],U=D[2]-k[2],J=a.Z.evaluate(this.visProp.selection),z=this.label?this.label.visProp:this.visProp.label;return(J==="minor"&&y>Math.PI||J==="major"&&y<Math.PI)&&(y=-(2*Math.PI-y)),d=(l=new m.Z(S.Z.COORDS_BY_USER,[k[1]+Math.cos(.5*y)*I-Math.sin(.5*y)*U,k[2]+Math.sin(.5*y)*I+Math.cos(.5*y)*U],this.board)).usrCoords[1]-k[1],b=l.usrCoords[2]-k[2],d=d*((Z=Math.sqrt(d*d+b*b))+O)/Z,b=b*(Z+x)/Z,p=[k[1]+d,k[2]+b],z.position=_.Z.calcLabelQuadrant(_.Z.rad([1,0],[0,0],p)),new m.Z(S.Z.COORDS_BY_USER,p,this.board)},s.updateQuadraticform=pe.prototype.updateQuadraticform,s.updateStdform=pe.prototype.updateStdform,s.methodMap=u.Z.deepCopy(s.methodMap,{getRadius:"getRadius",radius:"Radius",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",Value:"Value"}),s.prepareUpdate().update(),s},u.Z.registerElement("arc",u.Z.createArc),u.Z.createSemicircle=function(t,e,o){var s,n,h,l;if((l=a.Z.providePoints(t,e,o,"point"))===!1||l.length!==2)throw new Error("JSXGraph: Can't create Semicircle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point]`);return h=a.Z.copyAttributes(o,t.options,"semicircle","center"),(n=t.create("midpoint",l,h)).dump=!1,h=a.Z.copyAttributes(o,t.options,"semicircle"),(s=t.create("arc",[n,l[1],l[0]],h)).elType="semicircle",s.setParents([l[0].id,l[1].id]),s.subs={midpoint:n},s.inherits.push(n),s.midpoint=s.center=n,s},u.Z.registerElement("semicircle",u.Z.createSemicircle),u.Z.createCircumcircleArc=function(t,e,o){var s,n,h,l;if((l=a.Z.providePoints(t,e,o,"point"))===!1||l.length!==3)throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);return h=a.Z.copyAttributes(o,t.options,"circumcirclearc","center"),(n=t.create("circumcenter",l,h)).dump=!1,(h=a.Z.copyAttributes(o,t.options,"circumcirclearc")).usedirection=!0,(s=t.create("arc",[n,l[0],l[2],l[1]],h)).elType="circumcirclearc",s.setParents([l[0].id,l[1].id,l[2].id]),s.subs={center:n},s.inherits.push(n),s.center=n,s},u.Z.registerElement("circumcirclearc",u.Z.createCircumcircleArc),u.Z.createMinorArc=function(t,e,o){return o.selection="minor",u.Z.createArc(t,e,o)},u.Z.registerElement("minorarc",u.Z.createMinorArc),u.Z.createMajorArc=function(t,e,o){return o.selection="major",u.Z.createArc(t,e,o)},u.Z.registerElement("majorarc",u.Z.createMajorArc),u.Z.createSector=function(t,e,o){var s,n,h,l,p,d,b="invalid";if(e[0].elementClass===S.Z.OBJECT_CLASS_LINE&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE&&(a.Z.isArray(e[2])||a.Z.isNumber(e[2]))&&(a.Z.isArray(e[3])||a.Z.isNumber(e[3]))&&(a.Z.isNumber(e[4])||a.Z.isFunction(e[4])||a.Z.isString(e[4])))b="2lines";else{if((d=a.Z.providePoints(t,e,o,"sector",["center","radiusPoint","anglePoint"]))===!1)throw new Error("JSXGraph: Can't create Sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");b="3points"}if(n=a.Z.copyAttributes(o,t.options,"sector"),(s=t.create("curve",[[0],[0]],n)).type=S.Z.OBJECT_TYPE_SECTOR,s.elType="sector",s.autoRadius=function(){var Z=20/s.board.unitX,y=1/0,O=50/s.board.unitX;return a.Z.isPoint(s.center)&&(y=.3333*s.center.Dist(s.point2)),Math.max(Z,Math.min(y,O))},b==="2lines")s.Radius=function(){var Z=a.Z.evaluate(e[4]);return Z==="auto"?this.autoRadius():Z},s.line1=t.select(e[0]),s.line2=t.select(e[1]),s.line1.addChild(s),s.line2.addChild(s),s.setParents(e),s.point1={visProp:{}},s.point2={visProp:{}},s.point3={visProp:{}},l=_.Z.meetLineLine(s.line1.stdform,s.line2.stdform,0,t),a.Z.isArray(e[2])?(e[2].length===2&&(e[2]=[1].concat(e[2])),p=_.Z.projectPointToLine({coords:{usrCoords:e[2]}},s.line1,t),p=v.Z.subtract(p.usrCoords,l.usrCoords),s.direction1=B.Z.innerProduct(p,[0,s.line1.stdform[2],-s.line1.stdform[1]],3)>=0?1:-1):s.direction1=e[2]>=0?1:-1,a.Z.isArray(e[3])?(e[3].length===2&&(e[3]=[1].concat(e[3])),p=_.Z.projectPointToLine({coords:{usrCoords:e[3]}},s.line2,t),p=v.Z.subtract(p.usrCoords,l.usrCoords),s.direction2=B.Z.innerProduct(p,[0,s.line2.stdform[2],-s.line2.stdform[1]],3)>=0?1:-1):s.direction2=e[3]>=0?1:-1,s.updateDataArray=function(){var Z,y,O,x,D,k,I=[0,0,0];if(y=this.line1,O=this.line2,I=B.Z.crossProduct(y.stdform,O.stdform),Math.abs(I[0])>B.Z.eps*B.Z.eps&&(I[1]/=I[0],I[2]/=I[0],I[0]/=I[0]),Z=this.direction1*this.Radius(),x=v.Z.add(I,[0,Z*y.stdform[2],-Z*y.stdform[1]]),Z=this.direction2*this.Radius(),D=v.Z.add(I,[0,Z*O.stdform[2],-Z*O.stdform[1]]),this.point2.coords=new m.Z(S.Z.COORDS_BY_USER,x,s.board),this.point1.coords=new m.Z(S.Z.COORDS_BY_USER,I,s.board),this.point3.coords=new m.Z(S.Z.COORDS_BY_USER,D,s.board),Math.abs(x[0])<B.Z.eps||Math.abs(I[0])<B.Z.eps||Math.abs(D[0])<B.Z.eps)return this.dataX=[NaN],void(this.dataY=[NaN]);k=_.Z.bezierArc(x,I,D,!0,1),this.dataX=k[0],this.dataY=k[1],this.bezierDegree=3},s.methodMap=u.Z.deepCopy(s.methodMap,{radius:"Radius",getRadius:"Radius",setRadius:"setRadius"});else if(b==="3points"){for(s.point1=d[0],s.point2=d[1],s.point3=d[2],h=0;h<3;h++)a.Z.exists(d[h]._is_new)?(s.addChild(d[h]),delete d[h]._is_new):d[h].addChild(s);s.useDirection=o.usedirection,s.setParents(d),a.Z.exists(d[3])&&(s.point4=d[3],s.point4.addChild(s)),s.methodMap=u.Z.deepCopy(s.methodMap,{arc:"arc",center:"center",radiuspoint:"radiuspoint",anglepoint:"anglepoint",radius:"Radius",getRadius:"Radius",setRadius:"setRadius"}),s.updateDataArray=function(){var Z,y,O,x,D,k=this.point2,I=this.point1,U=this.point3,J=1,z=a.Z.evaluate(this.visProp.selection);if(!k.isReal||!I.isReal||!U.isReal)return this.dataX=[NaN],void(this.dataY=[NaN]);D=_.Z.rad(k,I,U),(z==="minor"&&D>Math.PI||z==="major"&&D<Math.PI)&&(J=-1),this.useDirection&&a.Z.exists(this.point4)&&(y=this.point2.coords.usrCoords,O=this.point4.coords.usrCoords,x=this.point3.coords.usrCoords,(y[1]-x[1])*(y[2]-O[2])-(y[2]-x[2])*(y[1]-O[1])>=0&&(U=this.point2,k=this.point3)),k=k.coords.usrCoords,I=I.coords.usrCoords,U=U.coords.usrCoords,Z=_.Z.bezierArc(k,I,U,!0,J),this.dataX=Z[0],this.dataY=Z[1],this.bezierDegree=3},s.Radius=function(){return this.point2.Dist(this.point1)},(n=a.Z.copyAttributes(o,t.options,"sector","arc")).withLabel=!1,n.name+="_arc",s.arc=t.create("arc",[s.point1,s.point2,s.point3],n),s.addChild(s.arc)}return s.center=s.point1,s.radiuspoint=s.point2,s.anglepoint=s.point3,s.hasPointCurve=function(Z,y){var O,x,D,k,I,U,J=new m.Z(S.Z.COORDS_BY_SCREEN,[Z,y],this.board),z=this.Radius(),V=this.center.coords.distance(S.Z.COORDS_BY_USER,J),W=a.Z.evaluate(this.visProp.selection);return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(I=this.board._inputDevice,k=a.Z.evaluate(this.visProp.precision[I])):k=this.board.options.precision.hasPoint,k/=Math.min(this.board.unitX,this.board.unitY),(U=Math.abs(V-z)<k)&&(O=_.Z.rad(this.point2,this.center,J.usrCoords.slice(1)),x=0,D=_.Z.rad(this.point2,this.center,this.point3),(W==="minor"&&D>Math.PI||W==="major"&&D<Math.PI)&&(x=D,D=2*Math.PI),(O<x||O>D)&&(U=!1)),U},s.hasPointSector=function(Z,y){var O,x,D,k=new m.Z(S.Z.COORDS_BY_SCREEN,[Z,y],this.board),I=this.Radius(),U=this.point1.coords.distance(S.Z.COORDS_BY_USER,k)<I,J=a.Z.evaluate(this.visProp.selection);return U&&(O=_.Z.rad(this.radiuspoint,this.center,k.usrCoords.slice(1)),x=0,D=_.Z.rad(this.radiuspoint,this.center,this.anglepoint),(J==="minor"&&D>Math.PI||J==="major"&&D<Math.PI)&&(x=D,D=2*Math.PI),(O<x||O>D)&&(U=!1)),U},s.hasPoint=function(Z,y){return a.Z.evaluate(this.visProp.highlightonsector)||a.Z.evaluate(this.visProp.hasinnerpoints)?this.hasPointSector(Z,y):this.hasPointCurve(Z,y)},s.getTextAnchor=function(){return this.point1.coords},s.getLabelAnchor=function(){var Z,y,O,x,D,k=_.Z.rad(this.point2,this.point1,this.point3),I=13/this.board.unitX,U=13/this.board.unitY,J=this.point2.coords.usrCoords,z=this.point1.coords.usrCoords,V=J[1]-z[1],W=J[2]-z[2],$=a.Z.evaluate(this.visProp.selection),nt=this.label?this.label.visProp:this.visProp.label;return($==="minor"&&k>Math.PI||$==="major"&&k<Math.PI)&&(k=-(2*Math.PI-k)),O=(Z=new m.Z(S.Z.COORDS_BY_USER,[z[1]+Math.cos(.5*k)*V-Math.sin(.5*k)*W,z[2]+Math.sin(.5*k)*V+Math.cos(.5*k)*W],this.board)).usrCoords[1]-z[1],x=Z.usrCoords[2]-z[2],O=O*((D=Math.sqrt(O*O+x*x))+I)/D,x=x*(D+U)/D,y=[z[1]+O,z[2]+x],nt.position=_.Z.calcLabelQuadrant(_.Z.rad([1,0],[0,0],y)),new m.Z(S.Z.COORDS_BY_USER,y,this.board)},s.setRadius=function(Z){s.Radius=function(){var y=a.Z.evaluate(Z);return y==="auto"?this.autoRadius():y}},s.getRadius=function(){return u.Z.deprecated("Sector.getRadius()","Sector.Radius()"),this.Radius()},b==="3points"&&(s.setPositionDirectly=function(Z,y,O){var x,D=new m.Z(Z,y,this.board),k=new m.Z(Z,O,this.board);return s.point1.draggable()&&s.point2.draggable()&&s.point3.draggable()?(x=v.Z.subtract(D.usrCoords,k.usrCoords),this.board.create("transform",x.slice(1),{type:"translate"}).applyOnce([s.point1,s.point2,s.point3]),this):this}),s.prepareUpdate().update(),s},u.Z.registerElement("sector",u.Z.createSector),u.Z.createCircumcircleSector=function(t,e,o){var s,n,h,l;if((l=a.Z.providePoints(t,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");return(n=t.create("circumcenter",l.slice(0,3),h)).dump=!1,h=a.Z.copyAttributes(o,t.options,"circumcirclesector"),(s=t.create("sector",[n,l[0],l[2],l[1]],h)).elType="circumcirclesector",s.setParents(l),s.center=n,s.subs={center:n},s},u.Z.registerElement("circumcirclesector",u.Z.createCircumcircleSector),u.Z.createMinorSector=function(t,e,o){return o.selection="minor",u.Z.createSector(t,e,o)},u.Z.registerElement("minorsector",u.Z.createMinorSector),u.Z.createMajorSector=function(t,e,o){return o.selection="major",u.Z.createSector(t,e,o)},u.Z.registerElement("majorsector",u.Z.createMajorSector),u.Z.createAngle=function(t,e,o){var s,n,h,l,p,d,b="invalid";if(e[0].elementClass===S.Z.OBJECT_CLASS_LINE&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE&&(a.Z.isArray(e[2])||a.Z.isNumber(e[2]))&&(a.Z.isArray(e[3])||a.Z.isNumber(e[3])))b="2lines";else{if((d=a.Z.providePoints(t,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create angle with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"' and '"+typeof e[2]+"'.");b="3points"}if(h=a.Z.copyAttributes(o,t.options,"angle"),a.Z.exists(h.name)&&h.name!==""||(h.name=t.generateName({type:S.Z.OBJECT_TYPE_ANGLE})),n=a.Z.exists(h.radius)?h.radius:0,b==="2lines"?(e.push(n),(s=t.create("sector",e,h)).updateDataArraySector=s.updateDataArray,s.setAngle=function(Z){},s.free=function(Z){}):((s=t.create("sector",[d[1],d[0],d[2]],h)).arc.visProp.priv=!0,s.point=s.point2=s.radiuspoint=d[0],s.pointsquare=s.point3=s.anglepoint=d[2],s.Radius=function(){var Z=a.Z.evaluate(n);return Z==="auto"?s.autoRadius():Z},s.updateDataArraySector=function(){var Z,y,O=this.point2,x=this.point1,D=this.point3,k=this.Radius(),I=x.Dist(O),U=1,J=a.Z.evaluate(this.visProp.selection);y=_.Z.rad(O,x,D),(J==="minor"&&y>Math.PI||J==="major"&&y<Math.PI)&&(U=-1),O=O.coords.usrCoords,x=x.coords.usrCoords,D=D.coords.usrCoords,O=[1,x[1]+(O[1]-x[1])*k/I,x[2]+(O[2]-x[2])*k/I],D=[1,x[1]+(D[1]-x[1])*k/I,x[2]+(D[2]-x[2])*k/I],Z=_.Z.bezierArc(O,x,D,!0,U),this.dataX=Z[0],this.dataY=Z[1],this.bezierDegree=3},s.setAngle=function(Z){var y,O,x,D=this.anglepoint,k=this.radiuspoint;return D.draggable()&&(y=this.board.create("transform",[Z,this.center],{type:"rotate"}),D.addTransform(k,y),y.update(),D.moveTo(B.Z.matVecMult(y.matrix,k.coords.usrCoords)),x=a.Z.isFunction(Z)?function(){return 2*Math.PI-Z()}:function(){return 2*Math.PI-Z},O=this.board.create("transform",[x,this.center],{type:"rotate"}),D.coords.on("update",function(){O.update(),k.moveTo(B.Z.matVecMult(O.matrix,D.coords.usrCoords))}),D.setParents(k)),this},s.free=function(){var Z=this.anglepoint;return Z.transformations.length>0&&(Z.transformations.pop(),Z.isDraggable=!0,Z.parents=[],Z.coords.off("update")),this},s.setParents(d)),a.Z.exists(s.visProp.text)&&s.label.setText(a.Z.evaluate(s.visProp.text)),s.elType="angle",s.type=S.Z.OBJECT_TYPE_ANGLE,s.subs={},s.updateDataArraySquare=function(){var Z,y,O,x,D,k,I,U,J=this.Radius();b==="2lines"&&this.updateDataArraySector(),Z=this.point2,y=this.point1,O=this.point3,Z=Z.coords.usrCoords,y=y.coords.usrCoords,O=O.coords.usrCoords,x=_.Z.distance(Z,y,3),D=_.Z.distance(O,y,3),Z=[1,y[1]+(Z[1]-y[1])*J/x,y[2]+(Z[2]-y[2])*J/x],O=[1,y[1]+(O[1]-y[1])*J/D,y[2]+(O[2]-y[2])*J/D],k=B.Z.crossProduct(O,y),I=[-Z[1]*k[1]-Z[2]*k[2],Z[0]*k[1],Z[0]*k[2]],k=B.Z.crossProduct(Z,y),U=[-O[1]*k[1]-O[2]*k[2],O[0]*k[1],O[0]*k[2]],(k=B.Z.crossProduct(I,U))[1]/=k[0],k[2]/=k[0],this.dataX=[y[1],Z[1],k[1],O[1],y[1]],this.dataY=[y[2],Z[2],k[2],O[2],y[2]],this.bezierDegree=1},s.updateDataArrayNone=function(){this.dataX=[NaN],this.dataY=[NaN],this.bezierDegree=1},s.updateDataArray=function(){var Z=a.Z.evaluate(this.visProp.type),y=_.Z.trueAngle(this.point2,this.point1,this.point3),O=a.Z.evaluate(this.visProp.selection);(O==="minor"&&y>180||O==="major"&&y<180)&&(y=360-y),Math.abs(y-90)<a.Z.evaluate(this.visProp.orthosensitivity)+B.Z.eps&&(Z=a.Z.evaluate(this.visProp.orthotype)),Z==="none"?this.updateDataArrayNone():Z==="square"?this.updateDataArraySquare():Z==="sector"?this.updateDataArraySector():Z==="sectordot"&&(this.updateDataArraySector(),this.dot.visProp.visible||this.dot.setAttribute({visible:!0})),(!this.visProp.visible||Z!=="sectordot"&&this.dot.visProp.visible)&&this.dot.setAttribute({visible:!1})},l=a.Z.copyAttributes(o,t.options,"angle","dot"),s.dot=t.create("point",[function(){var Z,y,O,x,D,k,I,U,J;return a.Z.exists(s.dot)&&!s.dot.visProp.visible?[0,0]:(Z=s.point2.coords.usrCoords,y=s.point1.coords.usrCoords,O=s.Radius(),x=_.Z.distance(Z,y,3),D=_.Z.rad(s.point2,s.point1,s.point3),((J=a.Z.evaluate(s.visProp.selection))==="minor"&&D>Math.PI||J==="major"&&D<Math.PI)&&(D=-(2*Math.PI-D)),D*=.5,k=Math.cos(D),I=Math.sin(D),Z=[1,y[1]+(Z[1]-y[1])*O/x,y[2]+(Z[2]-y[2])*O/x],U=[[1,0,0],[y[1]-.5*y[1]*k+.5*y[2]*I,.5*k,.5*-I],[y[2]-.5*y[1]*I-.5*y[2]*k,.5*I,.5*k]],B.Z.matVecMult(U,Z))}],l),s.dot.dump=!1,s.subs.dot=s.dot,b==="2lines")for(p=0;p<2;p++)t.select(e[p]).addChild(s.dot);else for(p=0;p<3;p++)t.select(d[p]).addChild(s.dot);return s.getLabelAnchor=function(){var Z,y,O,x,D,k,I,U,J,z=12,V=a.Z.evaluate(s.visProp.selection),W=this.label?this.label.visProp:this.visProp.label;return a.Z.exists(this.label.visProp.fontSize)&&(z=a.Z.evaluate(this.label.visProp.fontSize)),z/=this.board.unitX,y=s.point2.coords.usrCoords,O=s.point1.coords.usrCoords,x=s.Radius(),D=_.Z.distance(y,O,3),k=_.Z.rad(s.point2,s.point1,s.point3),(V==="minor"&&k>Math.PI||V==="major"&&k<Math.PI)&&(k=-(2*Math.PI-k)),k*=.5,I=Math.cos(k),U=Math.sin(k),y=[1,O[1]+(y[1]-O[1])*x/D,O[2]+(y[2]-O[2])*x/D],J=[[1,0,0],[O[1]-.5*O[1]*I+.5*O[2]*U,.5*I,.5*-U],[O[2]-.5*O[1]*U-.5*O[2]*I,.5*U,.5*I]],(Z=B.Z.matVecMult(J,y))[1]/=Z[0],Z[2]/=Z[0],Z[0]/=Z[0],D=_.Z.distance(Z,O,3),Z=[Z[0],O[1]+(Z[1]-O[1])*(x+z)/D,O[2]+(Z[2]-O[2])*(x+z)/D],W.position=_.Z.calcLabelQuadrant(_.Z.rad([1,0],[0,0],Z)),new m.Z(S.Z.COORDS_BY_USER,Z,this.board)},s.Value=function(){return _.Z.rad(this.point2,this.point1,this.point3)},s.methodMap=a.Z.deepCopy(s.methodMap,{Value:"Value",setAngle:"setAngle",free:"free"}),s},u.Z.registerElement("angle",u.Z.createAngle),u.Z.createNonreflexAngle=function(t,e,o){var s;return o.selection="minor",(s=u.Z.createAngle(t,e,o)).Value=function(){var n=_.Z.rad(this.point2,this.point1,this.point3);return n<Math.PI?n:2*Math.PI-n},s},u.Z.registerElement("nonreflexangle",u.Z.createNonreflexAngle),u.Z.createReflexAngle=function(t,e,o){var s;return o.selection="major",(s=u.Z.createAngle(t,e,o)).Value=function(){var n=_.Z.rad(this.point2,this.point1,this.point3);return n>=Math.PI?n:2*Math.PI-n},s},u.Z.registerElement("reflexangle",u.Z.createReflexAngle),u.Z.createOrthogonalProjection=function(t,e,o){var s,n,h,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),a.Z.isPointType(t,e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE)n=a.Z.providePoints(t,[e[0]],o,"point")[0],s=e[1];else{if(!a.Z.isPointType(t,e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line]`);n=a.Z.providePoints(t,[e[1]],o,"point")[0],s=e[0]}return l=a.Z.copyAttributes(o,t.options,"orthogonalprojection"),h=t.create("point",[function(){return _.Z.projectPointToLine(n,s,t)}],l),a.Z.exists(n._is_new)?(h.addChild(n),delete n._is_new):n.addChild(h),s.addChild(h),h.elType="orthogonalprojection",h.setParents([n.id,h.id]),h.update(),h.generatePolynomial=function(){var p=s.point1.symbolic.x,d=s.point1.symbolic.y,b=s.point2.symbolic.x,Z=s.point2.symbolic.y,y=n.symbolic.x,O=n.symbolic.y,x=h.symbolic.x,D=h.symbolic.y;return["("+d+")*("+x+")-("+d+")*("+b+")+("+D+")*("+b+")-("+p+")*("+D+")+("+p+")*("+Z+")-("+x+")*("+Z+")","("+O+")*("+d+")-("+O+")*("+Z+")-("+D+")*("+d+")+("+D+")*("+Z+")+("+y+")*("+p+")-("+y+")*("+b+")-("+x+")*("+p+")+("+x+")*("+b+")"]},h},u.Z.createPerpendicular=function(t,e,o){var s,n,h,l;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),a.Z.isPointType(t,e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE)n=e[1],s=a.Z.providePoints(t,[e[0]],o,"point")[0];else{if(!a.Z.isPointType(t,e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [line,point]`);n=e[0],s=a.Z.providePoints(t,[e[1]],o,"point")[0]}return l=a.Z.copyAttributes(o,t.options,"perpendicular"),(h=u.Z.createLine(t,[function(){return n.stdform[2]*s.X()-n.stdform[1]*s.Y()},function(){return-n.stdform[2]*s.Z()},function(){return n.stdform[1]*s.Z()}],l)).elType="perpendicular",h.setParents([n.id,s.id]),a.Z.exists(s._is_new)?(h.addChild(s),delete s._is_new):s.addChild(h),n.addChild(h),h},u.Z.createPerpendicularPoint=function(t,e,o){var s,n,h;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),a.Z.isPointType(t,e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE)n=a.Z.providePoints(t,[e[0]],o,"point")[0],s=e[1];else{if(!a.Z.isPointType(t,e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line]`);n=a.Z.providePoints(t,[e[1]],o,"point")[0],s=e[0]}return h=t.create("point",[function(){return _.Z.perpendicular(s,n,t)[0]}],o),a.Z.exists(n._is_new)?(h.addChild(n),delete n._is_new):n.addChild(h),s.addChild(h),h.elType="perpendicularpoint",h.setParents([n.id,s.id]),h.update(),h.generatePolynomial=function(){var l=s.point1.symbolic.x,p=s.point1.symbolic.y,d=s.point2.symbolic.x,b=s.point2.symbolic.y,Z=n.symbolic.x,y=n.symbolic.y,O=h.symbolic.x,x=h.symbolic.y;return["("+p+")*("+O+")-("+p+")*("+d+")+("+x+")*("+d+")-("+l+")*("+x+")+("+l+")*("+b+")-("+O+")*("+b+")","("+y+")*("+p+")-("+y+")*("+b+")-("+x+")*("+p+")+("+x+")*("+b+")+("+Z+")*("+l+")-("+Z+")*("+d+")-("+O+")*("+l+")+("+O+")*("+d+")"]},h},u.Z.createPerpendicularSegment=function(t,e,o){var s,n,h,l,p;if(e[0]=t.select(e[0]),e[1]=t.select(e[1]),a.Z.isPointType(t,e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE)n=e[1],s=a.Z.providePoints(t,[e[0]],o,"point")[0];else{if(!a.Z.isPointType(t,e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create perpendicular with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [line,point]`);n=e[0],s=a.Z.providePoints(t,[e[1]],o,"point")[0]}return p=a.Z.copyAttributes(o,t.options,"perpendicularsegment","point"),(l=u.Z.createPerpendicularPoint(t,[n,s],p)).dump=!1,a.Z.exists(o.layer)||(o.layer=t.options.layer.line),p=a.Z.copyAttributes(o,t.options,"perpendicularsegment"),(h=u.Z.createLine(t,[function(){return _.Z.perpendicular(n,s,t)[1]?[l,s]:[s,l]}],p)).point=l,a.Z.exists(s._is_new)?(h.addChild(s),delete s._is_new):s.addChild(h),n.addChild(h),h.elType="perpendicularsegment",h.setParents([s.id,n.id]),h.subs={point:l},h.inherits.push(l),h},u.Z.createMidpoint=function(t,e,o){var s,n,h,l,p;for(l=0;l<e.length;++l)e[l]=t.select(e[l]);if(e.length===2&&a.Z.isPointType(t,e[0])&&a.Z.isPointType(t,e[1]))e=a.Z.providePoints(t,e,o,"point"),s=e[0],n=e[1];else{if(e.length!==1||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error(`JSXGraph: Can't create midpoint.
Possible parent types: [point,point], [line]`);s=e[0].point1,n=e[0].point2}return p=a.Z.copyAttributes(o,t.options,"midpoint"),h=t.create("point",[function(){var d=s.coords.usrCoords[1]+n.coords.usrCoords[1];return isNaN(d)||Math.abs(s.coords.usrCoords[0])<B.Z.eps||Math.abs(n.coords.usrCoords[0])<B.Z.eps?NaN:.5*d},function(){var d=s.coords.usrCoords[2]+n.coords.usrCoords[2];return isNaN(d)||Math.abs(s.coords.usrCoords[0])<B.Z.eps||Math.abs(n.coords.usrCoords[0])<B.Z.eps?NaN:.5*d}],p),a.Z.exists(s._is_new)?(h.addChild(s),delete s._is_new):s.addChild(h),a.Z.exists(n._is_new)?(h.addChild(n),delete n._is_new):n.addChild(h),h.elType="midpoint",h.setParents([s.id,n.id]),h.prepareUpdate().update(),h.generatePolynomial=function(){var d=s.symbolic.x,b=s.symbolic.y,Z=n.symbolic.x,y=n.symbolic.y,O=h.symbolic.x,x=h.symbolic.y;return["("+b+")*("+O+")-("+b+")*("+Z+")+("+x+")*("+Z+")-("+d+")*("+x+")+("+d+")*("+y+")-("+O+")*("+y+")","("+d+")^2 - 2*("+d+")*("+O+")+("+b+")^2-2*("+b+")*("+x+")-("+Z+")^2+2*("+Z+")*("+O+")-("+y+")^2+2*("+y+")*("+x+")"]},h},u.Z.createParallelPoint=function(t,e,o){var s,n,h,l,p;for(p=0;p<e.length;++p)e[p]=t.select(e[p]);if(e.length===3&&a.Z.isPointType(t,e[0])&&a.Z.isPointType(t,e[1])&&a.Z.isPointType(t,e[2]))e=a.Z.providePoints(t,e,o,"point"),s=e[0],n=e[1],h=e[2];else if(a.Z.isPointType(t,e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_LINE)h=a.Z.providePoints(t,[e[0]],o,"point")[0],s=e[1].point1,n=e[1].point2;else{if(!a.Z.isPointType(t,e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create parallel point with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [line,point], [point,point,point]`);h=a.Z.providePoints(t,[e[1]],o,"point")[0],s=e[0].point1,n=e[0].point2}return l=t.create("point",[function(){return h.coords.usrCoords[1]+n.coords.usrCoords[1]-s.coords.usrCoords[1]},function(){return h.coords.usrCoords[2]+n.coords.usrCoords[2]-s.coords.usrCoords[2]}],o),a.Z.exists(s._is_new)?(l.addChild(s),delete s._is_new):s.addChild(l),a.Z.exists(n._is_new)?(l.addChild(n),delete n._is_new):n.addChild(l),a.Z.exists(h._is_new)?(l.addChild(h),delete h._is_new):h.addChild(l),l.elType="parallelpoint",l.setParents([s.id,n.id,h.id]),l.prepareUpdate().update(),l.generatePolynomial=function(){var d=s.symbolic.x,b=s.symbolic.y,Z=n.symbolic.x,y=n.symbolic.y,O=h.symbolic.x,x=h.symbolic.y,D=l.symbolic.x,k=l.symbolic.y;return["("+y+")*("+D+")-("+y+")*("+O+")-("+b+")*("+D+")+("+b+")*("+O+")-("+k+")*("+Z+")+("+k+")*("+d+")+("+x+")*("+Z+")-("+x+")*("+d+")","("+k+")*("+d+")-("+k+")*("+O+")-("+y+")*("+d+")+("+y+")*("+O+")-("+D+")*("+b+")+("+D+")*("+x+")+("+Z+")*("+b+")-("+Z+")*("+x+")"]},l},u.Z.createParallel=function(t,e,o){var s,n,h,l,p,d,b=1;for(p=0;p<e.length;++p)e[p]=t.select(e[p]);return s=null,e.length===3?(s=(e=a.Z.providePoints(t,e,o,"point"))[2],b=0):a.Z.isPointType(t,e[0])?(s=a.Z.providePoints(t,[e[0]],o,"point")[0],l=function(){return e[1].stdform}):a.Z.isPointType(t,e[1])&&(s=a.Z.providePoints(t,[e[1]],o,"point")[0],l=function(){return e[0].stdform}),a.Z.exists(o.layer)||(o.layer=t.options.layer.line),d=a.Z.copyAttributes(o,t.options,"parallel","point"),(n=b===1?t.create("point",[function(){return B.Z.crossProduct([1,0,0],l())}],d):t.create("parallelpoint",e,d)).isDraggable=!0,d=a.Z.copyAttributes(o,t.options,"parallel"),(h=t.create("line",[s,n],d)).elType="parallel",h.subs={point:n},h.inherits.push(n),h.setParents([e[0].id,e[1].id]),e.length===3&&h.addParents(e[2].id),h.point=n,h},u.Z.createArrowParallel=function(t,e,o){var s;try{return o.firstArrow=!1,o.lastArrow=!0,(s=u.Z.createParallel(t,e,o).setAttribute({straightFirst:!1,straightLast:!1})).elType="arrowparallel",s}catch{throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [line,point], [point,point,point]`)}},u.Z.createNormal=function(t,e,o){var s,n,h,l,p,d,b,Z,y;for(l=0;l<e.length;++l)e[l]=t.select(e[l]);if(e.length===1)s=e[0],n=s.slideObject;else{if(e.length!==2)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);if(a.Z.isPointType(t,e[0]))s=a.Z.providePoints(t,[e[0]],o,"point")[0],n=e[1];else{if(!a.Z.isPointType(t,e[1]))throw new Error("JSXGraph: Can't create normal with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);n=e[0],s=a.Z.providePoints(t,[e[1]],o,"point")[0]}}if(b=a.Z.copyAttributes(o,t.options,"normal"),n.elementClass===S.Z.OBJECT_CLASS_LINE)y=a.Z.copyAttributes(o,t.options,"normal","point"),Z=t.create("point",[function(){var O=B.Z.crossProduct([1,0,0],n.stdform);return[O[0],-O[2],O[1]]}],y),Z.isDraggable=!0,(h=t.create("line",[s,Z],b)).point=Z,h.subs={point:Z},h.inherits.push(Z);else if(n.elementClass===S.Z.OBJECT_CLASS_CIRCLE)h=t.create("line",[n.midpoint,s],b);else if(n.elementClass===S.Z.OBJECT_CLASS_CURVE)a.Z.evaluate(n.visProp.curvetype)!=="plot"?(p=n.X,d=n.Y,h=t.create("line",[function(){return-s.X()*c.Z.D(p)(s.position)-s.Y()*c.Z.D(d)(s.position)},function(){return c.Z.D(p)(s.position)},function(){return c.Z.D(d)(s.position)}],b)):h=t.create("line",[function(){var O,x,D,k,I,U,J,z,V,W,$=Math.floor(s.position),nt=s.position-$;if(n.bezierdegree===1)$===n.numberPoints-1&&($-=1,nt=1);else{if(n.bezierDegree!==3)return 0;$=3*Math.floor(s.position*(n.numberPoints-1)/3),D=(s.position*(n.numberPoints-1)-$)/3,$>=n.numberPoints-1&&($=n.numberPoints-4,D=1)}return $<0?1:n.bezierDegree===1?(n.Y($)+nt*(n.Y($+1)-n.Y($)))*(n.Y($)-n.Y($+1))-(n.X($)+nt*(n.X($+1)-n.X($)))*(n.X($+1)-n.X($)):(k=n.points[$].usrCoords,I=n.points[$+1].usrCoords,U=n.points[$+2].usrCoords,J=n.points[$+3].usrCoords,z=(1-D)*(1-D)*(I[1]-k[1])+2*(1-D)*D*(U[1]-I[1])+D*D*(J[1]-U[1]),V=(1-D)*(1-D)*(I[2]-k[2])+2*(1-D)*D*(U[2]-I[2])+D*D*(J[2]-U[2]),z/=W=Math.sqrt(z*z+V*V),V/=W,x=[1,(O=s.coords.usrCoords)[1]-V,O[2]+z],O[2]*x[1]-O[1]*x[2])},function(){var O,x,D,k,I,U,J,z,V,W=Math.floor(s.position);if(n.bezierdegree===1)W===n.numberPoints-1&&(W-=1);else{if(n.bezierDegree!==3)return 0;W=3*Math.floor(s.position*(n.numberPoints-1)/3),x=(s.position*(n.numberPoints-1)-W)/3,W>=n.numberPoints-1&&(W=n.numberPoints-4,x=1)}return W<0?0:n.bezierDegree===1?n.X(W+1)-n.X(W):(D=n.points[W].usrCoords,k=n.points[W+1].usrCoords,I=n.points[W+2].usrCoords,U=n.points[W+3].usrCoords,J=(1-x)*(1-x)*(k[1]-D[1])+2*(1-x)*x*(I[1]-k[1])+x*x*(U[1]-I[1]),z=(1-x)*(1-x)*(k[2]-D[2])+2*(1-x)*x*(I[2]-k[2])+x*x*(U[2]-I[2]),J/=V=Math.sqrt(J*J+z*z),z/=V,[1,(O=s.coords.usrCoords)[1]-z,O[2]+J][2]-O[2])},function(){var O,x,D,k,I,U,J,z,V,W,$=Math.floor(s.position);if(n.bezierdegree===1)$===n.numberPoints-1&&($-=1);else{if(n.bezierDegree!==3)return 0;$=3*Math.floor(s.position*(n.numberPoints-1)/3),D=(s.position*(n.numberPoints-1)-$)/3,$>=n.numberPoints-1&&($=n.numberPoints-4,D=1)}return $<0?0:n.bezierDegree===1?n.Y($+1)-n.Y($):(k=n.points[$].usrCoords,I=n.points[$+1].usrCoords,U=n.points[$+2].usrCoords,J=n.points[$+3].usrCoords,z=(1-D)*(1-D)*(I[1]-k[1])+2*(1-D)*D*(U[1]-I[1])+D*D*(J[1]-U[1]),V=(1-D)*(1-D)*(I[2]-k[2])+2*(1-D)*D*(U[2]-I[2])+D*D*(J[2]-U[2]),z/=W=Math.sqrt(z*z+V*V),V/=W,x=[1,(O=s.coords.usrCoords)[1]-V,O[2]+z],O[1]-x[1])}],b);else{if(n.type!==S.Z.OBJECT_TYPE_TURTLE)throw new Error("JSXGraph: Can't create normal with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,line], [point,circle], [glider]`);h=t.create("line",[function(){var O,x,D=Math.floor(s.position),k=s.position-D;for(x=0;x<n.objects.length;x++)if((O=n.objects[x]).type===S.Z.OBJECT_TYPE_CURVE){if(D<O.numberPoints)break;D-=O.numberPoints}return D===O.numberPoints-1&&(D-=1,k=1),D<0?1:(O.Y(D)+k*(O.Y(D+1)-O.Y(D)))*(O.Y(D)-O.Y(D+1))-(O.X(D)+k*(O.X(D+1)-O.X(D)))*(O.X(D+1)-O.X(D))},function(){var O,x,D=Math.floor(s.position);for(x=0;x<n.objects.length;x++)if((O=n.objects[x]).type===S.Z.OBJECT_TYPE_CURVE){if(D<O.numberPoints)break;D-=O.numberPoints}return D===O.numberPoints-1&&(D-=1),D<0?0:O.X(D+1)-O.X(D)},function(){var O,x,D=Math.floor(s.position);for(x=0;x<n.objects.length;x++)if((O=n.objects[x]).type===S.Z.OBJECT_TYPE_CURVE){if(D<O.numberPoints)break;D-=O.numberPoints}return D===O.numberPoints-1&&(D-=1),D<0?0:O.Y(D+1)-O.Y(D)}],b)}return h.elType="normal",h.setParents(e),a.Z.exists(s._is_new)?(h.addChild(s),delete s._is_new):s.addChild(h),n.addChild(h),h},u.Z.createBisector=function(t,e,o){var s,n,h,l;if(e=a.Z.providePoints(t,e,o,"point"),a.Z.isPoint(e[0])&&a.Z.isPoint(e[1])&&a.Z.isPoint(e[2])){for((l=a.Z.copyAttributes(o,t.options,"bisector","point")).snapToGrid=!1,(s=t.create("point",[function(){return _.Z.angleBisector(e[0],e[1],e[2],t)}],l)).dump=!1,h=0;h<3;h++)a.Z.exists(e[h]._is_new)?(s.addChild(e[h]),delete e[h]._is_new):e[h].addChild(s);return a.Z.exists(o.layer)||(o.layer=t.options.layer.line),l=a.Z.copyAttributes(o,t.options,"bisector"),(n=u.Z.createLine(t,[e[1],s],l)).point=s,n.elType="bisector",n.setParents(e),n.subs={point:s},n.inherits.push(s),n}throw new Error("JSXGraph: Can't create angle bisector with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point,point]`)},u.Z.createAngularBisectorsOfTwoLines=function(t,e,o){var s,n,h,l,p=t.select(e[0]),d=t.select(e[1]);if(p.elementClass!==S.Z.OBJECT_CLASS_LINE||d.elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [line,line]`);return a.Z.exists(o.layer)||(o.layer=t.options.layer.line),h=a.Z.copyAttributes(o,t.options,"bisectorlines","line1"),s=t.create("line",[function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[0]/b-d.stdform[0]/Z},function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[1]/b-d.stdform[1]/Z},function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[2]/b-d.stdform[2]/Z}],h),a.Z.exists(o.layer)||(o.layer=t.options.layer.line),h=a.Z.copyAttributes(o,t.options,"bisectorlines","line2"),n=t.create("line",[function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[0]/b+d.stdform[0]/Z},function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[1]/b+d.stdform[1]/Z},function(){var b=Math.sqrt(p.stdform[1]*p.stdform[1]+p.stdform[2]*p.stdform[2]),Z=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);return p.stdform[2]/b+d.stdform[2]/Z}],h),l=new Dt({line1:s,line2:n}),s.dump=!1,n.dump=!1,l.elType="bisectorlines",l.setParents([p.id,d.id]),l.subs={line1:s,line2:n},l},u.Z.createCircumcenter=function(t,e,o){var s,n,h,l,p;if(e=a.Z.providePoints(t,e,o,"point"),a.Z.isPoint(e[0])&&a.Z.isPoint(e[1])&&a.Z.isPoint(e[2])){for(h=e[0],l=e[1],p=e[2],s=u.Z.createPoint(t,[function(){return _.Z.circumcenter(h,l,p,t)}],o),n=0;n<3;n++)a.Z.exists(e[n]._is_new)?(s.addChild(e[n]),delete e[n]._is_new):e[n].addChild(s);return s.elType="circumcenter",s.setParents(e),s.generatePolynomial=function(){var d=h.symbolic.x,b=h.symbolic.y,Z=l.symbolic.x,y=l.symbolic.y,O=p.symbolic.x,x=p.symbolic.y,D=s.symbolic.x,k=s.symbolic.y;return[["((",D,")-(",d,"))^2+((",k,")-(",b,"))^2-((",D,")-(",Z,"))^2-((",k,")-(",y,"))^2"].join(""),["((",D,")-(",d,"))^2+((",k,")-(",b,"))^2-((",D,")-(",O,"))^2-((",k,")-(",x,"))^2"].join("")]},s}throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`)},u.Z.createIncenter=function(t,e,o){var s,n,h,l,p;if(!((e=a.Z.providePoints(t,e,o,"point")).length>=3&&a.Z.isPoint(e[0])&&a.Z.isPoint(e[1])&&a.Z.isPoint(e[2])))throw new Error("JSXGraph: Can't create incenter with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);for(n=e[0],h=e[1],l=e[2],s=t.create("point",[function(){var d,b,Z;return d=Math.sqrt((h.X()-l.X())*(h.X()-l.X())+(h.Y()-l.Y())*(h.Y()-l.Y())),b=Math.sqrt((n.X()-l.X())*(n.X()-l.X())+(n.Y()-l.Y())*(n.Y()-l.Y())),Z=Math.sqrt((h.X()-n.X())*(h.X()-n.X())+(h.Y()-n.Y())*(h.Y()-n.Y())),new m.Z(S.Z.COORDS_BY_USER,[(d*n.X()+b*h.X()+Z*l.X())/(d+b+Z),(d*n.Y()+b*h.Y()+Z*l.Y())/(d+b+Z)],t)}],o),p=0;p<3;p++)a.Z.exists(e[p]._is_new)?(s.addChild(e[p]),delete e[p]._is_new):e[p].addChild(s);return s.elType="incenter",s.setParents(e),s},u.Z.createCircumcircle=function(t,e,o){var s,n,h,l;if((e=a.Z.providePoints(t,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);try{for(h=a.Z.copyAttributes(o,t.options,"circumcircle","center"),(s=u.Z.createCircumcenter(t,e,h)).dump=!1,a.Z.exists(o.layer)||(o.layer=t.options.layer.circle),h=a.Z.copyAttributes(o,t.options,"circumcircle"),(n=u.Z.createCircle(t,[s,e[0]],h)).elType="circumcircle",n.setParents(e),n.subs={center:s},n.inherits.push(n),l=0;l<3;l++)a.Z.exists(e[l]._is_new)?(n.addChild(e[l]),delete e[l]._is_new):e[l].addChild(n)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`)}return n},u.Z.createIncircle=function(t,e,o){var s,n,h,l;if((e=a.Z.providePoints(t,e,o,"point"))===!1)throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`);try{for(l=a.Z.copyAttributes(o,t.options,"incircle","center"),(n=u.Z.createIncenter(t,e,l)).dump=!1,a.Z.exists(o.layer)||(o.layer=t.options.layer.circle),l=a.Z.copyAttributes(o,t.options,"incircle"),(h=u.Z.createCircle(t,[n,function(){var p=Math.sqrt((e[1].X()-e[2].X())*(e[1].X()-e[2].X())+(e[1].Y()-e[2].Y())*(e[1].Y()-e[2].Y())),d=Math.sqrt((e[0].X()-e[2].X())*(e[0].X()-e[2].X())+(e[0].Y()-e[2].Y())*(e[0].Y()-e[2].Y())),b=Math.sqrt((e[1].X()-e[0].X())*(e[1].X()-e[0].X())+(e[1].Y()-e[0].Y())*(e[1].Y()-e[0].Y())),Z=(p+d+b)/2;return Math.sqrt((Z-p)*(Z-d)*(Z-b)/Z)}],l)).elType="incircle",h.setParents(e),s=0;s<3;s++)a.Z.exists(e[s]._is_new)?(h.addChild(e[s]),delete e[s]._is_new):e[s].addChild(h);h.center=n,h.subs={center:h.center},h.inherits.push(n)}catch{throw new Error("JSXGraph: Can't create circumcircle with parent types '"+typeof e[0]+"', '"+typeof e[1]+"' and '"+typeof e[2]+`'.
Possible parent types: [point,point,point]`)}return h},u.Z.createReflection=function(t,e,o){var s,n,h,l,p,d,b,Z,y=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, line]`;for(d=0;d<e.length;++d)e[d]=t.select(e[d]);if(b=a.Z.copyAttributes(o,t.options,"reflection"),a.Z.isPoint(e[0]))n=a.Z.providePoints(t,[e[0]],Z)[0];else{if(e[0].elementClass!==S.Z.OBJECT_CLASS_CURVE&&e[0].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[0].type!==S.Z.OBJECT_TYPE_POLYGON&&e[0].elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflection element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);n=e[0]}if(e[1].elementClass!==S.Z.OBJECT_CLASS_LINE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);if(s=e[1],p=u.Z.createTransform(t,[s],{type:"reflect"}),a.Z.isPoint(n))h=u.Z.createPoint(t,[n,p],b);else if(n.elementClass===S.Z.OBJECT_CLASS_CURVE)h=u.Z.createCurve(t,[n,p],b);else if(n.elementClass===S.Z.OBJECT_CLASS_LINE)h=u.Z.createLine(t,[n,p],b);else if(n.type===S.Z.OBJECT_TYPE_POLYGON)h=u.Z.createPolygon(t,[n,p],b);else{if(n.elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create reflected element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);b.type.toLowerCase()==="euclidean"?(Z=a.Z.copyAttributes(o,t.options,"reflection","center"),(l=u.Z.createPoint(t,[n.center,p],Z)).prepareUpdate().update().updateVisibility(a.Z.evaluate(l.visProp.visible)).updateRenderer(),h=u.Z.createCircle(t,[l,function(){return n.Radius()}],b)):h=u.Z.createCircle(t,[n,p],b)}return a.Z.exists(n._is_new)&&(h.addChild(n),delete n._is_new),s.addChild(h),h.elType="reflection",h.addParents(s),h.prepareUpdate().update(),a.Z.isPoint(h)&&(h.generatePolynomial=function(){var O=s.point1.symbolic.x,x=s.point1.symbolic.y,D=s.point2.symbolic.x,k=s.point2.symbolic.y,I=n.symbolic.x,U=n.symbolic.y,J=h.symbolic.x,z=h.symbolic.y;return[["((",z,")-(",U,"))*((",x,")-(",k,"))+((",O,")-(",D,"))*((",J,")-(",I,"))"].join(""),["((",J,")-(",O,"))^2+((",z,")-(",x,"))^2-((",I,")-(",O,"))^2-((",U,")-(",x,"))^2"].join("")]}),h},u.Z.createMirrorElement=function(t,e,o){var s,n,h,l,p,d,b,Z,y=`
Possible parent types: [point|line|curve|polygon|circle|arc|sector, point]`;for(n=0;n<e.length;++n)e[n]=t.select(e[n]);if(b=a.Z.copyAttributes(o,t.options,"mirrorelement"),a.Z.isPoint(e[0]))s=a.Z.providePoints(t,[e[0]],b)[0];else{if(e[0].elementClass!==S.Z.OBJECT_CLASS_CURVE&&e[0].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[0].type!==S.Z.OBJECT_TYPE_POLYGON&&e[0].elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);s=e[0]}if(!a.Z.isPoint(e[1]))throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);if(Z=a.Z.copyAttributes(o,t.options,"mirrorelement","point"),h=a.Z.providePoints(t,[e[1]],Z)[0],d=u.Z.createTransform(t,[Math.PI,h],{type:"rotate"}),a.Z.isPoint(s))l=u.Z.createPoint(t,[s,d],b);else if(s.elementClass===S.Z.OBJECT_CLASS_CURVE)l=u.Z.createCurve(t,[s,d],b);else if(s.elementClass===S.Z.OBJECT_CLASS_LINE)l=u.Z.createLine(t,[s,d],b);else if(s.type===S.Z.OBJECT_TYPE_POLYGON)l=u.Z.createPolygon(t,[s,d],b);else{if(s.elementClass!==S.Z.OBJECT_CLASS_CIRCLE)throw new Error("JSXGraph: Can't create mirror element with parent types '"+typeof e[0]+"' and '"+typeof e[1]+"'."+y);b.type.toLowerCase()==="euclidean"?(Z=a.Z.copyAttributes(o,t.options,"mirrorelement","center"),(p=u.Z.createPoint(t,[s.center,d],Z)).prepareUpdate().update().updateVisibility(a.Z.evaluate(p.visProp.visible)).updateRenderer(),l=u.Z.createCircle(t,[p,function(){return s.Radius()}],b)):l=u.Z.createCircle(t,[s,d],b)}return a.Z.exists(s._is_new)&&(l.addChild(s),delete s._is_new),h.addChild(l),l.elType="mirrorelement",l.addParents(h),l.prepareUpdate().update(),l},u.Z.createMirrorPoint=function(t,e,o){var s=u.Z.createMirrorElement(t,e,o);return s.elType="mirrorpoint",s},u.Z.createIntegral=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U=null;if(a.Z.isArray(e[0])&&e[1].elementClass===S.Z.OBJECT_CLASS_CURVE)s=e[0],n=e[1];else{if(!a.Z.isArray(e[1])||e[0].elementClass!==S.Z.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create integral with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [[number|function,number|function],curve]`);s=e[1],n=e[0]}return(h=a.Z.copyAttributes(o,t.options,"integral")).withLabel=!1,I=t.create("curve",[[0],[0]],h),l=s[0],p=s[1],a.Z.isFunction(l)?(b=function(){return n.Y(d())},l=(d=l)()):(d=l,b=n.Y(l)),a.Z.isFunction(p)?(y=function(){return n.Y(Z())},p=(Z=p)()):(Z=p,y=n.Y(p)),h=a.Z.copyAttributes(o,t.options,"integral","curveLeft"),O=t.create("glider",[d,b,n],h),a.Z.isFunction(d)&&O.hideElement(),h=a.Z.copyAttributes(o,t.options,"integral","baseLeft"),x=t.create("point",[function(){return a.Z.evaluate(I.visProp.axis)==="y"?0:O.X()},function(){return a.Z.evaluate(I.visProp.axis)==="y"?O.Y():0}],h),h=a.Z.copyAttributes(o,t.options,"integral","curveRight"),D=t.create("glider",[Z,y,n],h),a.Z.isFunction(Z)&&D.hideElement(),h=a.Z.copyAttributes(o,t.options,"integral","baseRight"),k=t.create("point",[function(){return a.Z.evaluate(I.visProp.axis)==="y"?0:D.X()},function(){return a.Z.evaluate(I.visProp.axis)==="y"?D.Y():0}],h),(h=a.Z.copyAttributes(o,t.options,"integral")).withlabel!==!1&&h.axis!=="y"&&(h=a.Z.copyAttributes(o,t.options,"integral","label"),h=a.Z.copyAttributes(h,t.options,"label"),(U=t.create("text",[function(){var J=new m.Z(S.Z.COORDS_BY_SCREEN,[a.Z.evaluate(this.visProp.offset[0])+this.board.origin.scrCoords[1],0],this.board,!1),z=this.board.getBoundingBox(),V=.1*(z[2]-z[0]),W=D.X();return W<z[0]?W=z[0]+V:W>z[2]&&(W=z[2]-V),W+J.usrCoords[1]},function(){var J=new m.Z(S.Z.COORDS_BY_SCREEN,[0,a.Z.evaluate(this.visProp.offset[1])+this.board.origin.scrCoords[2]],this.board,!1),z=this.board.getBoundingBox(),V=.1*(z[1]-z[3]),W=D.Y();return W>z[1]?W=z[1]-V:W<z[3]&&(W=z[3]+V),W+J.usrCoords[2]},function(){var J=c.Z.NewtonCotes([x.X(),k.X()],n.Y);return"&int; = "+a.Z.toFixed(J,4)}],h)).dump=!1,O.addChild(U),D.addChild(U)),O.dump=!1,x.dump=!1,D.dump=!1,k.dump=!1,I.elType="integral",I.setParents([n.id,s]),I.subs={curveLeft:O,baseLeft:x,curveRight:D,baseRight:k},I.inherits.push(O,x,D,k),h.withLabel&&(I.subs.label=U,I.inherits.push(U)),I.Value=function(){return c.Z.I([x.X(),k.X()],n.Y)},I.updateDataArray=function(){var J,z,V,W,$,nt,et,lt,ot;if(a.Z.evaluate(this.visProp.axis)==="y"){for(O.Y()<D.Y()?(nt=O.X(),lt=O.Y(),et=D.X(),ot=D.Y()):(nt=D.X(),lt=D.Y(),et=O.X(),ot=O.Y()),W=Math.min(nt,et),$=Math.max(nt,et),J=[0,nt],z=[lt,lt],V=0;V<n.numberPoints;V++)lt<=n.points[V].usrCoords[2]&&W<=n.points[V].usrCoords[1]&&n.points[V].usrCoords[2]<=ot&&n.points[V].usrCoords[1]<=$&&(J.push(n.points[V].usrCoords[1]),z.push(n.points[V].usrCoords[2]));J.push(et),z.push(ot),J.push(0),z.push(ot),J.push(0),z.push(lt)}else{for(x.X()<k.X()?(W=x.X(),$=k.X()):(W=k.X(),$=x.X()),J=[W,W],z=[0,n.Y(W)],V=0;V<n.numberPoints;V++)W<=n.points[V].usrCoords[1]&&n.points[V].usrCoords[1]<=$&&(J.push(n.points[V].usrCoords[1]),z.push(n.points[V].usrCoords[2]));J.push($),z.push(n.Y($)),J.push($),z.push(0),J.push(W),z.push(0)}this.dataX=J,this.dataY=z},O.addChild(I),D.addChild(I),x.addChild(I),k.addChild(I),I.baseLeft=x,I.baseRight=k,I.curveLeft=O,I.curveRight=D,I.methodMap=u.Z.deepCopy(I.methodMap,{curveLeft:"curveLeft",baseLeft:"baseLeft",curveRight:"curveRight",baseRight:"baseRight",Value:"Value"}),I.label=U,I},u.Z.createGrid=function(t,e,o){var s,n;return n=a.Z.copyAttributes(o,t.options,"grid"),(s=t.create("curve",[[null],[null]],n)).elType="grid",s.type=S.Z.OBJECT_TYPE_GRID,s.updateDataArray=function(){var h,l,p,d,b,Z=a.Z.evaluate(this.visProp.gridx),y=a.Z.evaluate(this.visProp.gridy);for(d=a.Z.isArray(this.visProp.topleft)?new m.Z(a.Z.evaluate(this.visProp.tltype)||S.Z.COORDS_BY_USER,this.visProp.topleft,t):new m.Z(S.Z.COORDS_BY_SCREEN,[0,0],t),b=a.Z.isArray(this.visProp.bottomright)?new m.Z(a.Z.evaluate(this.visProp.brtype)||S.Z.COORDS_BY_USER,this.visProp.bottomright,t):new m.Z(S.Z.COORDS_BY_SCREEN,[t.canvasWidth,t.canvasHeight],t),t.options.grid.hasGrid=!0,s.dataX=[],s.dataY=[],h=Math.floor(d.usrCoords[2]/y)*y,l=Math.ceil(b.usrCoords[2]/y)*y,d.usrCoords[2]<b.usrCoords[2]&&(h=Math.ceil(b.usrCoords[2]/y)*y,l=Math.floor(d.usrCoords[2]/y)*y),p=h;p>l-y;p-=y)s.dataX.push(d.usrCoords[1],b.usrCoords[1],NaN),s.dataY.push(p,p,NaN);for(h=Math.ceil(d.usrCoords[1]/Z)*Z,l=Math.floor(b.usrCoords[1]/Z)*Z,d.usrCoords[1]>b.usrCoords[1]&&(h=Math.floor(b.usrCoords[1]/Z)*Z,l=Math.ceil(d.usrCoords[1]/Z)*Z),p=h;p<l+Z;p+=Z)s.dataX.push(p,p,NaN),s.dataY.push(d.usrCoords[2],b.usrCoords[2],NaN)},s.hasPoint=function(){return!1},t.grids.push(s),s},u.Z.createInequality=function(t,e,o){var s,n,h;if(h=a.Z.copyAttributes(o,t.options,"inequality"),e[0].elementClass===S.Z.OBJECT_CLASS_LINE)(n=t.create("curve",[[],[]],h)).hasPoint=function(){return!1},n.updateDataArray=function(){var l,p,d,b=t.getBoundingBox(),Z=h.inverse?-1:1,y=1.5*Math.max(b[2]-b[0],b[1]-b[3]),O={coords:{usrCoords:[1,(b[0]+b[2])/2,h.inverse?b[1]:b[3]]}},x=e[0].stdform.slice(1),D=x;d=1.5*Math.max(_.Z.perpendicular(e[0],O,t)[0].distance(S.Z.COORDS_BY_USER,O.coords),y),d*=Z,O={coords:{usrCoords:[1,(b[0]+b[2])/2,(b[1]+b[3])/2]}},l=[1,(O=Math.abs(B.Z.innerProduct(O.coords.usrCoords,e[0].stdform,3))>=B.Z.eps?_.Z.perpendicular(e[0],O,t)[0].usrCoords:O.coords.usrCoords)[1]+x[1]*y,O[2]-x[0]*y],p=[1,O[1]-D[1]*y,O[2]+D[0]*y],this.dataX=[l[1],l[1]+x[0]*d,p[1]+D[0]*d,p[1],l[1]],this.dataY=[l[2],l[2]+x[1]*d,p[2]+D[1]*d,p[2],l[2]]};else if(e[0].elementClass===S.Z.OBJECT_CLASS_CURVE&&e[0].visProp.curvetype==="functiongraph")(n=t.create("curve",[[],[]],h)).updateDataArray=function(){var l,p,d,b,Z,y,O,x,D,k=this.board.getBoundingBox(),I=[],U=e[0].minX(),J=e[0].maxX(),z=.3*(k[1]-k[3]);if(l=a.Z.evaluate(this.visProp.inverse)?1:3,this.dataX=[],this.dataY=[],(b=e[0].points.length)!==0)for(k[1]+=z,k[3]-=z,d=-1;d<b-1;){for(Z=d+1,p=b;Z<b;Z++)if(e[0].points[Z].isReal()){p=Z;break}if(p>=b)break;for(Z=p,d=b-1;Z<b-1;Z++)if(!e[0].points[Z+1].isReal()){d=Z;break}for(x=e[0].points[p].usrCoords[1],D=e[0].points[d].usrCoords[1],y=k[0]<U?U:k[0],O=k[2]>J?J:k[2],y=p===0?y:Math.max(y,x),O=d===b-1?O:Math.min(O,D),O=d===b-1?J:D,(I=[]).push([1,y=p===0?U:x,k[l]]),I.push([1,y,e[0].points[p].usrCoords[2]]),Z=p;Z<=d;Z++)I.push(e[0].points[Z].usrCoords);for(I.push([1,O,e[0].points[d].usrCoords[2]]),I.push([1,O,k[l]]),I.push(I[0]),Z=0;Z<I.length;Z++)this.dataX.push(I[Z][1]),this.dataY.push(I[Z][2]);d<b-1&&(this.dataX.push(NaN),this.dataY.push(NaN))}},n.hasPoint=function(){return!1};else if(s=a.Z.createFunction(e[0]),n.addParentsFromJCFunctions([s]),!a.Z.exists(s))throw new Error(`JSXGraph: Can't create area with the given parents.
Possible parent types: [line], [function]`);return n.addParents(e[0]),n},u.Z.registerElement("arrowparallel",u.Z.createArrowParallel),u.Z.registerElement("bisector",u.Z.createBisector),u.Z.registerElement("bisectorlines",u.Z.createAngularBisectorsOfTwoLines),u.Z.registerElement("msector",u.Z.createMsector),u.Z.registerElement("circumcircle",u.Z.createCircumcircle),u.Z.registerElement("circumcirclemidpoint",u.Z.createCircumcenter),u.Z.registerElement("circumcenter",u.Z.createCircumcenter),u.Z.registerElement("incenter",u.Z.createIncenter),u.Z.registerElement("incircle",u.Z.createIncircle),u.Z.registerElement("integral",u.Z.createIntegral),u.Z.registerElement("midpoint",u.Z.createMidpoint),u.Z.registerElement("mirrorelement",u.Z.createMirrorElement),u.Z.registerElement("mirrorpoint",u.Z.createMirrorPoint),u.Z.registerElement("normal",u.Z.createNormal),u.Z.registerElement("orthogonalprojection",u.Z.createOrthogonalProjection),u.Z.registerElement("parallel",u.Z.createParallel),u.Z.registerElement("parallelpoint",u.Z.createParallelPoint),u.Z.registerElement("perpendicular",u.Z.createPerpendicular),u.Z.registerElement("perpendicularpoint",u.Z.createPerpendicularPoint),u.Z.registerElement("perpendicularsegment",u.Z.createPerpendicularSegment),u.Z.registerElement("reflection",u.Z.createReflection),u.Z.registerElement("grid",u.Z.createGrid),u.Z.registerElement("inequality",u.Z.createInequality),u.Z.createLocus=function(t,e,o){var s,n;if(!a.Z.isArray(e)||e.length!==1||!a.Z.isPoint(e[0]))throw new Error(`JSXGraph: Can't create locus with parent of type other than point.
Possible parent types: [point]`);return n=e[0],(s=t.create("curve",[[null],[null]],o)).dontCallServer=!1,s.elType="locus",s.setParents([n.id]),s.updateDataArray=function(){var h,l,p;s.board.mode>0||(h=tt.generatePolynomials(t,n,!0).join("|"))!==s.spe&&(s.spe=h,l=function(d,b,Z,y){var O;s.dataX=d,s.dataY=b,s.eq=Z,s.ctime=y,s.generatePolynomial=(O=Z,function(x){var D,k="("+x.symbolic.x+")",I="("+x.symbolic.y+")",U=[];for(D=0;D<O.length;D++)U[D]=O[D].replace(/\*\*/g,"^").replace(/x/g,k).replace(/y/g,I);return U})},l((p=tt.geometricLocusByGroebnerBase(t,n,l)).datax,p.datay,p.polynomial,p.exectime))},s},u.Z.registerElement("locus",u.Z.createLocus),__webpack_require__(573),u.Z.Image=function(t,e,o,s,n){this.constructor(t,o,S.Z.OBJECT_TYPE_IMAGE,S.Z.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this.W=a.Z.createFunction(n[0],this.board,""),this.H=a.Z.createFunction(n[1],this.board,""),this.addParentsFromJCFunctions([this.W,this.H]),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*t.unitX),Math.abs(this.usrSize[1]*t.unitY)],this.url=s,this.elType="image",this.span=[this.coords.usrCoords.slice(0),[this.coords.usrCoords[0],this.W(),0],[this.coords.usrCoords[0],0,this.H()]],this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.board.finalizeAdding(this),this.methodMap=u.Z.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},u.Z.Image.prototype=new Gt.Z,a.Z.copyPrototypeMethods(u.Z.Image,oe.Z,"coordsConstructor"),u.Z.extend(u.Z.Image.prototype,{hasPoint:function(t,e){var o,s,n,h,l,p,d,b,Z,y=this.transformations.length;return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(h=this.board._inputDevice,l=a.Z.evaluate(this.visProp.precision[h])):l=this.board.options.precision.hasPoint,y===0?(o=t-this.coords.scrCoords[1],s=this.coords.scrCoords[2]-e,o>=-(n=l)&&o-this.size[0]<=n&&s>=-n&&s-this.size[1]<=n):(d=[(p=(p=new m.Z(S.Z.COORDS_BY_SCREEN,[t,e],this.board)).usrCoords)[0]-this.span[0][0],p[1]-this.span[0][1],p[2]-this.span[0][2]],0<=(b=(Z=B.Z.innerProduct)(d,this.span[1]))&&b<=Z(this.span[1],this.span[1])&&0<=(b=Z(d,this.span[2]))&&b<=Z(this.span[2],this.span[2]))},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateSize(),this.updateSpan(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateImage")},updateSize:function(){return this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this},updateSpan:function(){var t,e,o=this.transformations.length,s=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],t=0;t<o;t++)for(e=0;e<3;e++)s[e]=B.Z.matVecMult(this.transformations[t].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(t){var e;if(a.Z.isArray(t))for(e=0;e<t.length;e++)this.transformations.push(t[e]);else this.transformations.push(t);return this},getParents:function(){var t=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(t=this.parents),t},setSize:function(t,e){return this.W=a.Z.createFunction(t,this.board,""),this.H=a.Z.createFunction(e,this.board,""),this.addParentsFromJCFunctions([this.W,this.H]),this},W:function(){},H:function(){}}),u.Z.createImage=function(t,e,o){var s,n,h=e[0],l=e[1],p=e[2];if(s=a.Z.copyAttributes(o,t.options,"image"),!(n=oe.Z.create(u.Z.Image,t,l,s,h,p)))throw new Error("JSXGraph: Can't create image with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [x,y], [z,x,y], [element,transformation]`);return s.rotate!==0&&n.addRotation(s.rotate),n},u.Z.registerElement("image",u.Z.createImage),u.Z.Image,u.Z.createSlider=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z,V,W,$,nt;return z=(nt=a.Z.copyAttributes(o,t.options,"slider")).withticks,J=nt.withlabel,V=nt.snapwidth,nt=a.Z.copyAttributes(o,t.options,"slider","point1"),b=t.create("point",e[0],nt),nt=a.Z.copyAttributes(o,t.options,"slider","point2"),Z=t.create("point",e[1],nt),nt=a.Z.copyAttributes(o,t.options,"slider","baseline"),(O=t.create("segment",[b,Z],nt)).updateStdform(),s=b.coords.usrCoords.slice(1),n=Z.coords.usrCoords.slice(1),h=e[2][0],l=e[2][1],p=e[2][2],d=p-h,$=(W=a.Z.evaluate(V))===-1?l:Math.round(l/W)*W,I=s[0]+(n[0]-s[0])*($-h)/(p-h),U=s[1]+(n[1]-s[1])*($-h)/(p-h),(nt=a.Z.copyAttributes(o,t.options,"slider")).withLabel=!1,(y=t.create("glider",[I,U,O],nt)).setAttribute({snapwidth:V}),nt=a.Z.copyAttributes(o,t.options,"slider","highline"),x=t.create("segment",[b,y],nt),y.Value=function(){var et=this._smax-this._smin,lt=a.Z.evaluate(this.visProp.snapwidth);return lt===-1?this.position*et+this._smin:Math.round((this.position*et+this._smin)/lt)*lt},y.methodMap=a.Z.deepCopy(y.methodMap,{Value:"Value",setValue:"setValue",smax:"_smax",smin:"_smin",setMax:"setMax",setMin:"setMin"}),y._smax=p,y._smin=h,y.setMax=function(et){return this._smax=et,this},y.setValue=function(et){var lt=this._smax-this._smin;return Math.abs(lt)>B.Z.eps?this.position=(et-this._smin)/lt:this.position=0,this.position=Math.max(0,Math.min(1,this.position)),this},y.setMin=function(et){return this._smin=et,this},J&&(nt=a.Z.copyAttributes(o,t.options,"slider","label"),k=t.create("text",[function(){return .05*(Z.X()-b.X())+Z.X()},function(){return .05*(Z.Y()-b.Y())+Z.Y()},function(){var et,lt=a.Z.evaluate(y.visProp.digits),ot=a.Z.evaluate(y.visProp.suffixlabel),gt=a.Z.evaluate(y.visProp.unitlabel),vt=a.Z.evaluate(y.visProp.postlabel);return lt===2&&a.Z.evaluate(y.visProp.precision)!==2&&(lt=a.Z.evaluate(y.visProp.precision)),et=ot!==null?ot:y.name&&y.name!==""?y.name+" = ":"",et+=a.Z.toFixed(y.Value(),lt),gt!==null&&(et+=gt),vt!==null&&(et+=vt),et}],nt),y.label=k,y.visProp.withlabel=!0,y.hasLabel=!0),y.point1=b,y.point2=Z,y.baseline=O,y.highline=x,z&&(nt=a.Z.copyAttributes(o,t.options,"slider","ticks"),a.Z.exists(nt.generatelabeltext)||(nt.generateLabelText=function(et,lt,ot){var gt=y.point1.Dist(y.point2),vt=y._smin,Tt=y._smax,Rt=this.getDistanceFromZero(lt,et)*(Tt-vt)/gt+vt;return gt<B.Z.eps||Math.abs(Rt)<B.Z.eps?"0":this.formatLabelText(Rt)}),D=t.create("ticks",[y.baseline,y.point1.Dist(b)/2,function(et){var lt=y.point1.Dist(y.point2),ot=y.point1.coords.distance(S.Z.COORDS_BY_USER,et);return lt<B.Z.eps?0:ot/lt*d+h}],nt),y.ticks=D),y.remove=function(){J&&t.removeObject(k),t.removeObject(x),t.removeObject(O),t.removeObject(Z),t.removeObject(b),_e.prototype.remove.call(y)},b.dump=!1,Z.dump=!1,O.dump=!1,x.dump=!1,J&&(k.dump=!1),y.elType="slider",y.parents=e,y.subs={point1:b,point2:Z,baseLine:O,highLine:x},y.inherits.push(b,Z,O,x),z&&(D.dump=!1,y.subs.ticks=D,y.inherits.push(D)),y.getParents=function(){return[this.point1.coords.usrCoords.slice(1),this.point2.coords.usrCoords.slice(1),[this._smin,this.position*(this._smax-this._smin)+this._smin,this._smax]]},y.baseline.on("up",function(et){var lt,ot;a.Z.evaluate(y.visProp.moveonup)&&!a.Z.evaluate(y.visProp.fixed)&&(lt=O.board.getMousePosition(et,0),ot=new m.Z(S.Z.COORDS_BY_SCREEN,lt,this.board),y.moveTo([ot.usrCoords[1],ot.usrCoords[2]]),y.triggerEventHandlers(["drag"],[et]))}),y.prepareUpdate().update(),t.isSuspendedUpdate||(y.updateVisibility().updateRenderer(),y.baseline.updateVisibility().updateRenderer(),y.highline.updateVisibility().updateRenderer(),z&&y.ticks.updateVisibility().updateRenderer()),y},u.Z.registerElement("slider",u.Z.createSlider),u.Z.createTapemeasure=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x;return s=e[0],n=e[1],h=a.Z.copyAttributes(o,t.options,"tapemeasure","point1"),Z=t.create("point",s,h),h=a.Z.copyAttributes(o,t.options,"tapemeasure","point2"),y=t.create("point",n,h),Z.setAttribute({ignoredSnapToPoints:[y]}),y.setAttribute({ignoredSnapToPoints:[Z]}),h=a.Z.copyAttributes(o,t.options,"tapemeasure"),l=h.withticks,p=h.withlabel,(d=h.digits)===2&&h.precision!==2&&(d=h.precision),p&&(h.withlabel=!0),b=t.create("segment",[Z,y],h),p&&(O=o.name&&o.name!==""?o.name+" = ":"",b.label.setText(function(){return O+a.Z.toFixed(Z.Dist(y),d)})),l&&(h=a.Z.copyAttributes(o,t.options,"tapemeasure","ticks"),x=t.create("ticks",[b,.1],h),b.inherits.push(x)),b.remove=function(){l&&b.removeTicks(x),t.removeObject(y),t.removeObject(Z),Gt.Z.prototype.remove.call(this)},b.Value=function(){return Z.Dist(y)},Z.dump=!1,y.dump=!1,b.elType="tapemeasure",b.getParents=function(){return[[Z.X(),Z.Y()],[y.X(),y.Y()]]},b.subs={point1:Z,point2:y},l&&(x.dump=!1),b.methodMap=u.Z.deepCopy(b.methodMap,{Value:"Value"}),b.prepareUpdate().update(),t.isSuspendedUpdate||(b.updateVisibility().updateRenderer(),b.point1.updateVisibility().updateRenderer(),b.point2.updateVisibility().updateRenderer()),b},u.Z.registerElement("tapemeasure",u.Z.createTapemeasure),u.Z.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},u.Z.extend(u.Z.DataSource.prototype,{loadFromArray:function(t,e,o){var s,n,h;if(a.Z.isArray(e)&&(this.columnHeaders=e,e=!1),a.Z.isArray(o)&&(this.rowHeaders=o,o=!1),this.data=[],e&&(this.columnHeaders=[]),o&&(this.rowHeaders=[]),a.Z.exists(t)){for(this.data=[],s=0;s<t.length;s++)for(this.data[s]=[],n=0;n<t[s].length;n++)h=t[s][n],parseFloat(h).toString()===h?this.data[s][n]=parseFloat(h):this.data[s][n]=h!=="-"?h:NaN;if(e&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),o)for(this.rowHeaders=[],s=0;s<this.data.length;s++)this.rowHeaders.push(this.data[s][0]),this.data[s]=this.data[s].slice(1)}return this},loadFromTable:function(t,e,o){var s,n,h,l,p;if(a.Z.isArray(e)&&(this.columnHeaders=e,e=!1),a.Z.isArray(o)&&(this.rowHeaders=o,o=!1),this.data=[],e&&(this.columnHeaders=[]),o&&(this.rowHeaders=[]),t=document.getElementById(t),a.Z.exists(t)){for(s=t.getElementsByTagName("tr"),this.data=[],n=0;n<s.length;n++)for(l=s[n].getElementsByTagName("td"),this.data[n]=[],h=0;h<l.length;h++)p=l[h].innerHTML,parseFloat(p).toString()===p?this.data[n][h]=parseFloat(p):this.data[n][h]=p!=="-"?p:NaN;if(e&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),o)for(this.rowHeaders=[],n=0;n<this.data.length;n++)this.rowHeaders.push(this.data[n][0]),this.data[n]=this.data[n].slice(1)}return this},addColumn:function(t,e,o){throw new Error("not implemented")},addRow:function(t,e,o){throw new Error("not implemented")},getColumn:function(t){var e,o=[];if(a.Z.isString(t)){for(e=0;e<this.columnHeaders.length;e++)if(t===this.columnHeaders[e]){t=e;break}}for(e=0;e<this.data.length;e++)this.data[e].length>t&&(o[e]=parseFloat(this.data[e][t]));return o},getRow:function(t){var e,o;if(a.Z.isString(t)){for(o=0;o<this.rowHeaders.length;o++)if(t===this.rowHeaders[o]){t=o;break}}for(e=[],o=0;o<this.data[t].length;o++)e[o]=this.data[t][o];return e}});const Ce=u.Z.DataSource;u.Z.Chart=function(t,e,o){var s,n,h,l,p,d;if(this.constructor(t,o),!a.Z.isArray(e)||e.length===0)throw new Error("JSXGraph: Can't create a chart without data");if(this.elements=[],a.Z.isNumber(e[0]))for(n=e,s=[],h=0;h<n.length;h++)s[h]=h+1;else if(e.length===1&&a.Z.isArray(e[0]))for(n=e[0],s=[],d=a.Z.evaluate(n).length,h=0;h<d;h++)s[h]=h+1;else e.length===2&&(d=Math.min(e[0].length,e[1].length),s=e[0].slice(0,d),n=e[1].slice(0,d));if(a.Z.isArray(n)&&n.length===0)throw new Error("JSXGraph: Can't create charts without data.");for(p=o.chartstyle.replace(/ /g,"").split(","),h=0;h<p.length;h++){switch(p[h]){case"bar":l=this.drawBar(t,s,n,o);break;case"line":l=this.drawLine(t,s,n,o);break;case"fit":l=this.drawFit(t,s,n,o);break;case"spline":l=this.drawSpline(t,s,n,o);break;case"pie":l=this.drawPie(t,n,o);break;case"point":l=this.drawPoints(t,s,n,o);break;case"radar":l=this.drawRadar(t,e,o)}this.elements.push(l)}return this.id=this.board.setId(this,"Chart"),this.elements},u.Z.Chart.prototype=new Gt.Z,u.Z.extend(u.Z.Chart.prototype,{drawLine:function(t,e,o,s){return s.fillcolor="none",s.highlightfillcolor="none",t.create("curve",[e,o],s)},drawSpline:function(t,e,o,s){return s.fillColor="none",s.highlightfillcolor="none",t.create("spline",[e,o],s)},drawFit:function(t,e,o,s){var n=s.degree;return n=Math.max(parseInt(n,10),1)||1,s.fillcolor="none",s.highlightfillcolor="none",t.create("functiongraph",[c.Z.regressionPolynomial(n,e,o)],s)},drawBar:function(t,e,o,s){var n,h,l,p,d,b,Z,y,O,x,D=[],k=[],I=function(J,z){return function(){return e[J]()-z*l}},U={fixed:!0,withLabel:!1,visible:!1,name:""};if((O=a.Z.copyAttributes(s,t.options,"chart"))&&O.width)l=O.width;else{if(e.length<=1)l=1;else for(l=e[1]-e[0],n=1;n<e.length-1;n++)l=e[n+1]-e[n]<l?e[n+1]-e[n]:l;l*=.8}for(x=a.Z.copyAttributes(s,t.options,"chart","label"),n=0;n<e.length;n++)a.Z.isFunction(e[n])?(p=I(n,-.5),d=I(n,0),b=I(n,.5)):(p=e[n]-.5*l,d=e[n],b=e[n]+.5*l),Z=a.Z.isFunction(o[n])?o[n]():o[n],Z=o[n],O.dir==="horizontal"?(k[0]=t.create("point",[0,p],U),k[1]=t.create("point",[Z,p],U),k[2]=t.create("point",[Z,b],U),k[3]=t.create("point",[0,b],U),a.Z.exists(O.labels)&&a.Z.exists(O.labels[n])&&(x.anchorY="middle",(h=t.create("text",[Z,d,O.labels[n]],x)).visProp.anchorx=function(J){return function(){return J.X()>=0?"left":"right"}}(h))):(k[0]=t.create("point",[p,0],U),k[1]=t.create("point",[p,Z],U),k[2]=t.create("point",[b,Z],U),k[3]=t.create("point",[b,0],U),a.Z.exists(O.labels)&&a.Z.exists(O.labels[n])&&(x.anchorX="middle",(h=t.create("text",[d,Z,O.labels[n]],x)).visProp.anchory=function(J){return function(){return J.Y()>=0?"bottom":"top"}}(h))),a.Z.isArray(O.colors)&&(y=O.colors,O.fillcolor=y[n%y.length]),D[n]=t.create("polygon",k,O),a.Z.exists(O.labels)&&a.Z.exists(O.labels[n])&&(D[n].text=h);return D},drawPoints:function(t,e,o,s){var n,h=[],l=s.infoboxarray;for(s.fixed=!0,s.name="",n=0;n<e.length;n++)s.infoboxtext=!!l&&l[n%l.length],h[n]=t.create("point",[e[n],o[n]],s);return h},drawPie:function(t,e,o){var s,n,h=[],l=[],p=(v.Z.sum(e),o.colors),d=o.highlightcolors,b=o.labels,Z=o.radius||4,y=Z,O=o.center||[0,0],x=O[0],D=O[1],k=function(V,W,$){return function(){var nt,et,lt,ot=0;for(et=0;et<=V;et++)ot+=parseFloat(a.Z.evaluate(e[et]));for(nt=ot,et=V+1;et<e.length;et++)nt+=parseFloat(a.Z.evaluate(e[et]));return lt=nt!==0?2*Math.PI*ot/nt:0,y()*Math[W](lt)+$}},I=function(V,W){var $=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],nt=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];a.Z.exists(this.label)&&(this.label.rendNode.style.fontSize=W*a.Z.evaluate(this.label.visProp.fontsize)+"px",this.label.fullUpdate()),this.point2.coords=new m.Z(S.Z.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+$*V,this.point1.coords.usrCoords[2]+nt*V],this.board),this.fullUpdate()},U=function(){this.highlighted||(this.highlighted=!0,this.board.highlightedObjects[this.id]=this,this.board.renderer.highlight(this),I.call(this,1.1,2))},J=function(){this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this),I.call(this,.9090909,1))},z={fixed:!0,withLabel:!1,visible:!1,name:""};if(!a.Z.isArray(b))for(b=[],s=0;s<e.length;s++)b[s]="";for(a.Z.isFunction(Z)||(y=function(){return Z}),o.highlightonsector=o.highlightonsector||!1,o.straightfirst=!1,o.straightlast=!1,n=t.create("point",[x,D],z),h[0]=t.create("point",[function(){return y()+x},function(){return D}],z),s=0;s<e.length;s++)h[s+1]=t.create("point",[k(s,"cos",x),k(s,"sin",D)],z),o.name=b[s],o.withlabel=o.name!=="",o.fillcolor=p&&p[s%p.length],o.labelcolor=p&&p[s%p.length],o.highlightfillcolor=d&&d[s%d.length],l[s]=t.create("sector",[n,h[s],h[s+1]],o),o.highlightonsector&&(l[s].hasPoint=l[s].hasPointSector),o.highlightbysize&&(l[s].highlight=U,l[s].noHighlight=J);return{sectors:l,points:h,midpoint:n}},drawRadar:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z,V,W,$,nt,et,lt,ot,gt,vt,Tt,Rt,kt,Ft,te,qt,Pt,yt,mt,bt,pt,At,zt,ft,wt,Ot,Lt=e.length,Wt=function(){var jt,It,Et,ee,Jt=a.Z.evaluate(this.visProp.label.offset).slice(0);return jt=this.point1.X(),It=this.point2.X(),Et=this.point1.Y(),ee=this.point2.Y(),It<jt&&(Jt[0]=-Jt[0]),ee<Et&&(Jt[1]=-Jt[1]),this.setLabelRelativeCoords(Jt),new m.Z(S.Z.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},Vt=function(jt,It){var Et,ee,Jt;return Et=t.create("transform",[-(U[It]-k[It]),0],{type:"translate"}),ee=t.create("transform",[W/(J[It]+I[It]-(U[It]-k[It])),1],{type:"scale"}),Et.melt(ee),Jt=t.create("transform",[jt],{type:"rotate"}),Et.melt(Jt),Et};if(Lt<=0)throw new Error("JSXGraph radar chart: no data");if(h=o.paramarray,!a.Z.exists(h))throw new Error("JSXGraph radar chart: need paramArray attribute");if((l=h.length)<=1)throw new Error("JSXGraph radar chart: need more than one param in paramArray");for(s=0;s<Lt;s++)if(l!==e[s].length)throw new Error("JSXGraph radar chart: use data length equal to number of params ("+e[s].length+" != "+l+")");for(p=[],d=[],n=0;n<l;n++)p[n]=e[0][n],d[n]=p[n];for(s=1;s<Lt;s++)for(n=0;n<l;n++)e[s][n]>p[n]&&(p[n]=e[s][n]),e[s][n]<d[n]&&(d[n]=e[s][n]);for(b=[],Z=[],s=0;s<Lt;s++)b[s]="",Z[s]=[];for(y=[],O=[],x=o.startshiftratio||0,D=o.endshiftratio||0,s=0;s<l;s++)y[s]=(p[s]-d[s])*x,O[s]=(p[s]-d[s])*D;if(k=o.startshiftarray||y,I=o.endshiftarray||O,U=o.startarray||d,a.Z.exists(o.start))for(s=0;s<l;s++)U[s]=o.start;if(J=o.endarray||p,a.Z.exists(o.end))for(s=0;s<l;s++)J[s]=o.end;if(k.length!==l)throw new Error("JSXGraph radar chart: start shifts length is not equal to number of parameters");if(I.length!==l)throw new Error("JSXGraph radar chart: end shifts length is not equal to number of parameters");if(U.length!==l)throw new Error("JSXGraph radar chart: starts length is not equal to number of parameters");if(J.length!==l)throw new Error("JSXGraph radar chart: snds length is not equal to number of parameters");for(z=o.labelarray||b,V=o.colors,o.highlightcolors,W=o.radius||10,wt=o.strokewidth||1,a.Z.exists(o.highlightonsector)||(o.highlightonsector=!1),$={name:o.name,id:o.id,strokewidth:wt,polystrokewidth:o.polystrokewidth||wt,strokecolor:o.strokecolor||"black",straightfirst:!1,straightlast:!1,fillcolor:o.fillColor||"#FFFF88",fillopacity:o.fillOpacity||.4,highlightfillcolor:o.highlightFillColor||"#FF7400",highlightstrokecolor:o.highlightStrokeColor||"black",gradient:o.gradient||"none"},et=(nt=o.center||[0,0])[0],lt=nt[1],ot=t.create("point",[et,lt],{name:"",fixed:!0,withlabel:!1,visible:!1}),vt=gt=o.startangle||0,Tt=[],Rt=[],s=0;s<l;s++)for(vt+=2*Math.PI/l,Ft=W*Math.cos(vt)+et,te=W*Math.sin(vt)+lt,Tt[s]=t.create("point",[Ft,te],{name:"",fixed:!0,withlabel:!1,visible:!1}),Rt[s]=t.create("line",[ot,Tt[s]],{name:h[s],strokeColor:$.strokecolor,strokeWidth:$.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:$.highlightstrokecolor}),Rt[s].getLabelAnchor=Wt,kt=Vt(vt,s),n=0;n<e.length;n++)Ot=e[n][s],Z[n][s]=t.create("point",[Ot,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),Z[n][s].addTransform(Z[n][s],kt);for(qt=[],s=0;s<Lt;s++)for($.labelcolor=V&&V[s%V.length],$.strokecolor=V&&V[s%V.length],$.fillcolor=V&&V[s%V.length],qt[s]=t.create("polygon",Z[s],{withLines:!0,withLabel:!1,fillColor:$.fillcolor,fillOpacity:$.fillopacity,highlightFillColor:$.highlightfillcolor}),n=0;n<l;n++)qt[s].borders[n].setAttribute("strokecolor:"+V[s%V.length]),qt[s].borders[n].setAttribute("strokewidth:"+$.polystrokewidth);switch(o.legendposition||"none"){case"right":yt=o.legendleftoffset||2,mt=o.legendtopoffset||1,this.legend=t.create("legend",[et+W+yt,lt+W-mt],{labels:z,colors:V});break;case"none":break;default:u.Z.debug("Unknown legend position")}if(Pt=[],o.showcircles){for(bt=[],s=0;s<6;s++)bt[s]=20*s;if(bt[0]="0",(At=(pt=o.circlelabelarray||bt).length)<2)throw new Error("JSXGraph radar chart: too less circles in circleLabelArray");for(zt=[],kt=Vt(gt+Math.PI/l,0),$.fillcolor="none",$.highlightfillcolor="none",$.strokecolor=o.strokecolor||"black",$.strokewidth=o.circlestrokewidth||.5,$.layer=0,ft=(J[0]-U[0])/(At-1),s=0;s<At;s++)zt[s]=t.create("point",[U[0]+s*ft,0],{name:pt[s],size:0,fixed:!0,withLabel:!0,visible:!0}),zt[s].addTransform(zt[s],kt),Pt[s]=t.create("circle",[ot,zt[s]],$)}return this.rendNode=qt[0].rendNode,{circles:Pt,lines:Rt,points:Z,midpoint:ot,polygons:qt}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){return this}}),u.Z.createChart=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z=[],V=N.Z.isBrowser?t.document.getElementById(e[0]):null;if(e.length===1&&a.Z.isString(e[0])){if(a.Z.exists(V)){if(y=a.Z.copyAttributes(o,t.options,"chart"),s=(V=new Ce().loadFromTable(e[0],y.withheaders,y.withheaders)).data,p=V.columnHeaders,n=V.rowHeaders,O=y.width,x=y.name,D=y.strokecolor,k=y.fillcolor,I=y.highlightstrokecolor,U=y.highlightfillcolor,t.suspendUpdate(),J=s.length,Z=[],y.rows&&a.Z.isArray(y.rows)){for(h=0;h<J;h++)for(l=0;l<y.rows.length;l++)if(y.rows[l]===h||y.withheaders&&y.rows[l]===n[h]){Z.push(s[h]);break}}else Z=s;for(J=Z.length,h=0;h<J;h++){if(b=[],y.chartstyle&&y.chartstyle.indexOf("bar")!==-1){for(d=O||.8,b.push(1-d/2+(h+.5)*d/J),l=1;l<Z[h].length;l++)b.push(b[l-1]+1);y.width=d/J}x&&x.length===J?y.name=x[h]:y.withheaders&&(y.name=p[h]),D&&D.length===J?y.strokecolor=D[h]:y.strokecolor=_t.Z.hsv2rgb((h+1)/J*360,.9,.6),k&&k.length===J?y.fillcolor=k[h]:y.fillcolor=_t.Z.hsv2rgb((h+1)/J*360,.9,1),I&&I.length===J?y.highlightstrokecolor=I[h]:y.highlightstrokecolor=_t.Z.hsv2rgb((h+1)/J*360,.9,1),U&&U.length===J?y.highlightfillcolor=U[h]:y.highlightfillcolor=_t.Z.hsv2rgb((h+1)/J*360,.9,.6),y.chartstyle&&y.chartstyle.indexOf("bar")!==-1?z.push(new u.Z.Chart(t,[b,Z[h]],y)):z.push(new u.Z.Chart(t,[Z[h]],y))}t.unsuspendUpdate()}return z}return y=a.Z.copyAttributes(o,t.options,"chart"),new u.Z.Chart(t,e,y)},u.Z.registerElement("chart",u.Z.createChart),u.Z.Legend=function(t,e,o){var s;if(this.constructor(),s=a.Z.copyAttributes(o,t.options,"legend"),this.board=t,this.coords=new m.Z(S.Z.COORDS_BY_USER,e,this.board),this.myAtts={},this.label_array=s.labelarray||s.labels,this.color_array=s.colorarray||s.colors,this.lines=[],this.myAtts.strokewidth=s.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=s.legendstyle||s.style,this.style!=="vertical")throw new Error("JSXGraph: Unknown legend style: "+this.style);this.drawVerticalLegend(t,s)},u.Z.Legend.prototype=new Gt.Z,u.Z.Legend.prototype.drawVerticalLegend=function(t,e){var o,s=e.linelength||1,n=(e.rowheight||20)/this.board.unitY,h=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new m.Z(S.Z.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)};for(o=0;o<this.label_array.length;o++)this.myAtts.name=this.label_array[o],this.myAtts.strokecolor=this.color_array[o%this.color_array.length],this.myAtts.highlightstrokecolor=this.color_array[o%this.color_array.length],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[o%this.color_array.length],strokeWidth:this.myAtts.strokewidth},this.lines[o]=t.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-o*n],[this.coords.usrCoords[1]+s,this.coords.usrCoords[2]-o*n]],this.myAtts),this.lines[o].getLabelAnchor=h,this.lines[o].prepareUpdate().update().updateVisibility(a.Z.evaluate(this.lines[o].visProp.visible)).updateRenderer()},u.Z.createLegend=function(t,e,o){var s=[0,0];if(!a.Z.exists(e)||e.length!==2)throw new Error("JSXGraph: Legend element needs two numbers as parameters");return s=e,new u.Z.Legend(t,s,o)},u.Z.registerElement("legend",u.Z.createLegend),u.Z.Chart,u.Z.Legend,u.Z.Transformation=function(t,e,o){this.elementClass=S.Z.OBJECT_CLASS_OTHER,this.type=S.Z.OBJECT_TYPE_TRANSFORMATION,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=t,this.isNumericMatrix=!1,this.setMatrix(t,e,o),this.methodMap={apply:"apply",applyOnce:"applyOnce",bindTo:"bindTo",bind:"bindTo",melt:"melt"}},u.Z.Transformation.prototype={},u.Z.extend(u.Z.Transformation.prototype,{update:function(){return this},setMatrix:function(t,e,o){var s;for(this.isNumericMatrix=!0,s=0;s<o.length;s++)if(typeof o[s]!="number"){this.isNumericMatrix=!1;break}if(e==="translate"){if(o.length!==2)throw new Error("JSXGraph: translate transformation needs 2 parameters.");this.evalParam=a.Z.createEvalFunction(t,o,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}}else if(e==="scale"){if(o.length!==2)throw new Error("JSXGraph: scale transformation needs 2 parameters.");this.evalParam=a.Z.createEvalFunction(t,o,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}}else if(e==="reflect")o.length<4&&(o[0]=t.select(o[0])),o.length===2&&(o[1]=t.select(o[1])),o.length===4&&(this.evalParam=a.Z.createEvalFunction(t,o,4)),this.update=function(){var n,h,l,p,d,b,Z,y;o.length===1?Z=o[0].stdform:o.length===2?Z=B.Z.crossProduct(o[1].coords.usrCoords,o[0].coords.usrCoords):o.length===4&&(Z=B.Z.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),n=Z[1],h=Z[2],b=(y=[-(l=Z[0])*n,-l*h,n*n+h*h])[2],p=y[0]/y[2],d=y[1]/y[2],n=-Z[2],h=Z[1],this.matrix[1][1]=(n*n-h*h)/b,this.matrix[1][2]=2*n*h/b,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=p*(1-this.matrix[1][1])-d*this.matrix[1][2],this.matrix[2][0]=d*(1-this.matrix[2][2])-p*this.matrix[2][1]};else if(e==="rotate")o.length===3?this.evalParam=a.Z.createEvalFunction(t,o,3):o.length>0&&o.length<=2&&(this.evalParam=a.Z.createEvalFunction(t,o,1),o.length!==2||a.Z.isArray(o[1])||(o[1]=t.select(o[1]))),this.update=function(){var n,h,l=this.evalParam(0),p=Math.cos(l),d=Math.sin(l);this.matrix[1][1]=p,this.matrix[1][2]=-d,this.matrix[2][1]=d,this.matrix[2][2]=p,o.length>1&&(o.length===3?(n=this.evalParam(1),h=this.evalParam(2)):a.Z.isArray(o[1])?(n=o[1][0],h=o[1][1]):(n=o[1].X(),h=o[1].Y()),this.matrix[1][0]=n*(1-p)+h*d,this.matrix[2][0]=h*(1-p)-n*d)};else if(e==="shear"){if(o.length!==2)throw new Error("JSXGraph: shear transformation needs 2 parameters.");this.evalParam=a.Z.createEvalFunction(t,o,2),this.update=function(){this.matrix[1][2]=this.evalParam(0),this.matrix[2][1]=this.evalParam(1)}}else if(e==="generic"){if(o.length!==9)throw new Error("JSXGraph: generic transformation needs 9 parameters.");this.evalParam=a.Z.createEvalFunction(t,o,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)}}},apply:function(t,e){return this.update(),a.Z.exists(e)?B.Z.matVecMult(this.matrix,t.initialCoords.usrCoords):B.Z.matVecMult(this.matrix,t.coords.usrCoords)},applyOnce:function(t){var e,o,s;for(a.Z.isArray(t)||(t=[t]),o=t.length,s=0;s<o;s++)this.update(),e=B.Z.matVecMult(this.matrix,t[s].coords.usrCoords),t[s].coords.setCoordinates(S.Z.COORDS_BY_USER,e)},bindTo:function(t){var e,o;if(a.Z.isArray(t))for(o=t.length,e=0;e<o;e++)t[e].transformations.push(this);else t.transformations.push(this)},setProperty:function(t){u.Z.deprecated("Transformation.setProperty()","Transformation.setAttribute()")},setAttribute:function(t){},melt:function(t){var e,o,s,n,h,l,p=[];for(o=t.matrix.length,s=this.matrix[0].length,e=0;e<o;e++)p[e]=[];for(this.update(),t.update(),e=0;e<o;e++)for(l=0;l<s;l++){for(h=0,n=0;n<o;n++)h+=t.matrix[e][n]*this.matrix[n][l];p[e][l]=h}return this.update=function(){var d=this.matrix.length,b=this.matrix[0].length;for(e=0;e<d;e++)for(l=0;l<b;l++)this.matrix[e][l]=p[e][l]},this},getParents:function(){var t=[[].concat.apply([],this.matrix)];return this.parents.length!==0&&(t=this.parents),t}}),u.Z.createTransform=function(t,e,o){return new u.Z.Transformation(t,o.type,e)},u.Z.registerElement("transform",u.Z.createTransform),u.Z.Transformation,u.Z.Turtle=function(t,e,o){var s,n,h;return this.constructor(t,o,S.Z.OBJECT_TYPE_TURTLE,S.Z.OBJECT_CLASS_OTHER),this.turtleIsHidden=!1,this.board=t,this.visProp.curveType="plot",this._attributes=a.Z.copyAttributes(this.visProp,t.options,"turtle"),delete this._attributes.id,s=0,n=0,h=90,e.length!==0&&(e.length===3?(s=e[0],n=e[1],h=e[2]):e.length===2?a.Z.isArray(e[0])?(s=e[0][0],n=e[0][1],h=e[1]):(s=e[0],n=e[1]):(s=e[0][0],n=e[0][1])),this.init(s,n,h),this.methodMap=a.Z.deepCopy(this.methodMap,{forward:"forward",fd:"forward",back:"back",bk:"back",right:"right",rt:"right",left:"left",lt:"left",penUp:"penUp",pu:"penUp",penDown:"penDown",pd:"penDown",clearScreen:"clearScreen",cs:"clearScreen",clean:"clean",setPos:"setPos",home:"home",hideTurtle:"hideTurtle",ht:"hideTurtle",showTurtle:"showTurtle",st:"showTurtle",penSize:"setPenSize",penColor:"setPenColor",getPenColor:"getPenColor",getHighlightPenColor:"getHighlightPenColor",getPenSize:"getPenSize",pushTurtle:"pushTurtle",push:"pushTurtle",popTurtle:"popTurtle",pop:"popTurtle",lookTo:"lookTo",pos:"pos",moveTo:"moveTo",X:"X",Y:"Y"}),this},u.Z.Turtle.prototype=new Gt.Z,u.Z.extend(u.Z.Turtle.prototype,{init:function(t,e,o){var s={fixed:!0,name:"",visible:!1,withLabel:!1};this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[t,e],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,s),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],s),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.subs={arrow:this.arrow},this.inherits.push(this.arrow),this.right(90-o),this.board.update()},forward:function(t){if(t===0)return this;var e,o=t*Math.cos(this.dir*Math.PI/180),s=t*Math.sin(this.dir*Math.PI/180);return this.turtleIsHidden||((e=this.board.create("transform",[o,s],{type:"translate"})).applyOnce(this.turtle),e.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=o,this.pos[1]+=s,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(t){return this.forward(-t)},right:function(t){return this.dir-=t,this.dir%=360,this.turtleIsHidden||this.board.create("transform",[-t*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2),this.board.update(),this},left:function(t){return this.right(-t)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){var t,e;for(t=0;t<this.objects.length;t++)(e=this.objects[t]).type===S.Z.OBJECT_TYPE_CURVE&&(this.board.removeObject(e),this.objects.splice(t,1));return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var t,e,o=this.objects.length;for(t=0;t<o;t++)e=this.objects[t],this.board.removeObject(e);return this.init(0,0,90),this},setPos:function(t,e){return a.Z.isArray(t)?this.pos=t:this.pos=[t,e],this.turtleIsHidden||(this.turtle.setPositionDirectly(S.Z.COORDS_BY_USER,[t,e]),this.turtle2.setPositionDirectly(S.Z.COORDS_BY_USER,[t,e+this.arrowLen]),this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"}).applyOnce(this.turtle2)),this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",t)),this.objects.push(this.curve),this},setPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",t)),this.objects.push(this.curve),this},getPenAttribute:function(t){var e,o=this.objects.length;return e=o===4?0:o-1,a.Z.evaluate(this.objects[e].visProp[t])},getPenSize:function(){return this.getPenAttribute("strokewidth")},getPenColor:function(){return this.getPenAttribute("strokecolor")},getHighlightPenColor:function(){return this.getPenAttribute("highlightstrokecolor")},setHighlightPenColor:function(t){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",t)),this.objects.push(this.curve),this},setAttribute:function(t){var e,o,s,n=this.objects.length;for(e=0;e<n;e++)(o=this.objects[e]).type===S.Z.OBJECT_TYPE_CURVE&&o.setAttribute(t);return s=this.visProp.id,this.visProp=a.Z.deepCopy(this.curve.visProp),this.visProp.id=s,this._attributes=a.Z.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(t,e){return this._attributes[t.toLowerCase()]=e,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setAttribute({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setAttribute({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var t=this.stack.pop();return this.pos[0]=t[0],this.pos[1]=t[1],this.dir=t[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(t){var e,o,s,n,h;return a.Z.isArray(t)?(e=this.pos[0],o=this.pos[1],s=t[0],n=t[1],h=Math.atan2(n-o,s-e),this.right(this.dir-180*h/Math.PI)):a.Z.isNumber(t)&&this.right(this.dir-t),this},moveTo:function(t){var e,o,s;return a.Z.isArray(t)&&(e=t[0]-this.pos[0],o=t[1]-this.pos[1],this.turtleIsHidden||((s=this.board.create("transform",[e,o],{type:"translate"})).applyOnce(this.turtle),s.applyOnce(this.turtle2)),this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=t[0],this.pos[1]=t[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()),this},fd:function(t){return this.forward(t)},bk:function(t){return this.back(t)},lt:function(t){return this.left(t)},rt:function(t){return this.right(t)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(t,e){var o,s,n,h,l=this.objects.length;for(o=0,s=0;o<l;o++)if((n=this.objects[o]).elementClass===S.Z.OBJECT_CLASS_CURVE){if(s<=t&&t<s+n.numberPoints)return h=t-s,n[e](h);s+=n.numberPoints}return this[e]()},X:function(t){return a.Z.exists(t)?this.evalAt(t,"X"):this.pos[0]},Y:function(t){return a.Z.exists(t)?this.evalAt(t,"Y"):this.pos[1]},Z:function(t){return 1},minX:function(){return 0},maxX:function(){var t,e=this.objects.length,o=0;for(t=0;t<e;t++)this.objects[t].elementClass===S.Z.OBJECT_CLASS_CURVE&&(o+=this.objects[t].numberPoints);return o},hasPoint:function(t,e){var o,s;for(o=0;o<this.objects.length;o++)if((s=this.objects[o]).type===S.Z.OBJECT_TYPE_CURVE&&s.hasPoint(t,e))return!0;return!1}}),u.Z.createTurtle=function(t,e,o){var s;return e=e||[],s=a.Z.copyAttributes(o,t.options,"turtle"),new u.Z.Turtle(t,e,s)},u.Z.registerElement("turtle",u.Z.createTurtle),u.Z.Turtle,u.Z.Ticks=function(t,e,o){if(this.constructor(t.board,o,S.Z.OBJECT_TYPE_TICKS,S.Z.OBJECT_CLASS_OTHER),this.line=t,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,this.labelsData=[],a.Z.isFunction(e))throw this.ticksFunction=e,new Error("Function arguments are no longer supported.");a.Z.isArray(e)?this.fixedTicks=e:((Math.abs(e)<B.Z.eps||e<0)&&(e=o.defaultdistance),this.ticksFunction=this.makeTicksFunction(e),this.equidistant=!0),this.minTicksDistance=o.minticksdistance,this.ticks=[],this.ticksDelta=1,this.labels=[],this.labelData=[],this.labelCounter=0,this.id=this.line.addTicks(this),this.elType="ticks",this.inherits.push(this.labels),this.board.setId(this,"Ti")},u.Z.Ticks.prototype=new Gt.Z,u.Z.extend(u.Z.Ticks.prototype,{makeTicksFunction:function(t){return function(){var e,o,s;return a.Z.evaluate(this.visProp.insertticks)?((s=(o=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance")).upper-o.lower)<=6*(e=Math.pow(10,Math.floor(Math.log(.6*s)/Math.LN10)))&&(e*=.5),e):t}},hasPoint:function(t,e){var o,s,n,h,l=this.ticks&&this.ticks.length||0;if(a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(h=this.board._inputDevice,n=a.Z.evaluate(this.visProp.precision[h])):n=this.board.options.precision.hasPoint,n+=.5*a.Z.evaluate(this.visProp.strokewidth),!a.Z.evaluate(this.line.visProp.scalable)||this.line.elementClass===S.Z.OBJECT_CLASS_CURVE||this.line.stdform[1]!==0&&this.line.stdform[2]!==0&&this.line.type!==S.Z.OBJECT_TYPE_AXIS)return!1;for(o=0;o<l;o++)if((s=this.ticks[o])[2]&&!(this.line.stdform[1]===0&&Math.abs(s[0][0]-this.line.point1.coords.scrCoords[1])<B.Z.eps||this.line.stdform[2]===0&&Math.abs(s[1][0]-this.line.point1.coords.scrCoords[2])<B.Z.eps)&&(Math.abs(s[0][0]-s[0][1])>=1||Math.abs(s[1][0]-s[1][1])>=1)){if(this.line.stdform[1]===0){if(Math.abs(e-.5*(s[1][0]+s[1][1]))<2*n&&s[0][0]-n<t&&t<s[0][1]+n)return!0}else if(this.line.stdform[2]===0&&Math.abs(t-.5*(s[0][0]+s[0][1]))<2*n&&s[1][0]-n<e&&e<s[1][1]+n)return!0}return!1},setPositionDirectly:function(t,e,o){var s,n,h=new m.Z(t,e,this.board),l=new m.Z(t,o,this.board),p=this.board.getBoundingBox();return this.line.type===S.Z.OBJECT_TYPE_AXIS&&a.Z.evaluate(this.line.visProp.scalable)?(Math.abs(this.line.stdform[1])<B.Z.eps&&Math.abs(h.usrCoords[1]*l.usrCoords[1])>B.Z.eps?(s=l.usrCoords[1]/h.usrCoords[1],p[0]*=s,p[2]*=s,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")):Math.abs(this.line.stdform[2])<B.Z.eps&&Math.abs(h.usrCoords[2]*l.usrCoords[2])>B.Z.eps&&(n=l.usrCoords[2]/h.usrCoords[2],p[3]*=n,p[1]*=n,this.board.setBoundingBox(p,this.board.keepaspectratio,"update")),this):this},calculateTicksCoordinates:function(){var t,e,o,s;if(!(this.line.elementClass===S.Z.OBJECT_CLASS_LINE&&(this.setTicksSizeVariables(),Math.abs(this.dx)<B.Z.eps&&Math.abs(this.dy)<B.Z.eps)))return t=this.getZeroCoordinates(),e=this.line.elementClass===S.Z.OBJECT_CLASS_LINE?this.getLowerAndUpperBounds(t):{lower:this.line.minX(),upper:this.line.maxX()},a.Z.evaluate(this.visProp.type)==="polar"&&(s=this.board.getBoundingBox(),o=Math.max(Math.sqrt(s[0]*s[0]+s[1]*s[1]),Math.sqrt(s[2]*s[2]+s[3]*s[3])),e.upper=o),this.ticks=[],this.labelsData=[],this.equidistant?this.generateEquidistantTicks(t,e):this.generateFixedTicks(t,e),this},setTicksSizeVariables:function(t){var e,o,s,n,h=.5*a.Z.evaluate(this.visProp.majorheight),l=.5*a.Z.evaluate(this.visProp.minorheight);a.Z.exists(t)?(o=this.line.minX(),s=this.line.maxX(),(n=this.line.points.length)<2?(this.dxMaj=0,this.dyMaj=0):B.Z.relDif(t,o)<B.Z.eps?(this.dxMaj=this.line.points[0].usrCoords[2]-this.line.points[1].usrCoords[2],this.dyMaj=this.line.points[1].usrCoords[1]-this.line.points[0].usrCoords[1]):B.Z.relDif(t,s)<B.Z.eps?(this.dxMaj=this.line.points[n-2].usrCoords[2]-this.line.points[n-1].usrCoords[2],this.dyMaj=this.line.points[n-1].usrCoords[1]-this.line.points[n-2].usrCoords[1]):(this.dxMaj=-c.Z.D(this.line.Y)(t),this.dyMaj=c.Z.D(this.line.X)(t))):(this.dxMaj=this.line.stdform[1],this.dyMaj=this.line.stdform[2]),this.dxMin=this.dxMaj,this.dyMin=this.dyMaj,this.dx=this.dxMaj,this.dy=this.dyMaj,e=Math.sqrt(this.dxMaj*this.dxMaj*this.board.unitX*this.board.unitX+this.dyMaj*this.dyMaj*this.board.unitY*this.board.unitY),this.dxMaj*=h/e*this.board.unitX,this.dyMaj*=h/e*this.board.unitY,this.dxMin*=l/e*this.board.unitX,this.dyMin*=l/e*this.board.unitY,this.minStyle=a.Z.evaluate(this.visProp.minorheight)<0?"infinite":"finite",this.majStyle=a.Z.evaluate(this.visProp.majorheight)<0?"infinite":"finite"},getZeroCoordinates:function(){var t,e,o,s,n,h,l,p,d=a.Z.evaluate(this.visProp.anchor);return this.line.elementClass===S.Z.OBJECT_CLASS_LINE?this.line.type===S.Z.OBJECT_TYPE_AXIS?_.Z.projectPointToLine({coords:{usrCoords:[1,0,0]}},this.line,this.board):(o=this.line.point1.coords.usrCoords[0],t=this.line.point1.coords.usrCoords[1],e=this.line.point1.coords.usrCoords[2],h=this.line.point2.coords.usrCoords[0],s=this.line.point2.coords.usrCoords[1],n=this.line.point2.coords.usrCoords[2],d==="right"?this.line.point2.coords:d==="middle"?new m.Z(S.Z.COORDS_BY_USER,[.5*(o+h),.5*(t+s),.5*(e+n)],this.board):a.Z.isNumber(d)?new m.Z(S.Z.COORDS_BY_USER,[o+(h-o)*d,t+(s-t)*d,e+(n-e)*d],this.board):this.line.point1.coords):(l=this.line.minX(),p=this.line.maxX(),d==="right"?p:d==="middle"?.5*(l+p):a.Z.isNumber(d)?l*(1-d)+p*d:l)},getLowerAndUpperBounds:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O=a.Z.evaluate(this.line.visProp.straightfirst),x=a.Z.evaluate(this.line.visProp.straightlast),D=a.Z.evaluate(this.visProp.includeboundaries);return this.line.elementClass===S.Z.OBJECT_CLASS_CURVE?{lower:this.line.minX(),upper:this.line.maxX()}:(l=new m.Z(S.Z.COORDS_BY_USER,this.line.point1.coords.usrCoords,this.board),p=new m.Z(S.Z.COORDS_BY_USER,this.line.point2.coords.usrCoords,this.board),d=Math.abs(l.usrCoords[0])>=B.Z.eps&&l.scrCoords[1]>=0&&l.scrCoords[1]<=this.board.canvasWidth&&l.scrCoords[2]>=0&&l.scrCoords[2]<=this.board.canvasHeight,b=Math.abs(p.usrCoords[0])>=B.Z.eps&&p.scrCoords[1]>=0&&p.scrCoords[1]<=this.board.canvasWidth&&p.scrCoords[2]>=0&&p.scrCoords[2]<=this.board.canvasHeight,a.Z.exists(e)||e==="tickdistance"?_.Z.calcStraight(this.line,l,p,a.Z.evaluate(this.line.visProp.margin)):_.Z.calcLineDelimitingPoints(this.line,l,p),n=a.Z.evaluate(this.line.visProp.firstarrow),h=a.Z.evaluate(this.line.visProp.lastarrow),(n||h)&&(this.board.renderer.getPositionArrowHead(this.line,l,p,a.Z.evaluate(this.line.visProp.strokewidth)),n&&l.setCoordinates(S.Z.COORDS_BY_SCREEN,[l.scrCoords[1],l.scrCoords[2]]),h&&p.setCoordinates(S.Z.COORDS_BY_SCREEN,[p.scrCoords[1],p.scrCoords[2]])),(Z=this.getDistanceFromZero(t,l))<(y=this.getDistanceFromZero(t,p))?(o=Z,O||!d||D||(o+=B.Z.eps),s=y,x||!b||D||(s-=B.Z.eps)):y<Z?(o=y,x||!b||D||(o+=B.Z.eps),s=Z,O||!d||D||(s-=B.Z.eps)):(o=0,s=0),{lower:o,upper:s})},getDistanceFromZero:function(t,e){var o,s,n,h,l;return o=this.line.point1.coords,s=this.line.point2.coords,l=t.distance(S.Z.COORDS_BY_USER,e),n=[s.usrCoords[0]-o.usrCoords[0],s.usrCoords[1]-o.usrCoords[1],s.usrCoords[2]-o.usrCoords[2]],h=[e.usrCoords[0]-t.usrCoords[0],e.usrCoords[1]-t.usrCoords[1],e.usrCoords[2]-t.usrCoords[2]],B.Z.innerProduct(n,h,3)<0&&(l*=-1),l},generateEquidistantTicks:function(t,e){var o,s,n=B.Z.eps,h=this.equidistant?this.ticksFunction(1):this.ticksDelta,l=a.Z.evaluate(this.visProp.insertticks),p=a.Z.evaluate(this.visProp.minorticks);if(this.line.elementClass===S.Z.OBJECT_CLASS_LINE&&(s=this.getXandYdeltas()),h*=a.Z.evaluate(this.visProp.scale),l&&this.minTicksDistance>B.Z.eps?(h=this.adjustTickDistance(h,t,s),h/=p+1):l||(h/=p+1),this.ticksDelta=h,!(h<B.Z.eps)){for(o=0,a.Z.evaluate(this.visProp.drawzero)||(o=h);o<=e.upper+n&&(o>=e.lower-n&&this.processTickPosition(t,o,h,s),o+=h,!(e.upper-o>1e4*h)););for(o=-h;o>=e.lower-n&&(o<=e.upper+n&&this.processTickPosition(t,o,h,s),!((o-=h)-e.lower>1e4*h)););}},adjustTickDistance:function(t,e,o){var s,n,h,l=1,p=a.Z.evaluate(this.visProp.minorticks);if(this.line.elementClass===S.Z.OBJECT_CLASS_CURVE)return t;if(this.getLowerAndUpperBounds(e,"ticksdistance"),s=e.usrCoords[1]+o.x*t,n=e.usrCoords[2]+o.y*t,h=e.distance(S.Z.COORDS_BY_SCREEN,new m.Z(S.Z.COORDS_BY_USER,[s,n],this.board)),t===0)return 0;for(;h/(p+1)<this.minTicksDistance;)t*=l===1?2:5,l*=-1,s=e.usrCoords[1]+o.x*t,n=e.usrCoords[2]+o.y*t,h=e.distance(S.Z.COORDS_BY_SCREEN,new m.Z(S.Z.COORDS_BY_USER,[s,n],this.board));return t},processTickPosition:function(t,e,o,s){var n,h,l,p,d,b=a.Z.evaluate(this.visProp.ticksperlabel),Z=null;this.line.elementClass===S.Z.OBJECT_CLASS_LINE?(n=t.usrCoords[1]+e*s.x,h=t.usrCoords[2]+e*s.y):(n=this.line.X(t+e),h=this.line.Y(t+e)),l=new m.Z(S.Z.COORDS_BY_USER,[n,h],this.board),this.line.elementClass===S.Z.OBJECT_CLASS_CURVE&&(Z=t+e,this.setTicksSizeVariables(Z)),l.major=Math.round(e/o)%(a.Z.evaluate(this.visProp.minorticks)+1)==0,b||(b=a.Z.evaluate(this.visProp.minorticks)+1),d=Math.round(e/o)%b==0,(p=this.createTickPath(l,l.major)).length===3&&(this.ticks.push(p),d&&a.Z.evaluate(this.visProp.drawlabels)?this.labelsData.push(this.generateLabelData(this.generateLabelText(l,t,Z),l,this.ticks.length)):this.labelsData.push(null))},generateFixedTicks:function(t,e){var o,s,n,h,l,p,d,b,Z=B.Z.eps,y=a.Z.isArray(this.visProp.labels),O=a.Z.evaluate(this.visProp.drawlabels);for(this.line.elementClass===S.Z.OBJECT_CLASS_LINE&&(b=this.getXandYdeltas()),n=0;n<this.fixedTicks.length;n++)this.line.elementClass===S.Z.OBJECT_CLASS_LINE?(d=this.fixedTicks[n],l=t.usrCoords[1]+d*b.x,p=t.usrCoords[2]+d*b.y):(d=t+this.fixedTicks[n],l=this.line.X(d),p=this.line.Y(d)),o=new m.Z(S.Z.COORDS_BY_USER,[l,p],this.board),this.line.elementClass===S.Z.OBJECT_CLASS_CURVE&&this.setTicksSizeVariables(d),(h=this.createTickPath(o,!0)).length===3&&d>=e.lower-Z&&d<=e.upper+Z&&(this.ticks.push(h),O&&(y||a.Z.exists(this.visProp.labels[n]))?(s=y?a.Z.evaluate(this.visProp.labels[n]):d,this.labelsData.push(this.generateLabelData(this.generateLabelText(o,t,s),o,n))):this.labelsData.push(null))},getXandYdeltas:function(){var t,e,o=this.line.point1.Dist(this.line.point2);return this.line.type===S.Z.OBJECT_TYPE_AXIS?(t=this.line.point1.coords.usrCoords,e=this.line.point2.coords.usrCoords,(t[1]>e[1]||Math.abs(t[1]-e[1])<B.Z.eps&&t[2]>e[2])&&(t=this.line.point2.coords.usrCoords,e=this.line.point1.coords.usrCoords)):(t=this.line.point1.coords.usrCoords,e=this.line.point2.coords.usrCoords),{x:(e[1]-t[1])/o,y:(e[2]-t[2])/o}},_isInsideCanvas:function(t,e,o){var s=this.board.canvasWidth,n=this.board.canvasHeight;return o===void 0&&(o=0),t[0]>=o&&t[0]<=s-o&&e[0]>=o&&e[0]<=n-o||t[1]>=o&&t[1]<=s-o&&e[1]>=o&&e[1]<=n-o},createTickPath:function(t,e){var o,s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z=[-2e6,-2e6],V=[-2e6,-2e6];if(o=t.scrCoords,e?(h=this.dxMaj,l=this.dyMaj,Z=this.majStyle,I=a.Z.evaluate(this.visProp.majortickendings[0])>0,U=a.Z.evaluate(this.visProp.majortickendings[1])>0):(h=this.dxMin,l=this.dyMin,Z=this.minStyle,I=a.Z.evaluate(this.visProp.tickendings[0])>0,U=a.Z.evaluate(this.visProp.tickendings[1])>0),s=[-l*o[1]-h*o[2],l,h],e&&a.Z.evaluate(this.visProp.type)==="polar"){if(x=this.board.getBoundingBox(),k=(D=2*Math.PI)/180,o=t.usrCoords,(O=Math.sqrt(o[1]*o[1]+o[2]*o[2]))<Math.max(Math.sqrt(x[0]*x[0]+x[1]*x[1]),Math.sqrt(x[2]*x[2]+x[3]*x[3]))){for(z=[],V=[],y=0;y<=D;y+=k)z.push(this.board.origin.scrCoords[1]+O*Math.cos(y)*this.board.unitX),V.push(this.board.origin.scrCoords[2]+O*Math.sin(y)*this.board.unitY);return[z,V,e]}}else{if(Z==="infinite"){if(a.Z.evaluate(this.visProp.ignoreinfinitetickendings)&&(I=U=!0),n=_.Z.meetLineBoard(s,this.board),I&&U)z[0]=n[0].scrCoords[1],z[1]=n[1].scrCoords[1],V[0]=n[0].scrCoords[2],V[1]=n[1].scrCoords[2];else if((J=[B.Z.innerProduct(n[0].usrCoords.slice(1,3),this.line.stdform.slice(1,3))+this.line.stdform[0],B.Z.innerProduct(n[1].usrCoords.slice(1,3),this.line.stdform.slice(1,3))+this.line.stdform[0]])[0]<J[1]&&(n.reverse(),J.reverse()),I){if(J[0]<0)return[];J[1]<0?(z[0]=n[0].scrCoords[1],V[0]=n[0].scrCoords[2],z[1]=o[1],V[1]=o[2]):(z[0]=n[0].scrCoords[1],V[0]=n[0].scrCoords[2],z[1]=n[1].scrCoords[1],V[1]=n[1].scrCoords[2])}else if(U){if(J[1]>0)return[];J[0]>0?(z[0]=o[1],V[0]=o[2],z[1]=n[1].scrCoords[1],V[1]=n[1].scrCoords[2]):(z[0]=n[0].scrCoords[1],V[0]=n[0].scrCoords[2],z[1]=n[1].scrCoords[1],V[1]=n[1].scrCoords[2])}}else b=a.Z.evaluate(this.visProp.face)===">"?Math.PI/4:a.Z.evaluate(this.visProp.face)==="<"?-Math.PI/4:0,p=Math.cos(b)*h-Math.sin(b)*l,d=Math.sin(b)*h+Math.cos(b)*l,z[0]=o[1]+p*I,V[0]=o[2]-d*I,z[1]=o[1],V[1]=o[2],b=-b,p=Math.cos(b)*h-Math.sin(b)*l,d=Math.sin(b)*h+Math.cos(b)*l,z[2]=o[1]-p*U,V[2]=o[2]+d*U;if(this._isInsideCanvas(z,V))return[z,V,e]}return[]},formatLabelText:function(t){var e,o,s=a.Z.evaluate(this.visProp.scalesymbol);return a.Z.isNumber(t)?(((e=(Math.round(1e11*t)/1e11).toString()).length>a.Z.evaluate(this.visProp.maxlabellength)||e.indexOf("e")!==-1)&&(o=a.Z.evaluate(this.visProp.digits),a.Z.evaluate(this.visProp.precision)!==3&&o===3&&(o=a.Z.evaluate(this.visProp.precision)),e=t.toExponential(o).toString()),a.Z.evaluate(this.visProp.beautifulscientificticklabels)&&(e=this.beautifyScientificNotationLabel(e)),e.indexOf(".")>-1&&e.indexOf("e")===-1&&(e=(e=e.replace(/0+$/,"")).replace(/\.$/,""))):e=t.toString(),s.length>0&&(e==="1"?e=s:e==="-1"?e="-"+s:e!=="0"&&(e+=s)),a.Z.evaluate(this.visProp.useunicodeminus)&&(e=e.replace(/-/g,"")),e},beautifyScientificNotationLabel:function(t){return t.indexOf("e")===-1?t:(parseFloat(t.substring(0,t.indexOf("e")))+t.substring(t.indexOf("e"))).replace(/e(.*)$/g,function(e,o){var s="10";return s+=o.replace(/-/g,"").replace(/\+/g,"").replace(/0/g,"").replace(/1/g,"").replace(/2/g,"").replace(/3/g,"").replace(/4/g,"").replace(/5/g,"").replace(/6/g,"").replace(/7/g,"").replace(/8/g,"").replace(/9/g,"")})},generateLabelText:function(t,e,o){var s;if(!a.Z.exists(o)){if(s=this.getDistanceFromZero(e,t),Math.abs(s)<B.Z.eps)return"0";o=s/a.Z.evaluate(this.visProp.scale)}return this.formatLabelText(o)},generateLabelData:function(t,e,o){var s,n,h,l;return l=a.Z.evaluate(this.visProp.label.fontsize),s=[e.scrCoords[1],e.scrCoords[1]],n=[e.scrCoords[2],e.scrCoords[2]],h=l===void 0?12:l,h*=.5,this._isInsideCanvas(s,n,h)?(s=a.Z.evaluate(this.visProp.label.offset[0]),n=a.Z.evaluate(this.visProp.label.offset[1]),{x:e.usrCoords[1]+s/this.board.unitX,y:e.usrCoords[2]+n/this.board.unitY,t,i:o}):null},update:function(){return this.needsUpdate&&this.board.canvasWidth!==0&&this.board.canvasHeight!==0&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate?(this.visPropCalc.visible&&this.board.renderer.updateTicks(this),this.updateRendererLabels(),this.setDisplayRendNode(),this.needsUpdate=!1,this):this},updateRendererLabels:function(){var t,e,o,s,n,h,l,p;for(o=this.labelsData.length,s=this.labels.length,t=0,e=0;t<o;t++)this.labelsData[t]!==null&&(l=this.labelsData[t],e<s?((h=this.labels[e]).setText(l.t),h.setCoords(l.x,l.y),e++):(this.labelCounter+=1,n={isLabel:!0,layer:this.board.options.layer.line,highlightStrokeColor:this.board.options.text.strokeColor,highlightStrokeWidth:this.board.options.text.strokeWidth,highlightStrokeOpacity:this.board.options.text.strokeOpacity,priv:this.visProp.priv},(n=a.Z.deepCopy(n,this.visProp.label)).id=this.id+l.i+"Label"+this.labelCounter,h=u.Z.createText(this.board,[l.x,l.y,l.t],n),this.addChild(h),h.setParents(this),h.isDraggable=!1,h.dump=!1,this.labels.push(h)),(p=a.Z.evaluate(this.visProp.label.visible))==="inherit"&&(p=this.visPropCalc.visible),h.prepareUpdate().updateVisibility(p).updateRenderer(),h.distanceX=a.Z.evaluate(this.visProp.label.offset[0]),h.distanceY=a.Z.evaluate(this.visProp.label.offset[1]));for(e=o=e;e<s;e++)this.board.renderer.display(this.labels[e],!1),this.labels[e].visProp.visible=this.labels[e].visPropCalc.visible=!1;return this},hideElement:function(){var t;for(u.Z.deprecated("Element.hideElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!1,this.board.renderer.display(this,!1),t=0;t<this.labels.length;t++)a.Z.exists(this.labels[t])&&this.labels[t].hideElement();return this},showElement:function(){var t;for(u.Z.deprecated("Element.showElement()","Element.setDisplayRendNode()"),this.visPropCalc.visible=!0,this.board.renderer.display(this,!1),t=0;t<this.labels.length;t++)a.Z.exists(this.labels[t])&&this.labels[t].showElement();return this}}),u.Z.createTicks=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"ticks");if(n=e.length<2?h.ticksdistance:e[1],e[0].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[0].elementClass!==S.Z.OBJECT_CLASS_CURVE)throw new Error("JSXGraph: Can't create Ticks with parent types '"+typeof e[0]+"'.");return s=new u.Z.Ticks(e[0],n,h),a.Z.isFunction(h.generatelabelvalue)&&(s.generateLabelText=h.generatelabelvalue),a.Z.isFunction(h.generatelabeltext)&&(s.generateLabelText=h.generatelabeltext),s.setParents(e[0]),s.isDraggable=!0,s.fullUpdate(e[0].visPropCalc.visible),s},u.Z.createHatchmark=function(t,e,o){var s,n,h,l,p,d=[],b=a.Z.copyAttributes(o,t.options,"hatch");if(e[0].elementClass!==S.Z.OBJECT_CLASS_LINE&&e[0].elementClass!==S.Z.OBJECT_CLASS_CURVE||typeof e[1]!="number")throw new Error("JSXGraph: Can't create Hatch mark with parent types '"+typeof e[0]+"' and '"+typeof e[1]+" and ''"+typeof e[2]+"'.");for(h=.5*-(((s=e[1])-1)*(l=b.ticksdistance)),n=0;n<s;n++)d[n]=h+n*l;return(p=t.create("ticks",[e[0],d],b)).elType="hatch",e[0].inherits.push(p),p},u.Z.registerElement("ticks",u.Z.createTicks),u.Z.registerElement("hash",u.Z.createHatchmark),u.Z.registerElement("hatch",u.Z.createHatchmark),u.Z.Ticks,u.Z.CA=function(t,e,o){this.node=t,this.createNode=e,this.parser=o},u.Z.extend(u.Z.CA.prototype,{findMapNode:function(t,e){var o,s,n;if(e.value==="op_assign"&&e.children[0].value===t)return e.children[1];if(e.children){for(s=e.children.length,o=0;o<s;++o)if((n=this.findMapNode(t,e.children[o]))!==null)return n}return null},setMath:function(t){var e,o;if((t.type!="node_op"||t.value!="op_add"&&t.value!="op_sub"&&t.value!="op_mul"&&t.value!="op_div"&&t.value!="op_neg"&&t.value!="op_execfun"&&t.value!="op_exp")&&t.type!="node_var"&&t.type!="node_const"||(t.isMath=!0),t.children)for(o=t.children.length,e=0;e<o;++e)this.setMath(t.children[e])},deriveElementary:function(t,e){var o,s=t.children[0].value,n=t.children[1];switch(s){case"abs":o=this.createNode("node_op","op_div",n[0],this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0]))]));break;case"sqrt":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_mul",this.createNode("node_const",2),this.createNode(t.type,t.value,a.Z.deepCopy(t.children[0]),a.Z.deepCopy(t.children[1]))));break;case"sin":o=this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),a.Z.deepCopy(n));break;case"cos":o=this.createNode("node_op","op_neg",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),a.Z.deepCopy(n)));break;case"tan":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","cos"),a.Z.deepCopy(n)),this.createNode("node_const",2)));break;case"cot":o=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","sin"),a.Z.deepCopy(n)),this.createNode("node_const",2))));break;case"exp":o=this.createNode(t.type,t.value,a.Z.deepCopy(t.children[0]),a.Z.deepCopy(t.children[1]));break;case"pow":o=this.createNode("node_op","op_mul",this.createNode("node_op","op_execfun",a.Z.deepCopy(t.children[0]),a.Z.deepCopy(t.children[1])),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[1][0],e),this.createNode("node_op","op_div",a.Z.deepCopy(t.children[1][1]),a.Z.deepCopy(t.children[1][0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1][1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[a.Z.deepCopy(t.children[1][0])]))));break;case"log":case"ln":o=this.createNode("node_op","op_div",this.createNode("node_const",1),a.Z.deepCopy(n[0]));break;case"log2":case"lb":case"ld":o=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),a.Z.deepCopy(n[0])),this.createNode("node_const",1.4426950408889634));break;case"log10":case"lg":o=this.createNode("node_op","op_mul",this.createNode("node_op","op_div",this.createNode("node_const",1),a.Z.deepCopy(n[0])),this.createNode("node_const",.43429448190325176));break;case"asin":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0])))]));break;case"acos":o=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0])))])));break;case"atan":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0]))));break;case"acot":o=this.createNode("node_op","op_neg",this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_add",this.createNode("node_const",1),this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0])))));break;case"sinh":o=this.createNode("node_op","op_execfun",this.createNode("node_var","cosh"),[a.Z.deepCopy(n[0])]);break;case"cosh":o=this.createNode("node_op","op_execfun",this.createNode("node_var","sinh"),[a.Z.deepCopy(n[0])]);break;case"tanh":o=this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_exp",this.createNode("node_op","op_execfun",this.createNode("node_var","tanh"),[a.Z.deepCopy(n[0])]),this.createNode("node_const",2)));break;case"asinh":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_add",this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"acosh":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_execfun",this.createNode("node_var","sqrt"),[this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0])),this.createNode("node_const",1))]));break;case"atanh":o=this.createNode("node_op","op_div",this.createNode("node_const",1),this.createNode("node_op","op_sub",this.createNode("node_const",1),this.createNode("node_op","op_mul",a.Z.deepCopy(n[0]),a.Z.deepCopy(n[0]))));break;default:throw o=this.createNode("node_const",0),console.log('Derivative of "'+s+'" not yet implemented'),new Error("Error("+this.line+"): ")}return o},derivative:function(t,e){var o;switch(t.type){case"node_op":switch(t.value){case"op_execfun":o=t.children[0].value=="pow"?this.deriveElementary(t,e):t.children[1].length===0?this.createNode("node_const",0):this.createNode("node_op","op_mul",this.deriveElementary(t,e),this.derivative(t.children[1][0],e));break;case"op_div":o=this.createNode("node_op","op_div",this.createNode("node_op","op_sub",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),a.Z.deepCopy(t.children[1])),this.createNode("node_op","op_mul",a.Z.deepCopy(t.children[0]),this.derivative(t.children[1],e))),this.createNode("node_op","op_mul",a.Z.deepCopy(t.children[1]),a.Z.deepCopy(t.children[1])));break;case"op_mul":o=this.createNode("node_op","op_add",this.createNode("node_op","op_mul",a.Z.deepCopy(t.children[0]),this.derivative(t.children[1],e)),this.createNode("node_op","op_mul",this.derivative(t.children[0],e),a.Z.deepCopy(t.children[1])));break;case"op_neg":o=this.createNode("node_op","op_neg",this.derivative(t.children[0],e));break;case"op_add":case"op_sub":o=this.createNode("node_op",t.value,this.derivative(t.children[0],e),this.derivative(t.children[1],e));break;case"op_exp":o=this.createNode("node_op","op_mul",a.Z.deepCopy(t),this.createNode("node_op","op_add",this.createNode("node_op","op_mul",this.derivative(t.children[0],e),this.createNode("node_op","op_div",a.Z.deepCopy(t.children[1]),a.Z.deepCopy(t.children[0]))),this.createNode("node_op","op_mul",this.derivative(t.children[1],e),this.createNode("node_op","op_execfun",this.createNode("node_var","log"),[a.Z.deepCopy(t.children[0])]))))}break;case"node_var":o=t.value===e?this.createNode("node_const",1):this.createNode("node_const",0);break;case"node_const":o=this.createNode("node_const",0)}return o},expandDerivatives:function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x;if(!t)return 0;for(this.line=t.line,this.col=t.col,s=t.children.length,n=0;n<s;++n)if(t.children[n]&&t.children[n].type)t.children[n]=this.expandDerivatives(t.children[n],t,o);else if(a.Z.isArray(t.children[n]))for(h=0;h<t.children[n].length;++h)t.children[n][h]&&t.children[n][h].type&&(t.children[n][h]=this.expandDerivatives(t.children[n][h],t,o));if(t.type==="node_op"&&t.value==="op_execfun"&&t.children[0]&&t.children[0].value==="D"){if(t.children[1][0].type=="node_var"?(Z=t.children[1][0].value,O=(l=this.findMapNode(Z,o)).children[0],y=t.children[1].length>=2?t.children[1][1].value:l.children[0][0],p=l.children[1]):(p=t.children[1][0],O=["x"],y=t.children[1].length>=2?t.children[1][1].value:"x"),b=p,(x=t.children[1].length>=3?t.children[1][2].value:1)>=1)for(;x>=1;)b=this.derivative(b,y),b=this.removeTrivialNodes(b),x--;d=e.type=="node_op"&&e.value=="op_assign"?this.createNode("node_op","op_map",O,b):b,this.setMath(d),t.type=d.type,t.value=d.value,t.children[0]=d.children[0],t.children[1]=d.children[1]}return t},removeTrivialNodes:function(t){var e,o,s,n,h;if(a.Z.isArray(t))for(o=t.length,e=0;e<o;++e)t[e]=this.removeTrivialNodes(t[e]);if(t.type!="node_op"||!t.children)return t;for(o=t.children.length,e=0;e<o;++e){this.mayNotBeSimplified=!1;do t.children[e]=this.removeTrivialNodes(t.children[e]);while(this.mayNotBeSimplified)}switch(t.value){case"op_map":if(s=t.children[0],(n=t.children[1]).type=="node_var"){for(e=0;e<s.length;++e)if(s[e]==n.value){n.isMath=!0;break}}break;case"op_add":if(s=t.children[0],n=t.children[1],s.type=="node_const"&&s.value===0)return n;if(n.type=="node_const"&&n.value===0)return s;if(s.type=="node_const"&&n.type=="node_const")return s.value+=n.value,s;break;case"op_mul":if(s=t.children[0],n=t.children[1],s.type=="node_const"&&s.value==1)return n;if(n.type=="node_const"&&n.value==1||s.type=="node_const"&&s.value===0)return s;if(n.type=="node_const"&&n.value===0||n.type=="node_const"&&n.value===0)return n;if(s.type=="node_op"&&s.value=="op_neg"&&n.type=="node_op"&&n.value=="op_neg")return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if(s.value=="op_neg"&&n.value!="op_neg")return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s.children[0],n)],this.mayNotBeSimplified=!0,t;if(s.value!="op_neg"&&n.value=="op_neg")return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_mul",s,n.children[0])],this.mayNotBeSimplified=!0,t;if(s.value=="op_div"&&s.children[0].type=="node_const"&&s.children[0].value==1)return t.type="node_op",t.value="op_div",t.children=[n,s.children[1]],this.mayNotBeSimplified=!0,t;if(n.value=="op_div"&&n.children[0].type=="node_const"&&n.children[0].value==1)return t.type="node_op",t.value="op_div",t.children=[s,n.children[1]],this.mayNotBeSimplified=!0,t;if(s.type!="node_const"&&n.type=="node_const")return t.children=[n,s],this.mayNotBeSimplified=!0,t;if(s.type!="node_const"&&n.type=="node_op"&&n.value=="op_neg"&&n.children[0].type=="node_const")return t.children=[n,s],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value!="op_execfun"&&(n.type=="node_var"||n.type=="node_op"&&n.value=="op_execfun"))return t.children=[n,s],this.mayNotBeSimplified=!0,t;if(s.type!="node_op"&&n.type=="node_op"&&n.value=="op_neg"&&n.children[0].type=="node_var")return t.children=[n,s],this.mayNotBeSimplified=!0,t;if(s.type!="node_const"&&n.type=="node_op"&&(n.value=="op_mul"||n.value=="op_div")&&n.children[0].type=="node_const")return h=n.children[0],n.children[0]=s,t.children=[h,n],this.mayNotBeSimplified=!0,t;if(n.type!="node_const"&&s.type=="node_op"&&s.value=="op_mul"&&s.children[0].type=="node_const")return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],this.mayNotBeSimplified=!0,t;if(s.type=="node_const"&&n.type=="node_const")return s.value*=n.value,s;if(s.type=="node_const"&&n.type=="node_op"&&(n.value=="op_mul"||n.value=="op_div")&&n.children[0].type=="node_const")return n.children[0].value*=s.value,n;if(s.hash=this.parser.compile(s),n.hash=this.parser.compile(n),s.hash===n.hash)return t.value="op_exp",t.children[1]=this.createNode("node_const",2),t;if(s.type=="node_const"&&n.type=="node_op"&&(n.value=="op_mul"||n.value=="op_div")&&n.children[0].type=="node_const")return n.children[0].value*=s.value,n;if(n.type=="node_op"&&n.value=="op_exp"&&(s.hash||(s.hash=this.parser.compile(s)),n.children[0].hash||(n.children[0].hash=this.parser.compile(n.children[0])),s.hash===n.children[0].hash))return n.children[1]=this.createNode("node_op","op_add",n.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,n;if(s.type=="node_op"&&s.value=="op_exp"&&n.type=="node_op"&&n.value=="op_exp"&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_add",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_sub":if(s=t.children[0],n=t.children[1],s.type=="node_const"&&s.value===0)return t.value="op_neg",t.children[0]=n,t;if(n.type=="node_const"&&n.value===0)return s;if(s.type=="node_const"&&n.type=="node_const"&&s.value==n.value)return this.createNode("node_const",0);if(s.type=="node_var"&&n.type=="node_var"&&s.value==n.value)return this.createNode("node_const",0);if(s.type=="node_const"&&n.type=="node_const")return s.value-=n.value,s;if(s.type=="node_op"&&s.value=="op_mul"&&n.type=="node_op"&&n.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if(n.type=="node_op"&&n.value=="op_mul"&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_sub",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_neg":if((s=t.children[0]).type=="node_const"&&s.value===0)return s;if(s.type=="node_op"&&s.value=="op_neg")return s.children[0];break;case"op_div":if(s=t.children[0],n=t.children[1],s.type=="node_const"&&n.type=="node_const"&&s.value==n.value&&s.value!==0)return s.value=1,s;if(s.type=="node_const"&&s.value===0&&n.type=="node_const"&&n.value!==0)return s.value=0,s;if(s.type=="node_const"&&s.value===0&&(n.type=="node_op"||n.type=="node_var"))return t.type="node_const",t.value=0,t;if(s.type=="node_var"&&n.type=="node_var"&&s.value==n.value)return this.createNode("node_const",1);if(s.type=="node_const"&&s.value!==0&&n.type=="node_const"&&n.value===0)return s.value>0?s.value=1/0:s.value=-1/0,s;if(s.type=="node_op"&&s.value=="op_neg"&&n.type=="node_op"&&n.value=="op_neg")return t.children=[s.children[0],n.children[0]],this.mayNotBeSimplified=!0,t;if(s.value=="op_neg"&&n.value!="op_neg")return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s.children[0],n)],this.mayNotBeSimplified=!0,t;if(s.value!="op_neg"&&n.value=="op_neg")return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_op","op_div",s,n.children[0])],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value=="op_exp"&&(n.hash||(n.hash=this.parser.compile(n)),s.children[0].hash||(s.children[0].hash=this.parser.compile(s.children[0])),n.hash===s.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],this.createNode("node_const",1)),this.mayNotBeSimplified=!0,s;if(n.type!="node_const"&&s.type=="node_op"&&s.value=="op_mul"&&s.children[0].type=="node_const")return t.value="op_mul",t.children=[s.children[0],this.createNode("node_op","op_div",s.children[1],n)],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value=="op_exp"&&n.type=="node_op"&&n.value=="op_exp"&&(s.children[0].hash=this.parser.compile(s.children[0]),n.children[0].hash=this.parser.compile(n.children[0]),s.children[0].hash===n.children[0].hash))return s.children[1]=this.createNode("node_op","op_sub",s.children[1],n.children[1]),this.mayNotBeSimplified=!0,s;break;case"op_exp":if(s=t.children[0],(n=t.children[1]).type=="node_const"&&n.value===0)return n.value=1,n;if(n.type=="node_const"&&n.value==1||s.type=="node_const"&&s.value==1||s.type=="node_const"&&s.value===0&&n.type=="node_const"&&n.value!==0)return s;if(s.type=="node_op"&&s.value=="op_exp")return t.children=[s.children[0],this.createNode("node_op","op_mul",s.children[1],n)],t}switch(t.value){case"op_add":if(s=t.children[0],n=t.children[1],s.type=="node_const"&&n.type=="node_const"&&s.value==n.value)return s.value+=n.value,s;if(s.type=="node_var"&&n.type=="node_var"&&s.value==n.value)return t.children[0]=this.createNode("node_const",2),t.value="op_mul",t;if(s.type=="node_op"&&s.value=="op_neg")return t.value="op_sub",t.children[0]=n,t.children[1]=s.children[0],this.mayNotBeSimplified=!0,t;if(n.type=="node_op"&&n.value=="op_neg")return t.value="op_sub",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value=="op_mul"&&n.type=="node_op"&&n.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),n.children[1].hash=this.parser.compile(n.children[1]),s.children[1].hash===n.children[1].hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],n.children[0]),s.children[1]],this.mayNotBeSimplified=!0,t;if(s.type=="node_op"&&s.value=="op_mul"&&(s.children[1].hash=this.parser.compile(s.children[1]),n.hash=this.parser.compile(n),s.children[1].hash===n.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",s.children[0],this.createNode("node_const",1)),n],this.mayNotBeSimplified=!0,t;if(n.type=="node_op"&&n.value=="op_mul"&&(n.children[1].hash=this.parser.compile(n.children[1]),s.hash=this.parser.compile(s),n.children[1].hash===s.hash))return t.value="op_mul",t.children=[this.createNode("node_op","op_add",this.createNode("node_const",1),n.children[0]),s],this.mayNotBeSimplified=!0,t;break;case"op_sub":if(s=t.children[0],(n=t.children[1]).type=="node_op"&&n.value=="op_neg")return t.value="op_add",t.children[1]=n.children[0],this.mayNotBeSimplified=!0,t;break;case"op_execfun":return this.simplifyElementary(t)}return t},simplifyElementary:function(t){var e=t.children[0].value,o=t.children[1];if(o.length==0)return t;switch(e){case"sin":case"tan":if(o[0].type=="node_const"&&o[0].value===0||o[0].type=="node_var"&&o[0].value=="PI"||o[0].type=="node_op"&&o[0].value=="op_mul"&&o[0].children[0].type=="node_const"&&o[0].children[0].value%1==0&&o[0].children[1].type=="node_var"&&o[0].children[1].value=="PI")return t.type="node_const",t.value=0,t;break;case"cos":if(o[0].type=="node_const"&&o[0].value===0)return t.type="node_const",t.value=1,t;if(o[0].type=="node_var"&&o[0].value=="PI")return t.type="node_op",t.value="op_neg",t.children=[this.createNode("node_const",1)],t;break;case"exp":if(o[0].type=="node_const"&&o[0].value===0)return t.type="node_const",t.value=1,t;break;case"pow":if(o[1].type=="node_const"&&o[1].value===0)return t.type="node_const",t.value=1,t}return t}}),u.Z.CA,u.Z.Dump={addMarkers:function(t,e,o){var s,n,h;for(s in a.Z.isArray(e)||(e=[e]),a.Z.isArray(o)||(o=[o]),n=Math.min(e.length,o.length),e.length=n,o.length=n,t.objects)if(t.objects.hasOwnProperty(s))for(h=0;h<n;h++)t.objects[s][e[h]]=o[h]},deleteMarkers:function(t,e){var o,s,n;for(o in a.Z.isArray(e)||(e=[e]),s=e.length,e.length=s,t.objects)if(t.objects.hasOwnProperty(o))for(n=0;n<s;n++)delete t.objects[o][e[n]]},str:function(t){return typeof t=="string"&&t.substr(0,7)!=="function"&&(t='"'+t+'"'),t},minimizeObject:function(t,e){var o,s,n,h={},l=a.Z.deepCopy(t),p=[];for(n=1;n<arguments.length;n++)p.push(arguments[n]);for(h=a.Z.deepCopy(h,u.Z.Options.elements,!0),n=p.length;n>0;n--)h=a.Z.deepCopy(h,p[n-1],!0);for(o in h)h.hasOwnProperty(o)&&(s=o.toLowerCase(),typeof h[o]!="object"&&h[o]===l[s]&&delete l[s]);return l},prepareAttributes:function(t,e){var o,s;for(s in o=this.minimizeObject(e.getAttributes(),u.Z.Options[e.elType]),e.subs)e.subs.hasOwnProperty(s)&&(o[s]=this.minimizeObject(e.subs[s].getAttributes(),u.Z.Options[e.elType][s],u.Z.Options[e.subs[s].elType]),o[s].id=e.subs[s].id,o[s].name=e.subs[s].name);return o.id=e.id,o.name=e.name,o},setBoundingBox:function(t,e,o){return t.push({obj:o,method:"setBoundingBox",params:[e.getBoundingBox(),e.keepaspectratio]}),t},dump:function(t){var e,o,s,n,h=[],l=[],p=t.objectsList.length;for(this.addMarkers(t,"dumped",!1),e=0;e<p;e++)if(s={},!(o=t.objectsList[e]).dumped&&o.dump){for(s.type=o.getType(),s.parents=o.getParents().slice(),s.type==="point"&&s.parents[0]===1&&(s.parents=s.parents.slice(1)),n=0;n<s.parents.length;n++)a.Z.isString(s.parents[n])&&s.parents[n][0]!=="'"&&s.parents[n][0]!=='"'?s.parents[n]='"'+s.parents[n]+'"':a.Z.isArray(s.parents[n])&&(s.parents[n]="["+s.parents[n].toString()+"]");s.attributes=this.prepareAttributes(t,o),s.type==="glider"&&o.onPolygon&&h.push({obj:o.id,prop:"onPolygon",val:!0}),l.push(s)}return this.deleteMarkers(t,"dumped"),{elements:l,props:h,methods:[]}},arrayToParamStr:function(t,e){var o,s=[];for(o=0;o<t.length;o++)s.push(e.call(this,t[o]));return s.join(", ")},toJCAN:function(t){var e,o,s;switch(typeof t){case"object":if(t){if(o=[],a.Z.isArray(t)){for(e=0;e<t.length;e++)o.push(this.toJCAN(t[e]));return"["+o.join(",")+"]"}for(s in t)t.hasOwnProperty(s)&&o.push(s+": "+this.toJCAN(t[s]));return"<<"+o.join(", ")+">> "}return"null";case"string":return"'"+t.replace(/\\/g,"\\\\").replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return t.toString();case"null":return"null"}},toJessie:function(t){var e,o,s,n=this.dump(t),h=[];for(n.methods=this.setBoundingBox(n.methods,t,"$board"),o=n.elements,e=0;e<o.length;e++)o[e].attributes.name.length>0&&h.push("// "+o[e].attributes.name),h.push("s"+e+" = "+o[e].type+"("+o[e].parents.join(", ")+") "+this.toJCAN(o[e].attributes).replace(/\n/,"\\n")+";"),o[e].type==="axis"&&(s=o[e].attributes.id,t.objects[s].defaultTicks===null&&h.push("s"+e+".removeAllTicks();")),h.push("");for(e=0;e<n.methods.length;e++)h.push(n.methods[e].obj+"."+n.methods[e].method+"("+this.arrayToParamStr(n.methods[e].params,this.toJCAN)+");"),h.push("");for(e=0;e<n.props.length;e++)h.push(n.props[e].obj+"."+n.props[e].prop+" = "+this.toJCAN(n.props[e].val)+";"),h.push("");return h.join(`
`)},toJavaScript:function(t){var e,o,s,n=this.dump(t),h=[];for(n.methods=this.setBoundingBox(n.methods,t,"board"),o=n.elements,e=0;e<o.length;e++)h.push('board.create("'+o[e].type+'", ['+o[e].parents.join(", ")+"], "+a.Z.toJSON(o[e].attributes)+");"),o[e].type==="axis"&&(s=o[e].attributes.id,t.objects[s].defaultTicks===null&&h.push('board.objects["'+s+'"].removeTicks(board.objects["'+s+'"].defaultTicks);'));for(e=0;e<n.methods.length;e++)h.push(n.methods[e].obj+"."+n.methods[e].method+"("+this.arrayToParamStr(n.methods[e].params,a.Z.toJSON)+");"),h.push("");for(e=0;e<n.props.length;e++)h.push(n.props[e].obj+"."+n.props[e].prop+" = "+a.Z.toJSON(n.props[e].val)+";"),h.push("");return h.join(`
`)}},u.Z.Dump,u.Z.createComb=function(t,e,o){var s,n,h,l,p;if(e.length!==2)throw p=e.map(function(d){return"'"+typeof d+"'"}),new Error("JSXGraph: Can't create comb with parent types "+p.join(", ")+`.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);if(a.Z.isArray(e[0])&&e[0].length>1)l=a.Z.copyAttributes(o,t.options,"comb","point1"),s=t.create("point",e[0],l);else if(a.Z.isString(e[0])||a.Z.isPoint(e[0]))s=t.select(e[0]);else if(a.Z.isFunction(e[0])&&a.Z.isPoint(e[0]()))s=e[0]();else{if(!(a.Z.isFunction(e[0])&&e[0]().length&&e[0]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);l=a.Z.copyAttributes(o,t.options,"comb","point1"),s=u.Z.createPoint(t,e[0](),l)}if(a.Z.isArray(e[1])&&e[1].length>1)l=a.Z.copyAttributes(o,t.options,"comb","point2"),n=t.create("point",e[1],l);else if(a.Z.isString(e[1])||a.Z.isPoint(e[1]))n=t.select(e[1]);else if(a.Z.isFunction(e[1])&&a.Z.isPoint(e[1]()))n=e[1]();else{if(!(a.Z.isFunction(e[1])&&e[1]().length&&e[1]().length>=2))throw new Error("JSXGraph: Can't create comb with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [point,point], [[x1,y1],[x2,y2]]`);l=a.Z.copyAttributes(o,t.options,"comb","point2"),n=u.Z.createPoint(t,e[1](),l)}return l=a.Z.copyAttributes(o,t.options,"comb"),a.Z.merge(l,a.Z.copyAttributes(o,t.options,"comb","curve")),(h=t.create("curve",[[0],[0]],l)).updateDataArray=function(){var d,b,Z,y,O,x,D,k,I,U,J=0,z=s.Dist(n),V=s,W=n;for(k=a.Z.evaluate(h.visProp.frequency),I=-a.Z.evaluate(h.visProp.angle),U=a.Z.evaluate(h.visProp.width),a.Z.evaluate(h.visProp.reverse)&&(V=n,W=s,I=-I),d=Math.cos(I),b=Math.sin(I),Z=(W.X()-V.X())/z,y=(W.Y()-V.Y())/z,d*=U/Math.abs(b),b*=U/Math.abs(b),this.dataX=[],this.dataY=[];J<z;)O=V.X()+Z*J,x=V.Y()+y*J,b*=D=Math.min(d,z-J)/Math.abs(d),d*=D,this.dataX.push(O),this.dataY.push(x),this.dataX.push(O+Z*d+y*b),this.dataY.push(x-Z*b+y*d),this.dataX.push(NaN),this.dataY.push(NaN),J+=k},h},u.Z.registerElement("comb",u.Z.createComb);var ye=function(){ge.prototype.remove.call(this),this.board.removeObject(this.toppoint),this.board.removeObject(this.glider),this.board.removeObject(this.baseline),this.board.removeObject(this.basepoint),this.board.removeObject(this.label),this._isPrivateTangent&&this.board.removeObject(this.tangent)},Pe=function(){return this.tangent.getSlope()};u.Z.createSlopeTriangle=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O=!1;if(e.length===1&&e[0].type===S.Z.OBJECT_TYPE_TANGENT)n=e[0],h=n.glider;else if(e.length===1&&e[0].type===S.Z.OBJECT_TYPE_GLIDER)h=e[0],y=a.Z.copyAttributes(o,t.options,"slopetriangle","tangent"),n=t.create("tangent",[h],y),O=!0;else{if(e.length!==2||e[0].elementClass!==S.Z.OBJECT_CLASS_LINE||!a.Z.isPoint(e[1]))throw new Error("JSXGraph: Can't create slope triangle with parent types '"+typeof e[0]+"'.");n=e[0],h=e[1]}return y=a.Z.copyAttributes(o,t.options,"slopetriangle","basepoint"),b=t.create("point",[function(){return[h.X()+1,h.Y()]}],y),y=a.Z.copyAttributes(o,t.options,"slopetriangle","baseline"),d=t.create("line",[h,b],y),y=a.Z.copyAttributes(o,t.options,"slopetriangle","glider"),l=t.create("glider",[h.X()+1,h.Y(),d],y),y=a.Z.copyAttributes(o,t.options,"slopetriangle","toppoint"),p=t.create("point",[function(){return[l.X(),l.Y()+(l.X()-h.X())*n.getSlope()]}],y),(y=a.Z.copyAttributes(o,t.options,"slopetriangle")).borders=a.Z.copyAttributes(y.borders,t.options,"slopetriangle","borders"),(s=t.create("polygon",[h,l,p],y)).Value=Pe,s.tangent=n,s._isPrivateTangent=O,s.borders[2].setArrow(!1,!1),y=a.Z.copyAttributes(o,t.options,"slopetriangle","label"),(Z=t.create("text",[function(){return l.X()+.1},function(){return .5*(l.Y()+p.Y())},function(){return""}],y))._setText(function(){return a.Z.toFixed(s.Value(),a.Z.evaluate(Z.visProp.digits))}),Z.fullUpdate(),s.glider=l,s.basepoint=b,s.baseline=d,s.toppoint=p,s.label=Z,s.subs={glider:l,basePoint:b,baseLine:d,topPoint:p,label:Z},s.inherits.push(l,b,d,p,Z),s.methodMap=u.Z.deepCopy(s.methodMap,{tangent:"tangent",glider:"glider",basepoint:"basepoint",baseline:"baseline",toppoint:"toppoint",label:"label",Value:"Value",V:"Value"}),s.remove=ye,s},u.Z.registerElement("slopetriangle",u.Z.createSlopeTriangle);var Ee=function(){this._value=this.rendNodeCheckbox.checked,this.board.update()};u.Z.createCheckbox=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"checkbox");return n=[e[0],e[1],'<span style="display:inline"><input type="checkbox" /><label for=""></label></span>'],(s=t.create("text",n,h)).type=a.Z.OBJECT_TYPE_CHECKBOX,s.rendNodeCheckbox=s.rendNode.childNodes[0].childNodes[0],s.rendNodeLabel=s.rendNode.childNodes[0].childNodes[1],s.rendNodeTag=s.rendNodeCheckbox,s.rendNodeTag.disabled=!!h.disabled,s.rendNodeCheckbox.id=s.rendNode.id+"_checkbox",s.rendNodeLabel.id=s.rendNode.id+"_label",s.rendNodeLabel.setAttribute("for",s.rendNodeCheckbox.id),s.setText(e[2]),s.visPropOld.fontsize="0px",t.renderer.updateTextStyle(s,!1),s.rendNodeCheckbox.checked=h.checked,s._value=h.checked,s.Value=function(){return this._value},s.update=function(){return this.needsUpdate&&(u.Z.Text.prototype.update.call(this),this._value=this.rendNodeCheckbox.checked),this},N.Z.addEvent(s.rendNodeCheckbox,"change",Ee,s),s},u.Z.registerElement("checkbox",u.Z.createCheckbox);var Re=function(t){this._value=this.rendNodeInput.value,this.board.update()};u.Z.createInput=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"input");return n=[e[0],e[1],'<span style="display:inline; white-space:nowrap; padding:0px;"><span></span><input type="text" maxlength="'+h.maxlength+'" style="width:100%"/></span>'],(s=t.create("text",n,h)).type=a.Z.OBJECT_TYPE_INPUT,s.rendNodeLabel=s.rendNode.childNodes[0].childNodes[0],s.rendNodeInput=s.rendNode.childNodes[0].childNodes[1],s.rendNodeInput.value=e[2],s.rendNodeTag=s.rendNodeInput,s.rendNodeTag.disabled=!!h.disabled,s.rendNodeLabel.id=s.rendNode.id+"_label",s.rendNodeInput.id=s.rendNode.id+"_input",s.setText(e[3]),s._value=e[2],s.update=function(){return this.needsUpdate&&(u.Z.Text.prototype.update.call(this),this._value=this.rendNodeInput.value),this},s.Value=function(){return this._value},s.set=function(l){return this._value=l,this.rendNodeInput.value=l,this},N.Z.addEvent(s.rendNodeInput,"input",Re,s),N.Z.addEvent(s.rendNodeInput,"mousedown",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),N.Z.addEvent(s.rendNodeInput,"touchstart",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),N.Z.addEvent(s.rendNodeInput,"pointerdown",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),s.visPropOld.fontsize="0px",t.renderer.updateTextStyle(s,!1),s},u.Z.registerElement("input",u.Z.createInput);var Ae=function(){this._handler&&this._handler(),this.board.update()};u.Z.createButton=function(t,e,o){var s,n,h=a.Z.copyAttributes(o,t.options,"button");return n=[e[0],e[1],'<button type="button" style="width:100%;"></button>'],(s=t.create("text",n,h)).type=a.Z.OBJECT_TYPE_BUTTON,s.rendNodeButton=s.rendNode.childNodes[0],s.rendNodeButton.id=s.rendNode.id+"_button",s.rendNodeTag=s.rendNodeButton,s.rendNodeTag.disabled=!!h.disabled,s.setText(e[2]),s.visPropOld.fontsize="0px",t.renderer.updateTextStyle(s,!1),e[3]&&(a.Z.isString(e[3])?(s._jc=new u.Z.JessieCode,s._jc.use(t),s._handler=function(){s._jc.parse(e[3])}):s._handler=e[3]),N.Z.addEvent(s.rendNodeButton,"click",Ae,s),N.Z.addEvent(s.rendNodeButton,"mousedown",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),N.Z.addEvent(s.rendNodeButton,"touchstart",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),N.Z.addEvent(s.rendNodeButton,"pointerdown",function(l){a.Z.exists(l.stopPropagation)&&l.stopPropagation()},s),s},u.Z.registerElement("button",u.Z.createButton),u.Z.ForeignObject=function(t,e,o,s,n){this.constructor(t,o,S.Z.OBJECT_TYPE_FOREIGNOBJECT,S.Z.OBJECT_CLASS_OTHER),this.element=this.board.select(o.anchor),this.coordsConstructor(e),this._useUserSize=!1,this.size=[1,1],a.Z.exists(n)&&n.length>0&&(this._useUserSize=!0,this.W=a.Z.createFunction(n[0],this.board,""),this.H=a.Z.createFunction(n[1],this.board,""),this.addParentsFromJCFunctions([this.W,this.H]),this.usrSize=[this.W(),this.H()]),this.content=s,this.elType="foreignobject",this.id=this.board.setId(this,"Im"),this.board.renderer.drawForeignObject(this),this.board.finalizeAdding(this),this.methodMap=u.Z.deepCopy(this.methodMap,{addTransformation:"addTransform",trans:"addTransform"})},u.Z.ForeignObject.prototype=new Gt.Z,a.Z.copyPrototypeMethods(u.Z.ForeignObject,oe.Z,"coordsConstructor"),u.Z.extend(u.Z.ForeignObject.prototype,{hasPoint:function(t,e){var o,s,n,h,l,p,d,b,Z,y=this.transformations.length;return a.Z.isObject(a.Z.evaluate(this.visProp.precision))?(h=this.board._inputDevice,l=a.Z.evaluate(this.visProp.precision[h])):l=this.board.options.precision.hasPoint,y===0?(o=t-this.coords.scrCoords[1],s=this.coords.scrCoords[2]-e,o>=-(n=l)&&o-this.size[0]<=n&&s>=-n&&s-this.size[1]<=n):(d=[(p=(p=new m.Z(S.Z.COORDS_BY_SCREEN,[t,e],this.board)).usrCoords)[0]-this.span[0][0],p[1]-this.span[0][1],p[2]-this.span[0][2]],0<=(b=(Z=B.Z.innerProduct)(d,this.span[1]))&&b<=Z(this.span[1],this.span[1])&&0<=(b=Z(d,this.span[2]))&&b<=Z(this.span[2],this.span[2]))},update:function(t){return this.needsUpdate?(this.updateCoords(t),this.updateSize(),this):this},updateRenderer:function(){return this.updateRendererGeneric("updateForeignObject")},updateSize:function(){var t=[0,0];return this._useUserSize?(this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)]):this.rendNode.hasChildNodes()&&(t=this.rendNode.childNodes[0].getBoundingClientRect(),this.size=[t.width,t.height]),this},updateSpan:function(){var t,e,o=this.transformations.length,s=[];if(o===0)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(s[0]=[this.Z(),this.X(),this.Y()],s[1]=[this.Z(),this.X()+this.W(),this.Y()],s[2]=[this.Z(),this.X(),this.Y()+this.H()],t=0;t<o;t++)for(e=0;e<3;e++)s[e]=B.Z.matVecMult(this.transformations[t].matrix,s[e]);for(e=0;e<3;e++)s[e][1]/=s[e][0],s[e][2]/=s[e][0],s[e][0]/=s[e][0];for(e=1;e<3;e++)s[e][0]-=s[0][0],s[e][1]-=s[0][1],s[e][2]-=s[0][2];this.span=s}return this},addTransform:function(t){var e;if(a.Z.isArray(t))for(e=0;e<t.length;e++)this.transformations.push(t[e]);else this.transformations.push(t);return this},getParents:function(){var t=[this.url,[this.Z(),this.X(),this.Y()],this.usrSize];return this.parents.length!==0&&(t=this.parents),t},setSize:function(t,e){return this.W=a.Z.createFunction(t,this.board,""),this.H=a.Z.createFunction(e,this.board,""),this._useUserSize=!0,this.addParentsFromJCFunctions([this.W,this.H]),this},W:function(){},H:function(){}}),u.Z.createForeignObject=function(t,e,o){var s,n,h=e[0],l=e[1],p=[];if(e.length>=2&&(p=e[2]),s=a.Z.copyAttributes(o,t.options,"foreignobject"),!(n=oe.Z.create(u.Z.ForeignObject,t,l,s,h,p)))throw new Error("JSXGraph: Can't create foreignObject with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [string, [x, y], [w, h]], [string, [x, y]], [element,transformation]`);return n},u.Z.registerElement("foreignobject",u.Z.createForeignObject),u.Z.registerElement("fo",u.Z.createForeignObject),u.Z.ForeignObject,u.Z.extend(it.Z,{axes3d:{axesPosition:"center",xAxis:{visible:!0,point2:{name:"x"}},yAxis:{visible:!0,point2:{name:"y"}},zAxis:{visible:!0,point2:{name:"z"}},xPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},yPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},zPlaneRear:{visible:!0,layer:0,mesh3d:{layer:1}},xPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},yPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},zPlaneFront:{visible:!1,layer:0,mesh3d:{layer:1}},xPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},xPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneRearZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},yPlaneFrontZAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneRearYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontXAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1},zPlaneFrontYAxis:{visible:"inherit",strokeColor:"#888888",strokeWidth:1}},axis3d:{highlight:!1,strokecolor:"black",strokeWidth:1,tabindex:null,point1:{visible:!1,name:""},point2:{visible:!1,name:"",label:{visible:!0}}},curve3d:{highlight:!1,tabindex:-1,strokeWidth:1,numberPointsHigh:200},mesh3d:{strokeWidth:1,strokeColor:"#9a9a9a",strokeOpacity:.6,highlight:!1,fillColor:"#9a9a9a",fillOpacity:.1,tabindex:null,visible:"inherit"},line3d:{strokeWidth:1,strokeColor:"black",fixed:!0,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",point:{visible:!1,name:""},point1:{visible:!1,name:""},point2:{visible:!1,name:""}},plane3d:{strokeWidth:0,strokeColor:"black",strokeOpacity:1,highlight:!1,tabindex:null,gradient:"linear",gradientSecondColor:"#ffffff",gradientAngle:Math.PI,fillColor:"#a7a7a7",fillOpacity:.6,point:{visible:!1,name:"",fixed:!0}},point3d:{infoboxDigits:"auto",strokeWidth:0,gradient:"radial",gradientSecondColor:"#555555",fillColor:"yellow",highlightStrokeColor:"#555555"},surface3d:{highlight:!1,tabindex:-1,strokeWidth:1,stepsU:30,stepsV:30},view3d:{needsRegularUpdate:!0}}),u.Z.Options,u.Z.View3D=function(t,e,o){this.constructor(t,o,S.Z.OBJECT_TYPE_VIEW3D,S.Z.OBJECT_CLASS_3D),this.objects={},this.objectsList=[],this.elementsByName={},this.defaultAxes=null,this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.llftCorner=e[0],this.size=e[1],this.bbox3D=e[2],this.r=-1,this.timeoutAzimuth=null,this.id=this.board.setId(this,"V"),this.board.finalizeAdding(this),this.elType="view3d",this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.View3D.prototype=new Gt.Z,u.Z.extend(u.Z.View3D.prototype,{create:function(t,e,o){var s=[];return t.indexOf("3d")>0&&s.push(this),this.board.create(t,s.concat(e),o)},select:function(t,e){var o,s,n,h,l=t;if(l===null)return l;if(a.Z.isString(l)&&l!=="")a.Z.exists(this.objects[l])?l=this.objects[l]:a.Z.exists(this.elementsByName[l])&&(l=this.elementsByName[l]);else if(!e&&(a.Z.isFunction(l)||a.Z.isObject(l)&&!a.Z.isFunction(l.setAttribute))){for(s={},h=(o=a.Z.filterElements(this.objectsList,l)).length,n=0;n<h;n++)s[o[n].id]=o[n];l=new Dt(s)}else a.Z.isObject(l)&&a.Z.exists(l.id)&&!a.Z.exists(this.objects[l.id])&&(l=null);return l},update:function(){var t,e,o,s,n;return a.Z.exists(this.el_slide)&&a.Z.exists(this.az_slide)&&this.needsUpdate?(t=this.el_slide.Value(),e=this.r,o=this.az_slide.Value(),s=e*Math.sin(t),n=[[1,0,0],[0,1,0],[0,0,1]],this.matrix3D=[[1,0,0,0],[0,1,0,0],[0,0,1,0]],this.matrix3D[1][1]=e*Math.cos(o),this.matrix3D[1][2]=-e*Math.sin(o),this.matrix3D[2][1]=s*Math.sin(o),this.matrix3D[2][2]=s*Math.cos(o),this.matrix3D[2][3]=Math.cos(t),n[1][1]=this.size[0]/(this.bbox3D[0][1]-this.bbox3D[0][0]),n[2][2]=this.size[1]/(this.bbox3D[1][1]-this.bbox3D[1][0]),n[1][0]=this.llftCorner[0]-n[1][1]*this.bbox3D[0][0],n[2][0]=this.llftCorner[1]-n[2][2]*this.bbox3D[1][0],this.matrix3D=B.Z.matMatMult(n,this.matrix3D),this):this},updateRenderer:function(){return this.needsUpdate=!1,this},project3DTo2D:function(t,e,o){var s;return s=arguments.length===3?[1,t,e,o]:t.length===3?[1].concat(t):t,B.Z.matVecMult(this.matrix3D,s)},project2DTo3DPlane:function(t,e,o){var s,n,h,l,p=e.slice(1),d=[1,0,0,0];o=o||[1,0,0,0],l=B.Z.norm(p,3),h=B.Z.innerProduct(o.slice(1),p,3)/l,(s=this.matrix3D.slice(0,3)).push([0].concat(p)),n=t.coords.usrCoords.concat([h]);try{s[2][3]===1&&(s[2][1]=s[2][2]=.001*B.Z.eps),d=B.Z.Numerics.Gauss(s,n)}catch{d=[0,NaN,NaN,NaN]}return d},project3DToCube:function(t){var e=this.bbox3D;return t[1]<e[0][0]&&(t[1]=e[0][0]),t[1]>e[0][1]&&(t[1]=e[0][1]),t[2]<e[1][0]&&(t[2]=e[1][0]),t[2]>e[1][1]&&(t[2]=e[1][1]),t[3]<e[2][0]&&(t[3]=e[2][0]),t[3]>e[2][1]&&(t[3]=e[2][1]),t},intersectionLineCube:function(t,e,o){var s,n,h,l;for(s=o,n=0;n<3;n++)e[n]!==0&&(h=(this.bbox3D[n][0]-t[n])/e[n],l=(this.bbox3D[n][1]-t[n])/e[n],s=o<0?Math.max(s,Math.min(h,l)):Math.min(s,Math.max(h,l)));return s},isInCube:function(t){return t[0]>this.bbox3D[0][0]-B.Z.eps&&t[0]<this.bbox3D[0][1]+B.Z.eps&&t[1]>this.bbox3D[1][0]-B.Z.eps&&t[1]<this.bbox3D[1][1]+B.Z.eps&&t[2]>this.bbox3D[2][0]-B.Z.eps&&t[2]<this.bbox3D[2][1]+B.Z.eps},intersectionPlanePlane:function(t,e,o){var s,n,h,l,p=[[],[]];return o=o||e.d,s=B.Z.Geometry.meet3Planes(t.normal,t.d,e.normal,o,B.Z.crossProduct(t.normal,e.normal),0),n=B.Z.Geometry.meetPlanePlane(t.vec1,t.vec2,e.vec1,e.vec2),h=this.intersectionLineCube(s,n,1/0),l=B.Z.axpy(h,n,s),this.isInCube(l)&&(p[0]=l),h=this.intersectionLineCube(s,n,-1/0),l=B.Z.axpy(h,n,s),this.isInCube(l)&&(p[1]=l),p},getMesh:function(t,e,o){var s,n,h,l,p,d,b,Z=[0,0,0],y=e[2],O=o[2],x=[],D=[];for(d=(a.Z.evaluate(e[1])-a.Z.evaluate(e[0]))/y,b=(a.Z.evaluate(o[1])-a.Z.evaluate(o[0]))/O,s=0;s<=y;s++){for(h=e[0]+d*s,n=0;n<=O;n++)l=o[0]+b*n,Z=a.Z.isFunction(t)?t(h,l):[t[0](h,l),t[1](h,l),t[2](h,l)],p=this.project3DTo2D(Z),x.push(p[1]),D.push(p[2]);x.push(NaN),D.push(NaN)}for(n=0;n<=O;n++){for(l=o[0]+b*n,s=0;s<=y;s++)h=e[0]+d*s,Z=a.Z.isFunction(t)?t(h,l):[t[0](h,l),t[1](h,l),t[2](h,l)],p=this.project3DTo2D(Z),x.push(p[1]),D.push(p[2]);x.push(NaN),D.push(NaN)}return[x,D]},animateAzimuth:function(){var t=this.az_slide._smin,e=this.az_slide._smax-t,o=this.az_slide.Value()+.1;this.az_slide.position=(o-t)/e,this.az_slide.position>1&&(this.az_slide.position=0),this.board.update(),this.timeoutAzimuth=setTimeout(function(){this.animateAzimuth()}.bind(this),200)},stopAzimuth:function(){clearTimeout(this.timeoutAzimuth),this.timeoutAzimuth=null}}),u.Z.createView3D=function(t,e,o){var s,n,h,l,p,d,b=e[0],Z=e[1];return n=a.Z.copyAttributes(o,t.options,"view3d"),(s=new u.Z.View3D(t,e,n)).defaultAxes=s.create("axes3d",e,o),h=b[0],l=b[1],p=Z[0],d=Z[1],s.az_slide=t.create("slider",[[h-1,l-2],[h+p+1,l-2],[0,1,2*Math.PI]],{style:6,name:"az",point1:{frozen:!0},point2:{frozen:!0}}),s.el_slide=t.create("slider",[[h-1,l],[h-1,l+d],[0,.3,Math.PI/2]],{style:6,name:"el",point1:{frozen:!0},point2:{frozen:!0}}),s.board.highlightInfobox=function(y,O,x){var D,k,I,U,J=x.board,z=null;for(k=0;k<x.parents.length&&!(z=J.objects[x.parents[k]]).is3D;k++);if(z){if(U=[1,0,0,z.coords[3]],I=s.project2DTo3DPlane(z.element2D,[1,0,0,1],U),!s.isInCube(I))return void s.board.highlightCustomInfobox("",z);(D=a.Z.evaluate(z.visProp.infoboxdigits))==="auto"?s.board.highlightCustomInfobox("("+a.Z.autoDigits(z.X())+" | "+a.Z.autoDigits(z.Y())+" | "+a.Z.autoDigits(z.Z())+")",z):s.board.highlightCustomInfobox("("+a.Z.toFixed(z.X(),D)+" | "+a.Z.toFixed(z.Y(),D)+" | "+a.Z.toFixed(z.Z(),D)+")",z)}else s.board.highlightCustomInfobox("("+y+", "+O+")",x)},s.board.update(),s},u.Z.registerElement("view3d",u.Z.createView3D),u.Z.View3D,u.Z.GeometryElement3D=function(t,e){this.elType=e,this.id=this.board.setId(this,e),this.view=t,this.element2D=null,this.is3D=!0,this.view.objects[this.id]=this,this.view.objectsList.push(this),this.name!==""&&(this.view.elementsByName[this.name]=this)},u.Z.GeometryElement3D,u.Z.createAxes3D=function(t,e,o){var s,n,h,l,p,d,b,Z,y,O,x,D,k,I,U,J,z,V=e[0],W=["x","y","z"],$="Axis",nt=["Rear","Front"],et=[0,0,0],lt=[0,0,0],ot={};if(a.Z.exists(V.bbox3D))for(s=0;s<W.length;s++)et[s]=V.bbox3D[s][0],lt[s]=V.bbox3D[s][1];else for(s=0;s<W.length;s++)et[s]=e[1][s],lt[s]=e[2][1];for(b=(d=a.Z.copyAttributes(o,t.options,"axes3d")).axesposition,s=0;s<W.length;s++)U=(Z=W[s])+$,b==="center"?(y=[0,0,0],(O=[0,0,0])[s]=lt[s],ot[U]=V.create("axis3d",[y,O],d[U.toLowerCase()])):(U+="Border",y=et.slice(),O=lt.slice(),s===2?(y[1]=lt[1],O[0]=et[0]):(y[s]=lt[s],O[2]=et[2]),O[s]=lt[s],d[U.toLowerCase()].lastArrow=!1,ot[U]=V.create("axis3d",[y,O],d[U.toLowerCase()]),z={visible:!0,minorTicks:0,tickEndings:[0,1],drawLabels:!1},s===2&&(z.tickEndings=[1,0]),ot[U+"Ticks"]=V.create("ticks",[ot[U],1],z));for(ot.O=V.create("intersection",[ot[W[0]+$],ot[W[1]+$]],{name:"",visible:!1,withLabel:!1}),s=0;s<W.length;s++)for(l=(s+1)%3,p=(s+2)%3,Z=W[s],n=0;n<nt.length;n++)(y=[0,0,0])[s]=n===0?et[s]:lt[s],D=[0,0,0],(x=[0,0,0])[l]=1,D[p]=1,k=[et[l],lt[l]],I=[et[p],lt[p]],U=Z+"Plane"+nt[n],d=a.Z.copyAttributes(o,t.options,"axes3d",U),ot[U]=V.create("plane3d",[y,x,D,k,I],d),ot[U].elType="axisplane3d";for(s=0;s<W.length;s++)for(Z=W[s],n=0;n<nt.length;n++)for(h=1;h<=2;h++)U=Z+"Plane"+nt[n]+W[l=(s+h)%3].toUpperCase()+"Axis",J=Z+"Plane"+nt[n],(y=[0,0,0])[s]=(O=[0,0,0])[s]=n===0?et[s]:lt[s],y[l]=et[l],O[l]=lt[l],d=a.Z.copyAttributes(o,t.options,"axes3d",U),ot[U]=V.create("axis3d",[y,O],d),ot[J].addChild(ot[U]),ot[J].element2D.inherits.push(ot[U]);return ot},u.Z.registerElement("axes3d",u.Z.createAxes3D),u.Z.createAxis3D=function(t,e,o){var s,n,h,l,p,d,b=e[0],Z=e[1],y=e[2];return s=a.Z.copyAttributes(o.point1,t.options,"axis3d","point1"),n=b.create("point",[(l=Z[0],p=Z[1],d=Z[2],function(){return b.project3DTo2D(l,p,d)[1]}),function(O,x,D){return function(){return b.project3DTo2D(O,x,D)[2]}}(Z[0],Z[1],Z[2])],s),s=a.Z.copyAttributes(o.point2,t.options,"axis3d","point2"),h=b.create("point",[function(O,x,D){return function(){return b.project3DTo2D(O,x,D)[1]}}(y[0],y[1],y[2]),function(O,x,D){return function(){return b.project3DTo2D(O,x,D)[2]}}(y[0],y[1],y[2])],s),s=a.Z.copyAttributes(o,t.options,"axis3d"),b.create("arrow",[n,h],s)},u.Z.registerElement("axis3d",u.Z.createAxis3D),u.Z.createMesh3D=function(t,e,o){var s,n=e[0],h=e[1],l=e[2],p=e[3],d=e[4],b=e[5];return(s=n.create("curve",[[],[]],o)).updateDataArray=function(){var Z,y,O,x,D=p[0],k=p[1],I=b[0],U=b[1],J=[0,0,0],z=[0,0,0],V=[0,0,0];if(this.dataX=[],this.dataY=[],a.Z.isFunction(h))V=h().slice(1);else for(x=0;x<3;x++)V[x]=a.Z.evaluate(h[x]);for(x=0;x<3;x++)J[x]=a.Z.evaluate(l[x]),z[x]=a.Z.evaluate(d[x]);for(Z=u.Z.Math.norm(J,3),y=u.Z.Math.norm(z,3),x=0;x<3;x++)J[x]/=Z,z[x]/=y;O=n.getMesh([function(W,$){return V[0]+W*J[0]+$*z[0]},function(W,$){return V[1]+W*J[1]+$*z[1]},function(W,$){return V[2]+W*J[2]+$*z[2]}],[Math.ceil(D),Math.floor(k),(Math.ceil(k)-Math.floor(D))/1],[Math.ceil(I),Math.floor(U),(Math.ceil(U)-Math.floor(I))/1]),this.dataX=O[0],this.dataY=O[1]},s},u.Z.registerElement("mesh3d",u.Z.createMesh3D),u.Z.Point3D=function(t,e,o,s){this.constructor(t.board,s,S.Z.OBJECT_TYPE_POINT3D,S.Z.OBJECT_CLASS_3D),this.constructor3D(t,"point3d"),this.id=this.view.board.setId(this,"P3D"),this.board.finalizeAdding(this),this.coords=[0,0,0,0],this.F=e,this.slide=o,this.X=function(){return this.coords[1]},this.Y=function(){return this.coords[2]},this.Z=function(){return this.coords[3]},this._params=null,this._c2d=null,this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.Point3D.prototype=new u.Z.GeometryElement,a.Z.copyPrototypeMethods(u.Z.Point3D,u.Z.GeometryElement3D,"constructor3D"),u.Z.extend(u.Z.Point3D.prototype,{updateCoords:function(){var t;if(a.Z.isFunction(this.F))this.coords=[1].concat(a.Z.evaluate(this.F));else for(this.coords[0]=1,t=0;t<3;t++)a.Z.isFunction(this.F[t])&&(this.coords[t+1]=a.Z.evaluate(this.F[t]));return this},initCoords:function(){var t;if(a.Z.isFunction(this.F))this.coords=[1].concat(a.Z.evaluate(this.F));else for(this.coords[0]=1,t=0;t<3;t++)this.coords[t+1]=a.Z.evaluate(this.F[t]);return this},normalizeCoords:function(){return Math.abs(this.coords[0])>B.Z.eps&&(this.coords[1]/=this.coords[0],this.coords[2]/=this.coords[0],this.coords[3]/=this.coords[0],this.coords[0]=1),this},setPosition:function(t,e){var o=this.coords;return this.coords.slice(),t.length===3?(o[0]=1,o[1]=t[0],o[2]=t[1],o[3]=t[2]):(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[2],this.normalizeCoords()),this},update:function(t){var e,o;return this.element2D.draggable()&&_.Z.distance(this._c2d,this.element2D.coords.usrCoords)!==0?this.slide?this.projectCoords2Surface():(o=[1,0,0,this.coords[3]],(e=this.view.project2DTo3DPlane(this.element2D,[1,0,0,1],o))[0]!==0&&(this.coords=this.view.project3DToCube(e))):(this.updateCoords(),this.element2D.coords.setCoordinates(S.Z.COORDS_BY_USER,this.view.project3DTo2D([1,this.X(),this.Y(),this.Z()]))),this._c2d=this.element2D.coords.usrCoords.slice(),this},updateRenderer:function(){return this.needsUpdate=!1,this},projectCoords2Surface:function(){var t,e,o,s=[0,0],n=this.slide,h=this;n!==null&&(o=function(l,p,d,b){var Z=[1,n.X(d[0],d[1]),n.Y(d[0],d[1]),n.Z(d[0],d[1])],y=h.view.project3DTo2D(Z);return b[0]=h.element2D.X()-y[1],b[1]=h.element2D.Y()-y[2],b[0]*b[0]+b[1]*b[1]},a.Z.exists(this._params)&&(s=this._params.slice()),B.Z.Nlp.FindMinimum(o,2,2,s,5,1e-6,0,200),t=[1,n.X(s[0],s[1]),n.Y(s[0],s[1]),n.Z(s[0],s[1])],e=this.view.project3DTo2D(t),this._params=s,this.coords=t,this.element2D.coords.setCoordinates(S.Z.COORDS_BY_USER,e),this._c2d=e)},__evt__update3D:function(t){}}),u.Z.createPoint3D=function(t,e,o){var s,n,h,l,p,d=e[0];if(h=e.length>2&&a.Z.exists(e[e.length-1].is3D)?e.pop():null,e.length===2)n=e[1];else{if(e.length!==4)throw new Error("JSXGraph: Can't create point3d with parent types '"+typeof e[0]+"' and '"+typeof e[1]+`'.
Possible parent types: [[x,y,z]], [x,y,z]`);n=e.slice(1)}return s=a.Z.copyAttributes(o,t.options,"point3d"),(p=new u.Z.Point3D(d,n,h,s)).initCoords(),l=d.project3DTo2D(p.coords),s.name=p.name,p.element2D=d.create("point",l,s),p.addChild(p.element2D),p.inherits.push(p.element2D),p.element2D.setParents(p),p._c2d=p.element2D.coords.usrCoords.slice(),p},u.Z.registerElement("point3d",u.Z.createPoint3D),u.Z.Curve3D=function(t,e,o,s,n,h,l){this.constructor(t.board,l,S.Z.OBJECT_TYPE_CURVE3D,S.Z.OBJECT_CLASS_3D),this.constructor3D(t,"surface3d"),this.id=this.view.board.setId(this,"S3D"),this.board.finalizeAdding(this),this.F=e,this.X=o,this.Y=s,this.Z=n,this.F!==null&&(this.X=function(p){return this.F(p)[0]},this.Y=function(p){return this.F(p)[1]},this.Z=function(p){return this.F(p)[2]}),this.range=h,this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.Curve3D.prototype=new u.Z.GeometryElement,a.Z.copyPrototypeMethods(u.Z.Curve3D,u.Z.GeometryElement3D,"constructor3D"),u.Z.extend(u.Z.Curve3D.prototype,{updateDataArray:function(){var t,e,o,s,n,h,l,p,d=a.Z.evaluate(this.visProp.numberpointshigh),b=[0,0,0];if(l=[],p=[],a.Z.isArray(this.X))for(d=this.X.length,h=0;h<d;h++)b=[this.X[h],this.Y[h],this.Z[h]],n=this.view.project3DTo2D(b),l.push(n[1]),p.push(n[2]);else for(t=a.Z.evaluate(this.range),e=a.Z.evaluate(t[0]),s=((o=a.Z.evaluate(t[1]))-e)/(d-1),h=e;h<=o;h+=s)b=this.F!==null?this.F(h):[this.X(h),this.Y(h),this.Z(h)],n=this.view.project3DTo2D(b),l.push(n[1]),p.push(n[2]);return{X:l,Y:p}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),u.Z.createCurve3D=function(t,e,o){var s,n,h,l,p,d,b,Z=e[0];return e.length===3?(s=e[1],p=e[2],n=null,h=null,l=null):(n=e[1],h=e[2],l=e[3],p=e[4],s=null),d=a.Z.copyAttributes(o,t.options,"curve3d"),(b=new u.Z.Curve3D(Z,s,n,h,l,p,d)).element2D=t.create("curve",[[],[]],d),b.element2D.updateDataArray=function(){var y=b.updateDataArray();this.dataX=y.X,this.dataY=y.Y},b.addChild(b.element2D),b.inherits.push(b.element2D),b.element2D.setParents(b),b.element2D.prepareUpdate().update(),t.isSuspendedUpdate||b.element2D.updateVisibility().updateRenderer(),b},u.Z.registerElement("curve3d",u.Z.createCurve3D),u.Z.Line3D=function(t,e,o,s,n){this.constructor(t.board,n,S.Z.OBJECT_TYPE_LINE3D,S.Z.OBJECT_CLASS_3D),this.constructor3D(t,"line3d"),this.id=this.view.board.setId(this,"L3D"),this.board.finalizeAdding(this),this.point=e,this.direction=o,this.range=s||[-1/0,1/0],this.point1=null,this.point2=null,this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.Line3D.prototype=new u.Z.GeometryElement,a.Z.copyPrototypeMethods(u.Z.Line3D,u.Z.GeometryElement3D,"constructor3D"),u.Z.extend(u.Z.Line3D.prototype,{getPointCoords:function(t){var e,o,s,n=[];if(e=[this.point.X(),this.point.Y(),this.point.Z()],a.Z.isFunction(this.direction))n=this.direction();else for(o=1;o<4;o++)n.push(a.Z.evaluate(this.direction[o]));return s=a.Z.evaluate(t),Math.abs(s)===1/0&&(t=this.view.intersectionLineCube(e,n,s)),[e[0]+n[0]*s,e[1]+n[1]*s,e[2]+n[2]*s]},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),u.Z.createLine3D=function(t,e,o){var s,n,h,l,p,d,b,Z,y=e[0];return s=a.Z.copyAttributes(o,t.options,"line3d"),a.Z.isPoint3D(e[2])||e.length===3&&(a.Z.isArray(e[2])||a.Z.isFunction(e[2]))?(d=a.Z.providePoints3D(y,[e[1]],o,"line3d",["point1"])[0],b=a.Z.providePoints3D(y,[e[2]],o,"line3d",["point2"])[0],l=function(){return[b.X()-d.X(),b.Y()-d.Y(),b.Z()-d.Z()]},p=[0,1],Z=new u.Z.Line3D(y,d,l,p,s)):(h=a.Z.providePoints3D(y,[e[1]],o,"line3d",["point"])[0],a.Z.isFunction(e[2])?l=e[2]:e[2].length===3?l=[1].concat(e[2]):e[2].length===4&&(l=e[2]),p=e[3],n=a.Z.providePoints3D(y,[[0,0,0],[0,0,0]],o,"line3d",["point1","point2"]),Z=new u.Z.Line3D(y,h,l,p,s),n[0].F=function(){return Z.getPointCoords(a.Z.evaluate(Z.range[0]))},n[0].prepareUpdate().update(),d=n[0],n[1].F=function(){return Z.getPointCoords(a.Z.evaluate(Z.range[1]))},n[1].prepareUpdate().update(),b=n[1]),Z.element2D=y.create("segment",[d.element2D,b.element2D],s),Z.addChild(Z.element2D),Z.inherits.push(Z.element2D),Z.element2D.setParents(Z),d.addChild(Z),b.addChild(Z),Z.point1=d,Z.point2=b,Z.update(),Z.element2D.prepareUpdate().update().updateRenderer(),Z},u.Z.registerElement("line3d",u.Z.createLine3D),u.Z.Plane3D=function(t,e,o,s,n,h,l){this.constructor(t.board,l,S.Z.OBJECT_TYPE_PLANE3D,S.Z.OBJECT_CLASS_3D),this.constructor3D(t,"plane3d"),this.id=this.view.board.setId(this,"PL3D"),this.board.finalizeAdding(this),this.point=e,this.direction1=o,this.direction2=n,this.range1=s||[-1/0,1/0],this.range2=h||[-1/0,1/0],this.vec1=[0,0,0],this.vec2=[0,0,0],this.grid=null,this.normal=[0,0,0],this.d=0,this.updateNormal(),this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.Plane3D.prototype=new u.Z.GeometryElement,a.Z.copyPrototypeMethods(u.Z.Plane3D,u.Z.GeometryElement3D,"constructor3D"),u.Z.extend(u.Z.Plane3D.prototype,{updateNormal:function(){var t,e;for(t=0;t<3;t++)this.vec1[t]=a.Z.evaluate(this.direction1[t]),this.vec2[t]=a.Z.evaluate(this.direction2[t]);if(this.normal=B.Z.crossProduct(this.vec1,this.vec2),e=B.Z.norm(this.normal),Math.abs(e)>B.Z.eps)for(t=0;t<3;t++)this.normal[t]/=e;return this.d=B.Z.innerProduct(this.point.coords.slice(1),this.normal,3),this},updateDataArray:function(){var t,e,o,s,n,h,l,p,d,b,Z,y,O,x,D=["xPlaneRear","yPlaneRear","zPlaneRear"],k=[],I=[0,0,0],U=[0,0,0],J=[0,0,0],z=[0,0,0],V=this.view;if(this.dataX=[],this.dataY=[],this.updateNormal(),this.elType!=="axisplane3d"&&V.defaultAxes&&a.Z.evaluate(this.range1[0])===-1/0&&a.Z.evaluate(this.range1[1])===1/0&&a.Z.evaluate(this.range2[0])===-1/0&&a.Z.evaluate(this.range2[1])===1/0){for(b=0;b<D.length;b++){if((z=V.intersectionPlanePlane(this,V.defaultAxes[D[b]]))[0].length===3&&z[1].length===3){for(d=0;d<k.length&&!(_.Z.distance(z[0],k[d][0],3)<B.Z.eps&&_.Z.distance(z[1],k[d][1],3)<B.Z.eps||_.Z.distance(z[0],k[d][1],3)<B.Z.eps&&_.Z.distance(z[1],k[d][0],3)<B.Z.eps);d++);d===k.length&&k.push(z.slice())}if((z=[0,0,0])[b]=V.bbox3D[b][1],p=B.Z.innerProduct(z,V.defaultAxes[D[b]].normal,3),(z=V.intersectionPlanePlane(this,V.defaultAxes[D[b]],p))[0].length===3&&z[1].length===3){for(d=0;d<k.length&&!(_.Z.distance(z[0],k[d][0],3)<B.Z.eps&&_.Z.distance(z[1],k[d][1],3)<B.Z.eps||_.Z.distance(z[0],k[d][1],3)<B.Z.eps&&_.Z.distance(z[1],k[d][0],3)<B.Z.eps);d++);d===k.length&&k.push(z.slice())}}O=0,d=0;do{for((z=k[O][d]).length===3&&(n=V.project3DTo2D(z),this.dataX.push(n[1]),this.dataY.push(n[2])),d=(d+1)%2,z=k[O][d],x=O,b=0;b<k.length;b++){if(b!==O&&_.Z.distance(z,k[b][0])<B.Z.eps){O=b,d=0;break}if(b!==O&&_.Z.distance(z,k[b][1])<B.Z.eps){O=b,d=1;break}}if(O===x){console.log("Error: update plane3d: did not find next",O);break}}while(O!==0);n=V.project3DTo2D(k[0][0]),this.dataX.push(n[1]),this.dataY.push(n[2])}else{for(t=a.Z.evaluate(this.range1[0]),e=a.Z.evaluate(this.range1[1]),o=a.Z.evaluate(this.range2[0]),s=a.Z.evaluate(this.range2[1]),J=this.point.coords.slice(1),I=this.vec1.slice(),U=this.vec2.slice(),h=B.Z.norm(I,3),l=B.Z.norm(U,3),d=0;d<3;d++)I[d]/=h,U[d]/=l;for(b=0;b<4;b++){switch(b){case 0:Z=t,y=o;break;case 1:Z=e,y=o;break;case 2:Z=e,y=s;break;case 3:Z=t,y=s}for(d=0;d<3;d++)z[d]=J[d]+Z*I[d]+y*U[d];n=V.project3DTo2D(z),this.dataX.push(n[1]),this.dataY.push(n[2])}this.dataX.push(this.dataX[0]),this.dataY.push(this.dataY[0])}return{X:this.dataX,Y:this.dataY}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),u.Z.createPlane3D=function(t,e,o){var s,n,h,l,p=e[0],d=e[2],b=e[3],Z=e[4]||[-1/0,1/0],y=e[5]||[-1/0,1/0];return n=a.Z.providePoints3D(p,[e[1]],o,"plane3d",["point"])[0],s=a.Z.copyAttributes(o,t.options,"plane3d"),h=new u.Z.Plane3D(p,n,d,Z,b,y,s),n.addChild(h),h.element2D=p.create("curve",[[],[]],s),h.element2D.updateDataArray=function(){var O=h.updateDataArray();this.dataX=O.X,this.dataY=O.Y},h.addChild(h.element2D),h.inherits.push(h.element2D),h.element2D.setParents(h),s=a.Z.copyAttributes(o.mesh3d,t.options,"mesh3d"),Math.abs(h.range1[0])!==1/0&&Math.abs(h.range1[1])!==1/0&&Math.abs(h.range2[0])!==1/0&&Math.abs(h.range2[1])!==1/0&&(l=p.create("mesh3d",[function(){return n.coords},d,Z,b,y],s),h.grid=l,h.addChild(l),h.inherits.push(l),l.setParents(h)),h.element2D.prepareUpdate().update(),t.isSuspendedUpdate||h.element2D.updateVisibility().updateRenderer(),h},u.Z.registerElement("plane3d",u.Z.createPlane3D),u.Z.Surface3D=function(t,e,o,s,n,h,l,p){this.constructor(t.board,p,S.Z.OBJECT_TYPE_SURFACE3D,S.Z.OBJECT_CLASS_3D),this.constructor3D(t,"surface3d"),this.id=this.view.board.setId(this,"S3D"),this.board.finalizeAdding(this),this.F=e,this.X=o,this.Y=s,this.Z=n,this.F!==null&&(this.X=function(d,b){return this.F(d,b)[0]},this.Y=function(d,b){return this.F(d,b)[1]},this.Z=function(d,b){return this.F(d,b)[2]}),this.range_u=h,this.range_v=l,this.methodMap=a.Z.deepCopy(this.methodMap,{})},u.Z.Surface3D.prototype=new u.Z.GeometryElement,a.Z.copyPrototypeMethods(u.Z.Surface3D,u.Z.GeometryElement3D,"constructor3D"),u.Z.extend(u.Z.Surface3D.prototype,{updateDataArray:function(){var t,e,o=a.Z.evaluate(this.visProp.stepsu),s=a.Z.evaluate(this.visProp.stepsv),n=a.Z.evaluate(this.range_u),h=a.Z.evaluate(this.range_v);return t=this.F!==null?this.F:[this.X,this.Y,this.Z],{X:(e=this.view.getMesh(t,n.concat([o]),h.concat([s])))[0],Y:e[1]}},update:function(){return this},updateRenderer:function(){return this.needsUpdate=!1,this}}),u.Z.createParametricSurface3D=function(t,e,o){var s,n,h,l,p,d,b,Z,y=e[0];return e.length===4?(s=e[1],p=e[2],d=e[3],n=null,h=null,l=null):(n=e[1],h=e[2],l=e[3],p=e[4],d=e[5],s=null),b=a.Z.copyAttributes(o,t.options,"surface3d"),(Z=new u.Z.Surface3D(y,s,n,h,l,p,d,b)).element2D=y.create("curve",[[],[]],b),Z.element2D.updateDataArray=function(){var O=Z.updateDataArray();this.dataX=O.X,this.dataY=O.Y},Z.addChild(Z.element2D),Z.inherits.push(Z.element2D),Z.element2D.setParents(Z),Z.element2D.prepareUpdate().update(),t.isSuspendedUpdate||Z.element2D.updateVisibility().updateRenderer(),Z},u.Z.registerElement("parametricsurface3d",u.Z.createParametricSurface3D),u.Z.createFunctiongraph3D=function(t,e,o){var s=e[0],n=e[1],h=e[2],l=e[3];return s.create("parametricsurface3d",[function(p,d){return p},function(p,d){return d},n,h,l],o)},u.Z.registerElement("functiongraph3d",u.Z.createFunctiongraph3D);const Oe=u.Z.COORDS_BY_SCREEN,De=u.Z.COORDS_BY_USER,Le=u.Z.Dump,ke=u.Z.JSXGraph,Be=u.Z.Math,Ie=u.Z.Options,Se=u.Z.boards,St=u.Z.elements,xt=u.Z.palette,Ge=u.Z.paletteWong,xe=u.Z.Board,Ht=u.Z.Chart,Ct=u.Z.Circle,Mt=u.Z.Complex,Ut=u.Z.Composition,Nt=u.Z.Coords,ct=u.Z.CoordsElement,Zt=u.Z.Curve,st=u.Z.GeometryElement,Ye=u.Z.Group,ze=u.Z.Image,He=u.Z.JessieCode,je=u.Z.Line,We=u.Z.Point,Qt=u.Z.Polygon,ue=u.Z.Text,we=u.Z.Ticks,Te=u.Z.Transformation,Ve=u.Z.Turtle,re=u.Z.View3D,Me=u.Z.LMS2rgb,de=u.Z.addEvent,ne=u.Z.autoDigits,Xe=u.Z.autoHighlight,be=u.Z.bind,ce=u.Z.capitalize,Ue=u.Z.clearVisPropOld,Ze=u.Z.clone,qe=u.Z.cloneAndCopy,fe=u.Z.cmpArrays,Fe=u.Z.coordsArrayToMatrix,ve=u.Z.copyAttributes,Qe=u.Z.createEvalFunction,ti=u.Z.createFunction,ei=u.Z.createHTMLSlider,ii=u.Z.debug,si=u.Z.debugInt,ri=u.Z.debugLine,oi=u.Z.debugWST,ni=u.Z.deepCopy,ai=u.Z.def,hi=u.Z.deprecated,li=u.Z.eliminateDuplicates,ci=u.Z.escapeHTML,ui=u.Z.evalSlider,di=u.Z.evaluate,pi=u.Z.filterElements,fi=u.Z.getBoardByContainerId,_i=u.Z.getCSSTransformMatrix,gi=u.Z.getCSSTransform,vi=u.Z.getDimensions,mi=u.Z.getOffset,bi=u.Z.getPosition,Zi=u.Z.getProp,Ci=u.Z.hex2rgb,yi=u.Z.hsv2rgb,Pi=u.Z.isAndroid,Ei=u.Z.isApple,Oi=u.Z.isArray,Si=u.Z.isInArray,xi=u.Z.isInObject,wi=u.Z.isMetroApp,Ti=u.Z.isMozilla,Mi=u.Z.isName,Ni=u.Z.isNode,Ri=u.Z.isNumber,Ai=u.Z.isObject,Di=u.Z.isPointType,Li=u.Z.isString,ki=u.Z.isTouchDevice,Bi=u.Z.isTransformationOrArray,Ii=u.Z.isWebWorker,Yi=u.Z.isWebkitAndroid,ji=u.Z.isWebkitApple,Xi=u.Z.keys,Ui=u.Z.merge,Fi=u.Z.normalizePointFace,Ji=u.Z.providePoints,Gi=u.Z.registerElement,zi=u.Z.registerReader,Hi=u.Z.removeAllEvents,Wi=u.Z.removeElementFromArray,Vi=u.Z.removeEvent,qi=u.Z.rgb2LMS,Ki=u.Z.rgb2bw,$i=u.Z.rgb2cb,Qi=u.Z.rgb2css,ts=u.Z.rgb2hex,es=u.Z.rgb2hsv,is=u.Z.rgbParser,ss=u.Z.rgba2rgbo,rs=u.Z.rgbo2rgba,os=u.Z.sanitizeHTML,ns=u.Z.shortcut,as=u.Z.str2Bool,hs=u.Z.supportsCanvas,ls=u.Z.supportsPointerEvents,cs=u.Z.supportsSVG,us=u.Z.supportsVML,ds=u.Z.swap,ps=u.Z.timedChunk,fs=u.Z.toFixed,_s=u.Z.toFullscreen,gs=u.Z.toJSON,vs=u.Z.trim,ms=u.Z.trimNumber,bs=u.Z.truncate,Zs=u.Z.unescapeHTML,Cs=u.Z.uniqueArray,ys=u.Z.useBlackWhiteOptions,Ps=u.Z.useStandardOptions,Es=u.Z.warn;N.Z.isBrowser?window.JXG=u.Z:N.Z.isWebWorker()&&(self.JXG=u.Z);const Os=u.Z})();var __webpack_exports__default=__webpack_exports__.ZP;const BoardContext=reactExports.createContext(),graph=M.memo(function u(N){let{name:S,id:a,SVs:X,children:B,actions:R,callAction:A}=useDoenetRenderer(N);const[E,c]=reactExports.useState(null),m=reactExports.useRef(null),v=reactExports.useRef(null),_=reactExports.useRef(null),f=reactExports.useRef(null),g=reactExports.useRef(!1),C=reactExports.useRef(!1),P=reactExports.useRef(!1);let w=reactExports.useRef(null),T=reactExports.useRef(null),L=X.showNavigation&&!X.fixAxes,Y=at=>{A({action:R.recordVisibilityChange,args:{isVisible:at}})};if(reactExports.useEffect(()=>{if(!X.haveGraphParent)return()=>{A({action:R.recordVisibilityChange,args:{isVisible:!1}})}},[]),reactExports.useEffect(()=>{if(X.haveGraphParent)return;let at=[X.xmin,X.ymax,X.xmax,X.ymin];v.current=at,__webpack_exports__default.Options.layer.numlayers=100,__webpack_exports__default.Options.navbar.highlightFillColor="var(--canvastext)",__webpack_exports__default.Options.navbar.strokeColor="var(--canvastext)";let tt=!1;Array.isArray(X.grid)&&(tt=!0,__webpack_exports__default.Options.grid.gridX=X.grid[0],__webpack_exports__default.Options.grid.gridY=X.grid[1]);let Q=window.JXG.JSXGraph.initBoard(a,{boundingbox:at,axis:!1,showCopyright:!1,showNavigation:!1,zoom:{wheel:!X.fixAxes},pan:{enabled:!X.fixAxes},grid:tt});Q.itemsRenderedLowQuality={},Q.on("boundingbox",()=>{if(!g.current){let dt=Q.getBoundingBox(),[ht,ut,_t,Dt]=dt,Bt=Math.abs(_t-ht),Xt=Math.abs(ut-Dt),$t=dt.map((se,ae)=>Math.abs(se-v.current[ae]));Math.max($t[0]/Bt,$t[1]/Xt,$t[2]/Bt,$t[3]/Xt)>1e-12&&(v.current=dt,A({action:R.changeAxisLimits,args:{xmin:ht,xmax:_t,ymin:Dt,ymax:ut}}))}}),c(Q),m.current={width:parseFloat(i(X.width)),aspectRatio:X.aspectRatio},X.displayXAxis&&H(Q),X.displayYAxis&&G(Q),C.current=!0,P.current=L;function it(dt){var ht;let ut=dt.target.id;if(ut==="")return!1;let _t=ut.replace(a+"_",""),Dt=Q.select(_t);(ht=Dt.triggerEventHandlers)==null||ht.call(Dt,["keyfocusout"],[dt])}Q.containerObj.addEventListener("focusout",it);function rt(dt){var ht;let ut=dt.target.id;if(ut==="")return!1;let _t=ut.replace(a+"_",""),Dt=Q.select(_t);(ht=Dt.triggerEventHandlers)==null||ht.call(Dt,["keydown"],[dt])}return Q.containerObj.addEventListener("keydown",rt),()=>{Q.off("boundingbox")}},[]),reactExports.useEffect(()=>{E&&L&&q()},[E]),X.haveGraphParent)return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("a",{name:a}),B]});const j={width:i(X.width),aspectRatio:String(X.aspectRatio),maxWidth:"100%"};let F={};if(X.hidden?j.display="none":X.displayMode==="inline"?F={display:"inline-block",verticalAlign:"middle"}:F={display:"flex",justifyContent:X.horizontalAlign},X.showBorder?j.border="2px solid var(--canvastext)":j.border="none",j.marginBottom="12px",j.marginTop="12px",j.backgroundColor="var(--canvas)",j.color="var(--canvastext)",!E)return jsxRuntimeExports.jsx(VisibilitySensor,{partialVisibility:!0,onChange:Y,children:jsxRuntimeExports.jsxs("div",{style:F,children:[jsxRuntimeExports.jsx("a",{name:a}),jsxRuntimeExports.jsx("div",{id:a,className:"jxgbox",style:j})]})});if(C.current)C.current=!1;else{Array.isArray(X.grid)?((__webpack_exports__default.Options.grid.gridX!==X.grid[0]||__webpack_exports__default.Options.grid.gridY!==X.grid[1])&&(__webpack_exports__default.Options.grid.gridX=X.grid[0],__webpack_exports__default.Options.grid.gridY=X.grid[1],E.grids.length>0&&(E.removeObject(E.grids[0]),E.grids=[])),E.grids.length===0&&E.create("grid",[],{gridX:X.grid[0],gridY:X.grid[1]})):E.grids.length>0&&(E.removeObject(E.grids[0]),E.grids=[]),X.grid==="dense"?(_.current&&(_.current.defaultTicks.setAttribute({majorHeight:-1}),_.current.defaultTicks.setAttribute({minorHeight:-1})),f.current&&(f.current.defaultTicks.setAttribute({majorHeight:-1}),f.current.defaultTicks.setAttribute({minorHeight:-1}))):X.grid==="medium"?(_.current&&(_.current.defaultTicks.setAttribute({majorHeight:-1}),_.current.defaultTicks.setAttribute({minorHeight:10})),f.current&&(f.current.defaultTicks.setAttribute({majorHeight:-1}),f.current.defaultTicks.setAttribute({minorHeight:10}))):(_.current&&(_.current.defaultTicks.setAttribute({majorHeight:12}),_.current.defaultTicks.setAttribute({minorHeight:10})),f.current&&(f.current.defaultTicks.setAttribute({majorHeight:12}),f.current.defaultTicks.setAttribute({minorHeight:10})));let at=X.displayXAxis?!_.current:!!_.current,tt=X.displayYAxis?!f.current:!!f.current;if(tt&&!at&&X.displayXAxis&&(E.removeObject(_.current),_.current=null),at&&!tt&&X.displayYAxis&&(E.removeObject(f.current),f.current=null),X.displayXAxis)if(_.current){let rt=!!X.xlabel;if(rt!==w.current&&(_.current.setAttribute({withlabel:rt}),w.current=rt),_.current.name=X.xlabel,_.current.defaultTicks.setAttribute({drawLabels:X.displayXAxisTickLabels}),_.current.hasLabel){let dt="rt",ht=[5,10],ut="right";X.xlabelPosition==="left"&&(dt="lft",ut="left",ht=[-5,10]),_.current.label.visProp.position=dt,_.current.label.visProp.anchorx=ut,_.current.label.visProp.offset=ht,_.current.label.needsUpdate=!0,_.current.label.fullUpdate()}}else H(E);else _.current&&(E.removeObject(_.current),_.current=null);if(X.displayYAxis)if(f.current){let rt=!!X.ylabel;if(rt!==T.current&&(f.current.setAttribute({withlabel:rt}),T.current=rt),f.current.name=X.ylabel,f.current.defaultTicks.setAttribute({drawLabels:X.displayYAxisTickLabels}),f.current.hasLabel){let dt="rt",ht=[-10,-5],ut="right";X.ylabelPosition==="bottom"&&(dt="lft",ht[1]=5),X.ylabelAlignment==="right"&&(ut="left",ht[0]=10),f.current.label.visProp.position=dt,f.current.label.visProp.offset=ht,f.current.label.visProp.anchorx=ut,f.current.label.needsUpdate=!0,f.current.label.fullUpdate()}}else G(E);else f.current&&(E.removeObject(f.current),f.current=null);L?P.current||(q(),P.current=!0):P.current&&(K(),P.current=!1);let Q={width:parseFloat(i(X.width)),aspectRatio:X.aspectRatio};(Q.width!==m.current.width||Q.aspectRatio!==m.current.aspectRatio)&&Number.isFinite(Q.width)&&Number.isFinite(Q.aspectRatio)&&(m.current=Q);let it=[X.xmin,X.ymax,X.xmax,X.ymin];it.some((rt,dt)=>rt!==v.current[dt])&&(g.current=!0,E.setBoundingBox(it),g.current=!1,E.fullUpdate(),E.updateQuality===E.BOARD_QUALITY_LOW&&(E.itemsRenderedLowQuality[a]=E),v.current=it)}return jsxRuntimeExports.jsx(VisibilitySensor,{partialVisibility:!0,onChange:Y,children:jsxRuntimeExports.jsxs("div",{style:F,children:[jsxRuntimeExports.jsx("a",{name:a}),jsxRuntimeExports.jsx("div",{id:a,className:"jxgbox",style:j}),jsxRuntimeExports.jsx(BoardContext.Provider,{value:E,children:B})]})});function G(at){let tt={highlight:!1,fixed:!0};if(X.ylabel){let Q="rt",it=[-10,-5],rt="right";X.ylabelPosition==="bottom"&&(Q="lft",it[1]=5),X.ylabelAlignment==="right"&&(rt="left",it[0]=10),tt.name=X.ylabel,tt.withLabel=!0,tt.label={position:Q,offset:it,anchorx:rt,strokeColor:"var(--canvastext)",highlight:!1},X.ylabelHasLatex&&(tt.label.useMathJax=!0)}if(T.current=!!X.ylabel,tt.strokeColor="var(--canvastext)",tt.highlight=!1,tt.ticks={ticksDistance:2,label:{offset:[12,-2],layer:2,strokeColor:"var(--canvastext)",highlightStrokeColor:"var(--canvastext)",highlightStrokeOpacity:1},strokeColor:"var(--canvastext)",strokeOpacity:.5,precision:4,drawLabels:X.displayYAxisTickLabels},X.yTickScaleFactor!==null){let Q=Context.fromAst(X.yTickScaleFactor),it=Q.evaluate_to_constant();if(it>0){let rt=Q.toString();tt.ticks.scale=it,tt.ticks.scaleSymbol=rt}}X.grid==="dense"?(tt.ticks.majorHeight=-1,tt.ticks.minorHeight=-1):X.grid==="medium"?(tt.ticks.majorHeight=-1,tt.ticks.minorHeight=10):(tt.ticks.majorHeight=12,tt.ticks.minorHeight=10),X.displayXAxis||(tt.ticks.drawZero=!0),at.suspendUpdate(),f.current=at.create("axis",[[0,0],[0,1]],tt),f.current.defaultTicks.ticksFunction=function(){var Q,it,rt;return it=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),rt=it.upper-it.lower,Q=Math.pow(10,Math.floor(Math.log(.2*rt)/Math.LN10)),rt<=6*Q&&(Q*=.5),Q},f.current.defaultTicks.generateEquidistantTicks=function(Q,it){var rt,dt=1e-6,ht,ut=this.equidistant?this.ticksFunction(1):this.ticksDelta,_t=4;if(this.visProp.minorticks=4,ht=this.getXandYdeltas(),ut*=this.visProp.scale,this.minTicksDistance>1e-6){ut=this.adjustTickDistance(ut,Q,ht);let Dt=10**Math.floor(Math.log10(ut))*this.visProp.scale;Math.abs(ut/Dt-2)<1e-14&&(_t=3,this.visProp.minorticks=3),ut/=_t+1}if(this.ticksDelta=ut,!(ut<1e-6)){for(rt=0,this.visProp.drawzero||(rt=ut);rt<=it.upper+dt&&(rt>=it.lower-dt&&this.processTickPosition(Q,rt,ut,ht),rt+=ut,!(it.upper-rt>ut*1e4)););for(rt=-ut;rt>=it.lower-dt&&(rt<=it.upper+dt&&this.processTickPosition(Q,rt,ut,ht),rt-=ut,!(rt-it.lower>ut*1e4)););}},at.unsuspendUpdate()}function H(at){let tt={highlight:!1,fixed:!0};if(X.xlabel){let Q="rt",it=[5,10],rt="right";X.xlabelPosition==="left"&&(Q="lft",rt="left",it=[-5,10]),tt.name=X.xlabel,tt.withLabel=!0,tt.label={position:Q,offset:it,anchorx:rt,strokeColor:"var(--canvastext)",highlight:!1},X.xlabelHasLatex&&(tt.label.useMathJax=!0)}if(w.current=!!X.xlabel,tt.ticks={ticksDistance:2,label:{offset:[-5,-15],layer:2,strokeColor:"var(--canvastext)",highlightStrokeColor:"var(--canvastext)",highlightStrokeOpacity:1},strokeColor:"var(--canvastext)",strokeOpacity:.5,precision:4,drawLabels:X.displayXAxisTickLabels},X.xTickScaleFactor!==null){let Q=Context.fromAst(X.xTickScaleFactor),it=Q.evaluate_to_constant();if(it>0){let rt=Q.toString();tt.ticks.scale=it,tt.ticks.scaleSymbol=rt}}tt.strokeColor="var(--canvastext)",tt.highlight=!1,X.grid==="dense"?(tt.ticks.majorHeight=-1,tt.ticks.minorHeight=-1):X.grid==="medium"?(tt.ticks.majorHeight=-1,tt.ticks.minorHeight=10):(tt.ticks.majorHeight=12,tt.ticks.minorHeight=10),X.displayYAxis||(tt.ticks.drawZero=!0),at.suspendUpdate(),_.current=at.create("axis",[[0,0],[1,0]],tt),_.current.defaultTicks.ticksFunction=function(){var Q,it,rt;return it=this.getLowerAndUpperBounds(this.getZeroCoordinates(),"ticksdistance"),rt=it.upper-it.lower,Q=Math.pow(10,Math.floor(Math.log(.2*rt)/Math.LN10)),rt<=6*Q&&(Q*=.5),Q},_.current.defaultTicks.generateEquidistantTicks=function(Q,it){this.minTicksDistance=2*Math.max(2.5,Math.log10(Math.abs(it.lower)),Math.log10(Math.abs(it.upper)));var rt,dt=1e-6,ht,ut=this.equidistant?this.ticksFunction(1):this.ticksDelta,_t=4;if(this.visProp.minorticks=4,ht=this.getXandYdeltas(),ut*=this.visProp.scale,this.minTicksDistance>1e-6){ut=this.adjustTickDistance(ut,Q,ht);let Dt=10**Math.floor(Math.log10(ut))*this.visProp.scale;Math.abs(ut/Dt-2)<1e-14&&(_t=3,this.visProp.minorticks=3),ut/=_t+1}if(this.ticksDelta=ut,!(ut<1e-6)){for(rt=0,this.visProp.drawzero||(rt=ut);rt<=it.upper+dt&&(rt>=it.lower-dt&&this.processTickPosition(Q,rt,ut,ht),rt+=ut,!(it.upper-rt>ut*1e4)););for(rt=-ut;rt>=it.lower-dt&&(rt<=it.upper+dt&&this.processTickPosition(Q,rt,ut,ht),rt-=ut,!(rt-it.lower>ut*1e4)););}},at.unsuspendUpdate()}function q(){let at=document.querySelector("#"+cesc(a)+"_navigationbar"),tt=function(rt,dt,ht){var ut=function(){return ht.apply(E,arguments)};E["x_internal"+dt]=E["x_internal"+dt]||[],E["x_internal"+dt].push(ut),rt.addEventListener(dt,ut,!1)},Q=function(rt){rt||(rt=window.event),rt.stopPropagation?rt.stopPropagation():rt.cancelBubble=!0},it=function(rt,dt){var ht;ht=document.createElement("span"),at.appendChild(ht),ht.setAttribute("style","color: var(--canvastext); opacity: 0.7");let ut=document.createTextNode(rt);ht.appendChild(ut),ht.style.paddingLeft="7px",ht.style.paddingRight="7px",ht.classList!==void 0&&ht.classList.add("JXG_navigation_button"),tt(ht,"click",function(_t){return dt.bind(E)(),!1}),tt(ht,"mouseup",Q),tt(ht,"mousedown",Q),tt(ht,"touchend",Q),tt(ht,"touchstart",Q)};E.attr.showzoom&&(it("",E.zoomOut),it("o",E.zoom100),it("+",E.zoomIn)),it("",E.clickLeftArrow),it("",E.clickUpArrow),it("",E.clickDownArrow),it("",E.clickRightArrow)}function K(){for(let at=7;at>=1;at--)document.querySelector("#"+cesc(a)+"_navigationbar > :first-child").remove();E.internalclick=[],E.internalmousedown=[],E.internalmouseup=[],E.internaltouchend=[],E.internaltouchstart=[]}});let tempCounter=0;const BASE_LAYER_OFFSET=tempCounter++,IMAGE_LAYER_OFFSET=tempCounter++,LINE_LAYER_OFFSET=tempCounter++,VERTEX_LAYER_OFFSET=tempCounter++,CONTROL_POINT_LAYER_OFFSET=tempCounter++,POINT_LAYER_OFFSET=tempCounter++,TEXT_LAYER_OFFSET=tempCounter++;export{BASE_LAYER_OFFSET,BoardContext,CONTROL_POINT_LAYER_OFFSET,IMAGE_LAYER_OFFSET,LINE_LAYER_OFFSET,POINT_LAYER_OFFSET,TEXT_LAYER_OFFSET,VERTEX_LAYER_OFFSET,graph as default};
