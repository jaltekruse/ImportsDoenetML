import{D as Hy,s as DT,M as Ft,u as aG,r as sG,j as kp,V as lG,U as uG,W as cG,X as Rp,I as GL,E as $L}from"./index-2b5c64d9.js";import{i as NT}from"./css-ab4d83ca-d016d639.js";var Ep=function(t){return t&&t.Math==Math&&t},ct=Ep(typeof globalThis=="object"&&globalThis)||Ep(typeof window=="object"&&window)||Ep(typeof self=="object"&&self)||Ep(typeof Hy=="object"&&Hy)||function(){return this}()||Hy||Function("return this")(),Br={},Fe=function(t){try{return!!t()}catch{return!0}},fG=Fe,Nt=!fG(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),hG=Fe,Ad=!hG(function(){var t=function(){}.bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),dG=Ad,Tp=Function.prototype.call,Gt=dG?Tp.bind(Tp):function(){return Tp.apply(Tp,arguments)},jd={},KL={}.propertyIsEnumerable,qL=Object.getOwnPropertyDescriptor,pG=qL&&!KL.call({1:2},1);jd.f=pG?function(t){var e=qL(this,t);return!!e&&e.enumerable}:KL;var Id=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},XL=Ad,ZL=Function.prototype,F0=ZL.call,yG=XL&&ZL.bind.bind(F0,F0),We=XL?yG:function(t){return function(){return F0.apply(t,arguments)}},QL=We,mG=QL({}.toString),gG=QL("".slice),Vr=function(t){return gG(mG(t),8,-1)},vG=We,bG=Fe,wG=Vr,ab=Object,SG=vG("".split),Hd=bG(function(){return!ab("z").propertyIsEnumerable(0)})?function(t){return wG(t)=="String"?SG(t,""):ab(t)}:ab,mr=function(t){return t==null},CG=mr,OG=TypeError,En=function(t){if(CG(t))throw OG("Can't call method on "+t);return t},kG=Hd,RG=En,Fn=function(t){return kG(RG(t))},W0=typeof document=="object"&&document.all,EG=typeof W0>"u"&&W0!==void 0,JL={all:W0,IS_HTMLDDA:EG},eB=JL,TG=eB.all,wt=eB.IS_HTMLDDA?function(t){return typeof t=="function"||t===TG}:function(t){return typeof t=="function"},LT=wt,tB=JL,PG=tB.all,Lt=tB.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:LT(t)||t===PG}:function(t){return typeof t=="object"?t!==null:LT(t)},sb=ct,MG=wt,_G=function(t){return MG(t)?t:void 0},Bo=function(t,e){return arguments.length<2?_G(sb[t]):sb[t]&&sb[t][e]},xG=We,ki=xG({}.isPrototypeOf),Fa=typeof navigator<"u"&&String(navigator.userAgent)||"",nB=ct,lb=Fa,BT=nB.process,VT=nB.Deno,FT=BT&&BT.versions||VT&&VT.version,WT=FT&&FT.v8,lr,Om;WT&&(lr=WT.split("."),Om=lr[0]>0&&lr[0]<4?1:+(lr[0]+lr[1]));!Om&&lb&&(lr=lb.match(/Edge\/(\d+)/),(!lr||lr[1]>=74)&&(lr=lb.match(/Chrome\/(\d+)/),lr&&(Om=+lr[1])));var Dd=Om,UT=Dd,AG=Fe,jG=ct,IG=jG.String,oc=!!Object.getOwnPropertySymbols&&!AG(function(){var t=Symbol();return!IG(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&UT&&UT<41}),HG=oc,rB=HG&&!Symbol.sham&&typeof Symbol.iterator=="symbol",DG=Bo,NG=wt,LG=ki,BG=rB,VG=Object,Nd=BG?function(t){return typeof t=="symbol"}:function(t){var e=DG("Symbol");return NG(e)&&LG(e.prototype,VG(t))},FG=String,ic=function(t){try{return FG(t)}catch{return"Object"}},WG=wt,UG=ic,zG=TypeError,Wa=function(t){if(WG(t))return t;throw zG(UG(t)+" is not a function")},YG=Wa,GG=mr,Ua=function(t,e){var r=t[e];return GG(r)?void 0:YG(r)},ub=Gt,cb=wt,fb=Lt,$G=TypeError,oB=function(t,e){var r,n;if(e==="string"&&cb(r=t.toString)&&!fb(n=ub(r,t))||cb(r=t.valueOf)&&!fb(n=ub(r,t))||e!=="string"&&cb(r=t.toString)&&!fb(n=ub(r,t)))return n;throw $G("Can't convert object to primitive value")},iB={exports:{}},KG=!1,zT=ct,qG=Object.defineProperty,NO=function(t,e){try{qG(zT,t,{value:e,configurable:!0,writable:!0})}catch{zT[t]=e}return e},XG=ct,ZG=NO,YT="__core-js_shared__",QG=XG[YT]||ZG(YT,{}),LO=QG,GT=LO;(iB.exports=function(t,e){return GT[t]||(GT[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.30.2",mode:"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"});var ac=iB.exports,JG=En,e3=Object,Tn=function(t){return e3(JG(t))},t3=We,n3=Tn,r3=t3({}.hasOwnProperty),Et=Object.hasOwn||function(t,e){return r3(n3(t),e)},o3=We,i3=0,a3=Math.random(),s3=o3(1 .toString),Wg=function(t){return"Symbol("+(t===void 0?"":t)+")_"+s3(++i3+a3,36)},l3=ct,u3=ac,$T=Et,c3=Wg,f3=oc,h3=rB,Is=l3.Symbol,hb=u3("wks"),d3=h3?Is.for||Is:Is&&Is.withoutSetter||c3,mt=function(t){return $T(hb,t)||(hb[t]=f3&&$T(Is,t)?Is[t]:d3("Symbol."+t)),hb[t]},p3=Gt,KT=Lt,qT=Nd,y3=Ua,m3=oB,g3=mt,v3=TypeError,b3=g3("toPrimitive"),aB=function(t,e){if(!KT(t)||qT(t))return t;var r=y3(t,b3),n;if(r){if(e===void 0&&(e="default"),n=p3(r,t,e),!KT(n)||qT(n))return n;throw v3("Can't convert object to primitive value")}return e===void 0&&(e="number"),m3(t,e)},w3=aB,S3=Nd,Ug=function(t){var e=w3(t,"string");return S3(e)?e:e+""},C3=ct,XT=Lt,U0=C3.document,O3=XT(U0)&&XT(U0.createElement),zg=function(t){return O3?U0.createElement(t):{}},k3=Nt,R3=Fe,E3=zg,sB=!k3&&!R3(function(){return Object.defineProperty(E3("div"),"a",{get:function(){return 7}}).a!=7}),T3=Nt,P3=Gt,M3=jd,_3=Id,x3=Fn,A3=Ug,j3=Et,I3=sB,ZT=Object.getOwnPropertyDescriptor;Br.f=T3?ZT:function(t,e){if(t=x3(t),e=A3(e),I3)try{return ZT(t,e)}catch{}if(j3(t,e))return _3(!P3(M3.f,t,e),t[e])};var gn={},H3=Nt,D3=Fe,lB=H3&&D3(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),N3=Lt,L3=String,B3=TypeError,At=function(t){if(N3(t))return t;throw B3(L3(t)+" is not an object")},V3=Nt,F3=sB,W3=lB,Pp=At,QT=Ug,U3=TypeError,db=Object.defineProperty,z3=Object.getOwnPropertyDescriptor,pb="enumerable",yb="configurable",mb="writable";gn.f=V3?W3?function(t,e,r){if(Pp(t),e=QT(e),Pp(r),typeof t=="function"&&e==="prototype"&&"value"in r&&mb in r&&!r[mb]){var n=z3(t,e);n&&n[mb]&&(t[e]=r.value,r={configurable:yb in r?r[yb]:n[yb],enumerable:pb in r?r[pb]:n[pb],writable:!1})}return db(t,e,r)}:db:function(t,e,r){if(Pp(t),e=QT(e),Pp(r),F3)try{return db(t,e,r)}catch{}if("get"in r||"set"in r)throw U3("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var Y3=Nt,G3=gn,$3=Id,za=Y3?function(t,e,r){return G3.f(t,e,$3(1,r))}:function(t,e,r){return t[e]=r,t},uB={exports:{}},z0=Nt,K3=Et,cB=Function.prototype,q3=z0&&Object.getOwnPropertyDescriptor,BO=K3(cB,"name"),X3=BO&&function(){}.name==="something",Z3=BO&&(!z0||z0&&q3(cB,"name").configurable),Ld={EXISTS:BO,PROPER:X3,CONFIGURABLE:Z3},Q3=We,J3=wt,Y0=LO,e$=Q3(Function.toString);J3(Y0.inspectSource)||(Y0.inspectSource=function(t){return e$(t)});var fB=Y0.inspectSource,t$=ct,n$=wt,JT=t$.WeakMap,hB=n$(JT)&&/native code/.test(String(JT)),r$=ac,o$=Wg,eP=r$("keys"),Yg=function(t){return eP[t]||(eP[t]=o$(t))},Bd={},i$=hB,dB=ct,a$=Lt,s$=za,gb=Et,vb=LO,l$=Yg,u$=Bd,tP="Object already initialized",G0=dB.TypeError,c$=dB.WeakMap,km,Cf,Rm,f$=function(t){return Rm(t)?Cf(t):km(t,{})},h$=function(t){return function(e){var r;if(!a$(e)||(r=Cf(e)).type!==t)throw G0("Incompatible receiver, "+t+" required");return r}};if(i$||vb.state){var vr=vb.state||(vb.state=new c$);vr.get=vr.get,vr.has=vr.has,vr.set=vr.set,km=function(t,e){if(vr.has(t))throw G0(tP);return e.facade=t,vr.set(t,e),e},Cf=function(t){return vr.get(t)||{}},Rm=function(t){return vr.has(t)}}else{var es=l$("state");u$[es]=!0,km=function(t,e){if(gb(t,es))throw G0(tP);return e.facade=t,s$(t,es,e),e},Cf=function(t){return gb(t,es)?t[es]:{}},Rm=function(t){return gb(t,es)}}var Vo={set:km,get:Cf,has:Rm,enforce:f$,getterFor:h$},VO=We,d$=Fe,p$=wt,Mp=Et,$0=Nt,y$=Ld.CONFIGURABLE,m$=fB,pB=Vo,g$=pB.enforce,v$=pB.get,nP=String,Dy=Object.defineProperty,b$=VO("".slice),w$=VO("".replace),S$=VO([].join),C$=$0&&!d$(function(){return Dy(function(){},"length",{value:8}).length!==8}),O$=String(String).split("String"),k$=uB.exports=function(t,e,r){b$(nP(e),0,7)==="Symbol("&&(e="["+w$(nP(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Mp(t,"name")||y$&&t.name!==e)&&($0?Dy(t,"name",{value:e,configurable:!0}):t.name=e),C$&&r&&Mp(r,"arity")&&t.length!==r.arity&&Dy(t,"length",{value:r.arity});try{r&&Mp(r,"constructor")&&r.constructor?$0&&Dy(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=g$(t);return Mp(n,"source")||(n.source=S$(O$,typeof e=="string"?e:"")),t};Function.prototype.toString=k$(function(){return p$(this)&&v$(this).source||m$(this)},"toString");var yB=uB.exports,R$=wt,E$=gn,T$=yB,P$=NO,Qn=function(t,e,r,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:e;if(R$(r)&&T$(r,i,n),n.global)o?t[e]=r:P$(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch{}o?t[e]=r:E$.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Ya={},M$=Math.ceil,_$=Math.floor,x$=Math.trunc||function(t){var e=+t;return(e>0?_$:M$)(e)},A$=x$,Ri=function(t){var e=+t;return e!==e||e===0?0:A$(e)},j$=Ri,I$=Math.max,H$=Math.min,Vd=function(t,e){var r=j$(t);return r<0?I$(r+e,0):H$(r,e)},D$=Ri,N$=Math.min,Ga=function(t){return t>0?N$(D$(t),9007199254740991):0},L$=Ga,Jn=function(t){return L$(t.length)},B$=Fn,V$=Vd,F$=Jn,rP=function(t){return function(e,r,n){var o=B$(e),i=F$(o),a=V$(n,i),s;if(t&&r!=r){for(;i>a;)if(s=o[a++],s!=s)return!0}else for(;i>a;a++)if((t||a in o)&&o[a]===r)return t||a||0;return!t&&-1}},FO={includes:rP(!0),indexOf:rP(!1)},W$=We,bb=Et,U$=Fn,z$=FO.indexOf,Y$=Bd,oP=W$([].push),mB=function(t,e){var r=U$(t),n=0,o=[],i;for(i in r)!bb(Y$,i)&&bb(r,i)&&oP(o,i);for(;e.length>n;)bb(r,i=e[n++])&&(~z$(o,i)||oP(o,i));return o},WO=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],G$=mB,$$=WO,K$=$$.concat("length","prototype");Ya.f=Object.getOwnPropertyNames||function(t){return G$(t,K$)};var Fd={};Fd.f=Object.getOwnPropertySymbols;var q$=Bo,X$=We,Z$=Ya,Q$=Fd,J$=At,eK=X$([].concat),gB=q$("Reflect","ownKeys")||function(t){var e=Z$.f(J$(t)),r=Q$.f;return r?eK(e,r(t)):e},iP=Et,tK=gB,nK=Br,rK=gn,vB=function(t,e,r){for(var n=tK(e),o=rK.f,i=nK.f,a=0;a<n.length;a++){var s=n[a];!iP(t,s)&&!(r&&iP(r,s))&&o(t,s,i(e,s))}},oK=Fe,iK=wt,aK=/#|\.prototype\./,Wd=function(t,e){var r=lK[sK(t)];return r==cK?!0:r==uK?!1:iK(e)?oK(e):!!e},sK=Wd.normalize=function(t){return String(t).replace(aK,".").toLowerCase()},lK=Wd.data={},uK=Wd.NATIVE="N",cK=Wd.POLYFILL="P",Gg=Wd,wb=ct,fK=Br.f,hK=za,dK=Qn,pK=NO,yK=vB,mK=Gg,_e=function(t,e){var r=t.target,n=t.global,o=t.stat,i,a,s,l,u,c;if(n?a=wb:o?a=wb[r]||pK(r,{}):a=(wb[r]||{}).prototype,a)for(s in e){if(u=e[s],t.dontCallGetSet?(c=fK(a,s),l=c&&c.value):l=a[s],i=mK(n?s:r+(o?".":"#")+s,t.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;yK(u,l)}(t.sham||l&&l.sham)&&hK(u,"sham",!0),dK(a,s,u,t)}},gK=mt,vK=gK("toStringTag"),bB={};bB[vK]="z";var UO=String(bB)==="[object z]",bK=UO,wK=wt,Ny=Vr,SK=mt,CK=SK("toStringTag"),OK=Object,kK=Ny(function(){return arguments}())=="Arguments",RK=function(t,e){try{return t[e]}catch{}},$g=bK?Ny:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=RK(e=OK(t),CK))=="string"?r:kK?Ny(e):(n=Ny(e))=="Object"&&wK(e.callee)?"Arguments":n},EK=$g,TK=String,Bt=function(t){if(EK(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return TK(t)},zO={},PK=mB,MK=WO,Ud=Object.keys||function(t){return PK(t,MK)},_K=Nt,xK=lB,AK=gn,jK=At,IK=Fn,HK=Ud;zO.f=_K&&!xK?Object.defineProperties:function(t,e){jK(t);for(var r=IK(e),n=HK(e),o=n.length,i=0,a;o>i;)AK.f(t,a=n[i++],r[a]);return t};var DK=Bo,wB=DK("document","documentElement"),NK=At,LK=zO,aP=WO,BK=Bd,VK=wB,FK=zg,WK=Yg,sP=">",lP="<",K0="prototype",q0="script",SB=WK("IE_PROTO"),Sb=function(){},CB=function(t){return lP+q0+sP+t+lP+"/"+q0+sP},uP=function(t){t.write(CB("")),t.close();var e=t.parentWindow.Object;return t=null,e},UK=function(){var t=FK("iframe"),e="java"+q0+":",r;return t.style.display="none",VK.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(CB("document.F=Object")),r.close(),r.F},_p,Ly=function(){try{_p=new ActiveXObject("htmlfile")}catch{}Ly=typeof document<"u"?document.domain&&_p?uP(_p):UK():uP(_p);for(var t=aP.length;t--;)delete Ly[K0][aP[t]];return Ly()};BK[SB]=!0;var sc=Object.create||function(t,e){var r;return t!==null?(Sb[K0]=NK(t),r=new Sb,Sb[K0]=null,r[SB]=t):r=Ly(),e===void 0?r:LK.f(r,e)},YO={},zK=Ug,YK=gn,GK=Id,lc=function(t,e,r){var n=zK(e);n in t?YK.f(t,n,GK(0,r)):t[n]=r},cP=Vd,$K=Jn,KK=lc,qK=Array,XK=Math.max,GO=function(t,e,r){for(var n=$K(t),o=cP(e,n),i=cP(r===void 0?n:r,n),a=qK(XK(i-o,0)),s=0;o<i;o++,s++)KK(a,s,t[o]);return a.length=s,a},ZK=Vr,QK=Fn,OB=Ya.f,JK=GO,kB=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],e6=function(t){try{return OB(t)}catch{return JK(kB)}};YO.f=function(t){return kB&&ZK(t)=="Window"?e6(t):OB(QK(t))};var fP=yB,t6=gn,zd=function(t,e,r){return r.get&&fP(r.get,e,{getter:!0}),r.set&&fP(r.set,e,{setter:!0}),t6.f(t,e,r)},$O={},n6=mt;$O.f=n6;var r6=ct,RB=r6,hP=RB,o6=Et,i6=$O,a6=gn.f,KO=function(t){var e=hP.Symbol||(hP.Symbol={});o6(e,t)||a6(e,t,{value:i6.f(t)})},s6=Gt,l6=Bo,u6=mt,c6=Qn,EB=function(){var t=l6("Symbol"),e=t&&t.prototype,r=e&&e.valueOf,n=u6("toPrimitive");e&&!e[n]&&c6(e,n,function(o){return s6(r,this)},{arity:1})},f6=gn.f,h6=Et,d6=mt,dP=d6("toStringTag"),Kg=function(t,e,r){t&&!r&&(t=t.prototype),t&&!h6(t,dP)&&f6(t,dP,{configurable:!0,value:e})},p6=Vr,y6=We,Yd=function(t){if(p6(t)==="Function")return y6(t)},pP=Yd,m6=Wa,g6=Ad,v6=pP(pP.bind),Gd=function(t,e){return m6(t),e===void 0?t:g6?v6(t,e):function(){return t.apply(e,arguments)}},b6=Vr,uc=Array.isArray||function(t){return b6(t)=="Array"},w6=We,S6=Fe,TB=wt,C6=$g,O6=Bo,k6=fB,PB=function(){},R6=[],MB=O6("Reflect","construct"),qO=/^\s*(?:class|function)\b/,E6=w6(qO.exec),T6=!qO.exec(PB),Sc=function(t){if(!TB(t))return!1;try{return MB(PB,R6,t),!0}catch{return!1}},_B=function(t){if(!TB(t))return!1;switch(C6(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return T6||!!E6(qO,k6(t))}catch{return!0}};_B.sham=!0;var qg=!MB||S6(function(){var t;return Sc(Sc.call)||!Sc(Object)||!Sc(function(){t=!0})||t})?_B:Sc,yP=uc,P6=qg,M6=Lt,_6=mt,x6=_6("species"),mP=Array,A6=function(t){var e;return yP(t)&&(e=t.constructor,P6(e)&&(e===mP||yP(e.prototype))?e=void 0:M6(e)&&(e=e[x6],e===null&&(e=void 0))),e===void 0?mP:e},j6=A6,XO=function(t,e){return new(j6(t))(e===0?0:e)},I6=Gd,H6=We,D6=Hd,N6=Tn,L6=Jn,B6=XO,gP=H6([].push),zo=function(t){var e=t==1,r=t==2,n=t==3,o=t==4,i=t==6,a=t==7,s=t==5||i;return function(l,u,c,f){for(var h=N6(l),p=D6(h),y=I6(u,c),g=L6(p),v=0,S=f||B6,O=e?S(l,g):r||a?S(l,0):void 0,w,x;g>v;v++)if((s||v in p)&&(w=p[v],x=y(w,v,h),t))if(e)O[v]=x;else if(x)switch(t){case 3:return!0;case 5:return w;case 6:return v;case 2:gP(O,w)}else switch(t){case 4:return!1;case 7:gP(O,w)}return i?-1:n||o?o:O}},$a={forEach:zo(0),map:zo(1),filter:zo(2),some:zo(3),every:zo(4),find:zo(5),findIndex:zo(6),filterReject:zo(7)},Xg=_e,ZO=ct,QO=Gt,V6=We,Js=Nt,el=oc,F6=Fe,Jt=Et,W6=ki,X0=At,Zg=Fn,JO=Ug,U6=Bt,Z0=Id,Of=sc,xB=Ud,z6=Ya,AB=YO,Y6=Fd,jB=Br,IB=gn,G6=zO,HB=jd,Cb=Qn,$6=zd,ek=ac,K6=Yg,DB=Bd,vP=Wg,q6=mt,X6=$O,Z6=KO,Q6=EB,J6=Kg,NB=Vo,Qg=$a.forEach,On=K6("hidden"),Jg="Symbol",kf="prototype",e8=NB.set,bP=NB.getterFor(Jg),qn=Object[kf],Ca=ZO.Symbol,Jc=Ca&&Ca[kf],t8=ZO.TypeError,Ob=ZO.QObject,LB=jB.f,Ki=IB.f,BB=AB.f,n8=HB.f,VB=V6([].push),Io=ek("symbols"),$d=ek("op-symbols"),r8=ek("wks"),Q0=!Ob||!Ob[kf]||!Ob[kf].findChild,J0=Js&&F6(function(){return Of(Ki({},"a",{get:function(){return Ki(this,"a",{value:7}).a}})).a!=7})?function(t,e,r){var n=LB(qn,e);n&&delete qn[e],Ki(t,e,r),n&&t!==qn&&Ki(qn,e,n)}:Ki,kb=function(t,e){var r=Io[t]=Of(Jc);return e8(r,{type:Jg,tag:t,description:e}),Js||(r.description=e),r},ev=function(t,e,r){t===qn&&ev($d,e,r),X0(t);var n=JO(e);return X0(r),Jt(Io,n)?(r.enumerable?(Jt(t,On)&&t[On][n]&&(t[On][n]=!1),r=Of(r,{enumerable:Z0(0,!1)})):(Jt(t,On)||Ki(t,On,Z0(1,{})),t[On][n]=!0),J0(t,n,r)):Ki(t,n,r)},tk=function(t,e){X0(t);var r=Zg(e),n=xB(r).concat(UB(r));return Qg(n,function(o){(!Js||QO(eS,r,o))&&ev(t,o,r[o])}),t},o8=function(t,e){return e===void 0?Of(t):tk(Of(t),e)},eS=function(t){var e=JO(t),r=QO(n8,this,e);return this===qn&&Jt(Io,e)&&!Jt($d,e)?!1:r||!Jt(this,e)||!Jt(Io,e)||Jt(this,On)&&this[On][e]?r:!0},FB=function(t,e){var r=Zg(t),n=JO(e);if(!(r===qn&&Jt(Io,n)&&!Jt($d,n))){var o=LB(r,n);return o&&Jt(Io,n)&&!(Jt(r,On)&&r[On][n])&&(o.enumerable=!0),o}},WB=function(t){var e=BB(Zg(t)),r=[];return Qg(e,function(n){!Jt(Io,n)&&!Jt(DB,n)&&VB(r,n)}),r},UB=function(t){var e=t===qn,r=BB(e?$d:Zg(t)),n=[];return Qg(r,function(o){Jt(Io,o)&&(!e||Jt(qn,o))&&VB(n,Io[o])}),n};el||(Ca=function(){if(W6(Jc,this))throw t8("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:U6(arguments[0]),e=vP(t),r=function(n){this===qn&&QO(r,$d,n),Jt(this,On)&&Jt(this[On],e)&&(this[On][e]=!1),J0(this,e,Z0(1,n))};return Js&&Q0&&J0(qn,e,{configurable:!0,set:r}),kb(e,t)},Jc=Ca[kf],Cb(Jc,"toString",function(){return bP(this).tag}),Cb(Ca,"withoutSetter",function(t){return kb(vP(t),t)}),HB.f=eS,IB.f=ev,G6.f=tk,jB.f=FB,z6.f=AB.f=WB,Y6.f=UB,X6.f=function(t){return kb(q6(t),t)},Js&&($6(Jc,"description",{configurable:!0,get:function(){return bP(this).description}}),Cb(qn,"propertyIsEnumerable",eS,{unsafe:!0})));Xg({global:!0,constructor:!0,wrap:!0,forced:!el,sham:!el},{Symbol:Ca});Qg(xB(r8),function(t){Z6(t)});Xg({target:Jg,stat:!0,forced:!el},{useSetter:function(){Q0=!0},useSimple:function(){Q0=!1}});Xg({target:"Object",stat:!0,forced:!el,sham:!Js},{create:o8,defineProperty:ev,defineProperties:tk,getOwnPropertyDescriptor:FB});Xg({target:"Object",stat:!0,forced:!el},{getOwnPropertyNames:WB});Q6();J6(Ca,Jg);DB[On]=!0;var i8=oc,zB=i8&&!!Symbol.for&&!!Symbol.keyFor,a8=_e,s8=Bo,l8=Et,u8=Bt,YB=ac,c8=zB,Rb=YB("string-to-symbol-registry"),f8=YB("symbol-to-string-registry");a8({target:"Symbol",stat:!0,forced:!c8},{for:function(t){var e=u8(t);if(l8(Rb,e))return Rb[e];var r=s8("Symbol")(e);return Rb[e]=r,f8[r]=e,r}});var h8=_e,d8=Et,p8=Nd,y8=ic,m8=ac,g8=zB,wP=m8("symbol-to-string-registry");h8({target:"Symbol",stat:!0,forced:!g8},{keyFor:function(t){if(!p8(t))throw TypeError(y8(t)+" is not a symbol");if(d8(wP,t))return wP[t]}});var v8=Ad,GB=Function.prototype,SP=GB.apply,CP=GB.call,Ka=typeof Reflect=="object"&&Reflect.apply||(v8?CP.bind(SP):function(){return CP.apply(SP,arguments)}),b8=We,Kd=b8([].slice),w8=We,OP=uc,S8=wt,kP=Vr,C8=Bt,RP=w8([].push),O8=function(t){if(S8(t))return t;if(OP(t)){for(var e=t.length,r=[],n=0;n<e;n++){var o=t[n];typeof o=="string"?RP(r,o):(typeof o=="number"||kP(o)=="Number"||kP(o)=="String")&&RP(r,C8(o))}var i=r.length,a=!0;return function(s,l){if(a)return a=!1,l;if(OP(this))return l;for(var u=0;u<i;u++)if(r[u]===s)return l}}},k8=_e,$B=Bo,KB=Ka,R8=Gt,qd=We,qB=Fe,EP=wt,TP=Nd,XB=Kd,E8=O8,T8=oc,P8=String,li=$B("JSON","stringify"),xp=qd(/./.exec),PP=qd("".charAt),M8=qd("".charCodeAt),_8=qd("".replace),x8=qd(1 .toString),A8=/[\uD800-\uDFFF]/g,MP=/^[\uD800-\uDBFF]$/,_P=/^[\uDC00-\uDFFF]$/,xP=!T8||qB(function(){var t=$B("Symbol")();return li([t])!="[null]"||li({a:t})!="{}"||li(Object(t))!="{}"}),AP=qB(function(){return li("\uDF06\uD834")!=='"\\udf06\\ud834"'||li("\uDEAD")!=='"\\udead"'}),j8=function(t,e){var r=XB(arguments),n=E8(e);if(!(!EP(n)&&(t===void 0||TP(t))))return r[1]=function(o,i){if(EP(n)&&(i=R8(n,this,P8(o),i)),!TP(i))return i},KB(li,null,r)},I8=function(t,e,r){var n=PP(r,e-1),o=PP(r,e+1);return xp(MP,t)&&!xp(_P,o)||xp(_P,t)&&!xp(MP,n)?"\\u"+x8(M8(t,0),16):t};li&&k8({target:"JSON",stat:!0,arity:3,forced:xP||AP},{stringify:function(t,e,r){var n=XB(arguments),o=KB(xP?j8:li,null,n);return AP&&typeof o=="string"?_8(o,A8,I8):o}});var H8=_e,D8=oc,N8=Fe,ZB=Fd,L8=Tn,B8=!D8||N8(function(){ZB.f(1)});H8({target:"Object",stat:!0,forced:B8},{getOwnPropertySymbols:function(t){var e=ZB.f;return e?e(L8(t)):[]}});var V8=_e,F8=Nt,W8=ct,Ap=We,U8=Et,z8=wt,Y8=ki,G8=Bt,$8=zd,K8=vB,to=W8.Symbol,Mi=to&&to.prototype;if(F8&&z8(to)&&(!("description"in Mi)||to().description!==void 0)){var jP={},jp=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:G8(arguments[0]),e=Y8(Mi,this)?new to(t):t===void 0?to():to(t);return t===""&&(jP[e]=!0),e};K8(jp,to),jp.prototype=Mi,Mi.constructor=jp;var q8=String(to("test"))=="Symbol(test)",X8=Ap(Mi.valueOf),Z8=Ap(Mi.toString),Q8=/^Symbol\((.*)\)[^)]+$/,J8=Ap("".replace),eq=Ap("".slice);$8(Mi,"description",{configurable:!0,get:function(){var t=X8(this);if(U8(jP,t))return"";var e=Z8(t),r=q8?eq(e,7,-1):J8(e,Q8,"$1");return r===""?void 0:r}}),V8({global:!0,constructor:!0,forced:!0},{Symbol:jp})}var tq=KO;tq("iterator");var nq=Nt,rq=Ld.EXISTS,QB=We,oq=zd,JB=Function.prototype,iq=QB(JB.toString),eV=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,aq=QB(eV.exec),sq="name";nq&&!rq&&oq(JB,sq,{configurable:!0,get:function(){try{return aq(eV,iq(this))[1]}catch{return""}}});var lq=Fe,nk=!lq(function(){return Object.isExtensible(Object.preventExtensions({}))}),tV={exports:{}},uq=Fe,cq=uq(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),fq=Fe,hq=Lt,dq=Vr,IP=cq,By=Object.isExtensible,pq=fq(function(){By(1)}),yq=pq||IP?function(t){return!hq(t)||IP&&dq(t)=="ArrayBuffer"?!1:By?By(t):!0}:By,mq=_e,gq=We,vq=Bd,bq=Lt,rk=Et,wq=gn.f,HP=Ya,Sq=YO,ok=yq,Cq=Wg,Oq=nk,nV=!1,Ho=Cq("meta"),kq=0,ik=function(t){wq(t,Ho,{value:{objectID:"O"+kq++,weakData:{}}})},Rq=function(t,e){if(!bq(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!rk(t,Ho)){if(!ok(t))return"F";if(!e)return"E";ik(t)}return t[Ho].objectID},Eq=function(t,e){if(!rk(t,Ho)){if(!ok(t))return!0;if(!e)return!1;ik(t)}return t[Ho].weakData},Tq=function(t){return Oq&&nV&&ok(t)&&!rk(t,Ho)&&ik(t),t},Pq=function(){Mq.enable=function(){},nV=!0;var t=HP.f,e=gq([].splice),r={};r[Ho]=1,t(r).length&&(HP.f=function(n){for(var o=t(n),i=0,a=o.length;i<a;i++)if(o[i]===Ho){e(o,i,1);break}return o},mq({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Sq.f}))},Mq=tV.exports={enable:Pq,fastKey:Rq,getWeakData:Eq,onFreeze:Tq};vq[Ho]=!0;var Xd=tV.exports,_q=_e,xq=nk,Aq=Fe,jq=Lt,Iq=Xd.onFreeze,tS=Object.freeze,Hq=Aq(function(){tS(1)});_q({target:"Object",stat:!0,forced:Hq,sham:!xq},{freeze:function(t){return tS&&jq(t)?tS(Iq(t)):t}});var Dq=mt,Nq=sc,Lq=gn.f,nS=Dq("unscopables"),rS=Array.prototype;rS[nS]==null&&Lq(rS,nS,{configurable:!0,value:Nq(null)});var Zd=function(t){rS[nS][t]=!0},Qd={},Bq=Fe,rV=!Bq(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Vq=Et,Fq=wt,Wq=Tn,Uq=Yg,zq=rV,DP=Uq("IE_PROTO"),oS=Object,Yq=oS.prototype,tv=zq?oS.getPrototypeOf:function(t){var e=Wq(t);if(Vq(e,DP))return e[DP];var r=e.constructor;return Fq(r)&&e instanceof r?r.prototype:e instanceof oS?Yq:null},Gq=Fe,$q=wt,Kq=Lt,NP=tv,qq=Qn,Xq=mt,iS=Xq("iterator"),oV=!1,Ta,Eb,Tb;[].keys&&(Tb=[].keys(),"next"in Tb?(Eb=NP(NP(Tb)),Eb!==Object.prototype&&(Ta=Eb)):oV=!0);var Zq=!Kq(Ta)||Gq(function(){var t={};return Ta[iS].call(t)!==t});Zq&&(Ta={});$q(Ta[iS])||qq(Ta,iS,function(){return this});var iV={IteratorPrototype:Ta,BUGGY_SAFARI_ITERATORS:oV},Qq=iV.IteratorPrototype,Jq=sc,e4=Id,t4=Kg,n4=Qd,r4=function(){return this},o4=function(t,e,r,n){var o=e+" Iterator";return t.prototype=Jq(Qq,{next:e4(+!n,r)}),t4(t,o,!1),n4[o]=r4,t},i4=We,a4=Wa,s4=function(t,e,r){try{return i4(a4(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},l4=wt,u4=String,c4=TypeError,f4=function(t){if(typeof t=="object"||l4(t))return t;throw c4("Can't set "+u4(t)+" as a prototype")},h4=s4,d4=At,p4=f4,ak=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=h4(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(n,o){return d4(n),p4(o),t?r(n,o):n.__proto__=o,n}}():void 0),y4=_e,m4=Gt,aV=Ld,g4=wt,v4=o4,LP=tv,BP=ak,b4=Kg,w4=za,Pb=Qn,S4=mt,C4=Qd,sV=iV,O4=aV.PROPER,k4=aV.CONFIGURABLE,VP=sV.IteratorPrototype,Ip=sV.BUGGY_SAFARI_ITERATORS,Cc=S4("iterator"),FP="keys",Oc="values",WP="entries",R4=function(){return this},sk=function(t,e,r,n,o,i,a){v4(r,e,n);var s=function(S){if(S===o&&h)return h;if(!Ip&&S in c)return c[S];switch(S){case FP:return function(){return new r(this,S)};case Oc:return function(){return new r(this,S)};case WP:return function(){return new r(this,S)}}return function(){return new r(this)}},l=e+" Iterator",u=!1,c=t.prototype,f=c[Cc]||c["@@iterator"]||o&&c[o],h=!Ip&&f||s(o),p=e=="Array"&&c.entries||f,y,g,v;if(p&&(y=LP(p.call(new t)),y!==Object.prototype&&y.next&&(LP(y)!==VP&&(BP?BP(y,VP):g4(y[Cc])||Pb(y,Cc,R4)),b4(y,l,!0))),O4&&o==Oc&&f&&f.name!==Oc&&(k4?w4(c,"name",Oc):(u=!0,h=function(){return m4(f,this)})),o)if(g={values:s(Oc),keys:i?h:s(FP),entries:s(WP)},a)for(v in g)(Ip||u||!(v in c))&&Pb(c,v,g[v]);else y4({target:e,proto:!0,forced:Ip||u},g);return c[Cc]!==h&&Pb(c,Cc,h,{name:o}),C4[e]=h,g},lk=function(t,e){return{value:t,done:e}},E4=Fn,uk=Zd,UP=Qd,lV=Vo,T4=gn.f,P4=sk,Hp=lk,M4=Nt,uV="Array Iterator",_4=lV.set,x4=lV.getterFor(uV),A4=P4(Array,"Array",function(t,e){_4(this,{type:uV,target:E4(t),index:0,kind:e})},function(){var t=x4(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Hp(void 0,!0)):r=="keys"?Hp(n,!1):r=="values"?Hp(e[n],!1):Hp([n,e[n]],!1)},"values"),zP=UP.Arguments=UP.Array;uk("keys");uk("values");uk("entries");if(M4&&zP.name!=="values")try{T4(zP,"name",{value:"values"})}catch{}var j4=UO,I4=$g,H4=j4?{}.toString:function(){return"[object "+I4(this)+"]"},D4=UO,N4=Qn,L4=H4;D4||N4(Object.prototype,"toString",L4,{unsafe:!0});var B4=mt,V4=Qd,F4=B4("iterator"),W4=Array.prototype,cV=function(t){return t!==void 0&&(V4.Array===t||W4[F4]===t)},U4=$g,YP=Ua,z4=mr,Y4=Qd,G4=mt,$4=G4("iterator"),ck=function(t){if(!z4(t))return YP(t,$4)||YP(t,"@@iterator")||Y4[U4(t)]},K4=Gt,q4=Wa,X4=At,Z4=ic,Q4=ck,J4=TypeError,fV=function(t,e){var r=arguments.length<2?Q4(t):e;if(q4(r))return X4(K4(r,t));throw J4(Z4(t)+" is not iterable")},eX=Gt,GP=At,tX=Ua,hV=function(t,e,r){var n,o;GP(t);try{if(n=tX(t,"return"),!n){if(e==="throw")throw r;return r}n=eX(n,t)}catch(i){o=!0,n=i}if(e==="throw")throw r;if(o)throw n;return GP(n),r},nX=Gd,rX=Gt,oX=At,iX=ic,aX=cV,sX=Jn,$P=ki,lX=fV,uX=ck,KP=hV,cX=TypeError,Vy=function(t,e){this.stopped=t,this.result=e},qP=Vy.prototype,fk=function(t,e,r){var n=r&&r.that,o=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),a=!!(r&&r.IS_ITERATOR),s=!!(r&&r.INTERRUPTED),l=nX(e,n),u,c,f,h,p,y,g,v=function(O){return u&&KP(u,"normal",O),new Vy(!0,O)},S=function(O){return o?(oX(O),s?l(O[0],O[1],v):l(O[0],O[1])):s?l(O,v):l(O)};if(i)u=t.iterator;else if(a)u=t;else{if(c=uX(t),!c)throw cX(iX(t)+" is not iterable");if(aX(c)){for(f=0,h=sX(t);h>f;f++)if(p=S(t[f]),p&&$P(qP,p))return p;return new Vy(!1)}u=lX(t,c)}for(y=i?t.next:u.next;!(g=rX(y,u)).done;){try{p=S(g.value)}catch(O){KP(u,"throw",O)}if(typeof p=="object"&&p&&$P(qP,p))return p}return new Vy(!1)},fX=ki,hX=TypeError,hk=function(t,e){if(fX(e,t))return t;throw hX("Incorrect invocation")},dX=mt,dV=dX("iterator"),pV=!1;try{var pX=0,XP={next:function(){return{done:!!pX++}},return:function(){pV=!0}};XP[dV]=function(){return this},Array.from(XP,function(){throw 2})}catch{}var yV=function(t,e){if(!e&&!pV)return!1;var r=!1;try{var n={};n[dV]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},yX=wt,mX=Lt,ZP=ak,dk=function(t,e,r){var n,o;return ZP&&yX(n=e.constructor)&&n!==r&&mX(o=n.prototype)&&o!==r.prototype&&ZP(t,o),t},gX=_e,vX=ct,bX=We,QP=Gg,wX=Qn,SX=Xd,CX=fk,OX=hk,kX=wt,RX=mr,Mb=Lt,_b=Fe,EX=yV,TX=Kg,PX=dk,nv=function(t,e,r){var n=t.indexOf("Map")!==-1,o=t.indexOf("Weak")!==-1,i=n?"set":"add",a=vX[t],s=a&&a.prototype,l=a,u={},c=function(S){var O=bX(s[S]);wX(s,S,S=="add"?function(w){return O(this,w===0?0:w),this}:S=="delete"?function(w){return o&&!Mb(w)?!1:O(this,w===0?0:w)}:S=="get"?function(w){return o&&!Mb(w)?void 0:O(this,w===0?0:w)}:S=="has"?function(w){return o&&!Mb(w)?!1:O(this,w===0?0:w)}:function(w,x){return O(this,w===0?0:w,x),this})},f=QP(t,!kX(a)||!(o||s.forEach&&!_b(function(){new a().entries().next()})));if(f)l=r.getConstructor(e,t,n,i),SX.enable();else if(QP(t,!0)){var h=new l,p=h[i](o?{}:-0,1)!=h,y=_b(function(){h.has(1)}),g=EX(function(S){new a(S)}),v=!o&&_b(function(){for(var S=new a,O=5;O--;)S[i](O,O);return!S.has(-0)});g||(l=e(function(S,O){OX(S,s);var w=PX(new a,S,l);return RX(O)||CX(O,w[i],{that:w,AS_ENTRIES:n}),w}),l.prototype=s,s.constructor=l),(y||v)&&(c("delete"),c("has"),n&&c("get")),(v||p)&&c(i),o&&s.clear&&delete s.clear}return u[t]=l,gX({global:!0,constructor:!0,forced:l!=a},u),TX(l,t),o||r.setStrong(l,t,n),l},MX=Qn,pk=function(t,e,r){for(var n in e)MX(t,n,e[n],r);return t},_X=Bo,xX=zd,AX=mt,jX=Nt,JP=AX("species"),mV=function(t){var e=_X(t);jX&&e&&!e[JP]&&xX(e,JP,{configurable:!0,get:function(){return this}})},IX=sc,HX=zd,eM=pk,DX=Gd,NX=hk,LX=mr,BX=fk,VX=sk,Dp=lk,FX=mV,kc=Nt,tM=Xd.fastKey,gV=Vo,nM=gV.set,xb=gV.getterFor,vV={getConstructor:function(t,e,r,n){var o=t(function(u,c){NX(u,i),nM(u,{type:e,index:IX(null),first:void 0,last:void 0,size:0}),kc||(u.size=0),LX(c)||BX(c,u[n],{that:u,AS_ENTRIES:r})}),i=o.prototype,a=xb(e),s=function(u,c,f){var h=a(u),p=l(u,c),y,g;return p?p.value=f:(h.last=p={index:g=tM(c,!0),key:c,value:f,previous:y=h.last,next:void 0,removed:!1},h.first||(h.first=p),y&&(y.next=p),kc?h.size++:u.size++,g!=="F"&&(h.index[g]=p)),u},l=function(u,c){var f=a(u),h=tM(c),p;if(h!=="F")return f.index[h];for(p=f.first;p;p=p.next)if(p.key==c)return p};return eM(i,{clear:function(){for(var u=this,c=a(u),f=c.index,h=c.first;h;)h.removed=!0,h.previous&&(h.previous=h.previous.next=void 0),delete f[h.index],h=h.next;c.first=c.last=void 0,kc?c.size=0:u.size=0},delete:function(u){var c=this,f=a(c),h=l(c,u);if(h){var p=h.next,y=h.previous;delete f.index[h.index],h.removed=!0,y&&(y.next=p),p&&(p.previous=y),f.first==h&&(f.first=p),f.last==h&&(f.last=y),kc?f.size--:c.size--}return!!h},forEach:function(u){for(var c=a(this),f=DX(u,arguments.length>1?arguments[1]:void 0),h;h=h?h.next:c.first;)for(f(h.value,h.key,this);h&&h.removed;)h=h.previous},has:function(u){return!!l(this,u)}}),eM(i,r?{get:function(u){var c=l(this,u);return c&&c.value},set:function(u,c){return s(this,u===0?0:u,c)}}:{add:function(u){return s(this,u=u===0?0:u,u)}}),kc&&HX(i,"size",{configurable:!0,get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=xb(e),i=xb(n);VX(t,e,function(a,s){nM(this,{type:n,target:a,state:o(a),kind:s,last:void 0})},function(){for(var a=i(this),s=a.kind,l=a.last;l&&l.removed;)l=l.previous;return!a.target||!(a.last=l=l?l.next:a.state.first)?(a.target=void 0,Dp(void 0,!0)):s=="keys"?Dp(l.key,!1):s=="values"?Dp(l.value,!1):Dp([l.key,l.value],!1)},r?"entries":"values",!r,!0),FX(e)}},WX=nv,UX=vV;WX("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},UX);var yk=We,zX=Ri,YX=Bt,GX=En,$X=yk("".charAt),rM=yk("".charCodeAt),KX=yk("".slice),oM=function(t){return function(e,r){var n=YX(GX(e)),o=zX(r),i=n.length,a,s;return o<0||o>=i?t?"":void 0:(a=rM(n,o),a<55296||a>56319||o+1===i||(s=rM(n,o+1))<56320||s>57343?t?$X(n,o):a:t?KX(n,o,o+2):(a-55296<<10)+(s-56320)+65536)}},mk={codeAt:oM(!1),charAt:oM(!0)},qX=mk.charAt,XX=Bt,bV=Vo,ZX=sk,iM=lk,wV="String Iterator",QX=bV.set,JX=bV.getterFor(wV);ZX(String,"String",function(t){QX(this,{type:wV,string:XX(t),index:0})},function(){var t=JX(this),e=t.string,r=t.index,n;return r>=e.length?iM(void 0,!0):(n=qX(e,r),t.index+=n.length,iM(n,!1))});var SV={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},e9=zg,Ab=e9("span").classList,aM=Ab&&Ab.constructor&&Ab.constructor.prototype,CV=aM===Object.prototype?void 0:aM,sM=ct,OV=SV,t9=CV,ef=A4,jb=za,kV=mt,Ib=kV("iterator"),lM=kV("toStringTag"),Hb=ef.values,RV=function(t,e){if(t){if(t[Ib]!==Hb)try{jb(t,Ib,Hb)}catch{t[Ib]=Hb}if(t[lM]||jb(t,lM,e),OV[e]){for(var r in ef)if(t[r]!==ef[r])try{jb(t,r,ef[r])}catch{t[r]=ef[r]}}}};for(var Db in OV)RV(sM[Db]&&sM[Db].prototype,Db);RV(t9,"DOMTokenList");var n9=_e,r9=FO.includes,o9=Fe,i9=Zd,a9=o9(function(){return!Array(1).includes()});n9({target:"Array",proto:!0,forced:a9},{includes:function(t){return r9(this,t,arguments.length>1?arguments[1]:void 0)}});i9("includes");var uM=ic,s9=TypeError,EV=function(t,e){if(!delete t[e])throw s9("Cannot delete property "+uM(e)+" of "+uM(t))},cM=GO,l9=Math.floor,aS=function(t,e){var r=t.length,n=l9(r/2);return r<8?u9(t,e):c9(t,aS(cM(t,0,n),e),aS(cM(t,n),e),e)},u9=function(t,e){for(var r=t.length,n=1,o,i;n<r;){for(i=n,o=t[n];i&&e(t[i-1],o)>0;)t[i]=t[--i];i!==n++&&(t[i]=o)}return t},c9=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,s=0;a<o||s<i;)t[a+s]=a<o&&s<i?n(e[a],r[s])<=0?e[a++]:r[s++]:a<o?e[a++]:r[s++];return t},f9=aS,h9=Fe,cc=function(t,e){var r=[][t];return!!r&&h9(function(){r.call(null,e||function(){return 1},1)})},d9=Fa,fM=d9.match(/firefox\/(\d+)/i),p9=!!fM&&+fM[1],y9=Fa,m9=/MSIE|Trident/.test(y9),g9=Fa,hM=g9.match(/AppleWebKit\/(\d+)\./),v9=!!hM&&+hM[1],b9=_e,TV=We,w9=Wa,S9=Tn,dM=Jn,C9=EV,pM=Bt,gk=Fe,O9=f9,k9=cc,yM=p9,R9=m9,mM=Dd,gM=v9,oi=[],vM=TV(oi.sort),E9=TV(oi.push),T9=gk(function(){oi.sort(void 0)}),P9=gk(function(){oi.sort(null)}),M9=k9("sort"),PV=!gk(function(){if(mM)return mM<70;if(!(yM&&yM>3)){if(R9)return!0;if(gM)return gM<603;var t="",e,r,n,o;for(e=65;e<76;e++){switch(r=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(o=0;o<47;o++)oi.push({k:r+o,v:n})}for(oi.sort(function(i,a){return a.v-i.v}),o=0;o<oi.length;o++)r=oi[o].k.charAt(0),t.charAt(t.length-1)!==r&&(t+=r);return t!=="DGBEFHACIJK"}}),_9=T9||!P9||!M9||!PV,x9=function(t){return function(e,r){return r===void 0?-1:e===void 0?1:t!==void 0?+t(e,r)||0:pM(e)>pM(r)?1:-1}};b9({target:"Array",proto:!0,forced:_9},{sort:function(t){t!==void 0&&w9(t);var e=S9(this);if(PV)return t===void 0?vM(e):vM(e,t);var r=[],n=dM(e),o,i;for(i=0;i<n;i++)i in e&&E9(r,e[i]);for(O9(r,x9(t)),o=dM(r),i=0;i<o;)e[i]=r[i++];for(;i<n;)C9(e,i++);return e}});var A9=Nt,j9=uc,I9=TypeError,H9=Object.getOwnPropertyDescriptor,D9=A9&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),N9=D9?function(t,e){if(j9(t)&&!H9(t,"length").writable)throw I9("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},L9=TypeError,B9=9007199254740991,MV=function(t){if(t>B9)throw L9("Maximum allowed index exceeded");return t},V9=Fe,F9=mt,W9=Dd,U9=F9("species"),Jd=function(t){return W9>=51||!V9(function(){var e=[],r=e.constructor={};return r[U9]=function(){return{foo:1}},e[t](Boolean).foo!==1})},z9=_e,Y9=Tn,G9=Vd,$9=Ri,K9=Jn,q9=N9,X9=MV,Z9=XO,Q9=lc,Nb=EV,J9=Jd,e7=J9("splice"),t7=Math.max,n7=Math.min;z9({target:"Array",proto:!0,forced:!e7},{splice:function(t,e){var r=Y9(this),n=K9(r),o=G9(t,n),i=arguments.length,a,s,l,u,c,f;for(i===0?a=s=0:i===1?(a=0,s=n-o):(a=i-2,s=n7(t7($9(e),0),n-o)),X9(n+a-s),l=Z9(r,s),u=0;u<s;u++)c=o+u,c in r&&Q9(l,u,r[c]);if(l.length=s,a<s){for(u=o;u<n-s;u++)c=u+s,f=u+a,c in r?r[f]=r[c]:Nb(r,f);for(u=n;u>n-s+a;u--)Nb(r,u-1)}else if(a>s)for(u=n-s;u>o;u--)c=u+s-1,f=u+a-1,c in r?r[f]=r[c]:Nb(r,f);for(u=0;u<a;u++)r[u+o]=arguments[u+2];return q9(r,n-s+a),l}});var r7=Lt,o7=Math.floor,i7=Number.isInteger||function(t){return!r7(t)&&isFinite(t)&&o7(t)===t},a7=_e,s7=i7;a7({target:"Number",stat:!0},{isInteger:s7});var l7=We,_V=l7(1 .valueOf),xV=`	
\v\f\r                　\u2028\u2029\uFEFF`,u7=We,c7=En,f7=Bt,sS=xV,bM=u7("".replace),h7=RegExp("^["+sS+"]+"),d7=RegExp("(^|[^"+sS+"])["+sS+"]+$"),Lb=function(t){return function(e){var r=f7(c7(e));return t&1&&(r=bM(r,h7,"")),t&2&&(r=bM(r,d7,"$1")),r}},AV={start:Lb(1),end:Lb(2),trim:Lb(3)},p7=_e,jV=KG,y7=Nt,IV=ct,HV=RB,DV=We,m7=Gg,wM=Et,g7=dk,v7=ki,b7=Nd,NV=aB,w7=Fe,S7=Ya.f,C7=Br.f,O7=gn.f,k7=_V,R7=AV.trim,rv="Number",Ls=IV[rv];HV[rv];var vk=Ls.prototype,E7=IV.TypeError,T7=DV("".slice),Np=DV("".charCodeAt),P7=function(t){var e=NV(t,"number");return typeof e=="bigint"?e:M7(e)},M7=function(t){var e=NV(t,"number"),r,n,o,i,a,s,l,u;if(b7(e))throw E7("Cannot convert a Symbol value to a number");if(typeof e=="string"&&e.length>2){if(e=R7(e),r=Np(e,0),r===43||r===45){if(n=Np(e,2),n===88||n===120)return NaN}else if(r===48){switch(Np(e,1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+e}for(a=T7(e,2),s=a.length,l=0;l<s;l++)if(u=Np(a,l),u<48||u>i)return NaN;return parseInt(a,o)}}return+e},bk=m7(rv,!Ls(" 0o1")||!Ls("0b1")||Ls("+0x1")),_7=function(t){return v7(vk,t)&&w7(function(){k7(t)})},ov=function(t){var e=arguments.length<1?0:Ls(P7(t));return _7(this)?g7(Object(e),this,ov):e};ov.prototype=vk;bk&&!jV&&(vk.constructor=ov);p7({global:!0,constructor:!0,wrap:!0,forced:bk},{Number:ov});var x7=function(t,e){for(var r=y7?S7(e):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),n=0,o;r.length>n;n++)wM(e,o=r[n])&&!wM(t,o)&&O7(t,o,C7(e,o))};(bk||jV)&&x7(HV[rv],Ls);var A7=_e,SM=uc,j7=qg,I7=Lt,CM=Vd,H7=Jn,D7=Fn,N7=lc,L7=mt,B7=Jd,V7=Kd,F7=B7("slice"),W7=L7("species"),Bb=Array,U7=Math.max;A7({target:"Array",proto:!0,forced:!F7},{slice:function(t,e){var r=D7(this),n=H7(r),o=CM(t,n),i=CM(e===void 0?n:e,n),a,s,l;if(SM(r)&&(a=r.constructor,j7(a)&&(a===Bb||SM(a.prototype))?a=void 0:I7(a)&&(a=a[W7],a===null&&(a=void 0)),a===Bb||a===void 0))return V7(r,o,i);for(s=new(a===void 0?Bb:a)(U7(i-o,0)),l=0;o<i;o++,l++)o in r&&N7(s,l,r[o]);return s.length=l,s}});var z7=_e,Y7=Fe,G7=uc,$7=Lt,K7=Tn,q7=Jn,OM=MV,kM=lc,X7=XO,Z7=Jd,Q7=mt,J7=Dd,LV=Q7("isConcatSpreadable"),e5=J7>=51||!Y7(function(){var t=[];return t[LV]=!1,t.concat()[0]!==t}),t5=function(t){if(!$7(t))return!1;var e=t[LV];return e!==void 0?!!e:G7(t)},n5=!e5||!Z7("concat");z7({target:"Array",proto:!0,arity:1,forced:n5},{concat:function(t){var e=K7(this),r=X7(e,0),n=0,o,i,a,s,l;for(o=-1,a=arguments.length;o<a;o++)if(l=o===-1?e:arguments[o],t5(l))for(s=q7(l),OM(n+s),i=0;i<s;i++,n++)i in l&&kM(r,n,l[i]);else OM(n+1),kM(r,n++,l);return r.length=n,r}});var r5=Tn,RM=Vd,o5=Jn,i5=function(t){for(var e=r5(this),r=o5(e),n=arguments.length,o=RM(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=i===void 0?r:RM(i,r);a>o;)e[o++]=t;return e},a5=_e,s5=i5,l5=Zd;a5({target:"Array",proto:!0},{fill:s5});l5("fill");var u5=_e,c5=$a.map,f5=Jd,h5=f5("map");u5({target:"Array",proto:!0,forced:!h5},{map:function(t){return c5(this,t,arguments.length>1?arguments[1]:void 0)}});var d5=At,BV=function(){var t=d5(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},wk=Fe,p5=ct,Sk=p5.RegExp,Ck=wk(function(){var t=Sk("a","y");return t.lastIndex=2,t.exec("abcd")!=null}),y5=Ck||wk(function(){return!Sk("a","y").sticky}),m5=Ck||wk(function(){var t=Sk("^r","gy");return t.lastIndex=2,t.exec("str")!=null}),Ok={BROKEN_CARET:m5,MISSED_STICKY:y5,UNSUPPORTED_Y:Ck},g5=Fe,v5=ct,b5=v5.RegExp,VV=g5(function(){var t=b5(".","s");return!(t.dotAll&&t.exec(`
`)&&t.flags==="s")}),w5=Fe,S5=ct,C5=S5.RegExp,FV=w5(function(){var t=C5("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),Hs=Gt,iv=We,O5=Bt,k5=BV,R5=Ok,E5=ac,T5=sc,P5=Vo.get,M5=VV,_5=FV,x5=E5("native-string-replace",String.prototype.replace),Em=RegExp.prototype.exec,lS=Em,A5=iv("".charAt),j5=iv("".indexOf),I5=iv("".replace),Vb=iv("".slice),uS=function(){var t=/a/,e=/b*/g;return Hs(Em,t,"a"),Hs(Em,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),WV=R5.BROKEN_CARET,cS=/()??/.exec("")[1]!==void 0,H5=uS||cS||WV||M5||_5;H5&&(lS=function(t){var e=this,r=P5(e),n=O5(t),o=r.raw,i,a,s,l,u,c,f;if(o)return o.lastIndex=e.lastIndex,i=Hs(lS,o,n),e.lastIndex=o.lastIndex,i;var h=r.groups,p=WV&&e.sticky,y=Hs(k5,e),g=e.source,v=0,S=n;if(p&&(y=I5(y,"y",""),j5(y,"g")===-1&&(y+="g"),S=Vb(n,e.lastIndex),e.lastIndex>0&&(!e.multiline||e.multiline&&A5(n,e.lastIndex-1)!==`
`)&&(g="(?: "+g+")",S=" "+S,v++),a=new RegExp("^(?:"+g+")",y)),cS&&(a=new RegExp("^"+g+"$(?!\\s)",y)),uS&&(s=e.lastIndex),l=Hs(Em,p?a:e,S),p?l?(l.input=Vb(l.input,v),l[0]=Vb(l[0],v),l.index=e.lastIndex,e.lastIndex+=l[0].length):e.lastIndex=0:uS&&l&&(e.lastIndex=e.global?l.index+l[0].length:s),cS&&l&&l.length>1&&Hs(x5,l[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(l[u]=void 0)}),l&&h)for(l.groups=c=T5(null),u=0;u<h.length;u++)f=h[u],c[f[0]]=l[f[1]];return l});var av=lS,D5=_e,EM=av;D5({target:"RegExp",proto:!0,forced:/./.exec!==EM},{exec:EM});var TM=Yd,PM=Qn,N5=av,MM=Fe,UV=mt,L5=za,B5=UV("species"),Fb=RegExp.prototype,sv=function(t,e,r,n){var o=UV(t),i=!MM(function(){var u={};return u[o]=function(){return 7},""[t](u)!=7}),a=i&&!MM(function(){var u=!1,c=/a/;return t==="split"&&(c={},c.constructor={},c.constructor[B5]=function(){return c},c.flags="",c[o]=/./[o]),c.exec=function(){return u=!0,null},c[o](""),!u});if(!i||!a||r){var s=TM(/./[o]),l=e(o,""[t],function(u,c,f,h,p){var y=TM(u),g=c.exec;return g===N5||g===Fb.exec?i&&!p?{done:!0,value:s(c,f,h)}:{done:!0,value:y(f,c,h)}:{done:!1}});PM(String.prototype,t,l[0]),PM(Fb,o,l[1])}n&&L5(Fb[o],"sham",!0)},V5=mk.charAt,kk=function(t,e,r){return e+(r?V5(t,e).length:1)},Rk=We,F5=Tn,W5=Math.floor,Wb=Rk("".charAt),U5=Rk("".replace),Ub=Rk("".slice),z5=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Y5=/\$([$&'`]|\d{1,2})/g,G5=function(t,e,r,n,o,i){var a=r+t.length,s=n.length,l=Y5;return o!==void 0&&(o=F5(o),l=z5),U5(i,l,function(u,c){var f;switch(Wb(c,0)){case"$":return"$";case"&":return t;case"`":return Ub(e,0,r);case"'":return Ub(e,a);case"<":f=o[Ub(c,1,-1)];break;default:var h=+c;if(h===0)return u;if(h>s){var p=W5(h/10);return p===0?u:p<=s?n[p-1]===void 0?Wb(c,1):n[p-1]+Wb(c,1):u}f=n[h-1]}return f===void 0?"":f})},_M=Gt,$5=At,K5=wt,q5=Vr,X5=av,Z5=TypeError,lv=function(t,e){var r=t.exec;if(K5(r)){var n=_M(r,t,e);return n!==null&&$5(n),n}if(q5(t)==="RegExp")return _M(X5,t,e);throw Z5("RegExp#exec called on incompatible receiver")},Q5=Ka,xM=Gt,uv=We,J5=sv,eZ=Fe,tZ=At,nZ=wt,rZ=mr,oZ=Ri,iZ=Ga,ts=Bt,aZ=En,sZ=kk,lZ=Ua,uZ=G5,cZ=lv,fZ=mt,fS=fZ("replace"),hZ=Math.max,dZ=Math.min,pZ=uv([].concat),zb=uv([].push),AM=uv("".indexOf),jM=uv("".slice),yZ=function(t){return t===void 0?t:String(t)},mZ=function(){return"a".replace(/./,"$0")==="$0"}(),IM=function(){return/./[fS]?/./[fS]("a","$0")==="":!1}(),gZ=!eZ(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});J5("replace",function(t,e,r){var n=IM?"$":"$0";return[function(o,i){var a=aZ(this),s=rZ(o)?void 0:lZ(o,fS);return s?xM(s,o,a,i):xM(e,ts(a),o,i)},function(o,i){var a=tZ(this),s=ts(o);if(typeof i=="string"&&AM(i,n)===-1&&AM(i,"$<")===-1){var l=r(e,a,s,i);if(l.done)return l.value}var u=nZ(i);u||(i=ts(i));var c=a.global;if(c){var f=a.unicode;a.lastIndex=0}for(var h=[];;){var p=cZ(a,s);if(p===null||(zb(h,p),!c))break;var y=ts(p[0]);y===""&&(a.lastIndex=sZ(s,iZ(a.lastIndex),f))}for(var g="",v=0,S=0;S<h.length;S++){p=h[S];for(var O=ts(p[0]),w=hZ(dZ(oZ(p.index),s.length),0),x=[],T=1;T<p.length;T++)zb(x,yZ(p[T]));var z=p.groups;if(u){var $=pZ([O],x,w,s);z!==void 0&&zb($,z);var ne=ts(Q5(i,void 0,$))}else ne=uZ(O,s,w,x,z,i);w>=v&&(g+=jM(s,v,w)+ne,v=w+O.length)}return g+jM(s,v)}]},!gZ||!mZ||IM);var vZ=At,bZ=hV,wZ=function(t,e,r,n){try{return n?e(vZ(r)[0],r[1]):e(r)}catch(o){bZ(t,"throw",o)}},SZ=Gd,CZ=Gt,OZ=Tn,kZ=wZ,RZ=cV,EZ=qg,TZ=Jn,HM=lc,PZ=fV,MZ=ck,DM=Array,_Z=function(t){var e=OZ(t),r=EZ(this),n=arguments.length,o=n>1?arguments[1]:void 0,i=o!==void 0;i&&(o=SZ(o,n>2?arguments[2]:void 0));var a=MZ(e),s=0,l,u,c,f,h,p;if(a&&!(this===DM&&RZ(a)))for(f=PZ(e,a),h=f.next,u=r?new this:[];!(c=CZ(h,f)).done;s++)p=i?kZ(f,o,[c.value,s],!0):c.value,HM(u,s,p);else for(l=TZ(e),u=r?new this(l):DM(l);l>s;s++)p=i?o(e[s],s):e[s],HM(u,s,p);return u.length=s,u},xZ=_e,AZ=_Z,jZ=yV,IZ=!jZ(function(t){Array.from(t)});xZ({target:"Array",stat:!0,forced:IZ},{from:AZ});var HZ=_e,DZ=Yd,NZ=FO.indexOf,LZ=cc,hS=DZ([].indexOf),zV=!!hS&&1/hS([1],1,-0)<0,BZ=zV||!LZ("indexOf");HZ({target:"Array",proto:!0,forced:BZ},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return zV?hS(this,t,e)||0:NZ(this,t,e)}});var VZ=_e,FZ=We,WZ=uc,UZ=FZ([].reverse),NM=[1,2];VZ({target:"Array",proto:!0,forced:String(NM)===String(NM.reverse())},{reverse:function(){return WZ(this)&&(this.length=this.length),UZ(this)}});var zZ=$a.forEach,YZ=cc,GZ=YZ("forEach"),$Z=GZ?[].forEach:function(t){return zZ(this,t,arguments.length>1?arguments[1]:void 0)},LM=ct,BM=SV,KZ=CV,Yb=$Z,qZ=za,YV=function(t){if(t&&t.forEach!==Yb)try{qZ(t,"forEach",Yb)}catch{t.forEach=Yb}};for(var Gb in BM)BM[Gb]&&YV(LM[Gb]&&LM[Gb].prototype);YV(KZ);var XZ=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",ZZ=TypeError,GV=function(t,e){if(t<e)throw ZZ("Not enough arguments");return t},$V=ct,QZ=Ka,JZ=wt,eQ=XZ,tQ=Fa,nQ=Kd,rQ=GV,oQ=$V.Function,iQ=/MSIE .\./.test(tQ)||eQ&&function(){var t=$V.Bun.version.split(".");return t.length<3||t[0]==0&&(t[1]<3||t[1]==3&&t[2]==0)}(),Ek=function(t,e){var r=e?2:1;return iQ?function(n,o){var i=rQ(arguments.length,1)>r,a=JZ(n)?n:oQ(n),s=i?nQ(arguments,r):[],l=i?function(){QZ(a,this,s)}:a;return e?t(l,o):t(l)}:t},aQ=_e,KV=ct,sQ=Ek,VM=sQ(KV.setInterval,!0);aQ({global:!0,bind:!0,forced:KV.setInterval!==VM},{setInterval:VM});var lQ=_e,qV=ct,uQ=Ek,FM=uQ(qV.setTimeout,!0);lQ({global:!0,bind:!0,forced:qV.setTimeout!==FM},{setTimeout:FM});var cQ=Fa,fQ=/(?:ipad|iphone|ipod).*applewebkit/i.test(cQ),hQ=Vr,XV=typeof DT<"u"&&hQ(DT)=="process",Bn=ct,dQ=Ka,pQ=Gd,WM=wt,yQ=Et,ZV=Fe,UM=wB,mQ=Kd,zM=zg,gQ=GV,vQ=fQ,bQ=XV,dS=Bn.setImmediate,pS=Bn.clearImmediate,wQ=Bn.process,$b=Bn.Dispatch,SQ=Bn.Function,YM=Bn.MessageChannel,CQ=Bn.String,Kb=0,sf={},GM="onreadystatechange",Rf,_i,qb,Xb;ZV(function(){Rf=Bn.location});var Tk=function(t){if(yQ(sf,t)){var e=sf[t];delete sf[t],e()}},Zb=function(t){return function(){Tk(t)}},$M=function(t){Tk(t.data)},KM=function(t){Bn.postMessage(CQ(t),Rf.protocol+"//"+Rf.host)};(!dS||!pS)&&(dS=function(t){gQ(arguments.length,1);var e=WM(t)?t:SQ(t),r=mQ(arguments,1);return sf[++Kb]=function(){dQ(e,void 0,r)},_i(Kb),Kb},pS=function(t){delete sf[t]},bQ?_i=function(t){wQ.nextTick(Zb(t))}:$b&&$b.now?_i=function(t){$b.now(Zb(t))}:YM&&!vQ?(qb=new YM,Xb=qb.port2,qb.port1.onmessage=$M,_i=pQ(Xb.postMessage,Xb)):Bn.addEventListener&&WM(Bn.postMessage)&&!Bn.importScripts&&Rf&&Rf.protocol!=="file:"&&!ZV(KM)?(_i=KM,Bn.addEventListener("message",$M,!1)):GM in zM("script")?_i=function(t){UM.appendChild(zM("script"))[GM]=function(){UM.removeChild(this),Tk(t)}}:_i=function(t){setTimeout(Zb(t),0)});var QV={set:dS,clear:pS},OQ=_e,kQ=ct,qM=QV.clear;OQ({global:!0,bind:!0,enumerable:!0,forced:kQ.clearImmediate!==qM},{clearImmediate:qM});var RQ=_e,JV=ct,XM=QV.set,EQ=Ek,ZM=JV.setImmediate?EQ(XM,!1):XM;RQ({global:!0,bind:!0,enumerable:!0,forced:JV.setImmediate!==ZM},{setImmediate:ZM});var TQ=nv,PQ=vV;TQ("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},PQ);var MQ=_e,_Q=Fe,xQ=Tn,eF=tv,AQ=rV,jQ=_Q(function(){eF(1)});MQ({target:"Object",stat:!0,forced:jQ,sham:!AQ},{getPrototypeOf:function(t){return eF(xQ(t))}});var IQ=Lt,HQ=Vr,DQ=mt,NQ=DQ("match"),Pk=function(t){var e;return IQ(t)&&((e=t[NQ])!==void 0?!!e:HQ(t)=="RegExp")},LQ=Pk,BQ=TypeError,Mk=function(t){if(LQ(t))throw BQ("The method doesn't accept regular expressions");return t},VQ=mt,FQ=VQ("match"),_k=function(t){var e=/./;try{"/./"[t](e)}catch{try{return e[FQ]=!1,"/./"[t](e)}catch{}}return!1},WQ=_e,UQ=We,zQ=Mk,YQ=En,QM=Bt,GQ=_k,$Q=UQ("".indexOf);WQ({target:"String",proto:!0,forced:!GQ("includes")},{includes:function(t){return!!~$Q(QM(YQ(this)),QM(zQ(t)),arguments.length>1?arguments[1]:void 0)}});var KQ=_e,qQ=$a.filter,XQ=Jd,ZQ=XQ("filter");KQ({target:"Array",proto:!0,forced:!ZQ},{filter:function(t){return qQ(this,t,arguments.length>1?arguments[1]:void 0)}});var QQ=Gt,JQ=Et,eJ=ki,tJ=BV,JM=RegExp.prototype,tF=function(t){var e=t.flags;return e===void 0&&!("flags"in JM)&&!JQ(t,"flags")&&eJ(JM,t)?QQ(tJ,t):e},nJ=gn.f,rJ=function(t,e,r){r in t||nJ(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},oJ=Nt,xk=ct,ep=We,iJ=Gg,aJ=dk,sJ=za,lJ=Ya.f,e_=ki,uJ=Pk,t_=Bt,cJ=tF,nF=Ok,fJ=rJ,hJ=Qn,dJ=Fe,pJ=Et,yJ=Vo.enforce,mJ=mV,gJ=mt,rF=VV,oF=FV,vJ=gJ("match"),ui=xk.RegExp,Ms=ui.prototype,bJ=xk.SyntaxError,wJ=ep(Ms.exec),Tm=ep("".charAt),n_=ep("".replace),r_=ep("".indexOf),SJ=ep("".slice),CJ=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Oa=/a/g,Qb=/a/g,OJ=new ui(Oa)!==Oa,iF=nF.MISSED_STICKY,kJ=nF.UNSUPPORTED_Y,RJ=oJ&&(!OJ||iF||rF||oF||dJ(function(){return Qb[vJ]=!1,ui(Oa)!=Oa||ui(Qb)==Qb||ui(Oa,"i")!="/a/i"})),EJ=function(t){for(var e=t.length,r=0,n="",o=!1,i;r<=e;r++){if(i=Tm(t,r),i==="\\"){n+=i+Tm(t,++r);continue}!o&&i==="."?n+="[\\s\\S]":(i==="["?o=!0:i==="]"&&(o=!1),n+=i)}return n},TJ=function(t){for(var e=t.length,r=0,n="",o=[],i={},a=!1,s=!1,l=0,u="",c;r<=e;r++){if(c=Tm(t,r),c==="\\")c=c+Tm(t,++r);else if(c==="]")a=!1;else if(!a)switch(!0){case c==="[":a=!0;break;case c==="(":wJ(CJ,SJ(t,r+1))&&(r+=2,s=!0),n+=c,l++;continue;case(c===">"&&s):if(u===""||pJ(i,u))throw new bJ("Invalid capture group name");i[u]=!0,o[o.length]=[u,l],s=!1,u="";continue}s?u+=c:n+=c}return[n,o]};if(iJ("RegExp",RJ)){for(var xi=function(t,e){var r=e_(Ms,this),n=uJ(t),o=e===void 0,i=[],a=t,s,l,u,c,f,h;if(!r&&n&&o&&t.constructor===xi)return t;if((n||e_(Ms,t))&&(t=t.source,o&&(e=cJ(a))),t=t===void 0?"":t_(t),e=e===void 0?"":t_(e),a=t,rF&&"dotAll"in Oa&&(l=!!e&&r_(e,"s")>-1,l&&(e=n_(e,/s/g,""))),s=e,iF&&"sticky"in Oa&&(u=!!e&&r_(e,"y")>-1,u&&kJ&&(e=n_(e,/y/g,""))),oF&&(c=TJ(t),t=c[0],i=c[1]),f=aJ(ui(t,e),r?this:Ms,xi),(l||u||i.length)&&(h=yJ(f),l&&(h.dotAll=!0,h.raw=xi(EJ(t),s)),u&&(h.sticky=!0),i.length&&(h.groups=i)),t!==a)try{sJ(f,"source",a===""?"(?:)":a)}catch{}return f},o_=lJ(ui),i_=0;o_.length>i_;)fJ(xi,ui,o_[i_++]);Ms.constructor=xi,xi.prototype=Ms,hJ(xk,"RegExp",xi,{constructor:!0})}mJ("RegExp");var PJ=Ld.PROPER,MJ=Qn,_J=At,a_=Bt,xJ=Fe,AJ=tF,Ak="toString",jJ=RegExp.prototype,aF=jJ[Ak],IJ=xJ(function(){return aF.call({source:"a",flags:"b"})!="/a/b"}),HJ=PJ&&aF.name!=Ak;(IJ||HJ)&&MJ(RegExp.prototype,Ak,function(){var t=_J(this),e=a_(t.source),r=a_(AJ(t));return"/"+e+"/"+r},{unsafe:!0});var DJ=_e,NJ=We,LJ=Hd,BJ=Fn,VJ=cc,FJ=NJ([].join),WJ=LJ!=Object,UJ=WJ||!VJ("join",",");DJ({target:"Array",proto:!0,forced:UJ},{join:function(t){return FJ(BJ(this),t===void 0?",":t)}});var zJ=Ld.PROPER,YJ=Fe,s_=xV,l_="​᠎",GJ=function(t){return YJ(function(){return!!s_[t]()||l_[t]()!==l_||zJ&&s_[t].name!==t})},$J=_e,KJ=AV.trim,qJ=GJ;$J({target:"String",proto:!0,forced:qJ("trim")},{trim:function(){return KJ(this)}});function yS(t){"@babel/helpers - typeof";return yS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yS(t)}function jk(t){return window.requestAnimationFrame(t)}function XJ(){return!!document.documentElement.classList}function ZJ(){return!!document.createTextNode("test").textContent}function QJ(){return!!window.getComputedStyle}function Pm(t){window.cancelAnimationFrame(t)}function sF(){return"ontouchstart"in window}var mS;function JJ(){var t=document.createElement("TABLE");t.style.borderSpacing="0",t.style.borderWidth="0",t.style.padding="0";var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var r=document.createElement("CAPTION");r.innerHTML="c<br>c<br>c<br>c",r.style.padding="0",r.style.margin="0",t.insertBefore(r,e),document.body.appendChild(t),mS=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function lF(){return mS===void 0&&JJ(),mS}var Rc;function eee(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Rc||((typeof Intl>"u"?"undefined":yS(Intl))==="object"?Rc=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Rc=function(r,n){return"".concat(r).localeCompare(n)}:Rc=function(r,n){return r===n?0:r>n?-1:1},Rc)}var Ec;function tee(){if(Ec!==void 0)return Ec;try{var t={get passive(){Ec=!0}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch{Ec=!1}return Ec}var nee=KO,ree=EB;nee("toPrimitive");ree();var oee=At,iee=oB,aee=TypeError,see=function(t){if(oee(this),t==="string"||t==="default")t="string";else if(t!=="number")throw aee("Incorrect hint");return iee(this,t)},lee=Et,uee=Qn,cee=see,fee=mt,u_=fee("toPrimitive"),c_=Date.prototype;lee(c_,u_)||uee(c_,u_,cee);var hee=qg,dee=ic,pee=TypeError,uF=function(t){if(hee(t))return t;throw pee(dee(t)+" is not a constructor")},f_=At,yee=uF,mee=mr,gee=mt,vee=gee("species"),bee=function(t,e){var r=f_(t).constructor,n;return r===void 0||mee(n=f_(r)[vee])?e:yee(n)},wee=Ka,Tc=Gt,Ik=We,See=sv,Cee=At,Oee=mr,kee=Pk,h_=En,Ree=bee,Eee=kk,Tee=Ga,Jb=Bt,Pee=Ua,d_=GO,p_=lv,Mee=av,_ee=Ok,xee=Fe,ns=_ee.UNSUPPORTED_Y,y_=4294967295,Aee=Math.min,cF=[].push,jee=Ik(/./.exec),rs=Ik(cF),Pc=Ik("".slice),Iee=!xee(function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return r.length!==2||r[0]!=="a"||r[1]!=="b"});See("split",function(t,e,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(o,i){var a=Jb(h_(this)),s=i===void 0?y_:i>>>0;if(s===0)return[];if(o===void 0)return[a];if(!kee(o))return Tc(e,a,o,s);for(var l=[],u=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(o.sticky?"y":""),c=0,f=new RegExp(o.source,u+"g"),h,p,y;(h=Tc(Mee,f,a))&&(p=f.lastIndex,!(p>c&&(rs(l,Pc(a,c,h.index)),h.length>1&&h.index<a.length&&wee(cF,l,d_(h,1)),y=h[0].length,c=p,l.length>=s)));)f.lastIndex===h.index&&f.lastIndex++;return c===a.length?(y||!jee(f,""))&&rs(l,""):rs(l,Pc(a,c)),l.length>s?d_(l,0,s):l}:"0".split(void 0,0).length?n=function(o,i){return o===void 0&&i===0?[]:Tc(e,this,o,i)}:n=e,[function(o,i){var a=h_(this),s=Oee(o)?void 0:Pee(o,t);return s?Tc(s,o,a,i):Tc(n,Jb(a),o,i)},function(o,i){var a=Cee(this),s=Jb(o),l=r(n,a,s,i,n!==e);if(l.done)return l.value;var u=Ree(a,RegExp),c=a.unicode,f=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(ns?"g":"y"),h=new u(ns?"^(?:"+a.source+")":a,f),p=i===void 0?y_:i>>>0;if(p===0)return[];if(s.length===0)return p_(h,s)===null?[s]:[];for(var y=0,g=0,v=[];g<s.length;){h.lastIndex=ns?0:g;var S=p_(h,ns?Pc(s,g):s),O;if(S===null||(O=Aee(Tee(h.lastIndex+(ns?g:0)),s.length))===y)g=Eee(s,g,c);else{if(rs(v,Pc(s,y,g)),v.length===p)return v;for(var w=1;w<=S.length-1;w++)if(rs(v,S[w]),v.length===p)return v;g=y=O}}return rs(v,Pc(s,y)),v}]},!Iee,ns);function Hee(t){for(var e=t.length,r=0;r<e;)t[r]=[t[r]],r+=1}function m_(t,e){for(var r=e.length,n=0;n<r;)t.push(e[n]),n+=1}function Fy(t){var e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;for(var r=t.length,n=t[0].length,o=0;o<r;o++)for(var i=0;i<n;i++)e[i]||(e[i]=[]),e[i][o]=t[o][i];return e}function an(t,e,r,n){var o=-1,i=t,a=r;Array.isArray(t)||(i=Array.from(t));var s=i.length;for(n&&s&&(o+=1,a=i[o]),o+=1;o<s;)a=e(a,i[o],o,i),o+=1;return a}function Xn(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];e(s,r,n)&&(a+=1,i[a]=s),r+=1}return i}function Ye(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var o=n.length,i=[],a=-1;r<o;){var s=n[r];a+=1,i[a]=e(s,r,n),r+=1}return i}function _(t,e){var r=0,n=t;Array.isArray(t)||(n=Array.from(t));for(var o=n.length;r<o&&e(n[r],r,n)!==!1;)r+=1;return t}function fF(t){var e=[];return _(t,function(r){e.indexOf(r)===-1&&e.push(r)}),e}function g_(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=[].concat(e),o=n[0],i=n.slice(1),a=o;return _(i,function(s){a=a.filter(function(l){return!s.includes(l)})}),a}function v_(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function b_(t,e,r){return e=Dee(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dee(t){var e=Nee(t,"string");return Do(e)==="symbol"?e:String(e)}function Nee(t,e){if(Do(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Do(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Do(t){"@babel/helpers - typeof";return Do=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Do(t)}function Ef(t){var e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},$e(t,function(r,n){n!=="__children"&&(r&&Do(r)==="object"&&!Array.isArray(r)?e[n]=Ef(r):Array.isArray(r)?r.length&&Do(r[0])==="object"&&!Array.isArray(r[0])?e[n]=[Ef(r[0])]:e[n]=[]:e[n]=null)})),e}function Ei(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Yt(t,e,r){var n=Array.isArray(r);return $e(e,function(o,i){(n===!1||r.includes(i))&&(t[i]=o)}),t}function cv(t,e){$e(e,function(r,n){e[n]&&Do(e[n])==="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),cv(t[n],e[n])):t[n]=e[n]})}function yn(t){return Do(t)==="object"?JSON.parse(JSON.stringify(t)):t}function Rn(t){var e={};return $e(t,function(r,n){e[n]=r}),e}function pt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return _(r,function(o){t.MIXINS.push(o.MIXIN_NAME),$e(o,function(i,a){if(t.prototype[a]!==void 0)throw new Error("Mixin conflict. Property '".concat(a,"' already exist and cannot be overwritten."));if(typeof i=="function")t.prototype[a]=i;else{var s=function(u,c){var f="_".concat(u),h=function(p){var y=p;return(Array.isArray(y)||Ge(y))&&(y=yn(y)),y};return function(){return this[f]===void 0&&(this[f]=h(c)),this[f]}},l=function(u){var c="_".concat(u);return function(f){this[c]=f}};Object.defineProperty(t.prototype,a,{get:s(a,i),set:l(a),configurable:!0})}})}),t}function Hk(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ge(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fo(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function $e(t,e){for(var r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function Lee(t,e){var r=e.split("."),n=t;return $e(r,function(o){if(n=n[o],n===void 0)return n=void 0,!1}),n}function ew(t,e,r){var n=e.split("."),o=t;n.forEach(function(i,a){a!==n.length-1?(xt(o,i)||(o[i]={}),o=o[i]):o[i]=r})}function Dk(t){if(!Ge(t))return 0;var e=function r(n){var o=0;return Ge(n)?$e(n,function(i,a){a!=="__children"&&(o+=r(i))}):o+=1,o};return e(t)}function tl(t){var e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n="_".concat(r),o=(e={_touched:!1},b_(e,n,t),b_(e,"isTouched",function(){return this._touched}),e);return Object.defineProperty(o,r,{get:function(){return this[n]},set:function(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),o}function xt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Cn=function(t){var e={value:!1};return e.test=function(r,n){e.value=t(r,n)},e},Fr={chrome:Cn(function(t,e){return/Chrome/.test(t)&&/Google/.test(e)}),chromeWebKit:Cn(function(t){return/CriOS/.test(t)}),edge:Cn(function(t){return/Edge/.test(t)}),edgeWebKit:Cn(function(t){return/EdgiOS/.test(t)}),firefox:Cn(function(t){return/Firefox/.test(t)}),firefoxWebKit:Cn(function(t){return/FxiOS/.test(t)}),ie:Cn(function(t){return/Trident/.test(t)}),ie9:Cn(function(){return!!document.documentMode}),mobile:Cn(function(t){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)}),safari:Cn(function(t,e){return/Safari/.test(t)&&/Apple Computer/.test(e)})},tp={mac:Cn(function(t){return/^Mac/.test(t)}),win:Cn(function(t){return/^Win/.test(t)}),linux:Cn(function(t){return/^Linux/.test(t)}),ios:Cn(function(t){return/iPhone|iPad|iPod/i.test(t)})};function Bee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.userAgent,r=e===void 0?navigator.userAgent:e,n=t.vendor,o=n===void 0?navigator.vendor:n;$e(Fr,function(i){var a=i.test;return void a(r,o)})}function Vee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.platform,r=e===void 0?navigator.platform:e;$e(tp,function(n){var o=n.test;return void o(r)})}Bee();Vee();function hF(){return Fr.chrome.value}function Fee(){return Fr.chromeWebKit.value}function tw(){return Fr.firefox.value}function Wee(){return Fr.firefoxWebKit.value}function Uee(){return Fr.safari.value}function zee(){return Fr.edge.value}function Yee(){return Fr.ie.value}function Gee(){return Fr.ie9.value}function Ir(){return Fr.mobile.value}function dF(){return tp.ios.value}function pF(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator,e=t.maxTouchPoints;return e>2&&tp.mac.value}function w_(){return tp.win.value}function S_(){return tp.mac.value}/*! @license DOMPurify 2.4.5 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.5/LICENSE */function ni(t){"@babel/helpers - typeof";return ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ni(t)}function gS(t,e){return gS=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r},gS(t,e)}function $ee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Wy(t,e,r){return $ee()?Wy=Reflect.construct:Wy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&gS(l,i.prototype),l},Wy.apply(null,arguments)}function ar(t){return Kee(t)||qee(t)||Xee(t)||Zee()}function Kee(t){if(Array.isArray(t))return vS(t)}function qee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Xee(t,e){if(t){if(typeof t=="string")return vS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vS(t,e)}}function vS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Zee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Qee=Object.hasOwnProperty,C_=Object.setPrototypeOf,Jee=Object.isFrozen,ete=Object.getPrototypeOf,tte=Object.getOwnPropertyDescriptor,mn=Object.freeze,dr=Object.seal,nte=Object.create,yF=typeof Reflect<"u"&&Reflect,Mm=yF.apply,bS=yF.construct;Mm||(Mm=function(t,e,r){return t.apply(e,r)});mn||(mn=function(t){return t});dr||(dr=function(t){return t});bS||(bS=function(t,e){return Wy(t,ar(e))});var rte=Zn(Array.prototype.forEach),O_=Zn(Array.prototype.pop),Mc=Zn(Array.prototype.push),Uy=Zn(String.prototype.toLowerCase),nw=Zn(String.prototype.toString),ote=Zn(String.prototype.match),rr=Zn(String.prototype.replace),ite=Zn(String.prototype.indexOf),ate=Zn(String.prototype.trim),un=Zn(RegExp.prototype.test),rw=ste(TypeError);function Zn(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return Mm(t,e,n)}}function ste(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return bS(t,r)}}function Ke(t,e,r){r=r||Uy,C_&&C_(t,null);for(var n=e.length;n--;){var o=e[n];if(typeof o=="string"){var i=r(o);i!==o&&(Jee(e)||(e[n]=i),o=i)}t[o]=!0}return t}function Ai(t){var e=nte(null),r;for(r in t)Mm(Qee,t,[r])===!0&&(e[r]=t[r]);return e}function Lp(t,e){for(;t!==null;){var r=tte(t,e);if(r){if(r.get)return Zn(r.get);if(typeof r.value=="function")return Zn(r.value)}t=ete(t)}function n(o){return console.warn("fallback value for",o),null}return n}var k_=mn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ow=mn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),iw=mn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),lte=mn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),aw=mn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ute=mn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),R_=mn(["#text"]),E_=mn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),sw=mn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),T_=mn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Bp=mn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cte=dr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),fte=dr(/<%[\w\W]*|[\w\W]*%>/gm),hte=dr(/\${[\w\W]*}/gm),dte=dr(/^data-[\-\w.\u00B7-\uFFFF]/),pte=dr(/^aria-[\-\w]+$/),yte=dr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mte=dr(/^(?:\w+script|data):/i),gte=dr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vte=dr(/^html$/i),bte=function(){return typeof window>"u"?null:window},wte=function(t,e){if(ni(t)!=="object"||typeof t.createPolicy!="function")return null;var r=null,n="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(n)&&(r=e.currentScript.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(i){return i},createScriptURL:function(i){return i}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function mF(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bte(),e=function(j){return mF(j)};if(e.version="2.4.5",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,o=t.DocumentFragment,i=t.HTMLTemplateElement,a=t.Node,s=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,f=t.HTMLFormElement,h=t.DOMParser,p=t.trustedTypes,y=s.prototype,g=Lp(y,"cloneNode"),v=Lp(y,"nextSibling"),S=Lp(y,"childNodes"),O=Lp(y,"parentNode");if(typeof i=="function"){var w=n.createElement("template");w.content&&w.content.ownerDocument&&(n=w.content.ownerDocument)}var x=wte(p,r),T=x?x.createHTML(""):"",z=n,$=z.implementation,ne=z.createNodeIterator,G=z.createDocumentFragment,q=z.getElementsByTagName,Z=r.importNode,ee={};try{ee=Ai(n).documentMode?n.documentMode:{}}catch{}var Q={};e.isSupported=typeof O=="function"&&$&&typeof $.createHTMLDocument<"u"&&ee!==9;var ce=cte,fe=fte,we=hte,Se=dte,P=pte,d=mte,m=gte,b=yte,k=null,E=Ke({},[].concat(ar(k_),ar(ow),ar(iw),ar(aw),ar(R_))),A=null,W=Ke({},[].concat(ar(E_),ar(sw),ar(T_),ar(Bp))),N=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,X=null,re=!0,me=!0,le=!1,ke=!0,be=!1,Y=!1,Le=!1,He=!1,Ee=!1,De=!1,Me=!1,C=!0,R=!1,M="user-content-",B=!0,I=!1,V={},H=null,D=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),F=null,L=Ke({},["audio","video","img","source","image","track"]),U=null,ie=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",Re="http://www.w3.org/2000/svg",xe="http://www.w3.org/1999/xhtml",Ve=xe,qe=!1,je=null,Ie=Ke({},[ge,Re,xe],nw),Te,et=["application/xhtml+xml","text/html"],Mt="text/html",Ze,st=null,$t=n.createElement("form"),gt=function(j){return j instanceof RegExp||j instanceof Function},Ct=function(j){st&&st===j||((!j||ni(j)!=="object")&&(j={}),j=Ai(j),Te=et.indexOf(j.PARSER_MEDIA_TYPE)===-1?Te=Mt:Te=j.PARSER_MEDIA_TYPE,Ze=Te==="application/xhtml+xml"?nw:Uy,k="ALLOWED_TAGS"in j?Ke({},j.ALLOWED_TAGS,Ze):E,A="ALLOWED_ATTR"in j?Ke({},j.ALLOWED_ATTR,Ze):W,je="ALLOWED_NAMESPACES"in j?Ke({},j.ALLOWED_NAMESPACES,nw):Ie,U="ADD_URI_SAFE_ATTR"in j?Ke(Ai(ie),j.ADD_URI_SAFE_ATTR,Ze):ie,F="ADD_DATA_URI_TAGS"in j?Ke(Ai(L),j.ADD_DATA_URI_TAGS,Ze):L,H="FORBID_CONTENTS"in j?Ke({},j.FORBID_CONTENTS,Ze):D,K="FORBID_TAGS"in j?Ke({},j.FORBID_TAGS,Ze):{},X="FORBID_ATTR"in j?Ke({},j.FORBID_ATTR,Ze):{},V="USE_PROFILES"in j?j.USE_PROFILES:!1,re=j.ALLOW_ARIA_ATTR!==!1,me=j.ALLOW_DATA_ATTR!==!1,le=j.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=j.ALLOW_SELF_CLOSE_IN_ATTR!==!1,be=j.SAFE_FOR_TEMPLATES||!1,Y=j.WHOLE_DOCUMENT||!1,Ee=j.RETURN_DOM||!1,De=j.RETURN_DOM_FRAGMENT||!1,Me=j.RETURN_TRUSTED_TYPE||!1,He=j.FORCE_BODY||!1,C=j.SANITIZE_DOM!==!1,R=j.SANITIZE_NAMED_PROPS||!1,B=j.KEEP_CONTENT!==!1,I=j.IN_PLACE||!1,b=j.ALLOWED_URI_REGEXP||b,Ve=j.NAMESPACE||xe,N=j.CUSTOM_ELEMENT_HANDLING||{},j.CUSTOM_ELEMENT_HANDLING&&gt(j.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(N.tagNameCheck=j.CUSTOM_ELEMENT_HANDLING.tagNameCheck),j.CUSTOM_ELEMENT_HANDLING&&gt(j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(N.attributeNameCheck=j.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),j.CUSTOM_ELEMENT_HANDLING&&typeof j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(N.allowCustomizedBuiltInElements=j.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),be&&(me=!1),De&&(Ee=!0),V&&(k=Ke({},ar(R_)),A=[],V.html===!0&&(Ke(k,k_),Ke(A,E_)),V.svg===!0&&(Ke(k,ow),Ke(A,sw),Ke(A,Bp)),V.svgFilters===!0&&(Ke(k,iw),Ke(A,sw),Ke(A,Bp)),V.mathMl===!0&&(Ke(k,aw),Ke(A,T_),Ke(A,Bp))),j.ADD_TAGS&&(k===E&&(k=Ai(k)),Ke(k,j.ADD_TAGS,Ze)),j.ADD_ATTR&&(A===W&&(A=Ai(A)),Ke(A,j.ADD_ATTR,Ze)),j.ADD_URI_SAFE_ATTR&&Ke(U,j.ADD_URI_SAFE_ATTR,Ze),j.FORBID_CONTENTS&&(H===D&&(H=Ai(H)),Ke(H,j.FORBID_CONTENTS,Ze)),B&&(k["#text"]=!0),Y&&Ke(k,["html","head","body"]),k.table&&(Ke(k,["tbody"]),delete K.tbody),mn&&mn(j),st=j)},tt=Ke({},["mi","mo","mn","ms","mtext"]),Cp=Ke({},["foreignobject","desc","title","annotation-xml"]),nG=Ke({},["title","style","font","a","script"]),Op=Ke({},ow);Ke(Op,iw),Ke(Op,lte);var ob=Ke({},aw);Ke(ob,ute);var rG=function(j){var de=O(j);(!de||!de.tagName)&&(de={namespaceURI:Ve,tagName:"template"});var ae=Uy(j.tagName),ot=Uy(de.tagName);return je[j.namespaceURI]?j.namespaceURI===Re?de.namespaceURI===xe?ae==="svg":de.namespaceURI===ge?ae==="svg"&&(ot==="annotation-xml"||tt[ot]):!!Op[ae]:j.namespaceURI===ge?de.namespaceURI===xe?ae==="math":de.namespaceURI===Re?ae==="math"&&Cp[ot]:!!ob[ae]:j.namespaceURI===xe?de.namespaceURI===Re&&!Cp[ot]||de.namespaceURI===ge&&!tt[ot]?!1:!ob[ae]&&(nG[ae]||!Op[ae]):!!(Te==="application/xhtml+xml"&&je[j.namespaceURI]):!1},Ja=function(j){Mc(e.removed,{element:j});try{j.parentNode.removeChild(j)}catch{try{j.outerHTML=T}catch{j.remove()}}},ib=function(j,de){try{Mc(e.removed,{attribute:de.getAttributeNode(j),from:de})}catch{Mc(e.removed,{attribute:null,from:de})}if(de.removeAttribute(j),j==="is"&&!A[j])if(Ee||De)try{Ja(de)}catch{}else try{de.setAttribute(j,"")}catch{}},MT=function(j){var de,ae;if(He)j="<remove></remove>"+j;else{var ot=ote(j,/^[\r\n\t ]+/);ae=ot&&ot[0]}Te==="application/xhtml+xml"&&Ve===xe&&(j='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+j+"</body></html>");var jt=x?x.createHTML(j):j;if(Ve===xe)try{de=new h().parseFromString(jt,Te)}catch{}if(!de||!de.documentElement){de=$.createDocument(Ve,"template",null);try{de.documentElement.innerHTML=qe?T:jt}catch{}}var Mn=de.body||de.documentElement;return j&&ae&&Mn.insertBefore(n.createTextNode(ae),Mn.childNodes[0]||null),Ve===xe?q.call(de,Y?"html":"body")[0]:Y?de.documentElement:Mn},_T=function(j){return ne.call(j.ownerDocument||j,j,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},oG=function(j){return j instanceof f&&(typeof j.nodeName!="string"||typeof j.textContent!="string"||typeof j.removeChild!="function"||!(j.attributes instanceof c)||typeof j.removeAttribute!="function"||typeof j.setAttribute!="function"||typeof j.namespaceURI!="string"||typeof j.insertBefore!="function"||typeof j.hasChildNodes!="function")},bc=function(j){return ni(a)==="object"?j instanceof a:j&&ni(j)==="object"&&typeof j.nodeType=="number"&&typeof j.nodeName=="string"},zr=function(j,de,ae){Q[j]&&rte(Q[j],function(ot){ot.call(e,de,ae,st)})},xT=function(j){var de;if(zr("beforeSanitizeElements",j,null),oG(j)||un(/[\u0080-\uFFFF]/,j.nodeName))return Ja(j),!0;var ae=Ze(j.nodeName);if(zr("uponSanitizeElement",j,{tagName:ae,allowedTags:k}),j.hasChildNodes()&&!bc(j.firstElementChild)&&(!bc(j.content)||!bc(j.content.firstElementChild))&&un(/<[/\w]/g,j.innerHTML)&&un(/<[/\w]/g,j.textContent)||ae==="select"&&un(/<template/i,j.innerHTML))return Ja(j),!0;if(!k[ae]||K[ae]){if(!K[ae]&&jT(ae)&&(N.tagNameCheck instanceof RegExp&&un(N.tagNameCheck,ae)||N.tagNameCheck instanceof Function&&N.tagNameCheck(ae)))return!1;if(B&&!H[ae]){var ot=O(j)||j.parentNode,jt=S(j)||j.childNodes;if(jt&&ot)for(var Mn=jt.length,Kt=Mn-1;Kt>=0;--Kt)ot.insertBefore(g(jt[Kt],!0),v(j))}return Ja(j),!0}return j instanceof s&&!rG(j)||(ae==="noscript"||ae==="noembed")&&un(/<\/no(script|embed)/i,j.innerHTML)?(Ja(j),!0):(be&&j.nodeType===3&&(de=j.textContent,de=rr(de,ce," "),de=rr(de,fe," "),de=rr(de,we," "),j.textContent!==de&&(Mc(e.removed,{element:j.cloneNode()}),j.textContent=de)),zr("afterSanitizeElements",j,null),!1)},AT=function(j,de,ae){if(C&&(de==="id"||de==="name")&&(ae in n||ae in $t))return!1;if(!(me&&!X[de]&&un(Se,de))&&!(re&&un(P,de))){if(!A[de]||X[de]){if(!(jT(j)&&(N.tagNameCheck instanceof RegExp&&un(N.tagNameCheck,j)||N.tagNameCheck instanceof Function&&N.tagNameCheck(j))&&(N.attributeNameCheck instanceof RegExp&&un(N.attributeNameCheck,de)||N.attributeNameCheck instanceof Function&&N.attributeNameCheck(de))||de==="is"&&N.allowCustomizedBuiltInElements&&(N.tagNameCheck instanceof RegExp&&un(N.tagNameCheck,ae)||N.tagNameCheck instanceof Function&&N.tagNameCheck(ae))))return!1}else if(!U[de]&&!un(b,rr(ae,m,""))&&!((de==="src"||de==="xlink:href"||de==="href")&&j!=="script"&&ite(ae,"data:")===0&&F[j])&&!(le&&!un(d,rr(ae,m,"")))&&ae)return!1}return!0},jT=function(j){return j.indexOf("-")>0},IT=function(j){var de,ae,ot,jt;zr("beforeSanitizeAttributes",j,null);var Mn=j.attributes;if(Mn){var Kt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(jt=Mn.length;jt--;){de=Mn[jt];var wc=de,Yr=wc.name,bn=wc.namespaceURI;if(ae=Yr==="value"?de.value:ate(de.value),ot=Ze(Yr),Kt.attrName=ot,Kt.attrValue=ae,Kt.keepAttr=!0,Kt.forceKeepAttr=void 0,zr("uponSanitizeAttribute",j,Kt),ae=Kt.attrValue,!Kt.forceKeepAttr&&(ib(Yr,j),!!Kt.keepAttr)){if(!ke&&un(/\/>/i,ae)){ib(Yr,j);continue}be&&(ae=rr(ae,ce," "),ae=rr(ae,fe," "),ae=rr(ae,we," "));var HT=Ze(j.nodeName);if(AT(HT,ot,ae)){if(R&&(ot==="id"||ot==="name")&&(ib(Yr,j),ae=M+ae),x&&ni(p)==="object"&&typeof p.getAttributeType=="function"&&!bn)switch(p.getAttributeType(HT,ot)){case"TrustedHTML":ae=x.createHTML(ae);break;case"TrustedScriptURL":ae=x.createScriptURL(ae);break}try{bn?j.setAttributeNS(bn,Yr,ae):j.setAttribute(Yr,ae),O_(e.removed)}catch{}}}}zr("afterSanitizeAttributes",j,null)}},iG=function j(de){var ae,ot=_T(de);for(zr("beforeSanitizeShadowDOM",de,null);ae=ot.nextNode();)zr("uponSanitizeShadowNode",ae,null),!xT(ae)&&(ae.content instanceof o&&j(ae.content),IT(ae));zr("afterSanitizeShadowDOM",de,null)};return e.sanitize=function(j){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ae,ot,jt,Mn,Kt;if(qe=!j,qe&&(j="<!-->"),typeof j!="string"&&!bc(j)){if(typeof j.toString!="function")throw rw("toString is not a function");if(j=j.toString(),typeof j!="string")throw rw("dirty is not a string, aborting")}if(!e.isSupported){if(ni(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof j=="string")return t.toStaticHTML(j);if(bc(j))return t.toStaticHTML(j.outerHTML)}return j}if(Le||Ct(de),e.removed=[],typeof j=="string"&&(I=!1),I){if(j.nodeName){var wc=Ze(j.nodeName);if(!k[wc]||K[wc])throw rw("root node is forbidden and cannot be sanitized in-place")}}else if(j instanceof a)ae=MT("<!---->"),ot=ae.ownerDocument.importNode(j,!0),ot.nodeType===1&&ot.nodeName==="BODY"||ot.nodeName==="HTML"?ae=ot:ae.appendChild(ot);else{if(!Ee&&!be&&!Y&&j.indexOf("<")===-1)return x&&Me?x.createHTML(j):j;if(ae=MT(j),!ae)return Ee?null:Me?T:""}ae&&He&&Ja(ae.firstChild);for(var Yr=_T(I?j:ae);jt=Yr.nextNode();)jt.nodeType===3&&jt===Mn||xT(jt)||(jt.content instanceof o&&iG(jt.content),IT(jt),Mn=jt);if(Mn=null,I)return j;if(Ee){if(De)for(Kt=G.call(ae.ownerDocument);ae.firstChild;)Kt.appendChild(ae.firstChild);else Kt=ae;return(A.shadowroot||A.shadowrootmod)&&(Kt=Z.call(r,Kt,!0)),Kt}var bn=Y?ae.outerHTML:ae.innerHTML;return Y&&k["!doctype"]&&ae.ownerDocument&&ae.ownerDocument.doctype&&ae.ownerDocument.doctype.name&&un(vte,ae.ownerDocument.doctype.name)&&(bn="<!DOCTYPE "+ae.ownerDocument.doctype.name+`>
`+bn),be&&(bn=rr(bn,ce," "),bn=rr(bn,fe," "),bn=rr(bn,we," ")),x&&Me?x.createHTML(bn):bn},e.setConfig=function(j){Ct(j),Le=!0},e.clearConfig=function(){st=null,Le=!1},e.isValidAttribute=function(j,de,ae){st||Ct({});var ot=Ze(j),jt=Ze(de);return AT(ot,jt,ae)},e.addHook=function(j,de){typeof de=="function"&&(Q[j]=Q[j]||[],Mc(Q[j],de))},e.removeHook=function(j){if(Q[j])return O_(Q[j])},e.removeHooks=function(j){Q[j]&&(Q[j]=[])},e.removeAllHooks=function(){Q={}},e}var Ste=mF(),Cte=_e,Ote=mk.codeAt;Cte({target:"String",proto:!0},{codePointAt:function(t){return Ote(this,t)}});var kte=Ri,Rte=Bt,Ete=En,Tte=RangeError,Nk=function(t){var e=Rte(Ete(this)),r="",n=kte(t);if(n<0||n==1/0)throw Tte("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))n&1&&(r+=e);return r},gF=We,Pte=Ga,P_=Bt,Mte=Nk,_te=En,xte=gF(Mte),Ate=gF("".slice),jte=Math.ceil,M_=function(t){return function(e,r,n){var o=P_(_te(e)),i=Pte(r),a=o.length,s=n===void 0?" ":P_(n),l,u;return i<=a||s==""?o:(l=i-a,u=xte(s,jte(l/s.length)),u.length>l&&(u=Ate(u,0,l)),t?o+u:u+o)}},Ite={start:M_(!1),end:M_(!0)},Hte=Fa,Dte=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Hte),Nte=_e,Lte=Ite.start,Bte=Dte;Nte({target:"String",proto:!0,forced:Bte},{padStart:function(t){return Lte(this,t,arguments.length>1?arguments[1]:void 0)}});//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var vF;function J(){return vF.apply(null,arguments)}function Vte(t){vF=t}function pr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ka(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function nt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Lk(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(nt(t,e))return!1;return!0}function Sn(t){return t===void 0}function No(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function np(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function bF(t,e){var r=[],n,o=t.length;for(n=0;n<o;++n)r.push(e(t[n],n));return r}function ii(t,e){for(var r in e)nt(e,r)&&(t[r]=e[r]);return nt(e,"toString")&&(t.toString=e.toString),nt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Wr(t,e,r,n){return UF(t,e,r,n,!0).utc()}function Fte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ue(t){return t._pf==null&&(t._pf=Fte()),t._pf}var wS;Array.prototype.some?wS=Array.prototype.some:wS=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Bk(t){if(t._isValid==null){var e=Ue(t),r=wS.call(e.parsedDateParts,function(o){return o!=null}),n=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r);if(t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n}return t._isValid}function fv(t){var e=Wr(NaN);return t!=null?ii(Ue(e),t):Ue(e).userInvalidated=!0,e}var __=J.momentProperties=[],lw=!1;function Vk(t,e){var r,n,o,i=__.length;if(Sn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Sn(e._i)||(t._i=e._i),Sn(e._f)||(t._f=e._f),Sn(e._l)||(t._l=e._l),Sn(e._strict)||(t._strict=e._strict),Sn(e._tzm)||(t._tzm=e._tzm),Sn(e._isUTC)||(t._isUTC=e._isUTC),Sn(e._offset)||(t._offset=e._offset),Sn(e._pf)||(t._pf=Ue(e)),Sn(e._locale)||(t._locale=e._locale),i>0)for(r=0;r<i;r++)n=__[r],o=e[n],Sn(o)||(t[n]=o);return t}function rp(t){Vk(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),lw===!1&&(lw=!0,J.updateOffset(this),lw=!1)}function yr(t){return t instanceof rp||t!=null&&t._isAMomentObject!=null}function wF(t){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function er(t,e){var r=!0;return ii(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,t),r){var n=[],o,i,a,s=arguments.length;for(i=0;i<s;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(a in arguments[0])nt(arguments[0],a)&&(o+=a+": "+arguments[0][a]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}wF(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var x_={};function SF(t,e){J.deprecationHandler!=null&&J.deprecationHandler(t,e),x_[t]||(wF(e),x_[t]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function Ur(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Wte(t){var e,r;for(r in t)nt(t,r)&&(e=t[r],Ur(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function SS(t,e){var r=ii({},t),n;for(n in e)nt(e,n)&&(ka(t[n])&&ka(e[n])?(r[n]={},ii(r[n],t[n]),ii(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)nt(t,n)&&!nt(e,n)&&ka(t[n])&&(r[n]=ii({},r[n]));return r}function Fk(t){t!=null&&this.set(t)}var CS;Object.keys?CS=Object.keys:CS=function(t){var e,r=[];for(e in t)nt(t,e)&&r.push(e);return r};var Ute={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zte(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Ur(n)?n.call(e,r):n}function Dr(t,e,r){var n=""+Math.abs(t),o=e-n.length,i=t>=0;return(i?r?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var Wk=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Vp=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,uw={},Bs={};function Pe(t,e,r,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),t&&(Bs[t]=o),e&&(Bs[e[0]]=function(){return Dr(o.apply(this,arguments),e[1],e[2])}),r&&(Bs[r]=function(){return this.localeData().ordinal(o.apply(this,arguments),t)})}function Yte(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Gte(t){var e=t.match(Wk),r,n;for(r=0,n=e.length;r<n;r++)Bs[e[r]]?e[r]=Bs[e[r]]:e[r]=Yte(e[r]);return function(o){var i="",a;for(a=0;a<n;a++)i+=Ur(e[a])?e[a].call(o,t):e[a];return i}}function zy(t,e){return t.isValid()?(e=CF(e,t.localeData()),uw[e]=uw[e]||Gte(e),uw[e](t)):t.localeData().invalidDate()}function CF(t,e){var r=5;function n(o){return e.longDateFormat(o)||o}for(Vp.lastIndex=0;r>=0&&Vp.test(t);)t=t.replace(Vp,n),Vp.lastIndex=0,r-=1;return t}var $te={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Kte(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(Wk).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var qte="Invalid date";function Xte(){return this._invalidDate}var Zte="%d",Qte=/\d{1,2}/;function Jte(t){return this._ordinal.replace("%d",t)}var ene={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function tne(t,e,r,n){var o=this._relativeTime[r];return Ur(o)?o(t,e,r,n):o.replace(/%d/i,t)}function nne(t,e){var r=this._relativeTime[t>0?"future":"past"];return Ur(r)?r(e):r.replace(/%s/i,e)}var lf={};function sn(t,e){var r=t.toLowerCase();lf[r]=lf[r+"s"]=lf[e]=t}function tr(t){return typeof t=="string"?lf[t]||lf[t.toLowerCase()]:void 0}function Uk(t){var e={},r,n;for(n in t)nt(t,n)&&(r=tr(n),r&&(e[r]=t[n]));return e}var OF={};function ln(t,e){OF[t]=e}function rne(t){var e=[],r;for(r in t)nt(t,r)&&e.push({unit:r,priority:OF[r]});return e.sort(function(n,o){return n.priority-o.priority}),e}function hv(t){return t%4===0&&t%100!==0||t%400===0}function Kn(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Xe(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Kn(e)),r}function fc(t,e){return function(r){return r!=null?(kF(this,t,r),J.updateOffset(this,e),this):_m(this,t)}}function _m(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function kF(t,e,r){t.isValid()&&!isNaN(r)&&(e==="FullYear"&&hv(t.year())&&t.month()===1&&t.date()===29?(r=Xe(r),t._d["set"+(t._isUTC?"UTC":"")+e](r,t.month(),vv(r,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](r))}function one(t){return t=tr(t),Ur(this[t])?this[t]():this}function ine(t,e){if(typeof t=="object"){t=Uk(t);var r=rne(t),n,o=r.length;for(n=0;n<o;n++)this[r[n].unit](t[r[n].unit])}else if(t=tr(t),Ur(this[t]))return this[t](e);return this}var RF=/\d/,Wn=/\d\d/,EF=/\d{3}/,zk=/\d{4}/,dv=/[+-]?\d{6}/,St=/\d\d?/,TF=/\d\d\d\d?/,PF=/\d\d\d\d\d\d?/,pv=/\d{1,3}/,Yk=/\d{1,4}/,yv=/[+-]?\d{1,6}/,hc=/\d+/,mv=/[+-]?\d+/,ane=/Z|[+-]\d\d:?\d\d/gi,gv=/Z|[+-]\d\d(?::?\d\d)?/gi,sne=/[+-]?\d+(\.\d{1,3})?/,op=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xm;xm={};function ve(t,e,r){xm[t]=Ur(e)?e:function(n,o){return n&&r?r:e}}function lne(t,e){return nt(xm,t)?xm[t](e._strict,e._locale):new RegExp(une(t))}function une(t){return Ln(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,o,i){return r||n||o||i}))}function Ln(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var OS={};function ft(t,e){var r,n=e,o;for(typeof t=="string"&&(t=[t]),No(e)&&(n=function(i,a){a[e]=Xe(i)}),o=t.length,r=0;r<o;r++)OS[t[r]]=n}function ip(t,e){ft(t,function(r,n,o,i){o._w=o._w||{},e(r,o._w,o,i)})}function cne(t,e,r){e!=null&&nt(OS,t)&&OS[t](e,r._a,r,t)}var on=0,ao=1,Ar=2,qt=3,fr=4,so=5,Xi=6,fne=7,hne=8;function dne(t,e){return(t%e+e)%e}var Ht;Array.prototype.indexOf?Ht=Array.prototype.indexOf:Ht=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function vv(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=dne(e,12);return t+=(e-r)/12,r===1?hv(t)?29:28:31-r%7%2}Pe("M",["MM",2],"Mo",function(){return this.month()+1});Pe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Pe("MMMM",0,0,function(t){return this.localeData().months(this,t)});sn("month","M");ln("month",8);ve("M",St);ve("MM",St,Wn);ve("MMM",function(t,e){return e.monthsShortRegex(t)});ve("MMMM",function(t,e){return e.monthsRegex(t)});ft(["M","MM"],function(t,e){e[ao]=Xe(t)-1});ft(["MMM","MMMM"],function(t,e,r,n){var o=r._locale.monthsParse(t,n,r._strict);o!=null?e[ao]=o:Ue(r).invalidMonth=t});var pne="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),MF="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),_F=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,yne=op,mne=op;function gne(t,e){return t?pr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||_F).test(e)?"format":"standalone"][t.month()]:pr(this._months)?this._months:this._months.standalone}function vne(t,e){return t?pr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[_F.test(e)?"format":"standalone"][t.month()]:pr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bne(t,e,r){var n,o,i,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=Wr([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return r?e==="MMM"?(o=Ht.call(this._shortMonthsParse,a),o!==-1?o:null):(o=Ht.call(this._longMonthsParse,a),o!==-1?o:null):e==="MMM"?(o=Ht.call(this._shortMonthsParse,a),o!==-1?o:(o=Ht.call(this._longMonthsParse,a),o!==-1?o:null)):(o=Ht.call(this._longMonthsParse,a),o!==-1?o:(o=Ht.call(this._shortMonthsParse,a),o!==-1?o:null))}function wne(t,e,r){var n,o,i;if(this._monthsParseExact)return bne.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++)if(o=Wr([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t)||r&&e==="MMM"&&this._shortMonthsParse[n].test(t)||!r&&this._monthsParse[n].test(t))return n}function xF(t,e){var r;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Xe(e);else if(e=t.localeData().monthsParse(e),!No(e))return t}return r=Math.min(t.date(),vv(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,r),t}function AF(t){return t!=null?(xF(this,t),J.updateOffset(this,!0),this):_m(this,"Month")}function Sne(){return vv(this.year(),this.month())}function Cne(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||jF.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(nt(this,"_monthsShortRegex")||(this._monthsShortRegex=yne),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function One(t){return this._monthsParseExact?(nt(this,"_monthsRegex")||jF.call(this),t?this._monthsStrictRegex:this._monthsRegex):(nt(this,"_monthsRegex")||(this._monthsRegex=mne),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function jF(){function t(a,s){return s.length-a.length}var e=[],r=[],n=[],o,i;for(o=0;o<12;o++)i=Wr([2e3,o]),e.push(this.monthsShort(i,"")),r.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(e.sort(t),r.sort(t),n.sort(t),o=0;o<12;o++)e[o]=Ln(e[o]),r[o]=Ln(r[o]);for(o=0;o<24;o++)n[o]=Ln(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Pe("Y",0,0,function(){var t=this.year();return t<=9999?Dr(t,4):"+"+t});Pe(0,["YY",2],0,function(){return this.year()%100});Pe(0,["YYYY",4],0,"year");Pe(0,["YYYYY",5],0,"year");Pe(0,["YYYYYY",6,!0],0,"year");sn("year","y");ln("year",1);ve("Y",mv);ve("YY",St,Wn);ve("YYYY",Yk,zk);ve("YYYYY",yv,dv);ve("YYYYYY",yv,dv);ft(["YYYYY","YYYYYY"],on);ft("YYYY",function(t,e){e[on]=t.length===2?J.parseTwoDigitYear(t):Xe(t)});ft("YY",function(t,e){e[on]=J.parseTwoDigitYear(t)});ft("Y",function(t,e){e[on]=parseInt(t,10)});function uf(t){return hv(t)?366:365}J.parseTwoDigitYear=function(t){return Xe(t)+(Xe(t)>68?1900:2e3)};var IF=fc("FullYear",!0);function kne(){return hv(this.year())}function Rne(t,e,r,n,o,i,a){var s;return t<100&&t>=0?(s=new Date(t+400,e,r,n,o,i,a),isFinite(s.getFullYear())&&s.setFullYear(t)):s=new Date(t,e,r,n,o,i,a),s}function Tf(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Am(t,e,r){var n=7+e-r,o=(7+Tf(t,0,n).getUTCDay()-e)%7;return-o+n-1}function HF(t,e,r,n,o){var i=(7+r-n)%7,a=Am(t,n,o),s=1+7*(e-1)+i+a,l,u;return s<=0?(l=t-1,u=uf(l)+s):s>uf(t)?(l=t+1,u=s-uf(t)):(l=t,u=s),{year:l,dayOfYear:u}}function Pf(t,e,r){var n=Am(t.year(),e,r),o=Math.floor((t.dayOfYear()-n-1)/7)+1,i,a;return o<1?(a=t.year()-1,i=o+jo(a,e,r)):o>jo(t.year(),e,r)?(i=o-jo(t.year(),e,r),a=t.year()+1):(a=t.year(),i=o),{week:i,year:a}}function jo(t,e,r){var n=Am(t,e,r),o=Am(t+1,e,r);return(uf(t)-n+o)/7}Pe("w",["ww",2],"wo","week");Pe("W",["WW",2],"Wo","isoWeek");sn("week","w");sn("isoWeek","W");ln("week",5);ln("isoWeek",5);ve("w",St);ve("ww",St,Wn);ve("W",St);ve("WW",St,Wn);ip(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=Xe(t)});function Ene(t){return Pf(t,this._week.dow,this._week.doy).week}var Tne={dow:0,doy:6};function Pne(){return this._week.dow}function Mne(){return this._week.doy}function _ne(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function xne(t){var e=Pf(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Pe("d",0,"do","day");Pe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Pe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Pe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Pe("e",0,0,"weekday");Pe("E",0,0,"isoWeekday");sn("day","d");sn("weekday","e");sn("isoWeekday","E");ln("day",11);ln("weekday",11);ln("isoWeekday",11);ve("d",St);ve("e",St);ve("E",St);ve("dd",function(t,e){return e.weekdaysMinRegex(t)});ve("ddd",function(t,e){return e.weekdaysShortRegex(t)});ve("dddd",function(t,e){return e.weekdaysRegex(t)});ip(["dd","ddd","dddd"],function(t,e,r,n){var o=r._locale.weekdaysParse(t,n,r._strict);o!=null?e.d=o:Ue(r).invalidWeekday=t});ip(["d","e","E"],function(t,e,r,n){e[n]=Xe(t)});function Ane(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function jne(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Gk(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Ine="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),DF="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Hne="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Dne=op,Nne=op,Lne=op;function Bne(t,e){var r=pr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Gk(r,this._week.dow):t?r[t.day()]:r}function Vne(t){return t===!0?Gk(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Fne(t){return t===!0?Gk(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Wne(t,e,r){var n,o,i,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=Wr([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return r?e==="dddd"?(o=Ht.call(this._weekdaysParse,a),o!==-1?o:null):e==="ddd"?(o=Ht.call(this._shortWeekdaysParse,a),o!==-1?o:null):(o=Ht.call(this._minWeekdaysParse,a),o!==-1?o:null):e==="dddd"?(o=Ht.call(this._weekdaysParse,a),o!==-1||(o=Ht.call(this._shortWeekdaysParse,a),o!==-1)?o:(o=Ht.call(this._minWeekdaysParse,a),o!==-1?o:null)):e==="ddd"?(o=Ht.call(this._shortWeekdaysParse,a),o!==-1||(o=Ht.call(this._weekdaysParse,a),o!==-1)?o:(o=Ht.call(this._minWeekdaysParse,a),o!==-1?o:null)):(o=Ht.call(this._minWeekdaysParse,a),o!==-1||(o=Ht.call(this._weekdaysParse,a),o!==-1)?o:(o=Ht.call(this._shortWeekdaysParse,a),o!==-1?o:null))}function Une(t,e,r){var n,o,i;if(this._weekdaysParseExact)return Wne.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++)if(o=Wr([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t)||r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t)||r&&e==="dd"&&this._minWeekdaysParse[n].test(t)||!r&&this._weekdaysParse[n].test(t))return n}function zne(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=Ane(t,this.localeData()),this.add(t-e,"d")):e}function Yne(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Gne(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=jne(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function $ne(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||$k.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(nt(this,"_weekdaysRegex")||(this._weekdaysRegex=Dne),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Kne(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||$k.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(nt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Nne),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function qne(t){return this._weekdaysParseExact?(nt(this,"_weekdaysRegex")||$k.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(nt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Lne),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function $k(){function t(c,f){return f.length-c.length}var e=[],r=[],n=[],o=[],i,a,s,l,u;for(i=0;i<7;i++)a=Wr([2e3,1]).day(i),s=Ln(this.weekdaysMin(a,"")),l=Ln(this.weekdaysShort(a,"")),u=Ln(this.weekdays(a,"")),e.push(s),r.push(l),n.push(u),o.push(s),o.push(l),o.push(u);e.sort(t),r.sort(t),n.sort(t),o.sort(t),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Kk(){return this.hours()%12||12}function Xne(){return this.hours()||24}Pe("H",["HH",2],0,"hour");Pe("h",["hh",2],0,Kk);Pe("k",["kk",2],0,Xne);Pe("hmm",0,0,function(){return""+Kk.apply(this)+Dr(this.minutes(),2)});Pe("hmmss",0,0,function(){return""+Kk.apply(this)+Dr(this.minutes(),2)+Dr(this.seconds(),2)});Pe("Hmm",0,0,function(){return""+this.hours()+Dr(this.minutes(),2)});Pe("Hmmss",0,0,function(){return""+this.hours()+Dr(this.minutes(),2)+Dr(this.seconds(),2)});function NF(t,e){Pe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}NF("a",!0);NF("A",!1);sn("hour","h");ln("hour",13);function LF(t,e){return e._meridiemParse}ve("a",LF);ve("A",LF);ve("H",St);ve("h",St);ve("k",St);ve("HH",St,Wn);ve("hh",St,Wn);ve("kk",St,Wn);ve("hmm",TF);ve("hmmss",PF);ve("Hmm",TF);ve("Hmmss",PF);ft(["H","HH"],qt);ft(["k","kk"],function(t,e,r){var n=Xe(t);e[qt]=n===24?0:n});ft(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});ft(["h","hh"],function(t,e,r){e[qt]=Xe(t),Ue(r).bigHour=!0});ft("hmm",function(t,e,r){var n=t.length-2;e[qt]=Xe(t.substr(0,n)),e[fr]=Xe(t.substr(n)),Ue(r).bigHour=!0});ft("hmmss",function(t,e,r){var n=t.length-4,o=t.length-2;e[qt]=Xe(t.substr(0,n)),e[fr]=Xe(t.substr(n,2)),e[so]=Xe(t.substr(o)),Ue(r).bigHour=!0});ft("Hmm",function(t,e,r){var n=t.length-2;e[qt]=Xe(t.substr(0,n)),e[fr]=Xe(t.substr(n))});ft("Hmmss",function(t,e,r){var n=t.length-4,o=t.length-2;e[qt]=Xe(t.substr(0,n)),e[fr]=Xe(t.substr(n,2)),e[so]=Xe(t.substr(o))});function Zne(t){return(t+"").toLowerCase().charAt(0)==="p"}var Qne=/[ap]\.?m?\.?/i,Jne=fc("Hours",!0);function ere(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var BF={calendar:Ute,longDateFormat:$te,invalidDate:qte,ordinal:Zte,dayOfMonthOrdinalParse:Qte,relativeTime:ene,months:pne,monthsShort:MF,week:Tne,weekdays:Ine,weekdaysMin:Hne,weekdaysShort:DF,meridiemParse:Qne},Ot={},_c={},Mf;function tre(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function A_(t){return t&&t.toLowerCase().replace("_","-")}function nre(t){for(var e=0,r,n,o,i;e<t.length;){for(i=A_(t[e]).split("-"),r=i.length,n=A_(t[e+1]),n=n?n.split("-"):null;r>0;){if(o=bv(i.slice(0,r).join("-")),o)return o;if(n&&n.length>=r&&tre(i,n)>=r-1)break;r--}e++}return Mf}function rre(t){return t.match("^[^/\\\\]*$")!=null}function bv(t){var e=null,r;if(Ot[t]===void 0&&typeof module<"u"&&module&&module.exports&&rre(t))try{e=Mf._abbr,r=require,r("./locale/"+t),ci(e)}catch{Ot[t]=null}return Ot[t]}function ci(t,e){var r;return t&&(Sn(e)?r=Wo(t):r=qk(t,e),r?Mf=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Mf._abbr}function qk(t,e){if(e!==null){var r,n=BF;if(e.abbr=t,Ot[t]!=null)SF("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ot[t]._config;else if(e.parentLocale!=null)if(Ot[e.parentLocale]!=null)n=Ot[e.parentLocale]._config;else if(r=bv(e.parentLocale),r!=null)n=r._config;else return _c[e.parentLocale]||(_c[e.parentLocale]=[]),_c[e.parentLocale].push({name:t,config:e}),null;return Ot[t]=new Fk(SS(n,e)),_c[t]&&_c[t].forEach(function(o){qk(o.name,o.config)}),ci(t),Ot[t]}else return delete Ot[t],null}function ore(t,e){if(e!=null){var r,n,o=BF;Ot[t]!=null&&Ot[t].parentLocale!=null?Ot[t].set(SS(Ot[t]._config,e)):(n=bv(t),n!=null&&(o=n._config),e=SS(o,e),n==null&&(e.abbr=t),r=new Fk(e),r.parentLocale=Ot[t],Ot[t]=r),ci(t)}else Ot[t]!=null&&(Ot[t].parentLocale!=null?(Ot[t]=Ot[t].parentLocale,t===ci()&&ci(t)):Ot[t]!=null&&delete Ot[t]);return Ot[t]}function Wo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Mf;if(!pr(t)){if(e=bv(t),e)return e;t=[t]}return nre(t)}function ire(){return CS(Ot)}function Xk(t){var e,r=t._a;return r&&Ue(t).overflow===-2&&(e=r[ao]<0||r[ao]>11?ao:r[Ar]<1||r[Ar]>vv(r[on],r[ao])?Ar:r[qt]<0||r[qt]>24||r[qt]===24&&(r[fr]!==0||r[so]!==0||r[Xi]!==0)?qt:r[fr]<0||r[fr]>59?fr:r[so]<0||r[so]>59?so:r[Xi]<0||r[Xi]>999?Xi:-1,Ue(t)._overflowDayOfYear&&(e<on||e>Ar)&&(e=Ar),Ue(t)._overflowWeeks&&e===-1&&(e=fne),Ue(t)._overflowWeekday&&e===-1&&(e=hne),Ue(t).overflow=e),t}var are=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,sre=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lre=/Z|[+-]\d\d(?::?\d\d)?/,Fp=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],cw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ure=/^\/?Date\((-?\d+)/i,cre=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,fre={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function VF(t){var e,r,n=t._i,o=are.exec(n)||sre.exec(n),i,a,s,l,u=Fp.length,c=cw.length;if(o){for(Ue(t).iso=!0,e=0,r=u;e<r;e++)if(Fp[e][1].exec(o[1])){a=Fp[e][0],i=Fp[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(o[3]){for(e=0,r=c;e<r;e++)if(cw[e][1].exec(o[3])){s=(o[2]||" ")+cw[e][0];break}if(s==null){t._isValid=!1;return}}if(!i&&s!=null){t._isValid=!1;return}if(o[4])if(lre.exec(o[4]))l="Z";else{t._isValid=!1;return}t._f=a+(s||"")+(l||""),Qk(t)}else t._isValid=!1}function hre(t,e,r,n,o,i){var a=[dre(t),MF.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(o,10)];return i&&a.push(parseInt(i,10)),a}function dre(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function pre(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function yre(t,e,r){if(t){var n=DF.indexOf(t),o=new Date(e[0],e[1],e[2]).getDay();if(n!==o)return Ue(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function mre(t,e,r){if(t)return fre[t];if(e)return 0;var n=parseInt(r,10),o=n%100,i=(n-o)/100;return i*60+o}function FF(t){var e=cre.exec(pre(t._i)),r;if(e){if(r=hre(e[4],e[3],e[2],e[5],e[6],e[7]),!yre(e[1],r,t))return;t._a=r,t._tzm=mre(e[8],e[9],e[10]),t._d=Tf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ue(t).rfc2822=!0}else t._isValid=!1}function gre(t){var e=ure.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(VF(t),t._isValid===!1)delete t._isValid;else return;if(FF(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:J.createFromInputFallback(t)}J.createFromInputFallback=er("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function _s(t,e,r){return t??e??r}function vre(t){var e=new Date(J.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Zk(t){var e,r,n=[],o,i,a;if(!t._d){for(o=vre(t),t._w&&t._a[Ar]==null&&t._a[ao]==null&&bre(t),t._dayOfYear!=null&&(a=_s(t._a[on],o[on]),(t._dayOfYear>uf(a)||t._dayOfYear===0)&&(Ue(t)._overflowDayOfYear=!0),r=Tf(a,0,t._dayOfYear),t._a[ao]=r.getUTCMonth(),t._a[Ar]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=o[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[qt]===24&&t._a[fr]===0&&t._a[so]===0&&t._a[Xi]===0&&(t._nextDay=!0,t._a[qt]=0),t._d=(t._useUTC?Tf:Rne).apply(null,n),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[qt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==i&&(Ue(t).weekdayMismatch=!0)}}function bre(t){var e,r,n,o,i,a,s,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,a=4,r=_s(e.GG,t._a[on],Pf(bt(),1,4).year),n=_s(e.W,1),o=_s(e.E,1),(o<1||o>7)&&(l=!0)):(i=t._locale._week.dow,a=t._locale._week.doy,u=Pf(bt(),i,a),r=_s(e.gg,t._a[on],u.year),n=_s(e.w,u.week),e.d!=null?(o=e.d,(o<0||o>6)&&(l=!0)):e.e!=null?(o=e.e+i,(e.e<0||e.e>6)&&(l=!0)):o=i),n<1||n>jo(r,i,a)?Ue(t)._overflowWeeks=!0:l!=null?Ue(t)._overflowWeekday=!0:(s=HF(r,n,o,i,a),t._a[on]=s.year,t._dayOfYear=s.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function Qk(t){if(t._f===J.ISO_8601){VF(t);return}if(t._f===J.RFC_2822){FF(t);return}t._a=[],Ue(t).empty=!0;var e=""+t._i,r,n,o,i,a,s=e.length,l=0,u,c;for(o=CF(t._f,t._locale).match(Wk)||[],c=o.length,r=0;r<c;r++)i=o[r],n=(e.match(lne(i,t))||[])[0],n&&(a=e.substr(0,e.indexOf(n)),a.length>0&&Ue(t).unusedInput.push(a),e=e.slice(e.indexOf(n)+n.length),l+=n.length),Bs[i]?(n?Ue(t).empty=!1:Ue(t).unusedTokens.push(i),cne(i,n,t)):t._strict&&!n&&Ue(t).unusedTokens.push(i);Ue(t).charsLeftOver=s-l,e.length>0&&Ue(t).unusedInput.push(e),t._a[qt]<=12&&Ue(t).bigHour===!0&&t._a[qt]>0&&(Ue(t).bigHour=void 0),Ue(t).parsedDateParts=t._a.slice(0),Ue(t).meridiem=t._meridiem,t._a[qt]=wre(t._locale,t._a[qt],t._meridiem),u=Ue(t).era,u!==null&&(t._a[on]=t._locale.erasConvertYear(u,t._a[on])),Zk(t),Xk(t)}function wre(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function Sre(t){var e,r,n,o,i,a,s=!1,l=t._f.length;if(l===0){Ue(t).invalidFormat=!0,t._d=new Date(NaN);return}for(o=0;o<l;o++)i=0,a=!1,e=Vk({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[o],Qk(e),Bk(e)&&(a=!0),i+=Ue(e).charsLeftOver,i+=Ue(e).unusedTokens.length*10,Ue(e).score=i,s?i<n&&(n=i,r=e):(n==null||i<n||a)&&(n=i,r=e,a&&(s=!0));ii(t,r||e)}function Cre(t){if(!t._d){var e=Uk(t._i),r=e.day===void 0?e.date:e.day;t._a=bF([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Zk(t)}}function Ore(t){var e=new rp(Xk(WF(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function WF(t){var e=t._i,r=t._f;return t._locale=t._locale||Wo(t._l),e===null||r===void 0&&e===""?fv({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),yr(e)?new rp(Xk(e)):(np(e)?t._d=e:pr(r)?Sre(t):r?Qk(t):kre(t),Bk(t)||(t._d=null),t))}function kre(t){var e=t._i;Sn(e)?t._d=new Date(J.now()):np(e)?t._d=new Date(e.valueOf()):typeof e=="string"?gre(t):pr(e)?(t._a=bF(e.slice(0),function(r){return parseInt(r,10)}),Zk(t)):ka(e)?Cre(t):No(e)?t._d=new Date(e):J.createFromInputFallback(t)}function UF(t,e,r,n,o){var i={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(ka(t)&&Lk(t)||pr(t)&&t.length===0)&&(t=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=r,i._i=t,i._f=e,i._strict=n,Ore(i)}function bt(t,e,r,n){return UF(t,e,r,n,!1)}var Rre=er("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:fv()}),Ere=er("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=bt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:fv()});function zF(t,e){var r,n;if(e.length===1&&pr(e[0])&&(e=e[0]),!e.length)return bt();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function Tre(){var t=[].slice.call(arguments,0);return zF("isBefore",t)}function Pre(){var t=[].slice.call(arguments,0);return zF("isAfter",t)}var Mre=function(){return Date.now?Date.now():+new Date},xc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function _re(t){var e,r=!1,n,o=xc.length;for(e in t)if(nt(t,e)&&!(Ht.call(xc,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<o;++n)if(t[xc[n]]){if(r)return!1;parseFloat(t[xc[n]])!==Xe(t[xc[n]])&&(r=!0)}return!0}function xre(){return this._isValid}function Are(){return gr(NaN)}function wv(t){var e=Uk(t),r=e.year||0,n=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,a=e.day||0,s=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=_re(e),this._milliseconds=+c+u*1e3+l*6e4+s*1e3*60*60,this._days=+a+i*7,this._months=+o+n*3+r*12,this._data={},this._locale=Wo(),this._bubble()}function Yy(t){return t instanceof wv}function kS(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function jre(t,e,r){var n=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),i=0,a;for(a=0;a<n;a++)(r&&t[a]!==e[a]||!r&&Xe(t[a])!==Xe(e[a]))&&i++;return i+o}function YF(t,e){Pe(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Dr(~~(r/60),2)+e+Dr(~~r%60,2)})}YF("Z",":");YF("ZZ","");ve("Z",gv);ve("ZZ",gv);ft(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Jk(gv,t)});var Ire=/([\+\-]|\d\d)/gi;function Jk(t,e){var r=(e||"").match(t),n,o,i;return r===null?null:(n=r[r.length-1]||[],o=(n+"").match(Ire)||["-",0,0],i=+(o[1]*60)+Xe(o[2]),i===0?0:o[0]==="+"?i:-i)}function eR(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(yr(t)||np(t)?t.valueOf():bt(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),J.updateOffset(r,!1),r):bt(t).local()}function RS(t){return-Math.round(t._d.getTimezoneOffset())}J.updateOffset=function(){};function Hre(t,e,r){var n=this._offset||0,o;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Jk(gv,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(o=RS(this)),this._offset=t,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==t&&(!e||this._changeInProgress?KF(this,gr(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:RS(this)}function Dre(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Nre(t){return this.utcOffset(0,t)}function Lre(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(RS(this),"m")),this}function Bre(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Jk(ane,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Vre(t){return this.isValid()?(t=t?bt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Fre(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Wre(){if(!Sn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Vk(t,this),t=WF(t),t._a?(e=t._isUTC?Wr(t._a):bt(t._a),this._isDSTShifted=this.isValid()&&jre(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ure(){return this.isValid()?!this._isUTC:!1}function zre(){return this.isValid()?this._isUTC:!1}function GF(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Yre=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Gre=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function gr(t,e){var r=t,n=null,o,i,a;return Yy(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:No(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=Yre.exec(t))?(o=n[1]==="-"?-1:1,r={y:0,d:Xe(n[Ar])*o,h:Xe(n[qt])*o,m:Xe(n[fr])*o,s:Xe(n[so])*o,ms:Xe(kS(n[Xi]*1e3))*o}):(n=Gre.exec(t))?(o=n[1]==="-"?-1:1,r={y:ji(n[2],o),M:ji(n[3],o),w:ji(n[4],o),d:ji(n[5],o),h:ji(n[6],o),m:ji(n[7],o),s:ji(n[8],o)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(a=$re(bt(r.from),bt(r.to)),r={},r.ms=a.milliseconds,r.M=a.months),i=new wv(r),Yy(t)&&nt(t,"_locale")&&(i._locale=t._locale),Yy(t)&&nt(t,"_isValid")&&(i._isValid=t._isValid),i}gr.fn=wv.prototype;gr.invalid=Are;function ji(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function j_(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function $re(t,e){var r;return t.isValid()&&e.isValid()?(e=eR(e,t),t.isBefore(e)?r=j_(t,e):(r=j_(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function $F(t,e){return function(r,n){var o,i;return n!==null&&!isNaN(+n)&&(SF(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),o=gr(r,n),KF(this,o,t),this}}function KF(t,e,r,n){var o=e._milliseconds,i=kS(e._days),a=kS(e._months);t.isValid()&&(n=n??!0,a&&xF(t,_m(t,"Month")+a*r),i&&kF(t,"Date",_m(t,"Date")+i*r),o&&t._d.setTime(t._d.valueOf()+o*r),n&&J.updateOffset(t,i||a))}var Kre=$F(1,"add"),qre=$F(-1,"subtract");function qF(t){return typeof t=="string"||t instanceof String}function Xre(t){return yr(t)||np(t)||qF(t)||No(t)||Qre(t)||Zre(t)||t===null||t===void 0}function Zre(t){var e=ka(t)&&!Lk(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,a=n.length;for(o=0;o<a;o+=1)i=n[o],r=r||nt(t,i);return e&&r}function Qre(t){var e=pr(t),r=!1;return e&&(r=t.filter(function(n){return!No(n)&&qF(t)}).length===0),e&&r}function Jre(t){var e=ka(t)&&!Lk(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],r=r||nt(t,i);return e&&r}function eoe(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function toe(t,e){arguments.length===1&&(arguments[0]?Xre(arguments[0])?(t=arguments[0],e=void 0):Jre(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||bt(),n=eR(r,this).startOf("day"),o=J.calendarFormat(this,n)||"sameElse",i=e&&(Ur(e[o])?e[o].call(this,r):e[o]);return this.format(i||this.localeData().calendar(o,this,bt(r)))}function noe(){return new rp(this)}function roe(t,e){var r=yr(t)?t:bt(t);return this.isValid()&&r.isValid()?(e=tr(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function ooe(t,e){var r=yr(t)?t:bt(t);return this.isValid()&&r.isValid()?(e=tr(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function ioe(t,e,r,n){var o=yr(t)?t:bt(t),i=yr(e)?e:bt(e);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,r):!this.isBefore(o,r))&&(n[1]===")"?this.isBefore(i,r):!this.isAfter(i,r))):!1}function aoe(t,e){var r=yr(t)?t:bt(t),n;return this.isValid()&&r.isValid()?(e=tr(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function soe(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function loe(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function uoe(t,e,r){var n,o,i;if(!this.isValid())return NaN;if(n=eR(t,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,e=tr(e),e){case"year":i=Gy(this,n)/12;break;case"month":i=Gy(this,n);break;case"quarter":i=Gy(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return r?i:Kn(i)}function Gy(t,e){if(t.date()<e.date())return-Gy(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),o,i;return e-n<0?(o=t.clone().add(r-1,"months"),i=(e-n)/(n-o)):(o=t.clone().add(r+1,"months"),i=(e-n)/(o-n)),-(r+i)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function coe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function foe(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?zy(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ur(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",zy(r,"Z")):zy(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function hoe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,o,i;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(r+n+o+i)}function doe(t){t||(t=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=zy(this,t);return this.localeData().postformat(e)}function poe(t,e){return this.isValid()&&(yr(t)&&t.isValid()||bt(t).isValid())?gr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function yoe(t){return this.from(bt(),t)}function moe(t,e){return this.isValid()&&(yr(t)&&t.isValid()||bt(t).isValid())?gr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function goe(t){return this.to(bt(),t)}function XF(t){var e;return t===void 0?this._locale._abbr:(e=Wo(t),e!=null&&(this._locale=e),this)}var ZF=er("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function QF(){return this._locale}var jm=1e3,Vs=60*jm,Im=60*Vs,JF=(365*400+97)*24*Im;function Fs(t,e){return(t%e+e)%e}function eW(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-JF:new Date(t,e,r).valueOf()}function tW(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-JF:Date.UTC(t,e,r)}function voe(t){var e,r;if(t=tr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?tW:eW,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Fs(e+(this._isUTC?0:this.utcOffset()*Vs),Im);break;case"minute":e=this._d.valueOf(),e-=Fs(e,Vs);break;case"second":e=this._d.valueOf(),e-=Fs(e,jm);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function boe(t){var e,r;if(t=tr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?tW:eW,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Im-Fs(e+(this._isUTC?0:this.utcOffset()*Vs),Im)-1;break;case"minute":e=this._d.valueOf(),e+=Vs-Fs(e,Vs)-1;break;case"second":e=this._d.valueOf(),e+=jm-Fs(e,jm)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function woe(){return this._d.valueOf()-(this._offset||0)*6e4}function Soe(){return Math.floor(this.valueOf()/1e3)}function Coe(){return new Date(this.valueOf())}function Ooe(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function koe(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Roe(){return this.isValid()?this.toISOString():null}function Eoe(){return Bk(this)}function Toe(){return ii({},Ue(this))}function Poe(){return Ue(this).overflow}function Moe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Pe("N",0,0,"eraAbbr");Pe("NN",0,0,"eraAbbr");Pe("NNN",0,0,"eraAbbr");Pe("NNNN",0,0,"eraName");Pe("NNNNN",0,0,"eraNarrow");Pe("y",["y",1],"yo","eraYear");Pe("y",["yy",2],0,"eraYear");Pe("y",["yyy",3],0,"eraYear");Pe("y",["yyyy",4],0,"eraYear");ve("N",tR);ve("NN",tR);ve("NNN",tR);ve("NNNN",Voe);ve("NNNNN",Foe);ft(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var o=r._locale.erasParse(t,n,r._strict);o?Ue(r).era=o:Ue(r).invalidEra=t});ve("y",hc);ve("yy",hc);ve("yyy",hc);ve("yyyy",hc);ve("yo",Woe);ft(["y","yy","yyy","yyyy"],on);ft(["yo"],function(t,e,r,n){var o;r._locale._eraYearOrdinalRegex&&(o=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[on]=r._locale.eraYearOrdinalParse(t,o):e[on]=parseInt(t,10)});function _oe(t,e){var r,n,o,i=this._eras||Wo("en")._eras;for(r=0,n=i.length;r<n;++r){switch(typeof i[r].since){case"string":o=J(i[r].since).startOf("day"),i[r].since=o.valueOf();break}switch(typeof i[r].until){case"undefined":i[r].until=1/0;break;case"string":o=J(i[r].until).startOf("day").valueOf(),i[r].until=o.valueOf();break}}return i}function xoe(t,e,r){var n,o,i=this.eras(),a,s,l;for(t=t.toUpperCase(),n=0,o=i.length;n<o;++n)if(a=i[n].name.toUpperCase(),s=i[n].abbr.toUpperCase(),l=i[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(s===t)return i[n];break;case"NNNN":if(a===t)return i[n];break;case"NNNNN":if(l===t)return i[n];break}else if([a,s,l].indexOf(t)>=0)return i[n]}function Aoe(t,e){var r=t.since<=t.until?1:-1;return e===void 0?J(t.since).year():J(t.since).year()+(e-t.offset)*r}function joe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function Ioe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function Hoe(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function Doe(){var t,e,r,n,o=this.localeData().eras();for(t=0,e=o.length;t<e;++t)if(r=o[t].since<=o[t].until?1:-1,n=this.clone().startOf("day").valueOf(),o[t].since<=n&&n<=o[t].until||o[t].until<=n&&n<=o[t].since)return(this.year()-J(o[t].since).year())*r+o[t].offset;return this.year()}function Noe(t){return nt(this,"_erasNameRegex")||nR.call(this),t?this._erasNameRegex:this._erasRegex}function Loe(t){return nt(this,"_erasAbbrRegex")||nR.call(this),t?this._erasAbbrRegex:this._erasRegex}function Boe(t){return nt(this,"_erasNarrowRegex")||nR.call(this),t?this._erasNarrowRegex:this._erasRegex}function tR(t,e){return e.erasAbbrRegex(t)}function Voe(t,e){return e.erasNameRegex(t)}function Foe(t,e){return e.erasNarrowRegex(t)}function Woe(t,e){return e._eraYearOrdinalRegex||hc}function nR(){var t=[],e=[],r=[],n=[],o,i,a=this.eras();for(o=0,i=a.length;o<i;++o)e.push(Ln(a[o].name)),t.push(Ln(a[o].abbr)),r.push(Ln(a[o].narrow)),n.push(Ln(a[o].name)),n.push(Ln(a[o].abbr)),n.push(Ln(a[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Pe(0,["gg",2],0,function(){return this.weekYear()%100});Pe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Sv(t,e){Pe(0,[t,t.length],0,e)}Sv("gggg","weekYear");Sv("ggggg","weekYear");Sv("GGGG","isoWeekYear");Sv("GGGGG","isoWeekYear");sn("weekYear","gg");sn("isoWeekYear","GG");ln("weekYear",1);ln("isoWeekYear",1);ve("G",mv);ve("g",mv);ve("GG",St,Wn);ve("gg",St,Wn);ve("GGGG",Yk,zk);ve("gggg",Yk,zk);ve("GGGGG",yv,dv);ve("ggggg",yv,dv);ip(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=Xe(t)});ip(["gg","GG"],function(t,e,r,n){e[n]=J.parseTwoDigitYear(t)});function Uoe(t){return nW.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function zoe(t){return nW.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Yoe(){return jo(this.year(),1,4)}function Goe(){return jo(this.isoWeekYear(),1,4)}function $oe(){var t=this.localeData()._week;return jo(this.year(),t.dow,t.doy)}function Koe(){var t=this.localeData()._week;return jo(this.weekYear(),t.dow,t.doy)}function nW(t,e,r,n,o){var i;return t==null?Pf(this,n,o).year:(i=jo(t,n,o),e>i&&(e=i),qoe.call(this,t,e,r,n,o))}function qoe(t,e,r,n,o){var i=HF(t,e,r,n,o),a=Tf(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Pe("Q",0,"Qo","quarter");sn("quarter","Q");ln("quarter",7);ve("Q",RF);ft("Q",function(t,e){e[ao]=(Xe(t)-1)*3});function Xoe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Pe("D",["DD",2],"Do","date");sn("date","D");ln("date",9);ve("D",St);ve("DD",St,Wn);ve("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ft(["D","DD"],Ar);ft("Do",function(t,e){e[Ar]=Xe(t.match(St)[0])});var rW=fc("Date",!0);Pe("DDD",["DDDD",3],"DDDo","dayOfYear");sn("dayOfYear","DDD");ln("dayOfYear",4);ve("DDD",pv);ve("DDDD",EF);ft(["DDD","DDDD"],function(t,e,r){r._dayOfYear=Xe(t)});function Zoe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Pe("m",["mm",2],0,"minute");sn("minute","m");ln("minute",14);ve("m",St);ve("mm",St,Wn);ft(["m","mm"],fr);var Qoe=fc("Minutes",!1);Pe("s",["ss",2],0,"second");sn("second","s");ln("second",15);ve("s",St);ve("ss",St,Wn);ft(["s","ss"],so);var Joe=fc("Seconds",!1);Pe("S",0,0,function(){return~~(this.millisecond()/100)});Pe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Pe(0,["SSS",3],0,"millisecond");Pe(0,["SSSS",4],0,function(){return this.millisecond()*10});Pe(0,["SSSSS",5],0,function(){return this.millisecond()*100});Pe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Pe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Pe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Pe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});sn("millisecond","ms");ln("millisecond",16);ve("S",pv,RF);ve("SS",pv,Wn);ve("SSS",pv,EF);var ai,oW;for(ai="SSSS";ai.length<=9;ai+="S")ve(ai,hc);function eie(t,e){e[Xi]=Xe(("0."+t)*1e3)}for(ai="S";ai.length<=9;ai+="S")ft(ai,eie);oW=fc("Milliseconds",!1);Pe("z",0,0,"zoneAbbr");Pe("zz",0,0,"zoneName");function tie(){return this._isUTC?"UTC":""}function nie(){return this._isUTC?"Coordinated Universal Time":""}var oe=rp.prototype;oe.add=Kre;oe.calendar=toe;oe.clone=noe;oe.diff=uoe;oe.endOf=boe;oe.format=doe;oe.from=poe;oe.fromNow=yoe;oe.to=moe;oe.toNow=goe;oe.get=one;oe.invalidAt=Poe;oe.isAfter=roe;oe.isBefore=ooe;oe.isBetween=ioe;oe.isSame=aoe;oe.isSameOrAfter=soe;oe.isSameOrBefore=loe;oe.isValid=Eoe;oe.lang=ZF;oe.locale=XF;oe.localeData=QF;oe.max=Ere;oe.min=Rre;oe.parsingFlags=Toe;oe.set=ine;oe.startOf=voe;oe.subtract=qre;oe.toArray=Ooe;oe.toObject=koe;oe.toDate=Coe;oe.toISOString=foe;oe.inspect=hoe;typeof Symbol<"u"&&Symbol.for!=null&&(oe[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});oe.toJSON=Roe;oe.toString=coe;oe.unix=Soe;oe.valueOf=woe;oe.creationData=Moe;oe.eraName=joe;oe.eraNarrow=Ioe;oe.eraAbbr=Hoe;oe.eraYear=Doe;oe.year=IF;oe.isLeapYear=kne;oe.weekYear=Uoe;oe.isoWeekYear=zoe;oe.quarter=oe.quarters=Xoe;oe.month=AF;oe.daysInMonth=Sne;oe.week=oe.weeks=_ne;oe.isoWeek=oe.isoWeeks=xne;oe.weeksInYear=$oe;oe.weeksInWeekYear=Koe;oe.isoWeeksInYear=Yoe;oe.isoWeeksInISOWeekYear=Goe;oe.date=rW;oe.day=oe.days=zne;oe.weekday=Yne;oe.isoWeekday=Gne;oe.dayOfYear=Zoe;oe.hour=oe.hours=Jne;oe.minute=oe.minutes=Qoe;oe.second=oe.seconds=Joe;oe.millisecond=oe.milliseconds=oW;oe.utcOffset=Hre;oe.utc=Nre;oe.local=Lre;oe.parseZone=Bre;oe.hasAlignedHourOffset=Vre;oe.isDST=Fre;oe.isLocal=Ure;oe.isUtcOffset=zre;oe.isUtc=GF;oe.isUTC=GF;oe.zoneAbbr=tie;oe.zoneName=nie;oe.dates=er("dates accessor is deprecated. Use date instead.",rW);oe.months=er("months accessor is deprecated. Use month instead",AF);oe.years=er("years accessor is deprecated. Use year instead",IF);oe.zone=er("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Dre);oe.isDSTShifted=er("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Wre);function rie(t){return bt(t*1e3)}function oie(){return bt.apply(null,arguments).parseZone()}function iW(t){return t}var rt=Fk.prototype;rt.calendar=zte;rt.longDateFormat=Kte;rt.invalidDate=Xte;rt.ordinal=Jte;rt.preparse=iW;rt.postformat=iW;rt.relativeTime=tne;rt.pastFuture=nne;rt.set=Wte;rt.eras=_oe;rt.erasParse=xoe;rt.erasConvertYear=Aoe;rt.erasAbbrRegex=Loe;rt.erasNameRegex=Noe;rt.erasNarrowRegex=Boe;rt.months=gne;rt.monthsShort=vne;rt.monthsParse=wne;rt.monthsRegex=One;rt.monthsShortRegex=Cne;rt.week=Ene;rt.firstDayOfYear=Mne;rt.firstDayOfWeek=Pne;rt.weekdays=Bne;rt.weekdaysMin=Fne;rt.weekdaysShort=Vne;rt.weekdaysParse=Une;rt.weekdaysRegex=$ne;rt.weekdaysShortRegex=Kne;rt.weekdaysMinRegex=qne;rt.isPM=Zne;rt.meridiem=ere;function Hm(t,e,r,n){var o=Wo(),i=Wr().set(n,e);return o[r](i,t)}function aW(t,e,r){if(No(t)&&(e=t,t=void 0),t=t||"",e!=null)return Hm(t,e,r,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Hm(t,n,r,"month");return o}function rR(t,e,r,n){typeof t=="boolean"?(No(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,No(e)&&(r=e,e=void 0),e=e||"");var o=Wo(),i=t?o._week.dow:0,a,s=[];if(r!=null)return Hm(e,(r+i)%7,n,"day");for(a=0;a<7;a++)s[a]=Hm(e,(a+i)%7,n,"day");return s}function iie(t,e){return aW(t,e,"months")}function aie(t,e){return aW(t,e,"monthsShort")}function sie(t,e,r){return rR(t,e,r,"weekdays")}function lie(t,e,r){return rR(t,e,r,"weekdaysShort")}function uie(t,e,r){return rR(t,e,r,"weekdaysMin")}ci("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=Xe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});J.lang=er("moment.lang is deprecated. Use moment.locale instead.",ci);J.langData=er("moment.langData is deprecated. Use moment.localeData instead.",Wo);var Gr=Math.abs;function cie(){var t=this._data;return this._milliseconds=Gr(this._milliseconds),this._days=Gr(this._days),this._months=Gr(this._months),t.milliseconds=Gr(t.milliseconds),t.seconds=Gr(t.seconds),t.minutes=Gr(t.minutes),t.hours=Gr(t.hours),t.months=Gr(t.months),t.years=Gr(t.years),this}function sW(t,e,r,n){var o=gr(e,r);return t._milliseconds+=n*o._milliseconds,t._days+=n*o._days,t._months+=n*o._months,t._bubble()}function fie(t,e){return sW(this,t,e,1)}function hie(t,e){return sW(this,t,e,-1)}function I_(t){return t<0?Math.floor(t):Math.ceil(t)}function die(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,o,i,a,s,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=I_(ES(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,o=Kn(t/1e3),n.seconds=o%60,i=Kn(o/60),n.minutes=i%60,a=Kn(i/60),n.hours=a%24,e+=Kn(a/24),l=Kn(lW(e)),r+=l,e-=I_(ES(l)),s=Kn(r/12),r%=12,n.days=e,n.months=r,n.years=s,this}function lW(t){return t*4800/146097}function ES(t){return t*146097/4800}function pie(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=tr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+lW(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(ES(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function yie(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Xe(this._months/12)*31536e6:NaN}function Uo(t){return function(){return this.as(t)}}var mie=Uo("ms"),gie=Uo("s"),vie=Uo("m"),bie=Uo("h"),wie=Uo("d"),Sie=Uo("w"),Cie=Uo("M"),Oie=Uo("Q"),kie=Uo("y");function Rie(){return gr(this)}function Eie(t){return t=tr(t),this.isValid()?this[t+"s"]():NaN}function qa(t){return function(){return this.isValid()?this._data[t]:NaN}}var Tie=qa("milliseconds"),Pie=qa("seconds"),Mie=qa("minutes"),_ie=qa("hours"),xie=qa("days"),Aie=qa("months"),jie=qa("years");function Iie(){return Kn(this.days()/7)}var no=Math.round,Ds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Hie(t,e,r,n,o){return o.relativeTime(e||1,!!r,t,n)}function Die(t,e,r,n){var o=gr(t).abs(),i=no(o.as("s")),a=no(o.as("m")),s=no(o.as("h")),l=no(o.as("d")),u=no(o.as("M")),c=no(o.as("w")),f=no(o.as("y")),h=i<=r.ss&&["s",i]||i<r.s&&["ss",i]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||c<=1&&["w"]||c<r.w&&["ww",c]),h=h||u<=1&&["M"]||u<r.M&&["MM",u]||f<=1&&["y"]||["yy",f],h[2]=e,h[3]=+t>0,h[4]=n,Hie.apply(null,h)}function Nie(t){return t===void 0?no:typeof t=="function"?(no=t,!0):!1}function Lie(t,e){return Ds[t]===void 0?!1:e===void 0?Ds[t]:(Ds[t]=e,t==="s"&&(Ds.ss=e-1),!0)}function Bie(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Ds,o,i;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Ds,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),o=this.localeData(),i=Die(this,!r,n,o),r&&(i=o.pastFuture(+this,i)),o.postformat(i)}var fw=Math.abs;function os(t){return(t>0)-(t<0)||+t}function Cv(){if(!this.isValid())return this.localeData().invalidDate();var t=fw(this._milliseconds)/1e3,e=fw(this._days),r=fw(this._months),n,o,i,a,s=this.asSeconds(),l,u,c,f;return s?(n=Kn(t/60),o=Kn(n/60),t%=60,n%=60,i=Kn(r/12),r%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=s<0?"-":"",u=os(this._months)!==os(s)?"-":"",c=os(this._days)!==os(s)?"-":"",f=os(this._milliseconds)!==os(s)?"-":"",l+"P"+(i?u+i+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(o||n||t?"T":"")+(o?f+o+"H":"")+(n?f+n+"M":"")+(t?f+a+"S":"")):"P0D"}var Qe=wv.prototype;Qe.isValid=xre;Qe.abs=cie;Qe.add=fie;Qe.subtract=hie;Qe.as=pie;Qe.asMilliseconds=mie;Qe.asSeconds=gie;Qe.asMinutes=vie;Qe.asHours=bie;Qe.asDays=wie;Qe.asWeeks=Sie;Qe.asMonths=Cie;Qe.asQuarters=Oie;Qe.asYears=kie;Qe.valueOf=yie;Qe._bubble=die;Qe.clone=Rie;Qe.get=Eie;Qe.milliseconds=Tie;Qe.seconds=Pie;Qe.minutes=Mie;Qe.hours=_ie;Qe.days=xie;Qe.weeks=Iie;Qe.months=Aie;Qe.years=jie;Qe.humanize=Bie;Qe.toISOString=Cv;Qe.toString=Cv;Qe.toJSON=Cv;Qe.locale=XF;Qe.localeData=QF;Qe.toIsoString=er("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Cv);Qe.lang=ZF;Pe("X",0,0,"unix");Pe("x",0,0,"valueOf");ve("x",mv);ve("X",sne);ft("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});ft("x",function(t,e,r){r._d=new Date(Xe(t))});//! moment.js
J.version="2.29.4";Vte(bt);J.fn=oe;J.min=Tre;J.max=Pre;J.now=Mre;J.utc=Wr;J.unix=rie;J.months=iie;J.isDate=np;J.locale=ci;J.invalid=fv;J.duration=gr;J.isMoment=yr;J.weekdays=sie;J.parseZone=oie;J.localeData=Wo;J.isDuration=Yy;J.monthsShort=aie;J.weekdaysMin=uie;J.defineLocale=qk;J.updateLocale=ore;J.locales=ire;J.weekdaysShort=lie;J.normalizeUnits=tr;J.relativeTimeRounding=Nie;J.relativeTimeThreshold=Lie;J.calendarFormat=eoe;J.prototype=oe;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Vie=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function it(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var o=an(t,function(i,a,s){var l=a.replace(/\r?\n\s*/g,""),u=r[s]?r[s]:"";return i+l+u},"");return o.trim()}var H_,D_,N_,L_,B_,V_;function Ws(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function TS(t){"@babel/helpers - typeof";return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TS(t)}function Dt(t){var e;switch(TS(t)){case"string":case"number":e="".concat(t);break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function pe(t){return typeof t<"u"}function dt(t){return typeof t>"u"}function Xt(t){return t===null||t===""||dt(t)}function Fie(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var tf="length",cf=function(t){return parseInt(t,16)},F_=function(t){return parseInt(t,10)},Dm=function(t,e,r){return t.substr(e,r)},ff=function(t){return t.codePointAt(0)-65},PS=function(t){return"".concat(t).replace(/\-/g,"")},Wie=function(t){return cf(Dm(PS(t),cf("12"),ff("F")))/(cf(Dm(PS(t),ff("B"),~~![][tf]))||9)},Uie=function(){return typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},W_=!1,U_={invalid:function(){return it(H_||(H_=Ws([`
    The license key for Handsontable is invalid. 
    If you need any help, contact us at support@handsontable.com.`],[`
    The license key for Handsontable is invalid.\\x20
    If you need any help, contact us at support@handsontable.com.`])))},expired:function(t){var e=t.keyValidityDate,r=t.hotVersion;return it(D_||(D_=Ws([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior 
    to `,". If you need any help, contact us at sales@handsontable.com."],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. Renew your license key at handsontable.com or downgrade to a version released prior\\x20
    to `,". If you need any help, contact us at sales@handsontable.com."])),e,r,e)},missing:function(){return it(N_||(N_=Ws([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact 
    us at support@handsontable.com.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20
    us at support@handsontable.com.`])))},non_commercial:function(){return""}},z_={invalid:function(){return it(L_||(L_=Ws([`
    The license key for Handsontable is invalid. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to 
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is invalid.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},expired:function(t){var e=t.keyValidityDate,r=t.hotVersion;return it(B_||(B_=Ws([`
    The license key for Handsontable expired on `,`, and is not valid for the installed 
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your 
    license key or downgrade to a version released prior to `,`. If you need any 
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`],[`
    The license key for Handsontable expired on `,`, and is not valid for the installed\\x20
    version `,`. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20
    license key or downgrade to a version released prior to `,`. If you need any\\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`])),e,r,e)},missing:function(){return it(V_||(V_=Ws([`
    The license key for Handsontable is missing. Use your purchased key to activate the product. 
    Alternatively, you can activate Handsontable to use for non-commercial purposes by 
    passing the key: 'non-commercial-and-evaluation'. 
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in 
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`],[`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20
    passing the key: 'non-commercial-and-evaluation'.\\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`])))},non_commercial:function(){return""}};function zie(t,e){var r=!Xt(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",o="12.4.0",i,a="invalid",s="invalid";t=PS(t||"");var l=Yie(t);if(r||n||l)if(l){var u=J("23/05/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),f=Wie(t);i=J((f+1)*864e5,"x").format("MMMM DD, YYYY"),c>f?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(Uie()&&(a="valid",s="valid"),!W_&&a!=="valid"){var h=U_[a]({keyValidityDate:i,hotVersion:o});h&&console[a==="non_commercial"?"info":"warn"](U_[a]({keyValidityDate:i,hotVersion:o})),W_=!0}if(s!=="valid"&&e.parentNode){var p=z_[s]({keyValidityDate:i,hotVersion:o});if(p){var y=document.createElement("div");y.className="hot-display-license-info",y.innerHTML=z_[s]({keyValidityDate:i,hotVersion:o}),e.parentNode.insertBefore(y,e.nextSibling)}}}function Yie(t){var e=[][tf],r=e;if(t[tf]!==ff("Z"))return!1;for(var n="",o="B<H4P+".split(""),i=ff(o.shift());i;i=ff(o.shift()||"A"))--i<""[tf]?r=r|(F_("".concat(F_(cf(n)+(cf(Dm(t,Math.abs(i),2))+[]).padStart(2,"0"))))%97||2)>>1:n=Dm(t,i,i?o[tf]===1?9:8:6);return r===e}function hr(t){return t[0].toUpperCase()+t.substr(1)}function uW(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function cW(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function fW(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return"".concat(t).replace(/(?:\\)?\[([^[\]]+)]/g,function(r,n){return r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n]})}function Y_(t){return oR("".concat(t),{ALLOWED_TAGS:[]})}function oR(t,e){return Ste.sanitize(t,e)}function G_(t){return qie(t)||Kie(t)||$ie(t)||Gie()}function Gie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ie(t,e){if(t){if(typeof t=="string")return MS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MS(t,e)}}function Kie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qie(t){if(Array.isArray(t))return MS(t)}function MS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xie(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,o=t;o!==null;){if(r===e){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(r+=1,o=o.parentNode)}return n}function Zie(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Nm(t){return Zie(t)&&t.parent}function Ra(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,n=Node,o=n.ELEMENT_NODE,i=n.DOCUMENT_FRAGMENT_NODE,a=t;a!=null&&a!==r;){var s=a,l=s.nodeType,u=s.nodeName;if(l===o&&(e.includes(u)||e.includes(a)))return a;var c=a,f=c.host;f&&l===i?a=f:a=a.parentNode}return null}function Wp(t,e,r){for(var n=[],o=t;o&&(o=Ra(o,e,r),!(!o||r&&!r.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;var i=n.length;return i?n[i-1]:null}function Ea(t,e){var r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function Qie(t){var e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Ii(t,e,r){var n=r.parentElement.querySelector(".ht_clone_".concat(t));return n?n.contains(e):null}var _S,xS,AS;function Up(t){return!t||!t.length?[]:t.filter(function(e){return!!e})}if(XJ()){var $_=function(t){var e=t.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")};_S=function(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)},xS=function(t,e){var r=t.ownerDocument,n=e;if(typeof n=="string"&&(n=n.split(" ")),n=Up(n),n.length>0)if($_(r)){var o;(o=t.classList).add.apply(o,G_(n))}else for(var i=0;n[i];)t.classList.add(n[i]),i+=1},AS=function(t,e){var r=t.ownerDocument,n=e;if(typeof n=="string"&&(n=n.split(" ")),n=Up(n),n.length>0)if($_(r)){var o;(o=t.classList).remove.apply(o,G_(n))}else for(var i=0;n[i];)t.classList.remove(n[i]),i+=1}}else{var hw=function(t){return new RegExp("(\\s|^)".concat(t,"(\\s|$)"))};_S=function(t,e){return t.className!==void 0&&hw(e).test(t.className)},xS=function(t,e){var r=t.className,n=e;if(typeof n=="string"&&(n=n.split(" ")),n=Up(n),r==="")r=n.join(" ");else for(var o=0;o<n.length;o++)n[o]&&!hw(n[o]).test(r)&&(r+=" ".concat(n[o]));t.className=r},AS=function(t,e){var r=0,n=t.className,o=e;for(typeof o=="string"&&(o=o.split(" ")),o=Up(o);o[r];)n=n.replace(hw(o[r])," ").trim(),r+=1;t.className!==n&&(t.className=n)}}function Ae(t,e){return _S(t,e)}function te(t,e){xS(t,e)}function Ne(t,e){AS(t,e)}function hW(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var e=t.childNodes,r=e.length-1;r>=0;r--)hW(e[r])}function Nr(t){for(var e;e=t.lastChild;)t.removeChild(e)}var Jie=/(<(.*)>|&(.*);)/;function dc(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Jie.test(e)?t.innerHTML=r?oR(e):e:Pa(t,e)}function Pa(t,e){var r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?ZJ?r.textContent=e:r.data=e:(Nr(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function _f(t){for(var e=t.ownerDocument.documentElement,r=t;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return _f(r.host.impl);if(r.host)return _f(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.style&&r.style.display==="none")return!1;r=r.parentNode}return!0}function Wt(t){var e=t.ownerDocument,r=e.defaultView,n=e.documentElement,o=t,i,a,s,l;if(lF()&&o.firstChild&&o.firstChild.nodeName==="CAPTION")return l=o.getBoundingClientRect(),{top:l.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:l.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)};for(i=o.offsetLeft,a=o.offsetTop,s=o;(o=o.offsetParent)&&o!==e.body;)i+=o.offsetLeft,a+=o.offsetTop,s=o;return s&&s.style.position==="fixed"&&(i+=r.pageXOffset||n.scrollLeft,a+=r.pageYOffset||n.scrollTop),{left:i,top:a}}function xf(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollY;return e===void 0&&(e=t.document.documentElement.scrollTop),e}function nl(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.scrollX;return e===void 0&&(e=t.document.documentElement.scrollLeft),e}function Lm(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?xf(e):t.scrollTop}function jS(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?nl(e):t.scrollLeft}function Bm(t){var e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);for(var n=["auto","scroll"],o=QJ(),i=t.parentNode;i&&i.style&&e.body!==i;){var a=i.style,s=a.overflow,l=a.overflowX,u=a.overflowY;if([s,l,u].includes("scroll"))return i;if(o){var c=r.getComputedStyle(i);if(s=c.overflow,l=c.overflowX,u=c.overflowY,n.includes(s)||n.includes(l)||n.includes(u))return i}if(i.clientHeight<=i.scrollHeight+1&&(n.includes(u)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(l)||n.includes(s)))return i;i=i.parentNode}return r}function rl(t){for(var e=t.ownerDocument,r=e.defaultView,n=t.parentNode;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;var o=Ma(n,r),i=["scroll","hidden","auto"],a=o.getPropertyValue("overflow"),s=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(a)||i.includes(s)||i.includes(l))return n;n=n.parentNode}return r}function Af(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?"".concat(r.innerWidth,"px"):e==="height"?"".concat(r.innerHeight,"px"):void 0}else return;var n=t.style[e];if(n!==""&&n!==void 0)return n;var o=Ma(t,r);if(o[e]!==""&&o[e]!==void 0)return o[e]}function Ma(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ut(t){return t.offsetWidth}function Rt(t){return lF()&&t.firstChild&&t.firstChild.nodeName==="CAPTION"?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight}function si(t){return t.clientHeight||t.innerHeight}function $y(t){return t.clientWidth||t.innerWidth}function dW(t){var e=t.ownerDocument;if(t.selectionStart)return t.selectionStart;if(e.selection){t.focus();var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange(),o=n.duplicate();return n.moveToBookmark(r.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function eae(t){var e=t.ownerDocument;if(t.selectionEnd)return t.selectionEnd;if(e.selection){var r=e.selection.createRange();if(r===null)return 0;var n=t.createTextRange();return n.text.indexOf(r.text)+r.text.length}return 0}function tae(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document,r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function K_(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window,e=t.document;t.getSelection?t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges():e.selection&&e.selection.empty()}function Ov(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{var n=t.parentNode,o=n.style.display;n.style.display="block",t.setSelectionRange(e,r),n.style.display=o}}}var dw;function nae(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";var r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);var n=e.offsetWidth;r.style.overflow="scroll";var o=e.offsetWidth;return n===o&&(o=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-o}function en(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return dw===void 0&&(dw=nae(t)),dw}function rae(t){return t.offsetWidth!==t.clientWidth}function oae(t){return t.offsetHeight!==t.clientHeight}function iR(t,e,r){Gee()?(t.style.top=r,t.style.left=e):Uee()?t.style["-webkit-transform"]="translate3d(".concat(e,",").concat(r,",0)"):t.style.transform="translate3d(".concat(e,",").concat(r,",0)")}function kv(t){t.style.transform&&t.style.transform!==""?t.style.transform="":t.style["-webkit-transform"]&&t.style["-webkit-transform"]!==""&&(t.style["-webkit-transform"]="")}function Vm(t){var e=["INPUT","SELECT","TEXTAREA"];return t&&(e.indexOf(t.nodeName)>-1||t.contentEditable==="true")}function aR(t){return Vm(t)&&t.hasAttribute("data-hot-input")===!1}function iae(t){var e=t.ownerDocument.activeElement;aR(e)||t.select()}function pW(t){return!t.parentNode}function aae(t,e){var r=new IntersectionObserver(function(n,o){n.forEach(function(i){i.isIntersecting&&t.offsetParent!==null&&(e(),o.unobserve(t))})},{root:t.ownerDocument.body});r.observe(t)}function yt(t){return typeof t=="function"}function yW(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function o(){for(var i=this,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(function(){n=t.apply(i,s)},e),n}return o}function mW(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return t.apply(this,r.concat(i))}}function sae(t){var e=t.length;function r(n){return function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=n.concat(i),l;return s.length>=e?l=t.apply(this,s):l=r(s),l}}return r([])}function IS(t,e,r,n,o,i,a,s){return pe(s)?t.call(e,r,n,o,i,a,s):pe(a)?t.call(e,r,n,o,i,a):pe(i)?t.call(e,r,n,o,i):pe(o)?t.call(e,r,n,o):pe(n)?t.call(e,r,n):pe(r)?t.call(e,r):t.call(e)}function lt(){if(pe(console)){var t;(t=console).warn.apply(t,arguments)}}function sR(){if(pe(console)){var t;(t=console).error.apply(t,arguments)}}var lae=We,q_=pk,zp=Xd.getWeakData,uae=hk,cae=At,fae=mr,pw=Lt,hae=fk,gW=$a,X_=Et,vW=Vo,dae=vW.set,pae=vW.getterFor,yae=gW.find,mae=gW.findIndex,gae=lae([].splice),vae=0,Yp=function(t){return t.frozen||(t.frozen=new bW)},bW=function(){this.entries=[]},yw=function(t,e){return yae(t.entries,function(r){return r[0]===e})};bW.prototype={get:function(t){var e=yw(this,t);if(e)return e[1]},has:function(t){return!!yw(this,t)},set:function(t,e){var r=yw(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=mae(this.entries,function(r){return r[0]===t});return~e&&gae(this.entries,e,1),!!~e}};var wW={getConstructor:function(t,e,r,n){var o=t(function(l,u){uae(l,i),dae(l,{type:e,id:vae++,frozen:void 0}),fae(u)||hae(u,l[n],{that:l,AS_ENTRIES:r})}),i=o.prototype,a=pae(e),s=function(l,u,c){var f=a(l),h=zp(cae(u),!0);return h===!0?Yp(f).set(u,c):h[f.id]=c,l};return q_(i,{delete:function(l){var u=a(this);if(!pw(l))return!1;var c=zp(l);return c===!0?Yp(u).delete(l):c&&X_(c,u.id)&&delete c[u.id]},has:function(l){var u=a(this);if(!pw(l))return!1;var c=zp(l);return c===!0?Yp(u).has(l):c&&X_(c,u.id)}}),q_(i,r?{get:function(l){var u=a(this);if(pw(l)){var c=zp(l);return c===!0?Yp(u).get(l):c?c[u.id]:void 0}},set:function(l,u){return s(this,l,u)}}:{add:function(l){return s(this,l,!0)}}),o}},bae=nk,Z_=ct,Ky=We,Q_=pk,wae=Xd,Sae=nv,SW=wW,Gp=Lt,$p=Vo.enforce,Cae=Fe,Oae=hB,ap=Object,kae=Array.isArray,Kp=ap.isExtensible,CW=ap.isFrozen,Rae=ap.isSealed,OW=ap.freeze,Eae=ap.seal,J_={},ex={},Tae=!Z_.ActiveXObject&&"ActiveXObject"in Z_,Ac,kW=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},RW=Sae("WeakMap",kW,SW),xs=RW.prototype,qy=Ky(xs.set),Pae=function(){return bae&&Cae(function(){var t=OW([]);return qy(new RW,t,1),!CW(t)})};if(Oae)if(Tae){Ac=SW.getConstructor(kW,"WeakMap",!0),wae.enable();var tx=Ky(xs.delete),qp=Ky(xs.has),nx=Ky(xs.get);Q_(xs,{delete:function(t){if(Gp(t)&&!Kp(t)){var e=$p(this);return e.frozen||(e.frozen=new Ac),tx(this,t)||e.frozen.delete(t)}return tx(this,t)},has:function(t){if(Gp(t)&&!Kp(t)){var e=$p(this);return e.frozen||(e.frozen=new Ac),qp(this,t)||e.frozen.has(t)}return qp(this,t)},get:function(t){if(Gp(t)&&!Kp(t)){var e=$p(this);return e.frozen||(e.frozen=new Ac),qp(this,t)?nx(this,t):e.frozen.get(t)}return nx(this,t)},set:function(t,e){if(Gp(t)&&!Kp(t)){var r=$p(this);r.frozen||(r.frozen=new Ac),qp(this,t)?qy(this,t,e):r.frozen.set(t,e)}else qy(this,t,e);return this}})}else Pae()&&Q_(xs,{set:function(t,e){var r;return kae(t)&&(CW(t)?r=J_:Rae(t)&&(r=ex)),qy(this,t,e),r==J_&&OW(t),r==ex&&Eae(t),this}});var Ce={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:tw()?182:174,AUDIO_MUTE:tw()?181:173,AUDIO_UP:tw()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Mae=[Ce.ALT,Ce.ARROW_DOWN,Ce.ARROW_LEFT,Ce.ARROW_RIGHT,Ce.ARROW_UP,Ce.AUDIO_DOWN,Ce.AUDIO_MUTE,Ce.AUDIO_UP,Ce.BACKSPACE,Ce.CAPS_LOCK,Ce.DELETE,Ce.END,Ce.ENTER,Ce.ESCAPE,Ce.F1,Ce.F2,Ce.F3,Ce.F4,Ce.F5,Ce.F6,Ce.F7,Ce.F8,Ce.F9,Ce.F10,Ce.F11,Ce.F12,Ce.F13,Ce.F14,Ce.F15,Ce.F16,Ce.F17,Ce.F18,Ce.F19,Ce.HOME,Ce.INSERT,Ce.MEDIA_NEXT,Ce.MEDIA_PLAY_PAUSE,Ce.MEDIA_PREV,Ce.MEDIA_STOP,Ce.NULL,Ce.NUM_LOCK,Ce.PAGE_DOWN,Ce.PAGE_UP,Ce.PAUSE,Ce.SCROLL_LOCK,Ce.SHIFT,Ce.TAB];function _ae(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function EW(t){return Mae.includes(t)}function xae(t){return[Ce.CONTROL,Ce.COMMAND_LEFT,Ce.COMMAND_RIGHT,Ce.COMMAND_FIREFOX].includes(t)}function jf(t,e){var r=e.split("|"),n=!1;return _(r,function(o){if(t===Ce[o])return n=!0,!1}),n}function Lr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function As(t){return t.isImmediatePropagationEnabled===!1}function _a(t){return t.button===2}function lR(t){return t.button===0}function If(t){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},If(t)}var rx;function Aae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ox(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Iae(n.key),n)}}function jae(t,e,r){return e&&ox(t.prototype,e),r&&ox(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Iae(t){var e=Hae(t,"string");return If(e)==="symbol"?e:String(e)}function Hae(t,e){if(If(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(If(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dae(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var is=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Nae=it(rx||(rx=Dae([`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. 
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to 
  learn about the migration path.`],[`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20
  learn about the migration path.`]))),mw=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),gw=new Map([["beforeAutofillInsidePopulate",'The plugin hook "beforeAutofillInsidePopulate" is deprecated and will be removed in the next major release.']]),TW=function(){function t(){Aae(this,t),this.globalBucket=this.createEmptyBucket()}return jae(t,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return _(is,function(r){return e[r]=[]}),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(r))_(r,function(s){return n.add(e,s,o)});else{mw.has(e)&&lt(fW(Nae,{hookName:e,removedInVersion:mw.get(e)})),gw.has(e)&&lt(gw.get(e));var i=this.getBucket(o);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),r.skip=!1,i[e].indexOf(r)===-1){var a=!1;r.initialHook&&_(i[e],function(s,l){if(s.initialHook)return i[e][l]=r,a=!0,!1}),a||i[e].push(r)}}return this}},{key:"once",value:function(e,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(r)?_(r,function(i){return n.once(e,i,o)}):(r.runOnce=!0,this.add(e,r,o))}},{key:"remove",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,o=this.getBucket(n);return typeof o[e]<"u"&&o[e].indexOf(r)>=0?(r.skip=!0,!0):!1}},{key:"has",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=this.getBucket(r);return!!(n[e]!==void 0&&n[e].length)}},{key:"run",value:function(e,r,n,o,i,a,s,l){{var u=this.globalBucket[r],c=u?u.length:0,f=0;if(c)for(;f<c;){if(!u[f]||u[f].skip){f+=1;continue}var h=IS(u[f],e,n,o,i,a,s,l);h!==void 0&&(n=h),u[f]&&u[f].runOnce&&this.remove(r,u[f]),f+=1}}{var p=this.getBucket(e)[r],y=p?p.length:0,g=0;if(y)for(;g<y;){if(!p[g]||p[g].skip){g+=1;continue}var v=IS(p[g],e,n,o,i,a,s,l);v!==void 0&&(n=v),p[g]&&p[g].runOnce&&this.remove(r,p[g],e),g+=1}}return n}},{key:"destroy",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;$e(this.getBucket(e),function(r,n,o){return o[n].length=0})}},{key:"register",value:function(e){this.isRegistered(e)||is.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&is.splice(is.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return gw.has(e)||mw.has(e)}},{key:"isRegistered",value:function(e){return is.indexOf(e)>=0}},{key:"getRegistered",value:function(){return is}}],[{key:"getSingleton",value:function(){return Bae()}}]),t}(),Lae=new TW;function Bae(){return Lae}const ye=TW;function ix(t){return Uae(t)||Wae(t)||Fae(t)||Vae()}function Vae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fae(t,e){if(t){if(typeof t=="string")return HS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HS(t,e)}}function Wae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Uae(t){if(Array.isArray(t))return HS(t)}function HS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var vw=new Map;function nr(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";vw.has(t)||vw.set(t,new Map);var e=vw.get(t);function r(s,l){e.set(s,l)}function n(s){return e.get(s)}function o(s){return e.has(s)}function i(){return ix(e.keys())}function a(){return ix(e.values())}return{register:r,getItem:n,hasItem:o,getNames:i,getValues:a}}var DS=new WeakMap,sp=nr("editors"),zae=sp.register,PW=sp.getItem,MW=sp.hasItem;sp.getNames;sp.getValues;function Yae(t){var e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},ye.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function _W(t,e){var r;if(typeof t=="function")DS.get(t)||Hn(null,t),r=DS.get(t);else if(typeof t=="string")r=PW(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error('No editor registered under name "'.concat(t,'"'));return r.getInstance(e)}function ax(t){if(typeof t=="function")return t;if(!MW(t))throw Error('No registered editor found under "'.concat(t,'" name'));return PW(t).getConstructor()}function Hn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);var r=new Yae(e);typeof t=="string"&&zae(t,r),DS.set(e,r)}function Hf(t){"@babel/helpers - typeof";return Hf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hf(t)}function Gae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kae(n.key),n)}}function $ae(t,e,r){return e&&sx(t.prototype,e),r&&sx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kae(t){var e=qae(t,"string");return Hf(e)==="symbol"?e:String(e)}function qae(t,e){if(Hf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xae=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Gae(this,t),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}return $ae(t,[{key:"addEventListener",value:function(e,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function a(s){n.call(this,Zae(s))}return typeof i!="boolean"&&!tee()&&(i=!1),this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:a,options:i,eventManager:this}),e.addEventListener(r,a,i),function(){o.removeEventListener(e,r,n)}}},{key:"removeEventListener",value:function(e,r,n){for(var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,a;i;)if(i-=1,a=this.context.eventListeners[i],a.event===r&&a.element===e){if(n&&n!==a.callback||o&&a.eventManager!==this)continue;this.context.eventListeners.splice(i,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.context)for(var r=this.context.eventListeners.length;r;){r-=1;var n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options))}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,r){var n=e.document,o=e;n||(n=e.ownerDocument?e.ownerDocument:e,o=n.defaultView);var i={bubbles:!0,cancelable:r!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},a;n.createEvent?(a=n.createEvent("MouseEvents"),a.initMouseEvent(r,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):a=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent("on".concat(r),a)}}]),t}();function Zae(t){var e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Lr(this)},t}const Tt=Xae;function Df(t){"@babel/helpers - typeof";return Df=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Df(t)}function Qae(t,e){return nse(t)||tse(t,e)||ese(t,e)||Jae()}function Jae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ese(t,e){if(t){if(typeof t=="string")return lx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lx(t,e)}}function lx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tse(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function nse(t){if(Array.isArray(t))return t}function rse(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ux(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ise(n.key),n)}}function ose(t,e,r){return e&&ux(t.prototype,e),r&&ux(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ise(t){var e=ase(t,"string");return Df(e)==="symbol"?e:String(e)}function ase(t,e){if(Df(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Df(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rv="editorManager.navigation",hf="editorManager.handlingEditor",NS=function(){function t(e,r,n){var o=this;rse(this,t),this.instance=e,this.tableMeta=r,this.selection=n,this.eventManager=new Tt(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0;var i=this.instance.getShortcutManager();i.addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",function(a){return o.onAfterDocumentKeyDown(a)}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",function(a){!o.destroyed&&o.instance.isListening()&&o.openEditor("",a)}),this.instance.view._wt.update("onCellDblClick",function(a,s,l){return o.onCellDblClick(a,s,l)})}return ose(t,[{key:"registerShortcuts",value:function(){var e=this,r=this.instance.getShortcutManager(),n=r.getContext("grid"),o=r.getContext("editor"),i={group:hf};o.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(a,s){e.closeEditorAndSaveChanges(r.isCtrlPressed()),e.moveSelectionAfterEnter(s.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(r.isCtrlPressed()),e.activeEditor.focus()}}],i),n.addShortcuts([{keys:[["F2"]],callback:function(a){e.openEditor(null,a,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(a,s){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.openEditor(null,a,!0):e.moveSelectionAfterEnter(s.includes("shift")),Lr(a)}}],i)}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock){if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,function(y){y&&e.prepareEditor()});return}var r=this.instance.getSelectedRangeLast().highlight,n=r.row,o=r.col,i=this.instance.runHooks("modifyGetCellCoords",n,o),a=n,s=o;if(Array.isArray(i)){var l=Qae(i,2);a=l[0],s=l[1]}this.cellProperties=this.instance.getCellMeta(a,s);var u=this.instance.rootDocument.activeElement;if(u&&aR(u)&&u.blur(),!this.isCellEditable()){this.clearActiveEditor();return}var c=this.instance.getCell(n,o,!0);if(c){var f=this.instance.getCellEditor(this.cellProperties),h=this.instance.colToProp(s),p=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(a),s);this.activeEditor=_W(f,this.instance),this.activeEditor.prepare(n,o,h,c,p,this.cellProperties)}}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){var o=this.instance.getSelectedRangeLast().highlight,i=o.row,a=o.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(i),l=this.instance.columnIndexMapper.getRenderableFromVisualIndex(a);this.instance.view.scrollViewport(this.instance._createCellCoords(s,l)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}},{key:"closeEditor",value:function(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var e=this.instance.getCellEditor(this.cellProperties),r=this.instance.getSelectedRangeLast().highlight,n=r.row,o=r.col,i=this.instance,a=i.rowIndexMapper,s=i.columnIndexMapper,l=a.isHidden(this.instance.toPhysicalRow(n))||s.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!e||l)}},{key:"moveSelectionAfterEnter",value:function(e){var r=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-r.row,-r.col):this.selection.transformStart(r.row,r.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var r=this;if(this.instance.isListening()){var n=e.keyCode;if(this.selection.isSelected()){var o=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!EW(n)&&!xae(n)&&!o&&!this.isEditorOpened()){var i=this.instance.getShortcutManager(),a=i.getContext("editor"),s={runOnlyIf:function(){return pe(r.instance.getSelected())},group:Rv};a.addShortcuts([{keys:[["ArrowUp"]],callback:function(){r.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){r.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){r.instance.selection.transformStart(0,-1*r.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){r.instance.selection.transformStart(0,r.instance.getDirectionFactor())}}],s),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,r,n){n.nodeName==="TD"&&this.openEditor(null,e,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),t}(),cx=new WeakMap;NS.getInstance=function(t,e,r){var n=cx.get(t);return n||(n=new NS(t,e,r),cx.set(t,n)),n};const sse=NS;var lse=_e,use=Tn,xW=Ud,cse=Fe,fse=cse(function(){xW(1)});lse({target:"Object",stat:!0,forced:fse},{keys:function(t){return xW(use(t))}});var hse=_e,dse=Nk;hse({target:"String",proto:!0},{repeat:dse});var pse=Gt,yse=sv,mse=At,gse=mr,vse=Ga,bw=Bt,bse=En,wse=Ua,Sse=kk,fx=lv;yse("match",function(t,e,r){return[function(n){var o=bse(this),i=gse(n)?void 0:wse(n,t);return i?pse(i,n,o):new RegExp(n)[t](bw(o))},function(n){var o=mse(this),i=bw(n),a=r(e,o,i);if(a.done)return a.value;if(!o.global)return fx(o,i);var s=o.unicode;o.lastIndex=0;for(var l=[],u=0,c;(c=fx(o,i))!==null;){var f=bw(c[0]);l[u]=f,f===""&&(o.lastIndex=Sse(i,vse(o.lastIndex),s)),u++}return u===0?null:l}]});var Cse=Ka,Ose=Fn,kse=Ri,Rse=Jn,Ese=cc,Tse=Math.min,LS=[].lastIndexOf,AW=!!LS&&1/[1].lastIndexOf(1,-0)<0,Pse=Ese("lastIndexOf"),Mse=AW||!Pse,_se=Mse?function(t){if(AW)return Cse(LS,this,arguments)||0;var e=Ose(this),r=Rse(e),n=r-1;for(arguments.length>1&&(n=Tse(n,kse(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:LS,xse=_e,hx=_se;xse({target:"Array",proto:!0,forced:hx!==[].lastIndexOf},{lastIndexOf:hx});var Ase=Wa,jse=Tn,Ise=Hd,Hse=Jn,Dse=TypeError,dx=function(t){return function(e,r,n,o){Ase(r);var i=jse(e),a=Ise(i),s=Hse(i),l=t?s-1:0,u=t?-1:1;if(n<2)for(;;){if(l in a){o=a[l],l+=u;break}if(l+=u,t?l<0:s<=l)throw Dse("Reduce of empty array with no initial value")}for(;t?l>=0:s>l;l+=u)l in a&&(o=r(o,a[l],l,i));return o}},Nse={left:dx(!1),right:dx(!0)},Lse=_e,Bse=Nse.left,Vse=cc,px=Dd,Fse=XV,Wse=!Fse&&px>79&&px<83,Use=Wse||!Vse("reduce");Lse({target:"Array",proto:!0,forced:Use},{reduce:function(t){var e=arguments.length;return Bse(this,t,e,e>1?arguments[1]:void 0)}});var zse=_e,Yse=$a.findIndex,Gse=Zd,BS="findIndex",jW=!0;BS in[]&&Array(1)[BS](function(){jW=!1});zse({target:"Array",proto:!0,forced:jW},{findIndex:function(t){return Yse(this,t,arguments.length>1?arguments[1]:void 0)}});Gse(BS);function ww(t){return Xse(t)||qse(t)||Kse(t)||$se()}function $se(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kse(t,e){if(t){if(typeof t=="string")return VS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return VS(t,e)}}function qse(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Xse(t){if(Array.isArray(t))return VS(t)}function VS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var IW={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Zse=new RegExp(Object.keys(IW).map(function(t){return"(".concat(t,")")}).join("|"),"gi");function Qse(t){return(t&&t.nodeName||"")==="TABLE"}function yx(t){for(var e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData.apply(t,n),i=o.length,a=i>0?o[0].length:0,s=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,f=e?1:0,h=0;h<i;h+=1){for(var p=e&&h===0,y=[],g=0;g<a;g+=1){var v=!p&&r&&g===0,S="";if(p)S="<th>".concat(t.getColHeader(g-c),"</th>");else if(v)S="<th>".concat(t.getRowHeader(h-f),"</th>");else{var O=o[h][g],w=t.getCellMeta(h-f,g-c),x=w.hidden,T=w.rowspan,z=w.colspan;if(!x){var $=[];if(T&&$.push('rowspan="'.concat(T,'"')),z&&$.push('colspan="'.concat(z,'"')),Xt(O))S="<td ".concat($.join(" "),"></td>");else{var ne=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S="<td ".concat($.join(" "),">").concat(ne,"</td>")}}}y.push(S)}var G=["<tr>"].concat(y,["</tr>"]).join("");p?l.splice(1,0,G):u.splice(-1,0,G)}return s.splice(1,0,l.join(""),u.join("")),s.join("")}function mx(t){for(var e=t.length,r=["<table>"],n=0;n<e;n+=1){var o=t[n],i=o.length,a=[];n===0&&r.push("<tbody>");for(var s=0;s<i;s+=1){var l=o[s],u=Xt(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,function(c){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(c.length-1)," </span>")}).replace(/\t/gi,"&#9;");a.push("<td>".concat(u,"</td>"))}r.push.apply(r,["<tr>"].concat(a,["</tr>"])),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function Jse(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,r={},n=e.createDocumentFragment(),o=e.createElement("div");n.appendChild(o);var i=t;if(typeof i=="string"){var a=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,function(k){var E=k.match(/<td\b[^>]*?>/g)[0],A=k.substring(E.length,k.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,""),W="</td>";return"".concat(E).concat(A).concat(W)});o.insertAdjacentHTML("afterbegin","".concat(a)),i=o.querySelector("table")}if(!(!i||!Qse(i))){var s=o.querySelector('meta[name$="enerator"]'),l=i.querySelector("tbody th")!==null,u=i.querySelector("tr"),c=u?Array.from(u.cells).reduce(function(k,E){return k+E.colSpan},0)-(l?1:0):0,f=i.tFoot&&Array.from(i.tFoot.rows)||[],h=[],p=!1,y=0,g=0;if(i.tHead){var v=Array.from(i.tHead.rows).filter(function(k){var E=k.querySelector("td")!==null;return E&&h.push(k),!E});y=v.length,p=y>0,y>1?r.nestedHeaders=Array.from(v).reduce(function(k,E){var A=Array.from(E.cells).reduce(function(W,N,K){if(l&&K===0)return W;var X=N.colSpan,re=N.innerHTML,me=X>1?{label:re,colspan:X}:re;return W.push(me),W},[]);return k.push(A),k},[]):p&&(r.colHeaders=Array.from(v[0].children).reduce(function(k,E,A){return l&&A===0||k.push(E.innerHTML),k},[]))}h.length&&(r.fixedRowsTop=h.length),f.length&&(r.fixedRowsBottom=f.length);var S=[].concat(h,ww(Array.from(i.tBodies).reduce(function(k,E){return k.push.apply(k,ww(Array.from(E.rows))),k},[])),ww(f));g=S.length;for(var O=new Array(g),w=0;w<g;w++)O[w]=new Array(c);for(var x=[],T=[],z=0;z<g;z++)for(var $=S[z],ne=Array.from($.cells),G=ne.length,q=0;q<G;q++){var Z=ne[q],ee=Z.nodeName,Q=Z.innerHTML,ce=Z.rowSpan,fe=Z.colSpan,we=O[z].findIndex(function(k){return k===void 0});if(ee==="TD"){if(ce>1||fe>1){for(var Se=z;Se<z+ce;Se++)if(Se<g)for(var P=we;P<we+fe;P++)O[Se][P]=null;var d=Z.getAttribute("style"),m=d&&d.includes("mso-ignore:colspan");m||x.push({col:we,row:z,rowspan:ce,colspan:fe})}var b="";s&&/excel/gi.test(s.content)?b=Q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):b=Q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),O[z][we]=b.replace(Zse,function(k){return IW[k]})}else T.push(Q)}return x.length&&(r.mergeCells=x),T.length&&(r.rowHeaders=T),O.length&&(r.data=O),r}}function ele(t){return ole(t)||rle(t)||nle(t)||tle()}function tle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nle(t,e){if(t){if(typeof t=="string")return FS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FS(t,e)}}function rle(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ole(t){if(Array.isArray(t))return FS(t)}function FS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function WS(t){"@babel/helpers - typeof";return WS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},WS(t)}function kn(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=WS(t);if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);var n=Array.from(new Set(["."].concat(ele(e)))).map(function(o){return"\\".concat(o)}).join("|");return new RegExp("^[+-]?\\s*(((".concat(n,")?\\d+((").concat(n,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function ile(t){return kn(t,[","])}function Oe(t,e,r){var n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function US(t,e,r){var n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function HW(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ale(t){return ule(t)||lle(t)||DW(t)||sle()}function sle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lle(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ule(t){if(Array.isArray(t))return zS(t)}function cle(t,e){return dle(t)||hle(t,e)||DW(t,e)||fle()}function fle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DW(t,e){if(t){if(typeof t=="string")return zS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zS(t,e)}}function zS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hle(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function dle(t){if(Array.isArray(t))return t}var YS="asc",ple="desc",gx=new Map([[YS,[-1,1]],[ple,[1,-1]]]),yle=function(t){return"The priority '".concat(t,"' is already declared in a map.")},mle=function(t){return"The priority '".concat(t,"' is not a number.")};function gle(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorPriorityExists,r=t.errorPriorityNaN,n=new Map;e=yt(e)?e:yle,r=yt(r)?r:mle;function o(a,s){if(!kn(a))throw new Error(r(a));if(n.has(a))throw new Error(e(a));n.set(a,s)}function i(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YS,s=gx.get(a)||gx.get(YS),l=cle(s,2),u=l[0],c=l[1];return ale(n).sort(function(f,h){return f[0]<h[0]?u:c}).map(function(f){return f[1]})}return{addItem:o,getItems:i}}var vle=_e,ble=$a.find,wle=Zd,GS="find",NW=!0;GS in[]&&Array(1)[GS](function(){NW=!1});vle({target:"Array",proto:!0,forced:NW},{find:function(t){return ble(this,t,arguments.length>1?arguments[1]:void 0)}});wle(GS);function Sle(t){return kle(t)||Ole(t)||LW(t)||Cle()}function Cle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ole(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function kle(t){if(Array.isArray(t))return $S(t)}function vx(t,e){return Tle(t)||Ele(t,e)||LW(t,e)||Rle()}function Rle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LW(t,e){if(t){if(typeof t=="string")return $S(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(t,e)}}function $S(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ele(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Tle(t){if(Array.isArray(t))return t}var Ple=function(t){return"The id '".concat(t,"' is already declared in a map.")};function Ev(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorIdExists,r=new Map;e=yt(e)?e:Ple;function n(c,f){if(u(c))throw new Error(e(c));r.set(c,f)}function o(c){return r.delete(c)}function i(){r.clear()}function a(c){var f=l().find(function(y){var g=vx(y,2),v=g[0],S=g[1];return c===S?v:!1})||[null],h=vx(f,1),p=h[0];return p}function s(c){return r.get(c)}function l(){return Sle(r)}function u(c){return r.has(c)}return{addItem:n,clear:i,getId:a,getItem:s,getItems:l,hasItem:u,removeItem:o}}function Mle(t){return jle(t)||Ale(t)||xle(t)||_le()}function _le(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xle(t,e){if(t){if(typeof t=="string")return KS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KS(t,e)}}function Ale(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function jle(t){if(Array.isArray(t))return KS(t)}function KS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Ile=function(t){return"'".concat(t,"' value is already declared in a unique set.")};function Hle(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.errorItemExists,r=new Set;e=yt(e)?e:Ile;function n(a){if(r.has(a))throw new Error(e(a));r.add(a)}function o(){return Mle(r)}function i(){r.clear()}return{addItem:n,clear:i,getItems:o}}function Dle(t,e){return Ble(t)||Lle(t,e)||BW(t,e)||Nle()}function Nle(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lle(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Ble(t){if(Array.isArray(t))return t}function bx(t){return Wle(t)||Fle(t)||BW(t)||Vle()}function Vle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BW(t,e){if(t){if(typeof t=="string")return qS(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qS(t,e)}}function Fle(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Wle(t){if(Array.isArray(t))return qS(t)}function qS(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var uR=function(t){return'There is already registered "'.concat(t,'" plugin.')},Ule=function(t){return'There is already registered plugin on priority "'.concat(t,'".')},zle=function(t){return'The priority "'.concat(t,'" is not a number.')},VW=gle({errorPriorityExists:Ule,errorPriorityNaN:zle}),FW=Hle({errorItemExists:uR}),XS=Ev({errorIdExists:uR});function WW(){return[].concat(bx(VW.getItems()),bx(FW.getItems()))}function cR(t){var e=hr(t);return XS.getItem(e)}function Yle(t){return!!cR(t)}function Je(t,e,r){var n=$le(t,e,r),o=Dle(n,3);t=o[0],e=o[1],r=o[2],cR(t)===void 0&&Gle(t,e,r)}function Gle(t,e,r){var n=hr(t);if(XS.hasItem(n))throw new Error(uR(n));r===void 0?FW.addItem(n):VW.addItem(r,n),XS.addItem(n,e)}function $le(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}var lp=nr("renderers"),Kle=lp.register,qle=lp.getItem,UW=lp.hasItem;lp.getNames;lp.getValues;function wx(t){if(typeof t=="function")return t;if(!UW(t))throw Error('No registered renderer found under "'.concat(t,'" name'));return qle(t)}function eo(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Kle(t,e)}var up=nr("validators"),Xle=up.register,Zle=up.getItem,zW=up.hasItem;up.getNames;up.getValues;function Qle(t){if(typeof t=="function")return t;if(!zW(t))throw Error('No registered validator found under "'.concat(t,'" name'));return Zle(t)}function nf(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Xle(t,e)}var qi=1,rn=2;function Nf(t){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nf(t)}function Jle(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,tue(n.key),n)}}function eue(t,e,r){return e&&Sx(t.prototype,e),r&&Sx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tue(t){var e=nue(t,"string");return Nf(e)==="symbol"?e:String(e)}function nue(t,e){if(Nf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var as=new WeakMap,rue=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.stretchMode,u=e.stretchingItemWidthFn,c=u===void 0?function(h){return h}:u,f=e.inlineStartOffset;Jle(this,t),as.set(this,{viewportWidth:r,scrollOffset:n,totalColumns:o,columnWidthFn:i,overrideFn:a,calculationType:s,stretchingColumnWidthFn:c,inlineStartOffset:f}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return eue(t,[{key:"calculate",value:function(){for(var e=0,r=!0,n=[],o,i=0,a=0,s=as.get(this),l=s.calculationType,u=s.overrideFn,c=s.scrollOffset,f=Math.max(s.scrollOffset,0),h=s.totalColumns,p=s.viewportWidth,y=f>0?p+1:p,g=0;g<h;g++)if(o=this._getColumnWidth(g),e<=f&&l!==rn&&(this.startColumn=g,i=o),e>=f&&e+(l===rn?o:0)<=f+y&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=g,i=o),this.endColumn=g),n.push(e),e+=o,a=o,l!==rn&&(this.endColumn=g),e>=f+p){r=!1;break}var v=c+p-y,S=l===rn?0:a,O=l===rn?i:0;if(v<-1*s.inlineStartOffset||c>n.at(-1)+S||-1*s.scrollOffset-s.viewportWidth>-1*O?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===h-1&&r)for(this.startColumn=this.endColumn;this.startColumn>0;){var w=n[this.endColumn]+o-n[this.startColumn-1];if((w<=p||l!==rn)&&(this.startColumn-=1),w>p)break}l===qi&&this.startColumn!==null&&u&&u(this),this.startPosition=n[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),h<this.endColumn&&(this.endColumn=h-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if(this.stretch!=="none"){var r=e;this.totalTargetWidth=r;for(var n=as.get(this),o=n.totalColumns,i=0,a=0;a<o;a++){var s=this._getColumnWidth(a),l=n.stretchingColumnWidthFn(void 0,a);typeof l=="number"?r-=l:i+=s}var u=r-i;if(this.stretch==="all"&&u>0)this.stretchAllRatio=r/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&r!==1/0){var c=this._getColumnWidth(o-1),f=u+c;this.stretchLastWidth=f>=0?f:c}}}},{key:"getStretchedColumnWidth",value:function(e,r){var n=null;return this.stretch==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,r):this.stretch==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,r){var n=0,o=as.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var a=Math.round(r*this.stretchAllRatio),s=o.stretchingColumnWidthFn(a,e);s===void 0?this.stretchAllColumnsWidth[e]=a:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){var r=as.get(this),n=r.totalColumns;return e===n-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(e){var r=as.get(this).columnWidthFn(e);return isNaN(r)&&(r=t.DEFAULT_WIDTH),r}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),t}();const fR=rue;function Lf(t){"@babel/helpers - typeof";return Lf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lf(t)}function oue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aue(n.key),n)}}function iue(t,e,r){return e&&Cx(t.prototype,e),r&&Cx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aue(t){var e=sue(t,"string");return Lf(e)==="symbol"?e:String(e)}function sue(t,e){if(Lf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Lf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ox=new WeakMap,lue=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.viewportSize,n=e.scrollOffset,o=e.totalItems,i=e.itemSizeFn,a=e.overrideFn,s=e.calculationType,l=e.scrollbarHeight;oue(this,t),Ox.set(this,{viewportHeight:r,scrollOffset:n,totalRows:o,rowHeightFn:i,overrideFn:a,calculationType:s,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return iue(t,[{key:"calculate",value:function(){for(var e=Ox.get(this),r=e.calculationType,n=e.overrideFn,o=e.rowHeightFn,i=e.scrollOffset,a=Math.max(e.scrollOffset,0),s=e.totalRows,l=e.viewportHeight,u=e.horizontalScrollbarHeight||0,c=0,f=!0,h=[],p,y=0,g=0,v=0;v<s;v++)if(p=o(v),isNaN(p)&&(p=t.DEFAULT_HEIGHT),c<=a&&r!==rn&&(this.startRow=v,y=p),c>=a&&c+(r===rn?p:0)<=a+l-u&&(this.startRow===null&&(this.startRow=v,y=p),this.endRow=v),h.push(c),c+=p,g=p,r!==rn&&(this.endRow=v),c>=a+l-u){f=!1;break}var S=i+l-u,O=r===rn?y:0,w=r===rn?0:g;if(S<O||i>h.at(-1)+w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===s-1&&f)for(this.startRow=this.endRow;this.startRow>0;){var x=h[this.endRow]+p-h[this.startRow-1];if((x<=l-u||r!==rn)&&(this.startRow-=1),x>=l-u)break}r===qi&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),t}();const YW=lue;function Bf(t){"@babel/helpers - typeof";return Bf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bf(t)}function uue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,GW(n.key),n)}}function cue(t,e,r){return e&&kx(t.prototype,e),r&&kx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function fue(t,e,r){hue(t,e),e.set(t,r)}function hue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rx(t,e,r){return e=GW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GW(t){var e=due(t,"string");return Bf(e)==="symbol"?e:String(e)}function due(t,e){if(Bf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jc(t,e){var r=$W(t,e,"get");return pue(t,r)}function pue(t,e){return e.get?e.get.call(t):e.value}function yue(t,e,r){var n=$W(t,e,"set");return mue(t,n,r),r}function $W(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function mue(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Hi=new WeakMap,gue=function(){function t(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;uue(this,t),Rx(this,"row",null),Rx(this,"col",null),fue(this,Hi,{writable:!0,value:!1}),yue(this,Hi,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}return cue(t,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this?!0:this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(jc(this,Hi)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(jc(this,Hi)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(jc(this,Hi)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(jc(this,Hi)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new t(this.row,this.col,jc(this,Hi))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),t}();const Fm=gue;function Vf(t){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vf(t)}function vue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ex(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,KW(n.key),n)}}function bue(t,e,r){return e&&Ex(t.prototype,e),r&&Ex(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wue(t,e,r){Sue(t,e),e.set(t,r)}function Sue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sw(t,e,r){return e=KW(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KW(t){var e=Cue(t,"string");return Vf(e)==="symbol"?e:String(e)}function Cue(t,e){if(Vf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function br(t,e){var r=qW(t,e,"get");return Oue(t,r)}function Oue(t,e){return e.get?e.get.call(t):e.value}function kue(t,e,r){var n=qW(t,e,"set");return Rue(t,n,r),r}function qW(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Rue(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var zn=new WeakMap,Eue=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;vue(this,t),Sw(this,"highlight",null),Sw(this,"from",null),Sw(this,"to",null),wue(this,zn,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=r.clone(),this.to=n.clone(),kue(this,zn,o)}return bue(t,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var r=e.row,n=e.col,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=r&&i.row>=r&&o.col<=n&&i.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),s=Math.min(r.row,i.row),l=Math.min(r.col,i.col),u=Math.max(n.row,a.row),c=Math.max(n.col,a.col),f=this._createCellCoords(s,l),h=this._createCellCoords(u,c);return this.from=f,this.to=h,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var r=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=r[0],this.to=r[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var o=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var i=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=i[0],this.to=i[1];break}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}},{key:"flipDirectionHorizontally",value:function(){var e=this.getDirection();switch(e){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return br(this,zn)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return br(this,zn)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return br(this,zn)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return br(this,zn)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return br(this,zn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return br(this,zn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return br(this,zn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return br(this,zn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,r){return r&&r.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(r.from.row,r.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(r.from.row,r.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(r.to.row,r.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(r.to.row,r.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}},{key:"getOppositeCorner",value:function(e,r){if(!(e instanceof Fm))return!1;if(r){var n=r.from,o=r.to;if(r.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return r.top===n.top&&o.push("top"),r.right===n.right&&o.push("right"),r.bottom===n.bottom&&o.push("bottom"),r.left===n.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[],o=e.row;o<=r.row;o++)for(var i=e.col;i<=r.col;i++)!(this.from.row===o&&this.from.col===i)&&!(this.to.row===o&&this.to.col===i)&&n.push(this._createCellCoords(o,i));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[],o=e.row;o<=r.row;o++)for(var i=e.col;i<=r.col;i++)e.row===o&&e.col===i?n.push(e):r.row===o&&r.col===i?n.push(r):n.push(this._createCellCoords(o,i));return n}},{key:"forAll",value:function(e){for(var r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=r.row;o<=n.row;o++)for(var i=r.col;i<=n.col;i++){var a=e(o,i);if(a===!1)return}}},{key:"clone",value:function(){return new t(this.highlight,this.from,this.to,br(this,zn))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,r){return new Fm(e,r,br(this,zn))}}]),t}();const hR=Eue;var Tue=_e,Pue=ak;Tue({target:"Object",stat:!0},{setPrototypeOf:Pue});var XW=We,Mue=Wa,_ue=Lt,xue=Et,Tx=Kd,Aue=Ad,ZW=Function,jue=XW([].concat),Iue=XW([].join),Cw={},Hue=function(t,e,r){if(!xue(Cw,e)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";Cw[e]=ZW("C,a","return new C("+Iue(n,",")+")")}return Cw[e](t,r)},Due=Aue?ZW.bind:function(t){var e=Mue(this),r=e.prototype,n=Tx(arguments,1),o=function(){var i=jue(n,Tx(arguments));return this instanceof o?Hue(e,i.length,i):e.apply(t,i)};return _ue(r)&&(o.prototype=r),o},Nue=_e,Lue=Bo,Ow=Ka,Bue=Due,Px=uF,Vue=At,Mx=Lt,Fue=sc,QW=Fe,dR=Lue("Reflect","construct"),Wue=Object.prototype,Uue=[].push,JW=QW(function(){function t(){}return!(dR(function(){},[],t)instanceof t)}),eU=!QW(function(){dR(function(){})}),_x=JW||eU;Nue({target:"Reflect",stat:!0,forced:_x,sham:_x},{construct:function(t,e){Px(t),Vue(e);var r=arguments.length<3?t:Px(arguments[2]);if(eU&&!JW)return dR(t,e,r);if(t==r){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return Ow(Uue,n,e),new(Ow(Bue,t,n))}var o=r.prototype,i=Fue(Mx(o)?o:Wue),a=Ow(t,i,e);return Mx(a)?a:i}});function Ff(t){"@babel/helpers - typeof";return Ff=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ff(t)}function zue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gue(n.key),n)}}function Yue(t,e,r){return e&&xx(t.prototype,e),r&&xx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gue(t){var e=$ue(t,"string");return Ff(e)==="symbol"?e:String(e)}function $ue(t,e){if(Ff(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ff(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ss=new WeakMap,Kue=function(){function t(e,r,n,o,i,a){var s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;zue(this,t),this.wtSettings=n,this.domBindings=r,this.wtTable=i,this.selections=a,this.parent=s,this.eventManager=o,this.facadeGetter=e,ss.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return Yue(t,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",function(o){return e.onContextMenu(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",function(o){return e.onMouseOver(o)}),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",function(o){return e.onMouseOut(o)});var r=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",function(o){return e.onTouchStart(o)}),e.eventManager.addEventListener(e.wtTable.holder,"touchend",function(o){return e.onTouchEnd(o)}),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout(function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},n=function(){e.eventManager.addEventListener(e.wtTable.holder,"mouseup",function(o){return e.onMouseUp(o)}),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",function(o){return e.onMouseDown(o)})};Ir()?r():(sF()&&r(),n())}},{key:"selectedCellWasTouched",value:function(e){var r=ss.get(this),n=this.parentCell(e),o=n.coords;if(r.selectedCellBeforeTouchEnd&&o){var i=[o.row,r.selectedCellBeforeTouchEnd.from.row],a=i[0],s=i[1],l=[o.col,r.selectedCellBeforeTouchEnd.from.col],u=l[0],c=l[1];return a===s&&u===c}return!1}},{key:"parentCell",value:function(e){var r={},n=this.wtTable.TABLE,o=Wp(e,["TD","TH"],n);return o?(r.coords=this.wtTable.getCoords(o),r.TD=o):Ae(e,"wtBorder")&&Ae(e,"current")?(r.coords=this.selections.getCell().cellRange.highlight,r.TD=this.wtTable.getCell(r.coords)):Ae(e,"wtBorder")&&Ae(e,"area")&&this.selections.createOrGetArea().cellRange&&(r.coords=this.selections.createOrGetArea().cellRange.to,r.TD=this.wtTable.getCell(r.coords)),r}},{key:"onMouseDown",value:function(e){var r=ss.get(this),n=this.domBindings.rootDocument.activeElement,o=mW(Xie,e.target),i=e.target;if(!(i===n||o(0)===n||o(1)===n)){var a=this.parentCell(i);Ae(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):a.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,a.coords,a.TD),(e.button===0||this.touchApplied)&&a.TD&&(r.dblClickOrigin[0]=a.TD,clearTimeout(r.dblClickTimeout[0]),r.dblClickTimeout[0]=setTimeout(function(){r.dblClickOrigin[0]=null},1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var r=this.wtTable.TABLE,n=Wp(e.target,["TD","TH"],r),o=this.parent||this;n&&n!==o.lastMouseOver&&Ea(n,r)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var r=this.wtTable.TABLE,n=Wp(e.target,["TD","TH"],r),o=Wp(e.relatedTarget,["TD","TH"],r),i=this.parent||this;n&&n!==o&&Ea(n,r)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),o===null&&(i.lastMouseOver=null))}}},{key:"onMouseUp",value:function(e){var r=ss.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===r.dblClickOrigin[0]&&n.TD===r.dblClickOrigin[1]?(Ae(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),r.dblClickOrigin[0]=null,r.dblClickOrigin[1]=null):n.TD===r.dblClickOrigin[0]&&(r.dblClickOrigin[1]=n.TD,clearTimeout(r.dblClickTimeout[1]),r.dblClickTimeout[1]=setTimeout(function(){r.dblClickOrigin[1]=null},500)))}},{key:"onTouchStart",value:function(e){var r=ss.get(this);r.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var r,n=e.target,o=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,i=pe(o)&&o.row>=0&&o.col>=0,a=e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance");if(a){var s=["A","BUTTON","INPUT"];dF()&&(Fee()||Wee())&&this.selectedCellWasTouched(n)&&!s.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,r,n,o){var i=this.wtSettings.getSettingPure(e);i&&i(r,n,o,this.facadeGetter())}},{key:"destroy",value:function(){var e=ss.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),t}();const tU=Kue;function Wf(t){"@babel/helpers - typeof";return Wf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wf(t)}function que(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ax(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zue(n.key),n)}}function Xue(t,e,r){return e&&Ax(t.prototype,e),r&&Ax(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zue(t){var e=Que(t,"string");return Wf(e)==="symbol"?e:String(e)}function Que(t,e){if(Wf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jue=function(){function t(e,r,n){que(this,t),this.offset=e,this.total=r,this.countTH=n}return Xue(t,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),t}();const ece=Jue;function Uf(t){"@babel/helpers - typeof";return Uf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uf(t)}function tce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,rce(n.key),n)}}function nce(t,e,r){return e&&jx(t.prototype,e),r&&jx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function rce(t){var e=oce(t,"string");return Uf(e)==="symbol"?e:String(e)}function oce(t,e){if(Uf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ice=function(){function t(e,r,n){tce(this,t),this.offset=e,this.total=r,this.countTH=n}return nce(t,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),t}();const ace=ice;var sce=0,Wm=1,Um=2;function zf(t){"@babel/helpers - typeof";return zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zf(t)}function lce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ix(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cce(n.key),n)}}function uce(t,e,r){return e&&Ix(t.prototype,e),r&&Ix(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cce(t){var e=fce(t,"string");return zf(e)==="symbol"?e:String(e)}function fce(t,e){if(zf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hx=function(){function t(){lce(this,t),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return uce(t,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),t}();function Yf(t){"@babel/helpers - typeof";return Yf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yf(t)}function hce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pce(n.key),n)}}function dce(t,e,r){return e&&Dx(t.prototype,e),r&&Dx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pce(t){var e=yce(t,"string");return Yf(e)==="symbol"?e:String(e)}function yce(t,e){if(Yf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mce=function(){function t(){hce(this,t),this.size=new Hx,this.workingSpace=sce,this.sharedSize=null}return dce(t,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof Hx}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=Wm,e.workingSpace=Um,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=Um,e.workingSpace=Wm,this.sharedSize=e.getViewSize()}}]),t}();function Gf(t){"@babel/helpers - typeof";return Gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gf(t)}function gce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,bce(n.key),n)}}function vce(t,e,r){return e&&Nx(t.prototype,e),r&&Nx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function bce(t){var e=wce(t,"string");return Gf(e)==="symbol"?e:String(e)}function wce(t,e){if(Gf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nU=function(){function t(e,r,n){gce(this,t),this.rootNode=e,this.nodesPool=r,this.sizeSet=new mce,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return vce(t,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,r=this.sizeSet,n=0;if(this.isSharedViewSet())for(var o=e.firstElementChild;o;){if(o.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(Wm))break;o=o.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,r=this.sizeSet,n=this.isSharedViewSet(),o=r.getViewSize(),i=o.nextSize,a=this.getRenderedChildCount();a<i;){var s=this.nodesPool();!n||n&&r.isPlaceOn(Um)?e.appendChild(s):e.insertBefore(s,e.firstChild),a+=1}for(var l=n&&r.isPlaceOn(Wm);a>i;)e.removeChild(l?e.firstChild:e.lastChild),a-=1}},{key:"render",value:function(){var e=this.rootNode,r=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(Um)&&(n+=r.sharedSize.nextSize);var o=e.childNodes[n];if(o.tagName!==this.childNodeType){var i=this.nodesPool();e.replaceChild(i,o),o=i}this.collectedNodes.push(o),this.visualIndex+=1}},{key:"end",value:function(){}}]),t}();function ol(t){"@babel/helpers - typeof";return ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ol(t)}function Sce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Oce(n.key),n)}}function Cce(t,e,r){return e&&Lx(t.prototype,e),r&&Lx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Oce(t){var e=kce(t,"string");return ol(e)==="symbol"?e:String(e)}function kce(t,e){if(ol(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rce(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZS(t,e)}function ZS(t,e){return ZS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ZS(t,e)}function Ece(t){var e=Mce();return function(){var r=zm(t),n;if(e){var o=zm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tce(this,n)}}function Tce(t,e){if(e&&(ol(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Pce(t)}function Pce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Mce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zm(t){return zm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zm(t)}var rU=function(t){Rce(r,t);var e=Ece(r);function r(){return Sce(this,r),e.apply(this,arguments)}return Cce(r,[{key:"prependView",value:function(n){return this.sizeSet.prepend(n.sizeSet),n.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(n){return this.sizeSet.append(n.sizeSet),n.sizeSet.prepend(this.sizeSet),this}}]),r}(nU);function $f(t){"@babel/helpers - typeof";return $f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$f(t)}function _ce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ace(n.key),n)}}function xce(t,e,r){return e&&Bx(t.prototype,e),r&&Bx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ace(t){var e=jce(t,"string");return $f(e)==="symbol"?e:String(e)}function jce(t,e){if($f(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($f(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ice=function(){function t(e){_ce(this,t),this.nodeType=e.toUpperCase()}return xce(t,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),t}();function Kf(t){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kf(t)}function Hce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nce(n.key),n)}}function Dce(t,e,r){return e&&Vx(t.prototype,e),r&&Vx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nce(t){var e=Lce(t,"string");return Kf(e)==="symbol"?e:String(e)}function Lce(t,e){if(Kf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cp=function(){function t(e,r){Hce(this,t),this.nodesPool=typeof e=="string"?new Ice(e):null,this.nodeType=e,this.rootNode=r,this.table=null,this.renderedNodes=0}return Dce(t,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),t}();function il(t){"@babel/helpers - typeof";return il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},il(t)}function Bce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fce(n.key),n)}}function Vce(t,e,r){return e&&Fx(t.prototype,e),r&&Fx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fce(t){var e=Wce(t,"string");return il(e)==="symbol"?e:String(e)}function Wce(t,e){if(il(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uce(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QS(t,e)}function QS(t,e){return QS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},QS(t,e)}function zce(t){var e=$ce();return function(){var r=Ym(t),n;if(e){var o=Ym(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yce(this,n)}}function Yce(t,e){if(e&&(il(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gce(t)}function Gce(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $ce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ym(t){return Ym=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ym(t)}var Kce=function(t){Uce(r,t);var e=zce(r);function r(){var n;return Bce(this,r),n=e.call(this,"TH"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Vce(r,[{key:"obtainOrderView",value:function(n){var o=this,i;return this.orderViews.has(n)?i=this.orderViews.get(n):(i=new rU(n,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(n,i)),i}},{key:"render",value:function(){for(var n=this.table,o=n.rowsToRender,i=n.rowHeaderFunctions,a=n.rowHeadersCount,s=n.rows,l=n.cells,u=0;u<o;u++){var c=this.table.renderedRowToSource(u),f=s.getRenderedNode(u);this.sourceRowIndex=c;var h=this.obtainOrderView(f),p=l.obtainOrderView(f);h.appendView(p).setSize(a).setOffset(this.table.renderedColumnToSource(0)).start();for(var y=0;y<a;y++){h.render();var g=h.getCurrentNode();g.className="",g.removeAttribute("style"),i[y](c,g,y)}h.end()}}}]),r}(cp);function al(t){"@babel/helpers - typeof";return al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},al(t)}function qce(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Wx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zce(n.key),n)}}function Xce(t,e,r){return e&&Wx(t.prototype,e),r&&Wx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zce(t){var e=Qce(t,"string");return al(e)==="symbol"?e:String(e)}function Qce(t,e){if(al(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(al(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jce(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JS(t,e)}function JS(t,e){return JS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},JS(t,e)}function efe(t){var e=rfe();return function(){var r=Gm(t),n;if(e){var o=Gm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tfe(this,n)}}function tfe(t,e){if(e&&(al(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nfe(t)}function nfe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gm(t){return Gm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gm(t)}var ofe=function(t){Jce(r,t);var e=efe(r);function r(n){return qce(this,r),e.call(this,null,n)}return Xce(r,[{key:"adjust",value:function(){var n=this.table,o=n.columnHeadersCount,i=n.rowHeadersCount,a=this.rootNode.firstChild;if(o){for(var s=this.table.columnsToRender,l=s+i,u=0,c=o;u<c;u++){for(a=this.rootNode.childNodes[u],a||(a=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(a)),this.renderedNodes=a.childNodes.length;this.renderedNodes<l;)a.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>l;)a.removeChild(a.lastChild),this.renderedNodes-=1}var f=this.rootNode.childNodes.length;if(f>o)for(var h=o;h<f;h++)this.rootNode.removeChild(this.rootNode.lastChild)}else a&&Nr(a)}},{key:"render",value:function(){for(var n=this.table.columnHeadersCount,o=0;o<n;o+=1)for(var i=this.table,a=i.columnHeaderFunctions,s=i.columnsToRender,l=i.rowHeadersCount,u=this.rootNode.childNodes[o],c=-1*l;c<s;c+=1){var f=this.table.renderedColumnToSource(c),h=u.childNodes[c+l];h.className="",h.removeAttribute("style"),a[o](f,h,o)}}}]),r}(cp);function sl(t){"@babel/helpers - typeof";return sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sl(t)}function ife(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ux(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sfe(n.key),n)}}function afe(t,e,r){return e&&Ux(t.prototype,e),r&&Ux(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sfe(t){var e=lfe(t,"string");return sl(e)==="symbol"?e:String(e)}function lfe(t,e){if(sl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ufe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eC(t,e)}function eC(t,e){return eC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},eC(t,e)}function cfe(t){var e=dfe();return function(){var r=$m(t),n;if(e){var o=$m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ffe(this,n)}}function ffe(t,e){if(e&&(sl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hfe(t)}function hfe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $m(t){return $m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$m(t)}var pfe=function(t){ufe(r,t);var e=cfe(r);function r(n){return ife(this,r),e.call(this,null,n)}return afe(r,[{key:"adjust",value:function(){for(var n=this.table,o=n.columnsToRender,i=n.rowHeadersCount,a=o+i;this.renderedNodes<a;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>a;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var n=this.table,o=n.columnsToRender,i=n.rowHeadersCount,a=0;a<i;a++){var s=this.table.renderedColumnToSource(a),l=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[a].style.width="".concat(l,"px")}for(var u=0;u<o;u++){var c=this.table.renderedColumnToSource(u),f=this.table.columnUtils.getStretchedColumnWidth(c);this.rootNode.childNodes[u+i].style.width="".concat(f,"px")}var h=this.rootNode.firstChild;h&&te(h,"rowHeader")}}]),r}(cp);function ll(t){"@babel/helpers - typeof";return ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ll(t)}var zx;function yfe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function mfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vfe(n.key),n)}}function gfe(t,e,r){return e&&Yx(t.prototype,e),r&&Yx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vfe(t){var e=bfe(t,"string");return ll(e)==="symbol"?e:String(e)}function bfe(t,e){if(ll(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wfe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tC(t,e)}function tC(t,e){return tC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},tC(t,e)}function Sfe(t){var e=kfe();return function(){var r=Km(t),n;if(e){var o=Km(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cfe(this,n)}}function Cfe(t,e){if(e&&(ll(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ofe(t)}function Ofe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kfe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Km(t){return Km=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Km(t)}var Gx=!1,Rfe=function(t){wfe(r,t);var e=Sfe(r);function r(n){var o;return mfe(this,r),o=e.call(this,"TR",n),o.orderView=new nU(n,function(i){return o.nodesPool.obtain(i)},o.nodeType),o}return gfe(r,[{key:"getRenderedNode",value:function(n){return this.orderView.getNode(n)}},{key:"render",value:function(){var n=this.table.rowsToRender;!Gx&&n>1e3&&(Gx=!0,lt(it(zx||(zx=yfe([`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting 
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`],[`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`]))))),this.orderView.setSize(n).setOffset(this.table.renderedRowToSource(0)).start();for(var o=0;o<n;o++)this.orderView.render();this.orderView.end()}}]),r}(cp);function ul(t){"@babel/helpers - typeof";return ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ul(t)}function Efe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Pfe(n.key),n)}}function Tfe(t,e,r){return e&&$x(t.prototype,e),r&&$x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pfe(t){var e=Mfe(t,"string");return ul(e)==="symbol"?e:String(e)}function Mfe(t,e){if(ul(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ul(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _fe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nC(t,e)}function nC(t,e){return nC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},nC(t,e)}function xfe(t){var e=Ife();return function(){var r=qm(t),n;if(e){var o=qm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Afe(this,n)}}function Afe(t,e){if(e&&(ul(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jfe(t)}function jfe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ife(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qm(t){return qm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qm(t)}var Hfe=function(t){_fe(r,t);var e=xfe(r);function r(){var n;return Efe(this,r),n=e.call(this,"TD"),n.orderViews=new WeakMap,n.sourceRowIndex=0,n}return Tfe(r,[{key:"obtainOrderView",value:function(n){var o=this,i;return this.orderViews.has(n)?i=this.orderViews.get(n):(i=new rU(n,function(a){return o.nodesPool.obtain(o.sourceRowIndex,a)},this.nodeType),this.orderViews.set(n,i)),i}},{key:"render",value:function(){for(var n=this.table,o=n.rowsToRender,i=n.columnsToRender,a=n.rows,s=n.rowHeaders,l=0;l<o;l++){var u=this.table.renderedRowToSource(l),c=a.getRenderedNode(l);this.sourceRowIndex=u;var f=this.obtainOrderView(c),h=s.obtainOrderView(c);f.prependView(h).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(var p=0;p<i;p++){f.render();var y=f.getCurrentNode(),g=this.table.renderedColumnToSource(p);Ae(y,"hide")||(y.className=""),y.removeAttribute("style"),y.removeAttribute("dir"),this.table.cellRenderer(u,g,y)}f.end()}}}]),r}(cp);function qf(t){"@babel/helpers - typeof";return qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qf(t)}function Dfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lfe(n.key),n)}}function Nfe(t,e,r){return e&&Kx(t.prototype,e),r&&Kx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lfe(t){var e=Bfe(t,"string");return qf(e)==="symbol"?e:String(e)}function Bfe(t,e){if(qf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vfe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.cellRenderer;Dfe(this,t),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return Nfe(t,[{key:"setAxisUtils",value:function(e,r){this.rowUtils=e,this.columnUtils=r}},{key:"setViewportSize",value:function(e,r){this.rowsToRender=e,this.columnsToRender=r}},{key:"setFilters",value:function(e,r){this.rowFilter=e,this.columnFilter=r}},{key:"setHeaderContentRenderers",value:function(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.rowHeaders,n=e.columnHeaders,o=e.colGroup,i=e.rows,a=e.cells;r.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),a.setTable(this),this.rowHeaders=r,this.columnHeaders=n,this.colGroup=o,this.rows=i,this.cells=a}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,r=this.rows,n=0;n<e;n++){var o=r.getRenderedNode(n);if(o.firstChild){var i=this.renderedRowToSource(n),a=this.rowUtils.getHeight(i);a?o.firstChild.style.height="".concat(a-1,"px"):o.firstChild.style.height=""}}}}]),t}();function Xf(t){"@babel/helpers - typeof";return Xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xf(t)}function Ffe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ufe(n.key),n)}}function Wfe(t,e,r){return e&&qx(t.prototype,e),r&&qx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ufe(t){var e=zfe(t,"string");return Xf(e)==="symbol"?e:String(e)}function zfe(t,e){if(Xf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yfe=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.TABLE,n=e.THEAD,o=e.COLGROUP,i=e.TBODY,a=e.rowUtils,s=e.columnUtils,l=e.cellRenderer;Ffe(this,t),this.renderer=new Vfe(r,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new Kce,columnHeaders:new ofe(n),colGroup:new pfe(o),rows:new Rfe(i),cells:new Hfe}),this.renderer.setAxisUtils(a,s)}return Wfe(t,[{key:"setFilters",value:function(e,r){return this.renderer.setFilters(e,r),this}},{key:"setViewportSize",value:function(e,r){return this.renderer.setViewportSize(e,r),this}},{key:"setHeaderContentRenderers",value:function(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),t}();function Zf(t){"@babel/helpers - typeof";return Zf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zf(t)}function Gfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kfe(n.key),n)}}function $fe(t,e,r){return e&&Xx(t.prototype,e),r&&Xx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kfe(t){var e=qfe(t,"string");return Zf(e)==="symbol"?e:String(e)}function qfe(t,e){if(Zf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xfe=function(){function t(e,r){Gfe(this,t),this.dataAccessObject=e,this.wtSettings=r,this.headerWidths=new Map}return $fe(t,[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var r=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(r){var o=r.getStretchedColumnWidth(e,n);o&&(n=o)}return n}},{key:"getHeaderHeight",value:function(e){var r=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,r=this.dataAccessObject,n=r.wtTable,o=r.wtViewport,i=r.cloneSource,a=i?i.wtTable.holder:n.holder,s=a.offsetHeight<a.scrollHeight?en():0,l=e.getSetting("rowHeaderWidth");if(o.columnsRenderCalculator.refreshStretching(o.getViewportWidth()-s),l=e.getSetting("onModifyRowHeaderWidth",l),l!=null)for(var u=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth"),f=0;f<u;f++){var h=Array.isArray(l)?l[f]:l;h=h??c,this.headerWidths.set(f,h)}}}]),t}();function Qf(t){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qf(t)}function Zfe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jfe(n.key),n)}}function Qfe(t,e,r){return e&&Zx(t.prototype,e),r&&Zx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jfe(t){var e=ehe(t,"string");return Qf(e)==="symbol"?e:String(e)}function ehe(t,e){if(Qf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var the=function(){function t(e,r){Zfe(this,t),this.dataAccessObject=e,this.wtSettings=r}return Qfe(t,[{key:"getHeight",value:function(e){var r=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}}]),t}();function Jf(t){"@babel/helpers - typeof";return Jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jf(t)}function nhe(t){return ihe(t)||ohe(t)||oU(t)||rhe()}function rhe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ohe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ihe(t){if(Array.isArray(t))return rC(t)}function ahe(t,e){return uhe(t)||lhe(t,e)||oU(t,e)||she()}function she(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oU(t,e){if(t){if(typeof t=="string")return rC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rC(t,e)}}function rC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lhe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uhe(t){if(Array.isArray(t))return t}function che(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iU(n.key),n)}}function fhe(t,e,r){return e&&Qx(t.prototype,e),r&&Qx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wr(t,e,r){return e=iU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iU(t){var e=hhe(t,"string");return Jf(e)==="symbol"?e:String(e)}function hhe(t,e){if(Jf(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jf(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dhe=function(){function t(e,r,n,o,i){var a=this;che(this,t),wr(this,"wtSettings",null),wr(this,"domBindings",void 0),wr(this,"TBODY",null),wr(this,"THEAD",null),wr(this,"COLGROUP",null),wr(this,"hasTableHeight",!0),wr(this,"hasTableWidth",!0),wr(this,"isTableVisible",!1),wr(this,"tableOffset",0),wr(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,hW(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",function(){return a._modifyRowHeaderWidth(s)}),this.rowUtils=new the(this.dataAccessObject,this.wtSettings),this.columnUtils=new Xfe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Yfe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return fhe(t,[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ae(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}},{key:"createHider",value:function(e){var r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ae(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),n}},{key:"createHolder",value:function(e){var r=e.parentNode,n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ae(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(e)),n}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.wtSettings,n=this.dataAccessObject,o=n.wtOverlays,i=n.wtViewport,a=r.getSetting("totalRows"),s=r.getSetting("totalColumns"),l=r.getSetting("rowHeaders"),u=l.length,c=r.getSetting("columnHeaders"),f=c.length,h=!1,p=e;if(this.isMaster&&(this.holderOffset=Wt(this.holder),p=i.createRenderCalculators(p),u&&!r.getSetting("fixedColumnsStart"))){var y=o.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,g!==this.correctHeaderWidth&&(p=!1)}if(this.isMaster&&(h=o.updateStateOfRendering()),p)this.isMaster&&i.createVisibleCalculators(),o&&o.refresh(!0);else{this.isMaster?this.tableOffset=Wt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=a>0?this.getFirstRenderedRow():0,S=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new ace(v,a,f),this.columnFilter=new ece(S,s,u);var O=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var w={};this.wtSettings.getSetting("beforeDraw",!0,w),O=w.skipRender!==!0}if(O){this.tableRenderer.setHeaderContentRenderers(l,c),(this.is(jr)||this.is(fi))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();var x;if(this.isMaster&&(x=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(jr))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var T=ut(this.hider),z=ut(this.TABLE);T!==0&&z!==T&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),x!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(jr)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}var $=!1;return this.isMaster&&($=o.topOverlay.resetFixedPosition(),o.bottomOverlay.clone&&($=o.bottomOverlay.resetFixedPosition()||$),$=o.inlineStartOverlay.resetFixedPosition()||$,o.topInlineStartCornerOverlay&&o.topInlineStartCornerOverlay.resetFixedPosition(),o.bottomInlineStartCornerOverlay&&o.bottomInlineStartCornerOverlay.clone&&o.bottomInlineStartCornerOverlay.resetFixedPosition()),$?(o.refreshAll(),o.adjustElementsSize()):this.refreshSelections(p),h&&o.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var r=this.columnFilter.renderedToSource(e),n=this.wtSettings.getSetting("columnHeaders").length,o=this.wtSettings.getSetting("defaultRowHeight"),i,a,s,l=this.wtSettings.getSetting("columnHeaderHeight")||[];n;)n-=1,i=this.getColumnHeaderHeight(n),a=this.getColumnHeader(r,n),a&&(s=si(a),(!i&&o<s||i<s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders"),i=0,a=o.length;i<a;i++)if(n[i]){if(!r[i]||r[i].childNodes.length===0)return;r[i].childNodes[0].style.height="".concat(n[i],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,r=this.dataAccessObject.wtViewport;if(!(!this.isMaster&&!this.is(jr))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),o=0;o<n;o++){var i=this.rowFilter.renderedToSource(o);r.oversizedRows&&r.oversizedRows[i]&&(r.oversizedRows[i]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var r=this.TABLE.querySelectorAll(".".concat(e)),n=0,o=r.length;n<o;n++)Ne(r[n],e)}},{key:"refreshSelections",value:function(e){var r=this.wtSettings,n=this.dataAccessObject.selections;if(n){var o=Array.from(n),i=o.length;if(e){for(var a=[],s=0;s<i;s++){for(var l=o[s].settings,u=l.highlightHeaderClassName,c=l.highlightRowClassName,f=l.highlightColumnClassName,h=o[s].classNames,p=h.length,y=0;y<p;y++)a.includes(h[y])||a.push(h[y]);u&&!a.includes(u)&&a.push(u),c&&!a.includes(c)&&a.push(c),f&&!a.includes(f)&&a.push(f)}var g=r.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var v=0;v<g.length;v++)a.push(g[v]);for(var S=a.length,O=0;O<S;O++)this.removeClassFromCells(a[O])}for(var w=0;w<i;w++)o[w].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var r=e.row,n=e.col,o=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(o&&Array.isArray(o)){var i=ahe(o,2);r=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var a=this.getRow(r);if(!a&&r>=0)throw new Error("TR was expected to be rendered but is not");var s=a.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}},{key:"getRow",value:function(e){var r=null,n=null;if(e<0){var o;r=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}},{key:"getColumnHeader",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(function(o){var i=o.childNodes[n];i&&r.push(i)}),r}},{key:"getRowHeader",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)!==0){var n=this.wtSettings.getSetting("rowHeaders").length;if(!(r>=n)){var o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o==null?void 0:o.childNodes[r]}}}},{key:"getRowHeaders",value:function(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];for(var r=[],n=this.wtSettings.getSetting("rowHeaders").length,o=0;o<n;o++){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=i==null?void 0:i.childNodes[o];a&&r.push(a)}return r}},{key:"getCoords",value:function(e){var r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Ra(r,["TD","TH"])),r===null)return null;var n=r.parentNode,o=n.parentNode,i=Qie(n),a=r.cellIndex;if(Ii(ja,r,this.wtRootElement)||Ii(xa,r,this.wtRootElement))o.nodeName==="THEAD"&&(i-=o.childNodes.length);else if(Ii(fi,r,this.wtRootElement)||Ii(jr,r,this.wtRootElement)){var s=this.wtSettings.getSetting("totalRows");i=s-o.childNodes.length+i}else o===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i);return Ii(ja,r,this.wtRootElement)||Ii(Aa,r,this.wtRootElement)||Ii(fi,r,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a),this.wot.createCellCoords(i,a)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e=this.TBODY.childNodes.length,r=e*this.wtSettings.getSetting("defaultRowHeight"),n=si(this.TBODY)-1,o,i,a,s,l;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,a=this.rowFilter.renderedToSource(e),o=this.getRowHeight(a),s=this.getTrForRow(a),l=s.querySelector("th"),l?i=si(l):i=si(s)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[a]=i)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var r=this.wtSettings.getSetting("rowHeaders"),n=r.length;return Math.abs(e)<=n}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var r=this.wtSettings.getSetting("columnHeaders"),n=r.length;return Math.abs(e)<=n}},{key:"isRowBeforeRenderedRows",value:function(e){var r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return ut(this.TABLE)}},{key:"getHeight",value:function(){return Rt(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=ut(this.hider);return e!==0?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=Rt(this.hider);return e!==0?e:this.getHeight()}},{key:"isVisible",value:function(){return _f(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var r=yt(e)?e():null;return Array.isArray(r)?(r=nhe(r),r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}},{key:"_correctRowHeaderWidth",value:function(e){var r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}]),t}();const pc=dhe;var phe="stickyRowsBottom",aU={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Fo(aU,"MIXIN_NAME",phe,{writable:!1,enumerable:!1});const sU=aU;var yhe="stickyColumnsStart",lU={getFirstRenderedColumn:function(){var t=this.wtSettings.getSetting("totalColumns");return t===0?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};Fo(lU,"MIXIN_NAME",yhe,{writable:!1,enumerable:!1});const pR=lU;function cl(t){"@babel/helpers - typeof";return cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cl(t)}function Jx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ghe(n.key),n)}}function mhe(t,e,r){return e&&Jx(t.prototype,e),r&&Jx(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ghe(t){var e=vhe(t,"string");return cl(e)==="symbol"?e:String(e)}function vhe(t,e){if(cl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bhe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function whe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oC(t,e)}function oC(t,e){return oC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},oC(t,e)}function She(t){var e=khe();return function(){var r=Xm(t),n;if(e){var o=Xm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Che(this,n)}}function Che(t,e){if(e&&(cl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ohe(t)}function Ohe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function khe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Xm(t){return Xm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xm(t)}var yR=function(t){whe(r,t);var e=She(r);function r(n,o,i,a){return bhe(this,r),e.call(this,n,o,i,a,fi)}return mhe(r)}(pc);pt(yR,sU);pt(yR,pR);const Rhe=yR;var xa="top",jr="bottom",Aa="inline_start",ja="top_inline_start_corner",fi="bottom_inline_start_corner",Ehe=[xa,jr,Aa,ja,fi],The=new Map([[xa,"ht_clone_".concat(xa)],[jr,"ht_clone_".concat(jr)],[Aa,"ht_clone_".concat(Aa," ht_clone_left")],[ja,"ht_clone_".concat(ja," ht_clone_top_left_corner")],[fi,"ht_clone_".concat(fi," ht_clone_bottom_left_corner")]]);function eh(t){"@babel/helpers - typeof";return eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eh(t)}function Phe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uU(n.key),n)}}function Mhe(t,e,r){return e&&eA(t.prototype,e),r&&eA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kw(t,e,r){return e=uU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uU(t){var e=_he(t,"string");return eh(e)==="symbol"?e:String(e)}function _he(t,e){if(eh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xhe=function(){function t(e){Phe(this,t),kw(this,"dataAccessObject",void 0),kw(this,"lastScrolledColumnPos",-1),kw(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}return Mhe(t,[{key:"scrollViewport",value:function(e,r,n,o,i){var a=this.scrollViewportHorizontally(e.col,n,i),s=this.scrollViewportVertically(e.row,r,o);return a||s}},{key:"scrollViewportHorizontally",value:function(e,r,n){var o=this.dataAccessObject,i=o.drawn,a=o.totalColumns;if(!i||!Number.isInteger(e)||e<0||e>a)return!1;var s=this.getFirstVisibleColumn(),l=this.getLastVisibleColumn(),u=r===void 0&&n===void 0,c=this.dataAccessObject,f=c.fixedColumnsStart,h=c.inlineStartOverlay;if(u&&e<f)return!1;var p=!1;return s===-1?p=h.scrollTo(e,u?e>this.lastScrolledColumnPos:r):(u&&(e<s||e>l)||!u)&&(p=h.scrollTo(e,u?e>l:r)),p&&(this.lastScrolledColumnPos=e),p}},{key:"scrollViewportVertically",value:function(e,r,n){var o=this.dataAccessObject,i=o.drawn,a=o.totalRows;if(!i||!Number.isInteger(e)||e<0||e>a)return!1;var s=this.getFirstVisibleRow(),l=this.getLastVisibleRow(),u=r===void 0&&n===void 0,c=this.dataAccessObject,f=c.fixedRowsBottom,h=c.fixedRowsTop,p=c.topOverlay;if(u&&(e<h||e>a-f-1))return!1;var y=!1;return s===-1?y=p.scrollTo(e,u?e>this.lastScrolledRowPos:n):(u&&(e<s||e>l)||!u)&&(y=p.scrollTo(e,u?e>l:n)),y&&(this.lastScrolledRowPos=e),y}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,r=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=e.fixedRowsTop,s=e.rootWindow,l=n.getFirstVisibleRow();if(r.mainTableScrollableElement===s){var u=Wt(n.wtRootElement),c=si(n.hider),f=si(s),h=Lm(s,s);if(u.top+c-f<=h){var p=o.getColumnHeaderHeight();p+=r.sumCellSizes(0,a);for(var y=i;y>0;y--)if(p+=r.sumCellSizes(y-1,y),u.top+c-p<=h){l=y;break}}}return l}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,r=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=e.rootWindow,s=n.getLastVisibleRow();if(r.mainTableScrollableElement===a){var l=Wt(n.wtRootElement),u=Lm(a,a);if(l.top>u){for(var c=si(a),f=o.getColumnHeaderHeight(),h=1;h<=i;h++)if(f+=r.sumCellSizes(h-1,h),l.top+f-u>=c){s=h-2;break}}}return s}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,r=e.inlineStartOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalColumns,a=e.rootWindow,s=n.getFirstVisibleColumn();if(r.mainTableScrollableElement===a){var l=Wt(n.wtRootElement),u=$y(n.hider),c=$y(a),f=Math.abs(jS(a,a));if(l.left+u-c<=f){for(var h=o.getRowHeaderWidth(),p=i;p>0;p--)if(h+=r.sumCellSizes(p-1,p),l.left+u-h<=f){s=p;break}}}return s}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,r=e.wtSettings,n=e.inlineStartOverlay,o=e.wtTable,i=e.wtViewport,a=e.totalColumns,s=e.rootWindow,l=o.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var u=r.getSetting("rtlMode"),c=null;if(u){var f=o.TABLE.getBoundingClientRect(),h=this.dataAccessObject.rootWindow.document,p=h.documentElement.offsetWidth;c=Math.abs(f.right-p)}else{var y=Wt(o.wtRootElement);c=y.left}var g=Math.abs(jS(s,s));if(c>g){for(var v=$y(s),S=i.getRowHeaderWidth(),O=1;O<=a;O++)if(S+=n.sumCellSizes(O-1,O),c+S-g>=v){l=O-2;break}}}return l}}]),t}();const Ahe=xhe;function th(t){"@babel/helpers - typeof";return th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},th(t)}function jhe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cU(n.key),n)}}function Ihe(t,e,r){return e&&tA(t.prototype,e),r&&tA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function or(t,e,r){return e=cU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cU(t){var e=Hhe(t,"string");return th(e)==="symbol"?e:String(e)}function Hhe(t,e){if(th(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mR=function(){function t(e,r){jhe(this,t),or(this,"wtTable",void 0),or(this,"wtScroll",void 0),or(this,"wtViewport",void 0),or(this,"wtOverlays",void 0),or(this,"selections",void 0),or(this,"wtEvent",void 0),or(this,"guid","wt_".concat(uW())),or(this,"drawInterrupted",!1),or(this,"drawn",!1),or(this,"domBindings",void 0),or(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new Ahe(this.createScrollDao())}return Ihe(t,[{key:"eventManager",get:function(){return new Tt(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(o,i){Pa(i,e[o])}])}}},{key:"createCellCoords",value:function(e,r){return new Fm(e,r,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,r,n){return new hR(e,r,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}},{key:"getCell",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!r)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,r,n,o,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(e,r,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,r,n)}},{key:"scrollViewportVertically",value:function(e,r,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,r,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}]),t}();function fl(t){"@babel/helpers - typeof";return fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fl(t)}function nA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fU(n.key),n)}}function Dhe(t,e,r){return e&&nA(t.prototype,e),r&&nA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nhe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lhe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iC(t,e)}function iC(t,e){return iC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iC(t,e)}function Bhe(t){var e=Fhe();return function(){var r=Zm(t),n;if(e){var o=Zm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vhe(this,n)}}function Vhe(t,e){if(e&&(fl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xy(t)}function Xy(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fhe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Zm(t){return Zm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zm(t)}function rA(t,e,r){return e=fU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fU(t){var e=Whe(t,"string");return fl(e)==="symbol"?e:String(e)}function Whe(t,e){if(fl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Uhe=function(t){Lhe(r,t);var e=Bhe(r);function r(n,o,i){var a;Nhe(this,r),a=e.call(this,n,o),rA(Xy(a),"cloneSource",void 0),rA(Xy(a),"cloneOverlay",void 0);var s=a.wtSettings.getSetting("facade",Xy(a));return a.cloneSource=i.source,a.cloneOverlay=i.overlay,a.wtTable=a.cloneOverlay.createTable(a.getTableDao(),s,a.domBindings,a.wtSettings),a.wtViewport=i.viewport,a.selections=i.selections,a.wtEvent=new tU(s,a.domBindings,a.wtSettings,a.eventManager,a.wtTable,a.selections,i.event),a.findOriginalHeaders(),a}return Dhe(r)}(mR);function nh(t){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nh(t)}function zhe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hU(n.key),n)}}function Yhe(t,e,r){return e&&oA(t.prototype,e),r&&oA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ghe(t,e,r){return e=hU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hU(t){var e=$he(t,"string");return nh(e)==="symbol"?e:String(e)}function $he(t,e){if(nh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fp=function(){function t(e,r,n,o,i){zhe(this,t),Ghe(this,"wtSettings",null),Fo(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=r,this.wtSettings=o;var a=this.wot.wtTable,s=a.TABLE,l=a.hider,u=a.spreader,c=a.holder,f=a.wtRootElement;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=u,this.holder=c,this.wtRootElement=f,this.trimmingContainer=rl(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return Yhe(t,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var r=e!==this.needFullRender;return r&&!this.needFullRender&&this.reset(),r}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=rl(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable,r=this.domBindings.rootWindow;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Bm(e.TABLE)}},{key:"getRelativeCellPosition",value:function(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){lt("The provided element is not a child of the ".concat(this.type," overlay"));return}var o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),a=r<this.wtSettings.getSetting("fixedRowsTop"),s=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop},f=null;return o?f=this.getRelativeCellPositionWithinWindow(a,i,c,u):f=this.getRelativeCellPositionWithinHolder(a,s,i,c,u),f}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,r,n,o){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),a=0,s=0;if(!r)a=o.start;else{var l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+en())),a=l<=0?-1*l:0}if(e){var u=this.clone.wtTable.TABLE.getBoundingClientRect();s=u.top-i.top}else s=o.top;return{start:n.start+a,top:n.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,r,n,o,i){var a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(n||(s=a.horizontal-i.start),r){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect(),c=this.clone.wtTable.TABLE.getBoundingClientRect();l=c.top*-1+u.top}else e||(l=a.vertical-i.top);return{start:o.start-s,top:o.top-l}}},{key:"makeClone",value:function(){if(Ehe.indexOf(this.type)===-1)throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=n.createElement("DIV"),a=n.createElement("TABLE"),s=e.wtRootElement.parentNode;i.className="".concat(The.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,a.className=e.TABLE.className,i.appendChild(a),s.appendChild(i);var l=this.wtSettings.getSetting("preventOverflow");return l===!0||l==="horizontal"&&this.type===xa||l==="vertical"&&this.type===Aa?this.mainTableScrollableElement=o:o.getComputedStyle(s).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Bm(e.TABLE),new Uhe(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.shouldBeRendered();this.clone&&(this.needFullRender||r)&&this.clone.draw(e),this.needFullRender=r}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,o=r.style,i=e.parentNode.style;_([n,o,i],function(a){a.width="",a.height=""})}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),t}();function hl(t){"@babel/helpers - typeof";return hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hl(t)}function Zy(t,e,r){return dU()?Zy=Reflect.construct.bind():Zy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&Qm(l,i.prototype),l},Zy.apply(null,arguments)}function Khe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xhe(n.key),n)}}function qhe(t,e,r){return e&&iA(t.prototype,e),r&&iA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Xhe(t){var e=Zhe(t,"string");return hl(e)==="symbol"?e:String(e)}function Zhe(t,e){if(hl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qhe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qm(t,e)}function Qm(t,e){return Qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Qm(t,e)}function Jhe(t){var e=dU();return function(){var r=Jm(t),n;if(e){var o=Jm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ede(this,n)}}function ede(t,e){if(e&&(hl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tde(t)}function tde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jm(t){return Jm=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Jm(t)}var nde=function(t){Qhe(r,t);var e=Jhe(r);function r(n,o,i,a,s,l){var u;return Khe(this,r),u=e.call(this,n,o,fi,i,a),u.bottomOverlay=s,u.inlineStartOverlay=l,u}return qhe(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Zy(Rhe,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var n=this.wot;if(this.updateTrimmingContainer(),!n.wtTable.holder.parentNode)return!1;var o=this.clone.wtTable.holder.parentNode;if(o.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var i=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();o.style[this.isRtl()?"right":"left"]="".concat(i,"px"),o.style.bottom="".concat(a,"px")}else kv(o),this.repositionOverlay();var s=Rt(this.clone.wtTable.TABLE),l=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),o.style.height="".concat(s,"px"),o.style.width="".concat(l,"px"),!1}},{key:"repositionOverlay",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,l=0;i.hasVerticalScroll()||(l+=i.getWorkspaceHeight()-o.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(l+=en(a)),s.style.bottom="".concat(l,"px")}}]),r}(fp),rde="calculatedColumns",pU={getFirstRenderedColumn:function(){var t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn:function(){var t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn:function(){var t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn:function(){var t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};Fo(pU,"MIXIN_NAME",rde,{writable:!1,enumerable:!1});const gR=pU;function dl(t){"@babel/helpers - typeof";return dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dl(t)}function aA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ide(n.key),n)}}function ode(t,e,r){return e&&aA(t.prototype,e),r&&aA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ide(t){var e=ade(t,"string");return dl(e)==="symbol"?e:String(e)}function ade(t,e){if(dl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aC(t,e)}function aC(t,e){return aC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aC(t,e)}function ude(t){var e=hde();return function(){var r=eg(t),n;if(e){var o=eg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cde(this,n)}}function cde(t,e){if(e&&(dl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fde(t)}function fde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function eg(t){return eg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eg(t)}var vR=function(t){lde(r,t);var e=ude(r);function r(n,o,i,a){return sde(this,r),e.call(this,n,o,i,a,jr)}return ode(r)}(pc);pt(vR,sU);pt(vR,gR);const dde=vR;function pl(t){"@babel/helpers - typeof";return pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pl(t)}function Qy(t,e,r){return mU()?Qy=Reflect.construct.bind():Qy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&tg(l,i.prototype),l},Qy.apply(null,arguments)}function pde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gU(n.key),n)}}function yde(t,e,r){return e&&sA(t.prototype,e),r&&sA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tg(t,e)}function tg(t,e){return tg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},tg(t,e)}function gde(t){var e=mU();return function(){var r=ng(t),n;if(e){var o=ng(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vde(this,n)}}function vde(t,e){if(e&&(pl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yU(t)}function yU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ng(t){return ng=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ng(t)}function bde(t,e,r){return e=gU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gU(t){var e=wde(t,"string");return pl(e)==="symbol"?e:String(e)}function wde(t,e){if(pl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Sde=function(t){mde(r,t);var e=gde(r);function r(n,o,i,a){var s;return pde(this,r),s=e.call(this,n,o,jr,i,a),bde(yU(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return yde(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Qy(dde,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var n=this.domBindings.rootWindow,o=this.clone.wtTable.holder.parentNode;o.style.top="";var i=0,a=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===n&&(!a||a!=="vertical")?(i=this.getOverlayOffset(),o.style.bottom="".concat(i,"px")):(i=this.getScrollPosition(),this.repositionOverlay());var s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}},{key:"repositionOverlay",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings.rootDocument,s=this.clone.wtTable.holder.parentNode,l=0;i.hasVerticalScroll()||(l+=i.getWorkspaceHeight()-o.getTotalHeight()),i.hasVerticalScroll()&&i.hasHorizontalScroll()&&(l+=en(a)),s.style.bottom="".concat(l,"px")}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===o?(o.scrollTo(nl(o),n),i=!0):this.mainTableScrollableElement.scrollTop!==n&&(this.mainTableScrollableElement.scrollTop=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wot,a=i.wtTable,s=i.wtSettings,l=s.getSetting("defaultRowHeight"),u=n,c=0;u<o;){var f=a.getRowHeight(u);c+=f===void 0?l:f,u+=1}return c}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot,o=n.wtTable,i=n.wtViewport,a=this.domBindings,s=a.rootDocument,l=a.rootWindow,u=en(s),c=this.clone.wtTable.holder.parentNode,f=c.style,h=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==l||h==="horizontal"){var p=i.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(p-=u),p=Math.min(p,o.wtRootElement.scrollWidth),f.width="".concat(p,"px")}else f.width="";this.clone.wtTable.holder.style.width=f.width;var y=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(y=0),f.height="".concat(y,"px")}},{key:"adjustRootChildrenSize",value:function(){var n=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,n.style.width=n.parentNode.style.width,n.style.height=n.parentNode.style.height}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var n=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[n]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[n]=""}},{key:"scrollTo",value:function(n,o){var i=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=a.wtTable.holder,l=0;o&&s.offsetHeight!==s.clientHeight&&(l=en(this.domBindings.rootDocument)),o?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),n),i+=l,this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Lm(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),l=a-s,u=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+a,0),i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==o,a=this.wtSettings.getSetting("columnHeaders"),s=!1;if((i||o===0)&&a.length>0){var l=this.wot.wtTable.holder.parentNode,u=Ae(l,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),n||this.wtSettings.getSetting("totalRows")===0?(te(l,"innerBorderBottom"),s=!u):(Ne(l,"innerBorderBottom"),s=u)}return s}}]),r}(fp),Cde="calculatedRows",vU={getFirstRenderedRow:function(){var t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow:function(){var t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow:function(){var t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow:function(){var t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};Fo(vU,"MIXIN_NAME",Cde,{writable:!1,enumerable:!1});const bU=vU;function yl(t){"@babel/helpers - typeof";return yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yl(t)}function lA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kde(n.key),n)}}function Ode(t,e,r){return e&&lA(t.prototype,e),r&&lA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kde(t){var e=Rde(t,"string");return yl(e)==="symbol"?e:String(e)}function Rde(t,e){if(yl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ede(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sC(t,e)}function sC(t,e){return sC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},sC(t,e)}function Pde(t){var e=xde();return function(){var r=rg(t),n;if(e){var o=rg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mde(this,n)}}function Mde(t,e){if(e&&(yl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _de(t)}function _de(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function rg(t){return rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},rg(t)}var bR=function(t){Tde(r,t);var e=Pde(r);function r(n,o,i,a){return Ede(this,r),e.call(this,n,o,i,a,Aa)}return Ode(r)}(pc);pt(bR,bU);pt(bR,pR);const Ade=bR;function ml(t){"@babel/helpers - typeof";return ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ml(t)}function Jy(t,e,r){return wU()?Jy=Reflect.construct.bind():Jy=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&og(l,i.prototype),l},Jy.apply(null,arguments)}function jde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hde(n.key),n)}}function Ide(t,e,r){return e&&uA(t.prototype,e),r&&uA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hde(t){var e=Dde(t,"string");return ml(e)==="symbol"?e:String(e)}function Dde(t,e){if(ml(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nde(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&og(t,e)}function og(t,e){return og=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},og(t,e)}function Lde(t){var e=wU();return function(){var r=ig(t),n;if(e){var o=ig(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bde(this,n)}}function Bde(t,e){if(e&&(ml(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vde(t)}function Vde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ig(t){return ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ig(t)}var Fde=function(t){Nde(r,t);var e=Lde(r);function r(n,o,i,a){return jde(this,r),e.call(this,n,o,Aa,i,a)}return Ide(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Jy(Ade,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var n=this.wot.wtTable;if(!this.needFullRender||!n.holder.parentNode)return!1;var o=this.domBindings.rootWindow,i=this.clone.wtTable.holder.parentNode,a=this.wtSettings.getSetting("preventOverflow"),s=0;this.trimmingContainer===o&&(!a||a!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),iR(i,"".concat(s,"px"),"0px")):(s=this.getScrollPosition(),kv(i));var l=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),l}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.isRtl()&&(n=-n),this.mainTableScrollableElement===o&&o.scrollX!==n?(o.scrollTo(n,xf(o)),i=!0):this.mainTableScrollableElement.scrollLeft!==n&&(this.mainTableScrollableElement.scrollLeft=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wtSettings.getSetting("defaultColumnWidth"),a=n,s=0;a<o;)s+=this.wot.wtTable.getStretchedColumnWidth(a)||i,a+=1;return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,s=en(i),l=this.clone.wtTable.holder.parentNode,u=l.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||c==="vertical"){var f=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(f-=s),f=Math.min(f,n.wtRootElement.scrollHeight),u.height="".concat(f,"px")}else u.height="";this.clone.wtTable.holder.style.height=u.height;var h=ut(this.clone.wtTable.TABLE);u.width="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var n,o=this.clone.wtTable.holder,i=this.wot.selections,a=this.facadeGetter(),s=Math.abs((n=i==null?void 0:i.getCell().getBorder(a).cornerCenterPointOffset)!==null&&n!==void 0?n:0);this.clone.wtTable.hider.style.height=this.hider.style.height,o.style.height=o.parentNode.style.height,o.style.width="".concat(parseInt(o.parentNode.style.width,10)+s,"px")}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalColumns"),o=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[o]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style[o]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(n,o){var i=this.getTableParentOffset(),a=this.wot.cloneSource?this.wot.cloneSource:this.wot,s=a.wtTable.holder,l=0;if(o){var u=this.wot.wtTable.getColumnWidth(n),c=this.wot.wtViewport.getViewportWidth();u>c&&(o=!1)}return o&&s.offsetWidth!==s.clientWidth&&(l=en(this.domBindings.rootDocument)),o?(i+=this.sumCellSizes(0,n+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),n),i+=l,this.setScrollPosition(i)}},{key:"getTableParentOffset",value:function(){var n=this.wtSettings.getSetting("preventOverflow"),o=0;return!n&&this.trimmingContainer===this.domBindings.rootWindow&&(o=this.wot.wtTable.holderOffset.left),o}},{key:"getScrollPosition",value:function(){return Math.abs(jS(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);var a=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),l=a-s;i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),a=this.wtSettings.getSetting("fixedColumnsStart"),s=this.wtSettings.getSetting("totalRows");s?Ne(o,"emptyRows"):te(o,"emptyRows");var l=!1;if(a&&!i.length)te(o,"innerBorderLeft innerBorderInlineStart");else if(!a&&i.length){var u=Ae(o,"innerBorderInlineStart");n?(te(o,"innerBorderLeft innerBorderInlineStart"),l=!u):(Ne(o,"innerBorderLeft innerBorderInlineStart"),l=u)}return l}}]),r}(fp),Wde="stickyRowsTop",SU={getFirstRenderedRow:function(){var t=this.wtSettings.getSetting("totalRows");return t===0?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};Fo(SU,"MIXIN_NAME",Wde,{writable:!1,enumerable:!1});const CU=SU;function gl(t){"@babel/helpers - typeof";return gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gl(t)}function cA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zde(n.key),n)}}function Ude(t,e,r){return e&&cA(t.prototype,e),r&&cA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zde(t){var e=Yde(t,"string");return gl(e)==="symbol"?e:String(e)}function Yde(t,e){if(gl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $de(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lC(t,e)}function lC(t,e){return lC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},lC(t,e)}function Kde(t){var e=Zde();return function(){var r=ag(t),n;if(e){var o=ag(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qde(this,n)}}function qde(t,e){if(e&&(gl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xde(t)}function Xde(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Zde(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ag(t){return ag=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ag(t)}var wR=function(t){$de(r,t);var e=Kde(r);function r(n,o,i,a){return Gde(this,r),e.call(this,n,o,i,a,ja)}return Ude(r)}(pc);pt(wR,CU);pt(wR,pR);const Qde=wR;function vl(t){"@babel/helpers - typeof";return vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vl(t)}function em(t,e,r){return OU()?em=Reflect.construct.bind():em=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&sg(l,i.prototype),l},em.apply(null,arguments)}function Jde(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kU(n.key),n)}}function epe(t,e,r){return e&&fA(t.prototype,e),r&&fA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function tpe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sg(t,e)}function sg(t,e){return sg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},sg(t,e)}function npe(t){var e=OU();return function(){var r=lg(t),n;if(e){var o=lg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rpe(this,n)}}function rpe(t,e){if(e&&(vl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uC(t)}function uC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lg(t){return lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lg(t)}function hA(t,e,r){return e=kU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kU(t){var e=ope(t,"string");return vl(e)==="symbol"?e:String(e)}function ope(t,e){if(vl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ipe=function(t){tpe(r,t);var e=npe(r);function r(n,o,i,a,s,l){var u;return Jde(this,r),u=e.call(this,n,o,ja,i,a),hA(uC(u),"topOverlay",void 0),hA(uC(u),"inlineStartOverlay",void 0),u.topOverlay=s,u.inlineStartOverlay=l,u}return epe(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return em(Qde,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var n=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();iR(n,"".concat(o,"px"),"".concat(i,"px"))}else kv(n);var a=Rt(this.clone.wtTable.TABLE),s=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(a=0),n.style.height="".concat(a,"px"),n.style.width="".concat(s,"px"),!1}}]),r}(fp);function bl(t){"@babel/helpers - typeof";return bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bl(t)}function dA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,spe(n.key),n)}}function ape(t,e,r){return e&&dA(t.prototype,e),r&&dA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function spe(t){var e=lpe(t,"string");return bl(e)==="symbol"?e:String(e)}function lpe(t,e){if(bl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function upe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cpe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cC(t,e)}function cC(t,e){return cC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},cC(t,e)}function fpe(t){var e=ppe();return function(){var r=ug(t),n;if(e){var o=ug(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hpe(this,n)}}function hpe(t,e){if(e&&(bl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dpe(t)}function dpe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ppe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ug(t){return ug=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ug(t)}var SR=function(t){cpe(r,t);var e=fpe(r);function r(n,o,i,a){return upe(this,r),e.call(this,n,o,i,a,xa)}return ape(r)}(pc);pt(SR,CU);pt(SR,gR);const ype=SR;function wl(t){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wl(t)}function tm(t,e,r){return EU()?tm=Reflect.construct.bind():tm=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&cg(l,i.prototype),l},tm.apply(null,arguments)}function mpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TU(n.key),n)}}function gpe(t,e,r){return e&&pA(t.prototype,e),r&&pA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vpe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cg(t,e)}function cg(t,e){return cg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},cg(t,e)}function bpe(t){var e=EU();return function(){var r=fg(t),n;if(e){var o=fg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wpe(this,n)}}function wpe(t,e){if(e&&(wl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return RU(t)}function RU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fg(t){return fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fg(t)}function Spe(t,e,r){return e=TU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function TU(t){var e=Cpe(t,"string");return wl(e)==="symbol"?e:String(e)}function Cpe(t,e){if(wl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ope=function(t){vpe(r,t);var e=bpe(r);function r(n,o,i,a){var s;return mpe(this,r),s=e.call(this,n,o,xa,i,a),Spe(RU(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return gpe(r,[{key:"createTable",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return tm(ype,o)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var n=this.clone.wtTable.holder.parentNode,o=this.domBindings.rootWindow,i=this.wtSettings.getSetting("preventOverflow"),a=0,s=!1;if(this.trimmingContainer===o&&(!i||i!=="vertical")){var l=this.wot.wtTable,u=l.hider.getBoundingClientRect(),c=Math.ceil(u.bottom),f=n.offsetHeight;s=c===f,a=this.getOverlayOffset(),iR(n,"0px","".concat(a,"px"))}else a=this.getScrollPosition(),kv(n);var h=this.adjustHeaderBordersPosition(a,s);return this.adjustElementsSize(),h}},{key:"setScrollPosition",value:function(n){var o=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===o&&o.scrollY!==n?(o.scrollTo(nl(o),n),i=!0):this.mainTableScrollableElement.scrollTop!==n&&(this.mainTableScrollableElement.scrollTop=n,i=!0),i}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(n,o){for(var i=this.wtSettings.getSetting("defaultRowHeight"),a=n,s=0;a<o;){var l=this.wot.wtTable.getRowHeight(a);s+=l===void 0?i:l,a+=1}return s}},{key:"adjustElementsSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||n)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var n=this.wot.wtTable,o=this.domBindings,i=o.rootDocument,a=o.rootWindow,s=en(i),l=this.clone.wtTable.holder.parentNode,u=l.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==a||c==="horizontal"){var f=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(f-=s),f=Math.min(f,n.wtRootElement.scrollWidth),u.width="".concat(f,"px")}else u.width="";this.clone.wtTable.holder.style.width=u.width;var h=Rt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),u.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var n,o=this.clone.wtTable.holder,i=this.wot.selections,a=this.facadeGetter(),s=Math.abs((n=i==null?void 0:i.getCell().getBorder(a).cornerCenterPointOffset)!==null&&n!==void 0?n:0);this.clone.wtTable.hider.style.width=this.hider.style.width,o.style.width=o.parentNode.style.width,o.style.height="".concat(parseInt(o.parentNode.style.height,10)+s,"px")}},{key:"applyToDOM",value:function(){var n=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else if(n===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var n=this.isRtl()?"right":"left",o=this.clone.wtTable.spreader;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?o.style[n]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):o.style[n]=""}},{key:"scrollTo",value:function(n,o){var i=this.wot,a=this.wtSettings,s=i.cloneSource?i.cloneSource:i,l=s.wtTable.holder,u=this.getTableParentOffset(),c=0;if(o){var f=this.wot.wtTable.getRowHeight(n),h=this.wot.wtViewport.getViewportHeight();f>h&&(o=!1)}if(o&&l.offsetHeight!==l.clientHeight&&(c=en(this.domBindings.rootDocument)),o){var p=a.getSetting("fixedRowsBottom"),y=a.getSetting("totalRows");u+=this.sumCellSizes(0,n+1),u-=i.wtViewport.getViewportHeight()-this.sumCellSizes(y-p,y),u+=1}else u+=this.sumCellSizes(a.getSetting("fixedRowsTop"),n);return u+=c,this.setScrollPosition(u)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return Lm(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var n=this.domBindings.rootWindow,o=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===n&&(!o||o!=="vertical")){var a=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),l=a-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>l&&(i=0)}return i}},{key:"adjustHeaderBordersPosition",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=this.wot.wtTable.holder.parentNode,a=this.wtSettings.getSetting("totalColumns");a?Ne(i,"emptyColumns"):te(i,"emptyColumns");var s=!1;if(!o){var l=this.wtSettings.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=this.wtSettings.getSetting("columnHeaders");if((u||l===0)&&c.length>0){var f=Ae(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),n||this.wtSettings.getSetting("totalRows")===0?(te(i,"innerBorderTop"),s=!f):(Ne(i,"innerBorderTop"),s=f)}}return s}}]),r}(fp);function rh(t){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rh(t)}function ri(t,e,r){return kpe()?ri=Reflect.construct.bind():ri=function(n,o,i){var a=[null];a.push.apply(a,o);var s=Function.bind.apply(n,a),l=new s;return i&&fC(l,i.prototype),l},ri.apply(null,arguments)}function kpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fC(t,e){return fC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},fC(t,e)}function Rpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PU(n.key),n)}}function Epe(t,e,r){return e&&yA(t.prototype,e),r&&yA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $r(t,e,r){return e=PU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PU(t){var e=Tpe(t,"string");return rh(e)==="symbol"?e:String(e)}function Tpe(t,e){if(rh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ppe=function(){function t(e,r,n,o,i,a){var s=this;Rpe(this,t),$r(this,"wot",null),$r(this,"topOverlay",null),$r(this,"bottomOverlay",null),$r(this,"inlineStartOverlay",null),$r(this,"topInlineStartCornerOverlay",null),$r(this,"bottomInlineStartCornerOverlay",null),$r(this,"browserLineHeight",void 0),$r(this,"wtSettings",null),$r(this,"resizeObserver",new ResizeObserver(function(h){jk(function(){!Array.isArray(h)||!h.length||s.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=o,this.domBindings=n,this.facadeGetter=r,this.wtTable=a;var l=this.domBindings,u=l.rootDocument,c=l.rootWindow;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=en(u);var f=c.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=f?a.holder:Bm(a.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}return Epe(t,[{key:"getOverlays",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&r.push(this.wtTable),r}},{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,r=e.rootWindow,n=e.rootDocument,o=r.getComputedStyle(n.body),i=parseInt(o.lineHeight,10),a=parseInt(o.fontSize,10)*1.2;this.browserLineHeight=i||a}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=ri(Ope,e),this.bottomOverlay=ri(Sde,e),this.inlineStartOverlay=ri(Fde,e),this.topInlineStartCornerOverlay=ri(ipe,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=ri(nde,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var e=this,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=this.topOverlay.mainTableScrollableElement,a=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",function(p){return e.onKeyDown(p)}),this.eventManager.addEventListener(n.documentElement,"keyup",function(){return e.onKeyUp()}),this.eventManager.addEventListener(n,"visibilitychange",function(){return e.onKeyUp()}),this.eventManager.addEventListener(i,"scroll",function(p){return e.onTableScroll(p)},{passive:!0}),i!==a&&this.eventManager.addEventListener(a,"scroll",function(p){return e.onTableScroll(p)},{passive:!0});var s=o.devicePixelRatio&&o.devicePixelRatio>1,l=this.scrollableElement===o,u=this.wtSettings.getSetting("preventWheel"),c={passive:l};(u||s||!hF())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",function(p){return e.onCloneWheel(p,u)},c);var f=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];f.forEach(function(p){if(p&&p.needFullRender){var y=p.clone.wtTable.holder;e.eventManager.addEventListener(y,"wheel",function(g){return e.onCloneWheel(g,u)},c)}});var h;this.eventManager.addEventListener(o,"resize",function(){clearTimeout(h),h=setTimeout(function(){e.wtSettings.getSetting("onWindowResize")},200)}),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(o!==r&&i!==r&&!e.target.contains(o)||n!==r&&i!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,r){var n=this.domBindings.rootWindow,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,a=e.target,s=i!==n&&a!==n&&!a.contains(i),l=o!==n&&a!==n&&!a.contains(o);if(!(this.keyPressed&&(s||l))){var u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=jf(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);var o=this.scrollVertically(r),i=this.scrollHorizontally(n);return o||i}},{key:"scrollVertically",value:function(e){var r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,o=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],i=o[0],a=o[1];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==a||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=a),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,r=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable,r=this.domBindings.rootWindow;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Bm(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.updateLastSpreaderSize();r&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"updateLastSpreaderSize",value:function(){var e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,o=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),o}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.wot.wtViewport,n=this.wtTable,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),a=r.getRowHeaderWidth(),s=r.getColumnHeaderHeight(),l=n.hider.style;if(l.width="".concat(a+this.inlineStartOverlay.sumCellSizes(0,o),"px"),l.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var u=n.wtRootElement,c=u.scrollHeight,f=u.scrollWidth,h=n.holder,p=h.scrollHeight,y=h.scrollWidth;this.hasScrollbarRight=c<p,this.hasScrollbarBottom=f<y,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return _(r,function(o){o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(n=o.clone)}),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];_(r,function(n){n&&(n.clone.wtTable.TABLE.className=e.className)})}}]),t}();const Mpe=Ppe;function oh(t){"@babel/helpers - typeof";return oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oh(t)}function _pe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,MU(n.key),n)}}function xpe(t,e,r){return e&&mA(t.prototype,e),r&&mA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gA(t,e,r){return e=MU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MU(t){var e=Ape(t,"string");return oh(e)==="symbol"?e:String(e)}function Ape(t,e){if(oh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jpe=function(){function t(e){var r=this;_pe(this,t),gA(this,"settings",{}),gA(this,"defaults",Object.freeze(this.getDefaults())),$e(this.defaults,function(n,o){if(e[o]!==void 0)r.settings[o]=e[o];else{if(n===void 0)throw new Error('A required setting "'.concat(o,'" was not provided'));r.settings[o]=n}})}return xpe(t,[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(r,n,o){var i=e.getSetting("data",r,n);Pa(o,i??"")},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(r){return r},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(r){return r},onBeforeHighlightingColumnHeader:function(r){return r},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,r){var n=this;return r===void 0?$e(e,function(o,i){n.settings[i]=o}):this.settings[e]=r,this}},{key:"getSetting",value:function(e,r,n,o,i){return typeof this.settings[e]=="function"?this.settings[e](r,n,o,i):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),t}();function Sl(t){"@babel/helpers - typeof";return Sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sl(t)}function Ipe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dpe(n.key),n)}}function Hpe(t,e,r){return e&&vA(t.prototype,e),r&&vA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dpe(t){var e=Npe(t,"string");return Sl(e)==="symbol"?e:String(e)}function Npe(t,e){if(Sl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lpe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hC(t,e)}function hC(t,e){return hC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},hC(t,e)}function Bpe(t){var e=Wpe();return function(){var r=hg(t),n;if(e){var o=hg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vpe(this,n)}}function Vpe(t,e){if(e&&(Sl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fpe(t)}function Fpe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wpe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hg(t){return hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hg(t)}var CR=function(t){Lpe(r,t);var e=Bpe(r);function r(n,o,i,a){return Ipe(this,r),e.call(this,n,o,i,a,"master")}return Hpe(r,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var n=rl(this.wtRootElement),o=this.domBindings.rootWindow;if(n===o){var i=this.wtSettings.getSetting("preventOverflow");i||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var a=n.parentElement,s=Af(n,"height",o),l=Af(n,"overflow",o),u=this.holder.style,c=n.scrollWidth,f=n.scrollHeight,h=n.getBoundingClientRect(),p=h.width,y=h.height,g=["auto","hidden","scroll"];if(a&&g.includes(l)){var v=n.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",n.nextElementSibling?a.insertBefore(v,n.nextElementSibling):a.appendChild(v);var S=parseInt(Ma(v,o).height,10);a.removeChild(v),S===0&&(y=0)}y=Math.min(y,f),u.height=s==="auto"?"auto":"".concat(y,"px"),p=Math.min(p,c),u.width="".concat(p,"px"),u.overflow="",this.hasTableHeight=u.height==="auto"?!0:y>0,this.hasTableWidth=p>0}this.isTableVisible=_f(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var n=this.wtSettings,o=this.dataAccessObject.wtViewport,i="master",a=n.getSetting("columnHeaders"),s=a.length;if(s&&!o.hasOversizedColumnHeadersMarked[i]){for(var l=n.getSetting("rowHeaders"),u=l.length,c=this.getRenderedColumnsCount(),f=0;f<s;f++)for(var h=-1*u;h<c;h++)this.markIfOversizedColumnHeader(h);o.hasOversizedColumnHeadersMarked[i]=!0}}}]),r}(pc);pt(CR,bU);pt(CR,gR);const Upe=CR;function ih(t){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(t)}function zpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Gpe(n.key),n)}}function Ype(t,e,r){return e&&bA(t.prototype,e),r&&bA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gpe(t){var e=$pe(t,"string");return ih(e)==="symbol"?e:String(e)}function $pe(t,e){if(ih(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Kpe=function(){function t(e,r,n,o,i){var a=this;zpe(this,t),this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",function(){a.clientHeight=a.getWorkspaceHeight()})}return Ype(t,[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer,n=0;if(r===this.domBindings.rootWindow)n=e.documentElement.clientHeight;else{var o=Rt(r);n=o>0&&r.clientHeight>0?r.clientHeight:1/0}return n}},{key:"getWorkspaceWidth",value:function(){var e=this.wtSettings,r=this.domBindings,n=r.rootDocument,o=r.rootWindow,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,a=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),l=e.getSetting("preventOverflow"),u=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),f=u?c.right-a:c.left,h=a-f,p,y;if(l)return ut(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?p=Math.min(h,a):p=Math.min(this.getContainerFillWidth(),h,a),i===o&&s>0&&this.sumColumnWidths(0,s-1)>p)return n.documentElement.clientWidth;if(i!==o&&(y=Af(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o),y==="scroll"||y==="hidden"||y==="auto"))return Math.max(p,i.clientWidth);var g=e.getSetting("stretchH");return g==="none"||!g?Math.max(p,ut(this.wtTable.TABLE)):p}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,r){for(var n=0,o=e;o<r;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",e.appendChild(r);var n=r.offsetWidth;return this.containerWidth=n,e.removeChild(r),n}},{key:"getWorkspaceOffset",value:function(){return Wt(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){var e=this.wtSettings.getSetting("columnHeaders");return e.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Rt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,o=r.length;n<o;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var a=0,s=r.length;a<s;a++)i?(this.rowHeaderWidth+=ut(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var r=this.getRowHeaderWidth();return r>0?e-r:e}},{key:"createRowsCalculator",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qi,r=this.wtSettings,n=this.wtTable,o,i,a;this.rowHeaderWidth=NaN,r.getSetting("renderAllRows")&&e===qi?o=1/0:o=this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&s>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,l),s+=a,o-=a),u&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),o-=a),n.holder.clientHeight===n.holder.offsetHeight?i=0:i=en(this.domBindings.rootDocument),new YW({viewportSize:o,scrollOffset:s,totalItems:r.getSetting("totalRows"),itemSizeFn:function(f){return n.getRowHeight(f)},overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:qi,r=this.wtSettings,n=this.wtTable,o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var a=r.getSetting("fixedColumnsStart");if(a&&i>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);i+=s,o-=s}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=en(this.domBindings.rootDocument)),new fR({viewportSize:o,scrollOffset:i,totalItems:r.getSetting("totalColumns"),itemSizeFn:function(l){return n.getColumnWidth(l)},overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:r.getSetting("stretchH"),stretchingItemWidthFn:function(l,u){return r.getSetting("onBeforeStretchingColumnWidth",l,u)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=e;if(r){var n=this.createRowsCalculator(rn),o=this.createColumnsCalculator(rn);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(r=!1)}return r||(this.rowsRenderCalculator=this.createRowsCalculator(qi),this.columnsRenderCalculator=this.createColumnsCalculator(qi)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,r}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(rn),this.columnsVisibleCalculator=this.createColumnsCalculator(rn)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var r=e.startRow,n=e.endRow,o=e.isVisibleInTrimmingContainer;if(r===null&&n===null)return!o;var i=this.rowsRenderCalculator,a=i.startRow,s=i.endRow;return r<a||r===a&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var r=e.startColumn,n=e.endColumn,o=e.isVisibleInTrimmingContainer;if(r===null&&n===null)return!o;var i=this.columnsRenderCalculator,a=i.startColumn,s=i.endColumn;return r<a||r===a&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){$e(this.hasOversizedColumnHeadersMarked,function(e,r,n){n[r]=void 0})}}]),t}();const qpe=Kpe;function Cl(t){"@babel/helpers - typeof";return Cl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cl(t)}function Xpe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Qpe(n.key),n)}}function Zpe(t,e,r){return e&&wA(t.prototype,e),r&&wA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qpe(t){var e=Jpe(t,"string");return Cl(e)==="symbol"?e:String(e)}function Jpe(t,e){if(Cl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eye(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dC(t,e)}function dC(t,e){return dC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},dC(t,e)}function tye(t){var e=rye();return function(){var r=dg(t),n;if(e){var o=dg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nye(this,n)}}function nye(t,e){if(e&&(Cl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pC(t)}function pC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function dg(t){return dg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dg(t)}var oye=function(t){eye(r,t);var e=tye(r);function r(n,o){var i;Xpe(this,r),i=e.call(this,n,new jpe(o));var a=i.wtSettings.getSetting("facade",pC(i));return i.wtTable=new Upe(i.getTableDao(),a,i.domBindings,i.wtSettings),i.wtViewport=new qpe(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new tU(a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new Mpe(pC(i),a,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return Zpe(r,[{key:"exportSettingsAsClassNames",value:function(){var n=this,o={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},i=[],a=[];$e(o,function(s,l){n.wtSettings.getSetting(l).length&&a.push(s),i.push(s)}),Ne(this.wtTable.wtRootElement.parentNode,i),te(this.wtTable.wtRootElement.parentNode,a)}},{key:"getViewportDao",value:function(){var n=this;return{get wot(){return n},get topOverlayTrimmingContainer(){return n.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return n.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return n.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return n.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return n.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return n.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return n.wtOverlays.topOverlay},get inlineStartOverlay(){return n.wtOverlays.inlineStartOverlay},get bottomOverlay(){return n.wtOverlays.bottomOverlay}}}}]),r}(mR);function ah(t){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ah(t)}function iye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sye(n.key),n)}}function aye(t,e,r){return e&&SA(t.prototype,e),r&&SA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sye(t){var e=lye(t,"string");return ah(e)==="symbol"?e:String(e)}function lye(t,e){if(ah(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uye=function(){function t(e){iye(this,t),e instanceof mR?this._wot=e:this._initFromSettings(e)}return aye(t,[{key:"_initFromSettings",value:function(e){e.facade=function(r){var n=new t(r);return function(){return n}},this._wot=new oye(e.table,e)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,r){return this._wot.createCellCoords(e,r)}},{key:"createCellRange",value:function(e,r,n){return this._wot.createCellRange(e,r,n)}},{key:"draw",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}},{key:"getCell",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}},{key:"scrollViewport",value:function(e,r,n,o,i){return this._wot.scrollViewport(e,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(e,r,n){return this._wot.scrollViewportHorizontally(e,r,n)}},{key:"scrollViewportVertically",value:function(e,r,n){return this._wot.scrollViewportVertically(e,r,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,r){return this._wot.wtSettings.update(e,r),this}},{key:"getSetting",value:function(e,r,n,o,i){return this._wot.wtSettings.getSetting(e,r,n,o,i)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}]),t}(),cye=Nt,_U=We,fye=Ud,hye=Fn,dye=jd.f,pye=_U(dye),yye=_U([].push),CA=function(t){return function(e){for(var r=hye(e),n=fye(r),o=n.length,i=0,a=[],s;o>i;)s=n[i++],(!cye||pye(r,s))&&yye(a,t?[s,r[s]]:r[s]);return a}},mye={entries:CA(!0),values:CA(!1)},gye=_e,vye=mye.values;gye({target:"Object",stat:!0},{values:function(t){return vye(t)}});function sh(t){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sh(t)}function Rw(t,e){return Cye(t)||Sye(t,e)||wye(t,e)||bye()}function bye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wye(t,e){if(t){if(typeof t=="string")return OA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OA(t,e)}}function OA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Sye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Cye(t){if(Array.isArray(t))return t}function Oye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Rye(n.key),n)}}function kye(t,e,r){return e&&kA(t.prototype,e),r&&kA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rye(t){var e=Eye(t,"string");return sh(e)==="symbol"?e:String(e)}function Eye(t,e){if(sh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tye=function(){function t(e,r){Oye(this,t),r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}return kye(t,[{key:"registerListeners",value:function(){var e=this,r=this.wot.rootDocument.body;this.eventManager.addEventListener(r,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(r,"mouseup",function(){return e.onMouseUp()});for(var n=function(a){var s=e.main.childNodes[a];e.eventManager.addEventListener(s,"mouseenter",function(l){return e.onMouseEnter(l,e.main.childNodes[a])})},o=0,i=this.main.childNodes.length;o<i;o++)n(o)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Lr(e);var n=this,o=this.wot.rootDocument.body,i=r.getBoundingClientRect();r.style.display="none";function a(l){if(l.clientY<Math.floor(i.top)||l.clientY>Math.ceil(i.top+i.height)||l.clientX<Math.floor(i.left)||l.clientX>Math.ceil(i.left+i.width))return!0}function s(l){a(l)&&(n.eventManager.removeEventListener(o,"mousemove",s),r.style.display="block")}this.eventManager.addEventListener(o,"mousemove",s)}},{key:"createBorders",value:function(e){var r=this.wot.rootDocument;this.main=r.createElement("div");var n=["top","start","bottom","end","corner"],o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(var i=0;i<5;i++){var a=n[i],s=r.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[a]&&this.settings[a].hide&&(s.className+=" hidden"),o=s.style,o.backgroundColor=this.settings[a]&&this.settings[a].color?this.settings[a].color:e.border.color,o.height=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(e.border.width,"px"),o.width=this.settings[a]&&this.settings[a].width?"".concat(this.settings[a].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ir()&&this.createMultipleSelectorHandles(),this.disappear();var l=this.wot.wtTable,u=l.bordersHolder;u||(u=r.createElement("div"),u.className="htBorders",l.bordersHolder=u,l.spreader.appendChild(u)),u.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,r=this.wot.rootDocument;this.selectionHandles={top:r.createElement("DIV"),topHitArea:r.createElement("DIV"),bottom:r.createElement("DIV"),bottomHitArea:r.createElement("DIV")};var n=10,o=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var i={position:"absolute",height:"".concat(o,"px"),width:"".concat(o,"px"),"border-radius":"".concat(parseInt(o/1.5,10),"px")};$e(i,function(s,l){e.selectionHandles.styles.bottomHitArea[l]=s,e.selectionHandles.styles.topHitArea[l]=s});var a={position:"absolute",height:"".concat(n,"px"),width:"".concat(n,"px"),"border-radius":"".concat(parseInt(n/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};$e(a,function(s,l){e.selectionHandles.styles.bottom[l]=s,e.selectionHandles.styles.top[l]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,r){var n=this.wot.selections.createOrGetArea();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,r,n,o,i,a){var s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",u=this.selectionHandles.styles,c=u.top,f=u.topHitArea,h=u.bottom,p=u.bottomHitArea,y=parseInt(c.borderWidth,10),g=parseInt(c.width,10),v=parseInt(f.width,10),S=this.wot.wtTable.getWidth(),O=this.wot.wtTable.getHeight();c.top="".concat(parseInt(n-g-1,10),"px"),c[l]="".concat(parseInt(o-g-1,10),"px"),f.top="".concat(parseInt(n-v/4*3,10),"px"),f[l]="".concat(parseInt(o-v/4*3,10),"px");var w=Math.min(parseInt(o+i,10),S-g-y*2),x=Math.min(parseInt(o+i-v/4,10),S-v-y*2);h[l]="".concat(w,"px"),p[l]="".concat(x,"px");var T=Math.min(parseInt(n+a,10),O-g-y*2),z=Math.min(parseInt(n+a-v/4,10),O-v-y*2);h.top="".concat(T,"px"),p.top="".concat(z,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",f.display="block",this.isPartRange(e,r)?(h.display="none",p.display="none"):(h.display="block",p.display="block")):(c.display="none",h.display="none",f.display="none",p.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",f.zIndex="9999"):(c.zIndex="",f.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var r=this.wot,n=r.wtTable,o=r.rootDocument,i=r.rootWindow,a,s,l,u,c,f,h=n.getRenderedRowsCount(),p=0;p<h;p+=1){var y=n.rowFilter.renderedToSource(p);if(y>=e[0]&&y<=e[2]){a=y,c=e[0];break}}for(var g=h-1;g>=0;g-=1){var v=n.rowFilter.renderedToSource(g);if(v>=e[0]&&v<=e[2]){s=v;break}}for(var S=n.getRenderedColumnsCount(),O=0;O<S;O+=1){var w=n.columnFilter.renderedToSource(O);if(w>=e[1]&&w<=e[3]){l=w,f=e[1];break}}for(var x=S-1;x>=0;x-=1){var T=n.columnFilter.renderedToSource(x);if(T>=e[1]&&T<=e[3]){u=T;break}}if(a===void 0||l===void 0){this.disappear();return}var z=n.getCell(this.wot.createCellCoords(a,l)),$=a!==s||l!==u,ne=$?n.getCell(this.wot.createCellCoords(s,u)):z,G=Wt(z),q=$?Wt(ne):G,Z=Wt(n.TABLE),ee=ut(n.TABLE),Q=G.top,ce=G.left,fe=this.wot.wtSettings.getSetting("rtlMode"),we=0,Se=0;if(fe){var P=ut(z),d=i.innerWidth-Z.left-ee;Se=ce+P-q.left,we=i.innerWidth-ce-P-d-1}else Se=q.left+ut(ne)-ce,we=ce-Z.left-1;if(this.isEntireColumnSelected(a,s)){var m=this.getDimensionsFromHeader("columns",l,u,c,Z),b=null;if(m){var k=Rw(m,3);b=k[0],we=k[1],Se=k[2]}b&&(z=b)}var E=Q-Z.top-1,A=q.top+Rt(ne)-Q;if(this.isEntireRowSelected(l,u)){var W=this.getDimensionsFromHeader("rows",a,s,f,Z),N=null;if(W){var K=Rw(W,3);N=K[0],E=K[1],A=K[2]}N&&(z=N)}var X=Ma(z,i);parseInt(X.borderTopWidth,10)>0&&(E+=1,A=A>0?A-1:0),parseInt(X[fe?"borderRightWidth":"borderLeftWidth"],10)>0&&(we+=1,Se=Se>0?Se-1:0);var re=fe?"right":"left";this.topStyle.top="".concat(E,"px"),this.topStyle[re]="".concat(we,"px"),this.topStyle.width="".concat(Se,"px"),this.topStyle.display="block",this.startStyle.top="".concat(E,"px"),this.startStyle[re]="".concat(we,"px"),this.startStyle.height="".concat(A,"px"),this.startStyle.display="block";var me=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(E+A-me,"px"),this.bottomStyle[re]="".concat(we,"px"),this.bottomStyle.width="".concat(Se,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(E,"px"),this.endStyle[re]="".concat(we+Se-me,"px"),this.endStyle.height="".concat(A+1,"px"),this.endStyle.display="block";var le=this.settings.border.cornerVisible;le=typeof le=="function"?le(this.settings.layerLevel):le;var ke=this.wot.getSetting("onModifyGetCellCoords",s,u),be=s,Y=u;if(ke&&Array.isArray(ke)){var Le=Rw(ke,4);be=Le[2],Y=Le[3]}if(Ir()||!le||this.isPartRange(be,Y))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(E+A+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[re]="".concat(we+Se+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var He=rl(n.TABLE),Ee=He===i;Ee&&(He=o.documentElement);var De=parseInt(this.cornerDefaultStyle.width,10)/2,Me=parseInt(this.cornerDefaultStyle.height,10)/2;if(u===this.wot.getSetting("totalColumns")-1){var C=Ee?ne.getBoundingClientRect().left:ne.offsetLeft,R=!1,M=0;fe?(M=C-parseInt(this.cornerDefaultStyle.width,10)/2,R=M<0):(M=C+ut(ne)+parseInt(this.cornerDefaultStyle.width,10)/2,R=M>=$y(He)),R&&(this.cornerStyle[re]="".concat(Math.floor(we+Se+this.cornerCenterPointOffset-De),"px"),this.cornerStyle[fe?"borderLeftWidth":"borderRightWidth"]=0)}if(s===this.wot.getSetting("totalRows")-1){var B=Ee?ne.getBoundingClientRect().top:ne.offsetTop,I=B+Rt(ne)+parseInt(this.cornerDefaultStyle.height,10)/2,V=I>=si(He);V&&(this.cornerStyle.top="".concat(Math.floor(E+A+this.cornerCenterPointOffset-Me),"px"),this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Ir()&&this.updateMultipleSelectionHandlesPosition(s,u,E,we,Se,A)}}},{key:"isEntireColumnSelected",value:function(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,r,n,o,i){var a=this.wot.wtTable,s=a.wtRootElement.parentNode,l=null,u=null,c=null,f=null,h=null,p=null,y=null,g=null;switch(e){case"rows":l=function(){return a.getRowHeader.apply(a,arguments)},u=function(){return Rt.apply(void 0,arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return a.getColumnHeader.apply(a,arguments)},u=function(){return ut.apply(void 0,arguments)},c="ht__selection--columns",p="left";break}if(s.classList.contains(c)){var v=this.wot.getSetting("columnHeaders").length;if(y=l(r,v-o),g=l(n,v-o),!y||!g)return!1;var S=Wt(y),O=Wt(g);return y&&g&&(f=S[p]-i[p]-1,h=O[p]+u(g)-S[p]),[y,f,h]}return!1}},{key:"changeBorderStyle",value:function(e,r){var n=this[e].style,o=r[e];!o||o.hide?te(this[e],"hidden"):(Ae(this[e],"hidden")&&Ne(this[e],"hidden"),n.backgroundColor=o.color,(e==="top"||e==="bottom")&&(n.height="".concat(o.width,"px")),(e==="start"||e==="end")&&(n.width="".concat(o.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width="".concat(r.width,"px"),n.height="".concat(r.width,"px")}},{key:"toggleHiddenClass",value:function(e,r){this.changeBorderToDefaultStyle(e),r?te(this[e],"hidden"):Ne(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ir()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),t}();const Pye=Tye;function Mye(t,e){return jye(t)||Aye(t,e)||xye(t,e)||_ye()}function _ye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xye(t,e){if(t){if(typeof t=="string")return RA(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RA(t,e)}}function RA(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Aye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function jye(t){if(Array.isArray(t))return t}function Ol(t){"@babel/helpers - typeof";return Ol=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ol(t)}function Iye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dye(n.key),n)}}function Hye(t,e,r){return e&&EA(t.prototype,e),r&&EA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dye(t){var e=Nye(t,"string");return Ol(e)==="symbol"?e:String(e)}function Nye(t,e){if(Ol(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ol(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lye=function(){function t(e,r){Iye(this,t),this.settings=e,this.cellRange=r||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return Hye(t,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new Pye(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return this.cellRange===null}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}},{key:"addClassAtCoords",value:function(e,r,n,o){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,a=e.wtTable.getCell(this.settings.createCellCoords(r,n));if(Ol(a)==="object"){var s=o;i&&(s=this.classNameGenerator(a),this.classNames.includes(s)||this.classNames.push(s)),te(a,s)}return this}},{key:"linearClassNameGenerator",value:function(e,r){return function n(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(r===0||i===0)return e;var a=i>=0?i:r,s=e;a-=1;var l=a===0?e:"".concat(e,"-").concat(a);if(Ae(o,l)){var u=a+1;s="".concat(e,"-").concat(u)}else s=n(o,a);return s}}},{key:"draw",value:function(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}var r=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),i=Mye(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.settings,f=c.highlightHeaderClassName,h=c.highlightColumnClassName,p=c.highlightRowClassName,y=c.highlightOnlyClosestHeader,g=c.selectionType,v=g===void 0||["active-header","header"].includes(g);if(v&&s!==null&&u!==null)for(var S=0,O=0;O<n;O+=1){var w=e.wtTable.columnFilter.renderedToSource(O);if(w>=s&&w<=u){var x=e.wtTable.getColumnHeaders(w),T=x.length-1;y&&x.length>1&&(x=[x[T]]);for(var z=0;z<x.length;z+=1){var $=[],ne=x[z];f&&$.push(f),h&&$.push(h),z=y?T:z;var G=e.getSetting("onBeforeHighlightingColumnHeader",w,z,{selectionType:g,columnCursor:S,selectionWidth:u-s+1,classNames:$});G!==w&&(ne=e.wtTable.getColumnHeader(G,z)),te(ne,$)}S+=1}}if(a!==null&&l!==null)for(var q=0,Z=0;Z<r;Z+=1){var ee=e.wtTable.rowFilter.renderedToSource(Z);if(v&&ee>=a&&ee<=l){var Q=e.wtTable.getRowHeaders(ee),ce=Q.length-1;y&&Q.length>1&&(Q=[Q[ce]]);for(var fe=0;fe<Q.length;fe+=1){var we=[],Se=Q[fe];f&&we.push(f),p&&we.push(p),fe=y?ce:fe;var P=e.getSetting("onBeforeHighlightingRowHeader",ee,fe,{selectionType:g,rowCursor:q,selectionHeight:l-a+1,classNames:we});P!==ee&&(Se=e.wtTable.getRowHeader(P,fe)),te(Se,we)}q+=1}if(s!==null&&u!==null)for(var d=0;d<n;d+=1){var m=e.wtTable.columnFilter.renderedToSource(d);ee>=a&&ee<=l&&m>=s&&m<=u?this.settings.className&&this.addClassAtCoords(e,ee,m,this.settings.className,this.settings.markIntersections):ee>=a&&ee<=l?p&&this.addClassAtCoords(e,ee,m,p):m>=s&&m<=u&&h&&this.addClassAtCoords(e,ee,m,h);var b=e.getSetting("onAfterDrawSelection",ee,m,this.settings.layerLevel);typeof b=="string"&&this.addClassAtCoords(e,ee,m,b)}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach(function(e){return e.destroy()})}}]),t}();const Bye=Lye;function TA(t){var e=t.isShiftKey,r=t.isLeftClick,n=t.isRightClick,o=t.coords,i=t.selection,a=t.controller,s=t.cellCoordsFactory,l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&l)o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!a.cell?i.setRangeEnd(s(o.row,o.col)):u&&o.row<0&&!a.column?i.setRangeEnd(s(l.to.row,o.col)):c&&o.col<0&&!a.row?i.setRangeEnd(s(o.row,l.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!a.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!a.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{var f=!i.inInSelection(o),h=r||n&&f;o.row<0&&o.col>=0&&!a.column?h&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!a.row?h&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!a.cell?h&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Vye(t){var e=t.isLeftClick,r=t.coords,n=t.selection,o=t.controller,i=t.cellCoordsFactory;if(e){var a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();s&&!o.column?n.setRangeEnd(i(u-1,r.col)):a&&!o.row?n.setRangeEnd(i(r.row,l-1)):o.cell||n.setRangeEnd(r)}}var Fye=new Map([["mousedown",TA],["mouseover",Vye],["touchstart",TA]]);function PA(t,e){var r=e.coords,n=e.selection,o=e.controller,i=e.cellCoordsFactory;Fye.get(t.type)({coords:r,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:t.shiftKey,isLeftClick:lR(t)||t.type==="touchstart",isRightClick:_a(t)})}var xU=new WeakMap,OR=Symbol("rootInstance");function Wye(t){xU.set(t,!0)}function Uye(t){return t===OR}function yC(t){return xU.has(t)}function lh(t){"@babel/helpers - typeof";return lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lh(t)}function Ic(t,e){return Gye(t)||Yye(t,e)||AU(t,e)||zye()}function zye(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yye(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Gye(t){if(Array.isArray(t))return t}function MA(t){return qye(t)||Kye(t)||AU(t)||$ye()}function $ye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AU(t,e){if(t){if(typeof t=="string")return mC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mC(t,e)}}function Kye(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function qye(t){if(Array.isArray(t))return mC(t)}function mC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Xye(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jU(n.key),n)}}function Zye(t,e,r){return e&&_A(t.prototype,e),r&&_A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xA(t,e,r){Qye(t,e),e.set(t,r)}function Qye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(t,e,r){return e=jU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jU(t){var e=Jye(t,"string");return lh(e)==="symbol"?e:String(e)}function Jye(t,e){if(lh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AA(t,e){var r=IU(t,e,"get");return eme(t,r)}function eme(t,e){return e.get?e.get.call(t):e.value}function jA(t,e,r){var n=IU(t,e,"set");return tme(t,n,r),r}function IU(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function tme(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Di=new WeakMap,Ew=new WeakMap,Tw=new WeakMap,nme=function(){function t(e){Xye(this,t),Yo(this,"instance",void 0),Yo(this,"eventManager",void 0),Yo(this,"settings",void 0),Yo(this,"THEAD",void 0),Yo(this,"TBODY",void 0),Yo(this,"_wt",void 0),Yo(this,"activeWt",void 0),xA(this,Ew,{writable:!0,value:0}),xA(this,Tw,{writable:!0,value:0}),Yo(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new Tt(this.instance),this.settings=this.instance.getSettings(),Di.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return Zye(t,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,r){var n=this._wt.getCell(e,r);return n<0?null:n}},{key:"scrollViewport",value:function(e,r,n,o,i){return this._wt.scrollViewport(e,r,n,o,i)}},{key:"scrollViewportHorizontally",value:function(e,r,n){return this._wt.scrollViewportHorizontally(e,r,n)}},{key:"scrollViewportVertically",value:function(e,r,n){return this._wt.scrollViewportVertically(e,r,n)}},{key:"createElements",value:function(){var e=Di.get(this),r=this.instance,n=r.rootElement,o=r.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),te(n,"handsontable"),e.table=o.createElement("TABLE"),te(e.table,"htCore"),this.instance.getSettings().tableClassName&&te(e.table,this.instance.getSettings().tableClassName),this.THEAD=o.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=o.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,r=Di.get(this),n=this.instance,o=n.rootElement,i=n.rootDocument,a=n.selection,s=i.documentElement;this.eventManager.addEventListener(o,"mousedown",function(l){if(r.selectionMouseDown=!0,!e.isTextSelectionAllowed(l.target)){var u=e.instance.rootWindow;K_(u),l.preventDefault(),u.focus()}}),this.eventManager.addEventListener(o,"mouseup",function(){r.selectionMouseDown=!1}),this.eventManager.addEventListener(o,"mousemove",function(l){r.selectionMouseDown&&!e.isTextSelectionAllowed(l.target)&&(e.settings.fragmentSelection&&K_(e.instance.rootWindow),l.preventDefault())}),this.eventManager.addEventListener(s,"keyup",function(l){a.isInProgress()&&!l.shiftKey&&a.finish()}),this.eventManager.addEventListener(s,"mouseup",function(l){a.isInProgress()&&lR(l)&&a.finish(),r.mouseDown=!1,(aR(i.activeElement)||!a.isSelected()&&!a.isSelectedByAnyHeader()&&!o.contains(l.target)&&!_a(l))&&e.instance.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",function(l){a.isInProgress()&&_a(l)&&(a.finish(),r.mouseDown=!1)}),this.eventManager.addEventListener(s,"touchend",function(){a.isInProgress()&&a.finish(),r.mouseDown=!1}),this.eventManager.addEventListener(s,"mousedown",function(l){var u=l.target,c=l.x||l.clientX,f=l.y||l.clientY,h=l.target;if(!(r.mouseDown||!o||!e.instance.view)){var p=e.instance.view._wt.wtTable.holder;if(h===p){var y=en(i);if(i.elementFromPoint(c+y,f)!==p||i.elementFromPoint(c,f+y)!==p)return}else for(;h!==s;){if(h===null){if(l.isTargetWebComponent)break;return}if(h===o)return;h=h.parentNode}var g=typeof e.settings.outsideClickDeselects=="function"?e.settings.outsideClickDeselects(u):e.settings.outsideClickDeselects;g?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}}),this.eventManager.addEventListener(r.table,"selectstart",function(l){e.settings.fragmentSelection||Vm(l.target)||l.preventDefault()})}},{key:"translateFromRenderableToVisualCoords",value:function(e){var r,n=e.row,o=e.col;return(r=this.instance)._createCellCoords.apply(r,MA(this.translateFromRenderableToVisualIndex(n,o)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,r){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=r>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),o===null&&(o=r),[n,o]}},{key:"countRenderableIndexes",value:function(e,r){var n=Math.min(e.getNotTrimmedIndexesLength(),r),o=e.getNearestNotHiddenIndex(n-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,r){return this.countNotHiddenIndexes(e,r,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,r){return this.countNotHiddenIndexes(e,r,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,r,n,o){if(isNaN(e)||e<0)return 0;var i=n.getNearestNotHiddenIndex(e,r),a=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(a))return 0;var s=0;return r<0?s=a+1:r>0&&(s=o-a),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>r}},{key:"initializeWalkontable",value:function(){var e=this,r=Di.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:r.table,isDataViewInstance:function(){return yC(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(l,u){var c;return(c=e.instance).getDataAtCell.apply(c,MA(e.translateFromRenderableToVisualIndex(l,u)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var l=[];return e.instance.hasRowHeaders()&&l.push(function(u,c){var f=u>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(u):u;e.appendRowHeader(f,c)}),e.instance.runHooks("afterGetRowHeaderRenderers",l),jA(e,Tw,l.length),l},columnHeaders:function(){var l=[];return e.instance.hasColHeaders()&&l.push(function(u,c){var f=u>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(u):u;e.appendColHeader(f,c)}),e.instance.runHooks("afterGetColumnHeaderRenderers",l),jA(e,Ew,l.length),l},columnWidth:function(l){var u=e.instance.columnIndexMapper.getVisualFromRenderableIndex(l);return e.instance.getColWidth(u===null?l:u)},rowHeight:function(l){var u=e.instance.rowIndexMapper.getVisualFromRenderableIndex(l);return e.instance.getRowHeight(u===null?l:u)},cellRenderer:function(l,u,c){var f=e.translateFromRenderableToVisualIndex(l,u),h=Ic(f,2),p=h[0],y=h[1],g=e.instance.runHooks("modifyGetCellCoords",p,y),v=p,S=y;if(Array.isArray(g)){var O=Ic(g,2);v=O[0],S=O[1]}var w=e.instance.getCellMeta(v,S),x=e.instance.colToProp(S),T=e.instance.getDataAtRowProp(v,x);e.instance.hasHook("beforeValueRender")&&(T=e.instance.runHooks("beforeValueRender",T,w)),e.instance.runHooks("beforeRenderer",c,p,y,x,T,w),e.instance.getCellRenderer(w)(e.instance,c,p,y,x,T,w),e.instance.runHooks("afterRenderer",c,p,y,x,T,w)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onContainerElementResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(l,u,c,f){var h=e.translateFromRenderableToVisualCoords(u),p={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=f,r.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",l,h,c,p),!As(l)&&(PA(l,{coords:h,selection:e.instance.selection,controller:p,cellCoordsFactory:function(y,g){return e.instance._createCellCoords(y,g)}}),e.instance.runHooks("afterOnCellMouseDown",l,h,c),e.activeWt=e._wt)},onCellContextMenu:function(l,u,c,f){var h=e.translateFromRenderableToVisualCoords(u);e.activeWt=f,r.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",l,h,c),!As(l)&&(e.instance.runHooks("afterOnCellContextMenu",l,h,c),e.activeWt=e._wt)},onCellMouseOut:function(l,u,c,f){var h=e.translateFromRenderableToVisualCoords(u);e.activeWt=f,e.instance.runHooks("beforeOnCellMouseOut",l,h,c),!As(l)&&(e.instance.runHooks("afterOnCellMouseOut",l,h,c),e.activeWt=e._wt)},onCellMouseOver:function(l,u,c,f){var h=e.translateFromRenderableToVisualCoords(u),p={row:!1,column:!1,cell:!1};e.activeWt=f,e.instance.runHooks("beforeOnCellMouseOver",l,h,c,p),!As(l)&&(r.mouseDown&&PA(l,{coords:h,selection:e.instance.selection,controller:p,cellCoordsFactory:function(y,g){return e.instance._createCellCoords(y,g)}}),e.instance.runHooks("afterOnCellMouseOver",l,h,c),e.activeWt=e._wt)},onCellMouseUp:function(l,u,c,f){var h=e.translateFromRenderableToVisualCoords(u);e.activeWt=f,e.instance.runHooks("beforeOnCellMouseUp",l,h,c),!(As(l)||e.instance.isDestroyed)&&(e.instance.runHooks("afterOnCellMouseUp",l,h,c),e.activeWt=e._wt)},onCellCornerMouseDown:function(l){l.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",l)},onCellCornerDblClick:function(l){l.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",l)},beforeDraw:function(l,u){return e.beforeRender(l,u)},onDraw:function(l){return e.afterRender(l)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(l,u,c){var f=e.instance.rowIndexMapper,h=f.getVisualFromRenderableIndex(l),p=e.instance.runHooks("beforeHighlightingRowHeader",h,u,c);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(p,1))},onBeforeHighlightingColumnHeader:function(l,u,c){var f=e.instance.columnIndexMapper,h=f.getVisualFromRenderableIndex(l),p=e.instance.runHooks("beforeHighlightingColumnHeader",h,u,c);return f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(p,1))},onAfterDrawSelection:function(l,u,c){var f,h=e.translateFromRenderableToVisualIndex(l,u),p=Ic(h,2),y=p[0],g=p[1],v=e.instance.selection.getSelectedRange(),S=v.size();if(S>0){var O=(c??0)+1-S,w=v.peekByIndex(O);f=[w.from.row,w.from.col,w.to.row,w.to.col]}return e.instance.runHooks("afterDrawSelection",y,g,f,c)},onBeforeDrawBorders:function(l,u){var c=Ic(l,4),f=c[0],h=c[1],p=c[2],y=c[3],g=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(f),e.instance.columnIndexMapper.getVisualFromRenderableIndex(h),e.instance.rowIndexMapper.getVisualFromRenderableIndex(p),e.instance.columnIndexMapper.getVisualFromRenderableIndex(y)];return e.instance.runHooks("beforeDrawBorders",g,u)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(l,u){var c=e.instance.columnIndexMapper.getVisualFromRenderableIndex(u);return e.instance.runHooks("beforeStretchingColumnWidth",l,c)},onModifyRowHeaderWidth:function(l){return e.instance.runHooks("modifyRowHeaderWidth",l)},onModifyGetCellCoords:function(l,u,c){var f=e.instance.rowIndexMapper,h=e.instance.columnIndexMapper,p=u>=0?h.getVisualFromRenderableIndex(u):u,y=l>=0?f.getVisualFromRenderableIndex(l):l,g=e.instance.runHooks("modifyGetCellCoords",y,p,c);if(Array.isArray(g)){var v=Ic(g,4),S=v[0],O=v[1],w=v[2],x=v[3];return[S>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(S,1)):S,O>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(O,1)):O,w>=0?f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,-1)):w,x>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(x,-1)):x]}},viewportRowCalculatorOverride:function(l){var u=e.settings.viewportRowRenderingOffset;if(u==="auto"&&e.settings.fixedRowsTop&&(u=10),u>0||u==="auto"){var c=e.countRenderableRows(),f=l.startRow,h=l.endRow;if(typeof u=="number")l.startRow=Math.max(f-u,0),l.endRow=Math.min(h+u,c-1);else if(u==="auto"){var p=Math.ceil(h/c*12);l.startRow=Math.max(f-p,0),l.endRow=Math.min(h+p,c-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",l)},viewportColumnCalculatorOverride:function(l){var u=e.settings.viewportColumnRenderingOffset;if(u==="auto"&&e.settings.fixedColumnsStart&&(u=10),u>0||u==="auto"){var c=e.countRenderableColumns(),f=l.startColumn,h=l.endColumn;if(typeof u=="number"&&(l.startColumn=Math.max(f-u,0),l.endColumn=Math.min(h+u,c-1)),u==="auto"){var p=Math.ceil(h/c*6);l.startColumn=Math.max(f-p,0),l.endColumn=Math.min(h+p,c-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",l)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var l=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||l}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new uye(n),this.activeWt=this._wt;var o=this._wt.wtTable.spreader,i=this.instance.rootElement.getBoundingClientRect(),a=i.width,s=i.height;this.setLastSize(a,s),this.eventManager.addEventListener(o,"mousedown",function(l){l.target===o&&l.which===3&&l.stopPropagation()}),this.eventManager.addEventListener(o,"contextmenu",function(l){l.target===o&&l.which===3&&l.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())})}},{key:"isTextSelectionAllowed",value:function(e){if(Vm(e))return!0;var r=Ea(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}},{key:"isMouseDown",value:function(){return Di.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,r;return(e=(r=this.instance.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())!==null&&e!==void 0?e:!1}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,r){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,r)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,r){if(r.firstChild){var n=r.firstChild;if(!Ae(n,"relative")){Nr(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=this.instance,i=o.rootDocument,a=o.getRowHeader,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="rowHeader",this.updateCellHeader(l,e,a),s.appendChild(l),r.appendChild(s)}this.instance.runHooks("afterGetRowHeader",e,r)}},{key:"appendColHeader",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(r.firstChild){var i=r.firstChild;Ae(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n,o):(Nr(r),this.appendColHeader(e,r,n,o))}else{var a=this.instance.rootDocument,s=a.createElement("div"),l=a.createElement("span");s.className="relative",l.className="colHeader",this.updateCellHeader(l,e,n,o),s.appendChild(l),r.appendChild(s)}this.instance.runHooks("afterGetColHeader",e,r,o)}},{key:"updateCellHeader",value:function(e,r,n){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=r,a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ae(e,"colHeader")?i=a.wtTable.columnFilter.sourceToRendered(r):Ae(e,"rowHeader")&&(i=a.wtTable.rowFilter.sourceToRendered(r))),i>-1?dc(e,n(r,o)):(Pa(e,String.fromCharCode(160)),te(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var r=this._wt.wtViewport.getWorkspaceWidth(),n=r-e;return n>0?n:0}},{key:"maximumVisibleElementHeight",value:function(e){var r=this._wt.wtViewport.getWorkspaceHeight(),n=r-e;return n>0?n:0}},{key:"setLastSize",value:function(e,r){var n=Di.get(this),o=[e,r];n.lastWidth=o[0],n.lastHeight=o[1]}},{key:"getLastSize",value:function(){var e=Di.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return AA(this,Ew)}},{key:"getRowHeadersCount",value:function(){return AA(this,Tw)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),t}();const rme=nme;function gC(t){"@babel/helpers - typeof";return gC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gC(t)}var ome="ABCDEFGHIJKLMNOPQRSTUVWXYZ",IA=ome.length;function ime(t){for(var e=t+1,r="",n;e>0;)n=(e-1)%IA,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/IA,10);return r}function HA(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t,n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach(function(o,i){Array.isArray(o)?o.forEach(function(a,s){n.push([i+e,s,a])}):Object.keys(o).forEach(function(a){n.push([i+e,a,o[a]])})}),n}function HU(t){var e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ge(t[0])&&(e=Dk(t[0]))),e}function ame(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return Array.isArray(e)}))}function sme(t){return!!(Array.isArray(t)&&t.length&&t.every(function(e){return gC(e)==="object"&&!Array.isArray(e)&&e!==null}))}function uh(t){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uh(t)}function lme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cme(n.key),n)}}function ume(t,e,r){return e&&DA(t.prototype,e),r&&DA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cme(t){var e=fme(t,"string");return uh(e)==="symbol"?e:String(e)}function fme(t,e){if(uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hme=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];lme(this,t),this.hot=e,this.data=r,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return ume(t,[{key:"modifyRowData",value:function(e){var r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}},{key:"getData",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var r=this,n=[];return _(this.data,function(o,i){var a=r.getAtCell(i,e);n.push(a)}),n}},{key:"getAtRow",value:function(e,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=r===void 0&&n===void 0,s=null,l=null;if(s=this.modifyRowData(e),Array.isArray(s))l=[],a?s.forEach(function(f,h){l[h]=o.getAtPhysicalCell(e,h,s)}):Oe(r,n,function(f){l[f-r]=o.getAtPhysicalCell(e,f,s)});else if(Ge(s)||yt(s))if(i?l=[]:l={},!a||i){var u=0,c=this.countFirstRowKeys()-1;Oe(u,c,function(f){var h=o.colToProp(f);if(f>=(r||u)&&f<=(n||c)&&!Number.isInteger(h)){var p=o.getAtPhysicalCell(e,h,s);i?l.push(p):ew(l,h,p)}})}else $e(s,function(f,h){ew(l,h,o.getAtPhysicalCell(e,h,s))});return l}},{key:"setAtCell",value:function(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var o=tl(n);this.hot.runHooks("modifySourceData",e,r,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(r)?this.data[e][r]=n:ew(this.data[e],r,n)}}},{key:"getAtPhysicalCell",value:function(e,r,n){var o=null;if(n&&(typeof r=="string"?o=Lee(n,r):typeof r=="function"?o=r(n):o=n[r]),this.hot.hasHook("modifySourceData")){var i=tl(o);this.hot.runHooks("modifySourceData",e,r,i,"get"),i.isTouched()&&(o=i.value)}return o}},{key:"getAtCell",value:function(e,r){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}},{key:"getByRange",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=null,s=null,l=null,u=null;r===null||n===null?(i=!0,a=0,l=this.countRows()-1):(a=Math.min(r.row,n.row),s=Math.min(r.col,n.col),l=Math.max(r.row,n.row),u=Math.max(r.col,n.col));var c=[];return Oe(a,l,function(f){c.push(i?e.getAtRow(f,void 0,void 0,o):e.getAtRow(f,s,u,o))}),c}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return HU(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),t}();const dme=hme;var NA=Et,pme=function(t){return t!==void 0&&(NA(t,"value")||NA(t,"writable"))},yme=_e,mme=Gt,gme=Lt,vme=At,bme=pme,wme=Br,Sme=tv;function DU(t,e){var r=arguments.length<3?t:arguments[2],n,o;if(vme(t)===r)return t[e];if(n=wme.f(t,e),n)return bme(n)?n.value:n.get===void 0?void 0:mme(n.get,r);if(gme(o=Sme(t)))return DU(o,e,r)}yme({target:"Reflect",stat:!0},{get:DU});var Cme=_e,Ome=Fe,kme=Fn,NU=Br.f,LU=Nt,Rme=!LU||Ome(function(){NU(1)});Cme({target:"Object",stat:!0,forced:Rme,sham:!LU},{getOwnPropertyDescriptor:function(t,e){return NU(kme(t),e)}});var Eme="localHooks",BU={_localHooks:Object.create(null),addLocalHook:function(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks:function(t,e,r,n,o,i,a){if(this._localHooks[t])for(var s=this._localHooks[t].length,l=0;l<s;l++)IS(this._localHooks[t][l],this,e,r,n,o,i,a)},clearLocalHooks:function(){return this._localHooks={},this}};Fo(BU,"MIXIN_NAME",Eme,{writable:!1,enumerable:!1});const Pn=BU;function ch(t){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ch(t)}function Tme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mme(n.key),n)}}function Pme(t,e,r){return e&&LA(t.prototype,e),r&&LA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mme(t){var e=_me(t,"string");return ch(e)==="symbol"?e:String(e)}function _me(t,e){if(ch(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Xa=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Tme(this,t),this.indexedValues=[],this.initValueOrFn=e}return Pme(t,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var r=this.indexedValues;if(e<r.length)return r[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,yt(this.initValueOrFn)?Oe(r-1,function(n){return e.indexedValues.push(e.initValueOrFn(n))}):Oe(r-1,function(){return e.indexedValues.push(e.initValueOrFn)}),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),t}();pt(Xa,Pn);function Pw(t){return Ime(t)||jme(t)||Ame(t)||xme()}function xme(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ame(t,e){if(t){if(typeof t=="string")return vC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vC(t,e)}}function jme(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ime(t){if(Array.isArray(t))return vC(t)}function vC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kR(t,e,r,n){var o=r.length?r[0]:void 0;return[].concat(Pw(t.slice(0,o)),Pw(r.map(function(i,a){return yt(n)?n(i,a):n})),Pw(o===void 0?[]:t.slice(o)))}function RR(t,e){return Xn(t,function(r,n){return e.includes(n)===!1})}function kl(t){"@babel/helpers - typeof";return kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kl(t)}function Hme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nme(n.key),n)}}function Dme(t,e,r){return e&&BA(t.prototype,e),r&&BA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nme(t){var e=Lme(t,"string");return kl(e)==="symbol"?e:String(e)}function Lme(t,e){if(kl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function df(){return typeof Reflect<"u"&&Reflect.get?df=Reflect.get.bind():df=function(t,e,r){var n=Bme(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},df.apply(this,arguments)}function Bme(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ia(t),t!==null););return t}function Vme(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bC(t,e)}function bC(t,e){return bC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},bC(t,e)}function Fme(t){var e=zme();return function(){var r=Ia(t),n;if(e){var o=Ia(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wme(this,n)}}function Wme(t,e){if(e&&(kl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ume(t)}function Ume(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ia(t){return Ia=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ia(t)}var Ti=function(t){Vme(r,t);var e=Fme(r);function r(){return Hme(this,r),e.apply(this,arguments)}return Dme(r,[{key:"insert",value:function(n,o){this.indexedValues=kR(this.indexedValues,n,o,this.initValueOrFn),df(Ia(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=RR(this.indexedValues,n),df(Ia(r.prototype),"remove",this).call(this,n)}}]),r}(Xa);function Rl(t){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rl(t)}function Yme(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$me(n.key),n)}}function Gme(t,e,r){return e&&VA(t.prototype,e),r&&VA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $me(t){var e=Kme(t,"string");return Rl(e)==="symbol"?e:String(e)}function Kme(t,e){if(Rl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qme(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wC(t,e)}function wC(t,e){return wC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},wC(t,e)}function Xme(t){var e=Jme();return function(){var r=pg(t),n;if(e){var o=pg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Zme(this,n)}}function Zme(t,e){if(e&&(Rl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qme(t)}function Qme(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Jme(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pg(t){return pg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pg(t)}var Tv=function(t){qme(r,t);var e=Xme(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return Yme(this,r),e.call(this,n)}return Gme(r,[{key:"getHiddenIndexes",value:function(){return an(this.getValues(),function(n,o,i){return o&&n.push(i),n},[])}}]),r}(Ti);function Mw(t){return rge(t)||nge(t)||tge(t)||ege()}function ege(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tge(t,e){if(t){if(typeof t=="string")return SC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SC(t,e)}}function nge(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rge(t){if(Array.isArray(t))return SC(t)}function SC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ER(t,e,r){return[].concat(Mw(t.slice(0,e)),Mw(r),Mw(t.slice(e)))}function fh(t,e){return Xn(t,function(r){return e.includes(r)===!1})}function TR(t,e){return Ye(t,function(r){return r-e.filter(function(n){return n<r}).length})}function PR(t,e){var r=e[0],n=e.length;return Ye(t,function(o){return o>=r?o+n:o})}function El(t){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},El(t)}function oge(t){return lge(t)||sge(t)||age(t)||ige()}function ige(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function age(t,e){if(t){if(typeof t=="string")return CC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CC(t,e)}}function sge(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lge(t){if(Array.isArray(t))return CC(t)}function CC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function uge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FU(n.key),n)}}function cge(t,e,r){return e&&FA(t.prototype,e),r&&FA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oo(){return typeof Reflect<"u"&&Reflect.get?oo=Reflect.get.bind():oo=function(t,e,r){var n=fge(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},oo.apply(this,arguments)}function fge(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ur(t),t!==null););return t}function hge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OC(t,e)}function OC(t,e){return OC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},OC(t,e)}function dge(t){var e=yge();return function(){var r=ur(t),n;if(e){var o=ur(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pge(this,n)}}function pge(t,e){if(e&&(El(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return VU(t)}function VU(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ur(t){return ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ur(t)}function mge(t,e,r){return e=FU(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FU(t){var e=gge(t,"string");return El(e)==="symbol"?e:String(e)}function gge(t,e){if(El(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(El(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pv=function(t){hge(r,t);var e=dge(r);function r(){var n;uge(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),mge(VU(n),"orderOfIndexes",[]),n}return cge(r,[{key:"getValues",value:function(){var n=this;return this.orderOfIndexes.map(function(o){return n.indexedValues[o]})}},{key:"setValues",value:function(n){this.orderOfIndexes=oge(Array(n.length).keys()),oo(ur(r.prototype),"setValues",this).call(this,n)}},{key:"setValueAtIndex",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return n<this.indexedValues.length?(this.indexedValues[n]=o,this.orderOfIndexes.includes(n)===!1&&this.orderOfIndexes.splice(i,0,n),this.runLocalHooks("change"),!0):!1}},{key:"clearValue",value:function(n){this.orderOfIndexes=fh(this.orderOfIndexes,[n]),yt(this.initValueOrFn)?oo(ur(r.prototype),"setValueAtIndex",this).call(this,n,this.initValueOrFn(n)):oo(ur(r.prototype),"setValueAtIndex",this).call(this,n,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,oo(ur(r.prototype),"setDefaultValues",this).call(this,n)}},{key:"insert",value:function(n,o){this.indexedValues=kR(this.indexedValues,n,o,this.initValueOrFn),this.orderOfIndexes=PR(this.orderOfIndexes,o),oo(ur(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=RR(this.indexedValues,n),this.orderOfIndexes=fh(this.orderOfIndexes,n),this.orderOfIndexes=TR(this.orderOfIndexes,n),oo(ur(r.prototype),"remove",this).call(this,n)}},{key:"getEntries",value:function(){var n=this;return this.orderOfIndexes.map(function(o){return[o,n.getValueAtIndex(o)]})}}]),r}(Xa);function Tl(t){"@babel/helpers - typeof";return Tl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tl(t)}function vge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wge(n.key),n)}}function bge(t,e,r){return e&&WA(t.prototype,e),r&&WA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wge(t){var e=Sge(t,"string");return Tl(e)==="symbol"?e:String(e)}function Sge(t,e){if(Tl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kC(t,e)}function kC(t,e){return kC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},kC(t,e)}function Oge(t){var e=Ege();return function(){var r=yg(t),n;if(e){var o=yg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kge(this,n)}}function kge(t,e){if(e&&(Tl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rge(t)}function Rge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ege(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yg(t){return yg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yg(t)}var hp=function(t){Cge(r,t);var e=Oge(r);function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return vge(this,r),e.call(this,n)}return bge(r,[{key:"getTrimmedIndexes",value:function(){return an(this.getValues(),function(n,o,i){return o&&n.push(i),n},[])}}]),r}(Ti),UA=new Map([["indexesSequence",{getListWithInsertedItems:ER,getListWithRemovedItems:fh}],["physicallyIndexed",{getListWithInsertedItems:kR,getListWithRemovedItems:RR}]]),WU=function(t){if(UA.has(t)===!1)throw new Error("Alter strategy with ID '".concat(t,"' does not exist."));return UA.get(t)};function Pl(t){"@babel/helpers - typeof";return Pl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pl(t)}function Tge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mge(n.key),n)}}function Pge(t,e,r){return e&&zA(t.prototype,e),r&&zA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mge(t){var e=_ge(t,"string");return Pl(e)==="symbol"?e:String(e)}function _ge(t,e){if(Pl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Pl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pf(){return typeof Reflect<"u"&&Reflect.get?pf=Reflect.get.bind():pf=function(t,e,r){var n=xge(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},pf.apply(this,arguments)}function xge(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ha(t),t!==null););return t}function Age(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RC(t,e)}function RC(t,e){return RC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},RC(t,e)}function jge(t){var e=Dge();return function(){var r=Ha(t),n;if(e){var o=Ha(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ige(this,n)}}function Ige(t,e){if(e&&(Pl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hge(t)}function Hge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Dge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ha(t){return Ha=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ha(t)}var UU=function(t){Age(r,t);var e=jge(r);function r(){return Tge(this,r),e.call(this,function(n){return n})}return Pge(r,[{key:"insert",value:function(n,o){var i=PR(this.indexedValues,o);this.indexedValues=ER(i,n,o),pf(Ha(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){var o=fh(this.indexedValues,n);this.indexedValues=TR(o,n),pf(Ha(r.prototype),"remove",this).call(this,n)}}]),r}(Xa),YA=new Map([["hiding",Tv],["index",Xa],["linkedPhysicalIndexToValue",Pv],["physicalIndexToValue",Ti],["trimming",hp]]);function Nge(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!YA.has(t))throw new Error('The provided map type ("'.concat(t,'") does not exist.'));return new(YA.get(t))(e)}function hh(t){"@babel/helpers - typeof";return hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hh(t)}function Lge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vge(n.key),n)}}function Bge(t,e,r){return e&&GA(t.prototype,e),r&&GA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vge(t){var e=Fge(t,"string");return hh(e)==="symbol"?e:String(e)}function Fge(t,e){if(hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MR=function(){function t(){Lge(this,t),this.collection=new Map}return Bge(t,[{key:"register",value:function(e,r){var n=this;this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",function(){return n.runLocalHooks("change",r)}))}},{key:"unregister",value:function(e){var r=this.collection.get(e);pe(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach(function(r,n){return e.unregister(n)}),this.collection.clear()}},{key:"get",value:function(e){return dt(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach(function(r){r.remove(e)})}},{key:"insertToEvery",value:function(e,r){this.collection.forEach(function(n){n.insert(e,r)})}},{key:"initEvery",value:function(e){this.collection.forEach(function(r){r.init(e)})}}]),t}();pt(MR,Pn);function Ml(t){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ml(t)}function Wge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zge(n.key),n)}}function Uge(t,e,r){return e&&$A(t.prototype,e),r&&$A(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zge(t){var e=Yge(t,"string");return Ml(e)==="symbol"?e:String(e)}function Yge(t,e){if(Ml(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ml(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gge(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EC(t,e)}function EC(t,e){return EC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},EC(t,e)}function $ge(t){var e=Xge();return function(){var r=mg(t),n;if(e){var o=mg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kge(this,n)}}function Kge(t,e){if(e&&(Ml(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qge(t)}function qge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mg(t){return mg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mg(t)}var KA=function(t){Gge(r,t);var e=$ge(r);function r(n,o){var i;return Wge(this,r),i=e.call(this),i.mergedValuesCache=[],i.aggregationFunction=n,i.fallbackValue=o,i}return Uge(r,[{key:"getMergedValues",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(n===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];for(var o=Ye(this.get(),function(c){return c.getValues()}),i=[],a=pe(o[0])&&o[0].length||0,s=0;s<a;s+=1){for(var l=[],u=0;u<this.getLength();u+=1)l.push(o[u][s]);i.push(l)}return Ye(i,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(n,o){var i=this.getMergedValues(o)[n];return pe(i)?i:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),r}(MR);function dh(t){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dh(t)}function Zge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jge(n.key),n)}}function Qge(t,e,r){return e&&qA(t.prototype,e),r&&qA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Jge(t){var e=eve(t,"string");return dh(e)==="symbol"?e:String(e)}function eve(t,e){if(dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tve(t,e,r){nve(t,e),e.set(t,r)}function nve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rve(t,e,r){var n=zU(t,e,"set");return ove(t,n,r),r}function ove(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function ive(t,e){var r=zU(t,e,"get");return ave(t,r)}function zU(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function ave(t,e){return e.get?e.get.call(t):e.value}var _w=new WeakMap,YU=function(){function t(){Zge(this,t),tve(this,_w,{writable:!0,value:[]})}return Qge(t,[{key:"subscribe",value:function(e){return this.addLocalHook("change",e),this._write(ive(this,_w)),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){rve(this,_w,e)}}]),t}();pt(YU,Pn);function XA(t,e){for(var r=[],n=0,o=0;n<t.length&&o<e.length;n++,o++)t[n]!==e[o]&&r.push({op:"replace",index:o,oldValue:t[n],newValue:e[o]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;o<t.length;o++)r.push({op:"remove",index:o,oldValue:t[o],newValue:void 0});return r}function ph(t){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ph(t)}function sve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uve(n.key),n)}}function lve(t,e,r){return e&&ZA(t.prototype,e),r&&ZA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uve(t){var e=cve(t,"string");return ph(e)==="symbol"?e:String(e)}function cve(t,e){if(ph(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ph(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hc(t,e,r){fve(t,e),e.set(t,r)}function fve(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yn(t,e){var r=GU(t,e,"get");return hve(t,r)}function hve(t,e){return e.get?e.get.call(t):e.value}function Xp(t,e,r){var n=GU(t,e,"set");return dve(t,n,r),r}function GU(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function dve(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Zp=new WeakMap,Dc=new WeakMap,Qp=new WeakMap,Jp=new WeakMap,ey=new WeakMap,pve=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.initialIndexValue;sve(this,t),Hc(this,Zp,{writable:!0,value:new Set}),Hc(this,Dc,{writable:!0,value:[]}),Hc(this,Qp,{writable:!0,value:[]}),Hc(this,Jp,{writable:!0,value:!1}),Hc(this,ey,{writable:!0,value:!1}),Xp(this,ey,r??!1)}return lve(t,[{key:"createObserver",value:function(){var e=this,r=new YU;return Yn(this,Zp).add(r),r.addLocalHook("unsubscribe",function(){Yn(e,Zp).delete(r)}),r._writeInitialChanges(XA(Yn(this,Dc),Yn(this,Qp))),r}},{key:"emit",value:function(e){var r=Yn(this,Qp);(!Yn(this,Jp)||Yn(this,Dc).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Yn(this,ey)):Xp(this,Dc,new Array(e.length).fill(Yn(this,ey))),Yn(this,Jp)||(Xp(this,Jp,!0),r=Yn(this,Dc)));var n=XA(r,e);Yn(this,Zp).forEach(function(o){return o._write(n)}),Xp(this,Qp,e)}}]),t}();function yh(t){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yh(t)}var QA;function xw(t){return vve(t)||gve(t)||mve(t)||yve()}function yve(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mve(t,e){if(t){if(typeof t=="string")return TC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TC(t,e)}}function gve(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vve(t){if(Array.isArray(t))return TC(t)}function TC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function bve(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function wve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JA(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Cve(n.key),n)}}function Sve(t,e,r){return e&&JA(t.prototype,e),r&&JA(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cve(t){var e=Ove(t,"string");return yh(e)==="symbol"?e:String(e)}function Ove(t,e){if(yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ej=new Set(["getFirstNotHiddenIndex"]),PC=function(){function t(){var e=this;wve(this,t),this.indexesSequence=new UU,this.trimmingMapsCollection=new KA(function(r){return r.some(function(n){return n===!0})},!1),this.hidingMapsCollection=new KA(function(r){return r.some(function(n){return n===!0})},!1),this.variousMapsCollection=new MR,this.hidingChangesObservable=new pve({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",function(){e.indexesSequenceChanged=!0,e.updateCache(),e.runLocalHooks("indexesSequenceChange",e.indexesChangeSource),e.runLocalHooks("change",e.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",function(r){e.trimmedIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",function(r){e.hiddenIndexesChanged=!0,e.updateCache(),e.runLocalHooks("change",r,e.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",function(r){e.runLocalHooks("change",r,e.variousMapsCollection)})}return Sve(t,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if(e!=="hiding")throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,r,n){return this.registerMap(e,Nge(r,n))}},{key:"registerMap",value:function(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));r instanceof hp?this.trimmingMapsCollection.register(e,r):r instanceof Tv?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);var n=this.getNumberOfIndexes();return n>0&&r.init(n),r}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var r=this.notTrimmedIndexesCache[e];return pe(r)?r:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var r=this.renderablePhysicalIndexesCache[e];return pe(r)?r:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var r=this.fromPhysicalToVisualIndexesCache.get(e);return pe(r)?r:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var r=this.fromVisualToRenderableIndexesCache.get(e);return pe(r)?r:null}},{key:"getFirstNotHiddenIndex",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e-r;ej.has("getFirstNotHiddenIndex")&&(ej.delete("getFirstNotHiddenIndex"),lt(it(QA||(QA=bve([`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next 
                        major release. Please use "getNearestNotHiddenIndex" instead.`],[`The method "getFirstNotHiddenIndex" is deprecated and will be removed in the next\\x20
                        major release. Please use "getNearestNotHiddenIndex" instead.`])))));var i=this.getPhysicalFromVisualIndex(e);return i===null?n===!0&&o!==e-r?this.getFirstNotHiddenIndex(o,-r,!1,o):null:this.isHidden(i)===!1?e:this.getFirstNotHiddenIndex(e+r,r,n,o)}},{key:"getNearestNotHiddenIndex",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.getPhysicalFromVisualIndex(e);if(o===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var i=Array.from(this.fromVisualToRenderableIndexesCache.keys()),a=-1;return r>0?a=i.findIndex(function(s){return s>e}):a=i.reverse().findIndex(function(s){return s<e}),a===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:i[a]}},{key:"initToLength",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=xw(new Array(e).keys()),this.notHiddenIndexesCache=xw(new Array(e).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var r=this.getNumberOfIndexes();if(e<r){var n=xw(Array(this.getNumberOfIndexes()-e).keys()).map(function(o){return o+e});this.removeIndexes(n)}else this.insertIndexes(r,e-r)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.notTrimmedIndexesCache;var n=this.getIndexesSequence();return n.filter(function(o){return e.isTrimmed(o)===!1})}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.notHiddenIndexesCache;var n=this.getIndexesSequence();return n.filter(function(o){return e.isHidden(o)===!1})}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(r===!0)return this.renderablePhysicalIndexesCache;var n=this.getNotTrimmedIndexes();return n.filter(function(o){return e.isHidden(o)===!1})}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,r){var n=this;typeof e=="number"&&(e=[e]);var o=Ye(e,function(c){return n.getPhysicalFromVisualIndex(c)}),i=this.getNotTrimmedIndexesLength(),a=e.length,s=fh(this.getIndexesSequence(),o),l=i-a;if(r+a<i){var u=s.filter(function(c){return n.isTrimmed(c)===!1})[r];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(ER(s,l,o)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,r){var n=this.getNotTrimmedIndexes()[e],o=pe(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),a=Ye(new Array(r).fill(o),function(s,l){return s+l});this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,a),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,a),this.hidingMapsCollection.insertToEvery(i,a),this.variousMapsCollection.insertToEvery(i,a),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var r=0;r<e;r+=1){var n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var r=0;r<e;r+=1){var n=this.getPhysicalFromRenderableIndex(r),o=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(o,r)}}}]),t}();pt(PC,Pn);var tj;function kve(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Rve(t,e){return $e(e,function(r,n){dt(t[n])&&(t[n]=r)}),t}function $U(t){var e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/,r=e.exec(t);return r?"".concat(r[1].toLowerCase(),"-").concat(r[2].toUpperCase()):t}function KU(t){pe(t)&&sR(it(tj||(tj=kve(['Language with code "',`" was not found. You should register particular language 
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`],['Language with code "',`" was not found. You should register particular language\\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`])),t))}function Eve(t,e){var r=Array.isArray(t)&&Number.isInteger(e);return r?t[e]:t}var qU=nr("phraseFormatters"),Tve=qU.register,Pve=qU.getValues;function Mve(t,e){Tve(t,e)}function _ve(){return Pve()}Mve("pluralize",Eve);var XU="ContextMenu:items",Be=XU,_R="".concat(Be,".noItems"),xR="".concat(Be,".insertRowAbove"),AR="".concat(Be,".insertRowBelow"),jR="".concat(Be,".insertColumnOnTheLeft"),IR="".concat(Be,".insertColumnOnTheRight"),HR="".concat(Be,".removeRow"),DR="".concat(Be,".removeColumn"),NR="".concat(Be,".undo"),LR="".concat(Be,".redo"),BR="".concat(Be,".readOnly"),VR="".concat(Be,".clearColumn"),FR="".concat(Be,".copy"),WR="".concat(Be,".copyWithHeaders"),UR="".concat(Be,".copyWithGroupHeaders"),zR="".concat(Be,".copyHeadersOnly"),YR="".concat(Be,".cut"),GR="".concat(Be,".freezeColumn"),$R="".concat(Be,".unfreezeColumn"),KR="".concat(Be,".mergeCells"),qR="".concat(Be,".unmergeCells"),XR="".concat(Be,".addComment"),ZR="".concat(Be,".editComment"),QR="".concat(Be,".removeComment"),JR="".concat(Be,".readOnlyComment"),eE="".concat(Be,".align"),tE="".concat(Be,".align.left"),nE="".concat(Be,".align.center"),rE="".concat(Be,".align.right"),oE="".concat(Be,".align.justify"),iE="".concat(Be,".align.top"),aE="".concat(Be,".align.middle"),sE="".concat(Be,".align.bottom"),lE="".concat(Be,".borders"),uE="".concat(Be,".borders.top"),cE="".concat(Be,".borders.right"),fE="".concat(Be,".borders.bottom"),hE="".concat(Be,".borders.left"),dE="".concat(Be,".borders.remove"),pE="".concat(Be,".nestedHeaders.insertChildRow"),yE="".concat(Be,".nestedHeaders.detachFromParent"),mE="".concat(Be,".hideColumn"),gE="".concat(Be,".showColumn"),vE="".concat(Be,".hideRow"),bE="".concat(Be,".showRow"),vn="Filters:",Pt="".concat(vn,"conditions"),Mv="".concat(Pt,".none"),wE="".concat(Pt,".isEmpty"),SE="".concat(Pt,".isNotEmpty"),CE="".concat(Pt,".isEqualTo"),OE="".concat(Pt,".isNotEqualTo"),kE="".concat(Pt,".beginsWith"),RE="".concat(Pt,".endsWith"),EE="".concat(Pt,".contains"),TE="".concat(Pt,".doesNotContain"),xve="".concat(Pt,".byValue"),PE="".concat(Pt,".greaterThan"),ME="".concat(Pt,".greaterThanOrEqualTo"),_E="".concat(Pt,".lessThan"),xE="".concat(Pt,".lessThanOrEqualTo"),AE="".concat(Pt,".isBetween"),jE="".concat(Pt,".isNotBetween"),IE="".concat(Pt,".after"),HE="".concat(Pt,".before"),DE="".concat(Pt,".today"),NE="".concat(Pt,".tomorrow"),LE="".concat(Pt,".yesterday"),BE="".concat(vn,"labels.filterByCondition"),VE="".concat(vn,"labels.filterByValue"),FE="".concat(vn,"labels.conjunction"),_v="".concat(vn,"labels.disjunction"),gg="".concat(vn,"values.blankCells"),WE="".concat(vn,"buttons.selectAll"),UE="".concat(vn,"buttons.clear"),zE="".concat(vn,"buttons.ok"),YE="".concat(vn,"buttons.cancel"),GE="".concat(vn,"buttons.placeholder.search"),$E="".concat(vn,"buttons.placeholder.value"),KE="".concat(vn,"buttons.placeholder.secondValue");const Ave=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:XR,CONTEXTMENU_ITEMS_ALIGNMENT:eE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:sE,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:nE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:oE,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:tE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:aE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:rE,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:iE,CONTEXTMENU_ITEMS_BORDERS:lE,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:fE,CONTEXTMENU_ITEMS_BORDERS_LEFT:hE,CONTEXTMENU_ITEMS_BORDERS_RIGHT:cE,CONTEXTMENU_ITEMS_BORDERS_TOP:uE,CONTEXTMENU_ITEMS_CLEAR_COLUMN:VR,CONTEXTMENU_ITEMS_COPY:FR,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:zR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:UR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:WR,CONTEXTMENU_ITEMS_CUT:YR,CONTEXTMENU_ITEMS_EDIT_COMMENT:ZR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:GR,CONTEXTMENU_ITEMS_HIDE_COLUMN:mE,CONTEXTMENU_ITEMS_HIDE_ROW:vE,CONTEXTMENU_ITEMS_INSERT_LEFT:jR,CONTEXTMENU_ITEMS_INSERT_RIGHT:IR,CONTEXTMENU_ITEMS_MERGE_CELLS:KR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:yE,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:pE,CONTEXTMENU_ITEMS_NO_ITEMS:_R,CONTEXTMENU_ITEMS_READ_ONLY:BR,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:JR,CONTEXTMENU_ITEMS_REDO:LR,CONTEXTMENU_ITEMS_REMOVE_BORDERS:dE,CONTEXTMENU_ITEMS_REMOVE_COLUMN:DR,CONTEXTMENU_ITEMS_REMOVE_COMMENT:QR,CONTEXTMENU_ITEMS_REMOVE_ROW:HR,CONTEXTMENU_ITEMS_ROW_ABOVE:xR,CONTEXTMENU_ITEMS_ROW_BELOW:AR,CONTEXTMENU_ITEMS_SHOW_COLUMN:gE,CONTEXTMENU_ITEMS_SHOW_ROW:bE,CONTEXTMENU_ITEMS_UNDO:NR,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:$R,CONTEXTMENU_ITEMS_UNMERGE_CELLS:qR,CONTEXT_MENU_ITEMS_NAMESPACE:XU,FILTERS_BUTTONS_CANCEL:YE,FILTERS_BUTTONS_CLEAR:UE,FILTERS_BUTTONS_OK:zE,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:GE,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:KE,FILTERS_BUTTONS_PLACEHOLDER_VALUE:$E,FILTERS_BUTTONS_SELECT_ALL:WE,FILTERS_CONDITIONS_AFTER:IE,FILTERS_CONDITIONS_BEFORE:HE,FILTERS_CONDITIONS_BEGINS_WITH:kE,FILTERS_CONDITIONS_BETWEEN:AE,FILTERS_CONDITIONS_BY_VALUE:xve,FILTERS_CONDITIONS_CONTAINS:EE,FILTERS_CONDITIONS_EMPTY:wE,FILTERS_CONDITIONS_ENDS_WITH:RE,FILTERS_CONDITIONS_EQUAL:CE,FILTERS_CONDITIONS_GREATER_THAN:PE,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ME,FILTERS_CONDITIONS_LESS_THAN:_E,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:xE,FILTERS_CONDITIONS_NAMESPACE:Pt,FILTERS_CONDITIONS_NONE:Mv,FILTERS_CONDITIONS_NOT_BETWEEN:jE,FILTERS_CONDITIONS_NOT_CONTAIN:TE,FILTERS_CONDITIONS_NOT_EMPTY:SE,FILTERS_CONDITIONS_NOT_EQUAL:OE,FILTERS_CONDITIONS_TODAY:DE,FILTERS_CONDITIONS_TOMORROW:NE,FILTERS_CONDITIONS_YESTERDAY:LE,FILTERS_DIVS_FILTER_BY_CONDITION:BE,FILTERS_DIVS_FILTER_BY_VALUE:VE,FILTERS_LABELS_CONJUNCTION:FE,FILTERS_LABELS_DISJUNCTION:_v,FILTERS_NAMESPACE:vn,FILTERS_VALUES_BLANK_CELLS:gg},Symbol.toStringTag,{value:"Module"}));function mh(t){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mh(t)}var se;function ue(t,e,r){return e=jve(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jve(t){var e=Ive(t,"string");return mh(e)==="symbol"?e:String(e)}function Ive(t,e){if(mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Hve=(se={languageCode:"en-US"},ue(se,_R,"No available options"),ue(se,xR,"Insert row above"),ue(se,AR,"Insert row below"),ue(se,jR,"Insert column left"),ue(se,IR,"Insert column right"),ue(se,HR,["Remove row","Remove rows"]),ue(se,DR,["Remove column","Remove columns"]),ue(se,NR,"Undo"),ue(se,LR,"Redo"),ue(se,BR,"Read only"),ue(se,VR,"Clear column"),ue(se,eE,"Alignment"),ue(se,tE,"Left"),ue(se,nE,"Center"),ue(se,rE,"Right"),ue(se,oE,"Justify"),ue(se,iE,"Top"),ue(se,aE,"Middle"),ue(se,sE,"Bottom"),ue(se,GR,"Freeze column"),ue(se,$R,"Unfreeze column"),ue(se,lE,"Borders"),ue(se,uE,"Top"),ue(se,cE,"Right"),ue(se,fE,"Bottom"),ue(se,hE,"Left"),ue(se,dE,"Remove border(s)"),ue(se,XR,"Add comment"),ue(se,ZR,"Edit comment"),ue(se,QR,"Delete comment"),ue(se,JR,"Read-only comment"),ue(se,KR,"Merge cells"),ue(se,qR,"Unmerge cells"),ue(se,FR,"Copy"),ue(se,WR,["Copy with header","Copy with headers"]),ue(se,UR,["Copy with group header","Copy with group headers"]),ue(se,zR,["Copy header only","Copy headers only"]),ue(se,YR,"Cut"),ue(se,pE,"Insert child row"),ue(se,yE,"Detach from parent"),ue(se,mE,["Hide column","Hide columns"]),ue(se,gE,["Show column","Show columns"]),ue(se,vE,["Hide row","Hide rows"]),ue(se,bE,["Show row","Show rows"]),ue(se,Mv,"None"),ue(se,wE,"Is empty"),ue(se,SE,"Is not empty"),ue(se,CE,"Is equal to"),ue(se,OE,"Is not equal to"),ue(se,kE,"Begins with"),ue(se,RE,"Ends with"),ue(se,EE,"Contains"),ue(se,TE,"Does not contain"),ue(se,PE,"Greater than"),ue(se,ME,"Greater than or equal to"),ue(se,_E,"Less than"),ue(se,xE,"Less than or equal to"),ue(se,AE,"Is between"),ue(se,jE,"Is not between"),ue(se,IE,"After"),ue(se,HE,"Before"),ue(se,DE,"Today"),ue(se,NE,"Tomorrow"),ue(se,LE,"Yesterday"),ue(se,gg,"Blank cells"),ue(se,BE,"Filter by condition"),ue(se,VE,"Filter by value"),ue(se,FE,"And"),ue(se,_v,"Or"),ue(se,WE,"Select all"),ue(se,UE,"Clear"),ue(se,zE,"OK"),ue(se,YE,"Cancel"),ue(se,GE,"Search"),ue(se,$E,"Value"),ue(se,KE,"Second value"),se);const ZU=Hve;var MC=ZU.languageCode,xv=nr("languagesDictionaries"),Dve=xv.register,QU=xv.getItem,Nve=xv.hasItem,Lve=xv.getValues;JU(ZU);function JU(t,e){var r=t,n=e;return Ge(t)&&(n=t,r=n.languageCode),Bve(r,n),Dve(r,yn(n)),yn(n)}function Bve(t,e){t!==MC&&Rve(e,QU(MC))}function e2(t){return qE(t)?yn(QU(t)):null}function qE(t){return Nve(t)}function Vve(){return Lve()}function t2(t,e,r){var n=e2(t);if(n===null)return null;var o=n[e];if(dt(o))return null;var i=Fve(o,r);return Array.isArray(i)?i[0]:i}function Fve(t,e){var r=t;return _(_ve(),function(n){r=n(t,e)}),r}function Wve(t){var e=$U(t);return qE(e)||(e=MC,KU(t)),e}var Uve=_e,zve=Nt,Yve=gB,Gve=Fn,$ve=Br,Kve=lc;Uve({target:"Object",stat:!0,sham:!zve},{getOwnPropertyDescriptors:function(t){for(var e=Gve(t),r=$ve.f,n=Yve(e),o={},i=0,a,s;n.length>i;)s=r(e,a=n[i++]),s!==void 0&&Kve(o,a,s);return o}});var Av="active-header",jv="area",gh="cell",XE="fill",dp="header",ZE="custom-selection";function _l(t){"@babel/helpers - typeof";return _l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_l(t)}function qve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,r2(n.key),n)}}function Xve(t,e,r){return e&&nj(t.prototype,e),r&&nj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nm(){return typeof Reflect<"u"&&Reflect.get?nm=Reflect.get.bind():nm=function(t,e,r){var n=Zve(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},nm.apply(this,arguments)}function Zve(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xl(t),t!==null););return t}function Qve(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_C(t,e)}function _C(t,e){return _C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},_C(t,e)}function Jve(t){var e=tbe();return function(){var r=xl(t),n;if(e){var o=xl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ebe(this,n)}}function ebe(t,e){if(e&&(_l(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n2(t)}function n2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tbe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xl(t){return xl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xl(t)}function nbe(t,e,r){return e=r2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r2(t){var e=rbe(t,"string");return _l(e)==="symbol"?e:String(e)}function rbe(t,e){if(_l(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_l(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var obe=function(t){Qve(r,t);var e=Jve(r);function r(n,o){var i;return qve(this,r),i=e.call(this,n,null),nbe(n2(i),"visualCellRange",null),i.visualCellRange=o||null,i.commit(),i}return Xve(r,[{key:"add",value:function(n){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(n):this.visualCellRange.expand(n),this}},{key:"clear",value:function(){return this.visualCellRange=null,nm(xl(r.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(n){var o=n.from,i=n.to,a=this.getNearestNotHiddenCoords(o,1),s=this.getNearestNotHiddenCoords(i,-1);if(a===null||s===null)return null;if(a.row>s.row||a.col>s.col){var l=this.settings.type==="header"||this.settings.type==="active-header";if(!l)return null;a=o,s=i}return this.settings.createCellRange(a,a,s)}},{key:"getNearestNotHiddenCoords",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o,a=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),n.row,o);if(a===null)return null;var s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),n.col,i);return s===null?null:this.settings.createCellCoords(a,s)}},{key:"getNearestNotHiddenIndex",value:function(n,o,i){if(o<0)return o;var a=n.getNearestNotHiddenIndex(o,i),s=this.settings.type==="header"||this.settings.type==="active-header";return s&&a===null?-1:a}},{key:"commit",value:function(){if(this.visualCellRange===null)return this;var n=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return n===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(n.from,n.to),this}},{key:"syncWith",value:function(n){var o=n.getVerticalDirection()==="N-S"?1:-1,i=n.getHorizontalDirection()==="W-E"?1:-1,a=this.getNearestNotHiddenCoords(n.from.clone().normalize(),o,i);if(a!==null&&n.overlaps(a)){if(this.cellRange===null){var s=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(s)}return n.setHighlight(a),this}return n.setHighlight(n.from),this}},{key:"getCorners",value:function(){var n=this.cellRange,o=n.from,i=n.to,a=o.row===null||i.row===null,s=o.col===null||i.col===null,l=this.settings.createCellCoords(a?null:Math.min(o.row,i.row),s?null:Math.min(o.col,i.col)),u=this.settings.createCellCoords(a?null:Math.max(o.row,i.row),s?null:Math.max(o.col,i.col));return[l.row,l.col,u.row,u.col]}},{key:"getVisualCorners",value:function(){var n=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),o=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[n.row,n.col,o.row,o.col]}},{key:"createRenderableCellRange",value:function(n,o){var i=this.settings.visualToRenderableCoords(n),a=this.settings.visualToRenderableCoords(o);return this.settings.createCellRange(i,i,a)}}]),r}(Bye);const yc=obe;function vh(t){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vh(t)}var ibe=["activeHeaderClassName"];function rj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function oj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?rj(Object(r),!0).forEach(function(n){abe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function abe(t,e,r){return e=sbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sbe(t){var e=lbe(t,"string");return vh(e)==="symbol"?e:String(e)}function lbe(t,e){if(vh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ube(t,e){if(t==null)return{};var r=cbe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function cbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function fbe(t){var e=t.activeHeaderClassName,r=ube(t,ibe),n=new yc(oj(oj({highlightHeaderClassName:e},r),{},{selectionType:Av}));return n}function bh(t){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bh(t)}var hbe=["layerLevel","areaCornerVisible"];function ij(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function aj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ij(Object(r),!0).forEach(function(n){dbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dbe(t,e,r){return e=pbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pbe(t){var e=ybe(t,"string");return bh(e)==="symbol"?e:String(e)}function ybe(t,e){if(bh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mbe(t,e){if(t==null)return{};var r=gbe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function gbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function vbe(t){var e=t.layerLevel,r=t.areaCornerVisible,n=mbe(t,hbe),o=new yc(aj(aj({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:r}},n),{},{selectionType:jv}));return o}function wh(t){"@babel/helpers - typeof";return wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wh(t)}var bbe=["cellCornerVisible"];function sj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function lj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sj(Object(r),!0).forEach(function(n){wbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function wbe(t,e,r){return e=Sbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sbe(t){var e=Cbe(t,"string");return wh(e)==="symbol"?e:String(e)}function Cbe(t,e){if(wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Obe(t,e){if(t==null)return{};var r=kbe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function kbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Rbe(t){var e=t.cellCornerVisible,r=Obe(t,bbe),n=new yc(lj(lj({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e}},r),{},{selectionType:gh}));return n}function Sh(t){"@babel/helpers - typeof";return Sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sh(t)}var Ebe=["border","visualCellRange"];function uj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Aw(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uj(Object(r),!0).forEach(function(n){Tbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Tbe(t,e,r){return e=Pbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pbe(t){var e=Mbe(t,"string");return Sh(e)==="symbol"?e:String(e)}function Mbe(t,e){if(Sh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _be(t,e){if(t==null)return{};var r=xbe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function xbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Abe(t){var e=t.border,r=t.visualCellRange,n=_be(t,Ebe),o=new yc(Aw(Aw(Aw({},e),n),{},{selectionType:ZE}),r);return o}var cj=Nt,jbe=We,Ibe=Gt,Hbe=Fe,jw=Ud,Dbe=Fd,Nbe=jd,Lbe=Tn,Bbe=Hd,ls=Object.assign,fj=Object.defineProperty,Vbe=jbe([].concat),Fbe=!ls||Hbe(function(){if(cj&&ls({b:1},ls(fj({},"a",{enumerable:!0,get:function(){fj(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(o){e[o]=o}),ls({},t)[r]!=7||jw(ls({},e)).join("")!=n})?function(t,e){for(var r=Lbe(t),n=arguments.length,o=1,i=Dbe.f,a=Nbe.f;n>o;)for(var s=Bbe(arguments[o++]),l=i?Vbe(jw(s),i(s)):jw(s),u=l.length,c=0,f;u>c;)f=l[c++],(!cj||Ibe(a,s,f))&&(r[f]=s[f]);return r}:ls,Wbe=_e,hj=Fbe;Wbe({target:"Object",stat:!0,arity:2,forced:Object.assign!==hj},{assign:hj});function Ch(t){"@babel/helpers - typeof";return Ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ch(t)}function dj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function pj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?dj(Object(r),!0).forEach(function(n){Ube(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ube(t,e,r){return e=zbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zbe(t){var e=Ybe(t,"string");return Ch(e)==="symbol"?e:String(e)}function Ybe(t,e){if(Ch(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ch(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gbe(t){if(t==null)throw new TypeError("Cannot destructure "+t)}function $be(t){var e=Object.assign({},(Gbe(t),t)),r=new yc(pj(pj({className:"fill",border:{width:1,color:"#ff0000"}},e),{},{selectionType:XE}));return r}function Oh(t){"@babel/helpers - typeof";return Oh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oh(t)}var Kbe=["headerClassName","rowClassName","columnClassName"];function yj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function mj(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yj(Object(r),!0).forEach(function(n){qbe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function qbe(t,e,r){return e=Xbe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xbe(t){var e=Zbe(t,"string");return Oh(e)==="symbol"?e:String(e)}function Zbe(t,e){if(Oh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Oh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qbe(t,e){if(t==null)return{};var r=Jbe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Jbe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function ewe(t){var e=t.headerClassName,r=t.rowClassName,n=t.columnClassName,o=Qbe(t,Kbe),i=new yc(mj(mj({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:r,highlightColumnClassName:n},o),{},{highlightOnlyClosestHeader:!0,selectionType:dp}));return i}function kh(t){"@babel/helpers - typeof";return kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kh(t)}function gj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function twe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gj(Object(r),!0).forEach(function(n){nwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function nwe(t,e,r){return e=rwe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rwe(t){var e=owe(t,"string");return kh(e)==="symbol"?e:String(e)}function owe(t,e){if(kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var o2=nr("highlight/types"),mc=o2.register,iwe=o2.getItem;mc(Av,fbe);mc(jv,vbe);mc(gh,Rbe);mc(ZE,Abe);mc(XE,$be);mc(dp,ewe);function us(t,e){return iwe(t)(twe({type:t},e))}function Rh(t){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rh(t)}function Go(t){return uwe(t)||lwe(t)||swe(t)||awe()}function awe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function swe(t,e){if(t){if(typeof t=="string")return xC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xC(t,e)}}function lwe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uwe(t){if(Array.isArray(t))return xC(t)}function xC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Nc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?vj(Object(r),!0).forEach(function(n){cwe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cwe(t,e,r){return e=i2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i2(n.key),n)}}function hwe(t,e,r){return e&&bj(t.prototype,e),r&&bj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function i2(t){var e=dwe(t,"string");return Rh(e)==="symbol"?e:String(e)}function dwe(t,e){if(Rh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var pwe=function(t){function e(r){fwe(this,e),this.options=r,this.layerLevel=0,this.cell=us(gh,r),this.fill=us(XE,r),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return hwe(e,[{key:"isEnabledFor",value:function(r,n){var o=r;r===gh&&(o="current");var i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(o)}},{key:"useLayerLevel",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=r,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var r=this.layerLevel,n;return this.areas.has(r)?n=this.areas.get(r):(n=us(jv,Nc({layerLevel:r},this.options)),this.areas.set(r,n)),n}},{key:"getAreas",value:function(){return Go(this.areas.values())}},{key:"createOrGetHeader",value:function(){var r=this.layerLevel,n;return this.headers.has(r)?n=this.headers.get(r):(n=us(dp,Nc({},this.options)),this.headers.set(r,n)),n}},{key:"getHeaders",value:function(){return Go(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var r=this.layerLevel,n;return this.activeHeaders.has(r)?n=this.activeHeaders.get(r):(n=us(Av,Nc({},this.options)),this.activeHeaders.set(r,n)),n}},{key:"getActiveHeaders",value:function(){return Go(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return Go(this.customSelections.values())}},{key:"addCustomSelection",value:function(r){this.customSelections.push(us(ZE,Nc(Nc({},this.options),r)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),_(this.areas.values(),function(r){return void r.clear()}),_(this.headers.values(),function(r){return void r.clear()}),_(this.activeHeaders.values(),function(r){return void r.clear()})}},{key:t,value:function(){return[this.cell,this.fill].concat(Go(this.areas.values()),Go(this.headers.values()),Go(this.activeHeaders.values()),Go(this.customSelections))[Symbol.iterator]()}}]),e}(Symbol.iterator);const ywe=pwe;function Eh(t){"@babel/helpers - typeof";return Eh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eh(t)}function mwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vwe(n.key),n)}}function gwe(t,e,r){return e&&wj(t.prototype,e),r&&wj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vwe(t){var e=bwe(t,"string");return Eh(e)==="symbol"?e:String(e)}function bwe(t,e){if(Eh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Eh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wwe=function(t){function e(r){mwe(this,e),this.ranges=[],this.createCellRange=r}return gwe(e,[{key:"isEmpty",value:function(){return this.size()===0}},{key:"set",value:function(r){return this.clear(),this.ranges.push(this.createCellRange(r)),this}},{key:"add",value:function(r){return this.ranges.push(this.createCellRange(r)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(r){return this.ranges.some(function(n){return n.includes(r)})}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=this.size()+r-1,o;return n>=0&&(o=this.ranges[n]),o}},{key:t,value:function(){return this.ranges[Symbol.iterator]()}}]),e}(Symbol.iterator);const Swe=wwe;function Th(t){"@babel/helpers - typeof";return Th=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Th(t)}function Cwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kwe(n.key),n)}}function Owe(t,e,r){return e&&Sj(t.prototype,e),r&&Sj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kwe(t){var e=Rwe(t,"string");return Th(e)==="symbol"?e:String(e)}function Rwe(t,e){if(Th(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Th(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a2=function(){function t(e,r){Cwe(this,t),this.range=e,this.options=r}return Owe(t,[{key:"transformStart",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.options.createCellCoords(e,r),i=this.range.current().highlight,a=this.options.visualToRenderableCoords(i),s=a.row,l=a.col,u=i,c=0,f=0;if(this.runLocalHooks("beforeTransformStart",o),s!==null&&l!==null){var h=this.options.countRows(),p=this.options.countCols(),y=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),v=this.options.minSpareCols(),S=this.options.autoWrapRow(),O=this.options.autoWrapCol();s+e>h-1?n&&g>0&&!(y&&s>=h-y-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):O&&(o.row=1-h,o.col=l+o.col===p-1?1-p:1):O&&s+o.row<0&&l+o.col>=0&&(o.row=h-1,o.col=l+o.col===0?p-1:-1),l+o.col>p-1?n&&v>0?(this.runLocalHooks("insertColRequire",p),p=this.options.countCols()):S&&(o.row=s+o.row===h-1?1-h:1,o.col=1-p):S&&l+o.col<0&&s+o.row>=0&&(o.row=s+o.row===0?h-1:-1,o.col=p-1);var w=this.options.createCellCoords(s+o.row,l+o.col);c=0,f=0,w.row<0?(c=-1,w.row=0):w.row>0&&w.row>=h&&(c=1,w.row=h-1),w.col<0?(f=-1,w.col=0):w.col>0&&w.col>=p&&(f=1,w.col=p-1),u=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformStart",u,c,f),u}},{key:"transformEnd",value:function(e,r){var n=this.options.createCellCoords(e,r),o=this.range.current(),i=o.to,a=0,s=0;this.runLocalHooks("beforeTransformEnd",n);var l=this.options.visualToRenderableCoords(o.highlight),u=l.row,c=l.col;if(u!==null&&c!==null){var f=this.options.countRows(),h=this.options.countCols(),p=this.options.visualToRenderableCoords(o.to),y=p.row,g=p.col,v=this.options.createCellCoords(y+n.row,g+n.col);a=0,s=0,v.row<0?(a=-1,v.row=0):v.row>0&&v.row>=f&&(a=1,v.row=f-1),v.col<0?(s=-1,v.col=0):v.col>0&&v.col>=h&&(s=1,v.col=h-1),i=this.options.renderableToVisualCoords(v)}return this.runLocalHooks("afterTransformEnd",i,a,s),i}}]),t}();pt(a2,Pn);const Ewe=a2;function s2(t,e){return _we(t)||Mwe(t,e)||Pwe(t,e)||Twe()}function Twe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pwe(t,e){if(t){if(typeof t=="string")return Cj(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cj(t,e)}}function Cj(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mwe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _we(t){if(Array.isArray(t))return t}function AC(t){"@babel/helpers - typeof";return AC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AC(t)}var Iv=0,Hv=1,l2=2,QE=3,xwe=[QE,l2],Awe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Iw=Symbol("root"),Oj=Symbol("child");function Al(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Iw;if(e!==Iw&&e!==Oj)throw new Error("The second argument is used internally only and cannot be overwritten.");var r=Array.isArray(t),n=e===Iw,o=Iv;if(r){var i=t[0];if(t.length===0)o=Hv;else if(n&&i instanceof hR)o=QE;else if(n&&Array.isArray(i))o=Al(i,Oj);else if(t.length>=2&&t.length<=4){var a=!t.some(function(s,l){return!Awe[l].includes(AC(s))});a&&(o=l2)}}return o}function Ph(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.keepDirection,n=r===void 0?!1:r,o=e.propToCol;if(!xwe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(i){var a=t===QE,s=a?i.from.row:i[0],l=a?i.from.col:i[1],u=a?i.to.row:i[2],c=a?i.to.col:i[3];if(typeof o=="function"&&(typeof l=="string"&&(l=o(l)),typeof c=="string"&&(c=o(c))),dt(u)&&(u=s),dt(c)&&(c=l),!n){var f=s,h=l,p=u,y=c;s=Math.min(f,p),l=Math.min(h,y),u=Math.max(f,p),c=Math.max(h,y)}return[s,l,u,c]}}function jwe(t){var e=Al(t);if(e===Iv||e===Hv)return[];var r=Ph(e),n=new Set;_(t,function(a){var s=r(a),l=s2(s,4),u=l[1],c=l[3],f=Math.max(u,0),h=c-f+1;_(Array.from(new Array(h),function(p,y){return f+y}),function(p){n.has(p)||n.add(p)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=an(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function Iwe(t){var e=Al(t);if(e===Iv||e===Hv)return[];var r=Ph(e),n=new Set;_(t,function(a){var s=r(a),l=s2(s,3),u=l[0],c=l[2],f=Math.max(u,0),h=c-f+1;_(Array.from(new Array(h),function(p,y){return f+y}),function(p){n.has(p)||n.add(p)})});var o=Array.from(n).sort(function(a,s){return a-s}),i=an(o,function(a,s,l,u){return l!==0&&s===u[l-1]+1?a[a.length-1][1]+=1:a.push([s,1]),a},[]);return i}function $o(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof t=="number"&&t>=0&&t<e}function Mh(t){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mh(t)}var kj;function Rj(t,e){return Lwe(t)||Nwe(t,e)||Dwe(t,e)||Hwe()}function Hwe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dwe(t,e){if(t){if(typeof t=="string")return Ej(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ej(t,e)}}function Ej(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Nwe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Lwe(t){if(Array.isArray(t))return t}function Bwe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Vwe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Wwe(n.key),n)}}function Fwe(t,e,r){return e&&Tj(t.prototype,e),r&&Tj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Wwe(t){var e=Uwe(t,"string");return Mh(e)==="symbol"?e:String(e)}function Uwe(t,e){if(Mh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var u2=function(){function t(e,r){var n=this;Vwe(this,t),this.settings=e,this.tableProps=r,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Swe(function(o,i,a){return n.tableProps.createCellRange(o,i,a)}),this.highlight=new ywe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:function(o,i){return n.tableProps.isDisabledCellSelection(o,i)},cellCornerVisible:function(){return n.isCellCornerVisible.apply(n,arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible.apply(n,arguments)},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,i){return n.tableProps.createCellCoords(o,i)},createCellRange:function(o,i,a){return n.tableProps.createCellRange(o,i,a)},rowIndexMapper:function(){return n.tableProps.rowIndexMapper()},columnIndexMapper:function(){return n.tableProps.columnIndexMapper()}}),this.transformation=new Ewe(this.selectedRange,{countRows:function(){return n.tableProps.countRowsTranslated()},countCols:function(){return n.tableProps.countColsTranslated()},visualToRenderableCoords:function(o){return n.tableProps.visualToRenderableCoords(o)},renderableToVisualCoords:function(o){return n.tableProps.renderableToVisualCoords(o)},createCellCoords:function(o,i){return n.tableProps.createCellCoords(o,i)},fixedRowsBottom:function(){return e.fixedRowsBottom},minSpareRows:function(){return e.minSpareRows},minSpareCols:function(){return e.minSpareCols},autoWrapRow:function(){return e.autoWrapRow},autoWrapCol:function(){return e.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformStart"].concat(i))}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["beforeModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["afterModifyTransformEnd"].concat(i))}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertRowRequire"].concat(i))}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n.runLocalHooks.apply(n,["insertColRequire"].concat(i))})}return Fwe(t,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.settings.selectionMode==="multiple",i=dt(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.row<0,s=e.col<0,l=a&&s,u=e.clone();this.selectedByCorner=l,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),u),(!o||o&&!i&&dt(r))&&this.selectedRange.clear(),this.selectedRange.add(u),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&a&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,r){this.setRangeStart(e,r,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var r=e.clone();this.runLocalHooks("beforeSetRangeEnd",r),this.begin();var n=this.selectedRange.current();this.settings.selectionMode!=="single"&&n.setTo(this.tableProps.createCellCoords(r.row,r.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(gh,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var o=this.getLayerLevel();o<this.highlight.layerLevel&&(_(this.highlight.getAreas(),function(y){return void y.clear()}),_(this.highlight.getHeaders(),function(y){return void y.clear()}),_(this.highlight.getActiveHeaders(),function(y){return void y.clear()})),this.highlight.useLayerLevel(o);var i=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(i.clear(),a.clear(),s.clear(),this.highlight.isEnabledFor(jv,n.highlight)&&(this.isMultiple()||o>=1)&&(i.add(n.from).add(n.to).commit(),o===1)){var l=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(dp,n.highlight)){var u=this.tableProps.countRowsTranslated()===0,c=this.tableProps.countColsTranslated()===0,f=n;if((u||c)&&(f=n.clone()),u&&(f.from.row=-1),c&&(f.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&f.from.normalize(),a.add(f.from).commit()):a.add(f.from).add(f.to).commit(),this.isEntireRowSelected()){var h=this.tableProps.countCols()===n.getWidth();h&&s.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit()}if(this.isEntireColumnSelected()){var p=this.tableProps.countRows()===n.getHeight();p&&s.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=tl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,r,n))}},{key:"transformEnd",value:function(e,r){this.setRangeEnd(this.transformation.transformEnd(e,r))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.tableProps.countRows(),o=this.tableProps.countCols();if(!(!e&&!r&&(n===0||o===0))){var i=this.tableProps.createCellCoords(r?-1:0,e?-1:0),a=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(i),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(a),this.finish()}}},{key:"selectCells",value:function(e){var r=this,n=Al(e);if(n===Hv)return!1;if(n===Iv)throw new Error(it(kj||(kj=Bwe([`Unsupported format of the selection ranges was passed. To select cells pass 
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, 
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`],[`Unsupported format of the selection ranges was passed. To select cells pass\\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`]))));var o=Ph(n,{propToCol:function(l){return r.tableProps.propToCol(l)},keepDirection:!0}),i=this.tableProps.countRows(),a=this.tableProps.countCols(),s=!e.some(function(l){var u=o(l),c=Rj(u,4),f=c[0],h=c[1],p=c[2],y=c[3],g=$o(f,i)&&$o(h,a)&&$o(p,i)&&$o(y,a);return!g});return s&&(this.clear(),_(e,function(l){var u=o(l),c=Rj(u,4),f=c[0],h=c[1],p=c[2],y=c[3];r.setRangeStartOnly(r.tableProps.createCellCoords(f,h),!1),r.setRangeEnd(r.tableProps.createCellCoords(p,y)),r.finish()})),s}},{key:"selectColumns",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof r=="string"?this.tableProps.propToCol(r):r,a=this.tableProps.countCols(),s=this.tableProps.countRows(),l=$o(o,a)&&$o(i,a);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,o)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,i)),this.finish()),l}},{key:"selectRows",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1,o=this.tableProps.countRows(),i=this.tableProps.countCols(),a=$o(e,o)&&$o(r,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(r,i-1)),this.finish()),a}},{key:"refresh",value:function(){var e=this.highlight.getCustomSelections();if(e.forEach(function(l){l.commit()}),!!this.isSelected()){var r=this.highlight.getCell(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(var o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);var i=this.highlight.createOrGetArea(),a=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();i.commit(),a.commit(),s.commit()}this.highlight.useLayerLevel(n)}}}]),t}();pt(u2,Pn);const zwe=u2;var Ywe=_e,c2=Yd,Gwe=Br.f,$we=Ga,Pj=Bt,Kwe=Mk,qwe=En,Xwe=_k,Mj=c2("".startsWith),Zwe=c2("".slice),Qwe=Math.min,f2=Xwe("startsWith"),Jwe=!f2&&!!function(){var t=Gwe(String.prototype,"startsWith");return t&&!t.writable}();Ywe({target:"String",proto:!0,forced:!Jwe&&!f2},{startsWith:function(t){var e=Pj(qwe(this));Kwe(t);var r=$we(Qwe(arguments.length>1?arguments[1]:void 0,e.length)),n=Pj(t);return Mj?Mj(e,n,r):Zwe(e,r,r+n.length)===n}});var _j=/^(\r\n|\n\r|\r|\n)/,e0e=/^[^\t\r\n]+/,xj=/^\t/;function t0e(t){var e=[[""]];if(t.length===0)return e;for(var r=0,n=0,o;t.length>0&&o!==t.length;)if(o=t.length,t.match(xj))t=t.replace(xj,""),r+=1,e[n][r]="";else if(t.match(_j))t=t.replace(_j,""),r=0,n+=1,e[n]=[""];else{var i="";if(t.startsWith('"')){for(var a=0,s=!0;s;){var l=t.slice(0,1);l==='"'&&(a+=1),i+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(s=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,function(c){return new Array(Math.floor(c.length/2)).fill('"').join("")})}else{var u=t.match(e0e);i=u?u[0]:"",t=t.slice(i.length)}e[n][r]=i}return e}function yf(t){var e,r,n,o,i="",a;for(e=0,r=t.length;e<r;e+=1){for(o=t[e].length,n=0;n<o;n+=1)n>0&&(i+="	"),a=t[e][n],typeof a=="string"?a.indexOf(`
`)>-1?i+='"'.concat(a.replace(/"/g,'""'),'"'):i+=a:a==null?i+="":i+=a;e!==r-1&&(i+=`
`)}return i}function Hw(t){return i0e(t)||o0e(t)||r0e(t)||n0e()}function n0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r0e(t,e){if(t){if(typeof t=="string")return jC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jC(t,e)}}function o0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i0e(t){if(Array.isArray(t))return jC(t)}function jC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function jl(t){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jl(t)}function a0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Aj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l0e(n.key),n)}}function s0e(t,e,r){return e&&Aj(t.prototype,e),r&&Aj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function l0e(t){var e=u0e(t,"string");return jl(e)==="symbol"?e:String(e)}function u0e(t,e){if(jl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var c0e=function(){function t(e,r,n){a0e(this,t),this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return s0e(t,[{key:"createMap",value:function(){var e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var r=this.tableMeta.columns,n;if(this.colToPropCache=[],this.propToColCache=new Map,r){var o=0,i=0,a=!1;if(typeof r=="function"){var s=Dk(e);o=s>0?s:this.countFirstRowKeys(),a=!0}else{var l=this.tableMeta.maxCols;o=Math.min(l,r.length)}for(n=0;n<o;n++){var u=a?r(n):r[n];if(Ge(u)){if(typeof u.data<"u"){var c=a?i:n;this.colToPropCache[c]=u.data,this.propToColCache.set(u.data,c)}i+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return HU(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,r,n){var o=this,i=r,a=n,s;return typeof i>"u"&&(i=0,a=""),jl(e)==="object"&&!Array.isArray(e)&&$e(e,function(l,u){l===null?(s=a+u,o.colToPropCache.push(s),o.propToColCache.set(s,i),i+=1):i=o.recursiveDuckColumns(l,i,"".concat(u,"."))}),i}},{key:"colToProp",value:function(e){if(Number.isInteger(e)===!1)return e;var r=this.instance.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&pe(this.colToPropCache[r])?this.colToPropCache[r]:r}},{key:"propToCol",value:function(e){var r=this.propToColCache.get(e);if(pe(r))return this.instance.toVisualColumn(r);var n=this.instance.toVisualColumn(e);return n===null?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?Ef(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=o.source,a=o.mode,s=a===void 0?"above":a,l=this.instance.countSourceRows(),u=l,c=0,f=e;(typeof f!="number"||f>=l)&&(f=l),f<this.instance.countRows()&&(u=this.instance.toPhysicalRow(f));var h=this.instance.runHooks("beforeCreateRow",f,n,i);if(h===!1||u===null)return{delta:0};for(var p=this.tableMeta.maxRows,y=this.getSchema().length,g=[],v=function(){var O=null;r.instance.dataType==="array"?r.tableMeta.dataSchema?O=yn(r.getSchema()):(O=[],Oe(y-1,function(){return O.push(null)})):r.instance.dataType==="function"?O=r.tableMeta.dataSchema(f+c):(O={},cv(O,r.getSchema())),g.push(O),c+=1};c<n&&l+c<p;)v();this.instance.rowIndexMapper.insertIndexes(f,c),s==="below"&&(u=Math.min(u+1,l)),this.spliceData(u,0,g);var S=this.instance.toVisualRow(u);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),c>0&&(e==null?this.metaManager.createRow(null,c):i!=="auto"&&this.metaManager.createRow(u,n)),this.instance.runHooks("afterCreateRow",S,c,i),this.instance.forceFullRender=!0,{delta:c,startPhysicalIndex:u}}},{key:"createCol",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=n.source,i=n.mode,a=i===void 0?"start":i;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,l=this.tableMeta.maxCols,u=this.instance.countSourceCols(),c=e;(typeof c!="number"||c>=u)&&(c=u);var f=this.instance.runHooks("beforeCreateCol",c,r,o);if(f===!1)return{delta:0};var h=u;c<this.instance.countCols()&&(h=this.instance.toPhysicalColumn(c));var p=this.instance.countSourceRows(),y=this.instance.countCols(),g=0,v=h;a==="end"&&(v=Math.min(v+1,u));for(var S=v;g<r&&y<l;){if(typeof c!="number"||c>=y)if(p>0)for(var O=0;O<p;O+=1)typeof s[O]>"u"&&(s[O]=[]),s[O].push(null);else s.push([null]);else for(var w=0;w<p;w++)s[w].splice(v,0,null);g+=1,v+=1,y+=1}this.instance.columnIndexMapper.insertIndexes(c,g),g>0&&(e==null?this.metaManager.createColumn(null,g):o!=="auto"&&this.metaManager.createColumn(S,r));var x=this.instance.toVisualColumn(S);return this.instance.runHooks("afterCreateCol",x,g,o),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:S}}},{key:"removeRow",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n,a=this.visualRowsToPhysical(i,n),s=this.instance.countSourceRows();i=(s+i)%s;var l=this.instance.runHooks("beforeRemoveRow",i,a.length,a,o);if(l===!1)return!1;var u=a.length;if(this.filterData(i,u,a),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(a);var c=pe(this.tableMeta.columns)||pe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}var f=a.slice(0).sort(function(h,p){return p-h});return f.forEach(function(h){r.metaManager.removeRow(h,1)}),this.instance.runHooks("afterRemoveRow",i,u,a,o),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var o=typeof e!="number"?-r:e;o=(this.instance.countCols()+o)%this.instance.countCols();var i=this.visualColumnsToPhysical(o,r),a=i.slice(0).sort(function(S,O){return O-S}),s=this.instance.runHooks("beforeRemoveCol",o,r,i,n);if(s===!1)return!1;for(var l=!0,u=a.length,c=this.dataSource,f=0;f<u;f++)l&&i[0]!==i[f]-f&&(l=!1);if(l)for(var h=0,p=this.instance.countSourceRows();h<p;h++)c[h].splice(i[0],r),h===0&&this.metaManager.removeColumn(i[0],r);else for(var y=0,g=this.instance.countSourceRows();y<g;y++)for(var v=0;v<u;v++)c[y].splice(a[v],1),y===0&&this.metaManager.removeColumn(a[v],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,r,i,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(e,r,n){for(var o=this.instance.getDataAtCol(e),i=o.slice(r,r+n),a=o.slice(r+n),s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++)l[u-3]=arguments[u];m_(l,a);for(var c=0;c<n;)l.push(null),c+=1;return Hee(l),this.instance.populateFromArray(r,e,l,null,null,"spliceCol"),i}},{key:"spliceRow",value:function(e,r,n){for(var o=this.instance.getSourceDataAtRow(e),i=o.slice(r,r+n),a=o.slice(r+n),s=arguments.length,l=new Array(s>3?s-3:0),u=3;u<s;u++)l[u-3]=arguments[u];m_(l,a);for(var c=0;c<n;)l.push(null),c+=1;return this.instance.populateFromArray(e,r,[l],null,null,"spliceRow"),i}},{key:"spliceData",value:function(e,r,n){var o=this,i=this.instance.runHooks("beforeDataSplice",e,r,n);if(i!==!1){var a=[].concat(Hw(this.dataSource.slice(0,e)),Hw(n),Hw(this.dataSource.slice(e)));this.dataSource.length=0,a.forEach(function(s){return o.dataSource.push(s)})}}},{key:"filterData",value:function(e,r,n){var o=this.instance.runHooks("filterData",e,r,n);Array.isArray(o)===!1&&(o=this.dataSource.filter(function(i,a){return n.indexOf(a)===-1})),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}},{key:"get",value:function(e,r){var n=this.instance.toPhysicalRow(e),o=this.dataSource[n],i=this.instance.runHooks("modifyRowData",n);o=isNaN(i)?i:o;var a=null;if(o&&o.hasOwnProperty&&xt(o,r))a=o[r];else if(typeof r=="string"&&r.indexOf(".")>-1){var s=r.split("."),l=o;if(!l)return null;for(var u=0,c=s.length;u<c;u++)if(l=l[s[u]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var f=tl(a);this.instance.runHooks("modifyData",n,this.propToCol(r),f,"get"),f.isTouched()&&(a=f.value)}return a}},{key:"getCopyable",value:function(e,r){return this.instance.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}},{key:"set",value:function(e,r,n){var o=this.instance.toPhysicalRow(e),i=n,a=this.dataSource[o],s=this.instance.runHooks("modifyRowData",o);if(a=isNaN(s)?s:a,this.instance.hasHook("modifyData")){var l=tl(i);this.instance.runHooks("modifyData",o,this.propToCol(r),l,"set"),l.isTouched()&&(i=l.value)}if(a&&a.hasOwnProperty&&xt(a,r))a[r]=i;else if(typeof r=="string"&&r.indexOf(".")>-1){var u=r.split("."),c=a,f=0,h;for(f=0,h=u.length-1;f<h;f++)typeof c[u[f]]>"u"&&(c[u[f]]={}),c=c[u[f]];c[u[f]]=i}else typeof r=="function"?r(this.dataSource.slice(o,o+1)[0],i):a[r]=i}},{key:"visualRowsToPhysical",value:function(e,r){for(var n=this.instance.countSourceRows(),o=[],i=(n+e)%n,a=r,s;i<n&&a;)s=this.instance.toPhysicalRow(i),o.push(s),a-=1,i+=1;return o}},{key:"visualColumnsToPhysical",value:function(e,r){for(var n=this.instance.countCols(),o=[],i=(n+e)%n,a=r;i<n&&a;){var s=this.instance.toPhysicalColumn(i);o.push(s),a-=1,i+=1}return o}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var r=0;r<this.instance.countCols();r++)this.set(e,this.colToProp(r),"")}},{key:"getLength",value:function(){var e=this.tableMeta.maxRows,r;e<0||e===0?r=0:r=e||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}},{key:"getAll",value:function(){var e={row:0,col:0},r={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-r.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,r,t.DESTINATION_RENDERER)}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(e,r,n){var o=[],i,a,s,l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];var c=n===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,f=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),h=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(i=Math.min(e.row,r.row);i<=f;i++){s=[];var p=i>=0?this.instance.toPhysicalRow(i):i;for(a=Math.min(e.col,r.col);a<=h&&p!==null;a++)s.push(c.call(this,i,this.colToProp(a)));p!==null&&o.push(s)}return o}},{key:"getText",value:function(e,r){return yf(this.getRange(e,r,t.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(e,r){return yf(this.getRange(e,r,t.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),t}();const f0e=c0e;var pp=nr("cellTypes"),h0e=pp.register,d0e=pp.getItem,h2=pp.hasItem;pp.getNames;pp.getValues;function p0e(t){if(!h2(t))throw Error('You declared cell type "'.concat(t,`" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`));return d0e(t)}function Pr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);var r=e,n=r.editor,o=r.renderer,i=r.validator;n&&Hn(t,n),o&&eo(t,o),i&&nf(t,i),h0e(t,e)}function y0e(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!xt(e,t)}function Dv(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,n=typeof e.type=="string"?p0e(e.type):e.type;if(t._automaticallyAssignedMetaProps&&$e(e,function(i,a){return void t._automaticallyAssignedMetaProps.delete(a)}),!!Ge(n)){r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);var o={};$e(n,function(i,a){if(y0e(a,r)){var s;o[a]=i,(s=t._automaticallyAssignedMetaProps)===null||s===void 0||s.add(a)}}),Yt(t,o)}}function m0e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ei(r,t);for(var n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function rm(t){return Number.isInteger(t)&&t>=0}function om(t,e){if(!t())throw new Error("Assertion failed: ".concat(e))}function ty(t){return t==null}function IC(t){"@babel/helpers - typeof";return IC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IC(t)}const d2=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(t){var e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),Xt(n)===!1)return!1;return!0},isEmptyRow:function(t){var e,r,n,o;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),Xt(n)===!1)return IC(n)==="object"?(o=this.getCellMeta(t,e),Hk(this.getSchema()[o.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};function _h(t){"@babel/helpers - typeof";return _h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(t)}function jj(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Ij(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?jj(Object(r),!0).forEach(function(n){g0e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jj(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function g0e(t,e,r){return e=y2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Hj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y2(n.key),n)}}function p2(t,e,r){return e&&Hj(t.prototype,e),r&&Hj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y2(t){var e=v0e(t,"string");return _h(e)==="symbol"?e:String(e)}function v0e(t,e){if(_h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m2(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b0e(){return p2(function t(){m2(this,t)})}var w0e=function(){function t(e){m2(this,t),this.metaCtor=b0e(),this.meta=this.metaCtor.prototype,Yt(this.meta,d2()),this.meta.instance=e}return p2(t,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){var r;Yt(this.meta,e),Dv(this.meta,Ij(Ij({},e),{},{type:(r=e.type)!==null&&r!==void 0?r:this.meta.type}),e)}}]),t}();function xh(t){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xh(t)}function S0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O0e(n.key),n)}}function C0e(t,e,r){return e&&Dj(t.prototype,e),r&&Dj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function O0e(t){var e=k0e(t,"string");return xh(e)==="symbol"?e:String(e)}function k0e(t,e){if(xh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var R0e=function(){function t(e){S0e(this,t);var r=e.getMetaConstructor();this.meta=new r}return C0e(t,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){Yt(this.meta,e),Dv(this.meta,e,e)}}]),t}();function Ah(t){"@babel/helpers - typeof";return Ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ah(t)}function Nj(t){return M0e(t)||P0e(t)||T0e(t)||E0e()}function E0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T0e(t,e){if(t){if(typeof t=="string")return HC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HC(t,e)}}function P0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function M0e(t){if(Array.isArray(t))return HC(t)}function HC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Lj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A0e(n.key),n)}}function x0e(t,e,r){return e&&Lj(t.prototype,e),r&&Lj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function A0e(t){var e=j0e(t,"string");return Ah(e)==="symbol"?e:String(e)}function j0e(t,e){if(Ah(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ah(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DC=function(t){function e(r){_0e(this,e),this.valueFactory=r,this.data=[],this.index=[],this.holes=new Set}return x0e(e,[{key:"obtain",value:function(r){om(function(){return rm(r)},"Expecting an unsigned number.");var n=this._getStorageIndexByKey(r),o;if(n>=0)o=this.data[n],o===void 0&&(o=this.valueFactory(r),this.data[n]=o);else if(o=this.valueFactory(r),this.holes.size>0){var i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=o,this.index[r]=i}else this.data.push(o),this.index[r]=this.data.length-1;return o}},{key:"insert",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;om(function(){return rm(r)||ty(r)},"Expecting an unsigned number or null/undefined argument.");for(var o=[],i=this.data.length,a=0;a<n;a++)o.push(i+a),this.data.push(void 0);var s=ty(r)?this.index.length:r;this.index=[].concat(Nj(this.index.slice(0,s)),o,Nj(this.index.slice(s)))}},{key:"remove",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;om(function(){return rm(r)||ty(r)},"Expecting an unsigned number or null/undefined argument.");for(var o=this.index.splice(ty(r)?this.index.length-n:r,n),i=0;i<o.length;i++){var a=o[i];typeof a=="number"&&this.holes.add(a)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var r=this;return Xn(this.data,function(n,o){return!r.holes.has(o)})[Symbol.iterator]()}},{key:"entries",value:function(){for(var r=[],n=0;n<this.data.length;n++){var o=this._getKeyByStorageIndex(n);o!==-1&&r.push([o,this.data[n]])}var i=0;return{next:function(){if(i<r.length){var a=r[i];return i+=1,{value:a,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(r){return this.index.length>r?this.index[r]:-1}},{key:"_getKeyByStorageIndex",value:function(r){return this.index.indexOf(r)}},{key:t,value:function(){return this.entries()}}]),e}(Symbol.iterator);function jh(t){"@babel/helpers - typeof";return jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jh(t)}function I0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Bj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D0e(n.key),n)}}function H0e(t,e,r){return e&&Bj(t.prototype,e),r&&Bj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function D0e(t){var e=N0e(t,"string");return jh(e)==="symbol"?e:String(e)}function N0e(t,e){if(jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var L0e=["data","width"],B0e=function(){function t(e){var r=this;I0e(this,t),this.globalMeta=e,this.metas=new DC(function(){return r._createMeta()})}return H0e(t,[{key:"updateMeta",value:function(e,r){var n=this.getMeta(e);Yt(n,r),Dv(n,r)}},{key:"createColumn",value:function(e,r){this.metas.insert(e,r)}},{key:"removeColumn",value:function(e,r){this.metas.remove(e,r)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return m0e(this.globalMeta.getMetaConstructor(),L0e).prototype}}]),t}();function Ih(t){"@babel/helpers - typeof";return Ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ih(t)}function V0e(t){return z0e(t)||U0e(t)||W0e(t)||F0e()}function F0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function W0e(t,e){if(t){if(typeof t=="string")return NC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NC(t,e)}}function U0e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function z0e(t){if(Array.isArray(t))return NC(t)}function NC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Y0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$0e(n.key),n)}}function G0e(t,e,r){return e&&Vj(t.prototype,e),r&&Vj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $0e(t){var e=K0e(t,"string");return Ih(e)==="symbol"?e:String(e)}function K0e(t,e){if(Ih(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ih(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var q0e=function(){function t(e){var r=this;Y0e(this,t),this.columnMeta=e,this.metas=new DC(function(){return r._createRow()})}return G0e(t,[{key:"updateMeta",value:function(e,r,n){var o=this.getMeta(e,r);Yt(o,n),Dv(o,n)}},{key:"createRow",value:function(e,r){this.metas.insert(e,r)}},{key:"createColumn",value:function(e,r){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}},{key:"removeRow",value:function(e,r){this.metas.remove(e,r)}},{key:"removeColumn",value:function(e,r){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}},{key:"getMeta",value:function(e,r,n){var o=this.metas.obtain(e).obtain(r);return n===void 0?o:o[n]}},{key:"setMeta",value:function(e,r,n,o){var i,a=this.metas.obtain(e).obtain(r);(i=a._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(n),a[n]=o}},{key:"removeMeta",value:function(e,r,n){var o=this.metas.obtain(e).obtain(r);delete o[n]}},{key:"getMetas",value:function(){for(var e=[],r=Array.from(this.metas.values()),n=0;n<r.length;n++)e.push.apply(e,V0e(r[n].values()));return e}},{key:"getMetasAtRow",value:function(e){om(function(){return rm(e)},"Expecting an unsigned number.");var r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new DC(function(r){return e._createMeta(r)})}},{key:"_createMeta",value:function(e){var r=this.columnMeta.getMetaConstructor(e);return new r}}]),t}();function Hh(t){"@babel/helpers - typeof";return Hh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hh(t)}function X0e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q0e(n.key),n)}}function Z0e(t,e,r){return e&&Fj(t.prototype,e),r&&Fj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Q0e(t){var e=J0e(t,"string");return Hh(e)==="symbol"?e:String(e)}function J0e(t,e){if(Hh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var g2=function(){function t(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];X0e(this,t),this.hot=e,this.globalMeta=new w0e(e),this.tableMeta=new R0e(this.globalMeta),this.columnMeta=new B0e(this.globalMeta),this.cellMeta=new q0e(this.columnMeta),o.forEach(function(i){return new i(r)}),this.globalMeta.updateMeta(n)}return Z0e(t,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,r){this.columnMeta.updateMeta(e,r)}},{key:"getCellMeta",value:function(e,r,n){var o=n.visualRow,i=n.visualColumn,a=this.cellMeta.getMeta(e,r);return a.visualRow=o,a.visualCol=i,a.row=e,a.col=r,this.runLocalHooks("afterGetCellMeta",a),a}},{key:"getCellMetaKeyValue",value:function(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}},{key:"setCellMeta",value:function(e,r,n,o){this.cellMeta.setMeta(e,r,n,o)}},{key:"updateCellMeta",value:function(e,r,n){this.cellMeta.updateMeta(e,r,n)}},{key:"removeCellMeta",value:function(e,r,n){this.cellMeta.removeMeta(e,r,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}},{key:"removeRow",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}},{key:"createColumn",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}},{key:"removeColumn",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),t}();pt(g2,Pn);function vg(t){"@babel/helpers - typeof";return vg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vg(t)}function Wj(t,e,r,n){var o=n.hotInstance,i=n.dataMap,a=n.dataSource,s=n.internalSource,l=n.source,u=n.metaManager,c=n.firstRun,f=hr(s),h=o.getSettings();Array.isArray(h.dataSchema)?o.dataType="array":yt(h.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),t=o.runHooks("before".concat(f),t,c,l);var p=new f0e(o,t,u);if(e(p),vg(t)==="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){var y=p.getSchema();t=[];var g,v=0,S=0;for(v=0,S=h.startRows;v<S;v++)if((o.dataType==="object"||o.dataType==="function")&&h.dataSchema)g=yn(y),t.push(g);else if(o.dataType==="array")g=yn(y[0]),t.push(g);else{g=[];for(var O=0,w=h.startCols;O<w;O++)g.push(null);t.push(g)}}else throw new Error("".concat(s," only accepts array of objects or array of arrays (").concat(vg(t)," given)"));Array.isArray(t[0])&&(o.dataType="array"),h.data=t,p.dataSource=t,a.data=t,a.dataType=o.dataType,a.colToProp=p.colToProp.bind(p),a.propToCol=p.propToCol.bind(p),a.countCachedColumns=p.countCachedColumns.bind(p),r(p),o.runHooks("after".concat(f),t,c,l),c||(o.runHooks("afterChange",null,s),o.render())}function Dh(t){"@babel/helpers - typeof";return Dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dh(t)}function eSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nSe(n.key),n)}}function tSe(t,e,r){return e&&Uj(t.prototype,e),r&&Uj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function nSe(t){var e=rSe(t,"string");return Dh(e)==="symbol"?e:String(e)}function rSe(t,e){if(Dh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oSe=function(){function t(e){var r=this;eSe(this,t),this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",function(n){return r.extendCellMeta(n)}),ye.getSingleton().add("beforeRender",function(n){n&&r.metaSyncMemo.clear()},this.metaManager.hot)}return tSe(t,[{key:"extendCellMeta",value:function(e){var r,n=e.row,o=e.col;if(!((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(o))){var i=e.visualRow,a=e.visualCol,s=this.metaManager.hot,l=s.colToProp(a);e.prop=l,s.runHooks("beforeGetCellMeta",i,a,e);var u=xt(e,"type")?e.type:null,c=yt(e.cells)?e.cells(n,o,l):null;if(u)if(c){var f;c.type=(f=c.type)!==null&&f!==void 0?f:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,o,c),s.runHooks("afterGetCellMeta",i,a,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}}]),t}();function Nh(t){"@babel/helpers - typeof";return Nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nh(t)}function iSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sSe(n.key),n)}}function aSe(t,e,r){return e&&zj(t.prototype,e),r&&zj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sSe(t){var e=lSe(t,"string");return Nh(e)==="symbol"?e:String(e)}function lSe(t,e){if(Nh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uSe=function(){function t(e){iSe(this,t),this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(r){var n=this.metaManager.hot.isRtl();if(n&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(r,n,o){if(!o)throw new Error("The `".concat(r,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return aSe(t,[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach(function(r,n){var o=r.target,i=r.onChange,a=i===void 0?function(){}:i,s=typeof o=="string",l=s?o:n,u="_".concat(l);e.metaManager.globalMeta.meta[u]=e.metaManager.globalMeta.meta[l],e.installPropWatcher(n,u,a),s&&e.installPropWatcher(o,u,a)})}},{key:"installPropWatcher",value:function(e,r,n){var o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[r]},set:function(i){var a=!o.usageTracker.has(e);o.usageTracker.add(e),n.call(o,e,i,a),this[r]=i},enumerable:!0,configurable:!0})}}]),t}(),Yj=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),ny=function(t){return t.map(function(e){var r=e.toLowerCase();return Yj.has(r)?Yj.get(r):r}).sort().join("+")},cSe=function(t){return t.split("+")},Gj=function(t){return t.toLowerCase()},$j;function fSe(t){return pSe(t)||dSe(t)||v2(t)||hSe()}function hSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pSe(t){if(Array.isArray(t))return LC(t)}function ySe(t,e){return vSe(t)||gSe(t,e)||v2(t,e)||mSe()}function mSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v2(t,e){if(t){if(typeof t=="string")return LC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LC(t,e)}}function LC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function vSe(t){if(Array.isArray(t))return t}function bSe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var wSe=function(t){var e=Ev({errorIdExists:function(l){return'The "'.concat(l,'" shortcut is already registered in the "').concat(t,'" context.')}}),r=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=l.keys,c=l.callback,f=l.group,h=l.runOnlyIf,p=h===void 0?function(){return!0}:h,y=l.captureCtrl,g=y===void 0?!1:y,v=l.preventDefault,S=v===void 0?!0:v,O=l.stopPropagation,w=O===void 0?!1:O,x=l.relativeToGroup,T=l.position;if(dt(f))throw new Error("You need to define the shortcut's group.");if(yt(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(u)===!1)throw new Error(it($j||($j=bSe([`Pass the shortcut's keys as an array of arrays, 
      using the KeyboardEvent.key properties: 
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`],[`Pass the shortcut\\'s keys as an array of arrays,\\x20
      using the KeyboardEvent.key properties:\\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`]))));var z={callback:c,group:f,runOnlyIf:p,captureCtrl:g,preventDefault:S,stopPropagation:w};if(pe(x)){var $=[x,T];z.relativeToGroup=$[0],z.position=$[1]}u.forEach(function(ne){var G=ny(ne),q=e.hasItem(G);if(q){var Z=e.getItem(G),ee=Z.findIndex(function(Q){return Q.group===x});ee!==-1?T==="before"?ee-=1:ee+=1:ee=Z.length,Z.splice(ee,0,z)}else e.addItem(G,[z])})},n=function(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(function(c){$e(u,function(f,h){Object.prototype.hasOwnProperty.call(c,h)===!1&&(c[h]=u[h])}),r(c)})},o=function(l){var u=ny(l);e.removeItem(u)},i=function(l){var u=e.getItems();u.forEach(function(c){var f=ySe(c,2),h=f[0],p=f[1],y=p.filter(function(g){return g.group!==l});y.length===0?o(cSe(h)):(p.length=0,p.push.apply(p,fSe(y)))})},a=function(l){var u=ny(l),c=e.getItem(u);return pe(c)?c.slice():[]},s=function(l){var u=ny(l);return e.hasItem(u)};return{addShortcut:r,addShortcuts:n,getShortcuts:a,hasShortcut:s,removeShortcutsByKeys:o,removeShortcutsByGroup:i}};function SSe(){var t=new Set;return{press:function(e){t.add(e)},release:function(e){t.delete(e)},releaseAll:function(){t.clear()},isPressed:function(e){return t.has(e)}}}var CSe=["meta","alt","shift","control"],Lc=SSe();function OSe(t,e,r,n,o){var i=function(h){return CSe.includes(h)},a=function(h){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,y=[];return h.altKey&&y.push("alt"),p&&(h.ctrlKey||h.metaKey)?y.push("control/meta"):(h.ctrlKey&&y.push("control"),h.metaKey&&y.push("meta")),h.shiftKey&&y.push("shift"),y},s=function(h){if(e(h)!==!1){var p=r(h);if(!(h.keyCode===229||p===!1||As(h))){var y=Gj(h.key),g=[];i(y)?Lc.press(y):g=a(h);var v=[y].concat(g),S=o(h,v);!S&&(S_()&&g.includes("meta")||!S_()&&g.includes("control"))&&o(h,[y].concat(a(h,!0))),n(h)}}},l=function(h){if(e(h)!==!1){var p=Gj(h.key);i(p)!==!1&&Lc.release(p)}},u=function(){Lc.releaseAll()},c=function(){for(var h=t;h;)h.document.documentElement.addEventListener("keydown",s),h.document.documentElement.addEventListener("keyup",l),h.document.documentElement.addEventListener("blur",u),h=Nm(h)},f=function(){for(var h=t;h;)h.document.documentElement.removeEventListener("keydown",s),h.document.documentElement.removeEventListener("keyup",l),h.document.documentElement.removeEventListener("blur",u),h=Nm(h)};return{mount:c,unmount:f,isPressed:function(h){return Lc.isPressed(h)},releasePressedKeys:function(){return Lc.releaseAll()}}}var kSe=function(t){var e=t.ownerWindow,r=t.handleEvent,n=t.beforeKeyDown,o=t.afterKeyDown,i=Ev({errorIdExists:function(p){return'The "'.concat(p,'" context name is already registered.')}}),a="grid",s=function(p){var y=wSe(p);return i.addItem(p,y),y},l=function(){return a},u=function(p){return i.getItem(p)},c=function(p){a=p},f=!1,h=OSe(e,r,n,o,function(p,y){var g=u(l()),v=!1;if(!g.hasShortcut(y))return v;for(var S=g.getShortcuts(y),O=0;O<S.length;O++){var w=S[O],x=w.callback,T=w.runOnlyIf,z=w.preventDefault,$=w.stopPropagation,ne=w.captureCtrl;if(T(p)!==!1&&(f=ne,v=x(p,y)===!1,f=!1,z&&p.preventDefault(),$&&p.stopPropagation(),v))break}return v});return h.mount(),{addContext:s,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:function(){return!f&&(h.isPressed("control")||h.isPressed("meta"))},releasePressedKeys:function(){return h.releasePressedKeys()},destroy:function(){return h.unmount()}}},Kj,qj;function wn(t){"@babel/helpers - typeof";return wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wn(t)}function Xj(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Sr(t,e){return TSe(t)||ESe(t,e)||b2(t,e)||RSe()}function RSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ESe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function TSe(t){if(Array.isArray(t))return t}function cs(t){return _Se(t)||MSe(t)||b2(t)||PSe()}function PSe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b2(t,e){if(t){if(typeof t=="string")return BC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BC(t,e)}}function MSe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _Se(t){if(Array.isArray(t))return BC(t)}function BC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var xSe="gridDefault",Dw=null,ry=new Set;function JE(t,e){var r,n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,a=this,s=new Tt(a),l,u,c,f,h=!0;Uye(o)&&Wye(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var p=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",y=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},e.language=Wve(e.language);var g=new g2(a,e,[oSe,uSe]),v=g.getTableMeta(),S=g.getGlobalMeta(),O=Ev();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),yC(this)&&zie(e.licenseKey,t),this.guid="ht_".concat(uW()),this.columnIndexMapper=new PC,this.rowIndexMapper=new PC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",function(d){a.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",function(d){a.runHooks("afterRowSequenceChange",d)}),u=new dme(a),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);var w=function(d){var m=d.row,b=d.col;return a._createCellCoords(m>=0?a.rowIndexMapper.getRenderableFromVisualIndex(m):m,b>=0?a.columnIndexMapper.getRenderableFromVisualIndex(b):b)},x=function(d){var m=d.row,b=d.col;return a._createCellCoords(m>=0?a.rowIndexMapper.getVisualFromRenderableIndex(m):m,b>=0?a.columnIndexMapper.getVisualFromRenderableIndex(b):b)},T=new zwe(v,{rowIndexMapper:function(){return a.rowIndexMapper},columnIndexMapper:function(){return a.columnIndexMapper},countCols:function(){return a.countCols()},countRows:function(){return a.countRows()},propToCol:function(d){return l.propToCol(d)},isEditorOpened:function(){return a.getActiveEditor()?a.getActiveEditor().isOpened():!1},countColsTranslated:function(){return n.view.countRenderableColumns()},countRowsTranslated:function(){return n.view.countRenderableRows()},getShortcutManager:function(){return a.getShortcutManager()},createCellCoords:function(d,m){return a._createCellCoords(d,m)},createCellRange:function(d,m,b){return a._createCellRange(d,m,b)},visualToRenderableCoords:w,renderableToVisualCoords:x,isDisabledCellSelection:function(d,m){return a.getCellMeta(d,m).disableVisualSelection}});this.selection=T;var z=function(d){var m=d.hiddenIndexesChanged;m&&n.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("beforeSetRangeStart",function(d){n.runHooks("beforeSetRangeStart",d)}),this.selection.addLocalHook("beforeSetRangeStartOnly",function(d){n.runHooks("beforeSetRangeStartOnly",d)}),this.selection.addLocalHook("beforeSetRangeEnd",function(d){n.runHooks("beforeSetRangeEnd",d),d.row<0&&(d.row=n.view._wt.wtTable.getFirstVisibleRow()),d.col<0&&(d.col=n.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",function(d){var m=tl(!1),b=n.selection.getSelectedRange(),k=b.current(),E=k.from,A=k.to,W=b.size()-1;n.runHooks("afterSelection",E.row,E.col,A.row,A.col,m,W),n.runHooks("afterSelectionByProp",E.row,a.colToProp(E.col),A.row,a.colToProp(A.col),m,W);var N=n.selection.isSelectedByAnyHeader(),K=n.selection.selectedRange.current(),X=!0;i&&(X=!1),m.isTouched()&&(X=!m.value);var re=n.selection.isSelectedByRowHeader(),me=n.selection.isSelectedByColumnHeader();X!==!1&&(N?re?n.view.scrollViewportVertically(a.rowIndexMapper.getRenderableFromVisualIndex(d.row)):me&&n.view.scrollViewportHorizontally(a.columnIndexMapper.getRenderableFromVisualIndex(d.col)):K&&!n.selection.isMultiple()?n.view.scrollViewport(w(K.from)):n.view.scrollViewport(w(d))),re&&me?te(n.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(Ne(n.rootElement,"ht__selection--columns"),te(n.rootElement,"ht__selection--rows")):me?(Ne(n.rootElement,"ht__selection--rows"),te(n.rootElement,"ht__selection--columns")):Ne(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",function(d){var m=d.length-1,b=d[m],k=b.from,E=b.to;n.runHooks("afterSelectionEnd",k.row,k.col,E.row,E.col,m),n.runHooks("afterSelectionEndByProp",k.row,a.colToProp(k.col),E.row,a.colToProp(E.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",function(d){var m=n.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("beforeModifyTransformStart",function(d){n.runHooks("modifyTransformStart",d)}),this.selection.addLocalHook("afterModifyTransformStart",function(d,m,b){n.runHooks("afterModifyTransformStart",d,m,b)}),this.selection.addLocalHook("beforeModifyTransformEnd",function(d){n.runHooks("modifyTransformEnd",d)}),this.selection.addLocalHook("afterModifyTransformEnd",function(d,m,b){n.runHooks("afterModifyTransformEnd",d,m,b)}),this.selection.addLocalHook("afterDeselect",function(){f.destroyEditor(),n._refreshBorders(),Ne(n.rootElement,["ht__selection--rows","ht__selection--columns"]),n.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",function(d){n.alter("insert_row_above",d,1,"auto")}),this.selection.addLocalHook("insertColRequire",function(d){n.alter("insert_col_start",d,1,"auto")}),c={alter:function(d,m){var b,k,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,A=arguments.length>3?arguments[3]:void 0,W=arguments.length>4?arguments[4]:void 0,N=function(Ve){if(Ve.length===0)return[];var qe=cs(Ve);qe.sort(function(Ie,Te){var et=Sr(Ie,1),Mt=et[0],Ze=Sr(Te,1),st=Ze[0];return Mt===st?0:Mt>st?1:-1});var je=an(qe,function(Ie,Te){var et=Sr(Te,2),Mt=et[0],Ze=et[1],st=Ie[Ie.length-1],$t=Sr(st,2),gt=$t[0],Ct=$t[1],tt=gt+Ct;if(Mt<=tt){var Cp=Math.max(Ze-(tt-Mt),0);st[1]+=Cp}else Ie.push([Mt,Ze]);return Ie},[qe[0]]);return je};switch(d){case"insert_row":ry.has(d)||(ry.add(d),lt(it(Kj||(Kj=Xj(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_row_above` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_row_above\\` action instead."])),d)));case"insert_row_below":case"insert_row_above":var K=a.countSourceRows();if(v.maxRows===K)return;var X=d==="insert_row_below"?"below":"above";m=(b=m)!==null&&b!==void 0?b:d==="insert_row"||X==="below"?K:0;var re=l.createRow(m,E,{source:A,mode:X}),me=re.delta,le=re.startPhysicalIndex;if(me){var ke=T.selectedRange.current(),be=ke==null?void 0:ke.from,Y=be==null?void 0:be.row,Le=a.toVisualRow(le);if(T.isSelectedByCorner())a.selectAll();else if(pe(Y)&&Y>=Le){var He=ke.to,Ee=He.row,De=He.col,Me=be.col;T.isSelectedByRowHeader()&&(Me=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(Y+me,Me),!0),T.setRangeEnd(a._createCellCoords(Ee+me,De))}else a._refreshBorders()}break;case"insert_col":ry.has(d)||(ry.add(d),lt(it(qj||(qj=Xj(["The `","` action of the `alter()` method is deprecated and will be removed \n                              in the next major release of Handsontable. Use the `insert_col_start` action instead."],["The \\`","\\` action of the \\`alter()\\` method is deprecated and will be removed\\x20\n                              in the next major release of Handsontable. Use the \\`insert_col_start\\` action instead."])),d)));case"insert_col_start":case"insert_col_end":var C=d==="insert_col_end"?"end":"start";m=(k=m)!==null&&k!==void 0?k:d==="insert_col"||C==="end"?a.countSourceCols():0;var R=l.createCol(m,E,{source:A,mode:C}),M=R.delta,B=R.startPhysicalIndex;if(M){if(Array.isArray(v.colHeaders)){var I=[a.toVisualColumn(B),0];I.length+=M,Array.prototype.splice.apply(v.colHeaders,I)}var V=T.selectedRange.current(),H=V==null?void 0:V.from,D=H==null?void 0:H.col,F=a.toVisualColumn(B);if(T.isSelectedByCorner())a.selectAll();else if(pe(D)&&D>=F){var L=V.to,U=L.row,ie=L.col,ge=H.row;T.isSelectedByColumnHeader()&&(ge=-1),T.getSelectedRange().pop(),T.setRangeStartOnly(a._createCellCoords(ge,D+M),!0),T.setRangeEnd(a._createCellCoords(U,ie+M))}else a._refreshBorders()}break;case"remove_row":var Re=function(Ve){var qe=0;_(Ve,function(je){var Ie=Sr(je,2),Te=Ie[0],et=Ie[1],Mt=Xt(Te)?a.countRows()-1:Math.max(Te-qe,0);Number.isInteger(Te)&&(Te=Math.max(Te-qe,0));var Ze=l.removeRow(Te,et,A);if(Ze){var st=a.countRows(),$t=v.fixedRowsTop;$t>=Mt+1&&(v.fixedRowsTop-=Math.min(et,$t-Mt));var gt=v.fixedRowsBottom;gt&&Mt>=st-gt&&(v.fixedRowsBottom-=Math.min(et,gt)),qe+=et}})};Array.isArray(m)?Re(N(m)):Re([[m,E]]),c.adjustRowsAndCols(),a._refreshBorders();break;case"remove_col":var xe=function(Ve){var qe=0;_(Ve,function(je){var Ie=Sr(je,2),Te=Ie[0],et=Ie[1],Mt=Xt(Te)?a.countCols()-1:Math.max(Te-qe,0),Ze=a.toPhysicalColumn(Mt);Number.isInteger(Te)&&(Te=Math.max(Te-qe,0));var st=l.removeCol(Te,et,A);if(st){var $t=v.fixedColumnsStart;$t>=Mt+1&&(v.fixedColumnsStart-=Math.min(et,$t-Mt)),Array.isArray(v.colHeaders)&&(typeof Ze>"u"&&(Ze=-1),v.colHeaders.splice(Ze,et)),qe+=et}})};Array.isArray(m)?xe(N(m)):xe([[m,E]]),c.adjustRowsAndCols(),a._refreshBorders();break;default:throw new Error('There is no such action "'.concat(d,'"'))}W||c.adjustRowsAndCols()},adjustRowsAndCols:function(){var d=v.minRows,m=v.minSpareRows,b=v.minCols,k=v.minSpareCols;if(a.countRows()===0&&a.countCols()===0&&T.deselect(),d){var E=a.countRows();E<d&&l.createRow(E,d-E,{source:"auto"})}if(m){var A=a.countEmptyRows(!0);if(A<m){var W=m-A,N=Math.min(W,v.maxRows-a.countSourceRows());l.createRow(a.countRows(),N,{source:"auto"})}}{var K;(b||k)&&(K=a.countEmptyCols(!0));var X=a.countCols();if(b&&!v.columns&&X<b){var re=b-X;K+=re,l.createCol(X,re,{source:"auto"})}if(k&&!v.columns&&a.dataType==="array"&&K<k){X=a.countCols();var me=k-K,le=Math.min(me,v.maxCols-X);l.createCol(X,le,{source:"auto"})}}if(T.isSelected()){var ke=a.countRows(),be=a.countCols();_(T.selectedRange,function(Y){var Le=!1,He=Y.from.row,Ee=Y.from.col,De=Y.to.row,Me=Y.to.col;He>ke-1?(He=ke-1,Le=!0,De>He&&(De=He)):De>ke-1&&(De=ke-1,Le=!0,He>De&&(He=De)),Ee>be-1?(Ee=be-1,Le=!0,Me>Ee&&(Me=Ee)):Me>be-1&&(Me=be-1,Le=!0,Ee>Me&&(Ee=Me)),Le&&a.selectCell(He,Ee,De,Me)})}a.view&&a.view.adjustElementsSize()},populateFromArray:function(d,m,b,k,E,A,W){var N,K,X,re,me=[],le={},ke=[],be=d.row,Y=d.col;if(K=m.length,K===0)return!1;var Le=0,He=0;switch(Ge(b)&&(Le=b.col-Y+1,He=b.row-be+1),E){case"shift_down":var Ee=Fy(m),De=Ee.length,Me=Math.max(De,Le),C=a.getData().slice(be),R=Fy(C).slice(Y,Y+Me);for(X=0;X<Me;X+=1)if(X<De){for(N=0,K=Ee[X].length;N<He-K;N+=1)Ee[X].push(Ee[X][N%K]);X<R.length?ke.push(Ee[X].concat(R[X])):ke.push(Ee[X].concat(new Array(C.length).fill(null)))}else ke.push(Ee[X%De].concat(R[X]));a.populateFromArray(be,Y,Fy(ke));break;case"shift_right":var M=m.length,B=Math.max(M,He),I=a.getData().slice(be).map(function(gt){return gt.slice(Y)});for(N=0;N<B;N+=1)if(N<M){for(X=0,re=m[N].length;X<Le-re;X+=1)m[N].push(m[N][X%re]);if(N<I.length)for(var V=0;V<I[N].length;V+=1)m[N].push(I[N][V]);else{var H;(H=m[N]).push.apply(H,cs(new Array(I[0].length).fill(null)))}}else m.push(m[N%K].slice(0,B).concat(I[N]));a.populateFromArray(be,Y,m);break;case"overwrite":default:le.row=d.row,le.col=d.col;var D={row:b&&d?b.row-d.row+1:1,col:b&&d?b.col-d.col+1:1},F=0,L=0,U=!0,ie,ge=function(gt){var Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,tt=m[gt%m.length];return Ct!==null?tt[Ct%tt.length]:tt},Re=m.length,xe=b?b.row-d.row+1:0;for(b?K=xe:K=Math.max(Re,xe),N=0;N<K&&!(b&&le.row>b.row&&xe>Re||!v.allowInsertRow&&le.row>a.countRows()-1||le.row>=v.maxRows);N++){var Ve=N-F,qe=ge(Ve).length,je=b?b.col-d.col+1:0;if(b?re=je:re=Math.max(qe,je),le.col=d.col,ie=a.getCellMeta(le.row,le.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&ie.skipRowOnPaste){F+=1,le.row+=1,K+=1;continue}for(L=0,X=0;X<re&&!(b&&le.col>b.col&&je>qe||!v.allowInsertColumn&&le.col>a.countCols()-1||le.col>=v.maxCols);X++){if(ie=a.getCellMeta(le.row,le.col),(k==="CopyPaste.paste"||k==="Autofill.fill")&&ie.skipColumnOnPaste){L+=1,le.col+=1,re+=1;continue}if(ie.readOnly&&k!=="UndoRedo.undo"){le.col+=1;continue}var Ie=X-L,Te=ge(Ve,Ie),et=a.getDataAtCell(le.row,le.col),Mt={row:Ve,col:Ie};if(k==="Autofill.fill"){var Ze=a.runHooks("beforeAutofillInsidePopulate",Mt,A,m,W,{},D);Ze&&(Te=dt(Ze.value)?Te:Ze.value)}if(Te!==null&&wn(Te)==="object")if(Array.isArray(Te)&&et===null&&(et=[]),et===null||wn(et)!=="object")U=!1;else{var st=Ef(Array.isArray(et)?et:et[0]||et),$t=Ef(Array.isArray(Te)?Te:Te[0]||Te);Hk(st,$t)||Array.isArray(st)&&Array.isArray($t)?Te=yn(Te):U=!1}else et!==null&&wn(et)==="object"&&(U=!1);U&&me.push([le.row,le.col,Te]),U=!0,le.col+=1}le.row+=1}a.setDataAtCell(me,null,null,k||"populateFromArray");break}}};function $(d){var m=$U(d);qE(m)?(a.runHooks("beforeLanguageChange",m),S.language=m,a.runHooks("afterLanguageChange",m)):KU(d)}function ne(d,m){var b=d==="className"?a.rootElement:a.table;if(h)te(b,m);else{var k=[],E=[];S[d]&&(k=Array.isArray(S[d])?S[d]:v_(S[d])),m&&(E=Array.isArray(m)?m:v_(m));var A=g_(k,E),W=g_(E,k);A.length&&Ne(b,A),W.length&&te(b,W)}S[d]=m}this.init=function(){u.setData(v.data),a.runHooks("beforeInit"),(Ir()||pF())&&te(a.rootElement,"mobile"),this.updateSettings(v,!0),this.view=new rme(this),f=sse.getInstance(a,v,T),a.runHooks("init"),this.forceFullRender=!0,this.view.render(),h&&a.rootElement.offsetParent===null&&aae(a.rootElement,function(){a.view._wt.wtOverlays.updateLastSpreaderSize(),a.render(),a.view.adjustElementsSize()}),wn(h)==="object"&&(a.runHooks("afterChange",h[0],h[1]),h=!1),a.runHooks("afterInit")};function G(){var d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function q(d){var m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function Z(d,m,b){if(d.length){var k=a.getActiveEditor(),E=a.runHooks("beforeChange",d,m||"edit"),A=!0;if(E===!1){k&&k.cancelChanges();return}var W=new G;W.onQueueEmpty=function(be){k&&A&&k.cancelChanges(),b(be)};for(var N=d.length-1;N>=0;N--)if(d[N]===null)d.splice(N,1);else{var K=Sr(d[N],4),X=K[0],re=K[1],me=K[3],le=l.propToCol(re),ke=a.getCellMeta(X,le);ke.type==="numeric"&&typeof me=="string"&&ile(me)&&(d[N][3]=q(me)),a.getCellValidator(ke)&&(W.addValidatorToQueue(),a.validateCell(d[N][3],ke,function(be,Y){return function(Le){if(typeof Le!="boolean")throw new Error("Validation error: result is not boolean");if(Le===!1&&Y.allowInvalid===!1){A=!1,d.splice(be,1),Y.valid=!0;var He=a.getCell(Y.visualRow,Y.visualCol);He!==null&&Ne(He,v.invalidCellClassName)}W.removeValidatorFormQueue()}}(N,ke),m))}W.checkIfQueueIsEmpty()}}function ee(d,m){var b=d.length-1;if(!(b<0)){for(;b>=0;b--){var k=!1;if(d[b]===null){d.splice(b,1);continue}if(!((d[b][2]===null||d[b][2]===void 0)&&(d[b][3]===null||d[b][3]===void 0))){if(v.allowInsertRow)for(;d[b][0]>a.countRows()-1;){var E=l.createRow(void 0,void 0,{source:m}),A=E.delta;if(A===0){k=!0;break}}if(a.dataType==="array"&&(!v.columns||v.columns.length===0)&&v.allowInsertColumn)for(;l.propToCol(d[b][1])>a.countCols()-1;){var W=l.createCol(void 0,void 0,{source:m}),N=W.delta;if(N===0){k=!0;break}}k||l.set(d[b][0],d[b][1],d[b][3])}}a.forceFullRender=!0,c.adjustRowsAndCols(),a.runHooks("beforeChangeRender",d,m),f.lockEditor(),a._refreshBorders(null),f.unlockEditor(),a.view.adjustElementsSize(),a.runHooks("afterChange",d,m||"edit");var K=a.getActiveEditor();K&&pe(K.refreshValue)&&K.refreshValue()}}this._createCellCoords=function(d,m){return a.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,b){return a.view._wt.createCellRange(d,m,b)},this.validateCell=function(d,m,b,k){var E=a.getCellValidator(m);function A(W){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!N||m.hidden===!0){b(W);return}var K=m.visualCol,X=m.visualRow,re=a.getCell(X,K,!0);if(re&&re.nodeName!=="TH"){var me=a.rowIndexMapper.getRenderableFromVisualIndex(X),le=a.columnIndexMapper.getRenderableFromVisualIndex(K);a.view._wt.getSetting("cellRenderer",me,le,re)}b(W)}Fie(E)&&(E=function(W){return function(N,K){K(W.test(N))}}(E)),yt(E)?(d=a.runHooks("beforeValidate",d,m.visualRow,m.prop,k),a._registerImmediate(function(){E.call(m,d,function(W){a&&(W=a.runHooks("afterValidate",W,d,m.visualRow,m.prop,k),m.valid=W,A(W),a.runHooks("postAfterValidate",W,d,m.visualRow,m.prop,k))})})):a._registerImmediate(function(){m.valid=!0,A(m.valid,!1)})};function Q(d,m,b){return Array.isArray(d)?d:[[d,m,b]]}this.setDataAtCell=function(d,m,b,k){var E=Q(d,m,b),A=[],W=k,N,K,X;for(N=0,K=E.length;N<K;N++){if(wn(E[N])!=="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof E[N][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");E[N][1]>=this.countCols()?X=E[N][1]:X=l.colToProp(E[N][1]),A.push([E[N][0],X,u.getAtCell(this.toPhysicalRow(E[N][0]),E[N][1]),E[N][2]])}!W&&wn(d)==="object"&&(W=m),a.runHooks("afterSetDataAtCell",A,W),Z(A,W,function(){ee(A,W)})},this.setDataAtRowProp=function(d,m,b,k){var E=Q(d,m,b),A=[],W=k,N,K;for(N=0,K=E.length;N<K;N++)A.push([E[N][0],E[N][1],u.getAtCell(this.toPhysicalRow(E[N][0]),E[N][1]),E[N][2]]);!W&&wn(d)==="object"&&(W=m),a.runHooks("afterSetDataAtRowProp",A,W),Z(A,W,function(){ee(A,W)})},this.listen=function(){a&&!a.isListening()&&(Dw=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Dw=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return Dw===a.guid},this.destroyEditor=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;a._refreshBorders(d,m)},this.populateFromArray=function(d,m,b,k,E,A,W,N,K){if(!(wn(b)==="object"&&wn(b[0])==="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");var X=typeof k=="number"?a._createCellCoords(k,E):null;return c.populateFromArray(a._createCellCoords(d,m),b,X,A,W,N,K)},this.spliceCol=function(d,m,b){for(var k,E=arguments.length,A=new Array(E>3?E-3:0),W=3;W<E;W++)A[W-3]=arguments[W];return(k=l).spliceCol.apply(k,[d,m,b].concat(A))},this.spliceRow=function(d,m,b){for(var k,E=arguments.length,A=new Array(E>3?E-3:0),W=3;W<E;W++)A[W-3]=arguments[W];return(k=l).spliceRow.apply(k,[d,m,b].concat(A))},this.getSelected=function(){if(T.isSelected())return Ye(T.getSelectedRange(),function(d){var m=d.from,b=d.to;return[m.row,m.col,b.row,b.col]})},this.getSelectedLast=function(){var d=this.getSelected(),m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if(T.isSelected())return Array.from(T.getSelectedRange())},this.getSelectedRangeLast=function(){var d=this.getSelectedRange(),m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){var m=this;if(!(!T.isSelected()||this.countRows()===0||this.countCols()===0)){var b=[];_(T.getSelectedRange(),function(k){var E=k.getTopStartCorner(),A=k.getBottomEndCorner();Oe(E.row,A.row,function(W){Oe(E.col,A.col,function(N){m.getCellMeta(W,N).readOnly||b.push([W,N,null])})})}),b.length>0&&this.setDataAtCell(b,d)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(f.lockEditor(),this._refreshBorders(null),f.unlockEditor()))},this.batchRender=function(d){this.suspendRender();var m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();var b=d();return this.resumeExecution(m),b},this.batch=function(d){this.suspendRender(),this.suspendExecution();var m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(a.view){var d=a.view.getLastSize(),m=d.width,b=d.height,k=a.rootElement.getBoundingClientRect(),E=k.width,A=k.height,W=E!==m||A!==b,N=a.runHooks("beforeRefreshDimensions",{width:m,height:b},{width:E,height:A},W)===!1;N||((W||a.view._wt.wtOverlays.scrollableElement===a.rootWindow)&&(a.view.setLastSize(E,A),a.render()),a.runHooks("afterRefreshDimensions",{width:m,height:b},{width:E,height:A},W))}},this.updateData=function(d,m){var b=this;Wj(d,function(k){l=k},function(k){l=k,a.columnIndexMapper.fitToLength(b.getInitialColumnCount()),a.rowIndexMapper.fitToLength(b.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:g,firstRun:h})},this.loadData=function(d,m){Wj(d,function(b){l=b},function(){g.clearCellsCache(),a.initIndexMappers(),c.adjustRowsAndCols(),h&&(h=[null,"loadData"])},{hotInstance:a,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:g,firstRun:h})},this.getInitialColumnCount=function(){var d=v.columns,m=0;if(Array.isArray(d))m=d.length;else if(yt(d))if(a.dataType==="array")for(var b=this.countSourceCols(),k=0;k<b;k+=1)d(k)&&(m+=1);else(a.dataType==="object"||a.dataType==="function")&&(m=l.colToPropCache.length);else if(pe(v.dataSchema)){var E=l.getSchema();m=Array.isArray(E)?E.length:Dk(E)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,b,k){return dt(d)?l.getAll():l.getRange(a._createCellCoords(d,m),a._createCellCoords(b,k),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,b,k){return l.getCopyableText(a._createCellCoords(d,m),a._createCellCoords(b,k))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,b=(h?a.loadData:a.updateData).bind(this),k=!1,E,A;if(pe(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(pe(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(pe(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(E in d)E==="data"||(E==="language"?$(d.language):E==="className"?ne("className",d.className):E==="tableClassName"&&a.table?(ne("tableClassName",d.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames()):ye.getSingleton().isRegistered(E)||ye.getSingleton().isDeprecated(E)?(yt(d[E])||Array.isArray(d[E]))&&(d[E].initialHook=!0,a.addHook(E,d[E])):!m&&xt(d,E)&&(S[E]=d[E]));d.data===void 0&&v.data===void 0?b(null,"updateSettings"):d.data!==void 0?b(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),a.initIndexMappers());var W=a.countCols(),N=v.columns;if(N&&yt(N)&&(k=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&g.clearCache(),W>0)for(E=0,A=0;E<W;E++){if(N){var K=k?N(E):N[A];K&&g.updateColumnMeta(A,K)}A+=1}pe(d.cell)&&$e(d.cell,function(be){a.setCellMetaObject(be.row,be.col,be)}),a.runHooks("afterCellMetaReset");var X=a.rootElement.style.height;X!==""&&(X=parseInt(a.rootElement.style.height,10));var re=d.height;if(yt(re)&&(re=re()),m){var me=a.rootElement.getAttribute("style");me&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"))}if(re===null){var le=a.rootElement.getAttribute("data-initialstyle");le&&(le.indexOf("height")>-1||le.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",le):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else re!==void 0&&(a.rootElement.style.height=isNaN(re)?"".concat(re):"".concat(re,"px"),a.rootElement.style.overflow="hidden");if(typeof d.width<"u"){var ke=d.width;yt(ke)&&(ke=ke()),a.rootElement.style.width=isNaN(ke)?"".concat(ke):"".concat(ke,"px")}m||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),a.view&&!h&&(a.forceFullRender=!0,f.lockEditor(),a._refreshBorders(null),a.view._wt.wtOverlays.adjustElementsSize(),f.unlockEditor()),!m&&a.view&&(X===""||re===""||re===void 0)&&X!==re&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var d=a.getSelectedLast();if(v.getValue){if(yt(v.getValue))return v.getValue.call(a);if(d)return a.getData()[d[0][0]][v.getValue]}else if(d)return a.getDataAtCell(d[0],d[1])},this.getSettings=function(){return v},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,b,k,E){c.alter(d,m,b,k,E)},this.getCell=function(d,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=m,E=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;k=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;E=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return E===null||k===null?null:a.view.getCellAtCoords(a._createCellCoords(E,k),b)},this.getCoords=function(d){var m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;var b=m.row,k=m.col,E=b,A=k;return b>=0&&(E=this.rowIndexMapper.getVisualFromRenderableIndex(b)),k>=0&&(A=this.columnIndexMapper.getVisualFromRenderableIndex(k)),a._createCellCoords(E,A)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=function(d){return n.rowIndexMapper.getVisualFromPhysicalIndex(d)},this.toVisualColumn=function(d){return n.columnIndexMapper.getVisualFromPhysicalIndex(d)},this.toPhysicalRow=function(d){return n.rowIndexMapper.getPhysicalFromVisualIndex(d)},this.toPhysicalColumn=function(d){return n.columnIndexMapper.getPhysicalFromVisualIndex(d)},this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){for(var m=[],b=l.getRange(a._createCellCoords(0,d),a._createCellCoords(v.data.length-1,d),l.DESTINATION_RENDERER),k=0;k<b.length;k+=1)for(var E=0;E<b[k].length;E+=1)m.push(b[k][E]);return m},this.getDataAtProp=function(d){for(var m=[],b=l.getRange(a._createCellCoords(0,l.propToCol(d)),a._createCellCoords(v.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER),k=0;k<b.length;k+=1)for(var E=0;E<b[k].length;E+=1)m.push(b[k][E]);return m},this.getSourceData=function(d,m,b,k){var E;return d===void 0?E=u.getData():E=u.getByRange(a._createCellCoords(d,m),a._createCellCoords(b,k)),E},this.getSourceDataArray=function(d,m,b,k){var E;return d===void 0?E=u.getData(!0):E=u.getByRange(a._createCellCoords(d,m),a._createCellCoords(b,k),!0),E},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,b,k){var E=Q(d,m,b),A=this.hasHook("afterSetSourceDataAtCell"),W=[];A&&_(E,function(K){var X=Sr(K,3),re=X[0],me=X[1],le=X[2];W.push([re,me,u.getAtCell(re,me),le])}),_(E,function(K){var X=Sr(K,3),re=X[0],me=X[1],le=X[2];u.setAtCell(re,me,le)}),A&&this.runHooks("afterSetSourceDataAtCell",W,k),this.render();var N=a.getActiveEditor();N&&pe(N.refreshValue)&&N.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){var m=l.getRange(a._createCellCoords(d,0),a._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER);return m[0]||[]},this.getDataType=function(d,m,b,k){var E=this,A=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,b,k],W=A[0],N=A[1],K=A[2],X=A[3],re=null,me=null;K===void 0&&(K=W),X===void 0&&(X=N);var le="mixed";return Oe(Math.max(Math.min(W,K),0),Math.max(W,K),function(ke){var be=!0;return Oe(Math.max(Math.min(N,X),0),Math.max(N,X),function(Y){var Le=E.getCellMeta(ke,Y);return me=Le.type,re?be=re===me:re=me,be}),le=be?me:"mixed",be}),le},this.removeCellMeta=function(d,m,b){var k=[this.toPhysicalRow(d),this.toPhysicalColumn(m)],E=k[0],A=k[1],W=g.getCellMetaKeyValue(E,A,b),N=a.runHooks("beforeRemoveCellMeta",d,m,b,W);N!==!1&&(g.removeCellMeta(E,A,b),a.runHooks("afterRemoveCellMeta",d,m,b,W)),W=null},this.spliceCellsMeta=function(d){for(var m=this,b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=arguments.length,E=new Array(k>2?k-2:0),A=2;A<k;A++)E[A-2]=arguments[A];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");b>0&&g.removeRow(this.toPhysicalRow(d),b),E.length>0&&_(E.reverse(),function(W){g.createRow(m.toPhysicalRow(d)),_(W,function(N,K){return m.setCellMetaObject(d,K,N)})}),a.render()},this.setCellMetaObject=function(d,m,b){var k=this;wn(b)==="object"&&$e(b,function(E,A){k.setCellMeta(d,m,A,E)})},this.setCellMeta=function(d,m,b,k){var E=a.runHooks("beforeSetCellMeta",d,m,b,k);if(E!==!1){var A=d,W=m;d<this.countRows()&&(A=this.toPhysicalRow(d)),m<this.countCols()&&(W=this.toPhysicalColumn(m)),g.setCellMeta(A,W,b,k),a.runHooks("afterSetCellMeta",d,m,b,k)}},this.getCellsMeta=function(){return g.getCellsMeta()},this.getCellMeta=function(d,m){var b=this.toPhysicalRow(d),k=this.toPhysicalColumn(m);return b===null&&(b=d),k===null&&(k=m),g.getCellMeta(b,k,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return g.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||v.columns)},this.getCellRenderer=function(d,m){var b=typeof d=="number"?a.getCellMeta(d,m).renderer:d.renderer;return typeof b=="string"?wx(b):dt(b)?wx("text"):b},this.getCellEditor=function(d,m){var b=typeof d=="number"?a.getCellMeta(d,m).editor:d.editor;return typeof b=="string"?ax(b):dt(b)?ax("text"):b},this.getCellValidator=function(d,m){var b=typeof d=="number"?a.getCellMeta(d,m).validator:d.validator;return typeof b=="string"?Qle(b):b},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,b){var k=new G;d&&(k.onQueueEmpty=d);for(var E=a.countRows()-1;E>=0;){if(m!==void 0&&m.indexOf(E)===-1){E-=1;continue}for(var A=a.countCols()-1;A>=0;){if(b!==void 0&&b.indexOf(A)===-1){A-=1;continue}k.addValidatorToQueue(),a.validateCell(a.getDataAtCell(E,A),a.getCellMeta(E,A),function(W){if(typeof W!="boolean")throw new Error("Validation error: result is not boolean");W===!1&&(k.valid=!1),k.removeValidatorFormQueue()},"validateCells"),A-=1}E-=1}k.checkIfQueueIsEmpty()},this.getRowHeader=function(d){var m=v.rowHeaders,b=d;return b!==void 0&&(b=a.runHooks("modifyRowHeader",b)),b===void 0?(m=[],Oe(a.countRows()-1,function(k){m.push(a.getRowHeader(k))})):Array.isArray(m)&&m[b]!==void 0?m=m[b]:yt(m)?m=m(b):m&&typeof m!="string"&&typeof m!="number"&&(m=b+1),m},this.hasRowHeaders=function(){return!!v.rowHeaders},this.hasColHeaders=function(){if(v.colHeaders!==void 0&&v.colHeaders!==null)return!!v.colHeaders;for(var d=0,m=a.countCols();d<m;d++)if(a.getColHeader(d))return!0;return!1},this.getColHeader=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,b=a.runHooks("modifyColHeader",d);if(b===void 0){for(var k=[],E=a.countCols(),A=0;A<E;A++)k.push(a.getColHeader(A));return k}var W=v.colHeaders,N=function(re){for(var me=[],le=a.countCols(),ke=0;ke<le;ke++)yt(v.columns)&&v.columns(ke)&&me.push(ke);return me[re]},K=a.toPhysicalColumn(b),X=N(K);return v.colHeaders===!1?W=null:v.columns&&yt(v.columns)&&v.columns(X)&&v.columns(X).title?W=v.columns(X).title:v.columns&&v.columns[K]&&v.columns[K].title?W=v.columns[K].title:Array.isArray(v.colHeaders)&&v.colHeaders[K]!==void 0?W=v.colHeaders[K]:yt(v.colHeaders)?W=v.colHeaders(K):v.colHeaders&&typeof v.colHeaders!="string"&&typeof v.colHeaders!="number"&&(W=ime(b)),W=a.runHooks("modifyColumnHeaderValue",W,d,m),W},this._getColWidthFromSettings=function(d){var m;if(d>=0){var b=a.getCellMeta(0,d);m=b.width}if((m===void 0||m===v.width)&&(m=v.colWidths),m!=null){switch(wn(m)){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){var m=a._getColWidthFromSettings(d);return m=a.runHooks("modifyColWidth",m,d),m===void 0&&(m=fR.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){var m=v.rowHeights;if(m!=null){switch(wn(m)){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){var m=a._getRowHeightFromSettings(d);return m=a.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){var d=v.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return US(a.countRows()-1,function(b){if(a.isEmptyRow(b))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return US(a.countCols()-1,function(b){if(a.isEmptyCol(b))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return v.isEmptyRow.call(a,d)},this.isEmptyCol=function(d){return v.isEmptyCol.call(a,d)},this.selectCell=function(d,m,b,k){var E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return dt(d)||dt(m)?!1:this.selectCells([[d,m,b,k]],E,A)},this.selectCells=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(i=!0);var k=T.selectCells(d);return k&&b&&a.listen(),i=!1,k},this.selectColumns=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return T.selectColumns(d,m)},this.selectRows=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d;return T.selectRows(d,m)},this.deselectCell=function(){T.deselect()},this.selectAll=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=d&&this.hasRowHeaders(),b=d&&this.hasColHeaders();i=!0,T.selectAll(m,b),i=!1};var ce=function(d,m){return d.getNearestNotHiddenIndex(m,1,!0)};this.scrollViewportTo=function(d,m){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,k=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,A=!b,W=!k,N=d,K=m;if(E){var X=Number.isInteger(d),re=Number.isInteger(m),me=X?ce(this.rowIndexMapper,d):void 0,le=re?ce(this.columnIndexMapper,m):void 0;if(me===null||le===null)return!1;N=X?a.rowIndexMapper.getRenderableFromVisualIndex(me):void 0,K=re?a.columnIndexMapper.getRenderableFromVisualIndex(le):void 0}var ke=Number.isInteger(N),be=Number.isInteger(K);return ke&&be?a.view.scrollViewport(a._createCellCoords(N,K),A,k,b,W):ke&&be===!1?a.view.scrollViewportVertically(N,A,b):be&&ke===!1?a.view.scrollViewportHorizontally(K,k,W):!1},this.destroy=function(){if(a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),g.clearCache(),yC(a)){var d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}Nr(a.rootElement),s.destroy(),f&&f.destroy(),a.batchExecution(function(){a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),O.getItems().forEach(function(m){var b=Sr(m,2),k=b[1];k.destroy()}),O.clear(),a.runHooks("afterDestroy")},!0),ye.getSingleton().destroy(a),$e(a,function(m,b,k){yt(m)?k[b]=fe(b):b!=="guid"&&(k[b]=null)}),a.isDestroyed=!0,l&&l.destroy(),l=null,c=null,T=null,f=null,a=null};function fe(d){return function(){throw new Error('The "'.concat(d,'" method cannot be called because this Handsontable instance has been destroyed'))}}this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(d){var m=hr(d);return m==="UndoRedo"?this.undoRedo:O.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(d)},this.getInstance=function(){return a},this.addHook=function(d,m){ye.getSingleton().add(d,m,a)},this.hasHook=function(d){return ye.getSingleton().has(d,a)||ye.getSingleton().has(d)},this.addHookOnce=function(d,m){ye.getSingleton().once(d,m,a)},this.removeHook=function(d,m){ye.getSingleton().remove(d,m,a)},this.runHooks=function(d,m,b,k,E,A,W){return ye.getSingleton().run(a,d,m,b,k,E,A,W)},this.getTranslatedPhrase=function(d,m){return t2(v.language,d,m)},this.toHTML=function(){return yx(n)},this.toTableElement=function(){var d=n.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",yx(n)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,b=d;typeof b=="function"&&(b=setTimeout(b,m)),this.timeouts.push(b)},this._clearTimeouts=function(){_(this.timeouts,function(d){clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){_(this.immediates,function(d){clearImmediate(d)})},this._refreshBorders=function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;f.destroyEditor(d),a.view.render(),m&&T.isSelected()&&f.prepareEditor()},this.isRtl=function(){return a.rootWindow.getComputedStyle(a.rootElement).direction==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1};var we=kSe({handleEvent:function(d){var m=a.isListening(),b=(d==null?void 0:d.key)!==void 0;return m&&b},beforeKeyDown:function(d){return n.runHooks("beforeKeyDown",d)},afterKeyDown:function(d){n.isDestroyed||a.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",function(d){d.ctrlKey===!1&&d.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we};var Se=we.addContext("grid"),P={runOnlyIf:function(){return pe(a.getSelected())&&a.countRenderedRows()>0&&a.countRenderedCols()>0},group:xSe};we.setActiveContextName("grid"),Se.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){a.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var d=a.getSelectedRange(),m=d[d.length-1].highlight,b=m.row,k=m.col,E=a.getDataAtCell(b,k),A=new Map,W=0;W<d.length;W++)d[W].forAll(function(N,K){if(N>=0&&K>=0&&(N!==b||K!==k)){var X=a.getCellMeta(N,K),re=X.readOnly;re||A.set("".concat(N,"x").concat(K),[N,K,E])}});a.setDataAtCell(Array.from(A.values()))},runOnlyIf:function(){return a.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){T.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(0,1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){T.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d=a.getSelectedRangeLast(),m=d.from,b=d.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);T.setRangeStart(m.clone()),T.setRangeEnd(a._createCellCoords(k,b.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){T.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1),a.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){T.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d=a.getSelectedRangeLast(),m=d.from,b=d.to,k=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);T.setRangeStart(m.clone()),T.setRangeEnd(a._createCellCoords(k,b.col))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){T.transformStart(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var d,m=a.getSelectedRangeLast().highlight.row,b=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,cs(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(a._createCellCoords(m,b))}},{keys:[["ArrowLeft","Shift"]],callback:function(){T.transformEnd(0,-1*a.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d,m=a.getSelectedRangeLast(),b=m.from,k=m.to,E=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,cs(a.isRtl()?[a.countCols()-1,-1]:[0,1]));T.setRangeStart(b.clone()),T.setRangeEnd(a._createCellCoords(k.row,E))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){T.transformStart(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var d,m=a.getSelectedRangeLast().highlight.row,b=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,cs(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(a._createCellCoords(m,b))}},{keys:[["ArrowRight","Shift"]],callback:function(){T.transformEnd(0,a.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var d,m=a.getSelectedRangeLast(),b=m.from,k=m.to,E=(d=a.columnIndexMapper).getNearestNotHiddenIndex.apply(d,cs(a.isRtl()?[0,1]:[a.countCols()-1,-1]));T.setRangeStart(b.clone()),T.setRangeEnd(a._createCellCoords(k.row,E))},runOnlyIf:function(){return!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedColumnsStart,10),m=a.getSelectedRangeLast().highlight.row,b=a.columnIndexMapper.getNearestNotHiddenIndex(d,1);T.setRangeStart(a._createCellCoords(m,b))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedRowsTop,10),m=parseInt(a.getSettings().fixedColumnsStart,10),b=a.rowIndexMapper.getNearestNotHiddenIndex(d,1),k=a.columnIndexMapper.getNearestNotHiddenIndex(m,1);T.setRangeStart(a._createCellCoords(b,k))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){T.setRangeStart(a._createCellCoords(a.getSelectedRangeLast().highlight.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){T.setRangeEnd(a._createCellCoords(T.selectedRange.current().from.row,a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var d=parseInt(a.getSettings().fixedRowsBottom,10),m=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-d-1,-1),b=a.columnIndexMapper.getNearestNotHiddenIndex(a.countCols()-1,-1);T.setRangeStart(a._createCellCoords(m,b))},runOnlyIf:function(){return a.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){T.transformStart(-a.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var d=a.getSelectedRangeLast(),m=d.to,b=Math.max(m.row-a.countVisibleRows(),0),k=a.rowIndexMapper.getNearestNotHiddenIndex(b,1);if(k!==null){var E=a._createCellCoords(k,m.col),A=m.row-a.view.getFirstFullyVisibleRow(),W=Math.max(E.row-A,0);T.setRangeEnd(E),a.scrollViewportTo(W)}}},{keys:[["PageDown"]],callback:function(){T.transformStart(a.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var d=a.getSelectedRangeLast(),m=d.to,b=Math.min(m.row+a.countVisibleRows(),a.countRows()-1),k=a.rowIndexMapper.getNearestNotHiddenIndex(b,-1);if(k!==null){var E=a._createCellCoords(k,m.col),A=m.row-a.view.getFirstFullyVisibleRow(),W=Math.min(E.row-A,a.countRows()-1);T.setRangeEnd(E),a.scrollViewportTo(W)}}},{keys:[["Tab"]],callback:function(d){var m=typeof v.tabMoves=="function"?v.tabMoves(d):v.tabMoves;T.transformStart(m.row,m.col,!0)}},{keys:[["Shift","Tab"]],callback:function(d){var m=typeof v.tabMoves=="function"?v.tabMoves(d):v.tabMoves;T.transformStart(-m.row,-m.col)}}],P),WW().forEach(function(d){var m=cR(d);O.addItem(d,new m(n))}),ye.getSingleton().run(a,"construct")}var ASe="hooksRefRegisterer",w2={_hooksStorage:Object.create(null),addHook:function(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey:function(t){var e=this;_(this._hooksStorage[t]||[],function(r){e.hot.removeHook(t,r)})},clearHooks:function(){var t=this;$e(this._hooksStorage,function(e,r){return t.removeHooksByKey(r)}),this._hooksStorage={}}};Fo(w2,"MIXIN_NAME",ASe,{writable:!1,enumerable:!1});const jSe=w2;function Il(t){"@babel/helpers - typeof";return Il=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Il(t)}function ISe(t,e){return LSe(t)||NSe(t,e)||DSe(t,e)||HSe()}function HSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DSe(t,e){if(t){if(typeof t=="string")return Zj(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zj(t,e)}}function Zj(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function NSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function LSe(t){if(Array.isArray(t))return t}function BSe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VC(t,e)}function VC(t,e){return VC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},VC(t,e)}function VSe(t){var e=USe();return function(){var r=bg(t),n;if(e){var o=bg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FSe(this,n)}}function FSe(t,e){if(e&&(Il(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WSe(t)}function WSe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function USe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bg(t){return bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bg(t)}function Qj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Jj(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,zSe(n.key),n)}}function eI(t,e,r){return e&&Jj(t.prototype,e),r&&Jj(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function zSe(t){var e=YSe(t,"string");return Il(e)==="symbol"?e:String(e)}function YSe(t,e){if(Il(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Il(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GSe="base",Zt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),FC="baseEditor",gc=function(){function t(e){Qj(this,t),this.hot=e,this.instance=e,this.state=Zt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return eI(t,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,r,n,o,i,a){this.TD=o,this.row=e,this.col=r,this.prop=n,this.originalValue=i,this.cellProperties=a,this.state=Zt.VIRGIN}},{key:"extend",value:function(){return function(e){BSe(n,e);var r=VSe(n);function n(){return Qj(this,n),r.apply(this,arguments)}return eI(n)}(this.constructor)}},{key:"saveValue",value:function(e,r){var n=this,o,i,a,s;if(r){var l=this.hot.getSelectedLast();o=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),a=Math.max(l[0],l[2]),s=Math.max(l[1],l[3])}else{var u=[this.row,this.col,null,null];o=u[0],i=u[1],a=u[2],s=u[3]}var c=this.hot.runHooks("modifyGetCellCoords",o,i);if(Array.isArray(c)){var f=ISe(c,2);o=f[0],i=f[1]}var h=this.hot.getShortcutManager(),p=h.getContext("editor"),y={runOnlyIf:function(){return pe(n.hot.getSelected())},group:FC};this.isInFullEditMode()&&p.addShortcuts([{keys:[["ArrowUp"]],callback:function(){n.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){n.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){n.hot.selection.transformStart(0,-1*n.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){n.hot.selection.transformStart(0,n.hot.getDirectionFactor())}}],y),this.hot.populateFromArray(o,i,e,a,s,"edit")}},{key:"beginEditing",value:function(e,r){if(this.state===Zt.VIRGIN){var n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=Zt.EDITING,this.isInFullEditMode()){var a=typeof e=="string"?e:Dt(this.originalValue);this.setValue(a)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,r,n){var o=this,i;if(n){var a=this._closeCallback;this._closeCallback=function(c){a&&a(c),n(c),o.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager(),l=s.getContext("editor");if(l.removeShortcutsByGroup(FC),l.removeShortcutsByGroup(Rv),this.state===Zt.VIRGIN){this.hot._registerTimeout(function(){o._fireCallbacks(!0)});return}if(this.state===Zt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}var u=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof u=="string"?String.prototype.trim.call(u||""):u]]:i=[[u]],this.state=Zt.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",function(c){o.state=Zt.FINISHED,o.discardEditor(c)}):(this.state=Zt.FINISHED,this.discardEditor(!0))}}}},{key:"cancelChanges",value:function(){this.state=Zt.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){if(this.state===Zt.FINISHED)if(e===!1&&this.cellProperties.allowInvalid!==!0)this.hot.selectCell(this.row,this.col),this.focus(),this.state=Zt.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Zt.VIRGIN,this._fireCallbacks(!0);var r=this.hot.getShortcutManager();r.setActiveContextName("grid")}}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===Zt.WAITING}},{key:"getEditedCellRect",value:function(){var e,r=this.getEditedCell();if(r){var n=this.hot.view._wt,o=n.wtOverlays,i=n.wtViewport,a=this.hot.rootWindow,s=Wt(r),l=ut(r),u=Wt(this.hot.rootElement),c=ut(this.hot.rootElement),f=o.topOverlay.holder,h=o.inlineStartOverlay.holder,p=f!==a?f.scrollTop:0,y=h!==a?h.scrollLeft:0,g=a.innerWidth-u.left-c,v=(e=o.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,S=v.wtTable,O=S.name,w=["master","inline_start"].includes(O)?p:0,x=["master","top","bottom"].includes(O)?y:0,T=s.top===u.top?0:1,z=s.top-u.top-T-w,$=0;this.hot.isRtl()?$=a.innerWidth-s.left-l-g-1+x:$=s.left-u.left-1-x,["top","top_inline_start_corner"].includes(O)&&(z+=o.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(O)&&($+=Math.abs(o.inlineStartOverlay.getOverlayOffset()));var ne=this.hot.hasColHeaders(),G=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Z=this.hot.rowIndexMapper.getRenderableIndexesLength(),ee=Z-this.hot.view._wt.getSetting("fixedRowsBottom");(ne&&G<=0||G===ee)&&(z+=1),q<=0&&($+=1);var Q=i.rowsRenderCalculator.startPosition,ce=i.columnsRenderCalculator.startPosition,fe=Math.abs(o.inlineStartOverlay.getScrollPosition()),we=o.topOverlay.getScrollPosition(),Se=en(this.hot.rootDocument),P=r.offsetTop+Q-we,d=0;if(this.hot.isRtl()){var m=r.offsetLeft;m>=0?d=S.getWidth()-r.offsetLeft:d=Math.abs(m),d+=ce-fe-l}else d=r.offsetLeft+ce-fe;var b=Ma(this.TD,this.hot.rootWindow),k=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",E=parseInt(b[k],10)>0?0:1,A=parseInt(b.borderTopWidth,10)>0?0:1,W=ut(r)+E,N=Rt(r)+A,K=rae(f)?Se:0,X=oae(h)?Se:0,re=this.hot.view.maximumVisibleElementWidth(d)-K+E,me=Math.max(this.hot.view.maximumVisibleElementHeight(P)-X+A,23);return{top:z,start:$,height:N,maxHeight:me,width:W,maxWidth:re}}}},{key:"getEditedCellsLayerClass",value:function(){var e=this.checkEditorSection();switch(e){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}],[{key:"EDITOR_TYPE",get:function(){return GSe}}]),t}();pt(gc,jSe);function $Se(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,r=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(h,p,y){h.addEventListener(p,y,!1)},a=function(h,p,y){h.removeEventListener(p,y,!1)},s=function(h){var p,y;h?/^[a-zA-Z \.,\\\/\|0-9]$/.test(h)||(h="."):h="",n.textContent!==void 0?n.textContent=e.value+h:n.data=e.value+h,o.style.position="absolute",o.style.fontSize=f(e).fontSize,o.style.fontFamily=f(e).fontFamily,o.style.whiteSpace="pre",r.appendChild(o),p=o.clientWidth+2,r.removeChild(o),e.style.height=t.minHeight+"px",t.minWidth>p?e.style.width=t.minWidth+"px":p>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=p+"px",y=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>y?e.style.height=t.minHeight+"px":t.maxHeight<y?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=y+"px"},l=function(){window.setTimeout(s,0)},u=function(h){if(h&&h.minHeight)if(h.minHeight=="inherit")t.minHeight=e.clientHeight;else{var p=parseInt(h.minHeight);isNaN(p)||(t.minHeight=p)}if(h&&h.maxHeight)if(h.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var y=parseInt(h.maxHeight);isNaN(y)||(t.maxHeight=y)}if(h&&h.minWidth)if(h.minWidth=="inherit")t.minWidth=e.clientWidth;else{var g=parseInt(h.minWidth);isNaN(g)||(t.minWidth=g)}if(h&&h.maxWidth)if(h.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var v=parseInt(h.maxWidth);isNaN(v)||(t.maxWidth=v)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},c=function(h,p,y){e=h,u(p),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),y&&(i(e,"change",s),i(e,"cut",l),i(e,"paste",l),i(e,"drop",l),i(e,"keydown",l),i(e,"focus",s),i(e,"compositionstart",l),i(e,"compositionupdate",l),i(e,"compositionend",l)),s()};function f(h){return h.currentStyle||document.defaultView.getComputedStyle(h)}return{init:function(h,p,y){c(h,p,y)},unObserve:function(){a(e,"change",s),a(e,"cut",l),a(e,"paste",l),a(e,"drop",l),a(e,"keydown",l),a(e,"focus",s),a(e,"compositionstart",l),a(e,"compositionupdate",l),a(e,"compositionend",l)},resize:s}}function tI(t,e){for(var r=dW(e),n=e.value.split(`
`),o=r,i=0,a=0;a<n.length;a++){var s=n[a];a!==0&&(i+=n[a-1].length+1);var l=i+s.length;if(t==="home"?o=i:t==="end"&&(o=l),r<=l)break}Ov(e,o)}function Hl(t){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hl(t)}function nI(t,e){return ZSe(t)||XSe(t,e)||qSe(t,e)||KSe()}function KSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qSe(t,e){if(t){if(typeof t=="string")return rI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rI(t,e)}}function rI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function XSe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function ZSe(t){if(Array.isArray(t))return t}function QSe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eCe(n.key),n)}}function JSe(t,e,r){return e&&oI(t.prototype,e),r&&oI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function eCe(t){var e=tCe(t,"string");return Hl(e)==="symbol"?e:String(e)}function tCe(t,e){if(Hl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mf(){return typeof Reflect<"u"&&Reflect.get?mf=Reflect.get.bind():mf=function(t,e,r){var n=nCe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},mf.apply(this,arguments)}function nCe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Da(t),t!==null););return t}function rCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&WC(t,e)}function WC(t,e){return WC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},WC(t,e)}function oCe(t){var e=aCe();return function(){var r=Da(t),n;if(e){var o=Da(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iCe(this,n)}}function iCe(t,e){if(e&&(Hl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return S2(t)}function S2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Da(t){return Da=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Da(t)}var sCe="ht_editor_visible",oy="ht_editor_hidden",iI="textEditor",lCe="text",Za=function(t){rCe(r,t);var e=oCe(r);function r(n){var o;return QSe(this,r),o=e.call(this,n),o.eventManager=new Tt(S2(o)),o.autoResize=$Se(),o.TEXTAREA=void 0,o.textareaStyle=void 0,o.TEXTAREA_PARENT=void 0,o.textareaParentStyle=void 0,o.layerClass=void 0,o.createElements(),o.bindEvents(),o.hot.addHookOnce("afterDestroy",function(){return o.destroy()}),o}return JSe(r,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(n){this.TEXTAREA.value=n}},{key:"open",value:function(){var n=this;this.refreshDimensions(),this.showEditableElement();var o=this.hot.getShortcutManager();o.setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",function(i){return n.onAfterDocumentKeyDown(i)}),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(n,o,i,a,s,l){var u=this.state;if(mf(Da(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),!l.readOnly){this.refreshDimensions(!0);var c=l.allowInvalid,f=l.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==Zt.FINISHED&&this.hideEditableElement();var h=!f;h&&!Ir()&&this.focus()}}},{key:"beginEditing",value:function(n,o){this.state===Zt.VIRGIN&&(this.TEXTAREA.value="",mf(Da(r.prototype),"beginEditing",this).call(this,n,o))}},{key:"focus",value:function(){this.TEXTAREA.select(),Ov(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var n=this.hot.rootDocument;this.TEXTAREA=n.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,te(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=n.createElement("DIV"),te(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ae(this.TEXTAREA_PARENT,this.layerClass)&&Ne(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,oy),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(Yee()||zee())&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ne(this.TEXTAREA_PARENT,this.layerClass),te(this.TEXTAREA_PARENT,oy)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var n=this.TEXTAREA_PARENT.childNodes,o=!1;Oe(n.length-1,function(i){var a=n[i];if(Ae(a,"handsontableEditor"))return o=!0,!1}),Ae(this.TEXTAREA_PARENT,oy)&&Ne(this.TEXTAREA_PARENT,oy),o?(this.layerClass=sCe,te(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),te(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var n=this.hot.toPhysicalRow(this.row),o=this.hot.getSourceDataAtCell(n,this.col);this.originalValue=o,this.setValue(o),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(this.state!==Zt.EDITING&&!n)){if(this.TD=this.getEditedCell(),!this.TD){n||this.close();return}var o=this.getEditedCellRect(),i=o.top,a=o.start,s=o.width,l=o.maxWidth,u=o.height,c=o.maxHeight;this.textareaParentStyle.top="".concat(i,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(a,"px"),this.showEditableElement();var f=Ma(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=f.fontSize,this.TEXTAREA.style.fontFamily=f.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var h=Ma(this.TEXTAREA),p=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),y=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),g=s-p,v=u-y,S=l-p,O=c-y;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(g,S),minHeight:Math.min(v,O),maxWidth:S,maxHeight:O},!0)}}},{key:"bindEvents",value:function(){var n=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(o){return o.stopPropagation()}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(o){return o.stopPropagation()}),dF()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",function(){return n.finishEditing(!1)}),this.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return n.refreshDimensions()}),this.addHook("afterColumnResize",function(){n.refreshDimensions(),n.focus()}),this.addHook("afterRowResize",function(){n.refreshDimensions(),n.focus()})}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor"),a={runOnlyIf:function(){return pe(n.hot.getSelected())},group:iI},s=function(){n.hot.rootDocument.execCommand("insertText",!1,`
`)};i.addShortcuts([{keys:[["Tab"]],callback:function(l){var u=n.hot.getSettings(),c=typeof u.tabMoves=="function"?u.tabMoves(l):u.tabMoves;n.hot.selection.transformStart(c.row,c.col,!0)}},{keys:[["Shift","Tab"]],callback:function(l){var u=n.hot.getSettings(),c=typeof u.tabMoves=="function"?u.tabMoves(l):u.tabMoves;n.hot.selection.transformStart(-c.row,-c.col)}},{keys:[["Control","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(l){return!n.hot.selection.isMultiple()&&!l.altKey},relativeToGroup:hf,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return s(),!1},runOnlyIf:function(){return!n.hot.selection.isMultiple()},relativeToGroup:hf,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return s(),!1},relativeToGroup:hf,position:"before"},{keys:[["PageUp"]],callback:function(){n.hot.selection.transformStart(-n.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){n.hot.selection.transformStart(n.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(l,u){var c=nI(u,1),f=c[0];tI(f,n.TEXTAREA)}},{keys:[["End"]],callback:function(l,u){var c=nI(u,1),f=c[0];tI(f,n.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){n.hot._registerTimeout(function(){n.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){n.hot._registerTimeout(function(){n.autoResize.resize()},10)}}],a)}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(Rv),o.removeShortcutsByGroup(iI),o.removeShortcutsByGroup(FC)}},{key:"onAfterDocumentKeyDown",value:function(n){var o=[Ce.ARROW_UP,Ce.ARROW_RIGHT,Ce.ARROW_DOWN,Ce.ARROW_LEFT];o.indexOf(n.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(n.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return lCe}}]),r}(gc),uCe="base";function yp(t,e,r,n,o,i,a){var s=[],l=[];a.className&&te(e,a.className),a.readOnly&&s.push(a.readOnlyCellClassName),a.valid===!1&&a.invalidCellClassName?s.push(a.invalidCellClassName):l.push(a.invalidCellClassName),a.wordWrap===!1&&a.noWordWrapClassName&&s.push(a.noWordWrapClassName),!i&&a.placeholder&&s.push(a.placeholderCellClassName),Ne(e,l),te(e,s)}yp.RENDERER_TYPE=uCe;var cCe="text";function Pi(t,e,r,n,o,i,a){yp.apply(this,[t,e,r,n,o,i,a]);var s=i;if(!s&&a.placeholder&&(s=a.placeholder),s=Dt(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){Nr(e);var l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else Pa(e,s)}Pi.RENDERER_TYPE=cCe;var fCe="text",C2={CELL_TYPE:fCe,editor:Za,renderer:Pi};Pr(C2);Vn.editors={BaseEditor:gc};function Vn(t,e){var r=new JE(t,e||{},OR);return r.init(),r}Vn.Core=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new JE(t,e,OR)};Vn.DefaultSettings=d2();Vn.hooks=ye.getSingleton();Vn.CellCoords=Fm;Vn.CellRange=hR;Vn.packageName="handsontable";Vn.buildDate="23/05/2023 09:21:52";Vn.version="12.4.0";Vn.languages={dictionaryKeys:Ave,getLanguageDictionary:e2,getLanguagesDictionaries:Vve,registerLanguageDictionary:JU,getTranslatedPhrase:t2};function aI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function hCe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?aI(Object(r),!0).forEach(function(n){dCe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Lh(t){"@babel/helpers - typeof";return Lh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lh(t)}function Bh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k2(n.key),n)}}function Vh(t,e,r){return e&&sI(t.prototype,e),r&&sI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dCe(t,e,r){return e=k2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wg(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&UC(t,e)}function Sg(t){return Sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Sg(t)}function UC(t,e){return UC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},UC(t,e)}function pCe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yCe(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O2(t)}function Cg(t){var e=pCe();return function(){var r=Sg(t),n;if(e){var o=Sg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yCe(this,n)}}function mCe(t){return gCe(t)||vCe(t)||bCe(t)||wCe()}function gCe(t){if(Array.isArray(t))return zC(t)}function vCe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bCe(t,e){if(t){if(typeof t=="string")return zC(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zC(t,e)}}function zC(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wCe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SCe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function k2(t){var e=SCe(t,"string");return typeof e=="symbol"?e:String(e)}var Nw=null,CCe="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",OCe="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Og="global",kCe="hot-wrapper-editor-container";function RCe(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function YC(t,e){var r=Ft.Children.toArray(t),n=Ft.Children.count(t),o=null;return n!==0&&(n===1&&r[0].props[e]?o=r[0]:o=r.find(function(i){return i.props[e]!==void 0})),o||null}function R2(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function E2(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=arguments.length>1?arguments[1]:void 0;if(e===null)return null;var r=P2(e.props,!1);return r.className="".concat(kCe," ").concat(r.className),GL.createPortal(Ft.createElement("div",Object.assign({},r),e),t.body)}function T2(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Og,n=YC(t,"hot-editor"),o=R2(n);return n?Ft.cloneElement(n,{emitEditorInstance:function(i,a){e.get(o)||e.set(o,new Map);var s=e.get(o);s.set(a??Og,i)},editorColumnScope:r,isEditor:!0}):null}function ECe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;r||(r=document),Nw||(Nw=r.createDocumentFragment());var n=r.createElement("DIV");Nw.appendChild(n);var o=Ft.cloneElement(t,hCe({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:GL.createPortal(o,n,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:n}}function P2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var M2=function(){function t(){Bh(this,t)}return Vh(t,null,[{key:"getSettings",value:function(e){var r={};if(e.settings){var n=e.settings;for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])}for(var i in e)i!=="settings"&&i!=="children"&&e.hasOwnProperty(i)&&(r[i]=e[i]);return r}}]),t}(),TCe=function(t){wg(r,t);var e=Cg(r);function r(){return Bh(this,r),e.apply(this,arguments)}return Vh(r,[{key:"getSettingsProps",value:function(){var n=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(o){return!n.internalProps.includes(o)}).reduce(function(o,i){return o[i]=n.props[i],o},{})}},{key:"getLocalEditorElement",value:function(){return T2(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var n=this.props._getChildElementByType(this.props.children,"hot-renderer"),o=this.getLocalEditorElement();this.columnSettings=M2.getSettings(this.getSettingsProps()),n!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(n),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),o!==null&&(this.columnSettings.editor=this.props._getEditorClass(o,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var n=this.props._getOwnerDocument(),o=E2(n,this.getLocalEditorElement());return Ft.createElement(Ft.Fragment,null,o)}}]),r}(Ft.Component),PCe=function(t){wg(r,t);var e=Cg(r);function r(){var n;return Bh(this,r),n=e.apply(this,arguments),n.state={portals:[]},n}return Vh(r,[{key:"render",value:function(){return Ft.createElement(Ft.Fragment,null,this.state.portals)}}]),r}(Ft.Component),MCe="12.4.0";function eT(t,e){return e={exports:{}},t(e,e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tn=typeof Symbol=="function"&&Symbol.for,tT=tn?Symbol.for("react.element"):60103,nT=tn?Symbol.for("react.portal"):60106,Nv=tn?Symbol.for("react.fragment"):60107,Lv=tn?Symbol.for("react.strict_mode"):60108,Bv=tn?Symbol.for("react.profiler"):60114,Vv=tn?Symbol.for("react.provider"):60109,Fv=tn?Symbol.for("react.context"):60110,rT=tn?Symbol.for("react.async_mode"):60111,Wv=tn?Symbol.for("react.concurrent_mode"):60111,Uv=tn?Symbol.for("react.forward_ref"):60112,zv=tn?Symbol.for("react.suspense"):60113,_Ce=tn?Symbol.for("react.suspense_list"):60120,Yv=tn?Symbol.for("react.memo"):60115,Gv=tn?Symbol.for("react.lazy"):60116,xCe=tn?Symbol.for("react.block"):60121,ACe=tn?Symbol.for("react.fundamental"):60117,jCe=tn?Symbol.for("react.responder"):60118,ICe=tn?Symbol.for("react.scope"):60119;function Un(t){if(Lh(t)==="object"&&t!==null){var e=t.$$typeof;switch(e){case tT:switch(t=t.type,t){case rT:case Wv:case Nv:case Bv:case Lv:case zv:return t;default:switch(t=t&&t.$$typeof,t){case Fv:case Uv:case Gv:case Yv:case Vv:return t;default:return e}}case nT:return e}}}function _2(t){return Un(t)===Wv}var HCe=rT,DCe=Wv,NCe=Fv,LCe=Vv,BCe=tT,VCe=Uv,FCe=Nv,WCe=Gv,UCe=Yv,zCe=nT,YCe=Bv,GCe=Lv,$Ce=zv,KCe=function(t){return _2(t)||Un(t)===rT},qCe=_2,XCe=function(t){return Un(t)===Fv},ZCe=function(t){return Un(t)===Vv},QCe=function(t){return Lh(t)==="object"&&t!==null&&t.$$typeof===tT},JCe=function(t){return Un(t)===Uv},e1e=function(t){return Un(t)===Nv},t1e=function(t){return Un(t)===Gv},n1e=function(t){return Un(t)===Yv},r1e=function(t){return Un(t)===nT},o1e=function(t){return Un(t)===Bv},i1e=function(t){return Un(t)===Lv},a1e=function(t){return Un(t)===zv},s1e=function(t){return typeof t=="string"||typeof t=="function"||t===Nv||t===Wv||t===Bv||t===Lv||t===zv||t===_Ce||Lh(t)==="object"&&t!==null&&(t.$$typeof===Gv||t.$$typeof===Yv||t.$$typeof===Vv||t.$$typeof===Fv||t.$$typeof===Uv||t.$$typeof===ACe||t.$$typeof===jCe||t.$$typeof===ICe||t.$$typeof===xCe)},l1e=Un,u1e={AsyncMode:HCe,ConcurrentMode:DCe,ContextConsumer:NCe,ContextProvider:LCe,Element:BCe,ForwardRef:VCe,Fragment:FCe,Lazy:WCe,Memo:UCe,Portal:zCe,Profiler:YCe,StrictMode:GCe,Suspense:$Ce,isAsyncMode:KCe,isConcurrentMode:qCe,isContextConsumer:XCe,isContextProvider:ZCe,isElement:QCe,isForwardRef:JCe,isFragment:e1e,isLazy:t1e,isMemo:n1e,isPortal:r1e,isProfiler:o1e,isStrictMode:i1e,isSuspense:a1e,isValidElementType:s1e,typeOf:l1e},ht=eT(function(t,e){});ht.AsyncMode;ht.ConcurrentMode;ht.ContextConsumer;ht.ContextProvider;ht.Element;ht.ForwardRef;ht.Fragment;ht.Lazy;ht.Memo;ht.Portal;ht.Profiler;ht.StrictMode;ht.Suspense;ht.isAsyncMode;ht.isConcurrentMode;ht.isContextConsumer;ht.isContextProvider;ht.isElement;ht.isForwardRef;ht.isFragment;ht.isLazy;ht.isMemo;ht.isPortal;ht.isProfiler;ht.isStrictMode;ht.isSuspense;ht.isValidElementType;ht.typeOf;eT(function(t){t.exports=u1e});/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var lI=Object.getOwnPropertySymbols,c1e=Object.prototype.hasOwnProperty,f1e=Object.prototype.propertyIsEnumerable;function h1e(t){if(t==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function d1e(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de",Object.getOwnPropertyNames(t)[0]==="5")return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;var n=Object.getOwnPropertyNames(e).map(function(i){return e[i]});if(n.join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(i){o[i]=i}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}d1e();var p1e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",y1e=p1e;Function.call.bind(Object.prototype.hasOwnProperty);function x2(){}function A2(){}A2.resetWarningCache=x2;var m1e=function(){function t(n,o,i,a,s,l){if(l!==y1e){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:A2,resetWarningCache:x2};return r.PropTypes=r,r},g1e=eT(function(t){t.exports=m1e()}),Lw=g1e,j2=function(t){wg(r,t);var e=Cg(r);function r(){var n;return Bh(this,r),n=e.apply(this,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCacheArray=[],n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return Vh(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(OCe),null)},set:function(n){this.__hotInstance=n}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(n){this.hotElementRef=n}},{key:"getRendererWrapper",value:function(n){var o=this;return function(i,a,s,l,u,c,f){var h=o.getRenderedCellCache();if(h.has("".concat(s,"-").concat(l))&&(a.innerHTML=h.get("".concat(s,"-").concat(l)).innerHTML),a&&!a.getAttribute("ghost-table")){for(var p=ECe(n,{TD:a,row:s,col:l,prop:u,value:c,cellProperties:f,isRenderer:!0},a.ownerDocument),y=p.portal,g=p.portalContainer;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(g),o.portalCacheArray.push(y)}return h.set("".concat(s,"-").concat(l),a),a}}},{key:"getEditorClass",value:function(n){var o,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Og,a=R2(n),s=(o=this.getEditorCache().get(a))===null||o===void 0?void 0:o.get(i);return this.makeEditorClass(s)}},{key:"makeEditorClass",value:function(n){var o=function(i){wg(s,i);var a=Cg(s);function s(l){var u;return Bh(this,s),u=a.call(this,l),n.hotCustomEditorInstance=O2(u),u.editorComponent=n,u}return Vh(s,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),s}(Vn.editors.BaseEditor);return Object.getOwnPropertyNames(Vn.editors.BaseEditor.prototype).forEach(function(i){i!=="constructor"&&(o.prototype[i]=function(){for(var a,s=arguments.length,l=new Array(s),u=0;u<s;u++)l[u]=arguments[u];return(a=n[i]).call.apply(a,[n].concat(l))})}),o}},{key:"getGlobalRendererElement",value:function(){return YC(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return T2(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var n=M2.getSettings(this.props),o=this.getGlobalRendererElement(),i=this.getGlobalEditorElement();return n.columns=this.columnSettings.length?this.columnSettings:n.columns,i?n.editor=this.getEditorClass(i,Og):n.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),o?(n.renderer=this.getRendererWrapper(o),this.componentRendererColumns.set("global",!0)):n.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),n}},{key:"displayAutoSizeWarning",value:function(n){var o,i;this.hotInstance&&((o=this.hotInstance.getPlugin("autoRowSize"))!==null&&o!==void 0&&o.enabled||(i=this.hotInstance.getPlugin("autoColumnSize"))!==null&&i!==void 0&&i.enabled)&&this.componentRendererColumns.size>0&&RCe(CCe)}},{key:"setHotColumnSettings",value:function(n,o){this.columnSettings[o]=n}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var n=this;this.renderersPortalManager.setState({portals:mCe(this.portalCacheArray)},function(){n.portalCacheArray=[]})}},{key:"updateHot",value:function(n){this.hotInstance&&this.hotInstance.updateSettings(n,!1)}},{key:"setRenderersPortalManagerRef",value:function(n){this.renderersPortalManager=n}},{key:"componentDidMount",value:function(){var n=this,o=this.createNewGlobalSettings();this.hotInstance=new Vn.Core(this.hotElementRef,o),this.hotInstance.addHook("beforeViewRender",function(){return n.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return n.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(o)}},{key:"componentDidUpdate",value:function(){this.clearCache();var n=this.createNewGlobalSettings();this.updateHot(n),this.displayAutoSizeWarning(n)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var n=this,o=P2(this.props),i=function(u){return u.type===TCe},a=Ft.Children.toArray(this.props.children),s=a.filter(function(u){return i(u)}).map(function(u,c){return Ft.cloneElement(u,{_componentRendererColumns:n.componentRendererColumns,_emitColumnSettings:n.setHotColumnSettings.bind(n),_columnIndex:c,_getChildElementByType:YC.bind(n),_getRendererWrapper:n.getRendererWrapper.bind(n),_getEditorClass:n.getEditorClass.bind(n),_getOwnerDocument:n.getOwnerDocument.bind(n),_getEditorCache:n.getEditorCache.bind(n),children:u.props.children})}),l=E2(this.getOwnerDocument(),this.getGlobalEditorElement());return Ft.createElement(Ft.Fragment,null,Ft.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},o),s),Ft.createElement(PCe,{ref:this.setRenderersPortalManagerRef.bind(this)}),l)}}],[{key:"version",get:function(){return MCe}}]),r}(Ft.Component);j2.propTypes={style:Lw.object,id:Lw.string,className:Lw.string};Ft.Component;function Dl(t){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dl(t)}function v1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w1e(n.key),n)}}function b1e(t,e,r){return e&&uI(t.prototype,e),r&&uI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function w1e(t){var e=S1e(t,"string");return Dl(e)==="symbol"?e:String(e)}function S1e(t,e){if(Dl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Dl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sr(){return typeof Reflect<"u"&&Reflect.get?sr=Reflect.get.bind():sr=function(t,e,r){var n=C1e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},sr.apply(this,arguments)}function C1e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Nn(t),t!==null););return t}function O1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&GC(t,e)}function GC(t,e){return GC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},GC(t,e)}function k1e(t){var e=T1e();return function(){var r=Nn(t),n;if(e){var o=Nn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R1e(this,n)}}function R1e(t,e){if(e&&(Dl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E1e(t)}function E1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nn(t){return Nn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Nn(t)}var cI="handsontableEditor",P1e="handsontable",oT=function(t){O1e(r,t);var e=k1e(r);function r(){return v1e(this,r),e.apply(this,arguments)}return b1e(r,[{key:"open",value:function(){sr(Nn(r.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ov(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),sr(Nn(r.prototype),"close",this).call(this)}},{key:"prepare",value:function(n,o,i,a,s,l){sr(Nn(r.prototype),"prepare",this).call(this,n,o,i,a,s,l);var u=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(f,h){var p=this.getSourceData(h.row,h.col);p!==void 0&&u.setValue(p),u.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Yt(c,l.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(n,o){var i=this.hot.getSettings().onBeginEditing;i&&i()===!1||sr(Nn(r.prototype),"beginEditing",this).call(this,n,o)}},{key:"createElements",value:function(){sr(Nn(r.prototype),"createElements",this).call(this);var n=this.hot.rootDocument.createElement("DIV");n.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(n),this.htContainer=n,this.assignHooks()}},{key:"finishEditing",value:function(n,o,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var a=this.htEditor.getInstance().getValue();a!==void 0&&this.setValue(a)}sr(Nn(r.prototype),"finishEditing",this).call(this,n,o,i)}},{key:"assignHooks",value:function(){var n=this;this.hot.addHook("afterDestroy",function(){n.htEditor&&n.htEditor.destroy()})}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor");sr(Nn(r.prototype),"registerShortcuts",this).call(this);var a={group:cI,relativeToGroup:Rv,position:"before"},s=function(l,u){var c=n.htEditor.getInstance();if(l!==void 0&&(l<0||c.flipped&&l>c.countRows()-1?c.deselectCell():c.selectCell(l,0),c.getData().length))return u.preventDefault(),Lr(u),n.hot.listen(),n.TEXTAREA.focus(),!1};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(l){var u=n.htEditor.getInstance(),c,f;return!u.getSelectedLast()&&u.flipped?c=u.countRows()-1:u.getSelectedLast()&&(u.flipped?(f=u.getSelectedLast()[0],c=Math.max(0,f-1)):(f=u.getSelectedLast()[0],c=f-1)),s(c,l)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(l){var u=n.htEditor.getInstance(),c,f;if(!u.getSelectedLast()&&!u.flipped)c=0;else if(u.getSelectedLast()){if(u.flipped)c=u.getSelectedLast()[0]+1;else if(!u.flipped){var h=u.countRows()-1;f=u.getSelectedLast()[0],c=Math.min(h,f+1)}}return s(c,l)},preventDefault:!1}],a)}},{key:"unregisterShortcuts",value:function(){sr(Nn(r.prototype),"unregisterShortcuts",this).call(this);var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(cI)}}],[{key:"EDITOR_TYPE",get:function(){return P1e}}]),r}(Za);function Nl(t){"@babel/helpers - typeof";return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nl(t)}function M1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I2(n.key),n)}}function _1e(t,e,r){return e&&fI(t.prototype,e),r&&fI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Zi(){return typeof Reflect<"u"&&Reflect.get?Zi=Reflect.get.bind():Zi=function(t,e,r){var n=x1e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Zi.apply(this,arguments)}function x1e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=lo(t),t!==null););return t}function A1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$C(t,e)}function $C(t,e){return $C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$C(t,e)}function j1e(t){var e=H1e();return function(){var r=lo(t),n;if(e){var o=lo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return I1e(this,n)}}function I1e(t,e){if(e&&(Nl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return KC(t)}function KC(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lo(t){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lo(t)}function D1e(t,e,r){return e=I2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I2(t){var e=N1e(t,"string");return Nl(e)==="symbol"?e:String(e)}function N1e(t,e){if(Nl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bw=new WeakMap,L1e="autocomplete",iT=function(t){A1e(r,t);var e=j1e(r);function r(n){var o;return M1e(this,r),o=e.call(this,n),D1e(KC(o),"sortByRelevance",function(i,a,s){var l=[],u=[],c=i.length,f=a.length,h,p,y,g;if(c===0){for(y=0;y<f;y++)u.push(y);return u}for(y=0;y<f;y++){if(p=Y_(Dt(a[y])),s)g=p.indexOf(i);else{var v=this.cellProperties.locale;g=p.toLocaleLowerCase(v).indexOf(i.toLocaleLowerCase(v))}g!==-1&&(h=p.length-g-c,l.push({baseIndex:y,index:g,charsLeft:h,value:p}))}for(l.sort(function(S,O){if(O.index===-1)return-1;if(S.index===-1)return 1;if(S.index<O.index)return-1;if(O.index<S.index)return 1;if(S.index===O.index){if(S.charsLeft<O.charsLeft)return-1;if(S.charsLeft>O.charsLeft)return 1}return 0}),y=0,f=l.length;y<f;y++)u.push(l[y].baseIndex);return u}),o.query=null,o.strippedChoices=[],o.rawChoices=[],Bw.set(KC(o),{skipOne:!1,isMacOS:o.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),o}return _1e(r,[{key:"getValue",value:function(){var n=this,o=this.rawChoices.find(function(i){var a=n.stripValueIfNeeded(i);return a===n.TEXTAREA.value});return pe(o)?o:this.TEXTAREA.value}},{key:"createElements",value:function(){Zi(lo(r.prototype),"createElements",this).call(this),te(this.htContainer,"autocompleteEditor"),te(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}},{key:"open",value:function(){var n=this,o=Bw.get(this);Zi(lo(r.prototype),"open",this).call(this);var i=this.htEditor.getInstance(),a=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var s=en();s===0&&o.isMacOS&&(s+=15),this.addHook("beforeKeyDown",function(l){return n.onBeforeKeyDown(l)}),i.updateSettings({colWidths:a?[ut(this.TEXTAREA)-2]:void 0,width:a?ut(this.TEXTAREA)+s:void 0,renderer:function(l,u,c,f,h,p,y){Pi(l,u,c,f,h,p,y);var g=n.cellProperties,v=g.filteringCaseSensitive,S=g.allowHtml,O=g.locale,w=n.query,x=Dt(p),T,z;x&&!S&&(T=v===!0?x.indexOf(w):x.toLocaleLowerCase(O).indexOf(w.toLocaleLowerCase(O)),T!==-1&&(z=x.substr(T,w.length),x=x.replace(z,"<strong>".concat(z,"</strong>")))),u.innerHTML=x},autoColumnSize:!0}),o.skipOne&&(o.skipOne=!1),this.hot._registerTimeout(function(){n.queryChoices(n.TEXTAREA.value)})}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),Zi(lo(r.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(n){Zi(lo(r.prototype),"discardEditor",this).call(this,n),this.hot.view.render()}},{key:"queryChoices",value:function(n){var o=this,i=this.cellProperties.source;this.query=n,typeof i=="function"?i.call(this.cellProperties,n,function(a){o.rawChoices=a,o.updateChoicesList(o.stripValuesIfNeeded(a))}):Array.isArray(i)?(this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(n){var o=dW(this.TEXTAREA),i=eae(this.TEXTAREA),a=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,l=null,u=null,c=n;a&&(l=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),c,this.cellProperties.filteringCaseSensitive));var f=Array.isArray(l)?l.length:0;if(s===!1)f&&(u=l[0]);else{for(var h=[],p=0,y=c.length;p<y&&!(a&&f<=p);p++)f?h.push(c[l[p]]):h.push(c[p]);u=0,c=h}this.strippedChoices=c,this.htEditor.loadData(Fy([c])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(u),this.hot.listen(),Ov(this.TEXTAREA,o,o===i?void 0:i)}},{key:"flipDropdownIfNeeded",value:function(){var n=rl(this.hot.view._wt.wtTable.TABLE),o=n===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(o||!o&&(i||i==="horizontal"))return!1;var a=Wt(this.TEXTAREA),s=Rt(this.TEXTAREA),l=this.getDropdownHeight(),u=n.scrollTop,c=Rt(this.hot.view._wt.wtTable.THEAD),f=Wt(n),h=a.top-f.top-c+u,p=n.scrollHeight-h-c-s,y=l>p&&h>p;return y?this.flipDropdown(l):this.unflipDropdown(),this.limitDropdownIfNeeded(y?h:p,l),y}},{key:"limitDropdownIfNeeded",value:function(n,o){if(o>n){var i=0,a=0,s=0,l=null;do s=this.htEditor.getRowHeight(a)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=s,a+=1;while(i<n);l=i-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+o-l,"px")),this.setDropdownHeight(i-s)}}},{key:"flipDropdown",value:function(n){var o=this.htEditor.rootElement.style;o.position="absolute",o.top="".concat(-n,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var n=this.htEditor.rootElement.style;n.position="absolute",n.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var n=this.htEditor.getColWidth(0)+en(this.hot.rootDocument)+2,o=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:o?void 0:n}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(n){this.htEditor.updateSettings({height:n})}},{key:"highlightBestMatchingChoice",value:function(n){typeof n=="number"?this.htEditor.selectCell(n,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var n=this.htEditor.getInstance().getRowHeight(0)||23,o=this.cellProperties.visibleRows;return this.strippedChoices.length>=o?o*n:this.strippedChoices.length*n+8}},{key:"stripValueIfNeeded",value:function(n){return this.stripValuesIfNeeded([n])[0]}},{key:"stripValuesIfNeeded",value:function(n){var o=this.cellProperties.allowHtml,i=Ye(n,function(s){return Dt(s)}),a=Ye(i,function(s){return o?s:Y_(s)});return a}},{key:"allowKeyEventPropagation",value:function(n){var o=this.htEditor.getSelectedRangeLast(),i={row:o?o.from.row:-1},a=!1;return n===Ce.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(a=!0),n===Ce.ARROW_UP&&i.row>-1&&(a=!0),a}},{key:"onBeforeKeyDown",value:function(n){var o=this,i=Bw.get(this);if(i.skipOne=!1,_ae(n.keyCode)||n.keyCode===Ce.BACKSPACE||n.keyCode===Ce.DELETE||n.keyCode===Ce.INSERT){var a=10;if(n.keyCode===Ce.C&&(n.ctrlKey||n.metaKey))return;this.isOpened()||(a+=10),this.htEditor&&this.hot._registerTimeout(function(){o.queryChoices(o.TEXTAREA.value),i.skipOne=!0},a)}}}],[{key:"EDITOR_TYPE",get:function(){return L1e}}]),r}(oT);function Ll(t){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ll(t)}function B1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,F1e(n.key),n)}}function V1e(t,e,r){return e&&hI(t.prototype,e),r&&hI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function F1e(t){var e=W1e(t,"string");return Ll(e)==="symbol"?e:String(e)}function W1e(t,e){if(Ll(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ll(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U1e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qC(t,e)}function qC(t,e){return qC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},qC(t,e)}function z1e(t){var e=$1e();return function(){var r=kg(t),n;if(e){var o=kg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Y1e(this,n)}}function Y1e(t,e){if(e&&(Ll(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return G1e(t)}function G1e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $1e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kg(t){return kg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kg(t)}var K1e="checkbox",H2=function(t){U1e(r,t);var e=z1e(r);function r(){return B1e(this,r),e.apply(this,arguments)}return V1e(r,[{key:"beginEditing",value:function(n,o){if(o&&o.type==="mouseup"){var i=this.TD.querySelector('input[type="checkbox"]');Ae(i,"htBadValue")||i.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}],[{key:"EDITOR_TYPE",get:function(){return K1e}}]),r}(gc),D2={exports:{}};const q1e=cG(Vie);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(r,n){var o;{try{o=q1e}catch{}t.exports=n(o)}})(Hy,function(r){var n=typeof r=="function",o=!!window.addEventListener,i=window.document,a=window.setTimeout,s=function(P,d,m,b){o?P.addEventListener(d,m,!!b):P.attachEvent("on"+d,m)},l=function(P,d,m,b){o?P.removeEventListener(d,m,!!b):P.detachEvent("on"+d,m)},u=function(P){return P.trim?P.trim():P.replace(/^\s+|\s+$/g,"")},c=function(P,d){return(" "+P.className+" ").indexOf(" "+d+" ")!==-1},f=function(P,d){c(P,d)||(P.className=P.className===""?d:P.className+" "+d)},h=function(P,d){P.className=u((" "+P.className+" ").replace(" "+d+" "," "))},p=function(P){return/Array/.test(Object.prototype.toString.call(P))},y=function(P){return/Date/.test(Object.prototype.toString.call(P))&&!isNaN(P.getTime())},g=function(P){var d=P.getDay();return d===0||d===6},v=function(P){return P%4===0&&P%100!==0||P%400===0},S=function(P,d){return[31,v(P)?29:28,31,30,31,30,31,31,30,31,30,31][d]},O=function(P){y(P)&&P.setHours(0,0,0,0)},w=function(P,d){return P.getTime()===d.getTime()},x=function(P,d,m){var b,k;for(b in d)k=P[b]!==void 0,k&&typeof d[b]=="object"&&d[b]!==null&&d[b].nodeName===void 0?y(d[b])?m&&(P[b]=new Date(d[b].getTime())):p(d[b])?m&&(P[b]=d[b].slice(0)):P[b]=x({},d[b],m):(m||!k)&&(P[b]=d[b]);return P},T=function(P,d,m){var b;i.createEvent?(b=i.createEvent("HTMLEvents"),b.initEvent(d,!0,!1),b=x(b,m),P.dispatchEvent(b)):i.createEventObject&&(b=i.createEventObject(),b=x(b,m),P.fireEvent("on"+d,b))},z=function(P){return P.month<0&&(P.year-=Math.ceil(Math.abs(P.month)/12),P.month+=12),P.month>11&&(P.year+=Math.floor(Math.abs(P.month)/12),P.month-=12),P},$={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ne=function(P,d,m){for(d+=P.firstDay;d>=7;)d-=7;return m?P.i18n.weekdaysShort[d]:P.i18n.weekdays[d]},G=function(P){var d=[],m="false";if(P.isEmpty)if(P.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),P.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return P.isDisabled&&d.push("is-disabled"),P.isToday&&d.push("is-today"),P.isSelected&&(d.push("is-selected"),m="true"),P.hasEvent&&d.push("has-event"),P.isInRange&&d.push("is-inrange"),P.isStartRange&&d.push("is-startrange"),P.isEndRange&&d.push("is-endrange"),'<td data-day="'+P.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+P.year+'" data-pika-month="'+P.month+'" data-pika-day="'+P.day+'">'+P.day+"</button></td>"},q=function(P,d){P.setHours(0,0,0,0);var m=P.getDate(),b=P.getDay(),k=d,E=k-1,A=7,W=function(me){return(me+A-1)%A};P.setDate(m+E-W(b));var N=new Date(P.getFullYear(),0,k),K=24*60*60*1e3,X=(P.getTime()-N.getTime())/K,re=1+Math.round((X-E+W(N.getDay()))/A);return re},Z=function(P,d,m,b){var k=new Date(m,d,P),E=n?r(k).isoWeek():q(k,b);return'<td class="pika-week">'+E+"</td>"},ee=function(P,d,m,b){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(d?P.reverse():P).join("")+"</tr>"},Q=function(P){return"<tbody>"+P.join("")+"</tbody>"},ce=function(P){var d,m=[];for(P.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+ne(P,d)+'">'+ne(P,d,!0)+"</abbr></th>");return"<thead><tr>"+(P.isRTL?m.reverse():m).join("")+"</tr></thead>"},fe=function(P,d,m,b,k,E){var A,W,N,K=P._o,X=m===K.minYear,re=m===K.maxYear,me='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',le,ke,be=!0,Y=!0;for(N=[],A=0;A<12;A++)N.push('<option value="'+(m===k?A-d:12+A-d)+'"'+(A===b?' selected="selected"':"")+(X&&A<K.minMonth||re&&A>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[A]+"</option>");for(le='<div class="pika-label">'+K.i18n.months[b]+'<select class="pika-select pika-select-month" tabindex="-1">'+N.join("")+"</select></div>",p(K.yearRange)?(A=K.yearRange[0],W=K.yearRange[1]+1):(A=m-K.yearRange,W=1+m+K.yearRange),N=[];A<W&&A<=K.maxYear;A++)A>=K.minYear&&N.push('<option value="'+A+'"'+(A===m?' selected="selected"':"")+">"+A+"</option>");return ke='<div class="pika-label">'+m+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+N.join("")+"</select></div>",K.showMonthAfterYear?me+=ke+le:me+=le+ke,X&&(b===0||K.minMonth>=b)&&(be=!1),re&&(b===11||K.maxMonth<=b)&&(Y=!1),d===0&&(me+='<button class="pika-prev'+(be?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),d===P._o.numberOfMonths-1&&(me+='<button class="pika-next'+(Y?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),me+="</div>"},we=function(P,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ce(P)+Q(d)+"</table>"},Se=function(P){var d=this,m=d.config(P);d._onMouseDown=function(k){if(d._v){k=k||window.event;var E=k.target||k.srcElement;if(E)if(c(E,"is-disabled")||(c(E,"pika-button")&&!c(E,"is-empty")&&!c(E.parentNode,"is-disabled")?(d.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),m.bound&&a(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(E,"pika-prev")?d.prevMonth():c(E,"pika-next")&&d.nextMonth()),c(E,"pika-select"))d._c=!0;else if(k.preventDefault)k.preventDefault();else return k.returnValue=!1,!1}},d._onChange=function(k){k=k||window.event;var E=k.target||k.srcElement;E&&(c(E,"pika-select-month")?d.gotoMonth(E.value):c(E,"pika-select-year")&&d.gotoYear(E.value))},d._onKeyChange=function(k){if(k=k||window.event,d.isVisible())switch(k.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(n){var k=r(m.field.value,m.format,m.formatStrict);return k&&k.isValid()?k.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(k){var E;k.firedBy!==d&&(E=d._parseFieldValue(),y(E)&&d.setDate(E),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var k=i.activeElement;do if(c(k,"pika-single"))return;while(k=k.parentNode);d._c||(d._b=a(function(){d.hide()},50)),d._c=!1},d._onClick=function(k){k=k||window.event;var E=k.target||k.srcElement,A=E;if(E){!o&&c(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),s(E,"change",d._onChange)));do if(c(A,"pika-single")||A===m.trigger)return;while(A=A.parentNode);d._v&&E!==m.trigger&&A!==m.trigger&&d.hide()}},d.el=i.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),s(d.el,"mousedown",d._onMouseDown,!0),s(d.el,"touchend",d._onMouseDown,!0),s(d.el,"change",d._onChange),m.keyboardInput&&s(i,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?i.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),s(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var b=m.defaultDate;y(b)?m.setDefaultDate?d.setDate(b,!0):d.gotoDate(b):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",s(m.trigger,"click",d._onInputClick),s(m.trigger,"focus",d._onInputFocus),s(m.trigger,"blur",d._onInputBlur)):this.show()};return Se.prototype={config:function(P){this._o||(this._o=x({},$,!0));var d=x(this._o,P,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,y(d.minDate)||(d.minDate=!1),y(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),p(d.yearRange)){var b=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||b,d.yearRange[1]=parseInt(d.yearRange[1],10)||b}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||$.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(P){return P=P||this._o.format,y(this._d)?this._o.toString?this._o.toString(this._d,P):n?r(this._d).format(P):this._d.toDateString():""},getMoment:function(){return n?r(this._d):null},setMoment:function(P,d){n&&r.isMoment(P)&&this.setDate(P.toDate(),d)},getDate:function(){return y(this._d)?new Date(this._d.getTime()):null},setDate:function(P,d){if(!P)return this._d=null,this._o.field&&(this._o.field.value="",T(this._o.field,"change",{firedBy:this})),this.draw();if(typeof P=="string"&&(P=new Date(Date.parse(P))),!!y(P)){var m=this._o.minDate,b=this._o.maxDate;y(m)&&P<m?P=m:y(b)&&P>b&&(P=b),this._d=new Date(P.getTime()),O(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),T(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(P){var d=!0;if(y(P)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),b=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),k=P.getTime();b.setMonth(b.getMonth()+1),b.setDate(b.getDate()-1),d=k<m.getTime()||b.getTime()<k}d&&(this.calendars=[{month:P.getMonth(),year:P.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(P,d){var m=this.getDate()||new Date,b=parseInt(d)*24*60*60*1e3,k;P==="add"?k=new Date(m.valueOf()+b):P==="subtract"&&(k=new Date(m.valueOf()-b)),this.setDate(k)},adjustCalendars:function(){this.calendars[0]=z(this.calendars[0]);for(var P=1;P<this._o.numberOfMonths;P++)this.calendars[P]=z({month:this.calendars[0].month+P,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(P){isNaN(P)||(this.calendars[0].month=parseInt(P,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(P){isNaN(P)||(this.calendars[0].year=parseInt(P,10),this.adjustCalendars())},setMinDate:function(P){P instanceof Date?(O(P),this._o.minDate=P,this._o.minYear=P.getFullYear(),this._o.minMonth=P.getMonth()):(this._o.minDate=$.minDate,this._o.minYear=$.minYear,this._o.minMonth=$.minMonth,this._o.startRange=$.startRange),this.draw()},setMaxDate:function(P){P instanceof Date?(O(P),this._o.maxDate=P,this._o.maxYear=P.getFullYear(),this._o.maxMonth=P.getMonth()):(this._o.maxDate=$.maxDate,this._o.maxYear=$.maxYear,this._o.maxMonth=$.maxMonth,this._o.endRange=$.endRange),this.draw()},setStartRange:function(P){this._o.startRange=P},setEndRange:function(P){this._o.endRange=P},draw:function(P){if(!(!this._v&&!P)){var d=this._o,m=d.minYear,b=d.maxYear,k=d.minMonth,E=d.maxMonth,A="",W;this._y<=m&&(this._y=m,!isNaN(k)&&this._m<k&&(this._m=k)),this._y>=b&&(this._y=b,!isNaN(E)&&this._m>E&&(this._m=E));for(var N=0;N<d.numberOfMonths;N++)W="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),A+='<div class="pika-lendar">'+fe(this,N,this.calendars[N].year,this.calendars[N].month,this.calendars[0].year,W)+this.render(this.calendars[N].year,this.calendars[N].month,W)+"</div>";this.el.innerHTML=A,d.bound&&d.field.type!=="hidden"&&a(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var P,d,m,b,k,E,A,W,N,K,X,re;if(!this._o.container){if(this.el.style.position="absolute",P=this._o.trigger,d=P,m=this.el.offsetWidth,b=this.el.offsetHeight,k=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,A=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,X=!0,re=!0,typeof P.getBoundingClientRect=="function")K=P.getBoundingClientRect(),W=K.left+window.pageXOffset,N=K.bottom+window.pageYOffset;else for(W=d.offsetLeft,N=d.offsetTop+d.offsetHeight;d=d.offsetParent;)W+=d.offsetLeft,N+=d.offsetTop;(this._o.reposition&&W+m>k||this._o.position.indexOf("right")>-1&&W-m+P.offsetWidth>0)&&(W=W-m+P.offsetWidth,X=!1),(this._o.reposition&&N+b>E+A||this._o.position.indexOf("top")>-1&&N-b-P.offsetHeight>0)&&(N=N-b-P.offsetHeight,re=!1),this.el.style.left=W+"px",this.el.style.top=N+"px",f(this.el,X?"left-aligned":"right-aligned"),f(this.el,re?"bottom-aligned":"top-aligned"),h(this.el,X?"right-aligned":"left-aligned"),h(this.el,re?"top-aligned":"bottom-aligned")}},render:function(P,d,m){var b=this._o,k=new Date,E=S(P,d),A=new Date(P,d,1).getDay(),W=[],N=[];O(k),b.firstDay>0&&(A-=b.firstDay,A<0&&(A+=7));for(var K=d===0?11:d-1,X=d===11?0:d+1,re=d===0?P-1:P,me=d===11?P+1:P,le=S(re,K),ke=E+A,be=ke;be>7;)be-=7;ke+=7-be;for(var Y=!1,Le=0,He=0;Le<ke;Le++){var Ee=new Date(P,d,1+(Le-A)),De=y(this._d)?w(Ee,this._d):!1,Me=w(Ee,k),C=b.events.indexOf(Ee.toDateString())!==-1,R=Le<A||Le>=E+A,M=1+(Le-A),B=d,I=P,V=b.startRange&&w(b.startRange,Ee),H=b.endRange&&w(b.endRange,Ee),D=b.startRange&&b.endRange&&b.startRange<Ee&&Ee<b.endRange,F=b.minDate&&Ee<b.minDate||b.maxDate&&Ee>b.maxDate||b.disableWeekends&&g(Ee)||b.disableDayFn&&b.disableDayFn(Ee);R&&(Le<A?(M=le+M,B=K,I=re):(M=M-E,B=X,I=me));var L={day:M,month:B,year:I,hasEvent:C,isSelected:De,isToday:Me,isDisabled:F,isEmpty:R,isStartRange:V,isEndRange:H,isInRange:D,showDaysInNextAndPreviousMonths:b.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:b.enableSelectionDaysInNextAndPreviousMonths};b.pickWholeWeek&&De&&(Y=!0),N.push(G(L)),++He===7&&(b.showWeekNumber&&N.unshift(Z(Le-A,d,P,b.firstWeekOfYearMinDays)),W.push(ee(N,b.isRTL,b.pickWholeWeek,Y)),N=[],He=0,Y=!1)}return we(b,W,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),h(this.el,"is-hidden"),this._o.bound&&(s(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var P=this._v;P!==!1&&(this._o.bound&&l(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),f(this.el,"is-hidden"),this._v=!1,P!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var P=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),P.keyboardInput&&l(i,"keydown",this._onKeyChange),P.field&&(l(P.field,"change",this._onInputChange),P.bound&&(l(P.trigger,"click",this._onInputClick),l(P.trigger,"focus",this._onInputFocus),l(P.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Se})})(D2);var X1e=D2.exports;const dI=$L(X1e);function Bl(t){"@babel/helpers - typeof";return Bl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bl(t)}function Z1e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J1e(n.key),n)}}function Q1e(t,e,r){return e&&pI(t.prototype,e),r&&pI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function J1e(t){var e=eOe(t,"string");return Bl(e)==="symbol"?e:String(e)}function eOe(t,e){if(Bl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function io(){return typeof Reflect<"u"&&Reflect.get?io=Reflect.get.bind():io=function(t,e,r){var n=tOe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},io.apply(this,arguments)}function tOe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=cr(t),t!==null););return t}function nOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XC(t,e)}function XC(t,e){return XC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},XC(t,e)}function rOe(t){var e=aOe();return function(){var r=cr(t),n;if(e){var o=cr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oOe(this,n)}}function oOe(t,e){if(e&&(Bl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iOe(t)}function iOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cr(t){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cr(t)}var N2="date",yI="dateEditor",L2=function(t){nOe(r,t);var e=rOe(r);function r(n){var o;return Z1e(this,r),o=e.call(this,n),o.defaultDateFormat="DD/MM/YYYY",o.isCellEdited=!1,o.parentDestroyed=!1,o.$datePicker=null,o}return Q1e(r,[{key:"init",value:function(){var n=this;if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof dI!="function")throw new Error("You need to include Pikaday to your project.");io(cr(r.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){n.parentDestroyed=!0,n.destroyElements()})}},{key:"createElements",value:function(){io(cr(r.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),te(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);var n=new Tt(this);n.addEventListener(this.datePicker,"mousedown",function(o){return o.stopPropagation()})}},{key:"destroyElements",value:function(){var n=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),n&&n.removeChild(this.datePicker)}},{key:"prepare",value:function(n,o,i,a,s,l){io(cr(r.prototype),"prepare",this).call(this,n,o,i,a,s,l)}},{key:"open",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,o=this.hot.getShortcutManager(),i=o.getContext("editor");io(cr(r.prototype),"open",this).call(this),this.showDatepicker(n),i.addShortcut({keys:[["Enter"]],callback:function(a){a.stopPropagation()},group:yI})}},{key:"close",value:function(){var n,o=this;this._opened=!1,(n=this.$datePicker)!==null&&n!==void 0&&n.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(function(){o.instance._refreshBorders()});var i=this.hot.getShortcutManager(),a=i.getContext("editor");a.removeShortcutsByGroup(yI),io(cr(r.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var i=this.originalValue;i!==void 0&&this.setValue(i)}io(cr(r.prototype),"finishEditing",this).call(this,n,o)}},{key:"showDatepicker",value:function(n){var o=this.TD.getBoundingClientRect(),i=this.cellProperties.dateFormat||this.defaultDateFormat,a=this.instance.view.isMouseDown(),s=n?EW(n.keyCode):!1,l;this.datePicker.style.display="block",this.$datePicker=new dI(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+o.top+Rt(this.TD),"px");var u=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?u=o.right-ut(this.datePicker):u=o.left,this.datePickerStyle.left="".concat(u,"px"),this.originalValue?(l=this.originalValue,J(l,i,!0).isValid()&&this.$datePicker.setMoment(J(l,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!a&&this.setValue("")):this.cellProperties.defaultDate?(l=this.cellProperties.defaultDate,J(l,i,!0).isValid()&&this.$datePicker.setMoment(J(l,i),!0),!s&&!a&&this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var n=this,o=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&cv(i,this.cellProperties.datePickerConfig);var a=i.onSelect,s=i.onClose;return i.field=o,i.trigger=o,i.container=this.datePicker,i.bound=!1,i.format=i.format||this.defaultDateFormat,i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=function(l){var u=l;isNaN(u.getTime())||(u=J(u).format(n.cellProperties.dateFormat||n.defaultDateFormat)),n.setValue(u),n.hideDatepicker(),a&&a()},i.onClose=function(){n.parentDestroyed||n.finishEditing(!1),s&&s()},i}}],[{key:"EDITOR_TYPE",get:function(){return N2}}]),r}(Za);function Vl(t){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vl(t)}function sOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uOe(n.key),n)}}function lOe(t,e,r){return e&&mI(t.prototype,e),r&&mI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uOe(t){var e=cOe(t,"string");return Vl(e)==="symbol"?e:String(e)}function cOe(t,e){if(Vl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Vl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function im(){return typeof Reflect<"u"&&Reflect.get?im=Reflect.get.bind():im=function(t,e,r){var n=fOe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},im.apply(this,arguments)}function fOe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Fl(t),t!==null););return t}function hOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZC(t,e)}function ZC(t,e){return ZC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ZC(t,e)}function dOe(t){var e=mOe();return function(){var r=Fl(t),n;if(e){var o=Fl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pOe(this,n)}}function pOe(t,e){if(e&&(Vl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yOe(t)}function yOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fl(t){return Fl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fl(t)}var gOe="dropdown",aT=function(t){hOe(r,t);var e=dOe(r);function r(){return sOe(this,r),e.apply(this,arguments)}return lOe(r,[{key:"prepare",value:function(n,o,i,a,s,l){im(Fl(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return gOe}}]),r}(iT);ye.getSingleton().add("beforeValidate",function(t,e,r){var n=this.getCellMeta(e,this.propToCol(r));n.editor===aT&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});function Wl(t){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wl(t)}function vOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wOe(n.key),n)}}function bOe(t,e,r){return e&&gI(t.prototype,e),r&&gI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wOe(t){var e=SOe(t,"string");return Wl(e)==="symbol"?e:String(e)}function SOe(t,e){if(Wl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function COe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&QC(t,e)}function QC(t,e){return QC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},QC(t,e)}function OOe(t){var e=EOe();return function(){var r=Rg(t),n;if(e){var o=Rg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kOe(this,n)}}function kOe(t,e){if(e&&(Wl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ROe(t)}function ROe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Rg(t){return Rg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rg(t)}var TOe="numeric",B2=function(t){COe(r,t);var e=OOe(r);function r(){return vOe(this,r),e.apply(this,arguments)}return bOe(r,null,[{key:"EDITOR_TYPE",get:function(){return TOe}}]),r}(Za);function Ul(t){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ul(t)}function POe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_Oe(n.key),n)}}function MOe(t,e,r){return e&&vI(t.prototype,e),r&&vI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _Oe(t){var e=xOe(t,"string");return Ul(e)==="symbol"?e:String(e)}function xOe(t,e){if(Ul(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ul(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function am(){return typeof Reflect<"u"&&Reflect.get?am=Reflect.get.bind():am=function(t,e,r){var n=AOe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},am.apply(this,arguments)}function AOe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=zl(t),t!==null););return t}function jOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&JC(t,e)}function JC(t,e){return JC=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},JC(t,e)}function IOe(t){var e=NOe();return function(){var r=zl(t),n;if(e){var o=zl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return HOe(this,n)}}function HOe(t,e){if(e&&(Ul(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return DOe(t)}function DOe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zl(t){return zl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zl(t)}var LOe="password",V2=function(t){jOe(r,t);var e=IOe(r);function r(){return POe(this,r),e.apply(this,arguments)}return MOe(r,[{key:"createElements",value:function(){am(zl(r.prototype),"createElements",this).call(this),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Nr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}],[{key:"EDITOR_TYPE",get:function(){return LOe}}]),r}(Za);function Na(t){"@babel/helpers - typeof";return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Na(t)}function BOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FOe(n.key),n)}}function VOe(t,e,r){return e&&bI(t.prototype,e),r&&bI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FOe(t){var e=WOe(t,"string");return Na(e)==="symbol"?e:String(e)}function WOe(t,e){if(Na(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Na(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sm(){return typeof Reflect<"u"&&Reflect.get?sm=Reflect.get.bind():sm=function(t,e,r){var n=UOe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},sm.apply(this,arguments)}function UOe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Yl(t),t!==null););return t}function zOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&e1(t,e)}function e1(t,e){return e1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},e1(t,e)}function YOe(t){var e=KOe();return function(){var r=Yl(t),n;if(e){var o=Yl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GOe(this,n)}}function GOe(t,e){if(e&&(Na(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Oe(t)}function $Oe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yl(t){return Yl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Yl(t)}var Vw="ht_editor_visible",wI="selectEditor",qOe="select",XOe=function(t){zOe(r,t);var e=YOe(r);function r(){return BOe(this,r),e.apply(this,arguments)}return VOe(r,[{key:"init",value:function(){this.select=this.hot.rootDocument.createElement("SELECT"),te(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}},{key:"getValue",value:function(){return this.select.value}},{key:"setValue",value:function(n){this.select.value=n}},{key:"open",value:function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";var n=this.hot.getShortcutManager();n.setActiveContextName("editor"),this.registerShortcuts()}},{key:"close",value:function(){this._opened=!1,this.select.style.display="none",Ae(this.select,Vw)&&Ne(this.select,Vw),this.unregisterShortcuts(),this.clearHooks()}},{key:"focus",value:function(){this.select.focus()}},{key:"registerHooks",value:function(){var n=this;this.addHook("afterScrollHorizontally",function(){return n.refreshDimensions()}),this.addHook("afterScrollVertically",function(){return n.refreshDimensions()}),this.addHook("afterColumnResize",function(){return n.refreshDimensions()}),this.addHook("afterRowResize",function(){return n.refreshDimensions()})}},{key:"prepare",value:function(n,o,i,a,s,l){var u=this;sm(Yl(r.prototype),"prepare",this).call(this,n,o,i,a,s,l);var c=this.cellProperties.selectOptions,f;typeof c=="function"?f=this.prepareOptions(c(this.row,this.col,this.prop)):f=this.prepareOptions(c),Nr(this.select),$e(f,function(h,p){var y=u.hot.rootDocument.createElement("OPTION");y.value=p,dc(y,h),u.select.appendChild(y)})}},{key:"prepareOptions",value:function(n){var o={};if(Array.isArray(n))for(var i=0,a=n.length;i<a;i++)o[n[i]]=n[i];else Na(n)==="object"&&(o=n);return o}},{key:"refreshValue",value:function(){var n=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=n,this.setValue(n),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){if(this.state===Zt.EDITING){if(this.TD=this.getEditedCell(),!this.TD){this.close();return}var n=this.getEditedCellRect(),o=n.top,i=n.start,a=n.width,s=n.height,l=this.select.style;l.height="".concat(s,"px"),l.width="".concat(a,"px"),l.top="".concat(o,"px"),l[this.hot.isRtl()?"right":"left"]="".concat(i,"px"),l.margin="0px",te(this.select,Vw)}}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("editor"),a={group:wI};this.isInFullEditMode()!==!1&&i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){var s=n.select.selectedIndex-1;s>=0&&(n.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:function(){var s=n.select.selectedIndex+1;s<=n.select.length-1&&(n.select[s].selected=!0)}}],a)}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("editor");o.removeShortcutsByGroup(wI)}}],[{key:"EDITOR_TYPE",get:function(){return qOe}}]),r}(gc);function Gl(t){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gl(t)}function ZOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,JOe(n.key),n)}}function QOe(t,e,r){return e&&SI(t.prototype,e),r&&SI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function JOe(t){var e=eke(t,"string");return Gl(e)==="symbol"?e:String(e)}function eke(t,e){if(Gl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(){return typeof Reflect<"u"&&Reflect.get?lm=Reflect.get.bind():lm=function(t,e,r){var n=tke(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},lm.apply(this,arguments)}function tke(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=$l(t),t!==null););return t}function nke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&t1(t,e)}function t1(t,e){return t1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},t1(t,e)}function rke(t){var e=ake();return function(){var r=$l(t),n;if(e){var o=$l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oke(this,n)}}function oke(t,e){if(e&&(Gl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ike(t)}function ike(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ake(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function $l(t){return $l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$l(t)}var ske="time",F2=function(t){nke(r,t);var e=rke(r);function r(){return ZOe(this,r),e.apply(this,arguments)}return QOe(r,[{key:"prepare",value:function(n,o,i,a,s,l){lm($l(r.prototype),"prepare",this).call(this,n,o,i,a,s,l),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return ske}}]),r}(Za);function lke(){Hn(gc),Hn(iT),Hn(H2),Hn(L2),Hn(aT),Hn(oT),Hn(B2),Hn(V2),Hn(XOe),Hn(Za),Hn(F2)}var uke="html";function sT(t,e,r,n,o,i,a){yp.apply(this,[t,e,r,n,o,i,a]),dc(e,i??"",!1)}sT.RENDERER_TYPE=uke;var cke="autocomplete";function vc(t,e,r,n,o,i,a){var s=t.rootDocument,l=a.allowHtml?sT:Pi,u=s.createElement("DIV");if(u.className="htAutocompleteArrow",u.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,r,n,o,i,a]),e.firstChild||e.appendChild(s.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),te(e,"htAutocomplete"),!t.acArrowListener){var c=new Tt(t);t.acArrowListener=function(f){Ae(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},c.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",function(){c.destroy()})}}vc.RENDERER_TYPE=cke;var CI=new WeakMap,OI=new WeakMap,fke="htBadValue",Kl="data-row",ql="data-col",hke="checkboxRenderer",W2="checkbox";ye.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){var n=e.label,o=e.type,i=e.row,a=e.column,s=e.prop;if(o===W2){if(n){var l=n.value,u=n.property,c=r;if(l)c=typeof l=="function"?l(i,a,s,r):l;else if(u){var f=this.getDataAtRowProp(i,u);c=f!==null?f:r}t=c}return t}});function lT(t,e,r,n,o,i,a){var s=t.rootDocument;yp.apply(this,[t,e,r,n,o,i,a]),dke(t);var l=pke(s),u=a.label,c=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),Nr(e),i===a.checkedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.checkedTemplate).toLocaleLowerCase(a.locale)?l.checked=!0:i===a.uncheckedTemplate||Dt(i).toLocaleLowerCase(a.locale)===Dt(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?l.checked=!1:Xt(i)?te(l,"noValue"):(l.style.display="none",te(l,fke),c=!0),l.setAttribute(Kl,r),l.setAttribute(ql,n),!c&&u){var f="";if(u.value)f=typeof u.value=="function"?u.value.call(this,r,n,o,i):u.value;else if(u.property){var h=t.getDataAtRowProp(r,u.property);f=h!==null?h:""}var p=yke(s,f,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(p),e.appendChild(l)):(p.appendChild(l),l=p):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(l),e.appendChild(p)):(p.insertBefore(l,p.firstChild),l=p))}(!u||u&&!u.separated)&&e.appendChild(l),c&&e.appendChild(s.createTextNode("#bad-value#")),CI.has(t)||(CI.set(t,!0),y());function y(){var S=t.getShortcutManager(),O=S.getContext("grid"),w={group:hke};O.addShortcuts([{keys:[["space"]],callback:function(){return g(),!v()}},{keys:[["enter"]],callback:function(){return g(),!v()},runOnlyIf:function(){return t.getSettings().enterBeginsEditing}},{keys:[["delete"],["backspace"]],callback:function(){return g(!0),!v()},relativeToGroup:hf,position:"before"}],w)}function g(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=t.getSelectedRange();if(O)for(var w=0;w<O.length;w++){for(var x=O[w].getTopStartCorner(),T=x.row,z=x.col,$=O[w].getBottomEndCorner(),ne=$.row,G=$.col,q=[],Z=T;Z<=ne;Z+=1)for(var ee=z;ee<=G;ee+=1){var Q=t.getCellMeta(Z,ee);if(Q.type!=="checkbox")return;if(Q.readOnly!==!0){typeof Q.checkedTemplate>"u"&&(Q.checkedTemplate=!0),typeof Q.uncheckedTemplate>"u"&&(Q.uncheckedTemplate=!1);var ce=t.getDataAtCell(Z,ee);S===!1?[Q.checkedTemplate,Q.checkedTemplate.toString()].includes(ce)?q.push([Z,ee,Q.uncheckedTemplate]):[Q.uncheckedTemplate,Q.uncheckedTemplate.toString(),null,void 0].includes(ce)&&q.push([Z,ee,Q.checkedTemplate]):q.push([Z,ee,Q.uncheckedTemplate])}}q.length>0&&t.setDataAtCell(q)}}function v(){var S=t.getSelectedRange();if(S){for(var O=0;O<S.length;O++)for(var w=S[O].getTopStartCorner(),x=S[O].getBottomEndCorner(),T=w.row;T<=x.row;T++)for(var z=w.col;z<=x.col;z++){var $=t.getCellMeta(T,z);if($.type!=="checkbox")return!1;var ne=t.getCell(T,z);if(ne==null)return!0;var G=ne.querySelectorAll("input[type=checkbox]");if(G.length>0&&!$.readOnly)return!0}return!1}}}lT.RENDERER_TYPE=W2;function dke(t){var e=OI.get(t);if(!e){var r=t.rootElement;e=new Tt(t),e.addEventListener(r,"click",function(n){return gke(n,t)}),e.addEventListener(r,"mouseup",function(n){return mke(n,t)}),e.addEventListener(r,"change",function(n){return vke(n,t)}),OI.set(t,e)}return e}function pke(t){var e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function yke(t,e,r){var n=t.createElement("label");return n.className="htCheckboxRendererLabel ".concat(r?"fullWidth":""),n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function mke(t,e){var r=t.target;uT(r)&&(!r.hasAttribute(Kl)||!r.hasAttribute(ql)||setTimeout(e.listen,10))}function gke(t,e){var r=t.target;if(uT(r)&&!(!r.hasAttribute(Kl)||!r.hasAttribute(ql))){var n=parseInt(r.getAttribute(Kl),10),o=parseInt(r.getAttribute(ql),10),i=e.getCellMeta(n,o);i.readOnly&&t.preventDefault()}}function vke(t,e){var r=t.target;if(uT(r)&&!(!r.hasAttribute(Kl)||!r.hasAttribute(ql))){var n=parseInt(r.getAttribute(Kl),10),o=parseInt(r.getAttribute(ql),10),i=e.getCellMeta(n,o);if(!i.readOnly){var a=null;t.target.checked?a=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:a=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,e.setDataAtCell(n,o,a)}}}function uT(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var U2={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,o,i){function a(u,c){if(!o[u]){if(!n[u]){var f=typeof Rp=="function"&&Rp;if(!c&&f)return f(u,!0);if(s)return s(u,!0);var h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h}var p=o[u]={exports:{}};n[u][0].call(p.exports,function(y){return a(n[u][1][y]||y)},p,p.exports,r,n,o,i)}return o[u].exports}for(var s=typeof Rp=="function"&&Rp,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(r,n,o){(function(i){var a,s=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",f=c+"Number primitive has more than 15 significant digits: ",h=1e14,p=14,y=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,S=1e9;function O(G){var q=0|G;return 0<G||G===q?q:q-1}function w(G){for(var q,Z,ee=1,Q=G.length,ce=G[0]+"";ee<Q;){for(q=G[ee++]+"",Z=p-q.length;Z--;q="0"+q);ce+=q}for(Q=ce.length;ce.charCodeAt(--Q)===48;);return ce.slice(0,Q+1||1)}function x(G,q){var Z,ee,Q=G.c,ce=q.c,fe=G.s,we=q.s,Se=G.e,P=q.e;if(!fe||!we)return null;if(Z=Q&&!Q[0],ee=ce&&!ce[0],Z||ee)return Z?ee?0:-we:fe;if(fe!=we)return fe;if(Z=fe<0,ee=Se==P,!Q||!ce)return ee?0:!Q^Z?1:-1;if(!ee)return P<Se^Z?1:-1;for(we=(Se=Q.length)<(P=ce.length)?Se:P,fe=0;fe<we;fe++)if(Q[fe]!=ce[fe])return Q[fe]>ce[fe]^Z?1:-1;return Se==P?0:P<Se^Z?1:-1}function T(G,q,Z,ee){if(G<q||Z<G||G!==(G<0?l(G):u(G)))throw Error(c+(ee||"Argument")+(typeof G=="number"?G<q||Z<G?" out of range: ":" not an integer: ":" not a primitive number: ")+String(G))}function z(G){var q=G.c.length-1;return O(G.e/p)==q&&G.c[q]%2!=0}function $(G,q){return(1<G.length?G.charAt(0)+"."+G.slice(1):G)+(q<0?"e":"e+")+q}function ne(G,q,Z){var ee,Q;if(q<0){for(Q=Z+".";++q;Q+=Z);G=Q+G}else if(++q>(ee=G.length)){for(Q=Z,q-=ee;--q;Q+=Z);G+=Q}else q<ee&&(G=G.slice(0,q)+"."+G.slice(q));return G}(a=function G(q){var Z,ee,Q,ce,fe,we,Se,P,d,m,b=Y.prototype={constructor:Y,toString:null,valueOf:null},k=new Y(1),E=20,A=4,W=-7,N=21,K=-1e7,X=1e7,re=!1,me=1,le=0,ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},be="0123456789abcdefghijklmnopqrstuvwxyz";function Y(C,R){var M,B,I,V,H,D,F,L,U=this;if(!(U instanceof Y))return new Y(C,R);if(R==null){if(C instanceof Y)return U.s=C.s,U.e=C.e,void(U.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(U.s=1/C<0?(C=-C,-1):1,C===~~C){for(V=0,H=C;10<=H;H/=10,V++);return U.e=V,void(U.c=[C])}L=String(C)}else{if(L=String(C),!s.test(L))return Q(U,L,D);U.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(V=L.indexOf("."))&&(L=L.replace(".","")),0<(H=L.search(/e/i))?(V<0&&(V=H),V+=+L.slice(H+1),L=L.substring(0,H)):V<0&&(V=L.length)}else{if(T(R,2,be.length,"Base"),L=String(C),R==10)return De(U=new Y(C instanceof Y?C:L),E+U.e+1,A);if(D=typeof C=="number"){if(0*C!=0)return Q(U,L,D,R);if(U.s=1/C<0?(L=L.slice(1),-1):1,Y.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(f+C);D=!1}else U.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(M=be.slice(0,R),V=H=0,F=L.length;H<F;H++)if(M.indexOf(B=L.charAt(H))<0){if(B=="."){if(V<H){V=F;continue}}else if(!I&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){I=!0,H=-1,V=0;continue}return Q(U,String(C),D,R)}-1<(V=(L=ee(L,R,10,U.s)).indexOf("."))?L=L.replace(".",""):V=L.length}for(H=0;L.charCodeAt(H)===48;H++);for(F=L.length;L.charCodeAt(--F)===48;);if(L=L.slice(H,++F)){if(F-=H,D&&Y.DEBUG&&15<F&&(y<C||C!==u(C)))throw Error(f+U.s*C);if(X<(V=V-H-1))U.c=U.e=null;else if(V<K)U.c=[U.e=0];else{if(U.e=V,U.c=[],H=(V+1)%p,V<0&&(H+=p),H<F){for(H&&U.c.push(+L.slice(0,H)),F-=p;H<F;)U.c.push(+L.slice(H,H+=p));L=L.slice(H),H=p-L.length}else H-=F;for(;H--;L+="0");U.c.push(+L)}}else U.c=[U.e=0]}function Le(C,R,M,B){var I,V,H,D,F;if(M==null?M=A:T(M,0,8),!C.c)return C.toString();if(I=C.c[0],H=C.e,R==null)F=w(C.c),F=B==1||B==2&&(H<=W||N<=H)?$(F,H):ne(F,H,"0");else if(V=(C=De(new Y(C),R,M)).e,D=(F=w(C.c)).length,B==1||B==2&&(R<=V||V<=W)){for(;D<R;F+="0",D++);F=$(F,V)}else if(R-=H,F=ne(F,V,"0"),D<V+1){if(0<--R)for(F+=".";R--;F+="0");}else if(0<(R+=V-D))for(V+1==D&&(F+=".");R--;F+="0");return C.s<0&&I?"-"+F:F}function He(C,R){for(var M,B=1,I=new Y(C[0]);B<C.length;B++){if(!(M=new Y(C[B])).s){I=M;break}R.call(I,M)&&(I=M)}return I}function Ee(C,R,M){for(var B=1,I=R.length;!R[--I];R.pop());for(I=R[0];10<=I;I/=10,B++);return(M=B+M*p-1)>X?C.c=C.e=null:C.c=M<K?[C.e=0]:(C.e=M,R),C}function De(C,R,M,B){var I,V,H,D,F,L,U,ie=C.c,ge=g;if(ie){e:{for(I=1,D=ie[0];10<=D;D/=10,I++);if((V=R-I)<0)V+=p,H=R,U=(F=ie[L=0])/ge[I-H-1]%10|0;else if((L=l((V+1)/p))>=ie.length){if(!B)break e;for(;ie.length<=L;ie.push(0));F=U=0,H=(V%=p)-p+(I=1)}else{for(F=D=ie[L],I=1;10<=D;D/=10,I++);U=(H=(V%=p)-p+I)<0?0:F/ge[I-H-1]%10|0}if(B=B||R<0||ie[L+1]!=null||(H<0?F:F%ge[I-H-1]),B=M<4?(U||B)&&(M==0||M==(C.s<0?3:2)):5<U||U==5&&(M==4||B||M==6&&(0<V?0<H?F/ge[I-H]:0:ie[L-1])%10&1||M==(C.s<0?8:7)),R<1||!ie[0])return ie.length=0,B?(R-=C.e+1,ie[0]=ge[(p-R%p)%p],C.e=-R||0):ie[0]=C.e=0,C;if(V==0?(ie.length=L,D=1,L--):(ie.length=L+1,D=ge[p-V],ie[L]=0<H?u(F/ge[I-H]%ge[H])*D:0),B)for(;;){if(L==0){for(V=1,H=ie[0];10<=H;H/=10,V++);for(H=ie[0]+=D,D=1;10<=H;H/=10,D++);V!=D&&(C.e++,ie[0]==h&&(ie[0]=1));break}if(ie[L]+=D,ie[L]!=h)break;ie[L--]=0,D=1}for(V=ie.length;ie[--V]===0;ie.pop());}C.e>X?C.c=C.e=null:C.e<K&&(C.c=[C.e=0])}return C}function Me(C){var R,M=C.e;return M===null?C.toString():(R=w(C.c),R=M<=W||N<=M?$(R,M):ne(R,M,"0"),C.s<0?"-"+R:R)}return Y.clone=G,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(C){var R,M;if(C!=null){if(typeof C!="object")throw Error(c+"Object expected: "+C);if(C.hasOwnProperty(R="DECIMAL_PLACES")&&(T(M=C[R],0,S,R),E=M),C.hasOwnProperty(R="ROUNDING_MODE")&&(T(M=C[R],0,8,R),A=M),C.hasOwnProperty(R="EXPONENTIAL_AT")&&((M=C[R])&&M.pop?(T(M[0],-S,0,R),T(M[1],0,S,R),W=M[0],N=M[1]):(T(M,-S,S,R),W=-(N=M<0?-M:M))),C.hasOwnProperty(R="RANGE"))if((M=C[R])&&M.pop)T(M[0],-S,-1,R),T(M[1],1,S,R),K=M[0],X=M[1];else{if(T(M,-S,S,R),!M)throw Error(c+R+" cannot be zero: "+M);K=-(X=M<0?-M:M)}if(C.hasOwnProperty(R="CRYPTO")){if((M=C[R])!==!!M)throw Error(c+R+" not true or false: "+M);if(M){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw re=!M,Error(c+"crypto unavailable");re=M}else re=M}if(C.hasOwnProperty(R="MODULO_MODE")&&(T(M=C[R],0,9,R),me=M),C.hasOwnProperty(R="POW_PRECISION")&&(T(M=C[R],0,S,R),le=M),C.hasOwnProperty(R="FORMAT")){if(typeof(M=C[R])!="object")throw Error(c+R+" not an object: "+M);ke=M}if(C.hasOwnProperty(R="ALPHABET")){if(typeof(M=C[R])!="string"||/^.$|[+-.\s]|(.).*\1/.test(M))throw Error(c+R+" invalid: "+M);be=M}}return{DECIMAL_PLACES:E,ROUNDING_MODE:A,EXPONENTIAL_AT:[W,N],RANGE:[K,X],CRYPTO:re,MODULO_MODE:me,POW_PRECISION:le,FORMAT:ke,ALPHABET:be}},Y.isBigNumber=function(C){return C instanceof Y||C&&C._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return He(arguments,b.lt)},Y.minimum=Y.min=function(){return He(arguments,b.gt)},Y.random=(ce=9007199254740992,fe=Math.random()*ce&2097151?function(){return u(Math.random()*ce)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var R,M,B,I,V,H=0,D=[],F=new Y(k);if(C==null?C=E:T(C,0,S),I=l(C/p),re)if(crypto.getRandomValues){for(R=crypto.getRandomValues(new Uint32Array(I*=2));H<I;)9e15<=(V=131072*R[H]+(R[H+1]>>>11))?(M=crypto.getRandomValues(new Uint32Array(2)),R[H]=M[0],R[H+1]=M[1]):(D.push(V%1e14),H+=2);H=I/2}else{if(!crypto.randomBytes)throw re=!1,Error(c+"crypto unavailable");for(R=crypto.randomBytes(I*=7);H<I;)9e15<=(V=281474976710656*(31&R[H])+1099511627776*R[H+1]+4294967296*R[H+2]+16777216*R[H+3]+(R[H+4]<<16)+(R[H+5]<<8)+R[H+6])?crypto.randomBytes(7).copy(R,H):(D.push(V%1e14),H+=7);H=I/7}if(!re)for(;H<I;)(V=fe())<9e15&&(D[H++]=V%1e14);for(I=D[--H],C%=p,I&&C&&(V=g[p-C],D[H]=u(I/V)*V);D[H]===0;D.pop(),H--);if(H<0)D=[B=0];else{for(B=-1;D[0]===0;D.splice(0,1),B-=p);for(H=1,V=D[0];10<=V;V/=10,H++);H<p&&(B-=p-H)}return F.e=B,F.c=D,F}),Y.sum=function(){for(var C=1,R=arguments,M=new Y(R[0]);C<R.length;)M=M.plus(R[C++]);return M},ee=function(){var C="0123456789";function R(M,B,I,V){for(var H,D,F=[0],L=0,U=M.length;L<U;){for(D=F.length;D--;F[D]*=B);for(F[0]+=V.indexOf(M.charAt(L++)),H=0;H<F.length;H++)F[H]>I-1&&(F[H+1]==null&&(F[H+1]=0),F[H+1]+=F[H]/I|0,F[H]%=I)}return F.reverse()}return function(M,B,I,V,H){var D,F,L,U,ie,ge,Re,xe,Ve=M.indexOf("."),qe=E,je=A;for(0<=Ve&&(U=le,le=0,M=M.replace(".",""),ge=(xe=new Y(B)).pow(M.length-Ve),le=U,xe.c=R(ne(w(ge.c),ge.e,"0"),10,I,C),xe.e=xe.c.length),L=U=(Re=R(M,B,I,H?(D=be,C):(D=C,be))).length;Re[--U]==0;Re.pop());if(!Re[0])return D.charAt(0);if(Ve<0?--L:(ge.c=Re,ge.e=L,ge.s=V,Re=(ge=Z(ge,xe,qe,je,I)).c,ie=ge.r,L=ge.e),Ve=Re[F=L+qe+1],U=I/2,ie=ie||F<0||Re[F+1]!=null,ie=je<4?(Ve!=null||ie)&&(je==0||je==(ge.s<0?3:2)):U<Ve||Ve==U&&(je==4||ie||je==6&&1&Re[F-1]||je==(ge.s<0?8:7)),F<1||!Re[0])M=ie?ne(D.charAt(1),-qe,D.charAt(0)):D.charAt(0);else{if(Re.length=F,ie)for(--I;++Re[--F]>I;)Re[F]=0,F||(++L,Re=[1].concat(Re));for(U=Re.length;!Re[--U];);for(Ve=0,M="";Ve<=U;M+=D.charAt(Re[Ve++]));M=ne(M,L,D.charAt(0))}return M}}(),Z=function(){function C(B,I,V){var H,D,F,L,U=0,ie=B.length,ge=I%v,Re=I/v|0;for(B=B.slice();ie--;)U=((D=ge*(F=B[ie]%v)+(H=Re*F+(L=B[ie]/v|0)*ge)%v*v+U)/V|0)+(H/v|0)+Re*L,B[ie]=D%V;return U&&(B=[U].concat(B)),B}function R(B,I,V,H){var D,F;if(V!=H)F=H<V?1:-1;else for(D=F=0;D<V;D++)if(B[D]!=I[D]){F=B[D]>I[D]?1:-1;break}return F}function M(B,I,V,H){for(var D=0;V--;)B[V]-=D,D=B[V]<I[V]?1:0,B[V]=D*H+B[V]-I[V];for(;!B[0]&&1<B.length;B.splice(0,1));}return function(B,I,V,H,D){var F,L,U,ie,ge,Re,xe,Ve,qe,je,Ie,Te,et,Mt,Ze,st,$t,gt=B.s==I.s?1:-1,Ct=B.c,tt=I.c;if(!(Ct&&Ct[0]&&tt&&tt[0]))return new Y(B.s&&I.s&&(Ct?!tt||Ct[0]!=tt[0]:tt)?Ct&&Ct[0]==0||!tt?0*gt:gt/0:NaN);for(qe=(Ve=new Y(gt)).c=[],gt=V+(L=B.e-I.e)+1,D||(D=h,L=O(B.e/p)-O(I.e/p),gt=gt/p|0),U=0;tt[U]==(Ct[U]||0);U++);if(tt[U]>(Ct[U]||0)&&L--,gt<0)qe.push(1),ie=!0;else{for(Mt=Ct.length,st=tt.length,gt+=2,1<(ge=u(D/(tt[U=0]+1)))&&(tt=C(tt,ge,D),Ct=C(Ct,ge,D),st=tt.length,Mt=Ct.length),et=st,Ie=(je=Ct.slice(0,st)).length;Ie<st;je[Ie++]=0);$t=tt.slice(),$t=[0].concat($t),Ze=tt[0],tt[1]>=D/2&&Ze++;do{if(ge=0,(F=R(tt,je,st,Ie))<0){if(Te=je[0],st!=Ie&&(Te=Te*D+(je[1]||0)),1<(ge=u(Te/Ze)))for(D<=ge&&(ge=D-1),xe=(Re=C(tt,ge,D)).length,Ie=je.length;R(Re,je,xe,Ie)==1;)ge--,M(Re,st<xe?$t:tt,xe,D),xe=Re.length,F=1;else ge==0&&(F=ge=1),xe=(Re=tt.slice()).length;if(xe<Ie&&(Re=[0].concat(Re)),M(je,Re,Ie,D),Ie=je.length,F==-1)for(;R(tt,je,st,Ie)<1;)ge++,M(je,st<Ie?$t:tt,Ie,D),Ie=je.length}else F===0&&(ge++,je=[0]);qe[U++]=ge,je[0]?je[Ie++]=Ct[et]||0:(je=[Ct[et]],Ie=1)}while((et++<Mt||je[0]!=null)&&gt--);ie=je[0]!=null,qe[0]||qe.splice(0,1)}if(D==h){for(U=1,gt=qe[0];10<=gt;gt/=10,U++);De(Ve,V+(Ve.e=U+L*p-1)+1,H,ie)}else Ve.e=L,Ve.r=+ie;return Ve}}(),we=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Se=/^([^.]+)\.$/,P=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,Q=function(C,R,M,B){var I,V=M?R:R.replace(m,"");if(d.test(V))C.s=isNaN(V)?null:V<0?-1:1,C.c=C.e=null;else{if(!M&&(V=V.replace(we,function(H,D,F){return I=(F=F.toLowerCase())=="x"?16:F=="b"?2:8,B&&B!=I?H:D}),B&&(I=B,V=V.replace(Se,"$1").replace(P,"0.$1")),R!=V))return new Y(V,I);if(Y.DEBUG)throw Error(c+"Not a"+(B?" base "+B:"")+" number: "+R);C.c=C.e=C.s=null}},b.absoluteValue=b.abs=function(){var C=new Y(this);return C.s<0&&(C.s=1),C},b.comparedTo=function(C,R){return x(this,new Y(C,R))},b.decimalPlaces=b.dp=function(C,R){var M,B,I;if(C!=null)return T(C,0,S),R==null?R=A:T(R,0,8),De(new Y(this),C+this.e+1,R);if(!(M=this.c))return null;if(B=((I=M.length-1)-O(this.e/p))*p,I=M[I])for(;I%10==0;I/=10,B--);return B<0&&(B=0),B},b.dividedBy=b.div=function(C,R){return Z(this,new Y(C,R),E,A)},b.dividedToIntegerBy=b.idiv=function(C,R){return Z(this,new Y(C,R),0,1)},b.exponentiatedBy=b.pow=function(C,R){var M,B,I,V,H,D,F,L,U=this;if((C=new Y(C)).c&&!C.isInteger())throw Error(c+"Exponent not an integer: "+Me(C));if(R!=null&&(R=new Y(R)),H=14<C.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return L=new Y(Math.pow(+Me(U),H?2-z(C):+Me(C))),R?L.mod(R):L;if(D=C.s<0,R){if(R.c?!R.c[0]:!R.s)return new Y(NaN);(B=!D&&U.isInteger()&&R.isInteger())&&(U=U.mod(R))}else{if(9<C.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||H&&24e7<=U.c[1]:U.c[0]<8e13||H&&U.c[0]<=9999975e7)))return V=U.s<0&&z(C)?-0:0,-1<U.e&&(V=1/V),new Y(D?1/V:V);le&&(V=l(le/p+2))}for(F=H?(M=new Y(.5),D&&(C.s=1),z(C)):(I=Math.abs(+Me(C)))%2,L=new Y(k);;){if(F){if(!(L=L.times(U)).c)break;V?L.c.length>V&&(L.c.length=V):B&&(L=L.mod(R))}if(I){if((I=u(I/2))===0)break;F=I%2}else if(De(C=C.times(M),C.e+1,1),14<C.e)F=z(C);else{if((I=+Me(C))==0)break;F=I%2}U=U.times(U),V?U.c&&U.c.length>V&&(U.c.length=V):B&&(U=U.mod(R))}return B?L:(D&&(L=k.div(L)),R?L.mod(R):V?De(L,le,A,void 0):L)},b.integerValue=function(C){var R=new Y(this);return C==null?C=A:T(C,0,8),De(R,R.e+1,C)},b.isEqualTo=b.eq=function(C,R){return x(this,new Y(C,R))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(C,R){return 0<x(this,new Y(C,R))},b.isGreaterThanOrEqualTo=b.gte=function(C,R){return(R=x(this,new Y(C,R)))===1||R===0},b.isInteger=function(){return!!this.c&&O(this.e/p)>this.c.length-2},b.isLessThan=b.lt=function(C,R){return x(this,new Y(C,R))<0},b.isLessThanOrEqualTo=b.lte=function(C,R){return(R=x(this,new Y(C,R)))===-1||R===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return 0<this.s},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(C,R){var M,B,I,V,H=this,D=H.s;if(R=(C=new Y(C,R)).s,!D||!R)return new Y(NaN);if(D!=R)return C.s=-R,H.plus(C);var F=H.e/p,L=C.e/p,U=H.c,ie=C.c;if(!F||!L){if(!U||!ie)return U?(C.s=-R,C):new Y(ie?H:NaN);if(!U[0]||!ie[0])return ie[0]?(C.s=-R,C):new Y(U[0]?H:A==3?-0:0)}if(F=O(F),L=O(L),U=U.slice(),D=F-L){for((I=(V=D<0)?(D=-D,U):(L=F,ie)).reverse(),R=D;R--;I.push(0));I.reverse()}else for(B=(V=(D=U.length)<(R=ie.length))?D:R,D=R=0;R<B;R++)if(U[R]!=ie[R]){V=U[R]<ie[R];break}if(V&&(I=U,U=ie,ie=I,C.s=-C.s),0<(R=(B=ie.length)-(M=U.length)))for(;R--;U[M++]=0);for(R=h-1;D<B;){if(U[--B]<ie[B]){for(M=B;M&&!U[--M];U[M]=R);--U[M],U[B]+=h}U[B]-=ie[B]}for(;U[0]==0;U.splice(0,1),--L);return U[0]?Ee(C,U,L):(C.s=A==3?-1:1,C.c=[C.e=0],C)},b.modulo=b.mod=function(C,R){var M,B,I=this;return C=new Y(C,R),!I.c||!C.s||C.c&&!C.c[0]?new Y(NaN):!C.c||I.c&&!I.c[0]?new Y(I):(me==9?(B=C.s,C.s=1,M=Z(I,C,0,3),C.s=B,M.s*=B):M=Z(I,C,0,me),(C=I.minus(M.times(C))).c[0]||me!=1||(C.s=I.s),C)},b.multipliedBy=b.times=function(C,R){var M,B,I,V,H,D,F,L,U,ie,ge,Re,xe,Ve,qe,je=this,Ie=je.c,Te=(C=new Y(C,R)).c;if(!(Ie&&Te&&Ie[0]&&Te[0]))return!je.s||!C.s||Ie&&!Ie[0]&&!Te||Te&&!Te[0]&&!Ie?C.c=C.e=C.s=null:(C.s*=je.s,Ie&&Te?(C.c=[0],C.e=0):C.c=C.e=null),C;for(B=O(je.e/p)+O(C.e/p),C.s*=je.s,(F=Ie.length)<(ie=Te.length)&&(xe=Ie,Ie=Te,Te=xe,I=F,F=ie,ie=I),I=F+ie,xe=[];I--;xe.push(0));for(Ve=h,qe=v,I=ie;0<=--I;){for(M=0,ge=Te[I]%qe,Re=Te[I]/qe|0,V=I+(H=F);I<V;)M=((L=ge*(L=Ie[--H]%qe)+(D=Re*L+(U=Ie[H]/qe|0)*ge)%qe*qe+xe[V]+M)/Ve|0)+(D/qe|0)+Re*U,xe[V--]=L%Ve;xe[V]=M}return M?++B:xe.splice(0,1),Ee(C,xe,B)},b.negated=function(){var C=new Y(this);return C.s=-C.s||null,C},b.plus=function(C,R){var M,B=this,I=B.s;if(R=(C=new Y(C,R)).s,!I||!R)return new Y(NaN);if(I!=R)return C.s=-R,B.minus(C);var V=B.e/p,H=C.e/p,D=B.c,F=C.c;if(!V||!H){if(!D||!F)return new Y(I/0);if(!D[0]||!F[0])return F[0]?C:new Y(D[0]?B:0*I)}if(V=O(V),H=O(H),D=D.slice(),I=V-H){for((M=0<I?(H=V,F):(I=-I,D)).reverse();I--;M.push(0));M.reverse()}for((I=D.length)-(R=F.length)<0&&(M=F,F=D,D=M,R=I),I=0;R;)I=(D[--R]=D[R]+F[R]+I)/h|0,D[R]=h===D[R]?0:D[R]%h;return I&&(D=[I].concat(D),++H),Ee(C,D,H)},b.precision=b.sd=function(C,R){var M,B,I;if(C!=null&&C!==!!C)return T(C,1,S),R==null?R=A:T(R,0,8),De(new Y(this),C,R);if(!(M=this.c))return null;if(B=(I=M.length-1)*p+1,I=M[I]){for(;I%10==0;I/=10,B--);for(I=M[0];10<=I;I/=10,B++);}return C&&this.e+1>B&&(B=this.e+1),B},b.shiftedBy=function(C){return T(C,-y,y),this.times("1e"+C)},b.squareRoot=b.sqrt=function(){var C,R,M,B,I,V=this,H=V.c,D=V.s,F=V.e,L=E+4,U=new Y("0.5");if(D!==1||!H||!H[0])return new Y(!D||D<0&&(!H||H[0])?NaN:H?V:1/0);if((M=(D=Math.sqrt(+Me(V)))==0||D==1/0?(((R=w(H)).length+F)%2==0&&(R+="0"),D=Math.sqrt(+R),F=O((F+1)/2)-(F<0||F%2),new Y(R=D==1/0?"1e"+F:(R=D.toExponential()).slice(0,R.indexOf("e")+1)+F)):new Y(D+"")).c[0]){for((D=(F=M.e)+L)<3&&(D=0);;)if(I=M,M=U.times(I.plus(Z(V,I,L,1))),w(I.c).slice(0,D)===(R=w(M.c)).slice(0,D)){if(M.e<F&&--D,(R=R.slice(D-3,D+1))!="9999"&&(B||R!="4999")){+R&&(+R.slice(1)||R.charAt(0)!="5")||(De(M,M.e+E+2,1),C=!M.times(M).eq(V));break}if(!B&&(De(I,I.e+E+2,0),I.times(I).eq(V))){M=I;break}L+=4,D+=4,B=1}}return De(M,M.e+E+1,A,C)},b.toExponential=function(C,R){return C!=null&&(T(C,0,S),C++),Le(this,C,R,1)},b.toFixed=function(C,R){return C!=null&&(T(C,0,S),C=C+this.e+1),Le(this,C,R)},b.toFormat=function(C,R,M){var B;if(M==null)C!=null&&R&&typeof R=="object"?(M=R,R=null):C&&typeof C=="object"?(M=C,C=R=null):M=ke;else if(typeof M!="object")throw Error(c+"Argument not an object: "+M);if(B=this.toFixed(C,R),this.c){var I,V=B.split("."),H=+M.groupSize,D=+M.secondaryGroupSize,F=M.groupSeparator||"",L=V[0],U=V[1],ie=this.s<0,ge=ie?L.slice(1):L,Re=ge.length;if(D&&(I=H,H=D,Re-=D=I),0<H&&0<Re){for(I=Re%H||H,L=ge.substr(0,I);I<Re;I+=H)L+=F+ge.substr(I,H);0<D&&(L+=F+ge.slice(I)),ie&&(L="-"+L)}B=U?L+(M.decimalSeparator||"")+((D=+M.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(M.fractionGroupSeparator||"")):U):L}return(M.prefix||"")+B+(M.suffix||"")},b.toFraction=function(C){var R,M,B,I,V,H,D,F,L,U,ie,ge,Re=this,xe=Re.c;if(C!=null&&(!(D=new Y(C)).isInteger()&&(D.c||D.s!==1)||D.lt(k)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Me(D));if(!xe)return new Y(Re);for(R=new Y(k),L=M=new Y(k),B=F=new Y(k),ge=w(xe),V=R.e=ge.length-Re.e-1,R.c[0]=g[(H=V%p)<0?p+H:H],C=!C||0<D.comparedTo(R)?0<V?R:L:D,H=X,X=1/0,D=new Y(ge),F.c[0]=0;U=Z(D,R,0,1),(I=M.plus(U.times(B))).comparedTo(C)!=1;)M=B,B=I,L=F.plus(U.times(I=L)),F=I,R=D.minus(U.times(I=R)),D=I;return I=Z(C.minus(M),B,0,1),F=F.plus(I.times(L)),M=M.plus(I.times(B)),F.s=L.s=Re.s,ie=Z(L,B,V*=2,A).minus(Re).abs().comparedTo(Z(F,M,V,A).minus(Re).abs())<1?[L,B]:[F,M],X=H,ie},b.toNumber=function(){return+Me(this)},b.toPrecision=function(C,R){return C!=null&&T(C,1,S),Le(this,C,R,2)},b.toString=function(C){var R,M=this,B=M.s,I=M.e;return I===null?B?(R="Infinity",B<0&&(R="-"+R)):R="NaN":(R=C==null?I<=W||N<=I?$(w(M.c),I):ne(w(M.c),I,"0"):C===10?ne(w((M=De(new Y(M),E+I+1,A)).c),M.e,"0"):(T(C,2,be.length,"Base"),ee(ne(w(M.c),I,"0"),10,C,B,!0)),B<0&&M.c[0]&&(R="-"+R)),R},b.valueOf=b.toJSON=function(){return Me(this)},b._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(b[Symbol.toStringTag]="BigNumber",b[Symbol.for("nodejs.util.inspect.custom")]=b.valueOf),q!=null&&Y.set(q),Y}()).default=a.BigNumber=a,n!==void 0&&n.exports?n.exports=a:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=a)})(this)},{}],2:[function(r,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var a=i%10;return~~(i%100/10)==1?"th":a===1?"st":a===2?"nd":a===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,o){function i(O,w){return function(x){if(Array.isArray(x))return x}(O)||function(x,T){var z=[],$=!0,ne=!1,G=void 0;try{for(var q,Z=x[Symbol.iterator]();!($=(q=Z.next()).done)&&(z.push(q.value),!T||z.length!==T);$=!0);}catch(ee){ne=!0,G=ee}finally{try{$||Z.return==null||Z.return()}finally{if(ne)throw G}}return z}(O,w)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a=r("./globalState"),s=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},f={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function h(O){var w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof w=="string"&&(w=l.parseFormat(w)),!s.validateFormat(w))return"ERROR: invalid format";var T=w.prefix||"",z=w.postfix||"",$=function(ne,G,q){switch(G.output){case"currency":return G=S(G,a.currentCurrencyDefaultFormat()),function(be,Y,Le){var He=Le.currentCurrency(),Ee=Object.assign({},f,Y),De=void 0,Me="",C=!!Ee.totalLength||!!Ee.forceAverage||Ee.average,R=Y.currencyPosition||He.position,M=Y.currencySymbol||He.symbol;Ee.spaceSeparated&&(Me=" "),R==="infix"&&(De=Me+M+Me);var B=v({instance:be,providedFormat:Y,state:Le,decimalSeparator:De});return R==="prefix"&&(B=be._value<0&&Ee.negative==="sign"?"-".concat(Me).concat(M).concat(B.slice(1)):M+Me+B),R&&R!=="postfix"||(B=B+(Me=C?"":Me)+M),B}(ne,G,a);case"percent":return G=S(G,a.currentPercentageDefaultFormat()),function(be,Y,Le,He){var Ee=Y.prefixSymbol,De=v({instance:He(100*be._value),providedFormat:Y,state:Le}),Me=Object.assign({},f,Y);return Ee?"%".concat(Me.spaceSeparated?" ":"").concat(De):"".concat(De).concat(Me.spaceSeparated?" ":"","%")}(ne,G,a,q);case"byte":return G=S(G,a.currentByteDefaultFormat()),k=ne,A=a,W=q,N=(E=G).base||"binary",K=c[N],X=p(k._value,K.suffixes,K.scale),re=X.value,me=X.suffix,le=v({instance:W(re),providedFormat:E,state:A,defaults:A.currentByteDefaultFormat()}),ke=A.currentAbbreviations(),"".concat(le).concat(ke.spaced?" ":"").concat(me);case"time":return G=S(G,a.currentTimeDefaultFormat()),P=ne,d=Math.floor(P._value/60/60),m=Math.floor((P._value-60*d*60)/60),b=Math.round(P._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(b<10?"0":"").concat(b);case"ordinal":return G=S(G,a.currentOrdinalDefaultFormat()),Z=ne,ee=G,ce=(Q=a).currentOrdinal(),fe=Object.assign({},f,ee),we=v({instance:Z,providedFormat:ee,state:Q}),Se=ce(Z._value),"".concat(we).concat(fe.spaceSeparated?" ":"").concat(Se);case"number":default:return v({instance:ne,providedFormat:G,numbro:q})}var Z,ee,Q,ce,fe,we,Se,P,d,m,b,k,E,A,W,N,K,X,re,me,le,ke}(O,w,x);return $=($=T+$)+z}function p(O,w,x){var T=w[0],z=Math.abs(O);if(x<=z){for(var $=1;$<w.length;++$){var ne=Math.pow(x,$),G=Math.pow(x,$+1);if(ne<=z&&z<G){T=w[$],O/=ne;break}}T===w[0]&&(O/=Math.pow(x,w.length-1),T=w[w.length-1])}return{value:O,suffix:T}}function y(O){for(var w="",x=0;x<O;x++)w+="0";return w}function g(O,w){return O.toString().indexOf("e")!==-1?function(x,T){var z=x.toString(),$=i(z.split("e"),2),ne=$[0],G=$[1],q=i(ne.split("."),2),Z=q[0],ee=q[1],Q=ee===void 0?"":ee;if(0<+G)z=Z+Q+y(G-Q.length);else{var ce=".";ce=+Z<0?"-0".concat(ce):"0".concat(ce);var fe=(y(-G-1)+Math.abs(Z)+Q).substr(0,T);fe.length<T&&(fe+=y(T-fe.length)),z=ce+fe}return 0<+G&&0<T&&(z+=".".concat(y(T))),z}(O,w):(Math.round(+"".concat(O,"e+").concat(w))/Math.pow(10,w)).toFixed(w)}function v(O){var w=O.instance,x=O.providedFormat,T=O.state,z=T===void 0?a:T,$=O.decimalSeparator,ne=O.defaults,G=ne===void 0?z.currentDefaults():ne,q=w._value;if(q===0&&z.hasZeroFormat())return z.getZeroFormat();if(!isFinite(q))return q.toString();var Z,ee,Q,ce,fe,we,Se,P,d=Object.assign({},f,G,x),m=d.totalLength,b=m?0:d.characteristic,k=d.optionalCharacteristic,E=d.forceAverage,A=!!m||!!E||d.average,W=m?-1:A&&x.mantissa===void 0?0:d.mantissa,N=!m&&(x.optionalMantissa===void 0?W===-1:d.optionalMantissa),K=d.trimMantissa,X=d.thousandSeparated,re=d.spaceSeparated,me=d.negative,le=d.forceSign,ke=d.exponential,be="";if(A){var Y=function(C){var R=C.value,M=C.forceAverage,B=C.abbreviations,I=C.spaceSeparated,V=I!==void 0&&I,H=C.totalLength,D=H===void 0?0:H,F="",L=Math.abs(R),U=-1;if(L>=Math.pow(10,12)&&!M||M==="trillion"?(F=B.trillion,R/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!M||M==="billion"?(F=B.billion,R/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!M||M==="million"?(F=B.million,R/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!M||M==="thousand")&&(F=B.thousand,R/=Math.pow(10,3)),F&&(F=(V?" ":"")+F),D){var ie=R.toString().split(".")[0];U=Math.max(D-ie.length,0)}return{value:R,abbreviation:F,mantissaPrecision:U}}({value:q,forceAverage:E,abbreviations:z.currentAbbreviations(),spaceSeparated:re,totalLength:m});q=Y.value,be+=Y.abbreviation,m&&(W=Y.mantissaPrecision)}if(ke){var Le=(ee=(Z={value:q,characteristicPrecision:b}).value,Q=Z.characteristicPrecision,ce=Q===void 0?0:Q,fe=i(ee.toExponential().split("e"),2),we=fe[0],Se=fe[1],P=+we,ce&&1<ce&&(P*=Math.pow(10,ce-1),Se=0<=(Se=+Se-(ce-1))?"+".concat(Se):Se),{value:P,abbreviation:"e".concat(Se)});q=Le.value,be=Le.abbreviation+be}var He,Ee,De,Me=function(C,R,M,B,I){if(B===-1)return C;var V=g(R,B),H=i(V.toString().split("."),2),D=H[0],F=H[1],L=F===void 0?"":F;if(L.match(/^0+$/)&&(M||I))return D;var U=L.match(/0+$/);return I&&U?"".concat(D,".").concat(L.toString().slice(0,U.index)):V.toString()}(q.toString(),q,N,W,K);return Me=function(C,R,M,B,I){var V=B.currentDelimiters(),H=V.thousands;I=I||V.decimal;var D=V.thousandsSize||3,F=C.toString(),L=F.split(".")[0],U=F.split(".")[1];return M&&(R<0&&(L=L.slice(1)),function(ie,ge){for(var Re=[],xe=0,Ve=ie;0<Ve;Ve--)xe===ge&&(Re.unshift(Ve),xe=0),xe++;return Re}(L.length,D).forEach(function(ie,ge){L=L.slice(0,ie+ge)+H+L.slice(ie+ge)}),R<0&&(L="-".concat(L))),F=U?L+I+U:L}(Me=function(C,R,M,B){var I=C,V=i(I.toString().split("."),2),H=V[0],D=V[1];if(H.match(/^-?0$/)&&M)return D?"".concat(H.replace("0",""),".").concat(D):H.replace("0","");if(H.length<B)for(var F=B-H.length,L=0;L<F;L++)I="0".concat(I);return I.toString()}(Me,0,k,b),q,X,z,$),(A||ke)&&(Me=Me+be),(le||q<0)&&(He=Me,De=me,Me=(Ee=q)===0?He:+He==0?He.replace("-",""):0<Ee?"+".concat(He):De==="sign"?He:"(".concat(He.replace("-",""),")")),Me}function S(O,w){if(!O)return w;var x=Object.keys(O);return x.length===1&&x[0]==="output"?w:O}n.exports=function(O){return{format:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return h.apply(void 0,x.concat([O]))},getByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return function(z){var $=c.general;return p(z._value,$.suffixes,$.scale).suffix}.apply(void 0,x.concat([O]))},getBinaryByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return function(z){var $=c.binary;return p(z._value,$.suffixes,$.scale).suffix}.apply(void 0,x.concat([O]))},getDecimalByteUnit:function(){for(var w=arguments.length,x=new Array(w),T=0;T<w;T++)x[T]=arguments[T];return function(z){var $=c.decimal;return p(z._value,$.suffixes,$.scale).suffix}.apply(void 0,x.concat([O]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,o){var i=r("./en-US"),a=r("./validating"),s=r("./parsing"),l={},u=void 0,c={},f=null,h={};function p(g){u=g}function y(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return y().currency},l.currentAbbreviations=function(){return y().abbreviations},l.currentDelimiters=function(){return y().delimiters},l.currentOrdinal=function(){return y().ordinal},l.currentDefaults=function(){return Object.assign({},y().defaults,h)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),y().timeFormat)},l.setDefaults=function(g){g=s.parseFormat(g),a.validateFormat(g)&&(h=g)},l.getZeroFormat=function(){return f},l.setZeroFormat=function(g){return f=typeof g=="string"?g:null},l.hasZeroFormat=function(){return f!==null},l.languageData=function(g){if(g){if(c[g])return c[g];throw new Error('Unknown tag "'.concat(g,'"'))}return y()},l.registerLanguage=function(g){var v=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!a.validateLanguage(g))throw new Error("Invalid language data");c[g.languageTag]=g,v&&p(g.languageTag)},l.setLanguage=function(g){var v=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[g]){var S=g.split("-")[0],O=Object.keys(c).find(function(w){return w.split("-")[0]===S});return c[O]?void p(O):void p(v)}p(g)},l.registerLanguage(i),u=i.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,o){n.exports=function(i){return{loadLanguagesInNode:function(a){return s=i,void a.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&s.registerLanguage(u)});var s}}}},{}],6:[function(r,n,o){var i=r("bignumber.js");function a(s,l,u){var c=new i(s._value),f=l;return u.isNumbro(l)&&(f=l._value),f=new i(f),s._value=c.minus(f).toNumber(),s}n.exports=function(s){return{add:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.plus(y).toNumber(),c;var c,f,h,p,y},subtract:function(l,u){return a(l,u,s)},multiply:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.times(y).toNumber(),c;var c,f,h,p,y},divide:function(l,u){return f=u,h=s,p=new i((c=l)._value),y=f,h.isNumbro(f)&&(y=f._value),y=new i(y),c._value=p.dividedBy(y).toNumber(),c;var c,f,h,p,y},set:function(l,u){return c=l,h=f=u,s.isNumbro(f)&&(h=f._value),c._value=h,c;var c,f,h},difference:function(l,u){return c=u,a(h=(f=s)(l._value),c,f),Math.abs(h._value);var c,f,h}}}},{"bignumber.js":1}],7:[function(r,n,o){function i(v,S){for(var O=0;O<S.length;O++){var w=S[O];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}var a=r("./globalState"),s=r("./validating"),l=r("./loading")(g),u=r("./unformatting"),c=r("./formatting")(g),f=r("./manipulating")(g),h=r("./parsing"),p=function(){function v(w){(function(x,T){if(!(x instanceof T))throw new TypeError("Cannot call a class as a function")})(this,v),this._value=w}var S,O;return S=v,(O=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var w=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,w)}},{key:"formatCurrency",value:function(w){return typeof w=="string"&&(w=h.parseFormat(w)),(w=c.formatOrDefault(w,a.currentCurrencyDefaultFormat())).output="currency",c.format(this,w)}},{key:"formatTime",value:function(){var w=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return w.output="time",c.format(this,w)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(w){return f.difference(this,w)}},{key:"add",value:function(w){return f.add(this,w)}},{key:"subtract",value:function(w){return f.subtract(this,w)}},{key:"multiply",value:function(w){return f.multiply(this,w)}},{key:"divide",value:function(w){return f.divide(this,w)}},{key:"set",value:function(w){return f.set(this,y(w))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(S.prototype,O),v}();function y(v){var S=v;return g.isNumbro(v)?S=v._value:typeof v=="string"?S=g.unformat(v):isNaN(v)&&(S=NaN),S}function g(v){return new p(y(v))}g.version="2.1.2",g.isNumbro=function(v){return v instanceof p},g.language=a.currentLanguage,g.registerLanguage=a.registerLanguage,g.setLanguage=a.setLanguage,g.languages=a.languages,g.languageData=a.languageData,g.zeroFormat=a.setZeroFormat,g.defaultFormat=a.currentDefaults,g.setDefaults=a.setDefaults,g.defaultCurrencyFormat=a.currentCurrencyDefaultFormat,g.validate=s.validate,g.loadLanguagesInNode=l.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,o){n.exports={parseFormat:function(i){var a,s,l,u,c,f,h,p,y,g,v,S,O,w,x,T,z,$,ne,G,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(s=q,i=(l=(a=i).match(/^{([^}]*)}/))?(s.prefix=l[1],a.slice(l[0].length)):a,c=q,function(Z,ee){if(Z.indexOf("$")===-1){if(Z.indexOf("%")===-1)return Z.indexOf("bd")!==-1?(ee.output="byte",ee.base="general"):Z.indexOf("b")!==-1?(ee.output="byte",ee.base="binary"):Z.indexOf("d")!==-1?(ee.output="byte",ee.base="decimal"):Z.indexOf(":")===-1?Z.indexOf("o")!==-1&&(ee.output="ordinal"):ee.output="time";ee.output="percent"}else ee.output="currency"}(i=(f=(u=i).match(/{([^}]*)}$/))?(c.postfix=f[1],u.slice(0,-f[0].length)):u,q),h=q,(p=i.match(/[1-9]+[0-9]*/))&&(h.totalLength=+p[0]),y=q,(g=i.split(".")[0].match(/0+/))&&(y.characteristic=g[0].length),function(Z,ee){if(Z.indexOf(".")!==-1){var Q=Z.split(".")[0];ee.optionalCharacteristic=Q.indexOf("0")===-1}}(i,q),v=q,i.indexOf("a")!==-1&&(v.average=!0),O=q,(S=i).indexOf("K")!==-1?O.forceAverage="thousand":S.indexOf("M")!==-1?O.forceAverage="million":S.indexOf("B")!==-1?O.forceAverage="billion":S.indexOf("T")!==-1&&(O.forceAverage="trillion"),function(Z,ee){var Q=Z.split(".")[1];if(Q){var ce=Q.match(/0+/);ce&&(ee.mantissa=ce[0].length)}}(i,q),x=q,(w=i).match(/\[\.]/)?x.optionalMantissa=!0:w.match(/\./)&&(x.optionalMantissa=!1),T=q,i.indexOf(",")!==-1&&(T.thousandSeparated=!0),z=q,i.indexOf(" ")!==-1&&(z.spaceSeparated=!0),ne=q,($=i).match(/^\+?\([^)]*\)$/)&&(ne.negative="parenthesis"),$.match(/^\+?-/)&&(ne.negative="sign"),G=q,i.match(/^\+/)&&(G.forceSign=!0),q)}}},{}],9:[function(r,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function a(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",f=3<arguments.length?arguments[3]:void 0,h=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,y=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===h?0:function g(v,S){var O=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,T=5<arguments.length?arguments[5]:void 0,z=6<arguments.length?arguments[6]:void 0;if(!isNaN(+v))return+v;var $="",ne=v.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ne!==v)return-1*g(ne,S,O,w,x,T,z);for(var G=0;G<i.length;G++){var q=i[G];if(($=v.replace(q.key,""))!==v)return g($,S,O,w,x,T,z)*q.factor}if(($=v.replace("%",""))!==v)return g($,S,O,w,x,T,z)/100;var Z=parseFloat(v);if(!isNaN(Z)){var ee=w(Z);if(ee&&ee!=="."&&($=v.replace(new RegExp("".concat(a(ee),"$")),""))!==v)return g($,S,O,w,x,T,z);var Q={};Object.keys(T).forEach(function(m){Q[T[m]]=m});for(var ce=Object.keys(Q).sort().reverse(),fe=ce.length,we=0;we<fe;we++){var Se=ce[we],P=Q[Se];if(($=v.replace(Se,""))!==v){var d=void 0;switch(P){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return g($,S,O,w,x,T,z)*d}}}}(function(g,v){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",O=g.replace(S,"");return O=(O=O.replace(new RegExp("([0-9])".concat(a(v.thousands),"([0-9])"),"g"),"$1$2")).replace(v.decimal,".")}(l,u,c),u,c,f,h,p,y)}n.exports={unformat:function(l,u){var c,f,h,p=r("./globalState"),y=p.currentDelimiters(),g=p.currentCurrency().symbol,v=p.currentOrdinal(),S=p.getZeroFormat(),O=p.currentAbbreviations(),w=void 0;if(typeof l=="string")w=function(x,T){if(!x.indexOf(":")||T.thousands===":")return!1;var z=x.split(":");if(z.length!==3)return!1;var $=+z[0],ne=+z[1],G=+z[2];return!isNaN($)&&!isNaN(ne)&&!isNaN(G)}(l,y)?(c=l.split(":"),f=+c[0],h=+c[1],+c[2]+60*h+3600*f):s(l,y,g,v,S,O,u);else{if(typeof l!="number")return;w=l}if(w!==void 0)return w}}},{"./globalState":4}],10:[function(r,n,o){function i(y){return function(g){if(Array.isArray(g)){for(var v=0,S=new Array(g.length);v<g.length;v++)S[v]=g[v];return S}}(y)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(y)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(y){return(a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(y)}var s=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(y,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(y){return y.output==="byte"}},characteristic:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(y){return 0<=y},message:"value must be positive"},{restriction:function(y,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(y){return 0<=y},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(y,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(y){return y.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function f(y){return!!s.unformat(y)}function h(y,g,v){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],O=Object.keys(y).map(function(w){if(!g[w])return console.error("".concat(v," Invalid key: ").concat(w)),!1;var x=y[w],T=g[w];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!h(x,u,"[Validate ".concat(w,"]"),!0))return!1}else if(a(x)!==T.type)return console.error("".concat(v," ").concat(w,' type mismatched: "').concat(T.type,'" expected, "').concat(a(x),'" provided')),!1;if(T.restrictions&&T.restrictions.length)for(var z=T.restrictions.length,$=0;$<z;$++){var ne=T.restrictions[$],G=ne.restriction,q=ne.message;if(!G(x,y))return console.error("".concat(v," ").concat(w," invalid value: ").concat(q)),!1}return T.restriction&&!T.restriction(x,y)?(console.error("".concat(v," ").concat(w," invalid value: ").concat(T.message)),!1):T.validValues&&T.validValues.indexOf(x)===-1?(console.error("".concat(v," ").concat(w," invalid value: must be among ").concat(JSON.stringify(T.validValues),', "').concat(x,'" provided')),!1):!(T.children&&!h(x,T.children,"[Validate ".concat(w,"]")))});return S||O.push.apply(O,i(Object.keys(g).map(function(w){var x=g[w];if(typeof x=="string"&&(x={type:x}),x.mandatory){var T=x.mandatory;if(typeof T=="function"&&(T=T(y)),T&&y[w]===void 0)return console.error("".concat(v,' Missing mandatory key "').concat(w,'"')),!1}return!0}))),O.reduce(function(w,x){return w&&x},!0)}function p(y){return h(y,u,"[Validate format]")}n.exports={validate:function(y,g){var v=f(y),S=p(g);return v&&S},validateFormat:p,validateInput:f,validateLanguage:function(y){return h(y,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(U2);var bke=U2.exports;const Ni=$L(bke);var wke="numeric";function cT(t,e,r,n,o,i,a){var s=i;if(kn(s)){var l=a.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,f=a.className||"",h=f.length?f.split(" "):[];if(typeof u<"u"&&!Ni.languages()[u]){var p=u.replace("-",""),y=Ni.allLanguages?Ni.allLanguages[u]:Ni[p];y&&Ni.registerLanguage(y)}Ni.setLanguage(u),s=Ni(s).format(c||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),a.className=h.join(" "),e.dir="ltr"}Pi(t,e,r,n,o,s,a)}cT.RENDERER_TYPE=wke;var Ske="password";function fT(t,e,r,n,o,i,a){Pi.apply(this,[t,e,r,n,o,i,a]);var s=a.hashLength||e.innerHTML.length,l=a.hashSymbol||"*",u="";Oe(s-1,function(){u+=l}),dc(e,u)}fT.RENDERER_TYPE=Ske;var Cke="time";function hT(t,e,r,n,o,i,a){Pi.apply(this,[t,e,r,n,o,i,a]),e.dir="ltr"}hT.RENDERER_TYPE=Cke;function Oke(){eo(vc),eo(yp),eo(lT),eo(sT),eo(cT),eo(fT),eo(Pi),eo(hT)}var kke="autocomplete";function $v(t,e){var r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,kI(r,e)):kI(r,e)(this.source):e(!0)}$v.VALIDATOR_TYPE=kke;function kI(t,e){var r=t;return function(n){for(var o=!1,i=0,a=n.length;i<a;i++)if(r===n[i]){o=!0;break}e(o)}}var Rke=Object.is||function(t,e){return t===e?t!==0||1/t===1/e:t!=t&&e!=e},Eke=Gt,Tke=sv,Pke=At,Mke=mr,_ke=En,RI=Rke,EI=Bt,xke=Ua,Ake=lv;Tke("search",function(t,e,r){return[function(n){var o=_ke(this),i=Mke(n)?void 0:xke(n,t);return i?Eke(i,n,o):new RegExp(n)[t](EI(o))},function(n){var o=Pke(this),i=EI(n),a=r(e,o,i);if(a.done)return a.value;var s=o.lastIndex;RI(s,0)||(o.lastIndex=0);var l=Ake(o,i);return RI(o.lastIndex,s)||(o.lastIndex=s),l===null?-1:l.index}]});function jke(t){var e=new Date(t);return isNaN(new Date("".concat(t,"T00:00")).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var Ike="date";function dT(t,e){var r=_W(N2,this.instance),n=t,o=!0;n==null&&(n="");var i=J(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=J(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(a=!0,i=!0),a||(o=!1),!a&&i&&(o=!0),a&&!i)if(this.correctFormat===!0){var s=Hke(n,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,s,"dateValidator"),o=!0}else o=!1;e(o)}dT.VALIDATOR_TYPE=Ike;function Hke(t,e){var r=J(jke(t)),n=J(t,e),o=t.search(/[A-z]/g)>-1,i;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?i=r:i=n,i.format(e)}var Dke="numeric";function pT(t,e){var r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:kn(t))}pT.VALIDATOR_TYPE=Dke;var Nke=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],Lke="time";function yT(t,e){var r=this.timeFormat||"h:mm:ss a",n=!0,o=t;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;var i=/^\d{1,2}$/.test(o);i&&(o+=":00");var a=J(o,Nke,!0).isValid()?J(o):J(o,r),s=a.isValid(),l=J(o,r,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(this.correctFormat===!0){var u=a.format(r),c=this.instance.toVisualRow(this.row),f=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,f,u,"timeValidator"),n=!0}else n=!1;e(n)}yT.VALIDATOR_TYPE=Lke;function Bke(){nf($v),nf(dT),nf(pT),nf(yT)}var Vke="autocomplete",Fke={CELL_TYPE:Vke,editor:iT,renderer:vc,validator:$v},Wke="checkbox",Uke={CELL_TYPE:Wke,editor:H2,renderer:lT},zke="date",Yke={CELL_TYPE:zke,editor:L2,renderer:vc,validator:dT},Gke="dropdown",$ke={CELL_TYPE:Gke,editor:aT,renderer:vc,validator:$v},Kke="handsontable",qke={CELL_TYPE:Kke,editor:oT,renderer:vc},Xke="numeric",Zke={CELL_TYPE:Xke,editor:B2,renderer:cT,validator:pT,dataType:"number"},Qke="password",Jke={CELL_TYPE:Qke,editor:V2,renderer:fT,copyable:!1},eRe="time",tRe={CELL_TYPE:eRe,editor:F2,renderer:hT,validator:yT};function nRe(){Pr(Fke),Pr(Uke),Pr(Yke),Pr($ke),Pr(qke),Pr(Zke),Pr(Jke),Pr(C2),Pr(tRe)}var rRe=nv,oRe=wW;rRe("WeakSet",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},oRe);function Fh(t){"@babel/helpers - typeof";return Fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fh(t)}function iRe(t,e){return uRe(t)||lRe(t,e)||sRe(t,e)||aRe()}function aRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sRe(t,e){if(t){if(typeof t=="string")return TI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TI(t,e)}}function TI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lRe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uRe(t){if(Array.isArray(t))return t}function cRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hRe(n.key),n)}}function fRe(t,e,r){return e&&PI(t.prototype,e),r&&PI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hRe(t){var e=dRe(t,"string");return Fh(e)==="symbol"?e:String(e)}function dRe(t,e){if(Fh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pRe(t,e){yRe(t,e),e.add(t)}function yRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mRe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var MI=new Map([["plugin",Yle],["cell-type",h2],["editor",MW],["renderer",UW],["validator",zW]]),gRe="base",Li=new WeakMap,Fw=[],Cr=null,_I=new WeakSet,at=function(){function t(e){var r=this;cRe(this,t),pRe(this,_I),Fo(this,"hot",e,{writable:!1}),Li.set(this,{hooks:{}}),Cr=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return r.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(n){return r.onUpdateSettings(n)}),this.hot.addHook("beforeInit",function(){return r.init()})}return fRe(t,[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var r=this.constructor.PLUGIN_DEPS,n=Array.isArray(r)?r:[];if(n.length>0){var o=[];if(n.forEach(function(l){var u=l.split(":"),c=iRe(u,2),f=c[0],h=c[1];if(!MI.has(f))throw new Error('Unknown plugin dependency type "'.concat(f,'" was found.'));MI.get(f)(h)||o.push(" - ".concat(h," (").concat(f,")"))}),o.length>0){var i=["The ".concat(this.pluginName,` plugin requires the following modules:
`),"".concat(o.join(`
`),`
`)].join("");Fw.push(i)}}Cr||(Cr=WW()),Cr.indexOf("UndoRedo")>=0&&Cr.splice(Cr.indexOf("UndoRedo"),1),Cr.indexOf(this.pluginName)>=0&&Cr.splice(Cr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()});var a=Cr.length===0;if(a){if(Fw.length>0){var s=["".concat(Fw.join(`
`),`
`),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,r){Li.get(this).hooks[e]=Li.get(this).hooks[e]||[];var n=Li.get(this).hooks[e];this.hot.addHook(e,r),n.push(r),Li.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var r=this;_(Li.get(this).hooks[e]||[],function(n){r.hot.removeHook(e,n)})}},{key:"clearHooks",value:function(){var e=this,r=Li.get(this).hooks;$e(r,function(n,o){return e.removeHooks(o)}),r.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){_(this.pluginsInitializedCallbacks,function(e){return e()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var r=mRe(this,_I,vRe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),$e(this,function(r,n){n!=="hot"&&(e[n]=null)}),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return gRe}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),t}();function vRe(t){if(!t)return!1;var e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(var r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Wh(t){"@babel/helpers - typeof";return Wh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wh(t)}function bRe(t,e){return ORe(t)||CRe(t,e)||SRe(t,e)||wRe()}function wRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SRe(t,e){if(t){if(typeof t=="string")return xI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xI(t,e)}}function xI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CRe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function ORe(t){if(Array.isArray(t))return t}function kRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ERe(n.key),n)}}function RRe(t,e,r){return e&&AI(t.prototype,e),r&&AI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ERe(t){var e=TRe(t,"string");return Wh(e)==="symbol"?e:String(e)}function TRe(t,e){if(Wh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PRe=function(){function t(e){kRe(this,t),this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return RRe(t,[{key:"addRow",value:function(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){var r=this.hot.getColHeader(0);if(r!=null){var n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}},{key:"addColumn",value:function(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),_(this.rows,function(r){e(r.row,Rt(r.table)-1)})}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),_(this.columns,function(r){var n=r.table.getBoundingClientRect(),o=n.width;e(r.col,Math.ceil(o))})}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,r){this.settings||(this.settings={}),this.settings[e]=r}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1)),this.samples.forEach(function(n){_(n.strings,function(o){r.appendChild(e.createColElement(o.col))})}),r}},{key:"createRow",value:function(e){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),o.appendChild(i)),this.samples.forEach(function(a){_(a.strings,function(s){var l=s.col,u=r.hot.getCellMeta(e,l);u.col=l,u.row=e;var c=r.hot.getCellRenderer(u),f=n.createElement("td");f.setAttribute("ghost-table",1),c(r.hot,f,e,l,r.hot.colToProp(l),s.value,u),o.appendChild(f)})}),o}},{key:"appendColumnHeadersRow",value:function(){var e=this,r=this.hot.rootDocument,n=r.createDocumentFragment(),o=[];if(this.hot.hasRowHeaders()){var i=r.createElement("th");o.push([-1,i]),n.appendChild(i)}this.samples.forEach(function(a){_(a.strings,function(s){var l=s.col,u=r.createElement("th");o.push([l,u]),n.appendChild(u)})}),this.table.tHead.appendChild(n),_(o,function(a){var s=bRe(a,2),l=s[0],u=s[1];e.hot.view.appendColHeader(l,u)})}},{key:"createCol",value:function(e){var r=this,n=this.hot.rootDocument,o=n.createDocumentFragment();return this.samples.forEach(function(i){_(i.strings,function(a){var s=a.row,l=r.hot.getCellMeta(s,e);l.col=e,l.row=s;var u=r.hot.getCellRenderer(l),c=n.createElement("td"),f=n.createElement("tr");c.setAttribute("ghost-table",1),u(r.hot,c,s,e,r.hot.colToProp(e),a.value,l),f.appendChild(c),o.appendChild(f)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var r=this.hot.rootDocument.createElement("col");return r.style.width="".concat(this.hot.view._wt.wtTable.getStretchedColumnWidth(e),"px"),r}},{key:"createTable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=this.hot.rootDocument,n=r.createDocumentFragment(),o=r.createElement("table"),i=r.createElement("thead"),a=r.createElement("tbody"),s=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&o.appendChild(s),this.isHorizontal()&&(l.appendChild(u),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&a.appendChild(l),o.appendChild(a),te(o,e),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:a,colGroup:s,tr:l,th:u}}},{key:"createContainer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=this.hot.rootDocument,n=r.createDocumentFragment(),o=r.createElement("div"),i="htGhostTable htAutoSize ".concat(e.trim());return te(o,i),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!!(this.rows.length&&!this.columns.length)}},{key:"isHorizontal",value:function(){return!!(this.columns.length&&!this.rows.length)}}]),t}();const z2=PRe;function Uh(t){"@babel/helpers - typeof";return Uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uh(t)}function MRe(t,e,r){return e=Y2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _Re(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Y2(n.key),n)}}function xRe(t,e,r){return e&&jI(t.prototype,e),r&&jI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Y2(t){var e=ARe(t,"string");return Uh(e)==="symbol"?e:String(e)}function ARe(t,e){if(Uh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jRe=function(){function t(e){_Re(this,t),this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}return xRe(t,[{key:"getSampleCount",value:function(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}},{key:"setSampleCount",value:function(e){this.customSampleCount=e}},{key:"setAllowDuplicates",value:function(e){this.allowDuplicates=e}},{key:"generateRowSamples",value:function(e,r){return this.generateSamples("row",r,e)}},{key:"generateColumnSamples",value:function(e,r){return this.generateSamples("col",r,e)}},{key:"generateSamples",value:function(e,r,n){var o=this,i=new Map,a=typeof n=="number"?{from:n,to:n}:n,s=a.from,l=a.to;return Oe(s,l,function(u){var c=o.generateSample(e,r,u);i.set(u,c)}),i}},{key:"generateSample",value:function(e,r,n){var o=this;if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");var i=new Map,a=e==="row"?"col":"row",s=[];return Oe(r.from,r.to,function(l){var u=e==="row"?o.dataFactory(n,l):o.dataFactory(l,n),c=u.value,f=u.bundleSeed,h=typeof f=="string"&&f.length>0,p;h?p=f:Ge(c)?p="".concat(Object.keys(c).length):Array.isArray(c)?p="".concat(c.length):p="".concat(Dt(c).length),i.has(p)||i.set(p,{needed:o.getSampleCount(),strings:[]});var y=i.get(p);if(y.needed){var g=s.indexOf(c)>-1;(!g||o.allowDuplicates||h)&&(y.strings.push(MRe({value:c},a,l)),s.push(c),y.needed-=1)}}),i}}],[{key:"SAMPLE_COUNT",get:function(){return 3}}]),t}();const G2=jRe;function Xl(t){"@babel/helpers - typeof";return Xl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xl(t)}function II(t,e){return NRe(t)||DRe(t,e)||HRe(t,e)||IRe()}function IRe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HRe(t,e){if(t){if(typeof t=="string")return HI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HI(t,e)}}function HI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DRe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function NRe(t){if(Array.isArray(t))return t}function LRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function DI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VRe(n.key),n)}}function BRe(t,e,r){return e&&DI(t.prototype,e),r&&DI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function VRe(t){var e=FRe(t,"string");return Xl(e)==="symbol"?e:String(e)}function FRe(t,e){if(Xl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qi(){return typeof Reflect<"u"&&Reflect.get?Qi=Reflect.get.bind():Qi=function(t,e,r){var n=WRe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Qi.apply(this,arguments)}function WRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=uo(t),t!==null););return t}function URe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n1(t,e)}function n1(t,e){return n1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},n1(t,e)}function zRe(t){var e=GRe();return function(){var r=uo(t),n;if(e){var o=uo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YRe(this,n)}}function YRe(t,e){if(e&&(Xl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $2(t)}function $2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function uo(t){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},uo(t)}ye.getSingleton().register("modifyAutoColumnSizeSeed");var Bc="autoColumnSize",$Re=10,Ww=new WeakMap,KRe="autoColumnSize",qRe=function(t){URe(r,t);var e=zRe(r);function r(n){var o;return LRe(this,r),o=e.call(this,n),Ww.set($2(o),{cachedColumnHeaders:[]}),o.ghostTable=new z2(o.hot),o.samplesGenerator=new G2(function(i,a){var s=o.hot.getCellMeta(i,a),l="";s.spanned||(l=o.hot.getDataAtCell(i,a));var u="";return o.hot.hasHook("modifyAutoColumnSizeSeed")&&(u=o.hot.runHooks("modifyAutoColumnSizeSeed",u,s,l)),{value:l,bundleSeed:u}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredColumns=0,o.columnWidthsMap=new Ti,o.hot.columnIndexMapper.registerMap(KRe,o.columnWidthsMap),o.addHook("beforeColumnResize",function(i,a,s){return o.onBeforeColumnResize(i,a,s)}),o}return BRe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[Bc]!==!1&&!this.hot.getSettings().colWidths}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[Bc];o&&o.useHeaders!==null&&o.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",o.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeChangeRender",function(i){return n.onBeforeChange(i)}),this.addHook("afterFormulasValuesUpdate",function(i){return n.onAfterFormulasValuesUpdate(i)}),this.addHook("beforeViewRender",function(i){return n.onBeforeViewRender(i)}),this.addHook("modifyColWidth",function(i,a){return n.getColumnWidth(a,i)}),this.addHook("afterInit",function(){return n.onAfterInit()}),Qi(uo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){var n=this.findColumnsWhereHeaderWasChanged();n.length&&(this.clearCache(n),this.calculateVisibleColumnsWidth()),Qi(uo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=this;Qi(uo(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeColumnResize",function(o,i,a){return n.onBeforeColumnResize(o,i,a)})}},{key:"calculateVisibleColumnsWidth",value:function(){var n=this.hot.countRows();if(n){var o=this.hot.renderCall,i=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn();i===-1||a===-1||this.calculateColumnsWidth({from:i,to:a},void 0,o)}}},{key:"calculateColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof o=="number"?{from:o,to:o}:o,l=typeof i=="number"?{from:i,to:i}:i;Oe(s.from,s.to,function(u){var c=n.hot.toPhysicalColumn(u);if(c===null&&(c=u),a||n.columnWidthsMap.getValueAtIndex(c)===null&&!n.hot._getColWidthFromSettings(c)){var f=n.samplesGenerator.generateColumnSamples(u,l);_(f,function(h){var p=II(h,2),y=p[0],g=p[1];return n.ghostTable.addColumn(y,g)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(function(){n.ghostTable.getWidths(function(u,c){var f=n.hot.toPhysicalColumn(u);n.columnWidthsMap.setValueAtIndex(f,c)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}},{key:"calculateAllColumnsWidth",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=0,a=this.hot.countCols()-1,s=null;this.inProgress=!0;var l=function c(){if(!n.hot){Pm(s),n.inProgress=!1;return}n.calculateColumnsWidth({from:i,to:Math.min(i+r.CALCULATION_STEP,a)},o),i=i+r.CALCULATION_STEP+1,i<a?s=jk(c):(Pm(s),n.inProgress=!1,n.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateColumnsWidth({from:0,to:u},o),this.firstCalculation=!1,i=u+1),i<a?l():this.inProgress=!1}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings()[Bc],o=n&&xt(n,"samplingRatio")?n.samplingRatio:void 0,i=n&&xt(n,"allowSampleDuplicates")?n.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllColumnsWidth",value:function(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}},{key:"getSyncCalculationLimit",value:function(){var n=this.hot.getSettings()[Bc],o=r.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return Ge(n)&&(o=n.syncLimit,cW(o)?o=HW(i,o):o>>=0),Math.min(o,i)}},{key:"getColumnWidth",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=o;return a===void 0&&(a=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(n)),i&&typeof a=="number"&&(a=Math.max(a,fR.DEFAULT_WIDTH))),a}},{key:"getFirstVisibleColumn",value:function(){var n=this.hot.view._wt;if(n.wtViewport.columnsVisibleCalculator){var o=n.wtTable.getFirstVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(n.wtViewport.columnsRenderCalculator){var i=n.wtTable.getFirstRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}},{key:"getLastVisibleColumn",value:function(){var n=this.hot.view._wt;if(n.wtViewport.columnsVisibleCalculator){var o=n.wtTable.getLastVisibleColumn();if(o!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)}if(n.wtViewport.columnsRenderCalculator){var i=n.wtTable.getLastRenderedColumn();if(i!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)}return-1}},{key:"findColumnsWhereHeaderWasChanged",value:function(){var n=this.hot.getColHeader(),o=Ww.get(this),i=o.cachedColumnHeaders,a=an(n,function(s,l,u){var c=i.length;return(c-1<u||i[u]!==l)&&s.push(u),c-1<u?i.push(l):i[u]=l,s},[]);return a}},{key:"clearCache",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];o.length?this.hot.batchExecution(function(){_(o,function(i){n.columnWidthsMap.setValueAtIndex(i,null)})},!0):this.columnWidthsMap.clear()}},{key:"isNeedRecalculate",value:function(){return!!Xn(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),function(n){return n===null}).length}},{key:"onBeforeViewRender",value:function(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){n.hot&&n.recalculateAllColumnsWidth()},0)}},{key:"onBeforeChange",value:function(n){var o=this,i=Ye(n,function(a){var s=II(a,2),l=s[1];return o.hot.toPhysicalColumn(o.hot.propToCol(l))});this.clearCache(Array.from(new Set(i)))}},{key:"onBeforeColumnResize",value:function(n,o,i){var a=n;return i&&(this.calculateColumnsWidth(o,void 0,!0),a=this.getColumnWidth(o,void 0,!1)),a}},{key:"onAfterInit",value:function(){Ww.get(this).cachedColumnHeaders=this.hot.getColHeader()}},{key:"onAfterFormulasValuesUpdate",value:function(n){var o=Xn(n,function(a){var s;return pe((s=a.address)===null||s===void 0?void 0:s.col)}),i=Ye(o,function(a){return a.address.col});this.clearCache(Array.from(new Set(i)))}},{key:"destroy",value:function(){this.ghostTable.clean(),Qi(uo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Bc}},{key:"PLUGIN_PRIORITY",get:function(){return $Re}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 50}}]),r}(at),Ji={horizontal:"horizontal",vertical:"vertical"};function XRe(t,e,r,n){var o=r.length,i=r?r[0].length:0,a=[],s=e.row-t.row,l=e.col-t.col;if(["down","up"].indexOf(n)!==-1){for(var u=[],c=0;c<l;c++){var f=parseInt(r[0][c],10),h=parseInt(r[o-1][c],10),p=(n==="down"?h-f:f-h)/(o-1)||0;u.push(p)}a.push(u)}if(["right","left"].indexOf(n)!==-1)for(var y=0;y<s;y++){var g=parseInt(r[y][0],10),v=parseInt(r[y][i-1],10),S=(n==="right"?v-g:g-v)/(i-1)||0;a.push([S])}return a}function ZRe(t,e,r){var n,o,i;return e[0]===t[0]&&e[1]<t[1]?(i="left",n=r(e[0],e[1]),o=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(i="right",n=r(e[0],t[3]+1),o=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(i="up",n=r(e[0],e[1]),o=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(i="down",n=r(t[2]+1,e[1]),o=r(e[2],e[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function QRe(t){var e={};return t===!0?(e.directions=Object.keys(Ji),e.autoInsertRow=!0):Ge(t)?(pe(t.autoInsertRow)?t.direction===Ji.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,pe(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ji)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Zl(t){"@babel/helpers - typeof";return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zl(t)}function JRe(t){return nEe(t)||tEe(t)||K2(t)||eEe()}function eEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tEe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nEe(t){if(Array.isArray(t))return r1(t)}function rEe(t,e){return aEe(t)||iEe(t,e)||K2(t,e)||oEe()}function oEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K2(t,e){if(t){if(typeof t=="string")return r1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r1(t,e)}}function r1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function iEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function aEe(t){if(Array.isArray(t))return t}function sEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,uEe(n.key),n)}}function lEe(t,e,r){return e&&NI(t.prototype,e),r&&NI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function uEe(t){var e=cEe(t,"string");return Zl(e)==="symbol"?e:String(e)}function cEe(t,e){if(Zl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ea(){return typeof Reflect<"u"&&Reflect.get?ea=Reflect.get.bind():ea=function(t,e,r){var n=fEe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ea.apply(this,arguments)}function fEe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=co(t),t!==null););return t}function hEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&o1(t,e)}function o1(t,e){return o1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},o1(t,e)}function dEe(t){var e=yEe();return function(){var r=co(t),n;if(e){var o=co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return pEe(this,n)}}function pEe(t,e){if(e&&(Zl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q2(t)}function q2(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function co(t){return co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},co(t)}ye.getSingleton().register("modifyAutofillRange");ye.getSingleton().register("beforeAutofill");ye.getSingleton().register("afterAutofill");var LI="autofill",mEe=20,gEe=["fillHandle"],vEe="insert_row_below",bEe=200,wEe=function(t){hEe(r,t);var e=dEe(r);function r(n){var o;return sEe(this,r),o=e.call(this,n),o.eventManager=new Tt(q2(o)),o.addingStarted=!1,o.mouseDownOnCellCorner=!1,o.mouseDragOutside=!1,o.handleDraggedCells=0,o.directions=[],o.autoInsertRow=!1,o}return lEe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings().fillHandle}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",function(o){return n.onAfterCellCornerMouseDown(o)}),this.addHook("afterOnCellCornerDblClick",function(o){return n.onCellCornerDblClick(o)}),this.addHook("beforeOnCellMouseOver",function(o,i){return n.onBeforeCellMouseOver(i)}),ea(co(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ea(co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.clearMappedSettings(),ea(co(r.prototype),"disablePlugin",this).call(this)}},{key:"getSelectionData",value:function(){var n=this,o=this.hot.getSelectedRangeLast(),i=o.getTopStartCorner(),a=i.row,s=i.col,l=o.getBottomEndCorner(),u=l.row,c=l.col,f=this.hot.runHooks("modifyCopyableRange",[{startRow:a,startCol:s,endRow:u,endCol:c}]),h=[],p=[],y=[];return _(f,function(g){for(var v=g.startRow;v<=g.endRow;v+=1)h.indexOf(v)===-1&&h.push(v);for(var S=g.startCol;S<=g.endCol;S+=1)p.indexOf(S)===-1&&p.push(S)}),_(h,function(g){var v=[];_(p,function(S){v.push(n.hot.getCopyableData(g,S))}),y.push(v)}),y}},{key:"fillIn",value:function(){var n=this;if(this.hot.selection.highlight.getFill().isEmpty())return!1;var o=this.hot.selection.highlight.getFill().getVisualCorners(),i=rEe(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.hot.getSelectedRangeLast(),f=c.getTopStartCorner(),h=c.getBottomEndCorner();this.resetSelectionOfDraggedArea();var p=[f.row,f.col,h.row,h.col],y=this.hot.runHooks("modifyAutofillRange",[Math.min(f.row,a),Math.min(f.col,s),Math.max(h.row,l),Math.max(h.col,u)],p),g=ZRe(p,y,function(Se,P){return n.hot._createCellCoords(Se,P)}),v=g.directionOfDrag,S=g.startOfDragCoords,O=g.endOfDragCoords;if(S&&S.row>-1&&S.col>-1){var w=this.getSelectionData(),x=c.clone(),T=this.hot._createCellRange(S,S,O),z=this.hot.runHooks("beforeAutofill",w,x,T,v);if(z===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;var $=XRe(S,O,w,v),ne=z,G=z;if(["up","left"].indexOf(v)>-1&&!(G.length===1&&G[0].length===0))if(ne=[],v==="up")for(var q=O.row-S.row+1,Z=q%G.length,ee=0;ee<q;ee++)ne.push(G[(ee+(G.length-Z))%G.length]);else for(var Q=O.col-S.col+1,ce=Q%G[0].length,fe=0;fe<G.length;fe++){ne.push([]);for(var we=0;we<Q;we++)ne[fe].push(G[fe][(we+(G[fe].length-ce))%G[fe].length])}this.hot.populateFromArray(S.row,S.col,ne,O.row,O.col,"".concat(this.pluginName,".fill"),null,v,$),this.setSelection(y),this.hot.runHooks("afterAutofill",ne,x,T,v),this.hot.render()}else this.hot._refreshBorders();return!0}},{key:"reduceSelectionAreaIfNeeded",value:function(n){return n.row<0&&(n.row=0),n.col<0&&(n.col=0),n}},{key:"getCoordsOfDragAndDropBorders",value:function(n){var o=this.hot.getSelectedRangeLast(),i=o.getBottomEndCorner(),a=n;if(this.directions.includes(Ji.vertical)&&this.directions.includes(Ji.horizontal)){var s=o.getTopStartCorner();(i.col<=n.col||s.col>=n.col)&&(a=this.hot._createCellCoords(i.row,n.col)),(i.row<n.row||s.row>n.row)&&(a=this.hot._createCellCoords(n.row,i.col))}else if(this.directions.includes(Ji.vertical))a=this.hot._createCellCoords(n.row,i.col);else if(this.directions.includes(Ji.horizontal))a=this.hot._createCellCoords(i.row,n.col);else return;return this.reduceSelectionAreaIfNeeded(a)}},{key:"showBorder",value:function(n){var o=this.getCoordsOfDragAndDropBorders(n);o&&this.redrawBorders(o)}},{key:"addRow",value:function(){var n=this;this.hot._registerTimeout(function(){n.hot.alter(vEe,void 0,1,"".concat(n.pluginName,".fill")),n.addingStarted=!1},bEe)}},{key:"addNewRowIfNeeded",value:function(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){var n=this.hot.getSelectedLast(),o=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();n[2]<i-1&&o[2]===i-1&&(this.addingStarted=!0,this.addRow())}}},{key:"getIndexOfLastAdjacentFilledInRow",value:function(n){for(var o=this.hot.getData(),i=this.hot.countRows(),a,s=n[2]+1;s<i;s++){for(var l=n[1];l<=n[3];l++){var u=o[s][l];if(u)return-1}var c=o[s][n[1]-1],f=o[s][n[3]+1];(c||f)&&(a=s)}return a}},{key:"addSelectionFromStartAreaToSpecificRowIndex",value:function(n,o){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(n[0],n[1])).add(this.hot._createCellCoords(o,n[3])).commit()}},{key:"setSelection",value:function(n){var o;(o=this.hot).selectCell.apply(o,JRe(Ye(n,function(i){return Math.max(i,0)})).concat([!1,!1]))}},{key:"selectAdjacent",value:function(){var n=this.hot.getSelectedLast(),o=this.getIndexOfLastAdjacentFilledInRow(n);return o===-1||o===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(n,o),!0)}},{key:"resetSelectionOfDraggedArea",value:function(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}},{key:"redrawBorders",value:function(n){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(n).commit(),this.hot.view.render()}},{key:"getIfMouseWasDraggedOutside",value:function(n){var o=this.hot.rootDocument.documentElement,i=Wt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||o.scrollTop)+Rt(this.hot.table),a=Wt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||o.scrollLeft)+ut(this.hot.table);return n.clientY>i&&n.clientX<=a}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)})}},{key:"onCellCornerDblClick",value:function(){var n=this.selectAdjacent();n&&this.fillIn()}},{key:"onAfterCellCornerMouseDown",value:function(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}},{key:"onBeforeCellMouseOver",value:function(n){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(n),this.addNewRowIfNeeded())}},{key:"onMouseUp",value:function(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}},{key:"onMouseMove",value:function(n){var o=this.getIfMouseWasDraggedOutside(n);this.addingStarted===!1&&this.handleDraggedCells>0&&o?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}},{key:"clearMappedSettings",value:function(){this.directions.length=0,this.autoInsertRow=!1}},{key:"mapSettings",value:function(){var n=QRe(this.hot.getSettings().fillHandle);this.directions=n.directions,this.autoInsertRow=n.autoInsertRow}},{key:"destroy",value:function(){ea(co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return LI}},{key:"PLUGIN_PRIORITY",get:function(){return mEe}},{key:"SETTING_KEYS",get:function(){return[LI].concat(gEe)}}]),r}(at);function Ql(t){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ql(t)}function SEe(t,e){return REe(t)||kEe(t,e)||OEe(t,e)||CEe()}function CEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OEe(t,e){if(t){if(typeof t=="string")return BI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return BI(t,e)}}function BI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function kEe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function REe(t){if(Array.isArray(t))return t}function EEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PEe(n.key),n)}}function TEe(t,e,r){return e&&VI(t.prototype,e),r&&VI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PEe(t){var e=MEe(t,"string");return Ql(e)==="symbol"?e:String(e)}function MEe(t,e){if(Ql(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ql(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Us(){return typeof Reflect<"u"&&Reflect.get?Us=Reflect.get.bind():Us=function(t,e,r){var n=_Ee(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Us.apply(this,arguments)}function _Ee(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=hi(t),t!==null););return t}function xEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i1(t,e)}function i1(t,e){return i1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},i1(t,e)}function AEe(t){var e=HEe();return function(){var r=hi(t),n;if(e){var o=hi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jEe(this,n)}}function jEe(t,e){if(e&&(Ql(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IEe(t)}function IEe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hi(t){return hi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hi(t)}var iy="autoRowSize",DEe=40,NEe="autoRowSize",LEe=function(t){xEe(r,t);var e=AEe(r);function r(n){var o;return EEe(this,r),o=e.call(this,n),o.rowHeightsMap=void 0,o.headerHeight=null,o.ghostTable=new z2(o.hot),o.samplesGenerator=new G2(function(i,a){var s;return i>=0?s=o.hot.getDataAtCell(i,a):i===-1&&(s=o.hot.getColHeader(a)),{value:s}}),o.firstCalculation=!0,o.inProgress=!1,o.measuredRows=0,o.rowHeightsMap=new Ti,o.hot.rowIndexMapper.registerMap(NEe,o.rowHeightsMap),o.addHook("beforeRowResize",function(i,a,s){return o.onBeforeRowResize(i,a,s)}),o}return TEe(r,[{key:"isEnabled",value:function(){var n=this.hot.getSettings()[iy];return n===!0||Ge(n)}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeChangeRender",function(o){return n.onBeforeChange(o)}),this.addHook("beforeColumnResize",function(){return n.recalculateAllRowsHeight()}),this.addHook("beforeViewRender",function(o){return n.onBeforeViewRender(o)}),this.addHook("modifyRowHeight",function(o,i){return n.getRowHeight(i,o)}),this.addHook("modifyColumnHeaderHeight",function(){return n.getColumnHeaderHeight()}),Us(hi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=this;this.headerHeight=null,Us(hi(r.prototype),"disablePlugin",this).call(this),this.addHook("beforeRowResize",function(o,i,a){return n.onBeforeRowResize(o,i,a)})}},{key:"calculateRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=typeof o=="number"?{from:o,to:o}:o,l=typeof i=="number"?{from:i,to:i}:i;if(this.hot.getColHeader(0)!==null){var u=this.samplesGenerator.generateRowSamples(-1,l);this.ghostTable.addColumnHeadersRow(u.get(-1))}Oe(s.from,s.to,function(c){if(a||n.rowHeightsMap.getValueAtIndex(c)===null){var f=n.samplesGenerator.generateRowSamples(c,l);_(f,function(h){var p=SEe(h,2),y=p[0],g=p[1];return n.ghostTable.addRow(y,g)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(function(){n.ghostTable.getHeights(function(c,f){c<0?n.headerHeight=f:n.rowHeightsMap.setValueAtIndex(n.hot.toPhysicalRow(c),f)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}},{key:"calculateAllRowsHeight",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},i=0,a=this.hot.countRows()-1,s=null;this.inProgress=!0;var l=function c(){if(!n.hot){Pm(s),n.inProgress=!1;return}n.calculateRowsHeight({from:i,to:Math.min(i+r.CALCULATION_STEP,a)},o),i=i+r.CALCULATION_STEP+1,i<a?s=jk(c):(Pm(s),n.inProgress=!1,n.hot.view.adjustElementsSize(!0),n.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&n.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},u=this.getSyncCalculationLimit();this.firstCalculation&&u>=0&&(this.calculateRowsHeight({from:0,to:u},o),this.firstCalculation=!1,i=u+1),i<a?l():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}},{key:"setSamplingOptions",value:function(){var n=this.hot.getSettings()[iy],o=n&&xt(n,"samplingRatio")?n.samplingRatio:void 0,i=n&&xt(n,"allowSampleDuplicates")?n.allowSampleDuplicates:void 0;o&&!isNaN(o)&&this.samplesGenerator.setSampleCount(parseInt(o,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}},{key:"recalculateAllRowsHeight",value:function(){_f(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}},{key:"getSyncCalculationLimit",value:function(){var n=this.hot.getSettings()[iy],o=r.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return Ge(n)&&(o=n.syncLimit,cW(o)?o=HW(i,o):o>>=0),Math.min(o,i)}},{key:"getRowHeight",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,i=n<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(n)),a=o;return i!==null&&i>(o||0)&&(a=i),a}},{key:"getColumnHeaderHeight",value:function(){return this.headerHeight}},{key:"getFirstVisibleRow",value:function(){var n=this.hot.view._wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getFirstVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getFirstRenderedRow():-1}},{key:"getLastVisibleRow",value:function(){var n=this.hot.view._wt;return n.wtViewport.rowsVisibleCalculator?n.wtTable.getLastVisibleRow():n.wtViewport.rowsRenderCalculator?n.wtTable.getLastRenderedRow():-1}},{key:"clearCache",value:function(){this.headerHeight=null,this.rowHeightsMap.init()}},{key:"clearCacheByRange",value:function(n){var o=this,i=typeof n=="number"?{from:n,to:n}:n,a=i.from,s=i.to;this.hot.batchExecution(function(){Oe(Math.min(a,s),Math.max(a,s),function(l){o.rowHeightsMap.setValueAtIndex(l,null)})},!0)}},{key:"isNeedRecalculate",value:function(){return!!Xn(this.rowHeightsMap.getValues().slice(0,this.measuredRows),function(n){return n===null}).length}},{key:"onBeforeViewRender",value:function(){var n=this.hot.renderCall,o=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),a=this.getLastVisibleRow();if(!(i===-1||a===-1)){if(this.calculateRowsHeight({from:i,to:a},void 0,n),o){var s=this.hot.countRows()-1;this.calculateRowsHeight({from:s-o,to:s})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}},{key:"onBeforeRowMove",value:function(n,o){this.clearCacheByRange({from:n,to:o}),this.calculateAllRowsHeight()}},{key:"onBeforeRowResize",value:function(n,o,i){var a=n;return i&&(this.calculateRowsHeight(o,void 0,!0),a=this.getRowHeight(o)),a}},{key:"onAfterLoadData",value:function(){var n=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){n.hot&&n.recalculateAllRowsHeight()},0)}},{key:"onBeforeChange",value:function(n){var o=null;n.length===1?o=n[0][0]:n.length>1&&(o={from:n[0][0],to:n[n.length-1][0]}),o!==null&&this.clearCacheByRange(o)}},{key:"destroy",value:function(){this.ghostTable.clean(),Us(hi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return iy}},{key:"PLUGIN_PRIORITY",get:function(){return DEe}},{key:"SETTING_KEYS",get:function(){return!0}},{key:"CALCULATION_STEP",get:function(){return 50}},{key:"SYNC_CALCULATION_LIMIT",get:function(){return 500}}]),r}(at);function Jl(t){"@babel/helpers - typeof";return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jl(t)}function BEe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FEe(n.key),n)}}function VEe(t,e,r){return e&&FI(t.prototype,e),r&&FI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FEe(t){var e=WEe(t,"string");return Jl(e)==="symbol"?e:String(e)}function WEe(t,e){if(Jl(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gf(){return typeof Reflect<"u"&&Reflect.get?gf=Reflect.get.bind():gf=function(t,e,r){var n=UEe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},gf.apply(this,arguments)}function UEe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=La(t),t!==null););return t}function zEe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a1(t,e)}function a1(t,e){return a1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},a1(t,e)}function YEe(t){var e=KEe();return function(){var r=La(t),n;if(e){var o=La(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GEe(this,n)}}function GEe(t,e){if(e&&(Jl(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ee(t)}function $Ee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KEe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function La(t){return La=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},La(t)}var X2=WU("physicallyIndexed"),qEe=X2.getListWithInsertedItems,XEe=X2.getListWithRemovedItems,ZEe=function(t){zEe(r,t);var e=YEe(r);function r(){return BEe(this,r),e.call(this,function(n){return n})}return VEe(r,[{key:"insert",value:function(n,o){var i=PR(this.indexedValues,o);this.indexedValues=qEe(i,n,o,this.initValueOrFn),gf(La(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){var o=XEe(this.indexedValues,n);this.indexedValues=TR(o,n),gf(La(r.prototype),"remove",this).call(this,n)}}]),r}(Xa);const QEe=ZEe;function eu(t){"@babel/helpers - typeof";return eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eu(t)}function JEe(t){return rTe(t)||nTe(t)||tTe(t)||eTe()}function eTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tTe(t,e){if(t){if(typeof t=="string")return s1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s1(t,e)}}function nTe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rTe(t){if(Array.isArray(t))return s1(t)}function s1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function oTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aTe(n.key),n)}}function iTe(t,e,r){return e&&WI(t.prototype,e),r&&WI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aTe(t){var e=sTe(t,"string");return eu(e)==="symbol"?e:String(e)}function sTe(t,e){if(eu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vf(){return typeof Reflect<"u"&&Reflect.get?vf=Reflect.get.bind():vf=function(t,e,r){var n=lTe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},vf.apply(this,arguments)}function lTe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ba(t),t!==null););return t}function uTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l1(t,e)}function l1(t,e){return l1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},l1(t,e)}function cTe(t){var e=dTe();return function(){var r=Ba(t),n;if(e){var o=Ba(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fTe(this,n)}}function fTe(t,e){if(e&&(eu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hTe(t)}function hTe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ba(t){return Ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ba(t)}var Z2=WU("physicallyIndexed"),pTe=Z2.getListWithInsertedItems,yTe=Z2.getListWithRemovedItems,mTe=function(t){uTe(r,t);var e=cTe(r);function r(){return oTe(this,r),e.call(this,function(n){return n})}return iTe(r,[{key:"insert",value:function(n,o){var i=this;this.indexedValues=pTe(this.indexedValues,n,o,function(a,s){return i.getNextValue(s)}),vf(Ba(r.prototype),"insert",this).call(this,n,o)}},{key:"remove",value:function(n){this.indexedValues=yTe(this.indexedValues,n),vf(Ba(r.prototype),"remove",this).call(this,n)}},{key:"getNextValue",value:function(n){return Math.max.apply(Math,JEe(this.getValues()))+1+n}}]),r}(Xa);const gTe=mTe;function tu(t){"@babel/helpers - typeof";return tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tu(t)}function vTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wTe(n.key),n)}}function bTe(t,e,r){return e&&UI(t.prototype,e),r&&UI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wTe(t){var e=STe(t,"string");return tu(e)==="symbol"?e:String(e)}function STe(t,e){if(tu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zs(){return typeof Reflect<"u"&&Reflect.get?zs=Reflect.get.bind():zs=function(t,e,r){var n=CTe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},zs.apply(this,arguments)}function CTe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=di(t),t!==null););return t}function OTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u1(t,e)}function u1(t,e){return u1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},u1(t,e)}function kTe(t){var e=TTe();return function(){var r=di(t),n;if(e){var o=di(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RTe(this,n)}}function RTe(t,e){if(e&&(tu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ETe(t)}function ETe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function di(t){return di=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},di(t)}var Uw="bindRowsWithHeaders",PTe=210,MTe="loose",_Te=new Map([["loose",QEe],["strict",gTe]]),xTe=function(t){OTe(r,t);var e=kTe(r);function r(n){var o;return vTe(this,r),o=e.call(this,n),o.headerIndexes=null,o}return bTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Uw]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[Uw];typeof o!="string"&&(o=MTe);var i=_Te.get(o);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new i),this.addHook("modifyRowHeader",function(a){return n.onModifyRowHeader(a)}),zs(di(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),zs(di(r.prototype),"disablePlugin",this).call(this)}},{key:"onModifyRowHeader",value:function(n){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(n))}},{key:"destroy",value:function(){zs(di(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Uw}},{key:"PLUGIN_PRIORITY",get:function(){return PTe}}]),r}(at);function nu(t){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nu(t)}function zI(t){return HTe(t)||ITe(t)||jTe(t)||ATe()}function ATe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jTe(t,e){if(t){if(typeof t=="string")return c1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c1(t,e)}}function ITe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function HTe(t){if(Array.isArray(t))return c1(t)}function c1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function DTe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q2(n.key),n)}}function NTe(t,e,r){return e&&YI(t.prototype,e),r&&YI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ta(){return typeof Reflect<"u"&&Reflect.get?ta=Reflect.get.bind():ta=function(t,e,r){var n=LTe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ta.apply(this,arguments)}function LTe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=fo(t),t!==null););return t}function BTe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f1(t,e)}function f1(t,e){return f1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},f1(t,e)}function VTe(t){var e=WTe();return function(){var r=fo(t),n;if(e){var o=fo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FTe(this,n)}}function FTe(t,e){if(e&&(nu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return js(t)}function js(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WTe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fo(t){return fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fo(t)}function UTe(t,e,r){zTe(t,e),e.set(t,r)}function zTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zw(t,e,r){return e=Q2(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q2(t){var e=YTe(t,"string");return nu(e)==="symbol"?e:String(e)}function YTe(t,e){if(nu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GI(t,e){var r=J2(t,e,"get");return GTe(t,r)}function GTe(t,e){return e.get?e.get.call(t):e.value}function Yw(t,e,r){var n=J2(t,e,"set");return $Te(t,n,r),r}function J2(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function $Te(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Gw="collapsibleColumns",KTe=290,qTe=["nestedHeaders"],fs="collapsibleIndicator",$I=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),hs=new WeakMap,XTe=function(t){BTe(r,t);var e=VTe(r);function r(){var n;DTe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),zw(js(n),"nestedHeadersPlugin",null),zw(js(n),"eventManager",new Tt(js(n))),zw(js(n),"headerStateManager",null),UTe(js(n),hs,{writable:!0,value:null}),n}return NTe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Gw]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o.nestedHeaders;i||lt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Yw(this,hs,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",function(){return n.onInit()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("afterGetColHeader",function(){return n.onAfterGetColHeader.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(a,s,l){return n.onBeforeOnCellMouseDown(a,s,l)}),ta(fo(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){var n=this.hot.getSettings(),o=n.collapsibleColumns;typeof o=="boolean"?this.headerStateManager.mapState(function(i){return{collapsible:i.origColspan>1}}):Array.isArray(o)&&(this.headerStateManager.mapState(function(){return{collapsible:!1}}),this.headerStateManager.mergeStateWith(o))}ta(fo(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Yw(this,hs,null),this.nestedHeadersPlugin=null,this.clearButtons(),ta(fo(r.prototype),"disablePlugin",this).call(this)}},{key:"clearButtons",value:function(){if(this.hot.view){var n=this.hot.view._wt.getSetting("columnHeaders").length,o=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,a=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(l){l&&l.parentNode.removeChild(l)};Oe(0,n-1,function(l){var u=o.childNodes[l],c=i.childNodes[l],f=a?a.childNodes[l]:null;Oe(0,u.childNodes.length-1,function(h){var p=u.childNodes[h].querySelector(".".concat(fs));s(p),c&&c.childNodes[h]&&(p=c.childNodes[h].querySelector(".".concat(fs)),s(p)),a&&f&&f.childNodes[h]&&(p=f.childNodes[h].querySelector(".".concat(fs)),s(p))})})}}},{key:"expandSection",value:function(n){this.toggleCollapsibleSection([n],"expand")}},{key:"collapseSection",value:function(n){this.toggleCollapsibleSection([n],"collapse")}},{key:"toggleAllCollapsibleSections",value:function(n){var o=this,i=this.headerStateManager.mapNodes(function(a){var s=a.collapsible,l=a.origColspan,u=a.headerLevel,c=a.columnIndex,f=a.isCollapsed;if(s===!0&&l>1&&(f&&n==="expand"||!f&&n==="collapse"))return{row:o.headerStateManager.levelToRowCoords(u),col:c}});this.toggleCollapsibleSection(i,n)}},{key:"collapseAll",value:function(){this.toggleAllCollapsibleSections("collapse")}},{key:"expandAll",value:function(){this.toggleAllCollapsibleSections("expand")}},{key:"toggleCollapsibleSection",value:function(n,o){var i=this;if(!$I.has(o))throw new Error("Unsupported action is passed (".concat(o,")."));if(Array.isArray(n)){var a=Xn(n,function(g){var v=g.row;return v<0}),s=a.length>0;_(a,function(g){var v,S=g.row,O=g.col,w=(v=i.headerStateManager.getHeaderSettings(S,O))!==null&&v!==void 0?v:{},x=w.collapsible,T=w.isCollapsed;if(!x||T&&o==="collapse"||!T&&o==="expand")return s=!1,!1});var l=[],u=[];s&&_(a,function(g){var v=g.row,S=g.col,O=i.headerStateManager.triggerNodeModification(o,v,S),w=O.colspanCompensation,x=O.affectedColumns,T=O.rollbackModification;w>0&&(u.push.apply(u,zI(x)),l.push(T))});var c=this.getCollapsedColumns(),f=[];o==="collapse"?f=fF([].concat(zI(c),u)):o==="expand"&&(f=Xn(c,function(g){return!u.includes(g)}));var h=$I.get(o),p=this.hot.runHooks(h.beforeHook,c,f,s);if(p===!1){_(l,function(g){g()});return}this.hot.batchExecution(function(){_(u,function(g){GI(i,hs).setValueAtIndex(i.hot.toPhysicalColumn(g),h.hideColumn)})},!0);var y=this.getCollapsedColumns().length!==c.length;this.hot.runHooks(h.afterHook,c,f,s,y),this.hot.render(),this.hot.view.adjustElementsSize(!0)}}},{key:"getCollapsedColumns",value:function(){return GI(this,hs).getHiddenIndexes()}},{key:"onAfterGetColHeader",value:function(n,o,i){var a,s=(a=this.headerStateManager.getHeaderSettings(i,n))!==null&&a!==void 0?a:{},l=s.collapsible,u=s.origColspan,c=s.isCollapsed,f=l&&u>1&&n>=this.hot.getSettings().fixedColumnsStart,h=o.querySelector(".".concat(fs));if(f)h||(h=this.hot.rootDocument.createElement("div"),te(h,fs),o.querySelector("div:first-child").appendChild(h)),Ne(h,["collapsed","expanded"]),c?(te(h,"collapsed"),Pa(h,"+")):(te(h,"expanded"),Pa(h,"-"));else{var p;(p=h)===null||p===void 0||p.remove()}}},{key:"onBeforeOnCellMouseDown",value:function(n,o){Ae(n.target,fs)&&(Ae(n.target,"expanded")?(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([o],"collapse")):Ae(n.target,"collapsed")&&(this.eventManager.fireEvent(n.target,"mouseup"),this.toggleCollapsibleSection([o],"expand")),Lr(n))}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(n,o){o||this.updatePlugin()}},{key:"destroy",value:function(){Yw(this,hs,null),ta(fo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Gw}},{key:"PLUGIN_PRIORITY",get:function(){return KTe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:NestedHeaders"]}},{key:"SETTING_KEYS",get:function(){return[Gw].concat(qTe)}}]),r}(at);function zh(t){"@babel/helpers - typeof";return zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zh(t)}function KI(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function ZTe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KI(Object(r),!0).forEach(function(n){QTe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KI(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function QTe(t,e,r){return e=ez(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qI(t,e){return nPe(t)||tPe(t,e)||ePe(t,e)||JTe()}function JTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ePe(t,e){if(t){if(typeof t=="string")return XI(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XI(t,e)}}function XI(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tPe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function nPe(t){if(Array.isArray(t))return t}function rPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZI(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ez(n.key),n)}}function oPe(t,e,r){return e&&ZI(t.prototype,e),r&&ZI(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ez(t){var e=iPe(t,"string");return zh(e)==="symbol"?e:String(e)}function iPe(t,e){if(zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aPe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],sPe=!1,lPe=!0,uPe=!0,cPe=function(){function t(e,r){rPe(this,t),this.hot=e,this.sortingStates=new Pv,this.sortEmptyCells=sPe,this.indicator=lPe,this.headerAction=uPe,this.compareFunctionFactory=void 0,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}return oPe(t,[{key:"updateAllColumnsProperties",value:function(e){var r=this;Ge(e)&&$e(e,function(n,o){aPe.includes(o)&&(r[o]=n)})}},{key:"getAllColumnsProperties",value:function(){var e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}},{key:"getSortOrderOfColumn",value:function(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}},{key:"getIndexOfColumnInSortQueue",value:function(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(function(r){var n=qI(r,1),o=n[0];return o===e})}},{key:"getNumberOfSortedColumns",value:function(){return this.sortingStates.getLength()}},{key:"isListOfSortedColumnsEmpty",value:function(){return this.getNumberOfSortedColumns()===0}},{key:"isColumnSorted",value:function(e){return Ge(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}},{key:"getSortStates",value:function(){var e=this;if(this.sortingStates===null)return[];var r=this.sortingStates.getEntries();return r.map(function(n){var o=qI(n,2),i=o[0],a=o[1];return ZTe({column:e.hot.toVisualColumn(i)},a)})}},{key:"getColumnSortState",value:function(e){var r=this.getSortOrderOfColumn(e);if(pe(r))return{column:e,sortOrder:r}}},{key:"setSortStates",value:function(e){this.sortingStates.clear();for(var r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}]),t}(),Eg="asc",Tg="desc",fPe="colHeader";function hPe(t){if(Ge(t)===!1)return!1;var e=t.column,r=t.sortOrder;return Number.isInteger(e)&&[Eg,Tg].includes(r)}function dPe(t){if(t.some(function(r){return hPe(r)===!1}))return!1;var e=t.map(function(r){var n=r.column;return n});return new Set(e).size===e.length}function QI(t){if(t!==Tg)return t===Eg?Tg:Eg}function JI(t){var e=t.querySelector(".".concat(fPe));return e}function eH(t,e){if(t<0||!e.parentNode)return!1;var r=e.parentNode.parentNode.childNodes,n=Array.from(r).indexOf(e.parentNode)-r.length;return n===-1}function h1(t,e,r){return t===-1&&e>=0&&_a(r)===!1}var pPe="ascending",yPe="descending",tz="indicatorDisabled",nz="columnSorting",rz="sortAction",oz=new Map([[Eg,pPe],[Tg,yPe]]);function mPe(t,e,r,n){var o=[nz];if(n&&o.push(rz),r===!1)return o.push(tz),o;var i=t.getSortOrderOfColumn(e);return pe(i)&&o.push(oz.get(i)),o}function gPe(){return Array.from(oz.values()).concat(rz,tz,nz)}function iz(t,e,r){var n=e.locale;return function(o,i){var a=r.sortEmptyCells;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?Hr:Xt(o)?Xt(i)?Hr:a&&t==="asc"?Ut:zt:Xt(i)?a&&t==="asc"?zt:Ut:isNaN(o)&&!isNaN(i)?t==="asc"?zt:Ut:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?t==="asc"?Ut:zt:o>i?t==="asc"?zt:Ut:Hr}}var az="default";function vPe(t,e,r){return function(n,o){var i=parseFloat(n),a=parseFloat(o),s=r.sortEmptyCells;if(i===a||isNaN(i)&&isNaN(a))return Hr;if(s){if(Xt(n))return t==="asc"?Ut:zt;if(Xt(o))return t==="asc"?zt:Ut}return isNaN(i)?zt:isNaN(a)?Ut:i<a?t==="asc"?Ut:zt:i>a?t==="asc"?zt:Ut:Hr}}var bPe="numeric";function wPe(t,e,r){var n=e.checkedTemplate,o=e.uncheckedTemplate,i=r.sortEmptyCells;return function(a,s){var l=Xt(a),u=Xt(s),c=l?o:a,f=u?o:s,h=c===o||c===n,p=f===o||f===n;if(i===!1){if(l&&u===!1)return zt;if(l===!1&&u)return Ut}return h===!1&&p?t==="asc"?Ut:zt:h&&p===!1?t==="asc"?zt:Ut:h===!1&&p===!1?iz(t,e,r)(a,s):c===o&&f===n?t==="asc"?Ut:zt:c===n&&f===o?t==="asc"?zt:Ut:Hr}}var SPe="checkbox";function CPe(t,e,r){return function(n,o){var i=r.sortEmptyCells;if(n===o)return Hr;if(Xt(n))return Xt(o)?Hr:i&&t==="asc"?Ut:zt;if(Xt(o))return i&&t==="asc"?zt:Ut;var a=e.dateFormat,s=J(n,a),l=J(o,a);return s.isValid()?l.isValid()?l.isAfter(s)?t==="asc"?Ut:zt:l.isBefore(s)?t==="asc"?zt:Ut:Hr:Ut:zt}}var OPe="date",mT=nr("sorting.compareFunctionFactory"),Kv=mT.register,tH=mT.getItem,kPe=mT.hasItem,sz=nr("sorting.mainSortComparator"),lz=sz.register,RPe=sz.getItem;function uz(t){return kPe(t)?tH(t):tH(az)}Kv(bPe,vPe);Kv(SPe,wPe);Kv(OPe,CPe);Kv(az,iz);var Hr=0,Ut=-1,zt=1;function EPe(t,e){for(var r=RPe(e),n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];t.sort(r.apply(void 0,o))}function nH(t){return _Pe(t)||MPe(t)||PPe(t)||TPe()}function TPe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PPe(t,e){if(t){if(typeof t=="string")return rH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rH(t,e)}}function rH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function MPe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _Pe(t){if(Array.isArray(t))return t}function xPe(t,e){return function(r,n){var o=nH(r),i=o.slice(1),a=nH(n),s=a.slice(1);return function(l){var u=t[l],c=e[l],f=i[l],h=s[l],p=c.columnSorting,y=p.compareFunctionFactory?p.compareFunctionFactory:uz(c.type),g=y(u,c,p)(f,h);return g}(0)}}function ru(t){"@babel/helpers - typeof";return ru=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ru(t)}var APe=["column"],jPe=["column"];function ds(t){return NPe(t)||DPe(t)||HPe(t)||IPe()}function IPe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HPe(t,e){if(t){if(typeof t=="string")return d1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d1(t,e)}}function DPe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function NPe(t){if(Array.isArray(t))return d1(t)}function d1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function oH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function iH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oH(Object(r),!0).forEach(function(n){LPe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function LPe(t,e,r){return e=cz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aH(t,e){if(t==null)return{};var r=BPe(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function BPe(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function VPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cz(n.key),n)}}function FPe(t,e,r){return e&&sH(t.prototype,e),r&&sH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cz(t){var e=WPe(t,"string");return ru(e)==="symbol"?e:String(e)}function WPe(t,e){if(ru(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ru(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function na(){return typeof Reflect<"u"&&Reflect.get?na=Reflect.get.bind():na=function(t,e,r){var n=UPe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},na.apply(this,arguments)}function UPe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ho(t),t!==null););return t}function zPe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p1(t,e)}function p1(t,e){return p1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},p1(t,e)}function YPe(t){var e=KPe();return function(){var r=ho(t),n;if(e){var o=ho(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GPe(this,n)}}function GPe(t,e){if(e&&(ru(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Pe(t)}function $Pe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KPe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ho(t){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ho(t)}var y1="columnSorting",qPe=50,lH="append",XPe="replace";lz(y1,xPe);ye.getSingleton().register("beforeColumnSort");ye.getSingleton().register("afterColumnSort");var fz=function(t){zPe(r,t);var e=YPe(r);function r(n){var o;return VPe(this,r),o=e.call(this,n),o.columnStatesManager=null,o.columnMetaCache=null,o.pluginKey=y1,o.indexesSequenceCache=null,o}return FPe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[this.pluginKey]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.columnStatesManager=new cPe(this.hot,"".concat(this.pluginKey,".sortingStates")),this.columnMetaCache=new Ti(function(o){var i=n.hot.toVisualColumn(o);return i===null&&(i=o),n.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap("".concat(this.pluginKey,".columnMeta"),this.columnMetaCache),this.addHook("afterGetColHeader",function(o,i){return n.onAfterGetColHeader(o,i)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("afterOnCellMouseDown",function(o,i){return n.onAfterOnCellMouseDown(o,i)}),this.addHook("afterInit",function(){return n.loadOrSortBySettings()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.hot.view&&this.loadOrSortBySettings(),na(ho(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=this,o=function(i,a){var s=JI(a);eH(i,a)===!1||s===null||n.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",o),this.hot.addHookOnce("afterViewRender",function(){n.hot.removeHook("afterGetColHeader",o)}),this.hot.batchExecution(function(){n.indexesSequenceCache!==null&&(n.hot.rowIndexMapper.setIndexesSequence(n.indexesSequenceCache.getValues()),n.hot.rowIndexMapper.unregisterMap(n.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap("".concat(this.pluginKey,".columnMeta")),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,na(ho(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(n){var o=this.getSortConfig(),i=this.getNormalizedSortConfigs(n),a=this.areValidSortConfigs(i),s=this.hot.runHooks("beforeColumnSort",o,i,a);s!==!1&&(o.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new UU),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),a&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",o,a?i:o,a),a&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}},{key:"clearSort",value:function(){this.sort([])}},{key:"isSorted",value:function(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}},{key:"getSortConfig",value:function(n){return pe(n)?this.columnStatesManager.getColumnSortState(n):this.columnStatesManager.getSortStates()}},{key:"setSortConfig",value:function(n){var o=this.getNormalizedSortConfigs(n);this.areValidSortConfigs(o)&&this.columnStatesManager.setSortStates(o)}},{key:"getNormalizedSortConfigs",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(n)?n.slice(0,1):[n]}},{key:"areValidSortConfigs",value:function(n){var o=this.hot.countCols();return dPe(n)&&n.every(function(i){var a=i.column;return a<=o&&a>=0})}},{key:"saveAllSortSettings",value:function(n){var o=this,i=this.columnStatesManager.getAllColumnsProperties(),a=function(s){var l=s.column,u=aH(s,APe);return iH({column:o.hot.toPhysicalColumn(l)},u)};i.initialConfig=Ye(n,a),this.hot.runHooks("persistentStateSave","columnSorting",i)}},{key:"getAllSavedSortSettings",value:function(){var n=this,o={};this.hot.runHooks("persistentStateLoad","columnSorting",o);var i=o.value,a=function(s){var l=s.column,u=aH(s,jPe);return iH({column:n.hot.toVisualColumn(l)},u)};return pe(i)&&Array.isArray(i.initialConfig)&&(i.initialConfig=Ye(i.initialConfig,a)),i}},{key:"getColumnNextConfig",value:function(n){var o=this.columnStatesManager.getSortOrderOfColumn(n);if(pe(o)){var i=QI(o);return pe(i)?{column:n,sortOrder:i}:void 0}var a=this.hot.countCols();if(Number.isInteger(n)&&n>=0&&n<a)return{column:n,sortOrder:QI()}}},{key:"getNextSortConfig",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lH,i=this.columnStatesManager.getIndexOfColumnInSortQueue(n),a=i!==-1,s=this.getSortConfig(),l=this.getColumnNextConfig(n);if(a){if(dt(l))return[].concat(ds(s.slice(0,i)),ds(s.slice(i+1)));if(o===lH)return[].concat(ds(s.slice(0,i)),ds(s.slice(i+1)),[l]);if(o===XPe)return[].concat(ds(s.slice(0,i)),[l],ds(s.slice(i+1)))}return pe(l)?s.concat(l):s}},{key:"getPluginColumnConfig",value:function(n){if(Ge(n)){var o=n[this.pluginKey];if(Ge(o))return o}return{}}},{key:"getMergedPluginSettings",value:function(n){var o=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),a=this.hot.getCellMeta(0,n),s=Object.getPrototypeOf(a);return Array.isArray(s.columns)?Object.assign(i,o,this.getPluginColumnConfig(s.columns[n])):yt(s.columns)?Object.assign(i,o,this.getPluginColumnConfig(s.columns(n))):Object.assign(i,o)}},{key:"getFirstCellSettings",value:function(n){var o=this.hot.getCellMeta(0,n),i=Object.create(o);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(n)),i}},{key:"getNumberOfRowsToSort",value:function(n){var o=this.hot.getSettings();return o.maxRows<=n?o.maxRows:n-o.minSpareRows}},{key:"sortByPresetSortStates",value:function(n){var o=this;if(n.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}for(var i=[],a=this.hot.countRows(),s=function(y){return Ye(n,function(g){return o.hot.getDataAtCell(y,g.column)})},l=0;l<this.getNumberOfRowsToSort(a);l+=1)i.push([this.hot.toPhysicalRow(l)].concat(s(l)));var u=Ye(i,function(y){return y[0]});EPe(i,this.pluginKey,Ye(n,function(y){return y.sortOrder}),Ye(n,function(y){return o.getFirstCellSettings(y.column)}));for(var c=i.length;c<a;c+=1)i.push([c].concat(s(c)));var f=Ye(i,function(y){return y[0]}),h=new Map(Ye(u,function(y,g){return[y,f[g]]})),p=Ye(this.hot.rowIndexMapper.getIndexesSequence(),function(y){return h.has(y)?h.get(y):y});this.hot.rowIndexMapper.setIndexesSequence(p)}},{key:"loadOrSortBySettings",value:function(){var n=this.getAllSavedSortSettings();if(Ge(n))this.sortBySettings(n);else{var o=this.hot.getSettings()[this.pluginKey];this.sortBySettings(o)}}},{key:"sortBySettings",value:function(n){if(Ge(n)){this.columnStatesManager.updateAllColumnsProperties(n);var o=n.initialConfig;(Array.isArray(o)||Ge(o))&&this.sort(o)}else this.hot.render()}},{key:"onAfterGetColHeader",value:function(n,o){var i=JI(o);if(!(eH(n,o)===!1||i===null)){var a=this.getFirstCellSettings(n)[this.pluginKey],s=a.indicator,l=a.headerAction;this.updateHeaderClasses(i,this.columnStatesManager,n,s,l)}}},{key:"updateHeaderClasses",value:function(n){if(Ne(n,gPe()),this.enabled!==!1){for(var o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];te(n,mPe.apply(void 0,i))}}},{key:"onUpdateSettings",value:function(n){na(ho(r.prototype),"onUpdateSettings",this).call(this),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),pe(n[this.pluginKey])&&this.sortBySettings(n[this.pluginKey])}},{key:"onAfterLoadData",value:function(n){n===!0&&this.hot.view&&this.loadOrSortBySettings()}},{key:"wasClickableHeaderClicked",value:function(n,o){var i=this.getFirstCellSettings(o)[this.pluginKey],a=i.headerAction;return a&&n.target.nodeName==="SPAN"}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){h1(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(n,o){h1(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(o.col)),this.sort(this.getColumnNextConfig(o.col)))}},{key:"destroy",value:function(){var n;(n=this.columnStatesManager)===null||n===void 0||n.destroy(),na(ho(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return y1}},{key:"PLUGIN_PRIORITY",get:function(){return qPe}}]),r}(at),ZPe=_e,gT=We,QPe=Ri,JPe=_V,eMe=Nk,uH=Fe,tMe=RangeError,hz=String,dz=Math.floor,m1=gT(eMe),cH=gT("".slice),Vc=gT(1 .toFixed),Ns=function(t,e,r){return e===0?r:e%2===1?Ns(t,e-1,r*t):Ns(t*t,e/2,r)},nMe=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e},ps=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=dz(o/1e7)},$w=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=dz(n/e),n=n%e*1e7},fH=function(t){for(var e=6,r="";--e>=0;)if(r!==""||e===0||t[e]!==0){var n=hz(t[e]);r=r===""?n:r+m1("0",7-n.length)+n}return r},rMe=uH(function(){return Vc(8e-5,3)!=="0.000"||Vc(.9,0)!=="1"||Vc(1.255,2)!=="1.25"||Vc(0xde0b6b3a7640080,0)!=="1000000000000000128"})||!uH(function(){Vc({})});ZPe({target:"Number",proto:!0,forced:rMe},{toFixed:function(t){var e=JPe(this),r=QPe(t),n=[0,0,0,0,0,0],o="",i="0",a,s,l,u;if(r<0||r>20)throw tMe("Incorrect fraction digits");if(e!=e)return"NaN";if(e<=-1e21||e>=1e21)return hz(e);if(e<0&&(o="-",e=-e),e>1e-21)if(a=nMe(e*Ns(2,69,1))-69,s=a<0?e*Ns(2,-a,1):e/Ns(2,a,1),s*=4503599627370496,a=52-a,a>0){for(ps(n,0,s),l=r;l>=7;)ps(n,1e7,0),l-=7;for(ps(n,Ns(10,l,1),0),l=a-1;l>=23;)$w(n,1<<23),l-=23;$w(n,1<<l),ps(n,1,1),$w(n,2),i=fH(n)}else ps(n,0,s),ps(n,1<<-a,0),i=fH(n)+m1("0",r);return r>0?(u=i.length,i=o+(u<=r?"0."+m1("0",r-u)+i:cH(i,0,u-r)+"."+cH(i,u-r))):i=o+i,i}});function Yh(t){"@babel/helpers - typeof";return Yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yh(t)}function oMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aMe(n.key),n)}}function iMe(t,e,r){return e&&hH(t.prototype,e),r&&hH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aMe(t){var e=sMe(t,"string");return Yh(e)==="symbol"?e:String(e)}function sMe(t,e){if(Yh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lMe=function(){function t(e,r){oMe(this,t),this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=r,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}return iMe(t,[{key:"getEndpoint",value:function(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}},{key:"getAllEndpoints",value:function(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}},{key:"fillMissingEndpointData",value:function(e){return this.parseSettings(e.call(this))}},{key:"parseSettings",value:function(e){var r=this,n=[],o=e;if(!o&&typeof this.settings=="function"){this.settingsType="function";return}return o||(o=this.settings),_(o,function(i){var a={};r.assignSetting(i,a,"ranges",[[0,r.hot.countRows()-1]]),r.assignSetting(i,a,"reversedRowCoords",!1),r.assignSetting(i,a,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),r.assignSetting(i,a,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),r.assignSetting(i,a,"sourceColumn",i.destinationColumn),r.assignSetting(i,a,"type","sum"),r.assignSetting(i,a,"forceNumeric",!1),r.assignSetting(i,a,"suppressDataTypeErrors",!0),r.assignSetting(i,a,"suppressDataTypeErrors",!0),r.assignSetting(i,a,"customFunction",null),r.assignSetting(i,a,"readOnly",!0),r.assignSetting(i,a,"roundFloat",!1),n.push(a)}),n}},{key:"assignSetting",value:function(e,r,n,o){if(n==="ranges"&&e[n]===void 0){r[n]=o;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(o instanceof Error)throw o;r[n]=o}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}},{key:"resetSetupBeforeStructureAlteration",value:function(e,r,n){if(this.settingsType==="function"){var o=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();_(i,function(a){o==="row"&&a.destinationRow>=r&&(e==="insert_row"?a.alterRowOffset=n:e==="remove_row"&&(a.alterRowOffset=-1*n)),o==="col"&&a.destinationColumn>=r&&(e==="insert_col"?a.alterColumnOffset=n:e==="remove_col"&&(a.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}}},{key:"resetSetupAfterStructureAlteration",value:function(e,r,n,o,i){var a=this,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){var l=function y(){return a.hot.removeHook("beforeViewRender",y),a.refreshAllEndpoints()};this.hot.addHookOnce("beforeViewRender",l);return}var u=e.indexOf("row")>-1?"row":"col",c=e.indexOf("remove")>-1?-1:1,f=this.getAllEndpoints(),h=e.indexOf("move_row")===0,p=r;_(f,function(y){u==="row"&&y.destinationRow>=p&&(y.alterRowOffset=c*n),u==="col"&&y.destinationColumn>=p&&(y.alterColumnOffset=c*n)}),this.resetAllEndpoints(f,!h),h?_(f,function(y){a.extendEndpointRanges(y,p,o[0],o.length),a.recreatePhysicalRanges(y),a.clearOffsetInformation(y)}):_(f,function(y){a.shiftEndpointCoordinates(y,p)}),s&&this.refreshAllEndpoints()}},{key:"clearOffsetInformation",value:function(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"extendEndpointRanges",value:function(e,r,n,o){_(e.ranges,function(i){i[1]&&(r>=i[0]&&r<=i[1]?n>i[1]?i[1]+=o:n<i[0]&&(i[0]-=o):n>=i[0]&&n<=i[1]&&(i[1]-=o,r<=i[0]&&(i[0]+=1,i[1]+=1)))})}},{key:"recreatePhysicalRanges",value:function(e){var r=this,n=e.ranges,o=[],i=[];_(n,function(a){var s=[];if(a[1])for(var l=a[0];l<=a[1];l++)s.push(r.hot.toPhysicalRow(l));else s.push(r.hot.toPhysicalRow(a[0]));i.push(s)}),_(i,function(a){var s=[];_(a,function(l,u){u===0?s.push(l):a[u]!==a[u-1]+1&&(s.push(a[u-1]),o.push(s),s=[],s.push(l)),u===a.length-1&&(s.push(l),o.push(s))})}),e.ranges=o}},{key:"shiftEndpointCoordinates",value:function(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,_(e.ranges,function(n){_(n,function(o,i){o>=r&&(n[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}},{key:"resetAllEndpoints",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=r.some(function(i){var a=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+a>=e.hot.countRows()||i.destinationColumn+s>=e.hot.countCols()});o||(this.cellsToSetCache=[],_(r,function(i){e.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}},{key:"refreshAllEndpoints",value:function(){var e=this;this.cellsToSetCache=[],_(this.getAllEndpoints(),function(r){e.currentEndpoint=r,e.plugin.calculate(r),e.setEndpointValue(r,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshChangedEndpoints",value:function(e){var r=this,n=[];this.cellsToSetCache=[],_(e,function(o,i,a){"".concat(o[2]||"")!=="".concat(o[3])&&_(r.getAllEndpoints(),function(s,l){r.hot.propToCol(a[i][1])===s.sourceColumn&&n.indexOf(l)===-1&&n.push(l)})}),_(n,function(o){r.refreshEndpoint(r.getEndpoint(o))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}},{key:"refreshEndpoint",value:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}},{key:"resetEndpointValue",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?o:0)),""])}},{key:"setEndpointValue",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}var i=this.hot.toVisualRow(e.destinationRow);if(i!==null){var a=this.hot.getCellMeta(i,e.destinationColumn);(r==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}},{key:"throwOutOfBoundsWarning",value:function(){lt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}]),t}();const uMe=lMe;function Kw(t){return t==null||isNaN(t)}function ou(t){"@babel/helpers - typeof";return ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ou(t)}var dH;function cMe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function fMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dMe(n.key),n)}}function hMe(t,e,r){return e&&pH(t.prototype,e),r&&pH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dMe(t){var e=pMe(t,"string");return ou(e)==="symbol"?e:String(e)}function pMe(t,e){if(ou(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function um(){return typeof Reflect<"u"&&Reflect.get?um=Reflect.get.bind():um=function(t,e,r){var n=yMe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},um.apply(this,arguments)}function yMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=iu(t),t!==null););return t}function mMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g1(t,e)}function g1(t,e){return g1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},g1(t,e)}function gMe(t){var e=wMe();return function(){var r=iu(t),n;if(e){var o=iu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vMe(this,n)}}function vMe(t,e){if(e&&(ou(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bMe(t)}function bMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function iu(t){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},iu(t)}var qw="columnSummary",SMe=220,CMe=function(t){mMe(r,t);var e=gMe(r);function r(n){var o;return fMe(this,r),o=e.call(this,n),o.endpoints=null,o}return hMe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[qw]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.settings=this.hot.getSettings()[qw],this.endpoints=new uMe(this,this.settings),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeCreateRow",function(o,i,a){return n.endpoints.resetSetupBeforeStructureAlteration("insert_row",o,i,null,a)}),this.addHook("beforeCreateCol",function(o,i,a){return n.endpoints.resetSetupBeforeStructureAlteration("insert_col",o,i,null,a)}),this.addHook("beforeRemoveRow",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("beforeRemoveCol",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupBeforeStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterCreateRow",function(o,i,a){return n.endpoints.resetSetupAfterStructureAlteration("insert_row",o,i,null,a)}),this.addHook("afterCreateCol",function(o,i,a){return n.endpoints.resetSetupAfterStructureAlteration("insert_col",o,i,null,a)}),this.addHook("afterRemoveRow",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_row"].concat(a))}),this.addHook("afterRemoveCol",function(){for(var o,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(o=n.endpoints).resetSetupAfterStructureAlteration.apply(o,["remove_col"].concat(a))}),this.addHook("afterRowMove",function(){return n.onAfterRowMove.apply(n,arguments)}),um(iu(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}},{key:"calculate",value:function(n){switch(n.type.toLowerCase()){case"sum":n.result=this.calculateSum(n);break;case"min":n.result=this.calculateMinMax(n,n.type);break;case"max":n.result=this.calculateMinMax(n,n.type);break;case"count":n.result=this.countEntries(n);break;case"average":n.result=this.calculateAverage(n);break;case"custom":n.result=n.customFunction.call(this,n);break}}},{key:"calculateSum",value:function(n){var o=this,i=0;return $e(n.ranges,function(a){i+=o.getPartialSum(a,n.sourceColumn)}),i}},{key:"getPartialSum",value:function(n,o){var i=0,a=n[1]||n[0],s=null,l=0;do{if(s=this.getCellValue(a,o),s=Kw(s)?null:s,s!==null){var u=("".concat(s).split(".")[1]||[]).length||1;u>l&&(l=u)}i+=s||0,a-=1}while(a>=n[0]);return Math.round(i*Math.pow(10,l))/Math.pow(10,l)}},{key:"calculateMinMax",value:function(n,o){var i=this,a=null;return $e(n.ranges,function(s){var l=i.getPartialMinMax(s,n.sourceColumn,o);if(a===null&&l!==null&&(a=l),l!==null)switch(o){case"min":a=Math.min(a,l);break;case"max":a=Math.max(a,l);break}}),a===null?"Not enough data":a}},{key:"getPartialMinMax",value:function(n,o,i){var a=null,s=n[1]||n[0],l;do{if(l=this.getCellValue(s,o),l=Kw(l)?null:l,a===null)a=l;else if(l!==null)switch(i){case"min":a=Math.min(a,l);break;case"max":a=Math.max(a,l);break}s-=1}while(s>=n[0]);return a}},{key:"countEmpty",value:function(n,o){var i,a=0,s=n[1]||n[0];do i=this.getCellValue(s,o),i=Kw(i)?null:i,i===null&&(a+=1),s-=1;while(s>=n[0]);return a}},{key:"countEntries",value:function(n){var o=this,i=0,a=n.ranges;return $e(a,function(s){var l=s[1]===void 0?1:s[1]-s[0]+1,u=o.countEmpty(s,n.sourceColumn);i+=l,i-=u}),i}},{key:"calculateAverage",value:function(n){var o=this.calculateSum(n),i=this.countEntries(n);return o/i}},{key:"getCellValue",value:function(n,o){var i=this.hot.toVisualRow(n),a=this.hot.toVisualColumn(o),s=this.hot.getSourceDataAtCell(n,o),l="";if(i!==null&&a!==null&&(l=this.hot.getCellMeta(i,a).className||""),l.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(it(dH||(dH=cMe(["ColumnSummary plugin: cell at (",", ",`) is not in a 
          numeric format. Cannot do the calculation.`],["ColumnSummary plugin: cell at (",", ",`) is not in a\\x20
          numeric format. Cannot do the calculation.`])),n,o));return s}},{key:"onAfterInit",value:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}},{key:"onAfterChange",value:function(n,o){n&&o!=="ColumnSummary.reset"&&o!=="ColumnSummary.set"&&o!=="loadData"&&this.endpoints.refreshChangedEndpoints(n)}},{key:"onAfterRowMove",value:function(n,o){this.endpoints.resetSetupBeforeStructureAlteration("move_row",n[0],n.length,n,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",o,n.length,n,this.pluginName)}}],[{key:"PLUGIN_KEY",get:function(){return qw}},{key:"PLUGIN_PRIORITY",get:function(){return SMe}}]),r}(at);function Gh(t){"@babel/helpers - typeof";return Gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gh(t)}function OMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RMe(n.key),n)}}function kMe(t,e,r){return e&&yH(t.prototype,e),r&&yH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RMe(t){var e=EMe(t,"string");return Gh(e)==="symbol"?e:String(e)}function EMe(t,e){if(Gh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Gh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TMe=function(){function t(e,r){OMe(this,t),this.rootDocument=e,this.isRtl=r,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}return kMe(t,[{key:"setPosition",value:function(e,r){this.editorStyle.left="".concat(e,"px"),this.editorStyle.top="".concat(r,"px")}},{key:"setSize",value:function(e,r){if(e&&r){var n=this.getInputElement();n.style.width="".concat(e,"px"),n.style.height="".concat(r,"px")}}},{key:"getSize",value:function(){return{width:ut(this.getInputElement()),height:Rt(this.getInputElement())}}},{key:"resetSize",value:function(){var e=this.getInputElement();e.style.width="",e.style.height=""}},{key:"setReadOnlyState",value:function(e){var r=this.getInputElement();r.readOnly=e}},{key:"show",value:function(){this.editorStyle.display="block",this.hidden=!1}},{key:"hide",value:function(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}},{key:"isVisible",value:function(){return this.editorStyle.display==="block"}},{key:"setValue",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=e||"";this.getInputElement().value=r}},{key:"getValue",value:function(){return this.getInputElement().value}},{key:"isFocused",value:function(){return this.rootDocument.activeElement===this.getInputElement()}},{key:"focus",value:function(){this.getInputElement().focus()}},{key:"createEditor",value:function(){var e=this.rootDocument.createElement("div"),r=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),te(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),te(e,t.CLASS_EDITOR),te(r,t.CLASS_INPUT),e.appendChild(r),this.container.appendChild(e),e}},{key:"getInputElement",value:function(){return this.editor.querySelector(".".concat(t.CLASS_INPUT))}},{key:"destroy",value:function(){var e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}],[{key:"CLASS_EDITOR_CONTAINER",get:function(){return"htCommentsContainer"}},{key:"CLASS_EDITOR",get:function(){return"htComments"}},{key:"CLASS_INPUT",get:function(){return"htCommentTextArea"}},{key:"CLASS_CELL",get:function(){return"htCommentCell"}}]),t}();const PMe=TMe;var ze="---------";function MMe(){return{name:ze}}function _Me(t){return Ye(t,function(e){return{start:e.getTopStartCorner(),end:e.getBottomEndCorner()}})}function ay(t){return Ae(t,"htSeparator")}function xMe(t){return Ae(t,"htSubmenu")}function sy(t){return Ae(t,"htDisabled")}function ly(t){return Ae(t,"htSelectionDisabled")}function Qa(t){var e=t.getSelected();return!e||e[0]<0?null:e}function AMe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return"".concat(r," ").concat(e)}function jMe(t,e){if(t.indexOf(e)!==-1)return t;var r=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return"".concat(r," ").concat(e)}function Bi(t,e){var r={};return _(t,function(n){n.forAll(function(o,i){o>=0&&i>=0&&(r[o]||(r[o]=[]),r[o][i]=e(o,i))})}),r}function ti(t,e,r,n,o){_(t,function(i){i.forAll(function(a,s){a>=0&&s>=0&&IMe(a,s,e,r,n,o)})})}function IMe(t,e,r,n,o,i){var a=o(t,e),s=n;a.className&&(r==="vertical"?s=AMe(a.className,n):s=jMe(a.className,n)),i(t,e,"className",s)}function xr(t,e){var r=!1;return Array.isArray(t)&&_(t,function(n){return n.forAll(function(o,i){if(o>=0&&i>=0&&e(o,i))return r=!0,!1}),r}),r}function ro(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function HMe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function pz(t,e){for(var r=t.slice(0),n=0;n<r.length&&r[n].name===e;)r.shift();return r}function DMe(t,e){var r=t.slice(0);return r.reverse(),r=pz(r,e),r.reverse(),r}function NMe(t){var e=[];return _(t,function(r,n){n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function LMe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,r=t.slice(0);return r=pz(r,e),r=DMe(r,e),r=NMe(r),r}function $h(t){"@babel/helpers - typeof";return $h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$h(t)}function BMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function mH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FMe(n.key),n)}}function VMe(t,e,r){return e&&mH(t.prototype,e),r&&mH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FMe(t){var e=WMe(t,"string");return $h(e)==="symbol"?e:String(e)}function WMe(t,e){if($h(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($h(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UMe=250,zMe=250,yz=function(){function t(e){BMe(this,t),this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}return VMe(t,[{key:"hide",value:function(){var e=this;this.wasLastActionShow=!1,this.hidingTimer=setTimeout(function(){e.wasLastActionShow===!1&&e.runLocalHooks("hide")},zMe)}},{key:"show",value:function(e){this.wasLastActionShow=!0,this.showDebounced(e)}},{key:"cancelHiding",value:function(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}},{key:"updateDelay",value:function(){var e=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:UMe;this.showDebounced=yW(function(n){e.wasLastActionShow&&e.runLocalHooks("show",n.from.row,n.from.col)},r)}},{key:"destroy",value:function(){this.clearLocalHooks()}}]),t}();pt(yz,Pn);const YMe=yz;function au(t){"@babel/helpers - typeof";return au=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},au(t)}function Xw(t,e,r){return e=mz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mz(n.key),n)}}function $Me(t,e,r){return e&&gH(t.prototype,e),r&&gH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mz(t){var e=KMe(t,"string");return au(e)==="symbol"?e:String(e)}function KMe(t,e){if(au(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(au(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ra(){return typeof Reflect<"u"&&Reflect.get?ra=Reflect.get.bind():ra=function(t,e,r){var n=qMe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ra.apply(this,arguments)}function qMe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=po(t),t!==null););return t}function XMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v1(t,e)}function v1(t,e){return v1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},v1(t,e)}function ZMe(t){var e=JMe();return function(){var r=po(t),n;if(e){var o=po(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QMe(this,n)}}function QMe(t,e){if(e&&(au(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gz(t)}function gz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function po(t){return po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},po(t)}var Zw="comments",e_e=60,uy=new WeakMap,Or="comment",ys="value",vH="style",cy="readOnly",t_e=function(t){XMe(r,t);var e=ZMe(r);function r(n){var o;return GMe(this,r),o=e.call(this,n),o.editor=null,o.displaySwitch=null,o.eventManager=null,o.range={},o.preventEditorAutoSwitch=!1,uy.set(gz(o),{tempEditorDimensions:{},cellBelowCursor:null}),o}return $Me(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Zw]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.editor||(this.editor=new PMe(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new Tt(this)),this.displaySwitch||(this.displaySwitch=new YMe(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",function(o){return n.addToContextMenu(o)}),this.addHook("afterRenderer",function(o,i,a,s,l,u){return n.onAfterRenderer(o,u)}),this.addHook("afterScrollHorizontally",function(){return n.hide()}),this.addHook("afterScrollVertically",function(){return n.hide()}),this.addHook("afterBeginEditing",function(){return n.hide()}),this.displaySwitch.addLocalHook("hide",function(){return n.hide()}),this.displaySwitch.addLocalHook("show",function(o,i){return n.showAtCell(o,i)}),this.registerListeners(),ra(po(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ra(po(r.prototype),"updatePlugin",this).call(this),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}},{key:"disablePlugin",value:function(){ra(po(r.prototype),"disablePlugin",this).call(this)}},{key:"registerListeners",value:function(){var n=this,o=this.hot.rootDocument;this.eventManager.addEventListener(o,"mouseover",function(i){return n.onMouseOver(i)}),this.eventManager.addEventListener(o,"mousedown",function(i){return n.onMouseDown(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(){return n.onEditorBlur()}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(i){return n.onEditorMouseDown(i)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(i){return n.onEditorMouseUp(i)})}},{key:"setRange",value:function(n){this.range=n}},{key:"clearRange",value:function(){this.range={}}},{key:"targetIsCellWithComment",value:function(n){var o=Ra(n.target,"TD","TBODY");return!!(o&&Ae(o,"htCommentCell")&&Ra(o,[this.hot.rootElement]))}},{key:"targetIsCommentTextArea",value:function(n){return this.editor.getInputElement()===n.target}},{key:"setComment",value:function(n){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var o=this.editor.getValue(),i="";n!=null?i=n:o!=null&&(i=o);var a=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(a,s,Xw({},ys,i)),this.hot.render()}},{key:"setCommentAtCell",value:function(n,o,i){this.setRange({from:this.hot._createCellCoords(n,o)}),this.setComment(i)}},{key:"removeComment",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Or),n&&this.hot.render(),this.hide()}},{key:"removeCommentAtCell",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(n,o)}),this.removeComment(i)}},{key:"getComment",value:function(){var n=this.range.from.row,o=this.range.from.col;return this.getCommentMeta(n,o,ys)}},{key:"getCommentAtCell",value:function(n,o){return this.getCommentMeta(n,o,ys)}},{key:"show",value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.range.from,o=n.row,i=n.col;if(o<0||o>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;var a=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(a[Or]?a[Or][ys]:""),this.editor.show(),this.refreshEditor(!0),!0}},{key:"showAtCell",value:function(n,o){return this.setRange({from:this.hot._createCellCoords(n,o)}),this.show()}},{key:"hide",value:function(){this.editor.hide()}},{key:"refreshEditor",value:function(){var n,o,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!i&&(!this.range.from||!this.editor.isVisible()))){var a=this.hot,s=a.rowIndexMapper,l=a.columnIndexMapper,u=this.range.from,c=u.row,f=u.col,h=s.getRenderableFromVisualIndex(c),p=l.getRenderableFromVisualIndex(f),y=h===null;this.editor.setPosition(0,0),h===null&&(h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(c,-1))),p===null&&(p=l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,-1)));var g=h===null,v=p===null;h=(n=h)!==null&&n!==void 0?n:0,p=(o=p)!==null&&o!==void 0?o:0;var S=this.hot,O=S.rootWindow,w=S.view._wt,x=w.wtTable,T=w.getCell({row:h,col:p},!0),z=this.getCommentMeta(c,f,vH);z?this.editor.setSize(z.width,z.height):this.editor.resetSize();var $=v?0:x.getStretchedColumnWidth(p),ne=y&&!g?Rt(T):0,G=T.getBoundingClientRect(),q=G.left,Z=G.top,ee=G.width,Q=G.height,ce=this.editor.getSize(),fe=ce.width,we=ce.height,Se=this.hot.rootWindow,P=Se.innerWidth,d=Se.innerHeight,m=this.hot.rootDocument.documentElement,b=q+O.scrollX+$,k=Z+O.scrollY+ne;this.hot.isRtl()&&(b-=fe+$),this.hot.isLtr()&&q+ee+fe>P?b=q+O.scrollX-fe-1:this.hot.isRtl()&&b<-(m.scrollWidth-m.clientWidth)&&(b=q+O.scrollX+$+1),Z+we>d&&(k-=we-Q+1),this.editor.setPosition(b,k),this.editor.setReadOnlyState(this.getCommentMeta(c,f,cy))}}},{key:"checkSelectionCommentsConsistency",value:function(){var n=this.hot.getSelectedRangeLast();if(!n)return!1;var o=!1,i=n.getTopStartCorner();return this.getCommentMeta(i.row,i.col,ys)&&(o=!0),o}},{key:"updateCommentMeta",value:function(n,o,i){var a=this.hot.getCellMeta(n,o)[Or],s;a?(s=yn(a),cv(s,i)):s=i,this.hot.setCellMeta(n,o,Or,s)}},{key:"getCommentMeta",value:function(n,o,i){var a=this.hot.getCellMeta(n,o);if(a[Or])return a[Or][i]}},{key:"onMouseDown",value:function(n){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(n)){var o=Ra(n.target,"TD","TBODY"),i=null;o&&(i=this.hot.getCoords(o)),(!o||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}},{key:"onMouseOver",value:function(n){var o=uy.get(this),i=this.hot.rootDocument;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Ae(n.target,"wtBorder")||o.cellBelowCursor===n.target||!this.editor))if(o.cellBelowCursor=i.elementFromPoint(n.clientX,n.clientY),this.targetIsCellWithComment(n)){var a=this.hot._createCellRange(this.hot.getCoords(n.target));this.displaySwitch.show(a)}else Ea(n.target,i)&&!this.targetIsCommentTextArea(n)&&this.displaySwitch.hide()}},{key:"onMouseUp",value:function(){this.preventEditorAutoSwitch=!1}},{key:"onAfterRenderer",value:function(n,o){o[Or]&&o[Or][ys]&&te(n,o.commentedCellClassName)}},{key:"onEditorBlur",value:function(){this.setComment()}},{key:"onEditorMouseDown",value:function(n){var o=uy.get(this);o.tempEditorDimensions={width:ut(n.target),height:Rt(n.target)}}},{key:"onEditorMouseUp",value:function(n){var o=uy.get(this),i=ut(n.target),a=Rt(n.target);(i!==o.tempEditorDimensions.width+1||a!==o.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,Xw({},vH,{width:i,height:a}))}},{key:"onContextMenuAddComment",value:function(){var n=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:n.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}},{key:"onContextMenuRemoveComment",value:function(){var n=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(i,a){i>=0&&a>=0&&n.removeCommentAtCell(i,a,!1)}),this.hot.render()}},{key:"onContextMenuMakeReadOnly",value:function(){var n=this,o=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,o.forAll(function(i,a){if(i>=0&&a>=0){var s=!!n.getCommentMeta(i,a,cy);n.updateCommentMeta(i,a,Xw({},cy,!s))}})}},{key:"addToContextMenu",value:function(n){var o=this,i=function(){return o.hot.rowIndexMapper.getRenderableIndexesLength()>0&&o.hot.columnIndexMapper.getRenderableIndexesLength()>0};n.items.push({name:"---------"},{key:"commentsAddEdit",name:function(){return o.checkSelectionCommentsConsistency()?o.hot.getTranslatedPhrase(ZR):o.hot.getTranslatedPhrase(XR)},callback:function(){return o.onContextMenuAddComment()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsRemove",name:function(){return this.getTranslatedPhrase(QR)},callback:function(){return o.onContextMenuRemoveComment()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner()):!0}},{key:"commentsReadOnly",name:function(){var a=this,s=this.getTranslatedPhrase(JR),l=xr(this.getSelectedRangeLast(),function(u,c){var f=a.getCellMeta(u,c)[Or];if(f&&(f=f[cy]),f)return!0});return l&&(s=ro(s)),s},callback:function(){return o.onContextMenuMakeReadOnly()},disabled:function(){return i()?!(o.hot.getSelectedLast()&&!o.hot.selection.isSelectedByCorner())||!o.checkSelectionCommentsConsistency():!0}})}},{key:"getDisplayDelaySetting",value:function(){var n=this.hot.getSettings()[Zw];if(Ge(n))return n.displayDelay}},{key:"destroy",value:function(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),ra(po(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Zw}},{key:"PLUGIN_PRIORITY",get:function(){return e_e}}]),r}(at);function Kh(t){"@babel/helpers - typeof";return Kh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kh(t)}function n_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o_e(n.key),n)}}function r_e(t,e,r){return e&&bH(t.prototype,e),r&&bH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o_e(t){var e=i_e(t,"string");return Kh(e)==="symbol"?e:String(e)}function i_e(t,e){if(Kh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Kh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var a_e=function(){function t(e){n_e(this,t),this.hot=e,this.commands={},this.commonCallback=null}return r_e(t,[{key:"registerCommand",value:function(e,r){this.commands[e]=r}},{key:"setCommonCallback",value:function(e){this.commonCallback=e}},{key:"execute",value:function(e){for(var r=this,n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=e.split(":"),s=a[0],l=a.length===2?a[1]:null,u=this.commands[s];if(!u)throw new Error("Menu command '".concat(s,"' not exists."));if(l&&u.submenu&&(u=s_e(l,u.submenu.items)),u.disabled!==!0&&!(typeof u.disabled=="function"&&u.disabled.call(this.hot)===!0)&&!xt(u,"submenu")){var c=[];typeof u.callback=="function"&&c.push(u.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),o.unshift(a.join(":")),_(c,function(f){return f.apply(r.hot,o)})}}}]),t}();function s_e(t,e){var r;return _(e,function(n){var o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===t)return r=n,!1}),r}const vz=a_e;var $n="alignment";function l_e(){return{key:$n,name:function(){return this.getTranslatedPhrase(eE)},disabled:function(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:"".concat($n,":left"),name:function(){var t=this,e=this.getTranslatedPhrase(tE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htLeft")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat($n,":center"),name:function(){var t=this,e=this.getTranslatedPhrase(nE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htCenter")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat($n,":right"),name:function(){var t=this,e=this.getTranslatedPhrase(rE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htRight")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="horizontal",o="htRight";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat($n,":justify"),name:function(){var t=this,e=this.getTranslatedPhrase(oE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htJustify")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{name:ze},{key:"".concat($n,":top"),name:function(){var t=this,e=this.getTranslatedPhrase(iE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htTop")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="vertical",o="htTop";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat($n,":middle"),name:function(){var t=this,e=this.getTranslatedPhrase(aE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htMiddle")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1},{key:"".concat($n,":bottom"),name:function(){var t=this,e=this.getTranslatedPhrase(sE),r=xr(this.getSelectedRange(),function(n,o){var i=t.getCellMeta(n,o).className;if(i&&i.indexOf("htBottom")!==-1)return!0});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=Bi(e,function(i,a){return t.getCellMeta(i,a).className}),n="vertical",o="htBottom";this.runHooks("beforeCellAlignment",r,e,n,o),ti(e,n,o,function(i,a){return t.getCellMeta(i,a)},function(i,a,s,l){return t.setCellMeta(i,a,s,l)}),this.render()},disabled:!1}]}}}var qv="clear_column";function u_e(){return{key:qv,name:function(){return this.getTranslatedPhrase(VR)},callback:function(t,e){var r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled:function(){var t=Qa(this);return t?!this.selection.isSelectedByColumnHeader():!0}}}var mp="col_left";function c_e(){return{key:mp,name:function(){return this.getTranslatedPhrase(jR)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countCols();return e===0}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden:function(){return!this.getSettings().allowInsertColumn}}}var gp="col_right";function f_e(){return{key:gp,name:function(){return this.getTranslatedPhrase(IR)},callback:function(){var t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols:!0},hidden:function(){return!this.getSettings().allowInsertColumn}}}var vp="make_read_only";function h_e(){return{key:vp,name:function(){var t=this,e=this.getTranslatedPhrase(BR),r=xr(this.getSelectedRange(),function(n,o){return t.getCellMeta(n,o).readOnly});return r&&(e=ro(e)),e},callback:function(){var t=this,e=this.getSelectedRange(),r=xr(e,function(n,o){return t.getCellMeta(n,o).readOnly});_(e,function(n){n.forAll(function(o,i){o>=0&&i>=0&&t.setCellMeta(o,i,"readOnly",!r)})}),this.render()},disabled:function(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Xv="redo";function d_e(){return{key:Xv,name:function(){return this.getTranslatedPhrase(LR)},callback:function(){this.redo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}function p_e(t,e){return v_e(t)||g_e(t,e)||m_e(t,e)||y_e()}function y_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m_e(t,e){if(t){if(typeof t=="string")return wH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wH(t,e)}}function wH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function g_e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function v_e(t){if(Array.isArray(t))return t}var bp="remove_col";function b_e(){return{key:bp,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var r=p_e(t[0],4),n=r[1],o=r[3];n-o!==0&&(e=1)}return this.getTranslatedPhrase(DR,e)},callback:function(){this.alter("remove_col",jwe(this.getSelected()),null,"ContextMenu.removeColumn")},disabled:function(){if(!this.isColumnModificationAllowed())return!0;var t=Qa(this);if(!t)return!0;var e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden:function(){return!this.getSettings().allowRemoveColumn}}}function w_e(t,e){return k_e(t)||O_e(t,e)||C_e(t,e)||S_e()}function S_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C_e(t,e){if(t){if(typeof t=="string")return SH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SH(t,e)}}function SH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function O_e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function k_e(t){if(Array.isArray(t))return t}var Zv="remove_row";function R_e(){return{key:Zv,name:function(){var t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{var r=w_e(t[0],3),n=r[0],o=r[2];n-o!==0&&(e=1)}return this.getTranslatedPhrase(HR,e)},callback:function(){this.alter("remove_row",Iwe(this.getSelected()),1,"ContextMenu.removeRow")},disabled:function(){var t=Qa(this);if(!t)return!0;var e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden:function(){return!this.getSettings().allowRemoveRow}}}var Qv="row_above";function E_e(){return{key:Qv,name:function(){return this.getTranslatedPhrase(xR)},callback:function(){var t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled:function(){var t=Qa(this);if(!t)return!0;if(this.selection.isSelectedByCorner()){var e=this.countRows();return e===0}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}var Jv="row_below";function T_e(){return{key:Jv,name:function(){return this.getTranslatedPhrase(AR)},callback:function(){var t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled:function(){var t=Qa(this);return t?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden:function(){return!this.getSettings().allowInsertRow}}}var qh="no_items";function P_e(){return{key:qh,name:function(){return this.getTranslatedPhrase(_R)},disabled:!0,isCommand:!1}}var eb="undo";function M_e(){return{key:eb,name:function(){return this.getTranslatedPhrase(NR)},callback:function(){this.undo()},hidden:function(){var t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled:function(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}function Xh(t){"@babel/helpers - typeof";return Xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xh(t)}var cn;function _n(t,e,r){return e=__e(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function __e(t){var e=x_e(t,"string");return Xh(e)==="symbol"?e:String(e)}function x_e(t,e){if(Xh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A_e=[Qv,Jv,mp,gp,qv,Zv,bp,eb,Xv,vp,$n,ze,qh],j_e=(cn={},_n(cn,ze,MMe),_n(cn,qh,P_e),_n(cn,Qv,E_e),_n(cn,Jv,T_e),_n(cn,mp,c_e),_n(cn,gp,f_e),_n(cn,qv,u_e),_n(cn,Zv,R_e),_n(cn,bp,b_e),_n(cn,eb,M_e),_n(cn,Xv,d_e),_n(cn,vp,h_e),_n(cn,$n,l_e),cn);function bz(){var t={};return $e(j_e,function(e,r){t[r]=e()}),t}function Zh(t){"@babel/helpers - typeof";return Zh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zh(t)}function I_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,D_e(n.key),n)}}function H_e(t,e,r){return e&&CH(t.prototype,e),r&&CH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function D_e(t){var e=N_e(t,"string");return Zh(e)==="symbol"?e:String(e)}function N_e(t,e){if(Zh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var L_e=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;I_e(this,t),this.hot=e,this.predefinedItems=bz(),this.defaultOrderPattern=r}return H_e(t,[{key:"setPredefinedItems",value:function(e){var r=this,n={};this.defaultOrderPattern.length=0,$e(e,function(o,i){var a="";o.name===ze?(n[ze]=o,a=ze):isNaN(parseInt(i,10))?(o.key=o.key===void 0?i:o.key,n[i]=o,a=o.key):(n[o.key]=o,a=o.key),r.defaultOrderPattern.push(a)}),this.predefinedItems=n}},{key:"getItems",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return B_e(e,this.defaultOrderPattern,this.predefinedItems)}}]),t}();function B_e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=[],o=t;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),Ge(o)?$e(o,function(i,a){var s=r[typeof i=="string"?i:a];s||(s=i),Ge(i)?Yt(s,i):typeof s=="string"&&(s={name:s}),s.key===void 0&&(s.key=a),n.push(s)}):_(o,function(i,a){var s=r[i];!s&&A_e.indexOf(i)>=0||(s||(s={name:i,key:"".concat(a)}),Ge(i)&&Yt(s,i),s.key===void 0&&(s.key=a),n.push(s))}),n}const wz=L_e;function Qh(t){"@babel/helpers - typeof";return Qh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qh(t)}function V_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W_e(n.key),n)}}function F_e(t,e,r){return e&&OH(t.prototype,e),r&&OH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function W_e(t){var e=U_e(t,"string");return Qh(e)==="symbol"?e:String(e)}function U_e(t,e){if(Qh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z_e=function(){function t(e,r){V_e(this,t);var n=xf(r),o=nl(r),i,a,s,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(i=parseInt(e.top,10),s=parseInt(e.left,10),u=e.height||0,c=e.width||0,a=i,l=s,i+=n,s+=o):this.type==="event"&&(i=parseInt(e.pageY,10),s=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,a=i-n,l=s-o),this.top=i,this.topRelative=a,this.left=s,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}return F_e(t,[{key:"getSourceType",value:function(e){var r="literal";return e instanceof Event&&(r="event"),r}},{key:"fitsAbove",value:function(e){return this.topRelative>=e.offsetHeight}},{key:"fitsBelow",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}},{key:"fitsOnRight",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}}]),t}();const Y_e=z_e;function Jh(t){"@babel/helpers - typeof";return Jh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jh(t)}function kH(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function RH(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kH(Object(r),!0).forEach(function(n){G_e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kH(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function G_e(t,e,r){return e=Sz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sz(n.key),n)}}function K_e(t,e,r){return e&&EH(t.prototype,e),r&&EH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Sz(t){var e=q_e(t,"string");return Jh(e)==="symbol"?e:String(e)}function q_e(t,e){if(Jh(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Jh(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TH=215,Cz="menu",X_e=Cz,Oz=function(){function t(e,r){$_e(this,t),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:TH,container:this.hot.rootDocument.documentElement},this.eventManager=new Tt(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}return K_e(t,[{key:"registerEvents",value:function(){for(var e=this,r=this.hot.rootWindow;r;)this.eventManager.addEventListener(r.document,"mousedown",function(n){return e.onDocumentMouseDown(n)}),this.eventManager.addEventListener(r.document,"contextmenu",function(n){return e.onDocumentContextMenu(n)}),r=Nm(r)}},{key:"setMenuItems",value:function(e){this.menuItems=e}},{key:"getSelectedItem",value:function(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}},{key:"hasSelectedItem",value:function(){return Array.isArray(this.hotMenu.getSelectedLast())}},{key:"setOffset",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=r}},{key:"isSubMenu",value:function(){return this.parentMenu!==null}},{key:"open",value:function(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";var r=yW(function(h){return e.openSubMenu(h)},300),n=this.options.minWidth||TH,o=!1,i=Xn(this.menuItems,function(h){return h.key===qh&&(o=!0),HMe(h,e.hot)});if(i.length<1&&!o)i.push(bz()[qh]);else if(i.length===0)return;i=LMe(i,ze);var a=!1,s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:function(h){return pe(h)&&h<n?n:h},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:function(h,p,y,g,v,S){return e.menuItemRenderer(h,p,y,g,v,S)}}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:function(h,p){e.isAllSubMenusClosed()?r(p.row):e.openSubMenu(p.row)},rowHeights:function(h){return i[h].name===ze?1:23},afterOnCellContextMenu:function(h){h.preventDefault(),w_()&&a&&e.hasSelectedItem()&&e.close(!0)},beforeOnCellMouseUp:function(h){e.hasSelectedItem()&&(a=!e.isCommandPassive(e.getSelectedItem()),e.executeCommand(h))},afterOnCellMouseUp:function(h){(!w_()||!_a(h))&&a&&e.hasSelectedItem()&&(Ir()||pF()?setTimeout(function(){return e.close(!0)},325):e.close(!0))},afterUnlisten:function(){!e.hasSelectedItem()&&e.isOpened()&&e.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new JE(this.container,s),this.hotMenu.addHook("afterInit",function(){return e.onAfterInit()}),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection.apply(e,arguments)}),this.hotMenu.init(),this.hotMenu.listen();var l=this.hotMenu.getShortcutManager(),u=l.addContext(X_e),c={group:Cz},f=RH(RH({},c),{},{runOnlyIf:function(h){return Vm(h.target)===!1||e.container.contains(h.target)===!1}});l.setActiveContextName("menu"),u.addShortcuts([{keys:[["Escape"]],callback:function(){e.keyEvent=!0,e.close(),e.keyEvent=!1}},{keys:[["ArrowDown"]],callback:function(){var h=e.hotMenu.getSelectedLast();e.keyEvent=!0,h?e.selectNextCell(h[0],h[1]):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["ArrowUp"]],callback:function(){var h=e.hotMenu.getSelectedLast();e.keyEvent=!0,h?e.selectPrevCell(h[0],h[1]):e.selectLastCell(),e.keyEvent=!1}},{keys:[["ArrowRight"]],callback:function(){var h=e.hotMenu.getSelectedLast();if(e.keyEvent=!0,h){var p=e.openSubMenu(h[0]);p&&p.selectFirstCell()}e.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:function(){var h=e.hotMenu.getSelectedLast();e.keyEvent=!0,h&&e.isSubMenu()&&(e.close(),e.parentMenu&&e.parentMenu.hotMenu.listen()),e.keyEvent=!1}},{keys:[["Enter"]],callback:function(h){var p=e.hotMenu.getSelectedLast();e.keyEvent=!0,e.hotMenu.getSourceDataAtRow(p[0]).submenu||(e.executeCommand(h),e.close(!0)),e.keyEvent=!1}},{keys:[["PageUp"]],callback:function(){var h=e.hotMenu.getSelectedLast();e.keyEvent=!0,h?e.hotMenu.selection.transformStart(-e.hotMenu.countVisibleRows(),0):e.selectFirstCell(),e.keyEvent=!1}},{keys:[["PageDown"]],callback:function(){var h=e.hotMenu.getSelectedLast();e.keyEvent=!0,h?e.hotMenu.selection.transformStart(e.hotMenu.countVisibleRows(),0):e.selectLastCell(),e.keyEvent=!1}}],f),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}},{key:"close",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}},{key:"openSubMenu",value:function(e){if(!this.hotMenu)return!1;var r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!xMe(r))return!1;var n=this.hotMenu.getSourceDataAtRow(e),o=new t(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=o,o}},{key:"closeSubMenu",value:function(e){var r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];n&&(n.destroy(),delete this.hotSubMenus[r.key])}},{key:"closeAllSubMenus",value:function(){var e=this;_(this.hotMenu.getData(),function(r,n){return e.closeSubMenu(n)})}},{key:"isAllSubMenusClosed",value:function(){return Object.keys(this.hotSubMenus).length===0}},{key:"destroy",value:function(){var e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}},{key:"isOpened",value:function(){return this.hotMenu!==null}},{key:"executeCommand",value:function(e){if(!(!this.isOpened()||!this.hasSelectedItem())){var r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),!this.isCommandPassive(r)){var n=this.hot.getSelectedRange(),o=n?_Me(n):[];this.runLocalHooks("executeCommand",r.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,o,e)}}}},{key:"isCommandPassive",value:function(e){var r=e.isCommand,n=e.name,o=e.disabled,i=e.submenu,a=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return r===!1||n===ze||a===!0||i}},{key:"setPosition",value:function(e){var r=new Y_e(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(r.fitsBelow(this.container)?this.setPositionBelowCursor(r):r.fitsAbove(this.container)?this.setPositionAboveCursor(r):this.setPositionBelowCursor(r),this.hot.isLtr()?this.setHorizontalPositionForLtr(r):this.setHorizontalPositionForRtl(r)):(this.setPositionBelowCursor(r),this.setPositionOnRightOfCursor(r))}},{key:"setHorizontalPositionForRtl",value:function(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}},{key:"setHorizontalPositionForLtr",value:function(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}},{key:"setPositionAboveCursor",value:function(e){var r=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(r=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top="".concat(r,"px")}},{key:"setPositionBelowCursor",value:function(e){var r=this.offset.below+e.top+1;this.isSubMenu()&&(r=e.top-1),this.container.style.top="".concat(r,"px")}},{key:"setPositionOnRightOfCursor",value:function(e){var r=e.left;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),o=n.right;r+=e.cellWidth+o-(e.left+e.cellWidth)}else r+=this.offset.right;this.container.style.left="".concat(r,"px")}},{key:"setPositionOnLeftOfCursor",value:function(e){var r=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){var n=this.parentMenu.container.getBoundingClientRect(),o=n.left;r-=e.left-o}this.container.style.left="".concat(r,"px")}},{key:"selectFirstCell",value:function(){var e=this.hotMenu.getCell(0,0);ay(e)||sy(e)||ly(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}},{key:"selectLastCell",value:function(){var e=this.hotMenu.countRows()-1,r=this.hotMenu.getCell(e,0);ay(r)||sy(r)||ly(r)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}},{key:"selectNextCell",value:function(e,r){var n=e+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,r):null;o&&(ay(o)||sy(o)||ly(o)?this.selectNextCell(n,r):this.hotMenu.selectCell(n,r))}},{key:"selectPrevCell",value:function(e,r){var n=e-1,o=n>=0?this.hotMenu.getCell(n,r):null;o&&(ay(o)||sy(o)||ly(o)?this.selectPrevCell(n,r):this.hotMenu.selectCell(n,r))}},{key:"menuItemRenderer",value:function(e,r,n,o,i,a){var s=this,l=e.getSourceDataAtRow(n),u=this.hot.rootDocument.createElement("div"),c=function(g){return xt(g,"submenu")},f=function(g){return new RegExp(ze,"i").test(g.name)},h=function(g){return g.disabled===!0||typeof g.disabled=="function"&&g.disabled.call(s.hot)===!0},p=function(g){return g.disableSelection},y=a;typeof y=="function"&&(y=y.call(this.hot)),Nr(r),te(u,"htItemWrapper"),r.appendChild(u),f(l)?te(r,"htSeparator"):typeof l.renderer=="function"?(te(r,"htCustomMenuRenderer"),r.appendChild(l.renderer(e,u,n,o,i,y))):dc(u,y),h(l)?(te(r,"htDisabled"),this.eventManager.addEventListener(r,"mouseenter",function(){return e.deselectCell()})):p(l)?(te(r,"htSelectionDisabled"),this.eventManager.addEventListener(r,"mouseenter",function(){return e.deselectCell()})):c(l)?(te(r,"htSubmenu"),p(l)?this.eventManager.addEventListener(r,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(r,"mouseenter",function(){return e.selectCell(n,o,void 0,void 0,!1,!1)})):(Ne(r,["htSubmenu","htDisabled"]),p(l)?this.eventManager.addEventListener(r,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(r,"mouseenter",function(){return e.selectCell(n,o,void 0,void 0,!1,!1)}))}},{key:"createContainer",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=this.options.container.ownerDocument,n=e,o;return n&&(yt(n)&&(n=n.call(this.hot),n===null||dt(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n="".concat(this.options.className,"Sub_").concat(n),o=r.querySelector(".".concat(this.options.className,".").concat(n))),o||(o=r.createElement("div"),te(o,"htMenu ".concat(this.options.className)),n&&te(o,n),this.options.container.appendChild(o)),o}},{key:"blockMainTableCallbacks",value:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}},{key:"releaseMainTableCallbacks",value:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}},{key:"onAfterInit",value:function(){var e=this.hotMenu.view._wt.wtTable,r=this.hotMenu.getSettings().data,n=e.hider.style,o=e.holder.style,i=parseInt(n.width,10),a=an(r,function(s,l){return s+(l.name===ze?1:26)},0);o.width="".concat(i+3,"px"),o.height="".concat(a+3,"px"),n.height=o.height}},{key:"onAfterSelection",value:function(e,r,n,o,i){this.keyEvent===!1&&(i.value=!0)}},{key:"onDocumentMouseDown",value:function(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ea(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ea(e.target,".htMenu")&&this.close(!0))}},{key:"onDocumentContextMenu",value:function(e){this.isOpened()&&Ae(e.target,"htCore")&&Ea(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}]),t}();pt(Oz,Pn);const vT=Oz;function su(t){"@babel/helpers - typeof";return su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},su(t)}function Z_e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,J_e(n.key),n)}}function Q_e(t,e,r){return e&&PH(t.prototype,e),r&&PH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function J_e(t){var e=exe(t,"string");return su(e)==="symbol"?e:String(e)}function exe(t,e){if(su(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oa(){return typeof Reflect<"u"&&Reflect.get?oa=Reflect.get.bind():oa=function(t,e,r){var n=txe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},oa.apply(this,arguments)}function txe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=yo(t),t!==null););return t}function nxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b1(t,e)}function b1(t,e){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},b1(t,e)}function rxe(t){var e=ixe();return function(){var r=yo(t),n;if(e){var o=yo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oxe(this,n)}}function oxe(t,e){if(e&&(su(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kz(t)}function kz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ixe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function yo(t){return yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yo(t)}var fy="contextMenu",axe=70;ye.getSingleton().register("afterContextMenuDefaultOptions");ye.getSingleton().register("beforeContextMenuShow");ye.getSingleton().register("afterContextMenuShow");ye.getSingleton().register("afterContextMenuHide");ye.getSingleton().register("afterContextMenuExecute");var Rz=function(t){nxe(r,t);var e=rxe(r);function r(n){var o;return Z_e(this,r),o=e.call(this,n),o.eventManager=new Tt(kz(o)),o.commandExecutor=new vz(o.hot),o.itemsFactory=null,o.menu=null,o}return Q_e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[fy]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[fy];typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),this.menu=new vT(this.hot,{className:"htContextMenu",keepInViewport:!0,container:o.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",function(){return n.onMenuBeforeOpen()}),this.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()}),this.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()}),this.menu.addLocalHook("executeCommand",function(){for(var i,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return(i=n.executeCommand).call.apply(i,[n].concat(s))}),this.addHook("afterOnCellContextMenu",function(i){return n.onAfterOnCellContextMenu(i)}),oa(yo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),oa(yo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),oa(yo(r.prototype),"disablePlugin",this).call(this)}},{key:"open",value:function(n){if(this.menu&&(this.prepareMenuItems(),this.menu.open(),!!this.menu.isOpened())){var o=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,s=a.getBoundingClientRect(),l=s.top,u=s.left;o=l-xf(n.view),i=u-nl(n.view)}else o=-1*xf(this.menu.hotMenu.rootWindow),i=-1*nl(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(n.pageY,10)+o,left:parseInt(n.pageX,10)+i})}}},{key:"close",value:function(){this.menu&&(this.menu.close(),this.itemsFactory=null)}},{key:"executeCommand",value:function(n){var o;this.itemsFactory===null&&this.prepareMenuItems();for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=this.commandExecutor).execute.apply(o,[n].concat(a))}},{key:"prepareMenuItems",value:function(){var n=this;this.itemsFactory=new wz(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[fy],i={items:this.itemsFactory.getItems(o)};this.hot.runHooks("afterContextMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);var a=this.itemsFactory.getItems(o);this.hot.runHooks("beforeContextMenuSetItems",a),this.menu.setMenuItems(a),_(a,function(s){return n.commandExecutor.registerCommand(s.key,s)})}},{key:"onAfterOnCellContextMenu",value:function(n){var o=this.hot.getSettings(),i=o.rowHeaders,a=o.colHeaders;function s(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}var l=n.target;this.close(),!Ae(l,"handsontableInput")&&(n.preventDefault(),n.stopPropagation(),!(!(i||a)&&!s(l)&&!(Ae(l,"current")&&Ae(l,"wtBorder")))&&this.open(n))}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeContextMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterContextMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),oa(yo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return fy}},{key:"PLUGIN_PRIORITY",get:function(){return axe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[Qv,Jv,ze,mp,gp,ze,Zv,bp,ze,eb,Xv,ze,vp,ze,$n]}}]),r}(at);Rz.SEPARATOR={name:ze};function sxe(t){return{key:"copy",name:function(){return this.getTranslatedPhrase(FR)},callback:function(){t.copyCellsOnly()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function lxe(t){return{key:"copy_column_headers_only",name:function(){var e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(zR,r)},callback:function(){t.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function uxe(t){return{key:"copy_with_column_group_headers",name:function(){var e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(UR,r)},callback:function(){t.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function cxe(t){return{key:"copy_with_column_headers",name:function(){var e=this.getSelectedRangeLast(),r=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(WR,r)},callback:function(){t.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function fxe(t){return{key:"cut",name:function(){return this.getTranslatedPhrase(YR)},callback:function(){t.cut()},disabled:function(){if(this.countRows()===0||this.countCols()===0)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}function ed(t){"@babel/helpers - typeof";return ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ed(t)}function hxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pxe(n.key),n)}}function dxe(t,e,r){return e&&MH(t.prototype,e),r&&MH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function pxe(t){var e=yxe(t,"string");return ed(e)==="symbol"?e:String(e)}function yxe(t,e){if(ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var mxe=function(){function t(){hxe(this,t),this.data={}}return dxe(t,[{key:"setData",value:function(e,r){this.data[e]=r}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),t}();function td(t){"@babel/helpers - typeof";return td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},td(t)}function _H(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vxe(n.key),n)}}function gxe(t,e,r){return e&&_H(t.prototype,e),r&&_H(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vxe(t){var e=bxe(t,"string");return td(e)==="symbol"?e:String(e)}function bxe(t,e){if(td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Sxe=gxe(function t(){wxe(this,t),this.clipboardData=new mxe});function nd(t){"@babel/helpers - typeof";return nd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nd(t)}function Cxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,kxe(n.key),n)}}function Oxe(t,e,r){return e&&xH(t.prototype,e),r&&xH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function kxe(t){var e=Rxe(t,"string");return nd(e)==="symbol"?e:String(e)}function Rxe(t,e){if(nd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bT=function(){function t(e){Cxe(this,t),this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new Tt(this),this.listenersCount=new WeakSet,this.container=e}return Oxe(t,[{key:"useSecondaryElement",value:function(){var e=Pxe(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),AH(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),AH(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",Ir()||iae(this.mainElement)}}]),t}();pt(bT,Pn);var Pg=new WeakMap;function Exe(t){var e=new bT(t),r=Pg.get(t);return r=isNaN(r)?0:r,Pg.set(t,r+1),e}function Txe(t){t.eventManager.clear()}var Qw=function(t,e){return function(r){return e.runLocalHooks(t,r)}};function AH(t,e,r){t.addEventListener(e,"copy",Qw("copy",r)),t.addEventListener(e,"cut",Qw("cut",r)),t.addEventListener(e,"paste",Qw("paste",r))}var Mg=new WeakMap;function Pxe(t){var e=Mg.get(t);if(e)return e.parentElement||t.appendChild(e),e;var r=t.defaultView?t:t.ownerDocument,n=r.createElement("textarea");return Mg.set(t,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",t.appendChild(n),n}function jH(t){if(t instanceof bT){var e=Pg.get(t.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),Txe(t),e<=0){e=0;var r=Mg.get(t.container);r&&r.parentNode&&(r.parentNode.removeChild(r),Mg.delete(t.container)),t.mainElement=null}Pg.set(t.container,e)}}function rd(t){"@babel/helpers - typeof";return rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rd(t)}function Mxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function IH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xxe(n.key),n)}}function _xe(t,e,r){return e&&IH(t.prototype,e),r&&IH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xxe(t){var e=Axe(t,"string");return rd(e)==="symbol"?e:String(e)}function Axe(t,e){if(rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HH(t,e){Ez(t,e),e.add(t)}function ms(t,e,r){Ez(t,e),e.set(t,r)}function Ez(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hy(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function dn(t,e){var r=Tz(t,e,"get");return jxe(t,r)}function jxe(t,e){return e.get?e.get.call(t):e.value}function gs(t,e,r){var n=Tz(t,e,"set");return Ixe(t,n,r),r}function Tz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Ixe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Ko=new WeakMap,Jw=new WeakMap,Fc=new WeakMap,w1=new WeakMap,S1=new WeakMap,Wc=new WeakMap,dy=new WeakSet,DH=new WeakSet,Hxe=function(){function t(e){var r=e.countRows,n=e.countColumns,o=e.rowsLimit,i=e.columnsLimit,a=e.countColumnHeaders;Mxe(this,t),HH(this,DH),HH(this,dy),ms(this,Ko,{writable:!0,value:void 0}),ms(this,Jw,{writable:!0,value:void 0}),ms(this,Fc,{writable:!0,value:void 0}),ms(this,w1,{writable:!0,value:void 0}),ms(this,S1,{writable:!0,value:void 0}),ms(this,Wc,{writable:!0,value:void 0}),gs(this,Jw,r),gs(this,Fc,n),gs(this,w1,o),gs(this,S1,i),gs(this,Wc,a)}return _xe(t,[{key:"setSelectedRange",value:function(e){gs(this,Ko,e)}},{key:"getCellsRange",value:function(){if(dn(this,Jw).call(this)===0||dn(this,Fc).call(this)===0)return null;var e=dn(this,Ko).getTopStartCorner(),r=e.row,n=e.col,o=dn(this,Ko).getBottomEndCorner(),i=o.row,a=o.col,s=hy(this,DH,Dxe).call(this,r,i),l=hy(this,dy,e0).call(this,n,a),u=i!==s||a!==l;return{isRangeTrimmed:u,startRow:r,startCol:n,endRow:s,endCol:l}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(dn(this,Fc).call(this)===0||dn(this,Wc).call(this)===0)return null;var e=dn(this,Ko).getTopStartCorner(),r=e.col,n=dn(this,Ko).getBottomEndCorner(),o=n.col,i=hy(this,dy,e0).call(this,r,o),a=o!==i;return{isRangeTrimmed:a,startRow:-1,startCol:r,endRow:-1,endCol:i}}},{key:"getAllColumnHeadersRange",value:function(){if(dn(this,Fc).call(this)===0||dn(this,Wc).call(this)===0)return null;var e=dn(this,Ko).getTopStartCorner(),r=e.col,n=dn(this,Ko).getBottomEndCorner(),o=n.col,i=hy(this,dy,e0).call(this,r,o),a=o!==i;return{isRangeTrimmed:a,startRow:-dn(this,Wc).call(this),startCol:r,endRow:-1,endCol:i}}}]),t}();function e0(t,e){return Math.min(e,Math.max(t+dn(this,S1).call(this)-1,t))}function Dxe(t,e){return Math.min(e,Math.max(t+dn(this,w1).call(this)-1,t))}function Pz(t){var e=[],r=[];return _(t,function(n){var o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);Oe(o,i,function(l){e.indexOf(l)===-1&&e.push(l)});var a=Math.min(n.startCol,n.endCol),s=Math.max(n.startCol,n.endCol);Oe(a,s,function(l){r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function Nxe(t,e){return Fxe(t)||Vxe(t,e)||Bxe(t,e)||Lxe()}function Lxe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bxe(t,e){if(t){if(typeof t=="string")return NH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NH(t,e)}}function NH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vxe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function Fxe(t){if(Array.isArray(t))return t}function Va(t){"@babel/helpers - typeof";return Va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Va(t)}function Wxe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_z(n.key),n)}}function Uxe(t,e,r){return e&&LH(t.prototype,e),r&&LH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ia(){return typeof Reflect<"u"&&Reflect.get?ia=Reflect.get.bind():ia=function(t,e,r){var n=zxe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ia.apply(this,arguments)}function zxe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=mo(t),t!==null););return t}function Yxe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C1(t,e)}function C1(t,e){return C1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},C1(t,e)}function Gxe(t){var e=Kxe();return function(){var r=mo(t),n;if(e){var o=mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return $xe(this,n)}}function $xe(t,e){if(e&&(Va(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hn(t)}function hn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Kxe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mo(t){return mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mo(t)}function qxe(t,e){Mz(t,e),e.add(t)}function Vi(t,e,r){Mz(t,e),e.set(t,r)}function Mz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e,r){return e=_z(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _z(t){var e=Xxe(t,"string");return Va(e)==="symbol"?e:String(e)}function Xxe(t,e){if(Va(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Va(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zxe(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}function xn(t,e){var r=xz(t,e,"get");return Qxe(t,r)}function Qxe(t,e){return e.get?e.get.call(t):e.value}function Kr(t,e,r){var n=xz(t,e,"set");return Jxe(t,n,r),r}function xz(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Jxe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}ye.getSingleton().register("afterCopyLimit");ye.getSingleton().register("modifyCopyableRange");ye.getSingleton().register("beforeCut");ye.getSingleton().register("afterCut");ye.getSingleton().register("beforePaste");ye.getSingleton().register("afterPaste");ye.getSingleton().register("beforeCopy");ye.getSingleton().register("afterCopy");var py="copyPaste",eAe=80,tAe=["fragmentSelection"],BH=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),t0=new WeakMap,n0=new WeakMap,r0=new WeakMap,bs=new WeakMap,yy=new WeakMap,my=new WeakMap,ws=new WeakMap,VH=new WeakSet,nAe=function(t){Yxe(r,t);var e=Gxe(r);function r(){var n;Wxe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),qxe(hn(n),VH),vs(hn(n),"columnsLimit",1/0),vs(hn(n),"rowsLimit",1/0),vs(hn(n),"pasteMode","overwrite"),vs(hn(n),"uiContainer",n.hot.rootDocument.body),Vi(hn(n),t0,{writable:!0,value:!1}),Vi(hn(n),n0,{writable:!0,value:!1}),Vi(hn(n),r0,{writable:!0,value:!1}),Vi(hn(n),bs,{writable:!0,value:"cells-only"}),Vi(hn(n),yy,{writable:!0,value:!1}),Vi(hn(n),my,{writable:!0,value:!1}),Vi(hn(n),ws,{writable:!0,value:new Hxe({countRows:function(){return n.hot.countRows()},countColumns:function(){return n.hot.countCols()},rowsLimit:function(){return n.rowsLimit},columnsLimit:function(){return n.columnsLimit},countColumnHeaders:function(){return n.hot.view.getColumnHeadersCount()}})}),vs(hn(n),"copyableRanges",[]),vs(hn(n),"focusableElement",void 0),n}return Uxe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[py]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o[py];if(Va(i)==="object"){var a,s;this.pasteMode=(a=i.pasteMode)!==null&&a!==void 0?a:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,Kr(this,t0,!!i.copyColumnHeaders),Kr(this,n0,!!i.copyColumnGroupHeaders),Kr(this,r0,!!i.copyColumnHeadersOnly),this.uiContainer=(s=i.uiContainer)!==null&&s!==void 0?s:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",function(l){return n.onAfterContextMenuDefaultOptions(l)}),this.addHook("afterOnCellMouseUp",function(){return n.onAfterOnCellMouseUp()}),this.addHook("afterSelectionEnd",function(){return n.onAfterSelectionEnd()}),this.addHook("beforeKeyDown",function(){return n.onBeforeKeyDown()}),this.focusableElement=Exe(this.uiContainer),this.focusableElement.addLocalHook("copy",function(l){return n.onCopy(l)}).addLocalHook("cut",function(l){return n.onCut(l)}).addLocalHook("paste",function(l){return n.onPaste(l)}),ia(mo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),ia(mo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&jH(this.focusableElement),ia(mo(r.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Kr(this,bs,n),Kr(this,yy,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){Kr(this,my,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(n){return yf(this.getRangedData(n))}},{key:"getRangedData",value:function(n){var o=this,i=[],a=Pz(n),s=a.rows,l=a.columns;return _(s,function(u){var c=[];_(l,function(f){u<0?c.push(o.hot.getColHeader(f,u)):c.push(o.hot.getCopyableData(u,f))}),i.push(c)}),i}},{key:"paste",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n;if(!(!n&&!o)){var i=new Sxe;n&&i.clipboardData.setData("text/plain",n),o&&i.clipboardData.setData("text/html",o),this.getOrCreateFocusableElement(),this.onPaste(i)}}},{key:"setCopyableText",value:function(){var n=this.hot.getSelectedRangeLast();if(n){xn(this,ws).setSelectedRange(n);var o=new Map([["headers",null],["cells",null]]);xn(this,bs)==="column-headers-only"?o.set("headers",xn(this,ws).getMostBottomColumnHeadersRange()):(xn(this,bs)==="with-column-headers"?o.set("headers",xn(this,ws).getMostBottomColumnHeadersRange()):xn(this,bs)==="with-column-group-headers"&&o.set("headers",xn(this,ws).getAllColumnHeadersRange()),o.set("cells",xn(this,ws).getCellsRange())),this.copyableRanges=Array.from(o.values()).filter(function(c){return c!==null}).map(function(c){var f=c.startRow,h=c.startCol,p=c.endRow,y=c.endCol;return{startRow:f,startCol:h,endRow:p,endCol:y}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var i=o.get("cells");if(i!==null&&i.isRangeTrimmed){var a=i.startRow,s=i.startCol,l=i.endRow,u=i.endCol;this.hot.runHooks("afterCopyLimit",l-a+1,u-s+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var n,o=(n=this.hot.getActiveEditor())===null||n===void 0?void 0:n.TEXTAREA;o?this.focusableElement.setFocusableElement(o):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var n;return(n=this.hot.getActiveEditor())===null||n===void 0?void 0:n.isOpened()}},{key:"populateValues",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(n.length){for(var i=n.length,a=n[0].length,s=[],l=o.getTopStartCorner(),u=l.row,c=l.col,f=o.getBottomEndCorner(),h=f.row,p=f.col,y=u,g=c,v=u,S=c;s.length<i||y<=h;){var O=this.hot.getCellMeta(y,c),w=O.skipRowOnPaste,x=O.visualRow;if(y=x+1,w!==!0){v=x,g=c;for(var T=[],z=s.length%i;T.length<a||g<=p;){var $=this.hot.getCellMeta(u,g),ne=$.skipColumnOnPaste,G=$.visualCol;if(g=G+1,ne!==!0){S=G;var q=T.length%a;T.push(n[z][q])}}s.push(T)}}return this.hot.populateFromArray(u,c,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[u,c,v,S]}}},{key:"onCopy",value:function(n){if(!(!this.hot.isListening()&&!xn(this,yy)||this.isEditorOpened())){this.setCopyableText(),Kr(this,yy,!1);var o=this.getRangedData(this.copyableRanges),i=Zxe(this,VH,rAe).call(this,this.copyableRanges),a=!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,i);if(a){var s=yf(o);if(n&&n.clipboardData){var l=mx(o,this.hot.rootDocument);n.clipboardData.setData("text/plain",s),n.clipboardData.setData("text/html",[BH,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",s);this.hot.runHooks("afterCopy",o,this.copyableRanges,i)}Kr(this,bs,"cells-only"),n.preventDefault()}}},{key:"onCut",value:function(n){if(!(!this.hot.isListening()&&!xn(this,my)||this.isEditorOpened())){this.setCopyableText(),Kr(this,my,!1);var o=this.getRangedData(this.copyableRanges),i=!!this.hot.runHooks("beforeCut",o,this.copyableRanges);if(i){var a=yf(o);if(n&&n.clipboardData){var s=mx(o,this.hot.rootDocument);n.clipboardData.setData("text/plain",a),n.clipboardData.setData("text/html",[BH,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges)}n.preventDefault()}}},{key:"onPaste",value:function(n){if(!(!this.hot.isListening()||this.isEditorOpened())){n&&n.preventDefault&&n.preventDefault();var o;if(n&&typeof n.clipboardData<"u"){var i=oR(n.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(i&&/(<table)|(<TABLE)/g.test(i)){var a=Jse(i,this.hot.rootDocument);o=a.data}else o=n.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=t0e(o)),!(o&&o.length===0)&&this.hot.runHooks("beforePaste",o,this.copyableRanges)!==!1){var s=this.populateValues(o),l=Nxe(s,4),u=l[0],c=l[1],f=l[2],h=l[3];this.hot.selectCell(u,c,Math.min(this.hot.countRows()-1,f),Math.min(this.hot.countCols()-1,h)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:"---------"},sxe(this)),xn(this,t0)&&n.items.push(cxe(this)),xn(this,n0)&&n.items.push(uxe(this)),xn(this,r0)&&n.items.push(lxe(this)),n.items.push(fxe(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&tae())&&(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(!(!this.hot.isListening()||this.isEditorOpened())){var n=this.hot.rootDocument.activeElement,o=this.hot.getActiveEditor();!o||n!==this.focusableElement.getFocusableElement()&&n!==o.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(jH(this.focusableElement),this.focusableElement=null),ia(mo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return py}},{key:"SETTING_KEYS",get:function(){return[py].concat(tAe)}},{key:"PLUGIN_PRIORITY",get:function(){return eAe}}]),r}(at);function rAe(t){for(var e=Pz(t),r=e.rows,n=0,o=0;o<r.length&&!(r[o]>=0);o++)n+=1;return{columnHeadersCount:n}}function Az(t,e){return"border_row".concat(t,"col").concat(e)}function rf(){return{width:1,color:"#000"}}function go(){return{hide:!0}}function oAe(){return{width:1,color:"#000",cornerVisible:!1}}function o0(t){if(pe(t.start)||pe(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(pe(t.end)||pe(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function Uc(t){return pe(t.start)&&(t.left=t.start),pe(t.end)&&(t.right=t.end),t}function i0(t,e){return{id:Az(t,e),border:oAe(),row:t,col:e,top:go(),bottom:go(),start:go(),end:go()}}function iAe(t,e){return xt(e,"border")&&e.border&&(t.border=e.border),xt(e,"top")&&pe(e.top)&&(e.top?(Ge(e.top)||(e.top=rf()),t.top=e.top):(e.top=go(),t.top=e.top)),xt(e,"bottom")&&pe(e.bottom)&&(e.bottom?(Ge(e.bottom)||(e.bottom=rf()),t.bottom=e.bottom):(e.bottom=go(),t.bottom=e.bottom)),xt(e,"start")&&pe(e.start)&&(e.start?(Ge(e.start)||(e.start=rf()),t.start=e.start):(e.start=go(),t.start=e.start)),xt(e,"end")&&pe(e.end)&&(e.end?(Ge(e.end)||(e.end=rf()),t.end=e.end):(e.end=go(),t.end=e.end)),t}function Lo(t,e){var r=!1;return _(t.getSelectedRange(),function(n){n.forAll(function(o,i){if(!(o<0||i<0)){var a=t.getCellMeta(o,i).borders;if(a)if(e){if(!xt(a[e],"hide")||a[e].hide===!1)return r=!0,!1}else return r=!0,!1}})}),r}function tb(t){return'<span class="selected">'.concat(String.fromCharCode(10003),"</span>").concat(t)}function aAe(t){return t.some(function(e){return pe(e.left)||pe(e.right)})}function sAe(t){return t.some(function(e){return pe(e.start)||pe(e.end)})}var lAe=new Map([["left","start"],["right","end"]]);function uAe(t){var e;return(e=lAe.get(t))!==null&&e!==void 0?e:t}function cAe(t){return{key:"borders:bottom",name:function(){var e=this.getTranslatedPhrase(fE),r=Lo(this,"bottom");return r&&(e=tb(e)),e},callback:function(e,r){var n=Lo(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function fAe(t){var e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name:function(){var r=this.getTranslatedPhrase(hE),n=Lo(this,e);return n&&(r=tb(r)),r},callback:function(r,n){var o=Lo(this,e);t.prepareBorder(n,e,o)}}}function hAe(t){return{key:"borders:no_borders",name:function(){return this.getTranslatedPhrase(dE)},callback:function(e,r){t.prepareBorder(r,"noBorders")},disabled:function(){return!Lo(this)}}}function dAe(t){var e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name:function(){var r=this.getTranslatedPhrase(cE),n=Lo(this,e);return n&&(r=tb(r)),r},callback:function(r,n){var o=Lo(this,e);t.prepareBorder(n,e,o)}}}function pAe(t){return{key:"borders:top",name:function(){var e=this.getTranslatedPhrase(uE),r=Lo(this,"top");return r&&(e=tb(e)),e},callback:function(e,r){var n=Lo(this,"top");t.prepareBorder(r,"top",n)}}}function lu(t){"@babel/helpers - typeof";return lu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lu(t)}function FH(t,e){return vAe(t)||gAe(t,e)||mAe(t,e)||yAe()}function yAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mAe(t,e){if(t){if(typeof t=="string")return WH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return WH(t,e)}}function WH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function gAe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function vAe(t){if(Array.isArray(t))return t}function bAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Iz(n.key),n)}}function wAe(t,e,r){return e&&UH(t.prototype,e),r&&UH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aa(){return typeof Reflect<"u"&&Reflect.get?aa=Reflect.get.bind():aa=function(t,e,r){var n=SAe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},aa.apply(this,arguments)}function SAe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=vo(t),t!==null););return t}function CAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O1(t,e)}function O1(t,e){return O1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},O1(t,e)}function OAe(t){var e=RAe();return function(){var r=vo(t),n;if(e){var o=vo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kAe(this,n)}}function kAe(t,e){if(e&&(lu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jz(t)}function jz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vo(t){return vo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vo(t)}function EAe(t,e,r){return e=Iz(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iz(t){var e=TAe(t,"string");return lu(e)==="symbol"?e:String(e)}function TAe(t,e){if(lu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(lu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gy="customBorders",PAe=90,MAe=function(t){CAe(r,t);var e=OAe(r);function r(){var n;bAe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),EAe(jz(n),"savedBorders",[]),n}return wAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[gy]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return n.onAfterContextMenuDefaultOptions(o)}),this.addHook("init",function(){return n.onAfterInit()}),aa(vo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hideBorders(),aa(vo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),aa(vo(r.prototype),"updatePlugin",this).call(this)}},{key:"setBorders",value:function(n,o){var i=this,a=["top","bottom","start","end"],s=null;o&&(this.checkSettingsCohesion([o]),a=Object.keys(o),s=o0(o));var l=Al(n),u=Ph(l);_(n,function(c){for(var f=u(c),h=FH(f,4),p=h[0],y=h[1],g=h[2],v=h[3],S=function(w){for(var x=function(z){_(a,function($){i.prepareBorderFromCustomAdded(w,z,s,uAe($))})},T=y;T<=v;T+=1)x(T)},O=p;O<=g;O+=1)S(O)}),this.hot.view.render()}},{key:"getBorders",value:function(n){var o=this;if(!Array.isArray(n))return this.savedBorders;var i=Al(n),a=Ph(i),s=[];return _(n,function(l){for(var u=a(l),c=FH(u,4),f=c[0],h=c[1],p=c[2],y=c[3],g=function(S){for(var O=function(x){_(o.savedBorders,function(T){T.row===S&&T.col===x&&s.push(Uc(T))})},w=h;w<=y;w+=1)O(w)},v=f;v<=p;v+=1)g(v)}),s}},{key:"clearBorders",value:function(n){var o=this;n?this.setBorders(n):(_(this.savedBorders,function(i){o.clearBordersFromSelectionSettings(i.id),o.clearNullCellRange(),o.hot.removeCellMeta(i.row,i.col,"borders")}),this.savedBorders.length=0)}},{key:"insertBorderIntoSettings",value:function(n,o){var i=this.checkSavedBorders(n);i||this.savedBorders.push(n);var a=this.hot._createCellRange(this.hot._createCellCoords(n.row,n.col)),s=this.checkCustomSelections(n,a,o);s||this.hot.selection.highlight.addCustomSelection({border:n,visualCellRange:a})}},{key:"prepareBorderFromCustomAdded",value:function(n,o,i,a){var s=this.hot.countRows(),l=this.hot.countCols();if(!(n>=s||o>=l)){var u=i0(n,o);i&&(u=iAe(u,i),_(this.hot.selection.highlight.customSelections,function(c){if(u.id===c.settings.id)return Object.assign(c.settings,i),u.id=c.settings.id,u.top=c.settings.top,u.bottom=c.settings.bottom,u.start=c.settings.start,u.end=c.settings.end,!1})),this.hot.setCellMeta(n,o,"borders",Uc(u)),this.insertBorderIntoSettings(u,a)}}},{key:"prepareBorderFromCustomAddedRange",value:function(n,o){var i=this,a=Math.min(n.to.row,this.hot.countRows()-1),s=Math.min(n.to.col,this.hot.countCols()-1);Oe(n.from.row,a,function(l){Oe(n.from.col,s,function(u){var c=i0(l,u),f=0;l===n.from.row&&xt(o,"top")&&(f+=1,c.top=o.top),l===n.to.row&&xt(o,"bottom")&&(f+=1,c.bottom=o.bottom),u===n.from.col&&xt(o,"start")&&(f+=1,c.start=o.start),u===n.to.col&&xt(o,"end")&&(f+=1,c.end=o.end),f>0&&(i.hot.setCellMeta(l,u,"borders",Uc(c)),i.insertBorderIntoSettings(c))})})}},{key:"removeAllBorders",value:function(n,o){var i=Az(n,o);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(n,o,"borders")}},{key:"setBorder",value:function(n,o,i,a){var s=this.hot.getCellMeta(n,o).borders;if(!s||s.border===void 0?s=i0(n,o):s=o0(s),a){s[i]=go();var l=this.countHide(s);if(l===4)this.removeAllBorders(n,o);else{var u=this.checkCustomSelectionsFromContextMenu(s,i,a);u||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,o,"borders",Uc(s))}}else{s[i]=rf();var c=this.checkCustomSelectionsFromContextMenu(s,i,a);c||this.insertBorderIntoSettings(s),this.hot.setCellMeta(n,o,"borders",Uc(s))}}},{key:"prepareBorder",value:function(n,o,i){var a=this;_(n,function(s){var l=s.start,u=s.end;if(l.row===u.row&&l.col===u.col)o==="noBorders"?a.removeAllBorders(l.row,l.col):a.setBorder(l.row,l.col,o,i);else switch(o){case"noBorders":Oe(l.col,u.col,function(c){Oe(l.row,u.row,function(f){a.removeAllBorders(f,c)})});break;case"top":Oe(l.col,u.col,function(c){a.setBorder(l.row,c,o,i)});break;case"bottom":Oe(l.col,u.col,function(c){a.setBorder(u.row,c,o,i)});break;case"start":Oe(l.row,u.row,function(c){a.setBorder(c,l.col,o,i)});break;case"end":Oe(l.row,u.row,function(c){a.setBorder(c,u.col,o,i)});break}})}},{key:"createCustomBorders",value:function(n){var o=this;_(n,function(i){var a=o0(i);i.range?o.prepareBorderFromCustomAddedRange(i.range,a):o.prepareBorderFromCustomAdded(i.row,i.col,a)})}},{key:"countHide",value:function(n){var o=n.top,i=n.bottom,a=n.start,s=n.end,l=[o,i,a,s];return an(l,function(u,c){var f=u;return c&&c.hide&&(f+=1),f},0)}},{key:"clearBordersFromSelectionSettings",value:function(n){var o=Ye(this.hot.selection.highlight.customSelections,function(i){return i.settings.id}).indexOf(n);o>-1&&this.hot.selection.highlight.customSelections[o].clear()}},{key:"clearNullCellRange",value:function(){var n=this;_(this.hot.selection.highlight.customSelections,function(o,i){if(o.cellRange===null)return n.hot.selection.highlight.customSelections[i].destroy(),n.hot.selection.highlight.customSelections.splice(i,1),!1})}},{key:"hideBorders",value:function(){var n=this;_(this.savedBorders,function(o){n.clearBordersFromSelectionSettings(o.id),n.clearNullCellRange()})}},{key:"spliceBorder",value:function(n){var o=Ye(this.savedBorders,function(i){return i.id}).indexOf(n);o>-1&&this.savedBorders.splice(o,1)}},{key:"checkSavedBorders",value:function(n){var o=this,i=!1,a=this.countHide(n);return a===4?(this.spliceBorder(n.id),i=!0):_(this.savedBorders,function(s,l){if(n.id===s.id)return o.savedBorders[l]=n,i=!0,!1}),i}},{key:"checkCustomSelectionsFromContextMenu",value:function(n,o,i){var a=!1;return _(this.hot.selection.highlight.customSelections,function(s){if(n.id===s.settings.id)return $e(s.instanceBorders,function(l){l.toggleHiddenClass(o,i)}),a=!0,!1}),a}},{key:"checkCustomSelections",value:function(n,o,i){var a=this.countHide(n),s=!1;return a===4?(this.removeAllBorders(n.row,n.col),s=!0):_(this.hot.selection.highlight.customSelections,function(l){if(n.id===l.settings.id)return l.visualCellRange=o,l.commit(),i&&$e(l.instanceBorders,function(u){u.changeBorderStyle(i,n)}),s=!0,!1}),s}},{key:"changeBorderSettings",value:function(){var n=this.hot.getSettings()[gy];if(Array.isArray(n)){var o=yn(n);this.checkSettingsCohesion(o),o.length||(this.savedBorders=o),this.createCustomBorders(o)}else n!==void 0&&this.createCustomBorders(this.savedBorders)}},{key:"checkSettingsCohesion",value:function(n){var o=aAe(n),i=sAe(n);if(o&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&o)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}},{key:"onAfterContextMenuDefaultOptions",value:function(n){this.hot.getSettings()[gy]&&n.items.push({name:"---------"},{key:"borders",name:function(){return this.getTranslatedPhrase(lE)},disabled:function(){return this.selection.isSelectedByCorner()},submenu:{items:[pAe(this),dAe(this),cAe(this),fAe(this),hAe(this)]}})}},{key:"onAfterInit",value:function(){this.changeBorderSettings()}},{key:"destroy",value:function(){aa(vo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return gy}},{key:"PLUGIN_PRIORITY",get:function(){return PAe}}]),r}(at);function uu(t){"@babel/helpers - typeof";return uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uu(t)}function _Ae(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AAe(n.key),n)}}function xAe(t,e,r){return e&&zH(t.prototype,e),r&&zH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function AAe(t){var e=jAe(t,"string");return uu(e)==="symbol"?e:String(e)}function jAe(t,e){if(uu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sa(){return typeof Reflect<"u"&&Reflect.get?sa=Reflect.get.bind():sa=function(t,e,r){var n=IAe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},sa.apply(this,arguments)}function IAe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=bo(t),t!==null););return t}function HAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k1(t,e)}function k1(t,e){return k1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},k1(t,e)}function DAe(t){var e=LAe();return function(){var r=bo(t),n;if(e){var o=bo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NAe(this,n)}}function NAe(t,e){if(e&&(uu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hz(t)}function Hz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bo(t){return bo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bo(t)}var YH="dragToScroll",BAe=100,VAe=function(t){HAe(r,t);var e=DAe(r);function r(n){var o;return _Ae(this,r),o=e.call(this,n),o.eventManager=new Tt(Hz(o)),o.boundaries=null,o.callback=null,o.listening=!1,o}return xAe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[YH]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterOnCellMouseDown",function(o){return n.setupListening(o)}),this.addHook("afterOnCellCornerMouseDown",function(o){return n.setupListening(o)}),this.registerEvents(),sa(bo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),sa(bo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.unregisterEvents(),sa(bo(r.prototype),"disablePlugin",this).call(this)}},{key:"setBoundaries",value:function(n){this.boundaries=n}},{key:"setCallback",value:function(n){this.callback=n}},{key:"check",value:function(n,o){var i=0,a=0;o<this.boundaries.top?a=o-this.boundaries.top:o>this.boundaries.bottom&&(a=o-this.boundaries.bottom),n<this.boundaries.left?i=n-this.boundaries.left:n>this.boundaries.right&&(i=n-this.boundaries.right),this.callback(i,a)}},{key:"listen",value:function(){this.listening=!0}},{key:"unlisten",value:function(){this.listening=!1}},{key:"isListening",value:function(){return this.listening}},{key:"registerEvents",value:function(){for(var n=this,o=this.hot.rootWindow,i=o;i;)this.eventManager.addEventListener(i.document,"contextmenu",function(){return n.unlisten()}),this.eventManager.addEventListener(i.document,"mouseup",function(){return n.unlisten()}),this.eventManager.addEventListener(i.document,"mousemove",function(a){return n.onMouseMove(a)}),i=Nm(i)}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"setupListening",value:function(n){if(!_a(n)){var o=this.hot.view._wt.wtTable.holder;o!==this.hot.rootWindow&&(this.setBoundaries(o.getBoundingClientRect()),this.setCallback(function(i,a){i<0?o.scrollLeft-=50:i>0&&(o.scrollLeft+=50),a<0?o.scrollTop-=20:a>0&&(o.scrollTop+=20)}),this.listen())}}},{key:"onMouseMove",value:function(n){this.isListening()&&this.check(n.clientX,n.clientY)}},{key:"destroy",value:function(){sa(bo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return YH}},{key:"PLUGIN_PRIORITY",get:function(){return BAe}}]),r}(at);function cu(t){"@babel/helpers - typeof";return cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cu(t)}function FAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UAe(n.key),n)}}function WAe(t,e,r){return e&&GH(t.prototype,e),r&&GH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function UAe(t){var e=zAe(t,"string");return cu(e)==="symbol"?e:String(e)}function zAe(t,e){if(cu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function la(){return typeof Reflect<"u"&&Reflect.get?la=Reflect.get.bind():la=function(t,e,r){var n=YAe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},la.apply(this,arguments)}function YAe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=wo(t),t!==null););return t}function GAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&R1(t,e)}function R1(t,e){return R1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},R1(t,e)}function $Ae(t){var e=qAe();return function(){var r=wo(t),n;if(e){var o=wo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return KAe(this,n)}}function KAe(t,e){if(e&&(cu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dz(t)}function Dz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qAe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wo(t){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wo(t)}ye.getSingleton().register("afterDropdownMenuDefaultOptions");ye.getSingleton().register("beforeDropdownMenuShow");ye.getSingleton().register("afterDropdownMenuShow");ye.getSingleton().register("afterDropdownMenuHide");ye.getSingleton().register("afterDropdownMenuExecute");var a0="dropdownMenu",XAe=230,s0="changeType",Nz=function(t){GAe(r,t);var e=$Ae(r);function r(n){var o;return FAe(this,r),o=e.call(this,n),o.eventManager=new Tt(Dz(o)),o.commandExecutor=new vz(o.hot),o.itemsFactory=null,o.menu=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return WAe(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[a0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.itemsFactory=new wz(this.hot,r.DEFAULT_ITEMS);var o=this.hot.getSettings()[a0],i={items:this.itemsFactory.getItems(o)};this.registerEvents(),typeof o.callback=="function"&&this.commandExecutor.setCommonCallback(o.callback),la(wo(r.prototype),"enablePlugin",this).call(this),this.callOnPluginsReady(function(){n.hot.runHooks("afterDropdownMenuDefaultOptions",i),n.itemsFactory.setPredefinedItems(i.items);var a=n.itemsFactory.getItems(o);n.menu&&n.menu.destroy(),n.menu=new vT(n.hot,{className:"htDropdownMenu",keepInViewport:!0,container:o.uiContainer||n.hot.rootDocument.body}),n.hot.runHooks("beforeDropdownMenuSetItems",a),n.menu.setMenuItems(a),n.menu.addLocalHook("beforeOpen",function(){return n.onMenuBeforeOpen()}),n.menu.addLocalHook("afterOpen",function(){return n.onMenuAfterOpen()}),n.menu.addLocalHook("afterClose",function(){return n.onMenuAfterClose()}),n.menu.addLocalHook("executeCommand",function(){for(var s,l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];return(s=n.executeCommand).call.apply(s,[n].concat(u))}),_(a,function(s){return n.commandExecutor.registerCommand(s.key,s)})})}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),la(wo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.close(),this.menu&&this.menu.destroy(),la(wo(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(o){return n.onTableClick(o)})}},{key:"open",value:function(n){this.menu&&(this.menu.open(),n.width&&this.menu.setOffset("left",n.width),this.menu.setPosition(n))}},{key:"close",value:function(){this.menu&&this.menu.close()}},{key:"executeCommand",value:function(n){for(var o,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=this.commandExecutor).execute.apply(o,[n].concat(a))}},{key:"setListening",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(n?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}},{key:"onTableClick",value:function(n){if(n.stopPropagation(),Ae(n.target,s0)&&!this.menu.isOpened()){var o=0,i=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){var a=this.hot.rootWindow.frameElement,s=a.getBoundingClientRect(),l=s.top,u=s.left;o=l,i=u}var c=n.target.getBoundingClientRect();this.open({left:c.left+i,top:c.top+n.target.offsetHeight+3+o,width:c.width,height:c.height})}}},{key:"onAfterGetColHeader",value:function(n,o){var i=o.parentNode;if(i){var a=i.parentNode.childNodes,s=Array.prototype.indexOf.call(a,i);if(!(n<0||s!==a.length-1)){var l=o.querySelector(".".concat(s0));if(!(this.enabled&&l)){if(!this.enabled){l&&l.parentNode.removeChild(l);return}var u=this.hot.rootDocument.createElement("button");u.className=s0,u.type="button",u.onclick=function(){return!1},o.firstChild.insertBefore(u,o.firstChild.firstChild)}}}}},{key:"onMenuBeforeOpen",value:function(){this.hot.runHooks("beforeDropdownMenuShow",this)}},{key:"onMenuAfterOpen",value:function(){this.hot.runHooks("afterDropdownMenuShow",this)}},{key:"onMenuAfterClose",value:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}},{key:"destroy",value:function(){this.close(),this.menu&&this.menu.destroy(),la(wo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return a0}},{key:"PLUGIN_PRIORITY",get:function(){return XAe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:AutoColumnSize"]}},{key:"DEFAULT_ITEMS",get:function(){return[mp,gp,ze,bp,ze,qv,ze,vp,ze,$n]}}]),r}(at);Nz.SEPARATOR={name:ze};function od(t){"@babel/helpers - typeof";return od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},od(t)}function ZAe(t,e){return tje(t)||eje(t,e)||JAe(t,e)||QAe()}function QAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JAe(t,e){if(t){if(typeof t=="string")return $H(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $H(t,e)}}function $H(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function eje(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function tje(t){if(Array.isArray(t))return t}function nje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function KH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,oje(n.key),n)}}function rje(t,e,r){return e&&KH(t.prototype,e),r&&KH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function oje(t){var e=ije(t,"string");return od(e)==="symbol"?e:String(e)}function ije(t,e){if(od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var aje=function(){function t(e){nje(this,t),this.hot=e,this.options={}}return rje(t,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,r=this._getDataRange(),n=r.startRow,o=r.startCol,i=r.endRow,a=r.endCol,s=this.options,l=[];return Oe(n,i,function(u){var c=[];!s.exportHiddenRows&&e._isHiddenRow(u)||(Oe(o,a,function(f){!s.exportHiddenColumns&&e._isHiddenColumn(f)||c.push(e.hot.getDataAtCell(u,f))}),l.push(c))}),l}},{key:"getRowHeaders",value:function(){var e=this,r=[];if(this.options.rowHeaders){var n=this._getDataRange(),o=n.startRow,i=n.endRow,a=this.hot.getRowHeader();Oe(o,i,function(s){!e.options.exportHiddenRows&&e._isHiddenRow(s)||r.push(a[s])})}return r}},{key:"getColumnHeaders",value:function(){var e=this,r=[];if(this.options.columnHeaders){var n=this._getDataRange(),o=n.startCol,i=n.endCol,a=this.hot.getColHeader();Oe(o,i,function(s){!e.options.exportHiddenColumns&&e._isHiddenColumn(s)||r.push(a[s])})}return r}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,r=this.hot.countRows()-1,n=ZAe(this.options.range,4),o=n[0],i=o===void 0?0:o,a=n[1],s=a===void 0?0:a,l=n[2],u=l===void 0?r:l,c=n[3],f=c===void 0?e:c;return i=Math.max(i,0),s=Math.max(s,0),u=Math.min(u,r),f=Math.min(f,e),{startRow:i,startCol:s,endRow:u,endCol:f}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),t}();const sje=aje;function id(t){"@babel/helpers - typeof";return id=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(t)}function lje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,cje(n.key),n)}}function uje(t,e,r){return e&&qH(t.prototype,e),r&&qH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function cje(t){var e=fje(t,"string");return id(e)==="symbol"?e:String(e)}function fje(t,e){if(id(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(id(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hje=function(){function t(e,r){lje(this,t),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}return uje(t,[{key:"_mergeOptions",value:function(e){var r=Rn(this.constructor.DEFAULT_OPTIONS),n=new Date;return r=Yt(Rn(t.DEFAULT_OPTIONS),r),r=Yt(r,e),r.filename=fW(r.filename,{YYYY:n.getFullYear(),MM:"".concat(n.getMonth()+1).padStart(2,"0"),DD:"".concat(n.getDate()).padStart(2,"0")}),r}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),t}();const dje=hje;function fu(t){"@babel/helpers - typeof";return fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fu(t)}function pje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function XH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mje(n.key),n)}}function yje(t,e,r){return e&&XH(t.prototype,e),r&&XH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mje(t){var e=gje(t,"string");return fu(e)==="symbol"?e:String(e)}function gje(t,e){if(fu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E1(t,e)}function E1(t,e){return E1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},E1(t,e)}function bje(t){var e=Cje();return function(){var r=_g(t),n;if(e){var o=_g(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wje(this,n)}}function wje(t,e){if(e&&(fu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sje(t)}function Sje(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Cje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _g(t){return _g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_g(t)}var Oje=String.fromCharCode(13),kje=String.fromCharCode(34),Rje=String.fromCharCode(10),Eje=function(t){vje(r,t);var e=bje(r);function r(){return pje(this,r),e.apply(this,arguments)}return yje(r,[{key:"export",value:function(){var n=this,o=this.options,i=this.dataProvider.getData(),a=this.dataProvider.getColumnHeaders(),s=a.length>0,l=this.dataProvider.getRowHeaders(),u=l.length>0,c=o.bom?String.fromCharCode(65279):"";return s&&(a=Ye(a,function(f){return n._escapeCell(f,!0)}),u&&(c+=o.columnDelimiter),c+=a.join(o.columnDelimiter),c+=o.rowDelimiter),_(i,function(f,h){h>0&&(c+=o.rowDelimiter),u&&(c+=n._escapeCell(l[h])+o.columnDelimiter),c+=f.map(function(p){return n._escapeCell(p)}).join(o.columnDelimiter)}),c}},{key:"_escapeCell",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=Dt(n);return i!==""&&(o||i.indexOf(Oje)>=0||i.indexOf(kje)>=0||i.indexOf(Rje)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i='"'.concat(i,'"')),i}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}}]),r}(dje);const Tje=Eje;function ad(t){"@babel/helpers - typeof";return ad=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ad(t)}function Pje(t,e,r){return e=Mje(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mje(t){var e=_je(t,"string");return ad(e)==="symbol"?e:String(e)}function _je(t,e){if(ad(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ad(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xje="csv",T1=Pje({},xje,Tje);function Aje(t,e,r){return typeof T1[t]=="function"?new T1[t](e,r):null}function hu(t){"@babel/helpers - typeof";return hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hu(t)}function jje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Hje(n.key),n)}}function Ije(t,e,r){return e&&ZH(t.prototype,e),r&&ZH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Hje(t){var e=Dje(t,"string");return hu(e)==="symbol"?e:String(e)}function Dje(t,e){if(hu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nje(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P1(t,e)}function P1(t,e){return P1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},P1(t,e)}function Lje(t){var e=Fje();return function(){var r=xg(t),n;if(e){var o=xg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bje(this,n)}}function Bje(t,e){if(e&&(hu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vje(t)}function Vje(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Fje(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xg(t){return xg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xg(t)}var Wje="exportFile",Uje=240,zje=function(t){Nje(r,t);var e=Lje(r);function r(){return jje(this,r),e.apply(this,arguments)}return Ije(r,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(n,o).export()}},{key:"exportAsBlob",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(n,o))}},{key:"downloadFile",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.hot,a=i.rootDocument,s=i.rootWindow,l=this._createTypeFormatter(n,o),u=this._createBlob(l),c=s.URL||s.webkitURL,f=a.createElement("a"),h="".concat(l.options.filename,".").concat(l.options.fileExtension);if(f.download!==void 0){var p=c.createObjectURL(u);f.style.display="none",f.setAttribute("href",p),f.setAttribute("download",h),a.body.appendChild(f),f.dispatchEvent(new MouseEvent("click")),a.body.removeChild(f),setTimeout(function(){c.revokeObjectURL(p)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(u,h)}},{key:"_createTypeFormatter",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!T1[n])throw new Error('Export format type "'.concat(n,'" is not supported.'));return Aje(n,new sje(this.hot),o)}},{key:"_createBlob",value:function(n){var o=null;return typeof Blob<"u"&&(o=new Blob([n.export()],{type:"".concat(n.options.mimeType,";charset=").concat(n.options.encoding)})),o}}],[{key:"PLUGIN_KEY",get:function(){return Wje}},{key:"PLUGIN_PRIORITY",get:function(){return Uje}}]),r}(at);function sd(t){"@babel/helpers - typeof";return sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sd(t)}function Yje(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QH(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$je(n.key),n)}}function Gje(t,e,r){return e&&QH(t.prototype,e),r&&QH(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $je(t){var e=Kje(t,"string");return sd(e)==="symbol"?e:String(e)}function Kje(t,e){if(sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Lz=function(){function t(e,r){var n=r.id,o=r.stateless,i=o===void 0?!0:o;Yje(this,t),this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId="Filters.component.".concat(this.id),this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Pv)}return Gje(t,[{key:"reset",value:function(){_(this.elements,function(e){return e.reset()})}},{key:"hide",value:function(){this.hidden=!0}},{key:"show",value:function(){this.hidden=!1}},{key:"isHidden",value:function(){return this.hot===null||this.hidden}},{key:"restoreState",value:function(e){this.state&&this.setState(this.state.getValueAtIndex(e))}},{key:"setState",value:function(){throw new Error("The state setting logic is not implemented")}},{key:"saveState",value:function(e){this.state&&this.state.setValueAtIndex(e,this.getState())}},{key:"getState",value:function(){throw new Error("The state gathering logic is not implemented")}},{key:"destroy",value:function(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),_(this.elements,function(e){return e.destroy()}),this.state=null,this.elements=null,this.hot=null}}]),t}();pt(Lz,Pn);const nb=Lz;var ld={};function Ci(t,e){if(!ld[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));var r=ld[t],n=r.condition,o=r.descriptor,i=e;return o.inputValuesDecorator&&(i=o.inputValuesDecorator(i)),function(a){return n.apply(a.meta.instance,[].concat([a],[i]))}}function Ys(t){if(!ld[t])throw Error('Filter condition "'.concat(t,'" does not exist.'));return ld[t].descriptor}function Vt(t,e,r){r.key=t,ld[t]={condition:e,descriptor:r}}var Qt="none";function qje(){return!0}Vt(Qt,qje,{name:Mv,inputsCount:0,showOperators:!1});var bf="empty";function Xje(t){return Xt(t.value)}Vt(bf,Xje,{name:wE,inputsCount:0,showOperators:!0});var cm="not_empty";function Zje(t,e){return!Ci(bf,e)(t)}Vt(cm,Zje,{name:SE,inputsCount:0,showOperators:!0});function Qje(t,e){return nIe(t)||tIe(t,e)||eIe(t,e)||Jje()}function Jje(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eIe(t,e){if(t){if(typeof t=="string")return JH(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JH(t,e)}}function JH(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function tIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function nIe(t){if(Array.isArray(t))return t}var wf="eq";function rIe(t,e){var r=Qje(e,1),n=r[0];return Dt(t.value).toLocaleLowerCase(t.meta.locale)===Dt(n)}Vt(wf,rIe,{name:CE,inputsCount:1,showOperators:!0});var fm="neq";function oIe(t,e){return!Ci(wf,e)(t)}Vt(fm,oIe,{name:OE,inputsCount:1,showOperators:!0});function iIe(t,e){return uIe(t)||lIe(t,e)||sIe(t,e)||aIe()}function aIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sIe(t,e){if(t){if(typeof t=="string")return eD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return eD(t,e)}}function eD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uIe(t){if(Array.isArray(t))return t}var Bz="gt";function cIe(t,e){var r=iIe(e,1),n=r[0],o=n;return t.meta.type==="numeric"&&(o=parseFloat(o,10)),t.value>o}Vt(Bz,cIe,{name:PE,inputsCount:1,showOperators:!0});function fIe(t,e){return yIe(t)||pIe(t,e)||dIe(t,e)||hIe()}function hIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dIe(t,e){if(t){if(typeof t=="string")return tD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tD(t,e)}}function tD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function yIe(t){if(Array.isArray(t))return t}var Vz="gte";function mIe(t,e){var r=fIe(e,1),n=r[0],o=n;return t.meta.type==="numeric"&&(o=parseFloat(o,10)),t.value>=o}Vt(Vz,mIe,{name:ME,inputsCount:1,showOperators:!0});function gIe(t,e){return SIe(t)||wIe(t,e)||bIe(t,e)||vIe()}function vIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bIe(t,e){if(t){if(typeof t=="string")return nD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nD(t,e)}}function nD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function SIe(t){if(Array.isArray(t))return t}var Fz="lt";function CIe(t,e){var r=gIe(e,1),n=r[0],o=n;return t.meta.type==="numeric"&&(o=parseFloat(o,10)),t.value<o}Vt(Fz,CIe,{name:_E,inputsCount:1,showOperators:!0});function OIe(t,e){return TIe(t)||EIe(t,e)||RIe(t,e)||kIe()}function kIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RIe(t,e){if(t){if(typeof t=="string")return rD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rD(t,e)}}function rD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function EIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function TIe(t){if(Array.isArray(t))return t}var Wz="lte";function PIe(t,e){var r=OIe(e,1),n=r[0],o=n;return t.meta.type==="numeric"&&(o=parseFloat(o,10)),t.value<=o}Vt(Wz,PIe,{name:xE,inputsCount:1,showOperators:!0});function MIe(t,e){return jIe(t)||AIe(t,e)||xIe(t,e)||_Ie()}function _Ie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xIe(t,e){if(t){if(typeof t=="string")return oD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oD(t,e)}}function oD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function AIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function jIe(t){if(Array.isArray(t))return t}var wT="date_after";function IIe(t,e){var r=MIe(e,1),n=r[0],o=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)>=0}Vt(wT,IIe,{name:IE,inputsCount:1,showOperators:!0});function HIe(t,e){return BIe(t)||LIe(t,e)||NIe(t,e)||DIe()}function DIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NIe(t,e){if(t){if(typeof t=="string")return iD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iD(t,e)}}function iD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function LIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function BIe(t){if(Array.isArray(t))return t}var ST="date_before";function VIe(t,e){var r=HIe(e,1),n=r[0],o=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!o.isValid()||!i.isValid()?!1:o.diff(i)<=0}Vt(ST,VIe,{name:HE,inputsCount:1,showOperators:!0});function FIe(t,e){return YIe(t)||zIe(t,e)||UIe(t,e)||WIe()}function WIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UIe(t,e){if(t){if(typeof t=="string")return aD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aD(t,e)}}function aD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function YIe(t){if(Array.isArray(t))return t}var Ag="between";function GIe(t,e){var r=FIe(e,2),n=r[0],o=r[1],i=n,a=o;if(t.meta.type==="numeric"){var s=parseFloat(i,10),l=parseFloat(a,10);i=Math.min(s,l),a=Math.max(s,l)}else if(t.meta.type==="date"){var u=Ci(ST,[a]),c=Ci(wT,[i]);return u(t)&&c(t)}return t.value>=i&&t.value<=a}Vt(Ag,GIe,{name:AE,inputsCount:2,showOperators:!0});var Uz="not_between";function $Ie(t,e){return!Ci(Ag,e)(t)}Vt(Uz,$Ie,{name:jE,inputsCount:2,showOperators:!0});function KIe(t,e){return QIe(t)||ZIe(t,e)||XIe(t,e)||qIe()}function qIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XIe(t,e){if(t){if(typeof t=="string")return sD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return sD(t,e)}}function sD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZIe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function QIe(t){if(Array.isArray(t))return t}var zz="begins_with";function JIe(t,e){var r=KIe(e,1),n=r[0];return Dt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Dt(n))}Vt(zz,JIe,{name:kE,inputsCount:1,showOperators:!0});var eHe=_e,Yz=Yd,tHe=Br.f,nHe=Ga,lD=Bt,rHe=Mk,oHe=En,iHe=_k,uD=Yz("".endsWith),aHe=Yz("".slice),sHe=Math.min,Gz=iHe("endsWith"),lHe=!Gz&&!!function(){var t=tHe(String.prototype,"endsWith");return t&&!t.writable}();eHe({target:"String",proto:!0,forced:!lHe&&!Gz},{endsWith:function(t){var e=lD(oHe(this));rHe(t);var r=arguments.length>1?arguments[1]:void 0,n=e.length,o=r===void 0?n:sHe(nHe(r),n),i=lD(t);return uD?uD(e,i,o):aHe(e,o-i.length,o)===i}});function uHe(t,e){return dHe(t)||hHe(t,e)||fHe(t,e)||cHe()}function cHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fHe(t,e){if(t){if(typeof t=="string")return cD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cD(t,e)}}function cD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function hHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function dHe(t){if(Array.isArray(t))return t}var $z="ends_with";function pHe(t,e){var r=uHe(e,1),n=r[0];return Dt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Dt(n))}Vt($z,pHe,{name:RE,inputsCount:1,showOperators:!0});function yHe(t,e){return bHe(t)||vHe(t,e)||gHe(t,e)||mHe()}function mHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gHe(t,e){if(t){if(typeof t=="string")return fD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fD(t,e)}}function fD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function bHe(t){if(Array.isArray(t))return t}var CT="contains";function wHe(t,e){var r=yHe(e,1),n=r[0];return Dt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Dt(n))>=0}Vt(CT,wHe,{name:EE,inputsCount:1,showOperators:!0});var Kz="not_contains";function SHe(t,e){return!Ci(CT,e)(t)}Vt(Kz,SHe,{name:TE,inputsCount:1,showOperators:!0});var qz="date_tomorrow";function CHe(t){var e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}Vt(qz,CHe,{name:NE,inputsCount:0});var Xz="date_today";function OHe(t){var e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}Vt(Xz,OHe,{name:DE,inputsCount:0});var Zz="date_yesterday";function kHe(t){var e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}Vt(Zz,kHe,{name:LE,inputsCount:0});eee();function RHe(t,e){var r=t;return r===""&&(r="(".concat(e,")")),r}var M1=new Set([1]).has(1),EHe=M1&&typeof Array.from=="function";function wp(t){var e=t;return M1&&(e=new Set(e)),function(r){var n;return M1?n=e.has(r):n=!!~e.indexOf(r),n}}function Qz(t){return t??""}function _1(t){var e=t;return EHe?e=Array.from(new Set(e)):e=fF(e),e=e.sort(function(r,n){return typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1}),e}function hD(t,e,r,n){var o=[],i=t===e,a;return i||(a=wp(e)),_(t,function(s){var l=!1;(i||a(s))&&(l=!0);var u={checked:l,value:s,visualValue:RHe(s,r)};n&&n(u),o.push(u)}),o}function Jz(t,e){return _He(t)||MHe(t,e)||PHe(t,e)||THe()}function THe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PHe(t,e){if(t){if(typeof t=="string")return dD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dD(t,e)}}function dD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function MHe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function _He(t){if(Array.isArray(t))return t}var ua="by_value";function xHe(t,e){var r=Jz(e,1),n=r[0];return n(t.value)}Vt(ua,xHe,{name:"By value",inputsCount:0,inputValuesDecorator:function(t){var e=Jz(t,1),r=e[0];return[wp(r)]},showOperators:!1});var ud={};function AHe(t){if(!ud[t])throw Error('Operation with id "'.concat(t,'" does not exist.'));var e=ud[t].func;return function(r,n){return e(r,n)}}function jHe(t){return ud[t].name}function OT(t,e,r){ud[t]={name:e,func:r}}var pi="conjunction",IHe=FE;function HHe(t,e){return t.every(function(r){return r.func(e)})}OT(pi,IHe,HHe);var jg="disjunction",DHe=_v;function NHe(t,e){return t.some(function(r){return r.func(e)})}OT(jg,DHe,NHe);var kT="disjunctionWithExtraCondition",LHe=_v;function BHe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(function(r){return r.func(e)})&&t[t.length-1].func(e)}OT(kT,LHe,BHe);function cd(t){"@babel/helpers - typeof";return cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cd(t)}var zc;function l0(t,e,r){return e=VHe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VHe(t){var e=FHe(t,"string");return cd(e)==="symbol"?e:String(e)}function FHe(t,e){if(cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WHe="numeric",eY="text",UHe="date",pD=(zc={},l0(zc,WHe,[Qt,ze,bf,cm,ze,wf,fm,ze,Bz,Vz,Fz,Wz,Ag,Uz]),l0(zc,eY,[Qt,ze,bf,cm,ze,wf,fm,ze,zz,$z,ze,CT,Kz]),l0(zc,UHe,[Qt,ze,bf,cm,ze,wf,fm,ze,ST,wT,Ag,ze,qz,Xz,Zz]),zc);function zHe(t){var e=[],r=t;return pD[r]||(r=eY),_(pD[r],function(n){var o;n===ze?o={name:ze}:o=Rn(Ys(n)),e.push(o)}),e}function fd(t){"@babel/helpers - typeof";return fd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fd(t)}function YHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$He(n.key),n)}}function GHe(t,e,r){return e&&yD(t.prototype,e),r&&yD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $He(t){var e=KHe(t,"string");return fd(e)==="symbol"?e:String(e)}function KHe(t,e){if(fd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var u0="built",c0="building",mD=["click","input","keydown","keypress","keyup","focus","blur","change"],tY=function(){function t(e,r){YHe(this,t),this.hot=e,this.eventManager=new Tt(this),this.options=Yt(t.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}return GHe(t,[{key:"setValue",value:function(e){this.options.value=e,this.update()}},{key:"getValue",value:function(){return this.options.value}},{key:"element",get:function(){return this.buildState===c0?this._element:this.buildState===u0?(this.update(),this._element):(this.buildState=c0,this.build(),this.buildState=u0,this._element)}},{key:"isBuilt",value:function(){return this.buildState===u0}},{key:"translateIfPossible",value:function(e){return typeof e=="string"&&e.startsWith(vn)?this.hot.getTranslatedPhrase(e):e}},{key:"build",value:function(){var e=this,r=function(o,i){e.eventManager.addEventListener(o,i,function(a){return e.runLocalHooks(i,a,e)})};if(this.buildState||(this.buildState=c0),this.options.className&&te(this._element,this.options.className),this.options.children.length)_(this.options.children,function(o){return e._element.appendChild(o.element)});else if(this.options.wrapIt){var n=this.hot.rootDocument.createElement(this.options.tagName);$e(this.options,function(o,i){n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=e.translateIfPossible(o))}),this._element.appendChild(n),_(mD,function(o){return r(n,o)})}else _(mD,function(o){return r(e._element,o)})}},{key:"update",value:function(){}},{key:"reset",value:function(){this.options.value="",this.update()}},{key:"show",value:function(){this.element.style.display=""}},{key:"hide",value:function(){this.element.style.display="none"}},{key:"focus",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}],[{key:"DEFAULTS",get:function(){return Rn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}]),t}();pt(tY,Pn);const yi=tY;function du(t){"@babel/helpers - typeof";return du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},du(t)}function qHe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZHe(n.key),n)}}function XHe(t,e,r){return e&&gD(t.prototype,e),r&&gD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZHe(t){var e=QHe(t,"string");return du(e)==="symbol"?e:String(e)}function QHe(t,e){if(du(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hm(){return typeof Reflect<"u"&&Reflect.get?hm=Reflect.get.bind():hm=function(t,e,r){var n=JHe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},hm.apply(this,arguments)}function JHe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=pu(t),t!==null););return t}function eDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x1(t,e)}function x1(t,e){return x1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},x1(t,e)}function tDe(t){var e=rDe();return function(){var r=pu(t),n;if(e){var o=pu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nDe(this,n)}}function nDe(t,e){if(e&&(du(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nY(t)}function nY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pu(t){return pu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pu(t)}var vy=new WeakMap,oDe=function(t){eDe(r,t);var e=tDe(r);function r(n,o){var i;return qHe(this,r),i=e.call(this,n,Yt(r.DEFAULTS,o)),vy.set(nY(i),{}),i.registerHooks(),i}return XHe(r,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(){return n.onClick()}),this.addLocalHook("keyup",function(o){return n.onKeyup(o)})}},{key:"build",value:function(){hm(pu(r.prototype),"build",this).call(this);var n=vy.get(this),o=this.hot.rootDocument.createElement("div");n.input=this._element.firstChild,te(this._element,"htUIInput"),te(o,"htUIInputIcon"),this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=vy.get(this).input;n.type=this.options.type,n.placeholder=this.translateIfPossible(this.options.placeholder),n.value=this.translateIfPossible(this.options.value)}}},{key:"focus",value:function(){this.isBuilt()&&vy.get(this).input.focus()}},{key:"onClick",value:function(){}},{key:"onKeyup",value:function(n){this.options.value=n.target.value}}],[{key:"DEFAULTS",get:function(){return Rn({placeholder:"",type:"text",tagName:"input"})}}]),r}(yi);const Gs=oDe;function yu(t){"@babel/helpers - typeof";return yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yu(t)}function iDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sDe(n.key),n)}}function aDe(t,e,r){return e&&vD(t.prototype,e),r&&vD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sDe(t){var e=lDe(t,"string");return yu(e)==="symbol"?e:String(e)}function lDe(t,e){if(yu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $s(){return typeof Reflect<"u"&&Reflect.get?$s=Reflect.get.bind():$s=function(t,e,r){var n=uDe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},$s.apply(this,arguments)}function uDe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=mi(t),t!==null););return t}function cDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&A1(t,e)}function A1(t,e){return A1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},A1(t,e)}function fDe(t){var e=dDe();return function(){var r=mi(t),n;if(e){var o=mi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hDe(this,n)}}function hDe(t,e){if(e&&(yu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rY(t)}function rY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function mi(t){return mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mi(t)}var by=new WeakMap,pDe=function(t){cDe(r,t);var e=fDe(r);function r(n,o){var i;return iDe(this,r),i=e.call(this,n,Yt(r.DEFAULTS,o)),by.set(rY(i),{}),i.menu=null,i.items=[],i.registerHooks(),i}return aDe(r,[{key:"registerHooks",value:function(){var n=this;this.addLocalHook("click",function(){return n.onClick()})}},{key:"setItems",value:function(n){this.items=this.translateNames(n),this.menu&&this.menu.setMenuItems(this.items)}},{key:"translateNames",value:function(n){var o=this;return _(n,function(i){i.name=o.translateIfPossible(i.name)}),n}},{key:"build",value:function(){var n=this;$s(mi(r.prototype),"build",this).call(this),this.menu=new vT(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);var o=new yi(this.hot,{className:"htUISelectCaption"}),i=new yi(this.hot,{className:"htUISelectDropdown"}),a=by.get(this);a.caption=o,a.captionElement=o.element,a.dropdown=i,_([o,i],function(s){return n._element.appendChild(s.element)}),this.menu.addLocalHook("select",function(s){return n.onMenuSelect(s)}),this.menu.addLocalHook("afterClose",function(){return n.onMenuClosed()}),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n;this.options.value?n=this.options.value.name:n=this.menu.hot.getTranslatedPhrase(Mv),by.get(this).captionElement.textContent=n,$s(mi(r.prototype),"update",this).call(this)}}},{key:"openOptions",value:function(){var n=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?n.left-5:n.left-31,top:n.top-1,width:n.width,height:n.height}))}},{key:"closeOptions",value:function(){this.menu&&this.menu.close()}},{key:"onMenuSelect",value:function(n){n.name!==ze&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}},{key:"onMenuClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onClick",value:function(){this.openOptions()}},{key:"destroy",value:function(){this.menu&&(this.menu.destroy(),this.menu=null);var n=by.get(this),o=n.caption,i=n.dropdown;o&&o.destroy(),i&&i.destroy(),$s(mi(r.prototype),"destroy",this).call(this)}}],[{key:"DEFAULTS",get:function(){return Rn({className:"htUISelect",wrapIt:!1})}}]),r}(yi);const bD=pDe;function mu(t){"@babel/helpers - typeof";return mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mu(t)}function yDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,gDe(n.key),n)}}function mDe(t,e,r){return e&&wD(t.prototype,e),r&&wD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gDe(t){var e=vDe(t,"string");return mu(e)==="symbol"?e:String(e)}function vDe(t,e){if(mu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dm(){return typeof Reflect<"u"&&Reflect.get?dm=Reflect.get.bind():dm=function(t,e,r){var n=bDe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},dm.apply(this,arguments)}function bDe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=gu(t),t!==null););return t}function wDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j1(t,e)}function j1(t,e){return j1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},j1(t,e)}function SDe(t){var e=kDe();return function(){var r=gu(t),n;if(e){var o=gu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return CDe(this,n)}}function CDe(t,e){if(e&&(mu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ODe(t)}function ODe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gu(t){return gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gu(t)}var RDe=function(t){wDe(r,t);var e=SDe(r);function r(n,o){var i;return yDe(this,r),i=e.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.addSeparator=o.addSeparator,i.elements.push(new bD(i.hot,{menuContainer:o.menuContainer})),i.elements.push(new Gs(i.hot,{placeholder:$E})),i.elements.push(new Gs(i.hot,{placeholder:KE})),i.registerHooks(),i}return mDe(r,[{key:"registerHooks",value:function(){var n=this;this.getSelectElement().addLocalHook("select",function(o){return n.onConditionSelect(o)}),this.getSelectElement().addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),_(this.getInputElements(),function(o){o.addLocalHook("keydown",function(i){return n.onInputKeyDown(i)})})}},{key:"setState",value:function(n){var o=this;if(this.reset(),!!n){var i=Rn(n.command);i.name.startsWith(Pt)&&(i.name=this.hot.getTranslatedPhrase(i.name)),this.getSelectElement().setValue(i),_(n.args,function(a,s){if(s>i.inputsCount-1)return!1;var l=o.getInputElement(s);l.setValue(a),l[i.inputsCount>s?"show":"hide"](),s||setTimeout(function(){return l.focus()},10)})}}},{key:"getState",value:function(){var n=this.getSelectElement().getValue()||Ys(Qt),o=[];return _(this.getInputElements(),function(i,a){n.inputsCount>a&&o.push(i.getValue())}),{command:n,args:o}}},{key:"updateState",value:function(n,o){var i=Ys(n?n.name:Qt);this.state.setValueAtIndex(o,{command:i,args:n?n.args:[]}),n||_(this.getInputElements(),function(a){return a.setValue(null)})}},{key:"getSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof bD})[0]}},{key:"getInputElement",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[n]}},{key:"getInputElements",value:function(){return this.elements.filter(function(n){return n instanceof Gs})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i,a,s,l,u){te(i.parentNode,"htFiltersMenuCondition"),n.addSeparator&&te(i.parentNode,"border");var c=n.hot.rootDocument.createElement("div");return te(c,"htFiltersMenuLabel"),c.textContent=u,i.appendChild(c),i.parentNode.hasAttribute("ghost-table")||_(n.elements,function(f){return i.appendChild(f.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn(),o=[Ys(Qt)];if(n!==null){var i=n.visualIndex;o=zHe(this.hot.getDataType(0,i,this.hot.countRows(),i))}_(this.getInputElements(),function(a){return a.hide()}),this.getSelectElement().setItems(o),dm(gu(r.prototype),"reset",this).call(this),this.getSelectElement().setValue(o[0])}},{key:"onConditionSelect",value:function(n){_(this.getInputElements(),function(o,i){o[n.inputsCount>i?"show":"hide"](),i===0&&setTimeout(function(){return o.focus()},10)}),this.runLocalHooks("change",n)}},{key:"onSelectUIClosed",value:function(){this.runLocalHooks("afterClose")}},{key:"onInputKeyDown",value:function(n){jf(n.keyCode,"ENTER")?(this.runLocalHooks("accept"),Lr(n)):jf(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(n))}}]),r}(nb);const f0=RDe;function vu(t){"@babel/helpers - typeof";return vu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vu(t)}function EDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,PDe(n.key),n)}}function TDe(t,e,r){return e&&SD(t.prototype,e),r&&SD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function PDe(t){var e=MDe(t,"string");return vu(e)==="symbol"?e:String(e)}function MDe(t,e){if(vu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pm(){return typeof Reflect<"u"&&Reflect.get?pm=Reflect.get.bind():pm=function(t,e,r){var n=_De(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},pm.apply(this,arguments)}function _De(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=bu(t),t!==null););return t}function xDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I1(t,e)}function I1(t,e){return I1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},I1(t,e)}function ADe(t){var e=IDe();return function(){var r=bu(t),n;if(e){var o=bu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jDe(this,n)}}function jDe(t,e){if(e&&(vu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oY(t)}function oY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bu(t){return bu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bu(t)}var wy=new WeakMap,HDe=function(t){xDe(r,t);var e=ADe(r);function r(n,o){var i;return EDe(this,r),i=e.call(this,n,Yt(r.DEFAULTS,o)),wy.set(oY(i),{}),i}return TDe(r,[{key:"build",value:function(){pm(bu(r.prototype),"build",this).call(this);var n=wy.get(this);n.input=this._element.firstChild;var o=this.hot.rootDocument.createElement("label");o.textContent=this.translateIfPossible(this.options.label.textContent),o.htmlFor=this.translateIfPossible(this.options.label.htmlFor),n.label=o,this._element.appendChild(o),this.update()}},{key:"update",value:function(){if(this.isBuilt()){var n=wy.get(this);n.input.checked=this.options.checked,n.label.textContent=this.translateIfPossible(this.options.label.textContent)}}},{key:"isChecked",value:function(){return this.options.checked}},{key:"setChecked",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=n,this.update()}},{key:"focus",value:function(){this.isBuilt()&&wy.get(this).input.focus()}}],[{key:"DEFAULTS",get:function(){return Rn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}}]),r}(yi);const CD=HDe;function wu(t){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wu(t)}var OD;function DDe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function NDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BDe(n.key),n)}}function LDe(t,e,r){return e&&kD(t.prototype,e),r&&kD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BDe(t){var e=VDe(t,"string");return wu(e)==="symbol"?e:String(e)}function VDe(t,e){if(wu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&H1(t,e)}function H1(t,e){return H1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},H1(t,e)}function WDe(t){var e=YDe();return function(){var r=Ig(t),n;if(e){var o=Ig(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UDe(this,n)}}function UDe(t,e){if(e&&(wu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zDe(t)}function zDe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ig(t){return Ig=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ig(t)}var RD=0,GDe=function(t){FDe(r,t);var e=WDe(r);function r(n,o){var i;return NDe(this,r),i=e.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.buildOperatorsElement(),i}return LDe(r,[{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i){return te(i.parentNode,"htFiltersMenuOperators"),i.parentNode.hasAttribute("ghost-table")||_(n.elements,function(a){return i.appendChild(a.element)}),i}}}},{key:"buildOperatorsElement",value:function(){var n=this,o=[pi,jg];_(o,function(i){var a=new CD(n.hot,{name:"operator",label:{htmlFor:i,textContent:jHe(i)},value:i,checked:i===o[RD],id:i});a.addLocalHook("change",function(s){return n.onRadioInputChange(s)}),n.elements.push(a)})}},{key:"setChecked",value:function(n){if(this.elements.length<n)throw Error(it(OD||(OD=DDe(["Radio button with index "," doesn't exist."])),n));_(this.elements,function(o,i){o.setChecked(i===n)})}},{key:"getActiveOperationId",value:function(){var n=this.elements.find(function(o){return o instanceof CD&&o.isChecked()});return n?n.getValue():pi}},{key:"getState",value:function(){return this.getActiveOperationId()}},{key:"setState",value:function(n){this.reset(),n&&this.getActiveOperationId()!==n&&_(this.elements,function(o){o.setChecked(o.getValue()===n)})}},{key:"updateState",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pi,o=arguments.length>1?arguments[1]:void 0,i=n;i===kT&&(i=jg),this.state.setValueAtIndex(o,i)}},{key:"reset",value:function(){this.setChecked(RD)}},{key:"onRadioInputChange",value:function(n){this.setState(n.target.value)}}]),r}(nb);const $De=GDe;var KDe=We,qDe=En,ED=Bt,XDe=/"/g,ZDe=KDe("".replace),QDe=function(t,e,r,n){var o=ED(qDe(t)),i="<"+e;return r!==""&&(i+=" "+r+'="'+ZDe(ED(n),XDe,"&quot;")+'"'),i+">"+o+"</"+e+">"},JDe=Fe,eNe=function(t){return JDe(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})},tNe=_e,nNe=QDe,rNe=eNe;tNe({target:"String",proto:!0,forced:rNe("link")},{link:function(t){return nNe(this,"a","href",t)}});function Su(t){"@babel/helpers - typeof";return Su=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Su(t)}function oNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aNe(n.key),n)}}function iNe(t,e,r){return e&&TD(t.prototype,e),r&&TD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aNe(t){var e=sNe(t,"string");return Su(e)==="symbol"?e:String(e)}function sNe(t,e){if(Su(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Su(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ym(){return typeof Reflect<"u"&&Reflect.get?ym=Reflect.get.bind():ym=function(t,e,r){var n=lNe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ym.apply(this,arguments)}function lNe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Cu(t),t!==null););return t}function uNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D1(t,e)}function D1(t,e){return D1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},D1(t,e)}function cNe(t){var e=hNe();return function(){var r=Cu(t),n;if(e){var o=Cu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fNe(this,n)}}function fNe(t,e){if(e&&(Su(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iY(t)}function iY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function hNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(t){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cu(t)}var h0=new WeakMap,dNe=function(t){uNe(r,t);var e=cNe(r);function r(n,o){var i;return oNe(this,r),i=e.call(this,n,Yt(r.DEFAULTS,o)),h0.set(iY(i),{}),i}return iNe(r,[{key:"build",value:function(){ym(Cu(r.prototype),"build",this).call(this);var n=h0.get(this);n.link=this._element.firstChild}},{key:"update",value:function(){this.isBuilt()&&(h0.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}],[{key:"DEFAULTS",get:function(){return Rn({href:"#",tagName:"a"})}}]),r}(yi);const PD=dNe;function Ou(t){"@babel/helpers - typeof";return Ou=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ou(t)}function MD(t){return gNe(t)||mNe(t)||yNe(t)||pNe()}function pNe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yNe(t,e){if(t){if(typeof t=="string")return N1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N1(t,e)}}function mNe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function gNe(t){if(Array.isArray(t))return N1(t)}function N1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wNe(n.key),n)}}function bNe(t,e,r){return e&&_D(t.prototype,e),r&&_D(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wNe(t){var e=SNe(t,"string");return Ou(e)==="symbol"?e:String(e)}function SNe(t,e){if(Ou(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ou(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ks(){return typeof Reflect<"u"&&Reflect.get?Ks=Reflect.get.bind():Ks=function(t,e,r){var n=CNe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Ks.apply(this,arguments)}function CNe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=gi(t),t!==null););return t}function ONe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L1(t,e)}function L1(t,e){return L1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},L1(t,e)}function kNe(t){var e=ENe();return function(){var r=gi(t),n;if(e){var o=gi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return RNe(this,n)}}function RNe(t,e){if(e&&(Ou(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aY(t)}function aY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ENe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gi(t){return gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gi(t)}var TNe=new WeakMap,PNe="multipleSelect.itemBox",MNe=function(t){ONe(r,t);var e=kNe(r);function r(n,o){var i;return vNe(this,r),i=e.call(this,n,Yt(r.DEFAULTS,o)),TNe.set(aY(i),{}),i.searchInput=new Gs(i.hot,{placeholder:GE,className:"htUIMultipleSelectSearch"}),i.selectAllUI=new PD(i.hot,{textContent:WE,className:"htUISelectAll"}),i.clearAllUI=new PD(i.hot,{textContent:UE,className:"htUIClearAll"}),i.items=[],i.itemsBox=null,i.registerHooks(),i}return bNe(r,[{key:"registerHooks",value:function(){var n=this;this.searchInput.addLocalHook("keydown",function(o){return n.onInputKeyDown(o)}),this.searchInput.addLocalHook("input",function(o){return n.onInput(o)}),this.selectAllUI.addLocalHook("click",function(o){return n.onSelectAllClick(o)}),this.clearAllUI.addLocalHook("click",function(o){return n.onClearAllClick(o)})}},{key:"setItems",value:function(n){this.items=n,this.itemsBox&&this.itemsBox.loadData(this.items)}},{key:"setLocale",value:function(n){this.locale=n}},{key:"getLocale",value:function(){return this.locale}},{key:"getItems",value:function(){return MD(this.items)}},{key:"getValue",value:function(){return xNe(this.items)}},{key:"isSelectedAllValues",value:function(){return this.items.length===this.getValue().length}},{key:"build",value:function(){var n=this;Ks(gi(r.prototype),"build",this).call(this);var o=this.hot.rootDocument,i=o.createElement("div"),a=new yi(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(a.element),this._element.appendChild(i);var s=function(l){if(n._element){n.itemsBox&&n.itemsBox.destroy(),te(l,"htUIMultipleSelectHot"),n.itemsBox=new n.hot.constructor(l,{data:n.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:function(f,h,p,y,g,v){f.title=v.instance.getDataAtRowProp(h,v.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:function(){return n.itemsBox.container.scrollWidth-en(o)},copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:n.hot.isRtl()?"rtl":"ltr"}),n.itemsBox.init();var u=n.itemsBox.getShortcutManager(),c=u.getContext("grid");c.addShortcut({keys:[["Escape"]],callback:function(f){n.runLocalHooks("keydown",f,n)},group:PNe})}};s(i),setTimeout(function(){return s(i)},100)}},{key:"reset",value:function(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}},{key:"update",value:function(){this.isBuilt()&&(this.itemsBox.loadData(_Ne(this.items,this.options.value)),Ks(gi(r.prototype),"update",this).call(this))}},{key:"destroy",value:function(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,Ks(gi(r.prototype),"destroy",this).call(this)}},{key:"onInput",value:function(n){var o=this,i=n.target.value.toLocaleLowerCase(this.getLocale()),a;i===""?a=MD(this.items):a=Xn(this.items,function(s){return"".concat(s.value).toLocaleLowerCase(o.getLocale()).indexOf(i)>=0}),this.itemsBox.loadData(a)}},{key:"onInputKeyDown",value:function(n){this.runLocalHooks("keydown",n,this);var o=mW(jf,n.keyCode);o("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Lr(n),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}},{key:"onSelectAllClick",value:function(n){var o=[];n.preventDefault(),_(this.itemsBox.getSourceData(),function(i,a){i.checked=!0,o.push(HA(i,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}},{key:"onClearAllClick",value:function(n){var o=[];n.preventDefault(),_(this.itemsBox.getSourceData(),function(i,a){i.checked=!1,o.push(HA(i,a)[0])}),this.itemsBox.setSourceDataAtCell(o)}}],[{key:"DEFAULTS",get:function(){return Rn({className:"htUIMultipleSelect",value:[]})}}]),r}(yi);const xD=MNe;function _Ne(t,e){var r=wp(e);return Ye(t,function(n){return n.checked=r(n.value),n})}function xNe(t){var e=[];return _(t,function(r){r.checked&&e.push(r.value)}),e}function ku(t){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ku(t)}function ANe(t,e){return DNe(t)||HNe(t,e)||INe(t,e)||jNe()}function jNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function INe(t,e){if(t){if(typeof t=="string")return AD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AD(t,e)}}function AD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function HNe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function DNe(t){if(Array.isArray(t))return t}function NNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BNe(n.key),n)}}function LNe(t,e,r){return e&&jD(t.prototype,e),r&&jD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BNe(t){var e=VNe(t,"string");return ku(e)==="symbol"?e:String(e)}function VNe(t,e){if(ku(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mm(){return typeof Reflect<"u"&&Reflect.get?mm=Reflect.get.bind():mm=function(t,e,r){var n=FNe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},mm.apply(this,arguments)}function FNe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ru(t),t!==null););return t}function WNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B1(t,e)}function B1(t,e){return B1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},B1(t,e)}function UNe(t){var e=GNe();return function(){var r=Ru(t),n;if(e){var o=Ru(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zNe(this,n)}}function zNe(t,e){if(e&&(ku(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return YNe(t)}function YNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ru(t){return Ru=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ru(t)}var $Ne=function(t){WNe(r,t);var e=UNe(r);function r(n,o){var i;return NNe(this,r),i=e.call(this,n,{id:o.id,stateless:!1}),i.name=o.name,i.elements.push(new xD(i.hot)),i.registerHooks(),i}return LNe(r,[{key:"registerHooks",value:function(){var n=this;this.getMultipleSelectElement().addLocalHook("keydown",function(o){return n.onInputKeyDown(o)})}},{key:"setState",value:function(n){if(this.reset(),n&&n.command.key===ua){var o=this.getMultipleSelectElement();o.setItems(n.itemsSnapshot),o.setValue(n.args[0]),o.setLocale(n.locale)}}},{key:"getState",value:function(){var n=this.getMultipleSelectElement(),o=n.getItems();return{command:{key:n.isSelectedAllValues()||!o.length?Qt:ua},args:[n.getValue()],itemsSnapshot:o}}},{key:"updateState",value:function(n){var o=this,i=function(a,s,l,u,c){var f=Xn(s,function(x){return x.name===ua}),h=ANe(f,1),p=h[0],y={},g=o.hot.getTranslatedPhrase(gg);if(p){var v=_1(Ye(u(a,c),function(x){return x.value}));l&&(p.args[0]=l);var S=[],O=hD(v,p.args[0],g,function(x){x.checked&&S.push(x.value)}),w=n.editedConditionStack.column;y.locale=o.hot.getCellMeta(0,w).locale,y.args=[S],y.command=Ys(ua),y.itemsSnapshot=O}else y.args=[],y.command=Ys(Qt);o.state.setValueAtIndex(a,y)};i(n.editedConditionStack.column,n.editedConditionStack.conditions,n.conditionArgsChange,n.filteredRowsFactory),n.dependentConditionStacks.length&&i(n.dependentConditionStacks[0].column,n.dependentConditionStacks[0].conditions,n.conditionArgsChange,n.filteredRowsFactory,n.editedConditionStack)}},{key:"getMultipleSelectElement",value:function(){return this.elements.filter(function(n){return n instanceof xD})[0]}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i,a,s,l,u){te(i.parentNode,"htFiltersMenuValue");var c=n.hot.rootDocument.createElement("div");return te(c,"htFiltersMenuLabel"),c.textContent=u,i.appendChild(c),i.parentNode.hasAttribute("ghost-table")||_(n.elements,function(f){return i.appendChild(f.element)}),i}}}},{key:"reset",value:function(){var n=this.hot.getTranslatedPhrase(gg),o=_1(this._getColumnVisibleValues()),i=hD(o,o,n);this.getMultipleSelectElement().setItems(i),mm(Ru(r.prototype),"reset",this).call(this),this.getMultipleSelectElement().setValue(o);var a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}},{key:"onInputKeyDown",value:function(n){jf(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(n))}},{key:"_getColumnVisibleValues",value:function(){var n=this.hot.getPlugin("filters").getSelectedColumn();return n===null?[]:Ye(this.hot.getDataAtCol(n.visualIndex),function(o){return Qz(o)})}}]),r}(nb);const KNe=$Ne;function Eu(t){"@babel/helpers - typeof";return Eu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eu(t)}function qNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ID(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZNe(n.key),n)}}function XNe(t,e,r){return e&&ID(t.prototype,e),r&&ID(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZNe(t){var e=QNe(t,"string");return Eu(e)==="symbol"?e:String(e)}function QNe(t,e){if(Eu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Eu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V1(t,e)}function V1(t,e){return V1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},V1(t,e)}function eLe(t){var e=rLe();return function(){var r=Hg(t),n;if(e){var o=Hg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tLe(this,n)}}function tLe(t,e){if(e&&(Eu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nLe(t)}function nLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Hg(t){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hg(t)}var oLe=function(t){JNe(r,t);var e=eLe(r);function r(n,o){var i;return qNe(this,r),i=e.call(this,n,{id:o.id,stateless:!0}),i.name=o.name,i.elements.push(new Gs(i.hot,{type:"button",value:zE,className:"htUIButton htUIButtonOK",identifier:r.BUTTON_OK})),i.elements.push(new Gs(i.hot,{type:"button",value:YE,className:"htUIButton htUIButtonCancel",identifier:r.BUTTON_CANCEL})),i.registerHooks(),i}return XNe(r,[{key:"registerHooks",value:function(){var n=this;_(this.elements,function(o){o.addLocalHook("click",function(i,a){return n.onButtonClick(i,a)})})}},{key:"getMenuItemDescriptor",value:function(){var n=this;return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:function(){return n.isHidden()},renderer:function(o,i){return te(i.parentNode,"htFiltersMenuActionBar"),i.parentNode.hasAttribute("ghost-table")||_(n.elements,function(a){return i.appendChild(a.element)}),i}}}},{key:"accept",value:function(){this.runLocalHooks("accept")}},{key:"cancel",value:function(){this.runLocalHooks("cancel")}},{key:"onButtonClick",value:function(n,o){o.options.identifier===r.BUTTON_OK?this.accept():this.cancel()}}],[{key:"BUTTON_OK",get:function(){return"ok"}},{key:"BUTTON_CANCEL",get:function(){return"cancel"}}]),r}(nb);const iLe=oLe;function hd(t){"@babel/helpers - typeof";return hd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hd(t)}var HD,DD;function ND(t,e){return uLe(t)||lLe(t,e)||sLe(t,e)||aLe()}function aLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sLe(t,e){if(t){if(typeof t=="string")return LD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LD(t,e)}}function LD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function lLe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function uLe(t){if(Array.isArray(t))return t}function BD(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function cLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hLe(n.key),n)}}function fLe(t,e,r){return e&&VD(t.prototype,e),r&&VD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hLe(t){var e=dLe(t,"string");return hd(e)==="symbol"?e:String(e)}function dLe(t,e){if(hd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(hd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FD="ConditionCollection.filteringStates",sY=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;cLe(this,t),this.hot=e,this.isMapRegistrable=r,this.filteringStates=new Pv,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(FD,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}return fLe(t,[{key:"isEmpty",value:function(){return this.getFilteredColumns().length===0}},{key:"isMatch",value:function(e,r){var n,o=this.filteringStates.getValueAtIndex(r),i=(n=o==null?void 0:o.conditions)!==null&&n!==void 0?n:[],a=o==null?void 0:o.operation;return this.isMatchInConditions(i,e,a)}},{key:"isMatchInConditions",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pi;return e.length?AHe(n)(e,r):!0}},{key:"addCondition",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:pi,o=arguments.length>3?arguments[3]:void 0,i=this.hot.getCellMeta(0,e).locale,a=Ye(r.args,function(c){return typeof c=="string"?c.toLocaleLowerCase(i):c}),s=r.name||r.command.key;this.runLocalHooks("beforeAdd",e);var l=this.getOperation(e);if(l){if(l!==n)throw Error(it(HD||(HD=BD(["The column of index "," has been already applied with a `","` \n        filter operation. Use `removeConditions` to clear the current conditions and then add new ones. \n        Mind that you cannot mix different types of operations (for instance, if you use `conjunction`, \n        use it consequently for a particular column)."],["The column of index "," has been already applied with a \\`","\\`\\x20\n        filter operation. Use \\`removeConditions\\` to clear the current conditions and then add new ones.\\x20\n        Mind that you cannot mix different types of operations (for instance, if you use \\`conjunction\\`,\\x20\n        use it consequently for a particular column)."])),e,l))}else if(dt(ud[n]))throw new Error(it(DD||(DD=BD(["Unexpected operation named `","`. Possible ones are \n        `disjunction` and `conjunction`."],["Unexpected operation named \\`","\\`. Possible ones are\\x20\n        \\`disjunction\\` and \\`conjunction\\`."])),n));var u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:s,args:a,func:Ci(s,a)}]},o):u.push({name:s,args:a,func:Ci(s,a)}),this.runLocalHooks("afterAdd",e)}},{key:"getConditions",value:function(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}},{key:"getOperation",value:function(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}},{key:"getFilteredColumns",value:function(){return this.filteringStates.getEntries().map(function(e){var r=ND(e,1),n=r[0];return n})}},{key:"getColumnStackPosition",value:function(e){return this.getFilteredColumns().indexOf(e)}},{key:"exportAllConditions",value:function(){return an(this.filteringStates.getEntries(),function(e,r){var n=ND(r,2),o=n[0],i=n[1],a=i.operation,s=i.conditions;return e.push({column:o,operation:a,conditions:Ye(s,function(l){var u=l.name,c=l.args;return{name:u,args:c}})}),e},[])}},{key:"importAllConditions",value:function(e){var r=this;this.clean(),_(e,function(n){_(n.conditions,function(o){return r.addCondition(n.column,o)})})}},{key:"removeConditions",value:function(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}},{key:"clean",value:function(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}},{key:"hasConditions",value:function(e,r){var n=this.getConditions(e);return r?n.some(function(o){return o.name===r}):n.length>0}},{key:"destroy",value:function(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(FD),this.filteringStates=null,this.clearLocalHooks()}}]),t}();pt(sY,Pn);const lY=sY;function dd(t){"@babel/helpers - typeof";return dd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dd(t)}function pLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mLe(n.key),n)}}function yLe(t,e,r){return e&&WD(t.prototype,e),r&&WD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mLe(t){var e=gLe(t,"string");return dd(e)==="symbol"?e:String(e)}function gLe(t,e){if(dd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(dd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vLe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return[]};pLe(this,t),this.conditionCollection=e,this.columnDataFactory=r}return yLe(t,[{key:"filter",value:function(){var e=this,r=[];return _(this.conditionCollection.getFilteredColumns(),function(n,o){var i=e.columnDataFactory(n);o&&(i=e._getIntersectData(i,r)),r=e.filterByColumn(n,i)}),r}},{key:"filterByColumn",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=[];return _(n,function(i){i!==void 0&&r.conditionCollection.isMatch(i,e)&&o.push(i)}),o}},{key:"_getIntersectData",value:function(e,r){var n=[];return _(r,function(o){var i=o.meta.visualRow;e[i]!==void 0&&(n[i]=e[i])}),n}}]),t}();const uY=vLe;function pd(t){"@babel/helpers - typeof";return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pd(t)}function bLe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SLe(n.key),n)}}function wLe(t,e,r){return e&&UD(t.prototype,e),r&&UD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function SLe(t){var e=CLe(t,"string");return pd(e)==="symbol"?e:String(e)}function CLe(t,e){if(pd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cY=function(){function t(e,r){var n=this,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return[]};bLe(this,t),this.hot=e,this.conditionCollection=r,this.columnDataFactory=o,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",function(i){return n._onConditionBeforeModify(i)}),this.conditionCollection.addLocalHook("afterRemove",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("afterAdd",function(i){return n.updateStatesAtColumn(i)}),this.conditionCollection.addLocalHook("beforeClean",function(){return n._onConditionBeforeClean()}),this.conditionCollection.addLocalHook("afterClean",function(){return n._onConditionAfterClean()})}return wLe(t,[{key:"groupChanges",value:function(){this.grouping=!0}},{key:"flush",value:function(){var e=this;this.grouping=!1,_(this.changes,function(r){e.updateStatesAtColumn(r)}),this.changes.length=0}},{key:"_onConditionBeforeModify",value:function(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}},{key:"updateStatesAtColumn",value:function(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}var o=this.conditionCollection.exportAllConditions(),i=this.conditionCollection.getColumnStackPosition(e);i===-1&&(i=this.latestEditedColumnPosition);var a=o.slice(0,i),s=o.slice(i);s.length&&s[0].column===e&&s.shift();var l=sae(function(c,f){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],p=new lY(n.hot,!1),y=[].concat(c,h);p.importAllConditions(y);var g=n.columnDataFactory(f),v;p.isEmpty()?v=g:v=new uY(p,function(O){return n.columnDataFactory(O)}).filter(),v=Ye(v,function(O){return O.meta.visualRow});var S=wp(v);return p.destroy(),Xn(g,function(O){return S(O.meta.visualRow)})})(a),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:r})}},{key:"_onConditionBeforeClean",value:function(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}},{key:"_onConditionAfterClean",value:function(){var e=this;_(this.latestOrderStack,function(r){e.updateStatesAtColumn(r)})}},{key:"destroy",value:function(){var e=this;this.clearLocalHooks(),$e(this,function(r,n){e[n]=null})}}]),t}();pt(cY,Pn);const OLe=cY;function Tu(t){"@babel/helpers - typeof";return Tu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tu(t)}var zD;function kLe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function RLe(t,e){return MLe(t)||PLe(t,e)||TLe(t,e)||ELe()}function ELe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TLe(t,e){if(t){if(typeof t=="string")return YD(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return YD(t,e)}}function YD(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function PLe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function MLe(t){if(Array.isArray(t))return t}function _Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function GD(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ALe(n.key),n)}}function xLe(t,e,r){return e&&GD(t.prototype,e),r&&GD(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ALe(t){var e=jLe(t,"string");return Tu(e)==="symbol"?e:String(e)}function jLe(t,e){if(Tu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Tu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qs(){return typeof Reflect<"u"&&Reflect.get?qs=Reflect.get.bind():qs=function(t,e,r){var n=ILe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},qs.apply(this,arguments)}function ILe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=vi(t),t!==null););return t}function HLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F1(t,e)}function F1(t,e){return F1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},F1(t,e)}function DLe(t){var e=LLe();return function(){var r=vi(t),n;if(e){var o=vi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return NLe(this,n)}}function NLe(t,e){if(e&&(Tu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fY(t)}function fY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function LLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vi(t){return vi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vi(t)}var $D="filters",BLe=250,VLe=function(t){HLe(r,t);var e=DLe(r);function r(n){var o;return _Le(this,r),o=e.call(this,n),o.eventManager=new Tt(fY(o)),o.dropdownMenuPlugin=null,o.conditionCollection=null,o.conditionUpdateObserver=null,o.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),o.filtersRowsMap=null,o.hot.addHook("afterGetColHeader",function(i,a){return o.onAfterGetColHeader(i,a)}),o}return xLe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[$D]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new hp),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var o=this.hot.getSettings().dropdownMenu,i=o&&o.uiContainer||this.hot.rootDocument.body,a=function(f){return f.addLocalHook("accept",function(){return n.onActionBarSubmit("accept")}),f.addLocalHook("cancel",function(){return n.onActionBarSubmit("cancel")}),f.addLocalHook("change",function(h){return n.onComponentChange(f,h)}),f},s=function(){return"".concat(n.hot.getTranslatedPhrase(BE),":")},l=function(){return"".concat(n.hot.getTranslatedPhrase(VE),":")};if(!this.components.get("filter_by_condition")){var u=new f0(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});u.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition",a(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new $De(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){var c=new f0(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});c.addLocalHook("afterClose",function(){return n.onSelectUIClosed()}),this.components.set("filter_by_condition2",a(c))}this.components.get("filter_by_value")||this.components.set("filter_by_value",a(new KNe(this.hot,{id:"filter_by_value",name:l}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",a(new iLe(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new lY(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new OLe(this.hot,this.conditionCollection,function(f){return n.getDataMapAtColumn(f)}),this.conditionUpdateObserver.addLocalHook("update",function(f){return n.updateComponents(f)})),this.components.forEach(function(f){return f.show()}),this.addHook("beforeDropdownMenuSetItems",function(f){return n.onBeforeDropdownMenuSetItems(f)}),this.addHook("afterDropdownMenuDefaultOptions",function(f){return n.onAfterDropdownMenuDefaultOptions(f)}),this.addHook("afterDropdownMenuShow",function(){return n.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return n.onAfterDropdownMenuHide()}),this.addHook("afterChange",function(f){return n.onAfterChange(f)}),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),qs(vi(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this;if(this.enabled){var o;(o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(function(i,a){i.destroy(),n.components.set(a,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}qs(vi(r.prototype),"disablePlugin",this).call(this)}},{key:"addCondition",value:function(n,o,i){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:pi,s=this.hot.toPhysicalColumn(n);this.conditionCollection.addCondition(s,{command:{key:o},args:i},a)}},{key:"removeConditions",value:function(n){var o=this.hot.toPhysicalColumn(n);this.conditionCollection.removeConditions(o)}},{key:"clearConditions",value:function(n){if(n===void 0)this.conditionCollection.clean();else{var o=this.hot.toPhysicalColumn(n);this.conditionCollection.removeConditions(o)}}},{key:"filter",value:function(){var n=this,o=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),a=[],s=this.conditionCollection.exportAllConditions(),l=this.hot.runHooks("beforeFilter",s);if(l!==!1)if(i){var u=[];this.hot.batchExecution(function(){n.filtersRowsMap.clear(),a=Ye(o.filter(),function(f){return f.meta.visualRow});var c=wp(a);Oe(n.hot.countSourceRows()-1,function(f){c(f)||u.push(f)}),_(u,function(f){n.filtersRowsMap.setValueAtIndex(f,!0)})},!0),a.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}},{key:"getSelectedColumn",value:function(){var n,o=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return o?{visualIndex:o.col,physicalIndex:this.hot.toPhysicalColumn(o.col)}:null}},{key:"clearColumnSelection",value:function(){var n=this.getSelectedColumn();n!==null&&this.hot.selectCell(0,n.visualIndex)}},{key:"getDataMapAtColumn",value:function(n){var o=this,i=this.hot.toVisualColumn(n),a=[];return _(this.hot.getSourceDataAtCol(i),function(s,l){var u,c=o.hot.getCellMeta(l,i),f=c.row,h=c.col,p=c.visualCol,y=c.visualRow,g=c.type,v=c.instance,S=c.dateFormat,O=c.locale,w=(u=o.hot.getDataAtCell(o.hot.toVisualRow(l),i))!==null&&u!==void 0?u:s;a.push({meta:{row:f,col:h,visualCol:p,visualRow:y,type:g,instance:v,dateFormat:S,locale:O},value:Qz(w)})}),a}},{key:"onAfterChange",value:function(n){var o=this;n&&_(n,function(i){var a=RLe(i,2),s=a[1],l=o.hot.propToCol(s);o.conditionCollection.hasConditions(l)&&o.updateValueComponentCondition(l)})}},{key:"updateValueComponentCondition",value:function(n){var o=this.hot.getDataAtCol(n),i=_1(o);this.conditionUpdateObserver.updateStatesAtColumn(n,i)}},{key:"restoreComponents",value:function(n){var o,i=(o=this.getSelectedColumn())===null||o===void 0?void 0:o.physicalIndex;n.forEach(function(a){a.isHidden()||a.restoreState(i)}),this.updateDependentComponentsVisibility()}},{key:"onAfterDropdownMenuShow",value:function(){this.restoreComponents(Array.from(this.components.values()))}},{key:"onAfterDropdownMenuHide",value:function(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}},{key:"onBeforeDropdownMenuSetItems",value:function(){var n=this;this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",function(){n.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}},{key:"onAfterDropdownMenuDefaultOptions",value:function(n){n.items.push({name:ze}),this.components.forEach(function(o){n.items.push(o.getMenuItemDescriptor())})}},{key:"getOperationBasedOnArguments",value:function(n,o,i,a){var s=n;return s===jg&&o.command.key!==Qt&&i.command.key!==Qt&&a.command.key!==Qt?s=kT:a.command.key!==Qt&&(o.command.key===Qt||i.command.key===Qt)&&(s=pi),s}},{key:"onActionBarSubmit",value:function(n){var o;if(n==="accept"){var i=this.getSelectedColumn();if(i===null){var a;(a=this.dropdownMenuPlugin)===null||a===void 0||a.close();return}var s=i.physicalIndex,l=this.components.get("filter_by_condition").getState(),u=this.components.get("filter_by_condition2").getState(),c=this.components.get("filter_by_value").getState(),f=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),l,u,c);this.conditionUpdateObserver.groupChanges();var h=this.conditionCollection.getColumnStackPosition(s);h===-1&&(h=void 0),this.conditionCollection.removeConditions(s),l.command.key!==Qt&&(this.conditionCollection.addCondition(s,l,f,h),u.command.key!==Qt&&this.conditionCollection.addCondition(s,u,f,h)),c.command.key!==Qt&&this.conditionCollection.addCondition(s,c,f,h),this.conditionUpdateObserver.flush(),this.components.forEach(function(p){return p.saveState(s)}),this.filtersRowsMap.clear(),this.filter()}(o=this.dropdownMenuPlugin)===null||o===void 0||o.close()}},{key:"onComponentChange",value:function(n,o){this.updateDependentComponentsVisibility(),n.constructor===f0&&!o.inputsCount&&this.setListeningDropdownMenu()}},{key:"onSelectUIClosed",value:function(){this.setListeningDropdownMenu()}},{key:"setListeningDropdownMenu",value:function(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}},{key:"updateDependentComponentsVisibility",value:function(){var n=this.components.get("filter_by_condition"),o=n.getState(),i=o.command,a=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];i.showOperators?this.showComponents.apply(this,a):this.hideComponents.apply(this,a)}},{key:"onAfterGetColHeader",value:function(n,o){var i=this.hot.toPhysicalColumn(n);this.enabled&&this.conditionCollection.hasConditions(i)?te(o,"htFiltersActive"):Ne(o,"htFiltersActive")}},{key:"_createDataFilter",value:function(){var n=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new uY(o,function(i){return n.getDataMapAtColumn(i)})}},{key:"updateComponents",value:function(n){var o;if((o=this.dropdownMenuPlugin)!==null&&o!==void 0&&o.enabled){var i=n.editedConditionStack,a=i.conditions,s=i.column,l=a.filter(function(f){return f.name===ua}),u=a.filter(function(f){return f.name!==ua});if(l.length>=2||u.length>=3)lt(it(zD||(zD=kLe([`The filter conditions have been applied properly, but couldn’t be displayed visually. 
        The overall amount of conditions exceed the capability of the dropdown menu. 
        For more details see the documentation.`],[`The filter conditions have been applied properly, but couldn’t be displayed visually.\\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\\x20
        For more details see the documentation.`]))));else{var c=this.conditionCollection.getOperation(s);this.components.get("filter_by_condition").updateState(u[0],s),this.components.get("filter_by_condition2").updateState(u[1],s),this.components.get("filter_operators").updateState(c,s),this.components.get("filter_by_value").updateState(n)}}}},{key:"getIndexesOfComponents",value:function(){var n=[];if(!this.dropdownMenuPlugin)return n;for(var o=this.dropdownMenuPlugin.menu,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return _(a,function(l){_(o.menuItems,function(u,c){u.key===l.getMenuItemDescriptor().key&&n.push(c)})}),n}},{key:"changeComponentsVisibility",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(this.dropdownMenuPlugin){for(var o=this.dropdownMenuPlugin.menu,i=o.hotMenu,a=i.getPlugin("hiddenRows"),s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];var c=this.getIndexesOfComponents.apply(this,l);n?a.showRows(c):a.hideRows(c),i.render()}}},{key:"hideComponents",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.changeComponentsVisibility.apply(this,[!1].concat(o))}},{key:"showComponents",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.changeComponentsVisibility.apply(this,[!0].concat(o))}},{key:"destroy",value:function(){var n=this;this.enabled&&(this.components.forEach(function(o,i){o!==null&&(o.destroy(),n.components.set(i,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),qs(vi(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return $D}},{key:"PLUGIN_PRIORITY",get:function(){return BLe}},{key:"PLUGIN_DEPS",get:function(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}}]),r}(at);function yd(t){"@babel/helpers - typeof";return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(t)}function KD(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Sf(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?KD(Object(r),!0).forEach(function(n){FLe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):KD(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function FLe(t,e,r){return e=WLe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WLe(t){var e=ULe(t,"string");return yd(e)==="symbol"?e:String(e)}function ULe(t,e){if(yd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(yd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hY="internal-use-in-handsontable",W1={licenseKey:hY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function dY(t){var e,r;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[nn])===null||e===void 0||(r=e.language)===null||r===void 0?void 0:r.langCode}}function pY(t){return Object.keys(t).reduce(function(e,r){return r!=="hyperformula"&&(e[r]=t[r]),e},{})}function zLe(t){var e,r=t[nn],n=pY(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),o=dY(t);return Sf(Sf(Sf({},W1),n),o)}function YLe(t){var e,r=t[nn],n=pY(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),o=dY(t);return Sf(Sf({},n),o)}function GLe(t,e){return Object.keys(e).some(function(r){return e[r]!==void 0&&e[r]!==t[r]})}var qD;function $Le(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function U1(t){"@babel/helpers - typeof";return U1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U1(t)}function rb(){var t="engine_relationship",e=nr(nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function RT(){var t="shared_engine_usage",e=nr(nn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function KLe(t){var e=t.getSettings(),r=e[nn],n=r==null?void 0:r.engine;if(r===!0||dt(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return qLe((o=n.hyperformula)!==null&&o!==void 0?o:n,e,t)}else if(U1(n)==="object"&&dt(n.hyperformula)){var i=rb(),a=RT().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(t),a&&a.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:hY}),(n.getConfig().leapYear1900!==W1.leapYear1900||Hk(n.getConfig().nullDate,W1.nullDate)===!1)&&lt(it(qD||(qD=$Le(["If you use HyperFormula with Handsontable, keep the default `leapYear1900` and `nullDate` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."],["If you use HyperFormula with Handsontable, keep the default \\`leapYear1900\\` and \\`nullDate\\` \n      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates."])))),n}return null}function qLe(t,e,r){var n=e[nn],o=zLe(e),i=rb(),a=RT();XLe(t,n.functions),ZLe(t,n.language);var s=t.buildEmpty(o);return i.set(s,[r]),a.set(s,[r.guid]),QLe(s,n.namedExpressions),s.on("sheetAdded",function(){s.rebuildAndRecalculate()}),s.on("sheetRemoved",function(){s.rebuildAndRecalculate()}),s}function XD(t){var e,r=rb(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(function(o){return[o.getPlugin("formulas").sheetId,o]}))}function ZD(t,e){if(t){var r=rb(),n=r.get(t),o=RT(),i=o.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),i.length===0&&(o.delete(t),t.destroy()))}}function XLe(t,e){e&&e.forEach(function(r){var n=r.name,o=r.plugin,i=r.translations;try{t.registerFunction(n,o,i)}catch(a){lt(a.message)}})}function ZLe(t,e){if(e){var r=e.langCode;try{t.registerLanguage(r,e)}catch(n){lt(n.message)}}}function QLe(t,e){e&&(t.suspendEvaluation(),e.forEach(function(r){var n=r.name,o=r.expression,i=r.scope,a=r.options;try{t.addNamedExpression(n,o,i,a)}catch(s){lt(s.message)}}),t.resumeEvaluation())}function JLe(t,e){return(dt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}var yY="DD/MM/YYYY";function mY(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function eBe(t){return mY(t)?t.substr(1):t}function tBe(t){return typeof t=="string"&&t.startsWith("=")}function d0(t,e){return typeof t=="string"&&e==="date"}function QD(t,e){return J(t,e,!0).isValid()}function JD(t,e){return J(t,e,!0).format(yY)}function nBe(t,e){return J(t,yY,!0).format(e)}function eN(t,e){var r=-1,n=new Date(Date.UTC(0,0,t+r));return J(n).format(e)}function md(t){"@babel/helpers - typeof";return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(t)}function rBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,iBe(n.key),n)}}function oBe(t,e,r){return e&&tN(t.prototype,e),r&&tN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function iBe(t){var e=aBe(t,"string");return md(e)==="symbol"?e:String(e)}function aBe(t,e){if(md(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fi(t,e,r){sBe(t,e),e.set(t,r)}function sBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){var r=gY(t,e,"get");return lBe(t,r)}function lBe(t,e){return e.get?e.get.call(t):e.value}function qo(t,e,r){var n=gY(t,e,"set");return uBe(t,n,r),r}function gY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function uBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Yc=new WeakMap,Xo=new WeakMap,An=new WeakMap,Sy=new WeakMap,p0=new WeakMap,y0=new WeakMap,Cy=new WeakMap,cBe=function(){function t(e,r,n){rBe(this,t),Fi(this,Yc,{writable:!0,value:void 0}),Fi(this,Xo,{writable:!0,value:void 0}),Fi(this,An,{writable:!0,value:void 0}),Fi(this,Sy,{writable:!0,value:[]}),Fi(this,p0,{writable:!0,value:[]}),Fi(this,y0,{writable:!0,value:void 0}),Fi(this,Cy,{writable:!0,value:[]}),qo(this,Yc,e),qo(this,Xo,r),qo(this,An,n)}return oBe(t,[{key:"setRemovedHfIndexes",value:function(e){var r=this;return qo(this,Cy,e.map(function(n){var o=vt(r,Xo).getVisualFromPhysicalIndex(n);return r.getHfIndexFromVisualIndex(o)})),vt(this,Cy)}},{key:"getRemovedHfIndexes",value:function(){return vt(this,Cy)}},{key:"getHfIndexFromVisualIndex",value:function(e){var r=vt(this,Xo).getIndexesSequence(),n=vt(this,Xo).getNotTrimmedIndexes();return r.indexOf(n[e])}},{key:"syncMoves",value:function(e){var r=this,n=1,o="move".concat(hr(vt(this,Yc)),"s");vt(this,An).getEngine().batch(function(){e.forEach(function(i){var a=i.from!==i.to,s=i.from+1!==i.to;a&&s&&vt(r,An).getEngine()[o](vt(r,An).getSheetId(),i.from,n,i.to)})})}},{key:"storeMovesInformation",value:function(e,r,n){var o=this;n!==!1&&(qo(this,p0,e.map(function(i){return o.getHfIndexFromVisualIndex(i)})),qo(this,y0,this.getHfIndexFromVisualIndex(r)))}},{key:"getMoveLine",value:function(e,r){var n=vt(this,Xo).getNumberOfIndexes(),o=Array.from(Array(n).keys()).filter(function(a){return e.includes(a)===!1});if(r===0){var i;return(i=o[r])!==null&&i!==void 0?i:0}return o[r-1]+1}},{key:"getInitiallyCalculatedMoves",value:function(e,r){var n=this.getMoveLine(e,r),o=[];return e.forEach(function(i){var a={from:i,to:n};o.forEach(function(s){var l=s.from>s.to,u=s.to<=a.from,c=s.from>a.from;c&&u&&l&&(a.from+=1)}),a.from>=n&&(n+=1),o.push(a)}),o}},{key:"adjustedCalculatedMoves",value:function(e){return e.forEach(function(r,n){var o=e.slice(n+1);o.forEach(function(i){var a=i.from<i.to;i.from>r.from&&a&&(i.from-=1)})}),e}},{key:"calculateAndSyncMoves",value:function(e,r){var n=this;if(!vt(this,An).isPerformingUndoRedo()&&!(e===!1||r===!1)){var o=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(vt(this,p0),vt(this,y0)));vt(this,An).getSheetId()===null?vt(this,An).getPostponeAction(function(){return n.syncMoves(o)}):this.syncMoves(o)}}},{key:"getIndexesChangeSyncMethod",value:function(){var e=this,r="set".concat(hr(vt(this,Yc)),"Order");return function(n){if(!vt(e,An).isPerformingUndoRedo()){var o=vt(e,Xo).getIndexesSequence();if(n==="update"){var i=vt(e,Sy).map(function(c){return o.indexOf(c)}),a=vt(e,An).getEngine().getSheetDimensions(vt(e,An).getSheetId()),s;vt(e,Yc)==="row"?s=a.height:s=a.width;for(var l=i.length,u=l;u<s;u+=1)i.push(u);vt(e,An).getEngine()[r](vt(e,An).getSheetId(),i)}qo(e,Sy,o)}}}},{key:"init",value:function(){qo(this,Sy,vt(this,Xo).getIndexesSequence())}}]),t}();const nN=cBe;function gd(t){"@babel/helpers - typeof";return gd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gd(t)}function fBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dBe(n.key),n)}}function hBe(t,e,r){return e&&rN(t.prototype,e),r&&rN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dBe(t){var e=pBe(t,"string");return gd(e)==="symbol"?e:String(e)}function pBe(t,e){if(gd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(gd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wi(t,e,r){yBe(t,e),e.set(t,r)}function yBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(t,e){var r=vY(t,e,"get");return mBe(t,r)}function mBe(t,e){return e.get?e.get.call(t):e.value}function Ui(t,e,r){var n=vY(t,e,"set");return gBe(t,n,r),r}function vY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function gBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Oy=new WeakMap,ky=new WeakMap,m0=new WeakMap,g0=new WeakMap,v0=new WeakMap,b0=new WeakMap,w0=new WeakMap,vBe=function(){function t(e,r,n){fBe(this,t),Wi(this,Oy,{writable:!0,value:void 0}),Wi(this,ky,{writable:!0,value:void 0}),Wi(this,m0,{writable:!0,value:void 0}),Wi(this,g0,{writable:!0,value:!1}),Wi(this,v0,{writable:!0,value:!1}),Wi(this,b0,{writable:!0,value:null}),Wi(this,w0,{writable:!0,value:null}),Ui(this,Oy,new nN("row",e,this)),Ui(this,ky,new nN("column",r,this)),Ui(this,m0,n)}return hBe(t,[{key:"getForAxis",value:function(e){return e==="row"?qr(this,Oy):qr(this,ky)}},{key:"setPerformUndo",value:function(e){Ui(this,g0,e)}},{key:"setPerformRedo",value:function(e){Ui(this,v0,e)}},{key:"isPerformingUndoRedo",value:function(){return qr(this,g0)||qr(this,v0)}},{key:"getSheetId",value:function(){return qr(this,w0)}},{key:"getEngine",value:function(){return qr(this,b0)}},{key:"getPostponeAction",value:function(){return qr(this,m0)}},{key:"setupSyncEndpoint",value:function(e,r){Ui(this,b0,e),Ui(this,w0,r),qr(this,Oy).init(),qr(this,ky).init()}}]),t}();const bBe=vBe;function wBe(t){return OBe(t)||CBe(t)||bY(t)||SBe()}function SBe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CBe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function OBe(t){if(Array.isArray(t))return z1(t)}function Oi(t){"@babel/helpers - typeof";return Oi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oi(t)}function Ss(t,e){return EBe(t)||RBe(t,e)||bY(t,e)||kBe()}function kBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bY(t,e){if(t){if(typeof t=="string")return z1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z1(t,e)}}function z1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function RBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function EBe(t){if(Array.isArray(t))return t}function TBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wY(n.key),n)}}function PBe(t,e,r){return e&&oN(t.prototype,e),r&&oN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ca(){return typeof Reflect<"u"&&Reflect.get?ca=Reflect.get.bind():ca=function(t,e,r){var n=MBe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ca.apply(this,arguments)}function MBe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=So(t),t!==null););return t}function _Be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Y1(t,e)}function Y1(t,e){return Y1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Y1(t,e)}function xBe(t){var e=jBe();return function(){var r=So(t),n;if(e){var o=So(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ABe(this,n)}}function ABe(t,e){if(e&&(Oi(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mr(t)}function Mr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function So(t){return So=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},So(t)}function Cs(t,e,r){return e=wY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wY(t){var e=IBe(t,"string");return Oi(e)==="symbol"?e:String(e)}function IBe(t,e){if(Oi(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Oi(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S0(t,e,r){HBe(t,e),e.set(t,r)}function HBe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zo(t,e,r){var n=SY(t,e,"set");return DBe(t,n,r),r}function DBe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function Os(t,e){var r=SY(t,e,"get");return NBe(t,r)}function SY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function NBe(t,e){return e.get?e.get.call(t):e.value}var nn="formulas",LBe=["maxRows","maxColumns","language"],BBe=260;ye.getSingleton().register("afterNamedExpressionAdded");ye.getSingleton().register("afterNamedExpressionRemoved");ye.getSingleton().register("afterSheetAdded");ye.getSingleton().register("afterSheetRemoved");ye.getSingleton().register("afterSheetRenamed");ye.getSingleton().register("afterFormulasValuesUpdate");var ks=function(t){return t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto"},Xr=new WeakMap,C0=new WeakMap,Gc=new WeakMap,VBe=function(t){_Be(r,t);var e=xBe(r);function r(){var n;TBe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),S0(Mr(n),Xr,{writable:!0,value:!1}),S0(Mr(n),C0,{writable:!0,value:!1}),S0(Mr(n),Gc,{writable:!0,value:[["valuesUpdated",function(){var s;return(s=n).onEngineValuesUpdated.apply(s,arguments)}],["namedExpressionAdded",function(){var s;return(s=n).onEngineNamedExpressionsAdded.apply(s,arguments)}],["namedExpressionRemoved",function(){var s;return(s=n).onEngineNamedExpressionsRemoved.apply(s,arguments)}],["sheetAdded",function(){var s;return(s=n).onEngineSheetAdded.apply(s,arguments)}],["sheetRenamed",function(){var s;return(s=n).onEngineSheetRenamed.apply(s,arguments)}],["sheetRemoved",function(){var s;return(s=n).onEngineSheetRemoved.apply(s,arguments)}]]}),Cs(Mr(n),"staticRegister",nr("formulas")),Cs(Mr(n),"engine",null),Cs(Mr(n),"sheetName",null),Cs(Mr(n),"indexSyncer",null),Cs(Mr(n),"rowAxisSyncer",null),Cs(Mr(n),"columnAxisSyncer",null),n}return PBe(r,[{key:"sheetId",get:function(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}},{key:"isEnabled",value:function(){return!!this.hot.getSettings()[nn]}},{key:"enablePlugin",value:function(){var n,o=this;if(!this.enabled){if(this.engine=(n=KLe(this.hot))!==null&&n!==void 0?n:this.engine,!this.engine){lt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){var i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterLoadData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("beforeUpdateData",function(){return o.onBeforeLoadData.apply(o,arguments)}),this.addHook("afterUpdateData",function(){return o.onAfterLoadData.apply(o,arguments)}),this.addHook("modifyData",function(){return o.onModifyData.apply(o,arguments)}),this.addHook("modifySourceData",function(){return o.onModifySourceData.apply(o,arguments)}),this.addHook("beforeValidate",function(){return o.onBeforeValidate.apply(o,arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return o.onAfterSetSourceDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtCell",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("afterSetDataAtRowProp",function(){return o.onAfterSetDataAtCell.apply(o,arguments)}),this.addHook("beforeCreateRow",function(){return o.onBeforeCreateRow.apply(o,arguments)}),this.addHook("beforeCreateCol",function(){return o.onBeforeCreateCol.apply(o,arguments)}),this.addHook("afterCreateRow",function(){return o.onAfterCreateRow.apply(o,arguments)}),this.addHook("afterCreateCol",function(){return o.onAfterCreateCol.apply(o,arguments)}),this.addHook("beforeRemoveRow",function(){return o.onBeforeRemoveRow.apply(o,arguments)}),this.addHook("beforeRemoveCol",function(){return o.onBeforeRemoveCol.apply(o,arguments)}),this.addHook("afterRemoveRow",function(){return o.onAfterRemoveRow.apply(o,arguments)}),this.addHook("afterRemoveCol",function(){return o.onAfterRemoveCol.apply(o,arguments)}),this.indexSyncer=new bBe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,function(a){o.hot.addHookOnce("init",function(){a()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",function(a,s,l,u){o.rowAxisSyncer.storeMovesInformation(a,s,u)}),this.hot.addHook("beforeColumnMove",function(a,s,l,u){o.columnAxisSyncer.storeMovesInformation(a,s,u)}),this.hot.addHook("afterRowMove",function(a,s,l,u,c){o.rowAxisSyncer.calculateAndSyncMoves(u,c)}),this.hot.addHook("afterColumnMove",function(a,s,l,u,c){o.columnAxisSyncer.calculateAndSyncMoves(u,c)}),this.hot.addHook("beforeColumnFreeze",function(a,s){o.columnAxisSyncer.storeMovesInformation([a],o.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",function(a,s){o.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",function(a,s){o.columnAxisSyncer.storeMovesInformation([a],o.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",function(a,s){o.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){return o.onAfterCellMetaReset.apply(o,arguments)}),this.addHook("beforeUndo",function(){o.indexSyncer.setPerformUndo(!0),o.engine.undo()}),this.addHook("beforeRedo",function(){o.indexSyncer.setPerformRedo(!0),o.engine.redo()}),this.addHook("afterUndo",function(){o.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",function(){o.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return o.onAfterDetachChild.apply(o,arguments)}),this.addHook("beforeAutofill",function(){return o.onBeforeAutofill.apply(o,arguments)}),Os(this,Gc).forEach(function(a){var s=Ss(a,2),l=s[0],u=s[1];return o.engine.on(l,u)}),ca(So(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this;Os(this,Gc).forEach(function(o){var i=Ss(o,2),a=i[0],s=i[1];return n.engine.off(a,s)}),ZD(this.engine,this.hot),this.engine=null,ca(So(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(n){var o=YLe(this.hot.getSettings());GLe(this.engine.getConfig(),o)&&this.engine.updateConfig(o);var i=this.hot.getSettings()[nn];if(pe(i)&&pe(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!n.data&&this.sheetName===null){var a=this.hot.getSettings()[nn].sheetName;a&&this.engine.doesSheetExist(a)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(a??void 0,this.hot.getSourceDataArray())}ca(So(r.prototype),"updatePlugin",this).call(this,n)}},{key:"destroy",value:function(){var n=this;Os(this,Gc).forEach(function(o){var i,a=Ss(o,2),s=a[0],l=a[1];return(i=n.engine)===null||i===void 0?void 0:i.off(s,l)}),Zo(this,Gc,null),ZD(this.engine,this.hot),this.engine=null,ca(So(r.prototype),"destroy",this).call(this)}},{key:"addSheet",value:function(n,o){if(pe(o)&&!ame(o))return lt("The provided data should be an array of arrays."),!1;if(n!=null&&this.engine.doesSheetExist(n))return lt("Sheet with the provided name already exists."),!1;try{var i=this.engine.addSheet(n??void 0);return o&&this.engine.setSheetContent(this.engine.getSheetId(i),o),i}catch(a){return lt(a.message),!1}}},{key:"switchSheet",value:function(n){if(!this.engine.doesSheetExist(n)){sR("The sheet named `".concat(n,"` does not exist, switch aborted."));return}this.sheetName=n;var o=this.engine.getSheetSerialized(this.sheetId);o.length>0&&this.hot.loadData(o,"".concat(hr(nn),".switchSheet"))}},{key:"getCellType",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,a=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(o);return a!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o)}):"EMPTY"}},{key:"isFormulaCellType",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o)})}},{key:"renderDependentSheets",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=new Set;n.forEach(function(s){var l,u=s==null||(l=s.address)===null||l===void 0?void 0:l.sheet;u!==void 0&&(a.has(u)||a.add(u))}),XD(this.engine).forEach(function(s,l){if((i||l!==o.sheetId)&&a.has(l)){var u;s.render(),(u=s.view)===null||u===void 0||u.adjustElementsSize()}})}},{key:"validateDependentCells",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=function(l){var u,c=(u=l==null?void 0:l.address)!==null&&u!==void 0?u:{},f=c.row,h=c.col,p=c.sheet;return pe(p)?"".concat(p,":").concat(f,"x").concat(h):""},s=new Set(i.map(function(l){return a(l)}));n.forEach(function(l){var u,c,f=(u=l.address)!==null&&u!==void 0?u:{},h=f.row,p=f.col;if(!(pe(h)===!1||pe(p)===!1||h>=o.hot.countRows()||p>=o.hot.countCols())){var y=l==null||(c=l.address)===null||c===void 0?void 0:c.sheet,g=a(l);if(y!==void 0&&!s.has(g)){var v=XD(o.engine).get(y);if(!v)return;v.validateCell(v.getDataAtCell(h,p),v.getCellMeta(h,p),function(){})}}})}},{key:"syncChangeWithEngine",value:function(n,o,i){var a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(a)){lt("Not possible to set cell data at ".concat(JSON.stringify(a)));return}var s=this.hot.getCellMeta(n,o);return d0(i,s.type)&&(QD(i,s.dateFormat)?i=JD(i,s.dateFormat):tBe(i)===!1&&(i="'".concat(i))),this.engine.setCellContents(a,i)}},{key:"onBeforeValidate",value:function(n,o,i){var a=this.hot.propToCol(i);if(this.isFormulaCellType(o,a)){var s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},l=this.hot.getCellMeta(o,a),u=this.engine.getCellValue(s);return l.type==="date"&&kn(u)&&(u=eN(u,l.dateFormat)),Oi(u)==="object"&&u!==null?u.value:u}return n}},{key:"onBeforeAutofill",value:function(n,o,i){var a=o.getTopStartCorner(),s=a.row,l=a.col,u=o.getBottomEndCorner(),c=u.row,f=u.col,h=i.getTopStartCorner(),p=h.row,y=h.col,g=i.getBottomEndCorner(),v=g.row,S=g.col,O={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}},w={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(p),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(v),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(S),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(w)===!1)return!1;for(var x=this.engine.getFillRangeData(O,w),T=O.start,z=T.row,$=T.col,ne=O.end,G=ne.row,q=ne.col,Z=G-z+1,ee=q-$+1,Q=0;Q<x.length;Q+=1)for(var ce=0;ce<x[Q].length;ce+=1){var fe=x[Q][ce],we=Q%Z,Se=ce%ee,P=this.hot.getCellMeta(we,Se);d0(fe,P.type)&&(fe.startsWith("'")?x[Q][ce]=fe.slice(1):this.isFormulaCellType(we,Se,this.sheetId)===!1&&(x[Q][ce]=nBe(fe,P.dateFormat)))}return x}},{key:"onBeforeLoadData",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";i.includes(hr(nn))||Zo(this,C0,dt(this.hot.getSettings().data))}},{key:"onAfterCellMetaReset",value:function(){var n=this,o=this.hot.getSourceDataArray(),i=!1;o.forEach(function(a,s){a.forEach(function(l,u){var c=n.hot.getCellMeta(s,u),f=c.dateFormat;d0(l,c.type)&&(i=!0,QD(l,f)?o[s][u]=JD(l,f):n.isFormulaCellType(s,u)===!1&&(o[s][u]="'".concat(l)))})}),i===!0&&(Zo(this,Xr,!0),this.engine.setSheetContent(this.sheetId,o),Zo(this,Xr,!1))}},{key:"onAfterLoadData",value:function(n,o){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(!i.includes(hr(nn)))if(this.sheetName=JLe(this.engine,this.hot.getSettings()[nn].sheetName),Os(this,C0))this.switchSheet(this.sheetName);else{var a=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,a)){Zo(this,Xr,!0);var s=this.engine.setSheetContent(this.sheetId,a);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Zo(this,Xr,!1)}}}},{key:"onModifyData",value:function(n,o,i,a){if(!(a!=="get"||Os(this,Xr)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(n);if(!(s===null||o===null)){var l=this.isFormulaCellType(s,o);if(!l){var u=this.getCellType(s,o);if(u!=="ARRAY"){mY(i.value)&&(i.value=eBe(i.value));return}}var c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},f=this.engine.getCellValue(c),h=this.hot.getCellMeta(s,o);h.type==="date"&&kn(f)&&(f=eN(f,h.dateFormat));var p=Oi(f)==="object"&&f!==null?f.value:f;i.value=p}}}},{key:"onModifySourceData",value:function(n,o,i,a){if(!(a!=="get"||Os(this,Xr)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))){var s=this.hot.toVisualRow(n),l=this.hot.propToCol(o);if(!(s===null||l===null)){var u=this.isFormulaCellType(s,l);if(!u){var c=this.getCellType(s,l);if(c!=="ARRAY")return}var f=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(!(f.width===0&&f.height===0)){var h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};i.value=this.engine.getCellSerialized(h)}}}}},{key:"onAfterSetDataAtCell",value:function(n,o){var i=this;if(!ks(o)){var a=[],s=[],l=this.engine.batch(function(){n.forEach(function(u){var c=Ss(u,4),f=c[0],h=c[1],p=c[3],y=i.hot.propToCol(h),g=i.hot.toPhysicalRow(f),v=i.hot.toPhysicalColumn(y),S={row:i.rowAxisSyncer.getHfIndexFromVisualIndex(f),col:i.columnAxisSyncer.getHfIndexFromVisualIndex(y),sheet:i.sheetId};g!==null&&v!==null?i.syncChangeWithEngine(f,y,p):a.push([f,y,p]),s.push({address:S})})});a.length&&this.hot.addHookOnce("afterChange",function(){var u=i.engine.batch(function(){a.forEach(function(c){var f=Ss(c,3),h=f[0],p=f[1],y=f[2];i.syncChangeWithEngine(h,p,y)})});i.renderDependentSheets(u,!0)}),this.renderDependentSheets(l),this.validateDependentCells(l,s)}}},{key:"onAfterSetSourceDataAtCell",value:function(n,o){var i=this;if(!ks(o)){var a=[],s=[];n.forEach(function(l){var u=Ss(l,4),c=u[0],f=u[1],h=u[3],p=i.hot.propToCol(f);if(kn(p)){var y={row:i.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:i.columnAxisSyncer.getHfIndexFromVisualIndex(p),sheet:i.sheetId};if(!i.engine.isItPossibleToSetCellContents(y)){lt("Not possible to set source cell data at ".concat(JSON.stringify(y)));return}s.push({address:y}),a.push.apply(a,wBe(i.engine.setCellContents(y,h)))}}),this.renderDependentSheets(a),this.validateDependentCells(a,s)}}},{key:"onBeforeCreateRow",value:function(n,o){var i=this.rowAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countRows()&&(i=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,o]))return!1}},{key:"onBeforeCreateCol",value:function(n,o){var i=this.columnAxisSyncer.getHfIndexFromVisualIndex(n);if(n>=this.hot.countCols()&&(i=n),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,o]))return!1}},{key:"onBeforeRemoveRow",value:function(n,o,i){var a=this,s=this.rowAxisSyncer.setRemovedHfIndexes(i),l=s.every(function(u){return a.engine.isItPossibleToRemoveRows(a.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onBeforeRemoveCol",value:function(n,o,i){var a=this,s=this.columnAxisSyncer.setRemovedHfIndexes(i),l=s.every(function(u){return a.engine.isItPossibleToRemoveColumns(a.sheetId,[u,1])});return l===!1?!1:void 0}},{key:"onAfterCreateRow",value:function(n,o,i){if(!ks(i)){var a=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(n),o]);this.renderDependentSheets(a)}}},{key:"onAfterCreateCol",value:function(n,o,i){if(!ks(i)){var a=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(n),o]);this.renderDependentSheets(a)}}},{key:"onAfterRemoveRow",value:function(n,o,i,a){var s=this;if(!ks(a)){var l=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),u=this.engine.batch(function(){l.forEach(function(c){s.engine.removeRows(s.sheetId,[c,1])})});this.renderDependentSheets(u)}}},{key:"onAfterRemoveCol",value:function(n,o,i,a){var s=this;if(!ks(a)){var l=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),u=this.engine.batch(function(){l.forEach(function(c){s.engine.removeColumns(s.sheetId,[c,1])})});this.renderDependentSheets(u)}}},{key:"onAfterDetachChild",value:function(n,o,i){var a,s=this;Zo(this,Xr,!0);var l=this.hot.getSourceDataArray(i,0,i+(((a=o.__children)===null||a===void 0?void 0:a.length)||0),this.hot.countSourceCols());Zo(this,Xr,!1),l.forEach(function(u,c){u.forEach(function(f,h){s.engine.setCellContents({col:h,row:i+c,sheet:s.sheetId},[[f]])})})}},{key:"onEngineValuesUpdated",value:function(n){this.hot.runHooks("afterFormulasValuesUpdate",n)}},{key:"onEngineNamedExpressionsAdded",value:function(n,o){this.hot.runHooks("afterNamedExpressionAdded",n,o)}},{key:"onEngineNamedExpressionsRemoved",value:function(n,o){this.hot.runHooks("afterNamedExpressionRemoved",n,o)}},{key:"onEngineSheetAdded",value:function(n){this.hot.runHooks("afterSheetAdded",n)}},{key:"onEngineSheetRenamed",value:function(n,o){this.hot.runHooks("afterSheetRenamed",n,o)}},{key:"onEngineSheetRemoved",value:function(n,o){this.hot.runHooks("afterSheetRemoved",n,o)}}],[{key:"PLUGIN_KEY",get:function(){return nn}},{key:"PLUGIN_PRIORITY",get:function(){return BBe}},{key:"SETTING_KEYS",get:function(){return[nn].concat(LBe)}}]),r}(at);function FBe(t,e){return YBe(t)||zBe(t,e)||UBe(t,e)||WBe()}function WBe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UBe(t,e){if(t){if(typeof t=="string")return iN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iN(t,e)}}function iN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zBe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function YBe(t){if(Array.isArray(t))return t}function GBe(t){return{key:"hidden_columns_hide",name:function(){var e=this.getSelectedLast(),r=0;if(Array.isArray(e)){var n=FBe(e,4),o=n[1],i=n[3];o-i!==0&&(r=1)}return this.getTranslatedPhrase(mE,r)},callback:function(){for(var e=this.getSelectedRangeLast(),r=e.from,n=e.to,o=Math.max(Math.min(r.col,n.col),0),i=Math.max(r.col,n.col),a=[],s=o;s<=i;s+=1)a.push(s);t.hideColumns(a);var l=a[a.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(l,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Ry(t){return XBe(t)||qBe(t)||KBe(t)||$Be()}function $Be(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KBe(t,e){if(t){if(typeof t=="string")return G1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return G1(t,e)}}function qBe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function XBe(t){if(Array.isArray(t))return G1(t)}function G1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ZBe(t){var e=[];return{key:"hidden_columns_show",name:function(){var r=e.length>1?1:0;return this.getTranslatedPhrase(gE,r)},callback:function(){var r,n;if(e.length!==0){var o=e[0],i=e[e.length-1];o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countCols();a||this.selectColumns(o,i)}},disabled:!1,hidden:function(){var r=this,n=Ye(t.getHiddenColumns(),function(S){return r.toPhysicalColumn(S)});if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().col,a=o.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,p=u-l+1;if(h>p){var y=c.slice(i,a+1);f.push.apply(f,Ry(y.filter(function(S){return n.includes(S)})))}}else if(l===0&&l<i)f.push.apply(f,Ry(c.slice(0,i)));else if(l===null)f.push.apply(f,Ry(c.slice(0,this.countCols())));else{var g=this.countCols()-1,v=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));u===v&&g>a&&f.push.apply(f,Ry(c.slice(a+1)))}return _(f,function(S){e.push(r.toVisualColumn(S))}),e.length===0}}}function Pu(t){"@babel/helpers - typeof";return Pu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pu(t)}function QBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,eVe(n.key),n)}}function JBe(t,e,r){return e&&aN(t.prototype,e),r&&aN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function eVe(t){var e=tVe(t,"string");return Pu(e)==="symbol"?e:String(e)}function tVe(t,e){if(Pu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Pu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fa(){return typeof Reflect<"u"&&Reflect.get?fa=Reflect.get.bind():fa=function(t,e,r){var n=nVe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},fa.apply(this,arguments)}function nVe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Co(t),t!==null););return t}function rVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$1(t,e)}function $1(t,e){return $1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$1(t,e)}function oVe(t){var e=aVe();return function(){var r=Co(t),n;if(e){var o=Co(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iVe(this,n)}}function iVe(t,e){if(e&&(Pu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return K1(t)}function K1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Co(t){return Co=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Co(t)}function sN(t,e,r){sVe(t,e),e.set(t,r)}function sVe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e){var r=CY(t,e,"get");return lVe(t,r)}function lVe(t,e){return e.get?e.get.call(t):e.value}function $c(t,e,r){var n=CY(t,e,"set");return uVe(t,n,r),r}function CY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function uVe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}ye.getSingleton().register("beforeHideColumns");ye.getSingleton().register("afterHideColumns");ye.getSingleton().register("beforeUnhideColumns");ye.getSingleton().register("afterUnhideColumns");var O0="hiddenColumns",cVe=310,kr=new WeakMap,Rr=new WeakMap,fVe=function(t){rVe(r,t);var e=oVe(r);function r(){var n;QBe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),sN(K1(n),kr,{writable:!0,value:{}}),sN(K1(n),Rr,{writable:!0,value:null}),n}return JBe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[O0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[O0];Ge(o)&&($c(this,kr,o),dt(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),$c(this,Rr,new Tv),jn(this,Rr).addLocalHook("init",function(){return n.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,jn(this,Rr)),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(i,a,s){return n.onAfterGetCellMeta(i,a,s)}),this.addHook("modifyColWidth",function(i,a){return n.onModifyColWidth(i,a)}),this.addHook("afterGetColHeader",function(){return n.onAfterGetColHeader.apply(n,arguments)}),this.addHook("modifyCopyableRange",function(i){return n.onModifyCopyableRange(i)}),fa(Co(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),fa(Co(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),$c(this,kr,{}),fa(Co(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showColumns",value:function(n){var o=this,i=this.getHiddenColumns(),a=this.isValidConfig(n),s=i,l=jn(this,Rr).getValues().slice(),u=n.length>0;if(a&&u){var c=n.map(function(h){return o.hot.toPhysicalColumn(h)});_(c,function(h){l[h]=!1}),s=an(l,function(h,p,y){return p&&h.push(o.hot.toVisualColumn(y)),h},[])}var f=this.hot.runHooks("beforeUnhideColumns",i,s,a&&u);f!==!1&&(a&&u&&jn(this,Rr).setValues(l),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",i,s,a&&u,a&&s.length<i.length))}},{key:"showColumn",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.showColumns(o)}},{key:"hideColumns",value:function(n){var o=this,i=this.getHiddenColumns(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeHideColumns",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){_(n,function(u){jn(o,Rr).setValueAtIndex(o.hot.toPhysicalColumn(u),!0)})},!0),this.hot.runHooks("afterHideColumns",i,s,a,a&&s.length>i.length))}},{key:"hideColumn",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.hideColumns(o)}},{key:"getHiddenColumns",value:function(){var n=this;return Ye(jn(this,Rr).getHiddenIndexes(),function(o){return n.hot.toVisualColumn(o)})}},{key:"isHidden",value:function(n){return jn(this,Rr).getValueAtIndex(this.hot.toPhysicalColumn(n))||!1}},{key:"isValidConfig",value:function(n){var o=this.hot.countCols();return Array.isArray(n)&&n.length>0?n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o}):!1}},{key:"resetCellsMeta",value:function(){_(this.hot.getCellsMeta(),function(n){n&&(n.skipColumnOnPaste=!1)})}},{key:"onModifyColWidth",value:function(n,o){if(this.isHidden(o))return 0;if(jn(this,kr).indicators&&(this.isHidden(o+1)||this.isHidden(o-1))&&typeof n=="number"&&this.hot.hasColHeaders())return n+15}},{key:"onAfterGetCellMeta",value:function(n,o,i){if(jn(this,kr).copyPasteEnabled===!1&&this.isHidden(o)&&(i.skipColumnOnPaste=!0),this.isHidden(o-1))i.className=i.className||"",i.className.indexOf("afterHiddenColumn")===-1&&(i.className+=" afterHiddenColumn");else if(i.className){var a=i.className.split(" ");if(a.length>0){var s=a.indexOf("afterHiddenColumn");s>-1&&a.splice(s,1),i.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(n){var o=this;if(jn(this,kr).copyPasteEnabled)return n;var i=[],a=function(s,l,u,c){i.push({startRow:s,endRow:l,startCol:u,endCol:c})};return _(n,function(s){var l=!0,u=0;Oe(s.startCol,s.endCol,function(c){o.isHidden(c)?(l||a(s.startRow,s.endRow,u,c-1),l=!0):(l&&(u=c),c===s.endCol&&a(s.startRow,s.endRow,u,c),l=!1)})}),i}},{key:"onAfterGetColHeader",value:function(n,o){if(!(!jn(this,kr).indicators||n<0)){var i=[];n>=1&&this.isHidden(n-1)&&i.push("afterHiddenColumn"),n<this.hot.countCols()-1&&this.isHidden(n+1)&&i.push("beforeHiddenColumn"),te(o,i)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:ze},GBe(this),ZBe(this))}},{key:"onMapInit",value:function(){Array.isArray(jn(this,kr).columns)&&this.hideColumns(jn(this,kr).columns)}},{key:"destroy",value:function(){$c(this,kr,null),$c(this,Rr,null),fa(Co(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return O0}},{key:"PLUGIN_PRIORITY",get:function(){return cVe}}]),r}(at);function hVe(t,e){return mVe(t)||yVe(t,e)||pVe(t,e)||dVe()}function dVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pVe(t,e){if(t){if(typeof t=="string")return lN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lN(t,e)}}function lN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function mVe(t){if(Array.isArray(t))return t}function gVe(t){return{key:"hidden_rows_hide",name:function(){var e=this.getSelectedLast(),r=0;if(Array.isArray(e)){var n=hVe(e,3),o=n[0],i=n[2];o-i!==0&&(r=1)}return this.getTranslatedPhrase(vE,r)},callback:function(){for(var e=this.getSelectedRangeLast(),r=e.from,n=e.to,o=Math.max(Math.min(r.row,n.row),0),i=Math.max(r.row,n.row),a=[],s=o;s<=i;s+=1)a.push(s);t.hideRows(a);var l=a[a.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(l,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Ey(t){return SVe(t)||wVe(t)||bVe(t)||vVe()}function vVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bVe(t,e){if(t){if(typeof t=="string")return q1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q1(t,e)}}function wVe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function SVe(t){if(Array.isArray(t))return q1(t)}function q1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CVe(t){var e=[];return{key:"hidden_rows_show",name:function(){var r=e.length>1?1:0;return this.getTranslatedPhrase(bE,r)},callback:function(){var r,n;if(e.length!==0){var o=e[0],i=e[e.length-1];o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&r!==void 0?r:0,i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);var a=i-o+1===this.countRows();a||this.selectRows(o,i)}},disabled:!1,hidden:function(){var r=this,n=Ye(t.getHiddenRows(),function(S){return r.toPhysicalRow(S)});if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;var o=this.getSelectedRangeLast(),i=o.getTopStartCorner().row,a=o.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(i),u=s.getRenderableFromVisualIndex(a),c=s.getNotTrimmedIndexes(),f=[];if(i!==a){var h=a-i+1,p=u-l+1;if(h>p){var y=c.slice(i,a+1);f.push.apply(f,Ey(y.filter(function(S){return n.includes(S)})))}}else if(l===0&&l<i)f.push.apply(f,Ey(c.slice(0,i)));else if(l===null)f.push.apply(f,Ey(c.slice(0,this.countRows())));else{var g=this.countRows()-1,v=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1));u===v&&g>a&&f.push.apply(f,Ey(c.slice(a+1)))}return _(f,function(S){e.push(r.toVisualRow(S))}),e.length===0}}}function Mu(t){"@babel/helpers - typeof";return Mu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mu(t)}function OVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RVe(n.key),n)}}function kVe(t,e,r){return e&&uN(t.prototype,e),r&&uN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RVe(t){var e=EVe(t,"string");return Mu(e)==="symbol"?e:String(e)}function EVe(t,e){if(Mu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Mu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ha(){return typeof Reflect<"u"&&Reflect.get?ha=Reflect.get.bind():ha=function(t,e,r){var n=TVe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ha.apply(this,arguments)}function TVe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Oo(t),t!==null););return t}function PVe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X1(t,e)}function X1(t,e){return X1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},X1(t,e)}function MVe(t){var e=xVe();return function(){var r=Oo(t),n;if(e){var o=Oo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _Ve(this,n)}}function _Ve(t,e){if(e&&(Mu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Z1(t)}function Z1(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oo(t){return Oo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Oo(t)}function cN(t,e,r){AVe(t,e),e.set(t,r)}function AVe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gn(t,e){var r=OY(t,e,"get");return jVe(t,r)}function jVe(t,e){return e.get?e.get.call(t):e.value}function Kc(t,e,r){var n=OY(t,e,"set");return IVe(t,n,r),r}function OY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function IVe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}ye.getSingleton().register("beforeHideRows");ye.getSingleton().register("afterHideRows");ye.getSingleton().register("beforeUnhideRows");ye.getSingleton().register("afterUnhideRows");var k0="hiddenRows",HVe=320,Zr=new WeakMap,Er=new WeakMap,DVe=function(t){PVe(r,t);var e=MVe(r);function r(){var n;OVe(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),cN(Z1(n),Zr,{writable:!0,value:{}}),cN(Z1(n),Er,{writable:!0,value:null}),n}return kVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[k0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[k0];Ge(o)&&(Kc(this,Zr,o),dt(o.copyPasteEnabled)&&(o.copyPasteEnabled=!0)),Kc(this,Er,new Tv),Gn(this,Er).addLocalHook("init",function(){return n.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,Gn(this,Er)),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(i,a,s){return n.onAfterGetCellMeta(i,a,s)}),this.addHook("modifyRowHeight",function(i,a){return n.onModifyRowHeight(i,a)}),this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)}),this.addHook("modifyCopyableRange",function(i){return n.onModifyCopyableRange(i)}),ha(Oo(r.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ha(Oo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Kc(this,Zr,{}),ha(Oo(r.prototype),"disablePlugin",this).call(this),this.resetCellsMeta()}},{key:"showRows",value:function(n){var o=this,i=this.getHiddenRows(),a=this.isValidConfig(n),s=i,l=Gn(this,Er).getValues().slice(),u=n.length>0;if(a&&u){var c=n.map(function(h){return o.hot.toPhysicalRow(h)});_(c,function(h){l[h]=!1}),s=an(l,function(h,p,y){return p&&h.push(o.hot.toVisualRow(y)),h},[])}var f=this.hot.runHooks("beforeUnhideRows",i,s,a&&u);f!==!1&&(a&&u&&Gn(this,Er).setValues(l),this.hot.runHooks("afterUnhideRows",i,s,a&&u,a&&s.length<i.length))}},{key:"showRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.showRows(o)}},{key:"hideRows",value:function(n){var o=this,i=this.getHiddenRows(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeHideRows",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){_(n,function(u){Gn(o,Er).setValueAtIndex(o.hot.toPhysicalRow(u),!0)})},!0),this.hot.runHooks("afterHideRows",i,s,a,a&&s.length>i.length))}},{key:"hideRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.hideRows(o)}},{key:"getHiddenRows",value:function(){var n=this;return Ye(Gn(this,Er).getHiddenIndexes(),function(o){return n.hot.toVisualRow(o)})}},{key:"isHidden",value:function(n){return Gn(this,Er).getValueAtIndex(this.hot.toPhysicalRow(n))||!1}},{key:"isValidConfig",value:function(n){var o=this.hot.countRows();return Array.isArray(n)&&n.length>0?n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o}):!1}},{key:"resetCellsMeta",value:function(){_(this.hot.getCellsMeta(),function(n){n&&(n.skipRowOnPaste=!1)})}},{key:"onModifyRowHeight",value:function(n,o){return this.isHidden(o)?0:n}},{key:"onAfterGetCellMeta",value:function(n,o,i){if(Gn(this,Zr).copyPasteEnabled===!1&&this.isHidden(n)&&(i.skipRowOnPaste=!0),this.isHidden(n-1))i.className=i.className||"",i.className.indexOf("afterHiddenRow")===-1&&(i.className+=" afterHiddenRow");else if(i.className){var a=i.className.split(" ");if(a.length>0){var s=a.indexOf("afterHiddenRow");s>-1&&a.splice(s,1),i.className=a.join(" ")}}}},{key:"onModifyCopyableRange",value:function(n){var o=this;if(Gn(this,Zr).copyPasteEnabled)return n;var i=[],a=function(s,l,u,c){i.push({startRow:s,endRow:l,startCol:u,endCol:c})};return _(n,function(s){var l=!0,u=0;Oe(s.startRow,s.endRow,function(c){o.isHidden(c)?(l||a(u,c-1,s.startCol,s.endCol),l=!0):(l&&(u=c),c===s.endRow&&a(u,c,s.startCol,s.endCol),l=!1)})}),i}},{key:"onAfterGetRowHeader",value:function(n,o){if(!(!Gn(this,Zr).indicators||n<0)){var i=[];n>=1&&this.isHidden(n-1)&&i.push("afterHiddenRow"),n<this.hot.countRows()-1&&this.isHidden(n+1)&&i.push("beforeHiddenRow"),te(o,i)}}},{key:"onAfterContextMenuDefaultOptions",value:function(n){n.items.push({name:ze},gVe(this),CVe(this))}},{key:"onMapInit",value:function(){Array.isArray(Gn(this,Zr).rows)&&this.hideRows(Gn(this,Zr).rows)}},{key:"destroy",value:function(){Kc(this,Zr,null),Kc(this,Er,null),ha(Oo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return k0}},{key:"PLUGIN_PRIORITY",get:function(){return HVe}}]),r}(at);function NVe(t,e){return FVe(t)||VVe(t,e)||BVe(t,e)||LVe()}function LVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BVe(t,e){if(t){if(typeof t=="string")return fN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fN(t,e)}}function fN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function VVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function FVe(t){if(Array.isArray(t))return t}function WVe(t){return{key:"freeze_column",name:function(){return this.getTranslatedPhrase(GR)},callback:function(e,r){var n=NVe(r,1),o=n[0].start.col;t.freezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function UVe(t,e){return $Ve(t)||GVe(t,e)||YVe(t,e)||zVe()}function zVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YVe(t,e){if(t){if(typeof t=="string")return hN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hN(t,e)}}function hN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function GVe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function $Ve(t){if(Array.isArray(t))return t}function KVe(t){return{key:"unfreeze_column",name:function(){return this.getTranslatedPhrase($R)},callback:function(e,r){var n=UVe(r,1),o=n[0].start.col;t.unfreezeColumn(o),this.render(),this.view.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function _u(t){"@babel/helpers - typeof";return _u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_u(t)}function qVe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ZVe(n.key),n)}}function XVe(t,e,r){return e&&dN(t.prototype,e),r&&dN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZVe(t){var e=QVe(t,"string");return _u(e)==="symbol"?e:String(e)}function QVe(t,e){if(_u(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xs(){return typeof Reflect<"u"&&Reflect.get?Xs=Reflect.get.bind():Xs=function(t,e,r){var n=JVe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Xs.apply(this,arguments)}function JVe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=bi(t),t!==null););return t}function eFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Q1(t,e)}function Q1(t,e){return Q1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Q1(t,e)}function tFe(t){var e=rFe();return function(){var r=bi(t),n;if(e){var o=bi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nFe(this,n)}}function nFe(t,e){if(e&&(_u(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kY(t)}function kY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function bi(t){return bi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bi(t)}ye.getSingleton().register("beforeColumnFreeze");ye.getSingleton().register("afterColumnFreeze");ye.getSingleton().register("beforeColumnUnfreeze");ye.getSingleton().register("afterColumnUnfreeze");var pN="manualColumnFreeze",oFe=110,qc=new WeakMap,iFe=function(t){eFe(r,t);var e=tFe(r);function r(n){var o;return qVe(this,r),o=e.call(this,n),qc.set(kY(o),{afterFirstUse:!1}),o}return XVe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[pN]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(o){return n.addContextMenuEntry(o)}),this.addHook("beforeColumnMove",function(o,i){return n.onBeforeColumnMove(o,i)}),Xs(bi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){var n=qc.get(this);n.afterFirstUse=!1,Xs(bi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),Xs(bi(r.prototype),"updatePlugin",this).call(this)}},{key:"freezeColumn",value:function(n){var o=qc.get(this),i=this.hot.getSettings(),a=i.fixedColumnsStart<this.hot.countCols()&&n>i.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnFreeze",n,a);s!==!1&&(a&&(this.hot.columnIndexMapper.moveIndexes(n,i.fixedColumnsStart),i._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",n,a))}},{key:"unfreezeColumn",value:function(n){var o=qc.get(this),i=this.hot.getSettings(),a=i.fixedColumnsStart>0&&n<=i.fixedColumnsStart-1;o.afterFirstUse||(o.afterFirstUse=!0);var s=this.hot.runHooks("beforeColumnUnfreeze",n,a);s!==!1&&(a&&(i._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(n,i.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",n,a))}},{key:"addContextMenuEntry",value:function(n){n.items.push({name:"---------"},WVe(this),KVe(this))}},{key:"onBeforeColumnMove",value:function(n,o){var i=qc.get(this);if(i.afterFirstUse){var a=this.hot.getSettings().fixedColumnsStart;if(o<a||n.some(function(s){return s<a}))return!1}}}],[{key:"PLUGIN_KEY",get:function(){return pN}},{key:"PLUGIN_PRIORITY",get:function(){return oFe}}]),r}(at);function vd(t){"@babel/helpers - typeof";return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vd(t)}function aFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,lFe(n.key),n)}}function sFe(t,e,r){return e&&yN(t.prototype,e),r&&yN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function lFe(t){var e=uFe(t,"string");return vd(e)==="symbol"?e:String(e)}function uFe(t,e){if(vd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(vd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var R0=0,mN=1,gN=2,Rs="px",cFe=function(){function t(e){aFe(this,t),this.hot=e,this._element=null,this.state=R0,this.inlineProperty=e.isRtl()?"right":"left"}return sFe(t,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=gN}},{key:"build",value:function(){this.state===R0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=mN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=R0}},{key:"isAppended",value:function(){return this.state===gN}},{key:"isBuilt",value:function(){return this.state>=mN}},{key:"setPosition",value:function(e,r){kn(e)&&(this._element.style.top=e+Rs),kn(r)&&(this._element.style[this.inlineProperty]=r+Rs)}},{key:"getPosition",value:function(){var e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}},{key:"setSize",value:function(e,r){kn(e)&&(this._element.style.width=e+Rs),kn(r)&&(this._element.style.height=r+Rs)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,r){kn(e)&&(this._element.style.marginTop=e+Rs),kn(r)&&(this._element.style["margin".concat(hr(this.inlineProperty))]=r+Rs)}},{key:"getOffset",value:function(){var e=this._element.style,r="margin".concat(hr(this.inlineProperty));return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}}]),t}();const RY=cFe;function xu(t){"@babel/helpers - typeof";return xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xu(t)}function fFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dFe(n.key),n)}}function hFe(t,e,r){return e&&vN(t.prototype,e),r&&vN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dFe(t){var e=pFe(t,"string");return xu(e)==="symbol"?e:String(e)}function pFe(t,e){if(xu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gm(){return typeof Reflect<"u"&&Reflect.get?gm=Reflect.get.bind():gm=function(t,e,r){var n=yFe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},gm.apply(this,arguments)}function yFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Au(t),t!==null););return t}function mFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J1(t,e)}function J1(t,e){return J1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},J1(t,e)}function gFe(t){var e=wFe();return function(){var r=Au(t),n;if(e){var o=Au(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vFe(this,n)}}function vFe(t,e){if(e&&(xu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bFe(t)}function bFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(t){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Au(t)}var SFe="ht__manualColumnMove--backlight",CFe=function(t){mFe(r,t);var e=gFe(r);function r(){return fFe(this,r),e.apply(this,arguments)}return hFe(r,[{key:"build",value:function(){gm(Au(r.prototype),"build",this).call(this),te(this._element,SFe)}}]),r}(RY);const OFe=CFe;function ju(t){"@babel/helpers - typeof";return ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ju(t)}function kFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EFe(n.key),n)}}function RFe(t,e,r){return e&&bN(t.prototype,e),r&&bN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EFe(t){var e=TFe(t,"string");return ju(e)==="symbol"?e:String(e)}function TFe(t,e){if(ju(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(){return typeof Reflect<"u"&&Reflect.get?vm=Reflect.get.bind():vm=function(t,e,r){var n=PFe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},vm.apply(this,arguments)}function PFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Iu(t),t!==null););return t}function MFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eO(t,e)}function eO(t,e){return eO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},eO(t,e)}function _Fe(t){var e=jFe();return function(){var r=Iu(t),n;if(e){var o=Iu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xFe(this,n)}}function xFe(t,e){if(e&&(ju(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AFe(t)}function AFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Iu(t){return Iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Iu(t)}var IFe="ht__manualColumnMove--guideline",HFe=function(t){MFe(r,t);var e=_Fe(r);function r(){return kFe(this,r),e.apply(this,arguments)}return RFe(r,[{key:"build",value:function(){vm(Iu(r.prototype),"build",this).call(this),te(this._element,IFe)}}]),r}(RY);const DFe=HFe;function Hu(t){"@babel/helpers - typeof";return Hu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hu(t)}function NFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,BFe(n.key),n)}}function LFe(t,e,r){return e&&wN(t.prototype,e),r&&wN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function BFe(t){var e=VFe(t,"string");return Hu(e)==="symbol"?e:String(e)}function VFe(t,e){if(Hu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Hu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function da(){return typeof Reflect<"u"&&Reflect.get?da=Reflect.get.bind():da=function(t,e,r){var n=FFe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},da.apply(this,arguments)}function FFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=ko(t),t!==null););return t}function WFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tO(t,e)}function tO(t,e){return tO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},tO(t,e)}function UFe(t){var e=YFe();return function(){var r=ko(t),n;if(e){var o=ko(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zFe(this,n)}}function zFe(t,e){if(e&&(Hu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nO(t)}function nO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function YFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ko(t){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ko(t)}ye.getSingleton().register("beforeColumnMove");ye.getSingleton().register("afterColumnMove");var E0="manualColumnMove",GFe=120,Qo=new WeakMap,SN="ht__manualColumnMove",Ty="show-ui",T0="on-moving--columns",P0="after-selection--columns",$Fe=function(t){WFe(r,t);var e=UFe(r);function r(n){var o;return NFe(this,r),o=e.call(this,n),Qo.set(nO(o),{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(nO(o)),o.backlight=new OFe(n),o.guideline=new DFe(n),o}return LFe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[E0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterScrollVertically",function(){return n.onAfterScrollVertically()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,SN),da(ko(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),da(ko(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ne(this.hot.rootElement,SN),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),da(ko(r.prototype),"disablePlugin",this).call(this)}},{key:"moveColumn",value:function(n,o){return this.moveColumns([n],o)}},{key:"moveColumns",value:function(n,o){var i=Qo.get(this),a=i.cachedDropIndex,s=this.isMovePossible(n,o),l=this.hot.runHooks("beforeColumnMove",n,o,a,s);if(i.cachedDropIndex=void 0,l!==!1){s&&this.hot.columnIndexMapper.moveIndexes(n,o);var u=s&&this.isColumnOrderChanged(n,o);return this.hot.runHooks("afterColumnMove",n,o,a,s,u),u}}},{key:"dragColumn",value:function(n,o){return this.dragColumns([n],o)}},{key:"dragColumns",value:function(n,o){var i=this.countFinalIndex(n,o),a=Qo.get(this);return a.cachedDropIndex=o,this.moveColumns(n,i)}},{key:"isMovePossible",value:function(n,o){var i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),a=n.length+o>i,s=o<0,l=n.some(function(c){return c<0}),u=n.some(function(c){return c>=i});return!(a||s||l||u)}},{key:"isColumnOrderChanged",value:function(n,o){return n.some(function(i,a){return i-a!==o})}},{key:"countFinalIndex",value:function(n,o){var i=an(n,function(a,s){return s<o&&(a+=1),a},0);return o-i}},{key:"getColumnsWidth",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=0,s=n;s<=o;s+=1){var l=i.getRenderableFromVisualIndex(s);s<0?a+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:l!==null&&(a+=this.hot.view._wt.wtTable.getStretchedColumnWidth(l)||0)}return a}},{key:"moveBySettingsOrLoad",value:function(){var n=this.hot.getSettings()[E0];if(Array.isArray(n))this.moveColumns(n,0);else if(n!==void 0){var o=this.persistentStateLoad();o.length&&this.moveColumns(o,0)}}},{key:"isFixedColumnsStart",value:function(n){return n<this.hot.getSettings().fixedColumnsStart}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",n),n.value?n.value:[]}},{key:"prepareColumnsToMoving",value:function(n,o){var i=[];return Oe(n,o,function(a){i.push(a)}),i}},{key:"refreshPositions",value:function(){var n=Qo.get(this),o=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(n.hoveredColumn)&&o>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1));var i=this.hot.view._wt.wtTable,a=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof a.scrollX=="number"?a.scrollX:a.scrollLeft,l=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,n.hoveredColumn-1),u=i.hider.offsetWidth,c=i.TBODY.offsetLeft,f=this.backlight.getOffset().start,h=this.backlight.getSize().width,p=0,y=0;if(this.hot.isRtl()){var g=this.hot.rootWindow,v=ut(this.hot.rootElement),S=g.innerWidth-n.rootElementOffset-v;y=g.innerWidth-n.target.eventPageX-S-(a.scrollX===void 0?s:0)}else y=n.target.eventPageX-(n.rootElementOffset-(a.scrollX===void 0?s:0));if(n.hasRowHeaders&&(p=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(n.hoveredColumn)&&(l+=s),l+=p,n.hoveredColumn<0)n.fixedColumnsStart>0?n.target.col=0:n.target.col=o>0?o-1:o;else if(n.target.TD.offsetWidth/2+l<=y){var O=n.hoveredColumn>=n.countCols?n.countCols-1:n.hoveredColumn;n.target.col=O+1,l+=n.target.TD.offsetWidth}else n.target.col=n.hoveredColumn;var w=y,x=l;y+h+f>=u?w=u-h-f:y+f<c+p&&(w=c+p+Math.abs(f)),l>=u-1?x=u-1:x===0?x=1:a.scrollX!==void 0&&n.hoveredColumn<n.fixedColumnsStart&&(x-=n.rootElementOffset<=a.scrollX?n.rootElementOffset:0),this.backlight.setPosition(null,w),this.guideline.setPosition(null,x)}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this.hot.view._wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),u=this.hot.getSelectedRangeLast(),c=Qo.get(this),f=Ae(n.target,"sortAction");if(!u||!l||c.pressed||n.button!==0||f){c.pressed=!1,c.columnsToMove.length=0,Ne(this.hot.rootElement,[T0,Ty]);return}var h=this.guideline.isBuilt()&&!this.guideline.isAppended(),p=this.backlight.isBuilt()&&!this.backlight.isAppended();h&&p&&(this.guideline.appendTo(s.hider),this.backlight.appendTo(s.hider));var y=u.from,g=u.to,v=Math.min(y.col,g.col),S=Math.max(y.col,g.col);if(o.row<0&&o.col>=v&&o.col<=S){a.column=!0,c.pressed=!0,c.target.eventPageX=n.pageX,c.target.eventOffsetX=n.offsetX,c.hoveredColumn=o.col,c.target.TD=i,c.target.col=o.col,c.columnsToMove=this.prepareColumnsToMoving(v,S),c.hasRowHeaders=!!this.hot.getSettings().rowHeaders,c.countCols=this.hot.countCols(),c.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,c.rootElementOffset=Wt(this.hot.rootElement).left;var O=c.hasRowHeaders?-1:0,w=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,x=o.col<c.fixedColumnsStart,T=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),z=Math.abs(n.offsetX-(this.hot.isRtl()?n.target.offsetWidth:0)),$=this.getColumnsWidth(v,o.col-1)+z,ne=this.getColumnsWidth(O,v-1)+(x?T:0)+$;this.backlight.setPosition(w,ne),this.backlight.setSize(this.getColumnsWidth(v,S),s.hider.offsetHeight-w),this.backlight.setOffset(null,-$),te(this.hot.rootElement,T0)}else Ne(this.hot.rootElement,P0),c.pressed=!1,c.columnsToMove.length=0}},{key:"onMouseMove",value:function(n){var o=Qo.get(this);if(o.pressed){if(n.target===this.backlight.element){var i=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(i)})}o.target.eventPageX=n.pageX,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s=this.hot.getSelectedRangeLast(),l=Qo.get(this);!s||!l.pressed||(l.columnsToMove.indexOf(o.col)>-1?Ne(this.hot.rootElement,Ty):te(this.hot.rootElement,Ty),a.row=!0,a.column=!0,a.cell=!0,l.hoveredColumn=o.col,l.target.TD=i)}},{key:"onMouseUp",value:function(){var n=Qo.get(this),o=n.target.col,i=n.columnsToMove.length;if(n.hoveredColumn=void 0,n.pressed=!1,n.backlightWidth=0,Ne(this.hot.rootElement,[T0,Ty,P0]),this.hot.selection.isSelectedByColumnHeader()&&te(this.hot.rootElement,P0),!(i<1||o===void 0)){var a=n.columnsToMove[0],s=this.hot.toPhysicalColumn(a),l=this.dragColumns(n.columnsToMove,o);if(n.columnsToMove.length=0,l===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var u=this.hot.toVisualColumn(s),c=u+i-1;this.hot.selectColumns(u,c)}}}},{key:"onAfterScrollVertically",value:function(){var n=this.hot.view._wt.wtTable,o=n.getColumnHeaderHeight(0)+1,i=n.holder.scrollTop,a=o+i;this.backlight.setPosition(a),this.backlight.setSize(null,n.hider.offsetHeight-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),da(ko(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return E0}},{key:"PLUGIN_PRIORITY",get:function(){return GFe}}]),r}(at);function Du(t){"@babel/helpers - typeof";return Du=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Du(t)}function KFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function CN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,XFe(n.key),n)}}function qFe(t,e,r){return e&&CN(t.prototype,e),r&&CN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function XFe(t){var e=ZFe(t,"string");return Du(e)==="symbol"?e:String(e)}function ZFe(t,e){if(Du(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Du(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pa(){return typeof Reflect<"u"&&Reflect.get?pa=Reflect.get.bind():pa=function(t,e,r){var n=QFe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},pa.apply(this,arguments)}function QFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ro(t),t!==null););return t}function JFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rO(t,e)}function rO(t,e){return rO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},rO(t,e)}function eWe(t){var e=nWe();return function(){var r=Ro(t),n;if(e){var o=Ro(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tWe(this,n)}}function tWe(t,e){if(e&&(Du(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oO(t)}function oO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ro(t){return Ro=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ro(t)}var Py="manualColumnResize",rWe=130,ON="manualColumnWidths",M0=new WeakMap,oWe=function(t){JFe(r,t);var e=eWe(r);function r(n){var o;KFe(this,r),o=e.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentCol=null,o.selectedCols=[],o.currentWidth=null,o.newSize=null,o.startY=null,o.startWidth=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(oO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.columnWidthsMap=void 0,M0.set(oO(o),{config:void 0}),te(o.handle,"manualColumnResizer"),te(o.guide,"manualColumnResizerGuide"),o}return qFe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[Py]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.columnWidthsMap=new Ti,this.columnWidthsMap.addLocalHook("init",function(){return n.onMapInit()}),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",function(o,i){return n.onModifyColWidth(o,i)}),this.addHook("beforeStretchingColumnWidth",function(o,i){return n.onBeforeStretchingColumnWidth(o,i)}),this.addHook("beforeColumnResize",function(o,i,a){return n.onBeforeColumnResize(o,i,a)}),this.bindEvents(),pa(Ro(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),pa(Ro(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=M0.get(this);n.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),pa(Ro(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualColumnWidths",value:function(){this.hot.runHooks("persistentStateSave",ON,this.columnWidthsMap.getValues())}},{key:"loadManualColumnWidths",value:function(){var n={};return this.hot.runHooks("persistentStateLoad",ON,n),n.value}},{key:"setManualSize",value:function(n,o){var i=Math.max(o,20),a=this.hot.toPhysicalColumn(n);return this.columnWidthsMap.setValueAtIndex(a,i),i}},{key:"clearManualSize",value:function(n){var o=this.hot.toPhysicalColumn(n);this.columnWidthsMap.setValueAtIndex(o,null)}},{key:"onMapInit",value:function(){var n=this,o=M0.get(this),i=this.hot.getSettings()[Py],a=this.loadManualColumnWidths();typeof a<"u"?this.hot.batchExecution(function(){a.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0):Array.isArray(i)?(this.hot.batchExecution(function(){i.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0),o.config=i):i===!0&&Array.isArray(o.config)&&this.hot.batchExecution(function(){o.config.forEach(function(s,l){n.columnWidthsMap.setValueAtIndex(l,s)})},!0)}},{key:"setupHandlePosition",value:function(n){var o=this;if(n.parentNode){this.currentTH=n;var i=this.hot.view._wt,a=i.wtTable.getCoords(this.currentTH),s=a.col;if(!(s<0)){var l=Rt(this.currentTH),u=this.currentTH.getBoundingClientRect(),c=s<i.getSetting("fixedColumnsStart"),f;c&&(f=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),f||(f=i.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,a.row,a.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),this.selectedCols=[];var h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){var p=this.hot.getSelectedRange();_(p,function(y){var g=y.getTopStartCorner().col,v=y.getBottomEndCorner().col;Oe(g,v,function(S){o.selectedCols.includes(S)||o.selectedCols.push(S)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=f.start-6,this.startWidth=parseInt(u.width,10),this.handle.style.top="".concat(f.top,"px"),this.handle.style[this.inlineDir]="".concat(this.startOffset+this.startWidth,"px"),this.handle.style.height="".concat(l,"px"),this.hot.rootElement.appendChild(this.handle)}}}},{key:"refreshHandlePosition",value:function(){this.handle.style[this.inlineDir]="".concat(this.startOffset+this.currentWidth,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(Rt(this.handle),10),o=parseInt(this.handle.style.top,10)+n,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top="".concat(o,"px"),this.refreshGuidePosition(),this.guide.style.height="".concat(i-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}},{key:"hideHandleAndGuide",value:function(){Ne(this.handle,"active"),Ne(this.guide,"active")}},{key:"checkIfColumnHeader",value:function(n){return!!Ra(n,["THEAD"],this.hot.rootElement)}},{key:"getClosestTHParent",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getClosestTHParent(n.parentNode):null}},{key:"onMouseOver",value:function(n){if(!pW(n.target)&&this.checkIfColumnHeader(n.target)){var o=this.getClosestTHParent(n.target);if(!o)return;var i=o.getAttribute("colspan");o&&(i===null||i==="1")&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){var u=n.hot.runHooks("beforeColumnResize",n.newSize,s,!0);u!==void 0&&(n.newSize=u),n.hot.getSettings().stretchH==="all"?n.clearManualSize(s):n.setManualSize(s,n.newSize),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",n.newSize,s,!0),l&&o()};if(this.dblclick>=2){var a=this.selectedCols.length;a>1?(_(this.selectedCols,function(s){i(s)}),o()):_(this.selectedCols,function(s){i(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var o=this;Ae(n.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=n.pageX,this.newSize=this.startWidth)}},{key:"onMouseMove",value:function(n){var o=this;if(this.pressed){var i=(n.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+i,_(this.selectedCols,function(a){o.newSize=o.setManualSize(a,o.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}},{key:"onMouseUp",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){n.hot.runHooks("beforeColumnResize",n.newSize,s,!1),l&&o(),n.saveManualColumnWidths(),n.hot.runHooks("afterColumnResize",n.newSize,s,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth){var a=this.selectedCols.length;a>1?(_(this.selectedCols,function(s){i(s)}),o()):_(this.selectedCols,function(s){i(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this,o=this.hot,i=o.rootWindow,a=o.rootElement;this.eventManager.addEventListener(a,"mouseover",function(s){return n.onMouseOver(s)}),this.eventManager.addEventListener(a,"mousedown",function(s){return n.onMouseDown(s)}),this.eventManager.addEventListener(i,"mousemove",function(s){return n.onMouseMove(s)}),this.eventManager.addEventListener(i,"mouseup",function(){return n.onMouseUp()})}},{key:"onModifyColWidth",value:function(n,o){var i=n;if(this.enabled){var a=this.hot.toPhysicalColumn(o),s=this.columnWidthsMap.getValueAtIndex(a);this.hot.getSettings()[Py]&&s&&(i=s)}return i}},{key:"onBeforeStretchingColumnWidth",value:function(n,o){var i=this.columnWidthsMap.getValueAtIndex(o);return i===null&&(i=n),i}},{key:"onBeforeColumnResize",value:function(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}},{key:"destroy",value:function(){pa(Ro(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Py}},{key:"PLUGIN_PRIORITY",get:function(){return rWe}}]),r}(at);function bd(t){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bd(t)}function iWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sWe(n.key),n)}}function aWe(t,e,r){return e&&kN(t.prototype,e),r&&kN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sWe(t){var e=lWe(t,"string");return bd(e)==="symbol"?e:String(e)}function lWe(t,e){if(bd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(bd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _0=0,RN=1,EN=2,Es="px",uWe=function(){function t(e){iWe(this,t),this.hot=e,this._element=null,this.state=_0}return aWe(t,[{key:"appendTo",value:function(e){e.appendChild(this._element),this.state=EN}},{key:"build",value:function(){this.state===_0&&(this._element=this.hot.rootDocument.createElement("div"),this.state=RN)}},{key:"destroy",value:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=_0}},{key:"isAppended",value:function(){return this.state===EN}},{key:"isBuilt",value:function(){return this.state>=RN}},{key:"setPosition",value:function(e,r){e!==void 0&&(this._element.style.top=e+Es),r!==void 0&&(this._element.style.left=r+Es)}},{key:"getPosition",value:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}},{key:"setSize",value:function(e,r){e&&(this._element.style.width=e+Es),r&&(this._element.style.height=r+Es)}},{key:"getSize",value:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}},{key:"setOffset",value:function(e,r){e&&(this._element.style.marginTop=e+Es),r&&(this._element.style.marginLeft=r+Es)}},{key:"getOffset",value:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}]),t}();const EY=uWe;function Nu(t){"@babel/helpers - typeof";return Nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nu(t)}function cWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,hWe(n.key),n)}}function fWe(t,e,r){return e&&TN(t.prototype,e),r&&TN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function hWe(t){var e=dWe(t,"string");return Nu(e)==="symbol"?e:String(e)}function dWe(t,e){if(Nu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Nu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bm(){return typeof Reflect<"u"&&Reflect.get?bm=Reflect.get.bind():bm=function(t,e,r){var n=pWe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},bm.apply(this,arguments)}function pWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Lu(t),t!==null););return t}function yWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iO(t,e)}function iO(t,e){return iO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iO(t,e)}function mWe(t){var e=bWe();return function(){var r=Lu(t),n;if(e){var o=Lu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gWe(this,n)}}function gWe(t,e){if(e&&(Nu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vWe(t)}function vWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lu(t){return Lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lu(t)}var wWe="ht__manualRowMove--backlight",SWe=function(t){yWe(r,t);var e=mWe(r);function r(){return cWe(this,r),e.apply(this,arguments)}return fWe(r,[{key:"build",value:function(){bm(Lu(r.prototype),"build",this).call(this),te(this._element,wWe)}}]),r}(EY);const CWe=SWe;function Bu(t){"@babel/helpers - typeof";return Bu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bu(t)}function OWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,RWe(n.key),n)}}function kWe(t,e,r){return e&&PN(t.prototype,e),r&&PN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function RWe(t){var e=EWe(t,"string");return Bu(e)==="symbol"?e:String(e)}function EWe(t,e){if(Bu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Bu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wm(){return typeof Reflect<"u"&&Reflect.get?wm=Reflect.get.bind():wm=function(t,e,r){var n=TWe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},wm.apply(this,arguments)}function TWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Vu(t),t!==null););return t}function PWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&aO(t,e)}function aO(t,e){return aO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},aO(t,e)}function MWe(t){var e=AWe();return function(){var r=Vu(t),n;if(e){var o=Vu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _We(this,n)}}function _We(t,e){if(e&&(Bu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xWe(t)}function xWe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function AWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vu(t){return Vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vu(t)}var jWe="ht__manualRowMove--guideline",IWe=function(t){PWe(r,t);var e=MWe(r);function r(){return OWe(this,r),e.apply(this,arguments)}return kWe(r,[{key:"build",value:function(){wm(Vu(r.prototype),"build",this).call(this),te(this._element,jWe)}}]),r}(EY);const HWe=IWe;function Fu(t){"@babel/helpers - typeof";return Fu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fu(t)}function DWe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function MN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,LWe(n.key),n)}}function NWe(t,e,r){return e&&MN(t.prototype,e),r&&MN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function LWe(t){var e=BWe(t,"string");return Fu(e)==="symbol"?e:String(e)}function BWe(t,e){if(Fu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Fu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ya(){return typeof Reflect<"u"&&Reflect.get?ya=Reflect.get.bind():ya=function(t,e,r){var n=VWe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ya.apply(this,arguments)}function VWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Eo(t),t!==null););return t}function FWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sO(t,e)}function sO(t,e){return sO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},sO(t,e)}function WWe(t){var e=zWe();return function(){var r=Eo(t),n;if(e){var o=Eo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return UWe(this,n)}}function UWe(t,e){if(e&&(Fu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lO(t)}function lO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zWe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eo(t){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Eo(t)}ye.getSingleton().register("beforeRowMove");ye.getSingleton().register("afterRowMove");var x0="manualRowMove",YWe=140,Jo=new WeakMap,_N="ht__manualRowMove",My="show-ui",A0="on-moving--rows",j0="after-selection--rows",GWe=function(t){FWe(r,t);var e=WWe(r);function r(n){var o;return DWe(this,r),o=e.call(this,n),Jo.set(lO(o),{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),o.eventManager=new Tt(lO(o)),o.backlight=new CWe(n),o.guideline=new HWe(n),o}return NWe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[x0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterScrollHorizontally",function(){return n.onAfterScrollHorizontally()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.buildPluginUI(),this.registerEvents(),te(this.hot.rootElement,_N),ya(Eo(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),ya(Eo(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Ne(this.hot.rootElement,_N),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),ya(Eo(r.prototype),"disablePlugin",this).call(this)}},{key:"moveRow",value:function(n,o){return this.moveRows([n],o)}},{key:"moveRows",value:function(n,o){var i=Jo.get(this),a=i.cachedDropIndex,s=this.isMovePossible(n,o),l=this.hot.runHooks("beforeRowMove",n,o,a,s);if(i.cachedDropIndex=void 0,l!==!1){s&&this.hot.rowIndexMapper.moveIndexes(n,o);var u=s&&this.isRowOrderChanged(n,o);return this.hot.runHooks("afterRowMove",n,o,a,s,u),u}}},{key:"dragRow",value:function(n,o){return this.dragRows([n],o)}},{key:"dragRows",value:function(n,o){var i=this.countFinalIndex(n,o),a=Jo.get(this);return a.cachedDropIndex=o,this.moveRows(n,i)}},{key:"isMovePossible",value:function(n,o){var i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),a=n.length+o>i,s=o<0,l=n.some(function(c){return c<0}),u=n.some(function(c){return c>=i});return!(a||s||l||u)}},{key:"isRowOrderChanged",value:function(n,o){return n.some(function(i,a){return i-a!==o})}},{key:"countFinalIndex",value:function(n,o){var i=an(n,function(a,s){return s<o&&(a+=1),a},0);return o-i}},{key:"getRowsHeight",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=0,s=n;s<=o;s++){var l=i.getRenderableFromVisualIndex(s);l!==null&&(a+=this.hot.view._wt.wtTable.getRowHeight(l)||23)}return a}},{key:"moveBySettingsOrLoad",value:function(){var n=this.hot.getSettings()[x0];if(Array.isArray(n))this.moveRows(n,0);else if(n!==void 0){var o=this.persistentStateLoad();o.length&&this.moveRows(o,0)}}},{key:"isFixedRowTop",value:function(n){return n<this.hot.getSettings().fixedRowsTop}},{key:"isFixedRowBottom",value:function(n){return n>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}},{key:"persistentStateSave",value:function(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}},{key:"persistentStateLoad",value:function(){var n={};return this.hot.runHooks("persistentStateLoad","manualRowMove",n),n.value?n.value:[]}},{key:"prepareRowsToMoving",value:function(){var n=this.hot.getSelectedRangeLast(),o=[];if(!n)return o;var i=n.from,a=n.to,s=Math.min(i.row,a.row),l=Math.max(i.row,a.row);return Oe(s,l,function(u){o.push(u)}),o}},{key:"refreshPositions",value:function(){var n=Jo.get(this),o=n.target.coords,i=this.hot.view.getFirstFullyVisibleRow(),a=this.hot.view.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(o.row)&&i>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1)),this.isFixedRowBottom(o.row)&&a<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(a+1,1),void 0,!0);var l=this.hot.view._wt.wtTable,u=n.target.TD,c=this.hot.rootElement,f=Wt(c),h=rl(c),p=l.holder.scrollTop,y;this.hot.rootWindow===h?y=h.scrollY:y=h.scrollTop;var g=f.top-y,v=n.target.eventPageY-g+p,S=l.hider.offsetHeight,O=l.TBODY.offsetTop,w=this.backlight.getOffset().top,x=this.backlight.getSize().height,T=u.offsetHeight/2,z=u.offsetHeight,$=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,o.row-1),ne=v>=$+T;this.isFixedRowTop(o.row)&&($+=l.holder.scrollTop),o.row<0?n.target.row=i>0?i-1:i:ne?(n.target.row=o.row+1,$+=o.row===0?z-1:z):n.target.row=o.row;var G=v,q=$;v+x+w>=S?G=S-x-w:v+w<O&&(G=O+Math.abs(w)),$>=S-1&&(q=S-1),this.backlight.setPosition(G),this.guideline.setPosition(q)}},{key:"registerEvents",value:function(){var n=this,o=this.hot.rootDocument.documentElement;this.eventManager.addEventListener(o,"mousemove",function(i){return n.onMouseMove(i)}),this.eventManager.addEventListener(o,"mouseup",function(){return n.onMouseUp()})}},{key:"unregisterEvents",value:function(){this.eventManager.clear()}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this.hot.view._wt,l=s.wtTable,u=s.wtViewport,c=this.hot.selection.isSelectedByRowHeader(),f=this.hot.getSelectedRangeLast(),h=Jo.get(this);if(!f||!c||h.pressed||n.button!==0){h.pressed=!1,h.rowsToMove.length=0,Ne(this.hot.rootElement,[A0,My]);return}var p=this.guideline.isBuilt()&&!this.guideline.isAppended(),y=this.backlight.isBuilt()&&!this.backlight.isAppended();p&&y&&(this.guideline.appendTo(l.hider),this.backlight.appendTo(l.hider));var g=f.from,v=f.to,S=Math.min(g.row,v.row),O=Math.max(g.row,v.row);if(o.col<0&&o.row>=S&&o.row<=O){a.row=!0,h.pressed=!0,h.target.eventPageY=n.pageY,h.target.coords=o,h.target.TD=i,h.rowsToMove=this.prepareRowsToMoving();var w=l.holder.scrollLeft+u.getRowHeaderWidth();this.backlight.setPosition(null,w),this.backlight.setSize(l.hider.offsetWidth-w,this.getRowsHeight(S,O)),this.backlight.setOffset((this.getRowsHeight(S,o.row-1)+n.offsetY)*-1,null),te(this.hot.rootElement,A0),this.refreshPositions()}else Ne(this.hot.rootElement,j0),h.pressed=!1,h.rowsToMove.length=0}},{key:"onMouseMove",value:function(n){var o=Jo.get(this);if(o.pressed){if(n.target===this.backlight.element){var i=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,i)})}o.target.eventPageY=n.pageY,this.refreshPositions()}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s=this.hot.getSelectedRangeLast(),l=Jo.get(this);!s||!l.pressed||(l.rowsToMove.indexOf(o.row)>-1?Ne(this.hot.rootElement,My):te(this.hot.rootElement,My),a.row=!0,a.column=!0,a.cell=!0,l.target.coords=o,l.target.TD=i)}},{key:"onMouseUp",value:function(){var n=Jo.get(this),o=n.target.row,i=n.rowsToMove.length;if(n.pressed=!1,n.backlightHeight=0,Ne(this.hot.rootElement,[A0,My,j0]),this.hot.selection.isSelectedByRowHeader()&&te(this.hot.rootElement,j0),!(i<1||o===void 0)){var a=n.rowsToMove[0],s=this.hot.toPhysicalRow(a),l=this.dragRows(n.rowsToMove,o);if(n.rowsToMove.length=0,l===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);var u=this.hot.toVisualRow(s),c=u+i-1;this.hot.selectRows(u,c)}}}},{key:"onAfterScrollHorizontally",value:function(){var n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=n.holder.scrollLeft,a=o+i;this.backlight.setPosition(null,a),this.backlight.setSize(n.hider.offsetWidth-a)}},{key:"buildPluginUI",value:function(){this.backlight.build(),this.guideline.build()}},{key:"onAfterLoadData",value:function(){this.moveBySettingsOrLoad()}},{key:"destroy",value:function(){this.backlight.destroy(),this.guideline.destroy(),ya(Eo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return x0}},{key:"PLUGIN_PRIORITY",get:function(){return YWe}}]),r}(at);function Wu(t){"@babel/helpers - typeof";return Wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wu(t)}function $We(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qWe(n.key),n)}}function KWe(t,e,r){return e&&xN(t.prototype,e),r&&xN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qWe(t){var e=XWe(t,"string");return Wu(e)==="symbol"?e:String(e)}function XWe(t,e){if(Wu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Wu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ma(){return typeof Reflect<"u"&&Reflect.get?ma=Reflect.get.bind():ma=function(t,e,r){var n=ZWe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ma.apply(this,arguments)}function ZWe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=To(t),t!==null););return t}function QWe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uO(t,e)}function uO(t,e){return uO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},uO(t,e)}function JWe(t){var e=tUe();return function(){var r=To(t),n;if(e){var o=To(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return eUe(this,n)}}function eUe(t,e){if(e&&(Wu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cO(t)}function cO(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function To(t){return To=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},To(t)}var _y="manualRowResize",nUe=30,AN="manualRowHeights",I0=new WeakMap,rUe=function(t){QWe(r,t);var e=JWe(r);function r(n){var o;$We(this,r),o=e.call(this,n);var i=o.hot.rootDocument;return o.currentTH=null,o.currentRow=null,o.selectedRows=[],o.currentHeight=null,o.newSize=null,o.startY=null,o.startHeight=null,o.startOffset=null,o.handle=i.createElement("DIV"),o.guide=i.createElement("DIV"),o.eventManager=new Tt(cO(o)),o.pressed=null,o.dblclick=0,o.autoresizeTimeout=null,o.rowHeightsMap=void 0,I0.set(cO(o),{config:void 0}),te(o.handle,"manualRowResizer"),te(o.guide,"manualRowResizerGuide"),o}return KWe(r,[{key:"inlineDir",get:function(){return this.hot.isRtl()?"right":"left"}},{key:"isEnabled",value:function(){return this.hot.getSettings()[_y]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.rowHeightsMap=new Ti,this.rowHeightsMap.addLocalHook("init",function(){return n.onMapInit()}),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",function(o,i){return n.onModifyRowHeight(o,i)}),this.bindEvents(),ma(To(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ma(To(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){var n=I0.get(this);n.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),ma(To(r.prototype),"disablePlugin",this).call(this)}},{key:"saveManualRowHeights",value:function(){this.hot.runHooks("persistentStateSave",AN,this.rowHeightsMap.getValues())}},{key:"loadManualRowHeights",value:function(){var n={};return this.hot.runHooks("persistentStateLoad",AN,n),n.value}},{key:"setManualSize",value:function(n,o){var i=this.hot.toPhysicalRow(n),a=Math.max(o,YW.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(i,a),a}},{key:"setupHandlePosition",value:function(n){var o=this;this.currentTH=n;var i=this.hot.view,a=i._wt,s=a.wtTable.getCoords(this.currentTH),l=s.row;if(!(l<0)){var u=ut(this.currentTH),c=this.currentTH.getBoundingClientRect(),f=l<a.getSetting("fixedRowsTop"),h=l>=i.countNotHiddenRowIndexes(0,1)-a.getSetting("fixedRowsBottom"),p;f?p=a.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col):h&&(p=a.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),p||(p=a.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.selectedRows=[];var y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){var g=this.hot.getSelectedRange();_(g,function(v){var S=v.getTopStartCorner().row,O=v.getBottomStartCorner().row;Oe(S,O,function(w){o.selectedRows.includes(w)||o.selectedRows.push(w)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=p.top-6,this.startHeight=parseInt(c.height,10),this.handle.style.top="".concat(this.startOffset+this.startHeight,"px"),this.handle.style[this.inlineDir]="".concat(p.start,"px"),this.handle.style.width="".concat(u,"px"),this.hot.rootElement.appendChild(this.handle)}}},{key:"refreshHandlePosition",value:function(){this.handle.style.top="".concat(this.startOffset+this.currentHeight,"px")}},{key:"setupGuidePosition",value:function(){var n=parseInt(ut(this.handle),10),o=parseInt(this.handle.style[this.inlineDir],10)+n,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);te(this.handle,"active"),te(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]="".concat(o,"px"),this.guide.style.width="".concat(i-n,"px"),this.hot.rootElement.appendChild(this.guide)}},{key:"refreshGuidePosition",value:function(){this.guide.style.top=this.handle.style.top}},{key:"hideHandleAndGuide",value:function(){Ne(this.handle,"active"),Ne(this.guide,"active")}},{key:"checkIfRowHeader",value:function(n){var o,i,a=Ra(n,["TH"],this.hot.rootElement);return a&&((o=n.parentNode)===null||o===void 0||(i=o.parentNode)===null||i===void 0?void 0:i.tagName)==="TBODY"}},{key:"getClosestTHParent",value:function(n){return n.tagName!=="TABLE"?n.tagName==="TH"?n:this.getClosestTHParent(n.parentNode):null}},{key:"getActualRowHeight",value:function(n){var o=this.hot.view._wt.wtTable.getRowHeight(n);return o!==void 0&&this.newSize<o?o:this.newSize}},{key:"onMouseOver",value:function(n){if(!pW(n.target)&&this.checkIfRowHeader(n.target)){var o=this.getClosestTHParent(n.target);o&&(this.pressed||this.setupHandlePosition(o))}}},{key:"afterMouseDownTimeout",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){var u=n.hot.runHooks("beforeRowResize",n.getActualRowHeight(s),s,!0);u!==void 0&&(n.newSize=u),n.setManualSize(s,n.newSize),n.hot.runHooks("afterRowResize",n.getActualRowHeight(s),s,!0),l&&o()};if(this.dblclick>=2){var a=this.selectedRows.length;a>1?(_(this.selectedRows,function(s){i(s)}),o()):_(this.selectedRows,function(s){i(s,!0)})}this.dblclick=0,this.autoresizeTimeout=null}},{key:"onMouseDown",value:function(n){var o=this;Ae(n.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(function(){return o.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=n.pageY,this.newSize=this.startHeight)}},{key:"onMouseMove",value:function(n){var o=this;this.pressed&&(this.currentHeight=this.startHeight+(n.pageY-this.startY),_(this.selectedRows,function(i){o.newSize=o.setManualSize(i,o.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}},{key:"onMouseUp",value:function(){var n=this,o=function(){n.hot.forceFullRender=!0,n.hot.view.render(),n.hot.view.adjustElementsSize(!0)},i=function(s,l){n.hot.runHooks("beforeRowResize",n.getActualRowHeight(s),s,!1),l&&o(),n.saveManualRowHeights(),n.hot.runHooks("afterRowResize",n.getActualRowHeight(s),s,!1)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight){var a=this.selectedRows.length;a>1?(_(this.selectedRows,function(s){i(s)}),o()):_(this.selectedRows,function(s){i(s,!0)})}this.setupHandlePosition(this.currentTH)}}},{key:"bindEvents",value:function(){var n=this,o=this.hot,i=o.rootElement,a=o.rootWindow;this.eventManager.addEventListener(i,"mouseover",function(s){return n.onMouseOver(s)}),this.eventManager.addEventListener(i,"mousedown",function(s){return n.onMouseDown(s)}),this.eventManager.addEventListener(a,"mousemove",function(s){return n.onMouseMove(s)}),this.eventManager.addEventListener(a,"mouseup",function(){return n.onMouseUp()})}},{key:"onModifyRowHeight",value:function(n,o){var i=n;if(this.enabled){var a=this.hot.toPhysicalRow(o),s=this.rowHeightsMap.getValueAtIndex(a);this.hot.getSettings()[_y]&&s&&(i=s)}return i}},{key:"onMapInit",value:function(){var n=this,o=I0.get(this),i=this.hot.getSettings()[_y],a=this.loadManualRowHeights();this.hot.batchExecution(function(){typeof a<"u"?a.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)}):Array.isArray(i)?(i.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)}),o.config=i):i===!0&&Array.isArray(o.config)&&o.config.forEach(function(s,l){n.rowHeightsMap.setValueAtIndex(l,s)})},!0)}},{key:"destroy",value:function(){ma(To(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return _y}},{key:"PLUGIN_PRIORITY",get:function(){return nUe}}]),r}(at);function wd(t){"@babel/helpers - typeof";return wd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wd(t)}var jN,IN,HN,DN;function xy(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function oUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,aUe(n.key),n)}}function iUe(t,e,r){return e&&NN(t.prototype,e),r&&NN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function aUe(t){var e=sUe(t,"string");return wd(e)==="symbol"?e:String(e)}function sUe(t,e){if(wd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(wd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lUe=function(){function t(e,r,n,o,i,a){oUe(this,t),this.row=e,this.col=r,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=a}return iUe(t,[{key:"normalize",value:function(e){var r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}},{key:"includes",value:function(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}},{key:"includesHorizontally",value:function(e){return this.col<=e&&this.col+this.colspan-1>=e}},{key:"includesVertically",value:function(e){return this.row<=e&&this.row+this.rowspan-1>=e}},{key:"shift",value:function(e,r){var n=e[0]||e[1],o=r+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",s=Math.min(r,o),l=Math.max(r,o),u=this[a],c=this[a]+this[i]-1;if(u>=r&&(this[a]+=n),n>0)r<=c&&r>u&&(this[i]+=n);else if(n<0){if(s<=u&&l>=c)return this.removed=!0,!1;if(u>=s&&u<=l){var f=l-u+1,h=Math.abs(n)-f;this[a]-=h+n,this[i]-=f}else if(u<=s&&c>=l)this[i]+=n;else if(u<=s&&c>=s&&c<l){var p=c-s+1;this[i]-=p}}return!0}},{key:"isFarther",value:function(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}},{key:"getLastRow",value:function(){return this.row+this.rowspan-1}},{key:"getLastColumn",value:function(){return this.col+this.colspan-1}},{key:"getRange",value:function(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}],[{key:"NEGATIVE_VALUES_WARNING",value:function(e){return it(jN||(jN=xy(["The merged cell declared with {row: ",", col: ",`, 
      rowspan: `,", colspan: ",`} contains negative values, which is 
      not supported. It will not be added to the collection.`],["The merged cell declared with {row: ",", col: ",`,\\x20
      rowspan: `,", colspan: ",`} contains negative values, which is\\x20
      not supported. It will not be added to the collection.`])),e.row,e.col,e.rowspan,e.colspan)}},{key:"IS_OUT_OF_BOUNDS_WARNING",value:function(e){return it(IN||(IN=xy(["The merged cell declared at [",", ",`] is positioned 
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`],["The merged cell declared at [",", ",`] is positioned\\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`])),e.row,e.col)}},{key:"IS_SINGLE_CELL",value:function(e){return it(HN||(HN=xy(["The merged cell declared at [",", ",`] has both "rowspan" 
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has both "rowspan"\\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`])),e.row,e.col)}},{key:"ZERO_SPAN_WARNING",value:function(e){return it(DN||(DN=xy(["The merged cell declared at [",", ",`] has "rowspan" 
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`],["The merged cell declared at [",", ",`] has "rowspan"\\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`])),e.row,e.col)}},{key:"containsNegativeValues",value:function(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}},{key:"isSingleCell",value:function(e){return e.colspan===1&&e.rowspan===1}},{key:"containsZeroSpan",value:function(e){return e.colspan===0||e.rowspan===0}},{key:"isOutOfBounds",value:function(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}}]),t}();const _r=lUe;function fO(t,e,r,n){e?e.row===r&&e.col===n?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Sd(t){"@babel/helpers - typeof";return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sd(t)}var LN;function uUe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function BN(t){return dUe(t)||hUe(t)||fUe(t)||cUe()}function cUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fUe(t,e){if(t){if(typeof t=="string")return hO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hO(t,e)}}function hUe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dUe(t){if(Array.isArray(t))return hO(t)}function hO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function pUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mUe(n.key),n)}}function yUe(t,e,r){return e&&VN(t.prototype,e),r&&VN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mUe(t){var e=gUe(t,"string");return Sd(e)==="symbol"?e:String(e)}function gUe(t,e){if(Sd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Sd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vUe=function(){function t(e){pUe(this,t),this.plugin=e,this.mergedCells=[],this.hot=e.hot}return yUe(t,[{key:"get",value:function(e,r){var n=this.mergedCells,o=!1;return _(n,function(i){return i.row<=e&&i.row+i.rowspan-1>=e&&i.col<=r&&i.col+i.colspan-1>=r?(o=i,!1):!0}),o}},{key:"getByRange",value:function(e){var r=this.mergedCells,n=!1;return _(r,function(o){return o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(n=o,n):!0}),n}},{key:"getWithinRange",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=this.mergedCells,i=[],a=e;if(!a.includesRange){var s=this.hot._createCellCoords(a.from.row,a.from.col),l=this.hot._createCellCoords(a.to.row,a.to.col);a=this.hot._createCellRange(s,s,l)}return _(o,function(u){var c=r.hot._createCellCoords(u.row,u.col),f=r.hot._createCellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),h=r.hot._createCellRange(c,c,f);n?a.overlaps(h)&&i.push(u):a.includesRange(h)&&i.push(u)}),i.length?i:!1}},{key:"add",value:function(e){var r=this.mergedCells,n=e.row,o=e.col,i=e.rowspan,a=e.colspan,s=new _r(n,o,i,a,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,o),u=this.isOverlapping(s);return!l&&!u?(this.hot&&s.normalize(this.hot),r.push(s),s):(lt(t.IS_OVERLAPPING_WARNING(s)),!1)}},{key:"remove",value:function(e,r){var n=this.mergedCells,o=this.get(e,r),i=o?this.mergedCells.indexOf(o):-1;return o&&i!==-1?(n.splice(i,1),o):!1}},{key:"clear",value:function(){var e=this,r=this.mergedCells,n=[],o=[];_(r,function(i){var a=e.hot.getCell(i.row,i.col);a&&n.push([a,e.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,_(n,function(i,a){Oe(0,i.rowspan-1,function(s){Oe(0,i.colspan-1,function(l){if(l!==0||s!==0){var u=e.hot.getCell(i.row+s,i.col+l);u&&o.push([u,null,null,null])}})}),n[a][1]=null}),_(n,function(i){fO.apply(void 0,BN(i))}),_(o,function(i){fO.apply(void 0,BN(i))})}},{key:"isOverlapping",value:function(e){var r=this,n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),o=!1;return _(this.mergedCells,function(i){var a=r.hot._createCellRange(r.hot._createCellCoords(0,0),r.hot._createCellCoords(i.row,i.col),r.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1));return a.overlaps(n)?(o=!0,!1):!0}),o}},{key:"isFirstRenderableMergedCell",value:function(e,r){var n=this.get(e,r);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===r}},{key:"getFirstRenderableCoords",value:function(e,r){var n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);var o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}},{key:"shiftCollections",value:function(e,r,n){var o=this,i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}_(this.mergedCells,function(a){a.shift(i,r)}),US(this.mergedCells.length-1,0,function(a){var s=o.mergedCells[a];s&&s.removed&&o.mergedCells.splice(o.mergedCells.indexOf(s),1)})}}],[{key:"IS_OVERLAPPING_WARNING",value:function(e){return it(LN||(LN=uUe(["The merged cell declared at [",", ",`], overlaps 
      with the other declared merged cell. The overlapping merged cell was not added to the table, please 
      fix your setup.`],["The merged cell declared at [",", ",`], overlaps\\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\\x20
      fix your setup.`])),e.row,e.col)}}]),t}();const bUe=vUe;function Cd(t){"@babel/helpers - typeof";return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(t)}function zi(t,e){return OUe(t)||CUe(t,e)||SUe(t,e)||wUe()}function wUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SUe(t,e){if(t){if(typeof t=="string")return FN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return FN(t,e)}}function FN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function CUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function OUe(t){if(Array.isArray(t))return t}function kUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,EUe(n.key),n)}}function RUe(t,e,r){return e&&WN(t.prototype,e),r&&WN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function EUe(t){var e=TUe(t,"string");return Cd(e)==="symbol"?e:String(e)}function TUe(t,e){if(Cd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Cd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var PUe=function(){function t(e){kUe(this,t),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}return RUe(t,[{key:"correctSelectionAreaSize",value:function(e){if(e[0]===e[2]&&e[1]===e[3]){var r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}},{key:"getDirection",value:function(e,r){var n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}},{key:"snapDragArea",value:function(e,r,n,o){var i=r.slice(0),a=this.getAutofillSize(e,r,n),s=zi(e,4),l=s[0],u=s[1],c=s[2],f=s[3],h=["up","down"].indexOf(n)>-1,p=h?c-l+1:f-u+1,y=Math.floor(a/p)*p,g=a-y,v=this.getFarthestCollection(e,r,n,o);if(v){if(n==="down"){var S=v.row+v.rowspan-l-g,O=i[2]+S;O>=this.plugin.hot.countRows()?i[2]-=g:i[2]+=g?S:0}else if(n==="right"){var w=v.col+v.colspan-u-g,x=i[3]+w;x>=this.plugin.hot.countCols()?i[3]-=g:i[3]+=g?w:0}else if(n==="up"){var T=c-g-v.row+1,z=i[0]+T;z<0?i[0]+=g:i[0]-=g?T:0}else if(n==="left"){var $=f-g-v.col+1,ne=i[1]+$;ne<0?i[1]+=g:i[1]-=g?$:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:o,fillSize:a,dragArea:i,cycleLength:p}),i}},{key:"updateCurrentFillCache",value:function(e){this.currentFillData||(this.currentFillData={}),Yt(this.currentFillData,e)}},{key:"getAutofillSize",value:function(e,r,n){var o=zi(e,4),i=o[0],a=o[1],s=o[2],l=o[3],u=zi(r,4),c=u[0],f=u[1],h=u[2],p=u[3];switch(n){case"up":return i-c;case"down":return h-s;case"left":return a-f;case"right":return p-l;default:return null}}},{key:"getDragArea",value:function(e,r,n){var o=zi(e,4),i=o[0],a=o[1],s=o[2],l=o[3],u=zi(r,4),c=u[0],f=u[1],h=u[2],p=u[3];switch(n){case"up":return[c,f,i-1,l];case"down":return[s+1,a,h,l];case"left":return[c,f,s,a-1];case"right":return[i,l+1,h,p];default:return null}}},{key:"getFarthestCollection",value:function(e,r,n,o){var i=zi(e,4),a=i[0],s=i[1],l=i[2],u=i[3],c=["up","down"].indexOf(n)>-1,f=c?l:u,h=c?a:s,p=this.getAutofillSize(e,r,n),y=c?l-a+1:u-s+1,g=Math.floor(p/y)*y,v=p-g,S=null,O=null,w=null;switch(n){case"up":S="includesVertically",w=f-v+1;break;case"left":S="includesHorizontally",w=f-v+1;break;case"down":S="includesVertically",w=h+v-1;break;case"right":S="includesHorizontally",w=h+v-1;break}return _(o,function(x){x[S](w)&&x.isFarther(O,n)&&(O=x)}),O}},{key:"recreateAfterDataPopulation",value:function(e){if(this.currentFillData){var r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=function(c,f){switch(o){case"up":return c.row-f>=r.from.row;case"down":return c.row+c.rowspan-1+f<=r.to.row;case"left":return c.col-f>=r.from.column;case"right":return c.col+c.colspan-1+f<=r.to.column;default:return null}},a=0,s=null,l=1;do for(var u=0;u<n.length;u+=1){if(s=n[u],a=l*this.currentFillData.cycleLength,i(s,a))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:s.row-a,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+a,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-a,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+a,colspan:s.colspan});break}u===n.length-1&&(l+=1)}while(i(s,a));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}}},{key:"getRangeFromChanges",value:function(e){var r=this,n={min:null,max:null},o={min:null,max:null};return _(e,function(i){var a=i[0],s=r.plugin.hot.propToCol(i[1]);(n.min===null||a<n.min)&&(n.min=a),(n.max===null||a>n.max)&&(n.max=a),(o.min===null||s<o.min)&&(o.min=s),(o.max===null||s>o.max)&&(o.max=s)}),{from:{row:n.min,column:o.min},to:{row:n.max,column:o.max}}}},{key:"dragAreaOverlapsCollections",value:function(e,r,n){var o=this.getDragArea(e,r,n),i=zi(o,4),a=i[0],s=i[1],l=i[2],u=i[3],c=this.plugin.hot._createCellCoords(a,s),f=this.plugin.hot._createCellCoords(l,u),h=this.plugin.hot._createCellRange(c,c,f);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}]),t}();const MUe=PUe;function Od(t){"@babel/helpers - typeof";return Od=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Od(t)}function _Ue(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,AUe(n.key),n)}}function xUe(t,e,r){return e&&UN(t.prototype,e),r&&UN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function AUe(t){var e=jUe(t,"string");return Od(e)==="symbol"?e:String(e)}function jUe(t,e){if(Od(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Od(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IUe=function(){function t(e){_Ue(this,t),this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}return xUe(t,[{key:"snapDelta",value:function(e,r,n){var o=r.to,i=o.row+e.row,a=o.col+e.col;e.row?this.jumpOverMergedCell(e,n,i):e.col&&this.jumpOverMergedCell(e,n,a)}},{key:"jumpOverMergedCell",value:function(e,r,n){var o=e.row||e.col,i=null,a=null,s=null;e.row?(i=r.includesVertically(n),a=r.row,s=r.getLastRow()):e.col&&(i=r.includesHorizontally(n),a=r.col,s=r.getLastColumn()),o!==0&&(o>0?i&&n!==a&&(o+=s-n+1):i&&n!==s&&(o-=n-a+1),e.row?e.row=o:e.col&&(e.col=o))}},{key:"getUpdatedSelectionRange",value:function(e,r){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+r.row,e.to.col+r.col))}},{key:"getSelectedMergedCellClassName",value:function(e,r,n,o){var i=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),s=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(o!==void 0){var u=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r);if(u){var c=this.plugin.mergedCellsCollection.get(e,r);if(c){var f=c.getLastRow(),h=c.getLastColumn(),p=i<=c.row&&a<=c.col&&s>=f&&l>=h;if(p)return"".concat(this.fullySelectedMergedCellClassName,"-").concat(o);if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return"".concat(this.fullySelectedMergedCellClassName,"-multiple")}}}}},{key:"isMergeCellFullySelected",value:function(e,r){var n=[];if(!r||!e)return!1;for(var o=0;o<e.rowspan;o+=1)for(var i=0;i<e.colspan;i+=1)n.push(this.hot._createCellCoords(e.row+o,e.col+i));for(var a=0;a<n.length;a+=1){for(var s=[],l=0;l<r.length;l+=1)s[l]=r[l].includes(n[a]);if(!s.includes(!0))return!1}return!0}},{key:"getSelectedMergedCellClassNameToRemove",value:function(){for(var e=[],r=0;r<=7;r+=1)e.push("".concat(this.fullySelectedMergedCellClassName,"-").concat(r));return e.push("".concat(this.fullySelectedMergedCellClassName,"-multiple")),e}}]),t}();const HUe=IUe;function DUe(t){return{key:"mergeCells",name:function(){var e=this.getSelectedLast();if(e){var r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(qR)}return this.getTranslatedPhrase(KR)},callback:function(){t.toggleMergeOnSelection()},disabled:function(){var e=this.getSelectedLast();if(!e)return!0;var r=_r.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1});return r||this.selection.isSelectedByCorner()},hidden:!1}}function Uu(t){"@babel/helpers - typeof";return Uu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uu(t)}function NUe(t,e){return VUe(t)||BUe(t,e)||TY(t,e)||LUe()}function LUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BUe(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function VUe(t){if(Array.isArray(t))return t}function FUe(t){return zUe(t)||UUe(t)||TY(t)||WUe()}function WUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TY(t,e){if(t){if(typeof t=="string")return dO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dO(t,e)}}function UUe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zUe(t){if(Array.isArray(t))return dO(t)}function dO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function YUe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$Ue(n.key),n)}}function GUe(t,e,r){return e&&zN(t.prototype,e),r&&zN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ue(t){var e=KUe(t,"string");return Uu(e)==="symbol"?e:String(e)}function KUe(t,e){if(Uu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Uu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zs(){return typeof Reflect<"u"&&Reflect.get?Zs=Reflect.get.bind():Zs=function(t,e,r){var n=qUe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Zs.apply(this,arguments)}function qUe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=wi(t),t!==null););return t}function XUe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pO(t,e)}function pO(t,e){return pO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},pO(t,e)}function ZUe(t){var e=JUe();return function(){var r=wi(t),n;if(e){var o=wi(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return QUe(this,n)}}function QUe(t,e){if(e&&(Uu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return PY(t)}function PY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function JUe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wi(t){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wi(t)}ye.getSingleton().register("beforeMergeCells");ye.getSingleton().register("afterMergeCells");ye.getSingleton().register("beforeUnmergeCells");ye.getSingleton().register("afterUnmergeCells");var of="mergeCells",e2e=150,YN=new WeakMap,GN=of,t2e=function(t){XUe(r,t);var e=ZUe(r);function r(n){var o;return YUe(this,r),o=e.call(this,n),YN.set(PY(o),{lastDesiredCoords:null}),o.mergedCellsCollection=null,o.autofillCalculations=null,o.selectionCalculations=null,o}return GUe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[of]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.mergedCellsCollection=new bUe(this),this.autofillCalculations=new MUe(this),this.selectionCalculations=new HUe(this),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("modifyTransformStart",function(){return n.onModifyTransformStart.apply(n,arguments)}),this.addHook("afterModifyTransformStart",function(){return n.onAfterModifyTransformStart.apply(n,arguments)}),this.addHook("modifyTransformEnd",function(){return n.onModifyTransformEnd.apply(n,arguments)}),this.addHook("modifyGetCellCoords",function(){return n.onModifyGetCellCoords.apply(n,arguments)}),this.addHook("beforeSetRangeStart",function(){return n.onBeforeSetRangeStart.apply(n,arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return n.onBeforeSetRangeStart.apply(n,arguments)}),this.addHook("beforeSetRangeEnd",function(){return n.onBeforeSetRangeEnd.apply(n,arguments)}),this.addHook("afterIsMultipleSelection",function(){return n.onAfterIsMultipleSelection.apply(n,arguments)}),this.addHook("afterRenderer",function(){return n.onAfterRenderer.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.addMergeActionsToContextMenu.apply(n,arguments)}),this.addHook("afterGetCellMeta",function(){return n.onAfterGetCellMeta.apply(n,arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return n.onAfterViewportRowCalculatorOverride.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),this.addHook("modifyAutofillRange",function(){return n.onModifyAutofillRange.apply(n,arguments)}),this.addHook("afterCreateCol",function(){return n.onAfterCreateCol.apply(n,arguments)}),this.addHook("afterRemoveCol",function(){return n.onAfterRemoveCol.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("afterChange",function(){return n.onAfterChange.apply(n,arguments)}),this.addHook("beforeDrawBorders",function(){return n.onBeforeDrawAreaBorders.apply(n,arguments)}),this.addHook("afterDrawSelection",function(){return n.onAfterDrawSelection.apply(n,arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return n.onBeforeRemoveCellClassNames.apply(n,arguments)}),this.addHook("beforeUndoStackChange",function(o,i){if(i==="MergeCells")return!1}),this.registerShortcuts(),Zs(wi(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),Zs(wi(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){var n=this.hot.getSettings()[of];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(n),Zs(wi(r.prototype),"updatePlugin",this).call(this)}},{key:"ifChromeForceRepaint",value:function(){var n=this;if(hF()){var o=[],i=[];this.mergedCellsCollection.mergedCells.forEach(function(a){for(var s=a.row,l=a.rowspan,u=s+1;u<s+l;u++)i.push(u)}),i=FUe(new Set(i)),i.forEach(function(a){var s=n.hot.rowIndexMapper.getRenderableFromVisualIndex(a);n.hot.view._wt.wtOverlays.getOverlays(!0).map(function(l){return(l==null?void 0:l.name)==="master"?l:l.clone.wtTable}).forEach(function(l){var u=l.getRow(s);u&&(u.style.background=Af(u,"backgroundColor").replace(")",", 0.99)"),o.push(u))})}),this.hot._registerTimeout(function(){o.forEach(function(a){a.style.background=Af(a,"backgroundColor").replace(", 0.99)",")")})},1)}}},{key:"validateSetting",value:function(n){var o=!0;return n?(_r.containsNegativeValues(n)?(lt(_r.NEGATIVE_VALUES_WARNING(n)),o=!1):_r.isOutOfBounds(n,this.hot.countRows(),this.hot.countCols())?(lt(_r.IS_OUT_OF_BOUNDS_WARNING(n)),o=!1):_r.isSingleCell(n)?(lt(_r.IS_SINGLE_CELL(n)),o=!1):_r.containsZeroSpan(n)&&(lt(_r.ZERO_SPAN_WARNING(n)),o=!1),o):!1}},{key:"generateFromSettings",value:function(n){var o=this;if(Array.isArray(n)){var i=[];if(_(n,function(a){if(o.validateSetting(a)){var s=o.hot._createCellCoords(a.row,a.col),l=o.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1),u=o.hot._createCellRange(s,s,l);o.mergeRange(u,!0,!0),Oe(a.row,a.row+a.rowspan-1,function(c){Oe(a.col,a.col+a.colspan-1,function(f){c===a.row&&f===a.col||i.push([c,f,null])})})}}),i.length===0)return;this.hot.setDataAtCell(i)}}},{key:"clearCollections",value:function(){this.mergedCellsCollection.clear()}},{key:"canMergeRange",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return o?!0:this.validateSetting(n)}},{key:"toggleMergeOnSelection",value:function(){var n=this.hot.getSelectedRangeLast();if(n){n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=n.from,i=n.to;this.toggleMerge(n),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"mergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){n.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");var o=n.from,i=n.to;this.unmergeRange(n,!0),this.mergeRange(n),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"unmergeSelection",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(n){var o=n.from,i=n.to;this.unmergeRange(n,!0),this.hot.selectCell(o.row,o.col,i.row,i.col,!1)}}},{key:"mergeRange",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=n.getTopStartCorner(),l=n.getBottomEndCorner(),u={row:s.row,col:s.col,rowspan:l.row-s.row+1,colspan:l.col-s.col+1},c=[],f=null;if(!this.canMergeRange(u,i))return!1;this.hot.runHooks("beforeMergeCells",n,i),Oe(0,u.rowspan-1,function(p){Oe(0,u.colspan-1,function(y){var g=null;c[p]||(c[p]=[]),p===0&&y===0?g=o.hot.getSourceDataAtCell(o.hot.toPhysicalRow(u.row),o.hot.toPhysicalColumn(u.col)):o.hot.setCellMeta(u.row+p,u.col+y,"hidden",!0),c[p][y]=g})}),this.hot.setCellMeta(u.row,u.col,"spanned",!0);var h=this.mergedCellsCollection.add(u);return h?(a?f=[u.row,u.col,c]:this.hot.populateFromArray(u.row,u.col,c,void 0,void 0,this.pluginName),i||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",n,u,i),f):!0}},{key:"unmergeRange",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this.mergedCellsCollection.getWithinRange(n);a&&(this.hot.runHooks("beforeUnmergeCells",n,i),_(a,function(s){o.mergedCellsCollection.remove(s.row,s.col),Oe(0,s.rowspan-1,function(l){Oe(0,s.colspan-1,function(u){o.hot.removeCellMeta(s.row+l,s.col+u,"hidden")})}),o.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",n,i),this.hot.render())}},{key:"toggleMerge",value:function(n){var o=this.mergedCellsCollection.get(n.from.row,n.from.col),i=o.row===n.from.row&&o.col===n.from.col&&o.row+o.rowspan-1===n.to.row&&o.col+o.colspan-1===n.to.col;i?this.unmergeRange(n):this.mergeSelection(n)}},{key:"merge",value:function(n,o,i,a){var s=this.hot._createCellCoords(n,o),l=this.hot._createCellCoords(i,a);this.mergeRange(this.hot._createCellRange(s,s,l))}},{key:"unmerge",value:function(n,o,i,a){var s=this.hot._createCellCoords(n,o),l=this.hot._createCellCoords(i,a);this.unmergeRange(this.hot._createCellRange(s,s,l))}},{key:"onAfterInit",value:function(){this.generateFromSettings(this.hot.getSettings()[of]),this.hot.render()}},{key:"registerShortcuts",value:function(){var n=this,o=this.hot.getShortcutManager(),i=o.getContext("grid");i.addShortcut({keys:[["Control","m"]],callback:function(){n.toggleMerge(n.hot.getSelectedRangeLast()),n.hot.render()},runOnlyIf:function(a){return!a.altKey},group:GN})}},{key:"unregisterShortcuts",value:function(){var n=this.hot.getShortcutManager(),o=n.getContext("grid");o.removeShortcutsByGroup(GN)}},{key:"onAfterIsMultipleSelection",value:function(n){if(n){for(var o=this.mergedCellsCollection.mergedCells,i=this.hot.getSelectedRangeLast(),a=0;a<o.length;a+=1)if(i.from.row===o[a].row&&i.from.col===o[a].col&&i.to.row===o[a].row+o[a].rowspan-1&&i.to.col===o[a].col+o[a].colspan-1)return!1}return n}},{key:"onModifyTransformStart",value:function(n){var o=YN.get(this),i=this.hot.getSelectedRangeLast(),a={row:n.row,col:n.col},s=null,l=this.hot._createCellCoords(i.highlight.row,i.highlight.col),u=this.mergedCellsCollection.get(l.row,l.col);if(o.lastDesiredCoords||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),u){var c=this.hot._createCellCoords(u.row,u.col),f=this.hot._createCellCoords(u.row+u.rowspan-1,u.col+u.colspan-1),h=this.hot._createCellRange(c,c,f);h.includes(o.lastDesiredCoords)||(o.lastDesiredCoords=this.hot._createCellCoords(null,null)),a.row=o.lastDesiredCoords.row?o.lastDesiredCoords.row-l.row:a.row,a.col=o.lastDesiredCoords.col?o.lastDesiredCoords.col-l.col:a.col,n.row>0?a.row=u.row+u.rowspan-1-l.row+n.row:n.row<0&&(a.row=l.row-u.row+n.row),n.col>0?a.col=u.col+u.colspan-1-l.col+n.col:n.col<0&&(a.col=l.col-u.col+n.col)}s=this.hot._createCellCoords(i.highlight.row+a.row,i.highlight.col+a.col);var p=this.mergedCellsCollection.get(s.row,s.col);if(p){var y=this.mergedCellsCollection.getFirstRenderableCoords(p.row,p.col);o.lastDesiredCoords=s,a={row:y.row-l.row,col:y.col-l.col}}a.row!==0&&(n.row=a.row),a.col!==0&&(n.col=a.col)}},{key:"onModifyTransformEnd",value:function(n){var o=this,i=this.hot.getSelectedRangeLast(),a=Rn(n),s=this.selectionCalculations.getUpdatedSelectionRange(i,n),l=Rn(a),u=this.mergedCellsCollection.getWithinRange(s,!0);do l=Rn(a),this.selectionCalculations.getUpdatedSelectionRange(i,a),_(u,function(c){o.selectionCalculations.snapDelta(a,i,c)});while(a.row!==l.row||a.col!==l.col);n.row=a.row,n.col=a.col}},{key:"onModifyGetCellCoords",value:function(n,o){if(!(n<0||o<0)){var i=this.mergedCellsCollection.get(n,o);if(i){var a=i.row,s=i.col,l=i.colspan,u=i.rowspan;return[a,s,a+u-1,s+l-1]}}}},{key:"addMergeActionsToContextMenu",value:function(n){n.items.push({name:"---------"},DUe(this))}},{key:"onAfterRenderer",value:function(n,o,i){var a=this.mergedCellsCollection.get(o,i),s=Ge(a)?Rn(a):void 0;if(Ge(s)){var l=this.hot,u=l.rowIndexMapper,c=l.columnIndexMapper,f=s.row,h=s.col,p=s.colspan,y=s.rowspan,g=this.translateMergedCellToRenderable(f,y,h,p),v=NUe(g,2),S=v[0],O=v[1],w=u.getRenderableFromVisualIndex(o),x=c.getRenderableFromVisualIndex(i),T=S-w+1,z=O-x+1;s.row=u.getNearestNotHiddenIndex(s.row,1),s.col=c.getNearestNotHiddenIndex(s.col,1),s.rowspan=Math.min(s.rowspan,T),s.colspan=Math.min(s.colspan,z)}fO(n,s,o,i)}},{key:"onBeforeSetRangeStart",value:function(n){if(this.mergedCellsCollection.isFirstRenderableMergedCell(n.row,n.col)){var o=this.mergedCellsCollection.get(n.row,n.col),i=[o.row,o.col];n.row=i[0],n.col=i[1]}}},{key:"onBeforeSetRangeEnd",value:function(n){var o=this.hot.getSelectedRangeLast();o.highlight=this.hot._createCellCoords(o.highlight.row,o.highlight.col),o.to=n;var i=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{i=!1;for(var a=0;a<this.mergedCellsCollection.mergedCells.length;a+=1){var s=this.mergedCellsCollection.mergedCells[a],l=s.getRange();o.expandByRange(l)&&(n.row=o.to.row,n.col=o.to.col,i=!0)}}while(i)}},{key:"onAfterGetCellMeta",value:function(n,o,i){var a=this.mergedCellsCollection.get(n,o);a&&(a.row!==n||a.col!==o?i.copyable=!1:(i.rowspan=a.rowspan,i.colspan=a.colspan))}},{key:"onAfterViewportRowCalculatorOverride",value:function(n){var o=this.hot.countCols();this.modifyViewportRowStart(n,o),this.modifyViewportRowEnd(n,o)}},{key:"modifyViewportRowStart",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(n.startRow),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(a,s);if(Ge(l)){var u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l.row,1));if(u<n.startRow){n.startRow=u,this.modifyViewportRowStart(n,o);return}}}}},{key:"modifyViewportRowEnd",value:function(n,o){for(var i=this.hot.rowIndexMapper,a=i.getVisualFromRenderableIndex(n.endRow),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(a,s);if(Ge(l)){var u=l.row+l.rowspan-1,c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(c>n.endRow){n.endRow=c,this.modifyViewportRowEnd(n,o);return}}}}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){var o=this.hot.countRows();this.modifyViewportColumnStart(n,o),this.modifyViewportColumnEnd(n,o)}},{key:"modifyViewportColumnStart",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(n.startColumn),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(s,a);if(Ge(l)){var u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l.col,1));if(u<n.startColumn){n.startColumn=u,this.modifyViewportColumnStart(n,o);return}}}}},{key:"modifyViewportColumnEnd",value:function(n,o){for(var i=this.hot.columnIndexMapper,a=i.getVisualFromRenderableIndex(n.endColumn),s=0;s<o;s+=1){var l=this.mergedCellsCollection.get(s,a);if(Ge(l)){var u=l.col+l.colspan-1,c=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(c>n.endColumn){n.endColumn=c,this.modifyViewportColumnEnd(n,o);return}}}}},{key:"translateMergedCellToRenderable",value:function(n,o,i,a){var s=this.hot,l=s.rowIndexMapper,u=s.columnIndexMapper,c,f;o===0?c=l.getNearestNotHiddenIndex(n,1):c=l.getNearestNotHiddenIndex(n+o-1,-1),a===0?f=u.getNearestNotHiddenIndex(i,1):f=u.getNearestNotHiddenIndex(i+a-1,-1);var h=n>=0?l.getRenderableFromVisualIndex(c):n,p=i>=0?u.getRenderableFromVisualIndex(f):i;return[h,p]}},{key:"onModifyAutofillRange",value:function(n,o){this.autofillCalculations.correctSelectionAreaSize(o);var i=this.autofillCalculations.getDirection(o,n),a=n;if(this.autofillCalculations.dragAreaOverlapsCollections(o,a,i))return a=o,a;var s=this.mergedCellsCollection.getWithinRange({from:{row:o[0],col:o[1]},to:{row:o[2],col:o[3]}});return s&&(a=this.autofillCalculations.snapDragArea(o,a,i,s)),a}},{key:"onAfterCreateCol",value:function(n,o){this.mergedCellsCollection.shiftCollections("right",n,o)}},{key:"onAfterRemoveCol",value:function(n,o){this.mergedCellsCollection.shiftCollections("left",n,o)}},{key:"onAfterCreateRow",value:function(n,o,i){i!=="auto"&&this.mergedCellsCollection.shiftCollections("down",n,o)}},{key:"onAfterRemoveRow",value:function(n,o){this.mergedCellsCollection.shiftCollections("up",n,o)}},{key:"onAfterChange",value:function(n,o){o==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(n)}},{key:"onBeforeDrawAreaBorders",value:function(n,o){if(o&&o==="area"){var i=this.hot.getSelectedRangeLast(),a=this.mergedCellsCollection.getWithinRange(i);_(a,function(s){i.getBottomEndCorner().row===s.getLastRow()&&i.getBottomEndCorner().col===s.getLastColumn()&&(n[2]=s.row,n[3]=s.col)})}}},{key:"onAfterModifyTransformStart",value:function(n,o,i){if(this.enabled){var a=this.mergedCellsCollection.get(n.row,n.col);if(a){var s=o>0,l=o<0,u=i<0,c=i>0,f=a.row+a.rowspan-1===this.hot.countRows()-1,h=a.row===0,p=a.col+a.colspan-1===this.hot.countCols()-1,y=a.col===0;(s&&f||l&&h||c&&p||u&&y)&&(n.row=a.row,n.col=a.col)}}}},{key:"onAfterDrawSelection",value:function(n,o,i,a){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(n,o,i,a)}},{key:"onBeforeRemoveCellClassNames",value:function(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}],[{key:"PLUGIN_KEY",get:function(){return of}},{key:"PLUGIN_PRIORITY",get:function(){return e2e}}]),r}(at);function $N(t){return i2e(t)||o2e(t)||r2e(t)||n2e()}function n2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r2e(t,e){if(t){if(typeof t=="string")return KN(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return KN(t,e)}}function KN(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o2e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i2e(t){if(Array.isArray(t))return t}function a2e(t,e){return function(r,n){var o=$N(r),i=o.slice(1),a=$N(n),s=a.slice(1);return function l(u){var c=t[u],f=e[u],h=i[u],p=s[u],y=f.multiColumnSorting,g=y.compareFunctionFactory?y.compareFunctionFactory:uz(f.type),v=g(c,f,y)(h,p);if(v===Hr){var S=u+1;if(typeof e[S]<"u")return l(S)}return v}(0)}}var qN;function s2e(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function XN(){lt(it(qN||(qN=s2e(["Plugins `columnSorting` and `multiColumnSorting` should not be enabled simultaneously. \n    Only `multiColumnSorting` will work."],["Plugins \\`columnSorting\\` and \\`multiColumnSorting\\` should not be enabled simultaneously. \n    Only \\`multiColumnSorting\\` will work."]))))}var MY="sort";function l2e(t,e,r){var n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push("".concat(MY,"-").concat(t.getIndexOfColumnInSortQueue(e)+1)),n}function u2e(t){var e=t.className.split(" "),r=new RegExp("^".concat(MY,"-[0-9]{1,2}$"));return e.filter(function(n){return r.test(n)})}function zu(t){"@babel/helpers - typeof";return zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zu(t)}function c2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ZN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h2e(n.key),n)}}function f2e(t,e,r){return e&&ZN(t.prototype,e),r&&ZN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h2e(t){var e=d2e(t,"string");return zu(e)==="symbol"?e:String(e)}function d2e(t,e){if(zu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dn(){return typeof Reflect<"u"&&Reflect.get?Dn=Reflect.get.bind():Dn=function(t,e,r){var n=p2e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Dn.apply(this,arguments)}function p2e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=pn(t),t!==null););return t}function y2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yO(t,e)}function yO(t,e){return yO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},yO(t,e)}function m2e(t){var e=b2e();return function(){var r=pn(t),n;if(e){var o=pn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return g2e(this,n)}}function g2e(t,e){if(e&&(zu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return v2e(t)}function v2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pn(t){return pn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pn(t)}var mO="multiColumnSorting",w2e=170,S2e="append",QN="columnSorting";lz(mO,a2e);var C2e=function(t){y2e(r,t);var e=m2e(r);function r(n){var o;return c2e(this,r),o=e.call(this,n),o.pluginKey=mO,o}return f2e(r,[{key:"isEnabled",value:function(){return Dn(pn(r.prototype),"isEnabled",this).call(this)}},{key:"enablePlugin",value:function(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[QN]&&XN(),Dn(pn(r.prototype),"enablePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Dn(pn(r.prototype),"disablePlugin",this).call(this)}},{key:"sort",value:function(n){Dn(pn(r.prototype),"sort",this).call(this,n)}},{key:"clearSort",value:function(){Dn(pn(r.prototype),"clearSort",this).call(this)}},{key:"isSorted",value:function(){return Dn(pn(r.prototype),"isSorted",this).call(this)}},{key:"getSortConfig",value:function(n){return Dn(pn(r.prototype),"getSortConfig",this).call(this,n)}},{key:"setSortConfig",value:function(n){Dn(pn(r.prototype),"setSortConfig",this).call(this,n)}},{key:"getNormalizedSortConfigs",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(n)?n:[n]}},{key:"updateHeaderClasses",value:function(n){for(var o,i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];(o=Dn(pn(r.prototype),"updateHeaderClasses",this)).call.apply(o,[this,n].concat(a)),Ne(n,u2e(n)),this.enabled!==!1&&te(n,l2e.apply(void 0,a))}},{key:"onUpdateSettings",value:function(n){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[QN]&&XN(),Dn(pn(r.prototype),"onUpdateSettings",this).call(this,n)}},{key:"onAfterOnCellMouseDown",value:function(n,o){h1(o.row,o.col,n)!==!1&&this.wasClickableHeaderClicked(n,o.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(o.col),this.sort(this.getNextSortConfig(o.col,S2e))):this.sort(this.getColumnNextConfig(o.col)))}}],[{key:"PLUGIN_KEY",get:function(){return mO}},{key:"PLUGIN_PRIORITY",get:function(){return w2e}}]),r}(fz);function Yu(t){"@babel/helpers - typeof";return Yu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yu(t)}function O2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JN(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R2e(n.key),n)}}function k2e(t,e,r){return e&&JN(t.prototype,e),r&&JN(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function R2e(t){var e=E2e(t,"string");return Yu(e)==="symbol"?e:String(e)}function E2e(t,e){if(Yu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Yu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sm(){return typeof Reflect<"u"&&Reflect.get?Sm=Reflect.get.bind():Sm=function(t,e,r){var n=T2e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Sm.apply(this,arguments)}function T2e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Gu(t),t!==null););return t}function P2e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gO(t,e)}function gO(t,e){return gO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},gO(t,e)}function M2e(t){var e=A2e();return function(){var r=Gu(t),n;if(e){var o=Gu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _2e(this,n)}}function _2e(t,e){if(e&&(Yu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return x2e(t)}function x2e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A2e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Gu(t){return Gu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gu(t)}var j2e="multipleSelectionHandles",I2e=160,H2e=function(t){P2e(r,t);var e=M2e(r);function r(n){var o;return O2e(this,r),o=e.call(this,n),o.dragged=[],o.eventManager=null,o.lastSetCell=null,o}return k2e(r,[{key:"isEnabled",value:function(){return Ir()}},{key:"enablePlugin",value:function(){this.enabled||(this.eventManager||(this.eventManager=new Tt(this)),this.registerListeners(),Sm(Gu(r.prototype),"enablePlugin",this).call(this))}},{key:"registerListeners",value:function(){var n=this,o=this,i=this.hot.rootElement;function a(s){if(o.dragged.length===1)return o.dragged.splice(0,o.dragged.length),!0;var l=o.dragged.indexOf(s);if(l===-1)return!1;l===0?o.dragged=o.dragged.slice(0,1):l===1&&(o.dragged=o.dragged.slice(-1))}this.eventManager.addEventListener(i,"touchstart",function(s){var l;if(Ae(s.target,"topSelectionHandle-HitArea"))return l=o.hot.getSelectedRangeLast(),o.dragged.push("top"),o.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1;if(Ae(s.target,"bottomSelectionHandle-HitArea"))return l=o.hot.getSelectedRangeLast(),o.dragged.push("bottom"),o.touchStartRange={width:l.getWidth(),height:l.getHeight(),direction:l.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchend",function(s){if(Ae(s.target,"topSelectionHandle-HitArea"))return a.call(o,"top"),o.touchStartRange=void 0,s.preventDefault(),!1;if(Ae(s.target,"bottomSelectionHandle-HitArea"))return a.call(o,"bottom"),o.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(i,"touchmove",function(s){var l=n.hot.rootDocument,u,c,f,h,p,y;if(o.dragged.length!==0){var g=l.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!g||g===o.lastSetCell||((g.nodeName==="TD"||g.nodeName==="TH")&&(u=o.hot.getCoords(g),u.col===-1&&(u.col=0),c=o.hot.getSelectedRangeLast(),f=c.getWidth(),h=c.getHeight(),p=c.getDirection(),f===1&&h===1&&o.hot.selection.setRangeEnd(u),y=o.getCurrentRangeCoords(c,u,o.touchStartRange.direction,p,o.dragged[0]),y.start!==null&&o.hot.selection.setRangeStart(y.start),o.hot.selection.setRangeEnd(y.end),o.lastSetCell=g),s.preventDefault())}})}},{key:"getCurrentRangeCoords",value:function(n,o,i,a,s){var l=n.getTopStartCorner(),u=n.getBottomEndCorner(),c=n.getBottomStartCorner(),f=n.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(a){case"NE-SW":case"NW-SE":s==="top"?h={start:this.hot._createCellCoords(o.row,n.highlight.col),end:this.hot._createCellCoords(c.row,o.col)}:h={start:this.hot._createCellCoords(n.highlight.row,o.col),end:this.hot._createCellCoords(o.row,l.col)};break;case"SE-NW":s==="bottom"&&(h={start:this.hot._createCellCoords(u.row,o.col),end:this.hot._createCellCoords(o.row,l.col)});break}break;case"NW-SE":switch(a){case"NE-SW":s==="top"?h={start:o,end:c}:h.end=o;break;case"NW-SE":s==="top"?h={start:o,end:u}:h.end=o;break;case"SE-NW":s==="top"?h={start:o,end:l}:h.end=o;break;case"SW-NE":s==="top"?h={start:o,end:f}:h.end=o;break}break;case"SW-NE":switch(a){case"NW-SE":s==="bottom"?h={start:this.hot._createCellCoords(o.row,l.col),end:this.hot._createCellCoords(c.row,o.col)}:h={start:this.hot._createCellCoords(l.row,o.col),end:this.hot._createCellCoords(o.row,u.col)};break;case"SW-NE":s==="top"?h={start:this.hot._createCellCoords(n.highlight.row,o.col),end:this.hot._createCellCoords(o.row,u.col)}:h={start:this.hot._createCellCoords(o.row,l.col),end:this.hot._createCellCoords(l.row,o.col)};break;case"SE-NW":s==="bottom"?h={start:this.hot._createCellCoords(o.row,f.col),end:this.hot._createCellCoords(l.row,o.col)}:s==="top"&&(h={start:c,end:o});break}break;case"SE-NW":switch(a){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(h.end=o);break;case"SE-NW":s==="top"?h.end=o:h={start:o,end:l};break}break}return h}},{key:"isDragged",value:function(){return this.dragged.length>0}}],[{key:"PLUGIN_KEY",get:function(){return j2e}},{key:"PLUGIN_PRIORITY",get:function(){return I2e}}]),r}(at);function vO(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.label,r=e===void 0?"":e,n=t.colspan,o=n===void 0?1:n,i=t.origColspan,a=i===void 0?1:i,s=t.collapsible,l=s===void 0?!1:s,u=t.crossHiddenColumns,c=u===void 0?[]:u,f=t.isCollapsed,h=f===void 0?!1:f,p=t.isHidden,y=p===void 0?!1:p,g=t.isRoot,v=g===void 0?!1:g,S=t.isPlaceholder,O=S===void 0?!1:S;return{label:r,colspan:o,origColspan:a,collapsible:l,isCollapsed:h,crossHiddenColumns:c,isHidden:y,isRoot:v,isPlaceholder:O}}function _Y(){return{label:"",isPlaceholder:!0}}function eL(t){return B2e(t)||L2e(t)||N2e(t)||D2e()}function D2e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N2e(t,e){if(t){if(typeof t=="string")return bO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bO(t,e)}}function L2e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function B2e(t){if(Array.isArray(t))return bO(t)}function bO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function V2e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r=[];if(e===0)return r;_(t,function(o){var i=[],a=0;r.push(i),_(o,function(s){var l=vO();if(Ge(s)){var u=s.label,c=s.colspan;l.label=Dt(u),typeof c=="number"&&c>1&&(l.colspan=c,l.origColspan=c)}else l.label=Dt(s);a+=l.origColspan;var f=!1;if(a>=e&&(l.colspan=l.origColspan-(a-e),l.origColspan=l.colspan,f=!0),i.push(l),l.colspan>1)for(var h=0;h<l.colspan-1;h++)i.push(_Y());return!f})});var n=Math.max.apply(Math,eL(Ye(r,function(o){return o.length})));return _(r,function(o){if(o.length<n){var i=Ye(new Array(n-o.length),function(){return vO()});o.splice.apply(o,[o.length,0].concat(eL(i)))}}),r}function kd(t){"@babel/helpers - typeof";return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}var F2e=["row","col"];function tL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function W2e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?tL(Object(r),!0).forEach(function(n){U2e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):tL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function U2e(t,e,r){return e=xY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z2e(t,e){if(t==null)return{};var r=Y2e(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Y2e(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function G2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xY(n.key),n)}}function $2e(t,e,r){return e&&nL(t.prototype,e),r&&nL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function xY(t){var e=K2e(t,"string");return kd(e)==="symbol"?e:String(e)}function K2e(t,e){if(kd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(kd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H0(t,e,r){q2e(t,e),e.set(t,r)}function q2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ir(t,e){var r=AY(t,e,"get");return X2e(t,r)}function X2e(t,e){return e.get?e.get.call(t):e.value}function Xc(t,e,r){var n=AY(t,e,"set");return Z2e(t,n,r),r}function AY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Z2e(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var rL=["label","collapsible"],Qr=new WeakMap,Yi=new WeakMap,D0=new WeakMap,Q2e=function(){function t(){G2e(this,t),H0(this,Qr,{writable:!0,value:[]}),H0(this,Yi,{writable:!0,value:0}),H0(this,D0,{writable:!0,value:1/0})}return $2e(t,[{key:"setColumnsLimit",value:function(e){Xc(this,D0,e)}},{key:"setData",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Xc(this,Qr,V2e(e,ir(this,D0))),Xc(this,Yi,ir(this,Qr).length)}},{key:"getData",value:function(){return ir(this,Qr)}},{key:"mergeWith",value:function(e){var r=this;_(e,function(n){var o=n.row,i=n.col,a=z2e(n,F2e),s=r.getHeaderSettings(o,i);s!==null&&Yt(s,a,rL)})}},{key:"map",value:function(e){_(ir(this,Qr),function(r){_(r,function(n){var o=e(W2e({},n));Ge(o)&&Yt(n,o,rL)})})}},{key:"getHeaderSettings",value:function(e,r){var n;if(e>=ir(this,Yi)||e<0)return null;var o=ir(this,Qr)[e];return r>=o.length?null:(n=o[r])!==null&&n!==void 0?n:null}},{key:"getHeadersSettings",value:function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=[];if(e>=ir(this,Yi)||e<0)return o;for(var i=ir(this,Qr)[e],a=0,s=r;s<i.length;s++){var l=i[s];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=l.colspan,o.push(l),l.colspan>1&&(s+=l.colspan-1),a===n)break;if(a>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}},{key:"getLayersCount",value:function(){return ir(this,Yi)}},{key:"getColumnsCount",value:function(){return ir(this,Yi)>0?ir(this,Qr)[0].length:0}},{key:"clear",value:function(){Xc(this,Qr,[]),Xc(this,Yi,0)}}]),t}();function Rd(t){"@babel/helpers - typeof";return Rd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rd(t)}function oL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function iL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?oL(Object(r),!0).forEach(function(n){Cm(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function J2e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,jY(n.key),n)}}function eze(t,e,r){return e&&aL(t.prototype,e),r&&aL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cm(t,e,r){return e=jY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jY(t){var e=tze(t,"string");return Rd(e)==="symbol"?e:String(e)}function tze(t,e){if(Rd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Rd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nze(t){return aze(t)||ize(t)||oze(t)||rze()}function rze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oze(t,e){if(t){if(typeof t=="string")return wO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wO(t,e)}}function ize(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function aze(t){if(Array.isArray(t))return wO(t)}function wO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var sze="DF-pre-order";function IY(t,e){for(var r=t.call(e,this),n=0;n<this.childs.length;n++){if(r===!1)return!1;r=IY.call(this.childs[n],t,e)}return r}var lze="DF-post-order";function HY(t,e){for(var r=0;r<this.childs.length;r++){var n=HY.call(this.childs[r],t,e);if(n===!1)return!1}return t.call(e,this)}var DY="BF";function uze(t,e){var r=[this];function n(){if(r.length!==0){var o=r.shift();r.push.apply(r,nze(o.childs)),t.call(e,o)!==!1&&n()}}n()}var cze=DY,sL=new Map([[sze,IY],[lze,HY],[DY,uze]]),lL=function(){function t(e){J2e(this,t),Cm(this,"data",{}),Cm(this,"parent",null),Cm(this,"childs",[]),this.data=e}return eze(t,[{key:"addChild",value:function(e){e.parent=this,this.childs.push(e)}},{key:"cloneTree",value:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,r=new t(iL({},e.data)),n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}},{key:"replaceTreeWith",value:function(e){this.data=iL({},e.data),this.childs=[];for(var r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}},{key:"walkDown",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cze;if(!sL.has(r))throw new Error('Traversal strategy "'.concat(r,'" does not exist'));sL.get(r).call(this,e,this)}},{key:"walkUp",value:function(e){var r=this,n=function o(i){var a=e.call(r,i);a!==!1&&i.parent!==null&&o(i.parent)};n(this)}}]),t}();function Ed(t){"@babel/helpers - typeof";return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}function uL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function cL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?uL(Object(r),!0).forEach(function(n){fze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function fze(t,e,r){return e=NY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hze(t,e){return mze(t)||yze(t,e)||pze(t,e)||dze()}function dze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pze(t,e){if(t){if(typeof t=="string")return fL(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fL(t,e)}}function fL(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function yze(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function mze(t){if(Array.isArray(t))return t}function gze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,NY(n.key),n)}}function vze(t,e,r){return e&&hL(t.prototype,e),r&&hL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function NY(t){var e=bze(t,"string");return Ed(e)==="symbol"?e:String(e)}function bze(t,e){if(Ed(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ed(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N0(t,e,r){wze(t,e),e.set(t,r)}function wze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fn(t,e){var r=LY(t,e,"get");return Sze(t,r)}function Sze(t,e){return e.get?e.get.call(t):e.value}function Cze(t,e,r){var n=LY(t,e,"set");return Oze(t,n,r),r}function LY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function Oze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}var Ts=new WeakMap,Gi=new WeakMap,Ps=new WeakMap,kze=function(){function t(e){gze(this,t),N0(this,Ts,{writable:!0,value:new Map}),N0(this,Gi,{writable:!0,value:new Map}),N0(this,Ps,{writable:!0,value:null}),Cze(this,Ps,e)}return vze(t,[{key:"getRoots",value:function(){return Array.from(fn(this,Ts).values())}},{key:"getRootByColumn",value:function(e){var r;return fn(this,Gi).has(e)&&(r=fn(this,Ts).get(fn(this,Gi).get(e))),r}},{key:"getNode",value:function(e,r){var n=this.getRootByColumn(r);if(n){var o=r-fn(this,Gi).get(r),i=0,a;return n.walkDown(function(s){var l=s.data,u=l.origColspan,c=l.headerLevel;if(e===c){if(o>=i&&o<=i+u-1)return a=s,a.data.isRoot=r===a.data.columnIndex,!1;i+=u}}),a}}},{key:"rebuildTreeIndex",value:function(){var e=this,r=0;fn(this,Gi).clear(),_(fn(this,Ts),function(n){for(var o=hze(n,2),i=o[1].data.colspan,a=r;a<r+i;a++)fn(e,Gi).set(a,r);r+=i})}},{key:"buildTree",value:function(){this.clear();for(var e=fn(this,Ps).getColumnsCount(),r=0;r<e;){var n=fn(this,Ps).getHeaderSettings(0,r),o=new lL;fn(this,Ts).set(r,o),this.buildLeaves(o,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}},{key:"buildLeaves",value:function(e,r,n){var o=this,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,a=fn(this,Ps).getHeadersSettings(n,r,i);n+=1,_(a,function(s){var l=cL(cL({},s),{},{headerLevel:n-1,columnIndex:r}),u;n===1?(e.data=l,u=e):(u=new lL(l),e.addChild(u)),n<fn(o,Ps).getLayersCount()&&o.buildLeaves(u,r,n,s.origColspan),r+=s.origColspan})}},{key:"clear",value:function(){fn(this,Ts).clear(),fn(this,Gi).clear()}}]),t}();function BY(t,e){t.walkDown(function(r){var n=r.data,o=r.childs;if(!n.isHidden&&(e(n.columnIndex),o.length===0))for(var i=1;i<n.colspan;i++)e(n.columnIndex+i)})}function Dg(t,e){var r=t.childs;if(r.length!==0)return r[0].data[e]}function Ng(t){return Dg(t,"origColspan")===t.data.origColspan}function ET(t){var e=t.data,r=t.childs;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var n=Ng(t);if(n)return ET(r[0]);e.isCollapsed=!1;var o=r.slice(1),i=new Set,a=0;if(o.length>0)_(o,function(f){f.replaceTreeWith(f.data.clonedTree),f.data.clonedTree=null;var h=f.data;a+=h.colspan,BY(f,function(p){i.add(p)})});else{var s=e.colspan,l=e.origColspan,u=e.columnIndex;a=l-s;for(var c=1;c<l;c++)i.add(u+c)}return t.walkUp(function(f){var h=f.data;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):Ng(f)&&(h.isCollapsed=Dg(f,"isCollapsed"))}),{rollbackModification:function(){return TT(t)},affectedColumns:Array.from(i),colspanCompensation:a}}function TT(t){var e,r=t.data,n=t.childs;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:function(){},affectedColumns:[],colspanCompensation:0};var o=Ng(t);if(o)return TT(n[0]);r.isCollapsed=!0;var i=n.slice(1),a=new Set;if(i.length>0)_(i,function(h){BY(h,function(p){a.add(p)}),h.data.clonedTree=h.cloneTree(),h.walkDown(function(p){var y=p.data;y.isHidden=!0})});else for(var s=r.origColspan,l=r.columnIndex,u=1;u<s;u++){var c=l+u;a.add(c)}var f=r.colspan-((e=Dg(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(function(h){var p=h.data;p.colspan-=f,p.colspan<=1?(p.colspan=1,p.isCollapsed=!0):Ng(h)&&(p.isCollapsed=Dg(h,"isCollapsed"))}),{rollbackModification:function(){return ET(t)},affectedColumns:Array.from(a),colspanCompensation:f}}var dL;function Rze(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Eze(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it(dL||(dL=Rze([`The passed node is not the last node on the tree. Only for 
the last node, the hide column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the hide column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(!r.includes(e)){var n=!1;t.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&t.walkUp(function(o){var i=o.data;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}}var pL;function Tze(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Pze(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(it(pL||(pL=Tze([`The passed node is not the last node on the tree. Only for 
the last node, the show column modification can be applied.`],[`The passed node is not the last node on the tree. Only for\\x20
the last node, the show column modification can be applied.`]))));var r=t.data.crossHiddenColumns;if(r.includes(e)){var n=!1;t.walkUp(function(o){var i=o.data.collapsible;if(i)return n=!0,!1}),!n&&t.walkUp(function(o){var i=o.data;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}}var yL=new Map([["collapse",TT],["expand",ET],["hide-column",Eze],["show-column",Pze]]);function Mze(t,e,r){if(!yL.has(t))throw new Error('The node modifier action ("'.concat(t,'") does not exist.'));return yL.get(t)(e,r)}var _ze=["crossHiddenColumns"];function xze(t,e){if(t==null)return{};var r=Aze(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Aze(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Ay(t){var e=[];return _(t,function(r){r.walkDown(function(n){for(var o=n.data,i=o.origColspan,a=o.columnIndex,s=o.headerLevel,l=o.crossHiddenColumns,u=Ize(e,s),c=!1,f=a;f<a+i;f++){var h=l.includes(f);if(h||c)u.push(_Y());else{var p=jze(o);p.isRoot=!0,u.push(p),c=!0}}})}),e}function jze(t){var e=vO(t);e.crossHiddenColumns;var r=xze(e,_ze);return r}function Ize(t,e){var r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function Td(t){"@babel/helpers - typeof";return Td=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Td(t)}var Hze=["row"];function mL(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function gL(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?mL(Object(r),!0).forEach(function(n){Dze(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):mL(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Dze(t,e,r){return e=VY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nze(t,e){if(t==null)return{};var r=Lze(t,e),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lze(t,e){if(t==null)return{};var r={},n=Object.keys(t),o,i;for(i=0;i<n.length;i++)o=n[i],!(e.indexOf(o)>=0)&&(r[o]=t[o]);return r}function Bze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function vL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,VY(n.key),n)}}function Vze(t,e,r){return e&&vL(t.prototype,e),r&&vL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function VY(t){var e=Fze(t,"string");return Td(e)==="symbol"?e:String(e)}function Fze(t,e){if(Td(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Td(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function L0(t,e,r){Wze(t,e),e.set(t,r)}function Wze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zc(t,e,r){var n=FY(t,e,"set");return Uze(t,n,r),r}function Uze(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function _t(t,e){var r=FY(t,e,"get");return zze(t,r)}function FY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function zze(t,e){return e.get?e.get.call(t):e.value}var Tr=new WeakMap,In=new WeakMap,$i=new WeakMap,Yze=function(){function t(){Bze(this,t),L0(this,Tr,{writable:!0,value:new Q2e}),L0(this,In,{writable:!0,value:new kze(_t(this,Tr))}),L0(this,$i,{writable:!0,value:[[]]})}return Vze(t,[{key:"setState",value:function(e){_t(this,Tr).setData(e);var r=!1;try{_t(this,In).buildTree()}catch{_t(this,In).clear(),_t(this,Tr).clear(),r=!0}return Zc(this,$i,Ay(_t(this,In).getRoots())),r}},{key:"setColumnsLimit",value:function(e){_t(this,Tr).setColumnsLimit(e)}},{key:"mergeStateWith",value:function(e){var r=this,n=Ye(e,function(o){var i=o.row,a=Nze(o,Hze);return gL({row:i<0?r.rowCoordsToLevel(i):i},a)});_t(this,Tr).mergeWith(n),_t(this,In).buildTree(),Zc(this,$i,Ay(_t(this,In).getRoots()))}},{key:"mapState",value:function(e){_t(this,Tr).map(e),_t(this,In).buildTree(),Zc(this,$i,Ay(_t(this,In).getRoots()))}},{key:"mapNodes",value:function(e){return an(_t(this,In).getRoots(),function(r,n){return n.walkDown(function(o){var i=e(o.data);i!==void 0&&r.push(i)}),r},[])}},{key:"triggerNodeModification",value:function(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));var o=_t(this,In).getNode(r,n),i;return o&&(i=Mze(e,o,n),Zc(this,$i,Ay(_t(this,In).getRoots()))),i}},{key:"triggerColumnModification",value:function(e,r){return this.triggerNodeModification(e,-1,r)}},{key:"rowCoordsToLevel",value:function(e){if(e>=0)return null;var r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}},{key:"levelToRowCoords",value:function(e){if(e<0)return null;var r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}},{key:"getHeaderSettings",value:function(e,r){var n,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(o=_t(this,$i)[e])===null||o===void 0?void 0:o[r])!==null&&n!==void 0?n:null}},{key:"getHeaderTreeNodeData",value:function(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;var n=_t(this,In).getNode(e,r);return n?gL({},n.data):null}},{key:"findLeftMostColumnIndex",value:function(e,r){var n,o=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0},i=o.isRoot;if(i)return r;for(var a=r-1;a>=0;){var s,l=(s=this.getHeaderSettings(e,a))!==null&&s!==void 0?s:{isRoot:!0},u=l.isRoot;if(u)break;a-=1}return a}},{key:"getLayersCount",value:function(){return _t(this,Tr).getLayersCount()}},{key:"getColumnsCount",value:function(){return _t(this,Tr).getColumnsCount()}},{key:"clear",value:function(){Zc(this,$i,[]),_t(this,Tr).clear(),_t(this,In).clear()}}]),t}();function Pd(t){"@babel/helpers - typeof";return Pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pd(t)}function Gze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,WY(n.key),n)}}function $ze(t,e,r){return e&&bL(t.prototype,e),r&&bL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qc(t,e,r){return e=WY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WY(t){var e=Kze(t,"string");return Pd(e)==="symbol"?e:String(e)}function Kze(t,e){if(Pd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Pd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qze=function(){function t(e,r){Gze(this,t),Qc(this,"hot",void 0),Qc(this,"nestedHeaderSettingsGetter",void 0),Qc(this,"layersCount",0),Qc(this,"container",void 0),Qc(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}return $ze(t,[{key:"setLayersCount",value:function(e){return this.layersCount=e,this}},{key:"getWidth",value:function(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}},{key:"buildWidthsMap",value:function(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);var e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(var n=0;n<r;n++){var o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),i=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(i,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}},{key:"_buildGhostTable",value:function(e){for(var r=this.hot,n=r.rootDocument,o=r.columnIndexMapper,i=n.createDocumentFragment(),a=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,l=o.getRenderableIndexesLength(),u=0;u<this.layersCount;u++){for(var c=n.createElement("tr"),f=0;f<l;f++){var h=o.getVisualFromRenderableIndex(f);h===null&&(h=f);var p=n.createElement("th"),y=this.nestedHeaderSettingsGetter(u,h);if(y&&(!y.isPlaceholder||y.isHidden)){var g=y.label;s&&(g+='<button class="changeType"></button>'),dc(p,g),p.colSpan=y.colspan,c.appendChild(p)}}a.appendChild(c)}i.appendChild(a),e.appendChild(i)}},{key:"clear",value:function(){this.widthsMap.clear(),this.container=null}}]),t}();const Xze=qze;function $u(t){"@babel/helpers - typeof";return $u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$u(t)}var wL,SL;function CL(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function Zze(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,UY(n.key),n)}}function Qze(t,e,r){return e&&OL(t.prototype,e),r&&OL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ga(){return typeof Reflect<"u"&&Reflect.get?ga=Reflect.get.bind():ga=function(t,e,r){var n=Jze(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ga.apply(this,arguments)}function Jze(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Po(t),t!==null););return t}function eYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&SO(t,e)}function SO(t,e){return SO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},SO(t,e)}function tYe(t){var e=rYe();return function(){var r=Po(t),n;if(e){var o=Po(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nYe(this,n)}}function nYe(t,e){if(e&&($u(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return af(t)}function af(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Po(t){return Po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Po(t)}function kL(t,e,r){return e=UY(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UY(t){var e=oYe(t,"string");return $u(e)==="symbol"?e:String(e)}function oYe(t,e){if($u(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if($u(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RL(t,e,r){iYe(t,e),e.set(t,r)}function iYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jy(t,e,r){var n=zY(t,e,"set");return aYe(t,n,r),r}function aYe(t,e,r){if(e.set)e.set.call(t,r);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=r}}function kt(t,e){var r=zY(t,e,"get");return sYe(t,r)}function zY(t,e,r){if(!e.has(t))throw new TypeError("attempted to "+r+" private field on non-instance");return e.get(t)}function sYe(t,e){return e.get?e.get.call(t):e.value}var EL="nestedHeaders",lYe=280,It=new WeakMap,ei=new WeakMap,uYe=function(t){eYe(r,t);var e=tYe(r);function r(){var n;Zze(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return n=e.call.apply(e,[this].concat(i)),RL(af(n),It,{writable:!0,value:new Yze}),RL(af(n),ei,{writable:!0,value:null}),kL(af(n),"ghostTable",new Xze(n.hot,function(s,l){return n.getHeaderSettings(s,l)})),kL(af(n),"detectedOverlappedHeaders",!1),n}return Qze(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[EL]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings(),i=o.nestedHeaders;(!Array.isArray(i)||!Array.isArray(i[0]))&&lt(it(wL||(wL=CL([`Your Nested Headers plugin configuration is invalid. The settings has to be 
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`],[`Your Nested Headers plugin configuration is invalid. The settings has to be\\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`])))),this.addHook("init",function(){return n.onInit()}),this.addHook("afterLoadData",function(){return n.onAfterLoadData.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("afterOnCellMouseDown",function(){return n.onAfterOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeOnCellMouseOver",function(){return n.onBeforeOnCellMouseOver.apply(n,arguments)}),this.addHook("afterGetColumnHeaderRenderers",function(a){return n.onAfterGetColumnHeaderRenderers(a)}),this.addHook("modifyColWidth",function(){return n.onModifyColWidth.apply(n,arguments)}),this.addHook("modifyColumnHeaderValue",function(){return n.onModifyColumnHeaderValue.apply(n,arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return n.onBeforeHighlightingColumnHeader.apply(n,arguments)}),this.addHook("beforeCopy",function(){return n.onBeforeCopy.apply(n,arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return n.onAfterViewportColumnCalculatorOverride.apply(n,arguments)}),ga(Po(r.prototype),"enablePlugin",this).call(this),this.updatePlugin()}}},{key:"updatePlugin",value:function(){var n=this;if(this.hot.view){var o=this.hot.getSettings(),i=o.nestedHeaders;kt(this,It).setColumnsLimit(this.hot.countCols()),Array.isArray(i)&&(this.detectedOverlappedHeaders=kt(this,It).setState(i)),this.detectedOverlappedHeaders&&lt(it(SL||(SL=CL([`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration 
                        is currently not supported.`],[`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\x20
                        is currently not supported.`])))),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function(a,s){var l=a===!0?"hide-column":"show-column";kt(n,It).triggerColumnModification(l,s)}),!kt(this,ei)&&this.enabled&&jy(this,ei,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(function(a){a.forEach(function(s){var l=s.op,u=s.index,c=s.newValue;if(l==="replace"){var f=c===!0?"hide-column":"show-column";kt(n,It).triggerColumnModification(f,u)}}),n.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),ga(Po(r.prototype),"updatePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){this.clearColspans(),kt(this,It).clear(),kt(this,ei).unsubscribe(),jy(this,ei,null),this.ghostTable.clear(),ga(Po(r.prototype),"disablePlugin",this).call(this)}},{key:"getStateManager",value:function(){return kt(this,It)}},{key:"getLayersCount",value:function(){return kt(this,It).getLayersCount()}},{key:"getHeaderSettings",value:function(n,o){return kt(this,It).getHeaderSettings(n,o)}},{key:"clearColspans",value:function(){if(this.hot.view)for(var n=this.hot.view._wt,o=n.getSetting("columnHeaders").length,i=n.wtTable.THEAD,a=n.wtOverlays.topOverlay.clone.wtTable.THEAD,s=n.wtOverlays.topInlineStartCornerOverlay?n.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,l=0;l<o;l++){var u=i.childNodes[l];if(!u)break;for(var c=a.childNodes[l],f=s?s.childNodes[l]:null,h=0,p=u.childNodes.length;h<p;h++)u.childNodes[h].removeAttribute("colspan"),Ne(u.childNodes[h],"hiddenHeader"),c&&c.childNodes[h]&&(c.childNodes[h].removeAttribute("colspan"),Ne(c.childNodes[h],"hiddenHeader")),s&&f&&f.childNodes[h]&&(f.childNodes[h].removeAttribute("colspan"),Ne(f.childNodes[h],"hiddenHeader"))}}},{key:"headerRendererFactory",value:function(n){var o=this,i=this.hot.view._wt.getSetting("fixedColumnsStart");return function(a,s){var l,u=o.hot,c=u.columnIndexMapper,f=u.view,h=c.getVisualFromRenderableIndex(a);h===null&&(h=a),s.removeAttribute("colspan"),Ne(s,"hiddenHeader");var p=(l=kt(o,It).getHeaderSettings(n,h))!==null&&l!==void 0?l:{label:""},y=p.colspan,g=p.isHidden,v=p.isPlaceholder;if(v||g)te(s,"hiddenHeader");else if(y>1){var S,O,w=f._wt.wtOverlays,x=(S=w.topInlineStartCornerOverlay)===null||S===void 0?void 0:S.clone.wtTable.THEAD.contains(s),T=(O=w.inlineStartOverlay)===null||O===void 0?void 0:O.clone.wtTable.THEAD.contains(s),z=x||T?Math.min(y,i-a):y;z>1&&s.setAttribute("colspan",z)}o.hot.view.appendColHeader(h,s,function(){return o.getColumnHeaderValue.apply(o,arguments)},n)}}},{key:"getColumnHeaderValue",value:function(n,o){var i,a=(i=kt(this,It).getHeaderSettings(o,n))!==null&&i!==void 0?i:{},s=a.isHidden,l=a.isPlaceholder;return l||s?"":this.hot.getColHeader(n,o)}},{key:"onBeforeHighlightingColumnHeader",value:function(n,o,i){var a=kt(this,It).getHeaderTreeNodeData(o,n);if(!a)return n;var s=i.classNames,l=i.columnCursor,u=i.selectionType,c=i.selectionWidth,f=kt(this,It).getHeaderSettings(o,n),h=f.isRoot,p=f.colspan;if(u===dp){if(!h)return a.columnIndex}else u===Av&&(p>c-l||!h)&&(s.length=0);return n}},{key:"onBeforeCopy",value:function(n,o,i){var a=i.columnHeadersCount;if(a!==0)for(var s=0;s<o.length;s++){var l=o[s],u=l.startRow,c=l.startCol,f=l.endRow,h=l.endCol,p=f-u+1,y=c-h+1;if(u>=0||y===1)break;for(var g=c;g<=h;g++)for(var v=u;v<=f;v++){var S,O=p+v,w=g-c;if(w!==0){var x=(S=kt(this,It).getHeaderTreeNodeData(v,g))===null||S===void 0?void 0:S.isRoot;x===!1&&(n[O][w]="")}}}}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i,a){var s=this._getHeaderTreeNodeDataByCoords(o);s&&(a.column=!0)}},{key:"onAfterOnCellMouseDown",value:function(n,o){var i=this._getHeaderTreeNodeDataByCoords(o);if(i){var a=this.hot.selection,s=a.isSelected()?a.getSelectedRange().current():null,l=[],u=i.columnIndex,c=i.origColspan,f=!a.inInSelection(o);n.shiftKey&&s?o.col<s.from.col?l.push(s.getTopEndCorner().col,u,o.row):o.col>s.from.col?l.push(s.getTopStartCorner().col,u+c-1,o.row):l.push(u,u+c-1,o.row):(lR(n)||_a(n)&&f)&&l.push(u,u+c-1,o.row),a.selectColumns.apply(a,l)}}},{key:"onBeforeOnCellMouseOver",value:function(n,o,i,a){var s;if(this.hot.view.isMouseDown()){var l=this._getHeaderTreeNodeDataByCoords(o);if(l){var u=l.columnIndex,c=l.origColspan,f=this.hot.getSelectedRangeLast(),h=f.getTopStartCorner(),p=f.getBottomEndCorner(),y=f.from;a.column=!0,a.cell=!0;var g=[];o.col<y.col?g.push(p.col,u):o.col>y.col?g.push(h.col,u+c-1):g.push(u,u+c-1),(s=this.hot).selectColumns.apply(s,g)}}}},{key:"onAfterGetColumnHeaderRenderers",value:function(n){n.length=0;for(var o=0;o<kt(this,It).getLayersCount();o++)n.push(this.headerRendererFactory(o))}},{key:"onAfterViewportColumnCalculatorOverride",value:function(n){for(var o=kt(this,It).getLayersCount(),i=n.startColumn,a=!!o,s=0;s<o;s++){var l=kt(this,It).findLeftMostColumnIndex(s,n.startColumn),u=this.hot.columnIndexMapper.getRenderableFromVisualIndex(l);if(l>=0&&(a=!1),kn(u)&&u<n.startColumn){i=u;break}}n.startColumn=a?kt(this,It).getHeaderTreeNodeData(0,i).columnIndex:i}},{key:"onModifyColWidth",value:function(n,o){var i=this.ghostTable.getWidth(o);return n>i?n:i}},{key:"onModifyColumnHeaderValue",value:function(n,o,i){var a,s=(a=kt(this,It).getHeaderTreeNodeData(i,o))!==null&&a!==void 0?a:{label:""},l=s.label;return l}},{key:"onInit",value:function(){this.updatePlugin()}},{key:"onAfterLoadData",value:function(n,o){o||this.updatePlugin()}},{key:"destroy",value:function(){jy(this,It,null),kt(this,ei)!==null&&(kt(this,ei).unsubscribe(),jy(this,ei,null)),ga(Po(r.prototype),"destroy",this).call(this)}},{key:"_getHeaderTreeNodeDataByCoords",value:function(n){if(!(n.row>=0||n.col<0))return kt(this,It).getHeaderTreeNodeData(n.row,n.col)}}],[{key:"PLUGIN_KEY",get:function(){return EL}},{key:"PLUGIN_PRIORITY",get:function(){return lYe}}]),r}(at);function TL(t){return dYe(t)||hYe(t)||fYe(t)||cYe()}function cYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fYe(t,e){if(t){if(typeof t=="string")return CO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CO(t,e)}}function hYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dYe(t){if(Array.isArray(t))return CO(t)}function CO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ku(t){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ku(t)}function pYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mYe(n.key),n)}}function yYe(t,e,r){return e&&PL(t.prototype,e),r&&PL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mYe(t){var e=gYe(t,"string");return Ku(e)==="symbol"?e:String(e)}function gYe(t,e){if(Ku(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ku(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vYe=function(){function t(e,r){pYe(this,t),this.hot=r,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}return yYe(t,[{key:"setData",value:function(e){this.data=e}},{key:"getData",value:function(){return this.data}},{key:"getRawSourceData",value:function(){var e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}},{key:"updateWithData",value:function(e){this.setData(e),this.rewriteCache()}},{key:"rewriteCache",value:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Oe(0,this.data.length-1,function(r){e.cacheNode(e.data[r],0,null)})}},{key:"cacheNode",value:function(e,r,n){var o=this;this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&_(e.__children,function(i){o.cacheNode(i,r+1,e)})}},{key:"getDataObject",value:function(e){return e==null?null:this.cache.rows[e]}},{key:"readTreeNodes",value:function(e,r,n,o){var i=this,a=!1,s=r;if(isNaN(s)&&s.end)return s;var l=e;return l||(l={__children:this.data},a=!0,s-=1),n!=null&&s===n?{result:l,end:!0}:o!=null&&l===o?{result:s,end:!0}:(s+=1,l.__children&&_(l.__children,function(u){if(i.parentReference.set(u,a?null:l),s=i.readTreeNodes(u,s,n,o),isNaN(s)&&s.end)return!1}),s)}},{key:"mockParent",value:function(){var e=this.mockNode();return e.__children=this.data,e}},{key:"mockNode",value:function(){var e={};return $e(this.data[0],function(r,n){e[n]=null}),e}},{key:"getRowIndex",value:function(e){return e==null?null:this.cache.nodeInfo.get(e).row}},{key:"getRowIndexWithinParent",value:function(e){var r=null;isNaN(e)?r=e:r=this.getDataObject(e);var n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}},{key:"countAllRows",value:function(){var e={__children:this.data};return this.countChildren(e)}},{key:"countChildren",value:function(e){var r=this,n=0,o=e;return isNaN(o)||(o=this.getDataObject(o)),!o||!o.__children?0:(_(o.__children,function(i){n+=1,i.__children&&(n+=r.countChildren(i))}),n)}},{key:"getRowParent",value:function(e){var r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}},{key:"getRowObjectParent",value:function(e){return!e||Ku(e)!=="object"?null:this.cache.nodeInfo.get(e).parent}},{key:"getRowLevel",value:function(e){var r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}},{key:"getRowObjectLevel",value:function(e){return e==null?null:this.cache.nodeInfo.get(e).level}},{key:"hasChildren",value:function(e){var r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}},{key:"isChild",value:function(e){return this.getRowParent(e)!==null}},{key:"getChild",value:function(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}},{key:"isRowHighestLevel",value:function(e){return!this.isChild(e)}},{key:"isParent",value:function(e){var r,n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}},{key:"addChild",value:function(e,r){var n=r;this.hot.runHooks("beforeAddChild",e,n);var o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);var i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();var a=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,n)}},{key:"addChildAtIndex",value:function(e,r,n){var o=n,i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,r),e){var a=this.getRowIndex(e),s=a+r+1;this.hot.runHooks("beforeCreateRow",s,1),e.__children.splice(r,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(s,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",s,1),i=s}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[r]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,o,r)}},{key:"addSibling",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",n=this.translateTrimmedRow(e),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}},{key:"detachFromParent",value:function(e){var r=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,o=null,i=[];Array.isArray(e)?(Oe(e[0],e[2],function(v){var S=r.translateTrimmedRow(v);i.push(r.getDataObject(S))}),Oe(0,i.length-2,function(v){r.detachFromParent(i[v],!1)}),o=i[i.length-1]):o=e;var a=this.getRowIndex(o),s=this.countChildren(o),l=this.getRowIndexWithinParent(o),u=this.getRowParent(o),c=this.getRowParent(u),f=this.getRowIndex(c),h=null;if(this.hot.runHooks("beforeDetachChild",u,o),l!=null){var p=Array.from(new Array(a+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",a,s+1,p,this.plugin.pluginName),u.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",a,s+1,p,this.plugin.pluginName),c){h=f+this.countChildren(c);var y=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",g+1,s+1,this.plugin.pluginName),c.__children.push(o)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(o)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",u,o,this.getRowIndex(o)),n&&this.hot.render()}},{key:"filterData",value:function(e,r,n){var o=this,i=[];_(n,function(a){i.push(o.getDataObject(a))}),_(i,function(a){var s=o.getRowIndexWithinParent(a),l=o.getRowParent(a);l===null?o.data.splice(s,1):l.__children.splice(s,1)}),this.rewriteCache()}},{key:"spliceData",value:function(e,r,n){var o=this.getDataObject(e-1),i=null,a=e;if(o&&o.__children&&o.__children.length===0?(i=o,a=0):e<this.countAllRows()&&(i=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),i)if(n){var s;(s=i.__children).splice.apply(s,[a,r].concat(TL(n)))}else i.__children.splice(a,r);else if(n){var l;(l=this.data).splice.apply(l,[a,r].concat(TL(n)))}else this.data.splice(a,r);this.rewriteCache()}},{key:"syncRowWithRawSource",value:function(e){var r=e,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}},{key:"moveRow",value:function(e,r,n,o){var i=r===this.hot.countRows(),a=this.getRowParent(e),s=this.getRowIndexWithinParent(e),l=a.__children.slice(s,s+1),u=e>r,c=i?this.getRowParent(r-1):this.getRowParent(r);c==null&&(c=this.getRowParent(r-1)),c==null&&(c=this.getDataObject(r-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(r),c.__children=[]);var f=i||n||o?c.__children.length:this.getRowIndexWithinParent(r),h=a===c;c.__children.splice(f,0,l[0]),a.__children.splice(s+(u&&h?1:0),1),this.syncRowWithRawSource(a),h||this.syncRowWithRawSource(c)}},{key:"translateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{key:"untranslateTrimmedRow",value:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}]),t}();const bYe=vYe;function Md(t){"@babel/helpers - typeof";return Md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Md(t)}function ML(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,SYe(n.key),n)}}function wYe(t,e,r){return e&&ML(t.prototype,e),r&&ML(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function SYe(t){var e=CYe(t,"string");return Md(e)==="symbol"?e:String(e)}function CYe(t,e){if(Md(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Md(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var kYe=wYe(function t(e,r){OYe(this,t),this.hot=r,this.plugin=e});const PT=kYe;function qu(t){"@babel/helpers - typeof";return qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qu(t)}function RYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,TYe(n.key),n)}}function EYe(t,e,r){return e&&_L(t.prototype,e),r&&_L(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function TYe(t){var e=PYe(t,"string");return qu(e)==="symbol"?e:String(e)}function PYe(t,e){if(qu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&OO(t,e)}function OO(t,e){return OO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},OO(t,e)}function _Ye(t){var e=jYe();return function(){var r=Lg(t),n;if(e){var o=Lg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xYe(this,n)}}function xYe(t,e){if(e&&(qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AYe(t)}function AYe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function jYe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Lg(t){return Lg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Lg(t)}var IYe=function(t){MYe(r,t);var e=_Ye(r);function r(n,o){var i;return RYe(this,r),i=e.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsingUI=i.plugin.collapsingUI,i.rowHeaderWidthCache=null,i}return EYe(r,[{key:"appendLevelIndicators",value:function(n,o){var i=this.hot.toPhysicalRow(n),a=this.dataManager.getRowLevel(i),s=this.dataManager.getDataObject(i),l=o.getElementsByTagName("DIV")[0],u=l.querySelector("span.rowHeader"),c=l.querySelectorAll('[class^="ht_nesting"]');if(_(c,function(y){y&&l.removeChild(y)}),te(o,r.CSS_CLASSES.indicatorContainer),a){var f=this.hot.rootDocument,h=u.cloneNode(!0);l.innerHTML="",Oe(0,a-1,function(){var y=f.createElement("SPAN");te(y,r.CSS_CLASSES.emptyIndicator),l.appendChild(y)}),l.appendChild(h)}if(this.dataManager.hasChildren(s)){var p=this.hot.rootDocument.createElement("DIV");te(o,r.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?te(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.expandButton)):te(p,"".concat(r.CSS_CLASSES.button," ").concat(r.CSS_CLASSES.collapseButton)),l.appendChild(p)}}},{key:"updateRowHeaderWidth",value:function(n){var o=n;o||(o=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*o+25),this.hot.render()}}],[{key:"CSS_CLASSES",get:function(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}}]),r}(PT);const YY=IYe;function Xu(t){"@babel/helpers - typeof";return Xu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xu(t)}function xL(t){return LYe(t)||NYe(t)||DYe(t)||HYe()}function HYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function DYe(t,e){if(t){if(typeof t=="string")return kO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return kO(t,e)}}function NYe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LYe(t){if(Array.isArray(t))return kO(t)}function kO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function BYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FYe(n.key),n)}}function VYe(t,e,r){return e&&AL(t.prototype,e),r&&AL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FYe(t){var e=WYe(t,"string");return Xu(e)==="symbol"?e:String(e)}function WYe(t,e){if(Xu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Xu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UYe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&RO(t,e)}function RO(t,e){return RO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},RO(t,e)}function zYe(t){var e=$Ye();return function(){var r=Bg(t),n;if(e){var o=Bg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return YYe(this,n)}}function YYe(t,e){if(e&&(Xu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GYe(t)}function GYe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $Ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bg(t){return Bg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Bg(t)}var KYe=function(t){UYe(r,t);var e=zYe(r);function r(n,o){var i;return BYe(this,r),i=e.call(this,n,o),i.dataManager=i.plugin.dataManager,i.collapsedRows=[],i.collapsedRowsStash={stash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,a)},shiftStash:function(a,s){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),_(i.lastCollapsedRows,function(u,c){u>=a&&u<s&&(i.lastCollapsedRows[c]=u+l)})},applyStash:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,a),i.lastCollapsedRows=void 0},trimStash:function(a,s){Oe(a,a+s-1,function(l){var u=i.lastCollapsedRows.indexOf(l);u>-1&&i.lastCollapsedRows.splice(u,1)})}},i}return VYe(r,[{key:"collapseChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],l=null,u=null,c=null;return isNaN(n)?(l=n,u=this.dataManager.getRowIndex(l)):(l=this.dataManager.getDataObject(n),u=n),this.dataManager.hasChildren(l)&&_(l.__children,function(f){s.push(o.dataManager.getRowIndex(f))}),c=this.collapseRows(s,!0,!1),a&&this.trimRows(c),i&&this.renderAndAdjust(),this.collapsedRows.indexOf(u)===-1&&this.collapsedRows.push(u),c}},{key:"collapseMultipleChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];_(n,function(l){s.push.apply(s,xL(o.collapseChildren(l,!1,!1)))}),a&&this.trimRows(s),i&&this.renderAndAdjust()}},{key:"collapseRow",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([n],o)}},{key:"collapseRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return _(n,function(l){s.push(l),i&&o.collapseChildRows(l,s)}),a&&this.trimRows(s),s}},{key:"collapseChildRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(n)){var s=this.dataManager.getDataObject(n);_(s.__children,function(l){var u=o.dataManager.getRowIndex(l);i.push(u),o.collapseChildRows(u,i)})}a&&this.trimRows(i)}},{key:"expandRow",value:function(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([n],o)}},{key:"expandRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=[];return _(n,function(l){s.push(l),i&&o.expandChildRows(l,s)}),a&&this.untrimRows(s),s}},{key:"expandChildRows",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(n)){var s=this.dataManager.getDataObject(n);_(s.__children,function(l){if(!o.isAnyParentCollapsed(l)){var u=o.dataManager.getRowIndex(l);i.push(u),o.expandChildRows(u,i)}})}a&&this.untrimRows(i)}},{key:"expandChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[],l=null,u=null,c=null;return isNaN(n)?(l=n,u=this.dataManager.getRowIndex(n)):(l=this.dataManager.getDataObject(n),u=n),this.collapsedRows.splice(this.collapsedRows.indexOf(u),1),this.dataManager.hasChildren(l)&&_(l.__children,function(f){var h=o.dataManager.getRowIndex(f);s.push(h)}),c=this.expandRows(s,!0,!1),a&&this.untrimRows(c),i&&this.renderAndAdjust(),c}},{key:"expandMultipleChildren",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=[];_(n,function(l){s.push.apply(s,xL(o.expandChildren(l,!1,!1)))}),a&&this.untrimRows(s),i&&this.renderAndAdjust()}},{key:"collapseAll",value:function(){var n=this,o=this.dataManager.getData(),i=[];_(o,function(a){n.dataManager.hasChildren(a)&&i.push(a)}),this.collapseMultipleChildren(i),this.renderAndAdjust()}},{key:"expandAll",value:function(){var n=this,o=this.dataManager.getData(),i=[];_(o,function(a){n.dataManager.hasChildren(a)&&i.push(a)}),this.expandMultipleChildren(i),this.renderAndAdjust()}},{key:"trimRows",value:function(n){var o=this;this.hot.batchExecution(function(){_(n,function(i){o.plugin.collapsedRowsMap.setValueAtIndex(i,!0)})},!0)}},{key:"untrimRows",value:function(n){var o=this;this.hot.batchExecution(function(){_(n,function(i){o.plugin.collapsedRowsMap.setValueAtIndex(i,!1)})},!0)}},{key:"areChildrenCollapsed",value:function(n){var o=this,i=isNaN(n)?n:this.dataManager.getDataObject(n),a=!0;return i===null&&(i={__children:this.dataManager.data}),this.dataManager.hasChildren(i)&&_(i.__children,function(s){var l=o.dataManager.getRowIndex(s);if(!o.plugin.collapsedRowsMap.getValueAtIndex(l))return a=!1,!1}),a}},{key:"isAnyParentCollapsed",value:function(n){for(var o=n;o!==null;){o=this.dataManager.getRowParent(o);var i=this.dataManager.getRowIndex(o);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}},{key:"toggleState",value:function(n,o){if(!(o.col>=0)){var i=this.translateTrimmedRow(o.row);Ae(n.target,YY.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Lr(n))}}},{key:"translateTrimmedRow",value:function(n){return this.hot.toPhysicalRow(n)}},{key:"untranslateTrimmedRow",value:function(n){return this.hot.toVisualRow(n)}},{key:"renderAndAdjust",value:function(){this.hot.render(),this.hot.view.adjustElementsSize()}}]),r}(PT);const qYe=KYe;function Zu(t){"@babel/helpers - typeof";return Zu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu(t)}function XYe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,QYe(n.key),n)}}function ZYe(t,e,r){return e&&jL(t.prototype,e),r&&jL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function QYe(t){var e=JYe(t,"string");return Zu(e)==="symbol"?e:String(e)}function JYe(t,e){if(Zu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Zu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&EO(t,e)}function EO(t,e){return EO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},EO(t,e)}function tGe(t){var e=rGe();return function(){var r=Vg(t),n;if(e){var o=Vg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nGe(this,n)}}function nGe(t,e){if(e&&(Zu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return GY(t)}function GY(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vg(t){return Vg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vg(t)}var IL=new WeakMap,oGe=function(t){eGe(r,t);var e=tGe(r);function r(n,o){var i;return XYe(this,r),i=e.call(this,n,o),IL.set(GY(i),{row_above:function(a,s){var l=s[s.length-1];i.dataManager.addSibling(l.start.row,"above")},row_below:function(a,s){var l=s[s.length-1];i.dataManager.addSibling(l.start.row,"below")}}),i.dataManager=i.plugin.dataManager,i}return ZYe(r,[{key:"appendOptions",value:function(n){var o=this,i=[{key:"add_child",name:function(){return this.getTranslatedPhrase(pE)},callback:function(){var a=o.dataManager.translateTrimmedRow(o.hot.getSelectedLast()[0]),s=o.dataManager.getDataObject(a);o.dataManager.addChild(s)},disabled:function(){var a=o.hot.getSelectedLast();return!a||a[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return this.getTranslatedPhrase(yE)},callback:function(){o.dataManager.detachFromParent(o.hot.getSelectedLast())},disabled:function(){var a=o.hot.getSelectedLast(),s=o.dataManager.translateTrimmedRow(a[0]),l=o.dataManager.getRowParent(s);return!l||!a||a[0]<0||o.hot.selection.isSelectedByColumnHeader()||o.hot.countRows()>=o.hot.getSettings().maxRows}},{name:"---------"}];return Oe(0,n.items.length-1,function(a){if(a===0)return _(i,function(s,l){n.items.splice(a+l,0,s)}),!1}),this.modifyRowInsertingOptions(n)}},{key:"modifyRowInsertingOptions",value:function(n){var o=IL.get(this);return Oe(0,n.items.length-1,function(i){var a=o[n.items[i].key];a!=null&&(n.items[i].callback=a)}),n}}]),r}(PT);const iGe=oGe;function _d(t){"@babel/helpers - typeof";return _d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_d(t)}var HL;function DL(t){return uGe(t)||lGe(t)||sGe(t)||aGe()}function aGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sGe(t,e){if(t){if(typeof t=="string")return TO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TO(t,e)}}function lGe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uGe(t){if(Array.isArray(t))return TO(t)}function TO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function cGe(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function fGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dGe(n.key),n)}}function hGe(t,e,r){return e&&NL(t.prototype,e),r&&NL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function dGe(t){var e=pGe(t,"string");return _d(e)==="symbol"?e:String(e)}function pGe(t,e){if(_d(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(_d(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yGe=function(){function t(e){fGe(this,t),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}return hGe(t,[{key:"onBeforeRowMove",value:function(e,r,n,o){var i=this,a=this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:o});if(a)return!1;this.movedToCollapsed=!1;var s=n===this.hot.countRows(),l=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n),u=!0,c=e.map(function(g){if(!u)return!1;var v=i.dataManager.translateTrimmedRow(g);return u=i.shouldAllowMoving(v,l),v}),f=c.indexOf(l)===-1;if(!u||!f)return!1;var h=this.getBaseParent(c),p=this.getTargetParent(s,l),y=h===p;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(p),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,l,y),this.moveRows(c,l,p),this.dataManager.rewriteCache(),this.moveCellsMeta(c,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,o,o&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}},{key:"displayAPICompatibilityWarning",value:function(e){var r=e.rows,n=e.finalIndex,o=e.dropIndex,i=e.movePossible,a=!1;return dt(o)&&(lt(it(HL||(HL=cGe([`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows 
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`],[`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`])))),this.hot.runHooks("afterRowMove",r,n,o,i,!1),a=!0),a}},{key:"shouldAllowMoving",value:function(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}},{key:"getBaseParent",value:function(e){return this.dataManager.getRowParent(e[0])}},{key:"getTargetParent",value:function(e,r){var n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}},{key:"shiftCollapsibleParentsLocations",value:function(e,r,n){n||(Math.max.apply(Math,DL(e))<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}},{key:"moveRows",value:function(e,r,n){var o=this,i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(function(){e.forEach(function(a){o.dataManager.moveRow(a,r,o.movedToCollapsed,i)})})}},{key:"moveCellsMeta",value:function(e,r){var n=this,o,i=[],a=Math.max.apply(Math,DL(e))<r;e.forEach(function(s){i.push(n.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),(o=this.hot).spliceCellsMeta.apply(o,[r-(a?i.length:0),0].concat(i))}},{key:"selectCells",value:function(e,r){var n=e.length,o=0,i=0,a=null,s=null;if(this.movedToCollapsed){var l=null;e[n-1]<r?l=this.dataManager.translateTrimmedRow(r-n):l=this.dataManager.translateTrimmedRow(r);var u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);o=this.dataManager.untranslateTrimmedRow(c),i=o}else e[n-1]<r?(i=r-1,o=i-n+1):(o=r,i=o+n-1);a=this.hot.selection,s=this.hot.countCols()-1,a.setRangeStart(this.hot._createCellCoords(o,0)),a.setRangeEnd(this.hot._createCellCoords(i,s),!0)}},{key:"isRowOrderChanged",value:function(e,r){return e.some(function(n,o){return n-o!==r})}}]),t}();function Qu(t){"@babel/helpers - typeof";return Qu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qu(t)}function mGe(t){return wGe(t)||bGe(t)||vGe(t)||gGe()}function gGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vGe(t,e){if(t){if(typeof t=="string")return PO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return PO(t,e)}}function bGe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wGe(t){if(Array.isArray(t))return PO(t)}function PO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function SGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function LL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,OGe(n.key),n)}}function CGe(t,e,r){return e&&LL(t.prototype,e),r&&LL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function OGe(t){var e=kGe(t,"string");return Qu(e)==="symbol"?e:String(e)}function kGe(t,e){if(Qu(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Qu(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function va(){return typeof Reflect<"u"&&Reflect.get?va=Reflect.get.bind():va=function(t,e,r){var n=RGe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},va.apply(this,arguments)}function RGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Mo(t),t!==null););return t}function EGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&MO(t,e)}function MO(t,e){return MO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},MO(t,e)}function TGe(t){var e=MGe();return function(){var r=Mo(t),n;if(e){var o=Mo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return PGe(this,n)}}function PGe(t,e){if(e&&(Qu(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Y(t)}function $Y(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function MGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Mo(t){return Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mo(t)}var B0="nestedRows",_Ge=300,Jr=new WeakMap,xGe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",AGe=function(t){EGe(r,t);var e=TGe(r);function r(n){var o;return SGe(this,r),o=e.call(this,n),o.dataManager=null,o.headersUI=null,o.collapsedRowsMap=null,Jr.set($Y(o),{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1}),o}return CGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[B0]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new hp),this.dataManager=new bYe(this,this.hot),this.collapsingUI=new qYe(this,this.hot),this.headersUI=new YY(this,this.hot),this.contextMenuUI=new iGe(this,this.hot),this.rowMoveController=new yGe(this),this.addHook("afterInit",function(){return n.onAfterInit.apply(n,arguments)}),this.addHook("beforeViewRender",function(){return n.onBeforeViewRender.apply(n,arguments)}),this.addHook("modifyRowData",function(){return n.onModifyRowData.apply(n,arguments)}),this.addHook("modifySourceLength",function(){return n.onModifySourceLength.apply(n,arguments)}),this.addHook("beforeDataSplice",function(){return n.onBeforeDataSplice.apply(n,arguments)}),this.addHook("filterData",function(){return n.onFilterData.apply(n,arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return n.onAfterContextMenuDefaultOptions.apply(n,arguments)}),this.addHook("afterGetRowHeader",function(){return n.onAfterGetRowHeader.apply(n,arguments)}),this.addHook("beforeOnCellMouseDown",function(){return n.onBeforeOnCellMouseDown.apply(n,arguments)}),this.addHook("beforeRemoveRow",function(){return n.onBeforeRemoveRow.apply(n,arguments)}),this.addHook("afterRemoveRow",function(){return n.onAfterRemoveRow.apply(n,arguments)}),this.addHook("beforeAddChild",function(){return n.onBeforeAddChild.apply(n,arguments)}),this.addHook("afterAddChild",function(){return n.onAfterAddChild.apply(n,arguments)}),this.addHook("beforeDetachChild",function(){return n.onBeforeDetachChild.apply(n,arguments)}),this.addHook("afterDetachChild",function(){return n.onAfterDetachChild.apply(n,arguments)}),this.addHook("modifyRowHeaderWidth",function(){return n.onModifyRowHeaderWidth.apply(n,arguments)}),this.addHook("afterCreateRow",function(){return n.onAfterCreateRow.apply(n,arguments)}),this.addHook("beforeRowMove",function(){return n.onBeforeRowMove.apply(n,arguments)}),this.addHook("beforeLoadData",function(o){return n.onBeforeLoadData(o)}),this.addHook("beforeUpdateData",function(o){return n.onBeforeLoadData(o)}),va(Mo(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),va(Mo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin();var n=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(n),va(Mo(r.prototype),"updatePlugin",this).call(this)}},{key:"onBeforeRowMove",value:function(n,o,i,a){return this.rowMoveController.onBeforeRowMove(n,o,i,a)}},{key:"disableCoreAPIModifiers",value:function(){var n=Jr.get(this);n.skipCoreAPIModifiers=!0}},{key:"enableCoreAPIModifiers",value:function(){var n=Jr.get(this);n.skipCoreAPIModifiers=!1}},{key:"onBeforeOnCellMouseDown",value:function(n,o,i){this.collapsingUI.toggleState(n,o,i)}},{key:"onModifyRowData",value:function(n){var o=Jr.get(this);if(!o.skipCoreAPIModifiers)return this.dataManager.getDataObject(n)}},{key:"onModifySourceLength",value:function(){var n=Jr.get(this);if(!n.skipCoreAPIModifiers)return this.dataManager.countAllRows()}},{key:"onBeforeDataSplice",value:function(n,o,i){var a=Jr.get(this);return a.skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(n)?!0:(this.dataManager.spliceData(n,o,i),!1)}},{key:"onFilterData",value:function(n,o,i){var a=Jr.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],o),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*o),this.dataManager.filterData(n,o,i),a.skipRender=!0,this.dataManager.getData().slice()}},{key:"onAfterContextMenuDefaultOptions",value:function(n){return this.contextMenuUI.appendOptions(n)}},{key:"onAfterGetRowHeader",value:function(n,o){this.headersUI.appendLevelIndicators(n,o)}},{key:"onModifyRowHeaderWidth",value:function(n){return this.headersUI.rowHeaderWidthCache||n}},{key:"onAfterRemoveRow",value:function(n,o,i,a){var s=this;if(a!==this.pluginName){var l=Jr.get(this);setTimeout(function(){l.skipRender=null,s.headersUI.updateRowHeaderWidth(),s.collapsingUI.collapsedRowsStash.applyStash()},0)}}},{key:"onBeforeRemoveRow",value:function(n,o,i){var a=this,s=Array.from(i.reduce(function(l,u){if(a.dataManager.isParent(u)){var c=a.dataManager.getDataObject(u).__children;return l.add(u),Array.isArray(c)&&c.forEach(function(f){return l.add(a.dataManager.getRowIndex(f))}),l}return l.add(u)},new Set));i.length=0,i.push.apply(i,s)}},{key:"onBeforeAddChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterAddChild",value:function(n,o){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(o)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onBeforeDetachChild",value:function(){this.collapsingUI.collapsedRowsStash.stash()}},{key:"onAfterDetachChild",value:function(n,o,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}},{key:"onAfterCreateRow",value:function(){this.dataManager.rewriteCache()}},{key:"onAfterInit",value:function(){var n=Math.max.apply(Math,mGe(this.dataManager.cache.levels));n>0&&this.headersUI.updateRowHeaderWidth(n)}},{key:"onBeforeViewRender",value:function(n,o){var i=Jr.get(this);i.skipRender&&(o.skipRender=!0)}},{key:"destroy",value:function(){va(Mo(r.prototype),"destroy",this).call(this)}},{key:"onBeforeLoadData",value:function(n){if(!sme(n)){sR(xGe),this.hot.getSettings()[B0]=!1,this.disablePlugin();return}this.dataManager.setData(n),this.dataManager.rewriteCache()}}],[{key:"PLUGIN_KEY",get:function(){return B0}},{key:"PLUGIN_PRIORITY",get:function(){return _Ge}}]),r}(at);function xd(t){"@babel/helpers - typeof";return xd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xd(t)}function jGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,HGe(n.key),n)}}function IGe(t,e,r){return e&&BL(t.prototype,e),r&&BL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function HGe(t){var e=DGe(t,"string");return xd(e)==="symbol"?e:String(e)}function DGe(t,e){if(xd(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(xd(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NGe=function(){function t(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;jGe(this,t),this.rootWindow=r,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}return IGe(t,[{key:"saveValue",value:function(e,r){this.rootWindow.localStorage.setItem("".concat(this.prefix,"_").concat(e),JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}},{key:"loadValue",value:function(e,r){var n=typeof e>"u"?r:e,o=this.rootWindow.localStorage.getItem("".concat(this.prefix,"_").concat(n));return o===null?void 0:JSON.parse(o)}},{key:"reset",value:function(e){this.rootWindow.localStorage.removeItem("".concat(this.prefix,"_").concat(e))}},{key:"resetAll",value:function(){var e=this;_(this.savedKeys,function(r,n){e.rootWindow.localStorage.removeItem("".concat(e.prefix,"_").concat(e.savedKeys[n]))}),this.clearSavedKeys()}},{key:"loadSavedKeys",value:function(){var e=this.rootWindow.localStorage.getItem("".concat(this.prefix,"__persistentStateKeys")),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}},{key:"saveSavedKeys",value:function(){this.rootWindow.localStorage.setItem("".concat(this.prefix,"__persistentStateKeys"),JSON.stringify(this.savedKeys))}},{key:"clearSavedKeys",value:function(){this.savedKeys.length=0,this.saveSavedKeys()}}]),t}();const LGe=NGe;function Ju(t){"@babel/helpers - typeof";return Ju=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ju(t)}function BGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,FGe(n.key),n)}}function VGe(t,e,r){return e&&VL(t.prototype,e),r&&VL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function FGe(t){var e=WGe(t,"string");return Ju(e)==="symbol"?e:String(e)}function WGe(t,e){if(Ju(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(Ju(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ba(){return typeof Reflect<"u"&&Reflect.get?ba=Reflect.get.bind():ba=function(t,e,r){var n=UGe(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ba.apply(this,arguments)}function UGe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_o(t),t!==null););return t}function zGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_O(t,e)}function _O(t,e){return _O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},_O(t,e)}function YGe(t){var e=KGe();return function(){var r=_o(t),n;if(e){var o=_o(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return GGe(this,n)}}function GGe(t,e){if(e&&(Ju(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $Ge(t)}function $Ge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function KGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _o(t){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_o(t)}ye.getSingleton().register("persistentStateSave");ye.getSingleton().register("persistentStateLoad");ye.getSingleton().register("persistentStateReset");var FL="persistentState",qGe=0,XGe=function(t){zGe(r,t);var e=YGe(r);function r(n){var o;return BGe(this,r),o=e.call(this,n),o.storage=void 0,o}return VGe(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[FL]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.storage||(this.storage=new LGe(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",function(o,i){return n.saveValue(o,i)}),this.addHook("persistentStateLoad",function(o,i){return n.loadValue(o,i)}),this.addHook("persistentStateReset",function(){return n.resetValue()}),ba(_o(r.prototype),"enablePlugin",this).call(this))}},{key:"disablePlugin",value:function(){this.storage=void 0,ba(_o(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),ba(_o(r.prototype),"updatePlugin",this).call(this)}},{key:"loadValue",value:function(n,o){o.value=this.storage.loadValue(n)}},{key:"saveValue",value:function(n,o){this.storage.saveValue(n,o)}},{key:"resetValue",value:function(n){typeof n>"u"?this.storage.resetAll():this.storage.reset(n)}},{key:"destroy",value:function(){ba(_o(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return FL}},{key:"PLUGIN_PRIORITY",get:function(){return qGe}}]),r}(at);function ec(t){"@babel/helpers - typeof";return ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec(t)}function ZGe(t){return t3e(t)||e3e(t)||JGe(t)||QGe()}function QGe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JGe(t,e){if(t){if(typeof t=="string")return xO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xO(t,e)}}function e3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function t3e(t){if(Array.isArray(t))return xO(t)}function xO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function n3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function WL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o3e(n.key),n)}}function r3e(t,e,r){return e&&WL(t.prototype,e),r&&WL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o3e(t){var e=i3e(t,"string");return ec(e)==="symbol"?e:String(e)}function i3e(t,e){if(ec(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(ec(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wa(){return typeof Reflect<"u"&&Reflect.get?wa=Reflect.get.bind():wa=function(t,e,r){var n=a3e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},wa.apply(this,arguments)}function a3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=xo(t),t!==null););return t}function s3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AO(t,e)}function AO(t,e){return AO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},AO(t,e)}function l3e(t){var e=f3e();return function(){var r=xo(t),n;if(e){var o=xo(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u3e(this,n)}}function u3e(t,e){if(e&&(ec(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c3e(t)}function c3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xo(t){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xo(t)}var V0="search",h3e=190,d3e="htSearchResult",p3e=function(t,e,r,n,o){t.getCellMeta(e,r).isSearchResult=o},y3e=function(t,e,r){return dt(t)||t===null||!t.toLocaleLowerCase||t.length===0||dt(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1},m3e=function(t){s3e(r,t);var e=l3e(r);function r(n){var o;return n3e(this,r),o=e.call(this,n),o.callback=p3e,o.queryMethod=y3e,o.searchResultClass=d3e,o}return r3e(r,[{key:"isEnabled",value:function(){return this.hot.getSettings()[V0]}},{key:"enablePlugin",value:function(){var n=this;if(!this.enabled){var o=this.hot.getSettings()[V0];this.updatePluginSettings(o),this.addHook("beforeRenderer",function(){return n.onBeforeRenderer.apply(n,arguments)}),wa(xo(r.prototype),"enablePlugin",this).call(this)}}},{key:"disablePlugin",value:function(){var n=this,o=function(){return n.onBeforeRenderer.apply(n,arguments)};this.hot.addHook("beforeRenderer",o),this.hot.addHookOnce("afterViewRender",function(){n.hot.removeHook("beforeRenderer",o)}),wa(xo(r.prototype),"disablePlugin",this).call(this)}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),wa(xo(r.prototype),"updatePlugin",this).call(this)}},{key:"query",value:function(n){var o=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),s=this.hot.countRows(),l=this.hot.countCols(),u=[],c=this.hot;return Oe(0,s-1,function(f){Oe(0,l-1,function(h){var p=o.hot.getDataAtCell(f,h),y=o.hot.getCellMeta(f,h),g=y.search.callback||i,v=y.search.queryMethod||a,S=v(n,p,y);if(S){var O={row:f,col:h,data:p};u.push(O)}g&&g(c,f,h,p,S)})}),u}},{key:"getCallback",value:function(){return this.callback}},{key:"setCallback",value:function(n){this.callback=n}},{key:"getQueryMethod",value:function(){return this.queryMethod}},{key:"setQueryMethod",value:function(n){this.queryMethod=n}},{key:"getSearchResultClass",value:function(){return this.searchResultClass}},{key:"setSearchResultClass",value:function(n){this.searchResultClass=n}},{key:"updatePluginSettings",value:function(n){Ge(n)&&(n.searchResultClass&&this.setSearchResultClass(n.searchResultClass),n.queryMethod&&this.setQueryMethod(n.queryMethod),n.callback&&this.setCallback(n.callback))}},{key:"onBeforeRenderer",value:function(n,o,i,a,s,l){var u=l.className||[],c=[];if(typeof u=="string")c=u.split(" ");else{var f;(f=c).push.apply(f,ZGe(u))}this.isEnabled()&&l.isSearchResult?c.includes(this.searchResultClass)||c.push("".concat(this.searchResultClass)):c.includes(this.searchResultClass)&&c.splice(c.indexOf(this.searchResultClass),1),l.className=c.join(" ")}},{key:"destroy",value:function(){wa(xo(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return V0}},{key:"PLUGIN_PRIORITY",get:function(){return h3e}}]),r}(at);function tc(t){"@babel/helpers - typeof";return tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tc(t)}function g3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b3e(n.key),n)}}function v3e(t,e,r){return e&&UL(t.prototype,e),r&&UL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function b3e(t){var e=w3e(t,"string");return tc(e)==="symbol"?e:String(e)}function w3e(t,e){if(tc(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(tc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qs(){return typeof Reflect<"u"&&Reflect.get?Qs=Reflect.get.bind():Qs=function(t,e,r){var n=S3e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Qs.apply(this,arguments)}function S3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Si(t),t!==null););return t}function C3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jO(t,e)}function jO(t,e){return jO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},jO(t,e)}function O3e(t){var e=E3e();return function(){var r=Si(t),n;if(e){var o=Si(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return k3e(this,n)}}function k3e(t,e){if(e&&(tc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return R3e(t)}function R3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Si(t){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Si(t)}var T3e="touchScroll",P3e=200,M3e=function(t){C3e(r,t);var e=O3e(r);function r(n){var o;return g3e(this,r),o=e.call(this,n),o.scrollbars=[],o.clones=[],o.lockedCollection=!1,o.freezeOverlays=!1,o}return v3e(r,[{key:"isEnabled",value:function(){return sF()}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.addHook("afterViewRender",function(){return n.onAfterViewRender()}),this.registerEvents(),Qs(Si(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,Qs(Si(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){Qs(Si(r.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var n=this;this.addHook("beforeTouchScroll",function(){return n.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return n.onAfterMomentumScroll()})}},{key:"onAfterViewRender",value:function(){if(!this.lockedCollection){var n=this.hot.view._wt.wtOverlays,o=n.topOverlay,i=n.bottomOverlay,a=n.inlineStartOverlay,s=n.topInlineStartCornerOverlay,l=n.bottomInlineStartCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(o),i.clone&&this.scrollbars.push(i),this.scrollbars.push(a),s&&this.scrollbars.push(s),l&&l.clone&&this.scrollbars.push(l),this.clones=[],o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s&&this.clones.push(s.clone.wtTable.holder.parentNode),l&&l.clone&&this.clones.push(l.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,_(this.clones,function(n){te(n,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var n=this;this.freezeOverlays=!1,_(this.clones,function(o){Ne(o,"hide-tween"),te(o,"show-tween")}),this.hot._registerTimeout(function(){_(n.clones,function(o){Ne(o,"show-tween")})},400),_(this.scrollbars,function(o){o.refresh(),o.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}],[{key:"PLUGIN_KEY",get:function(){return T3e}},{key:"PLUGIN_PRIORITY",get:function(){return P3e}},{key:"SETTING_KEYS",get:function(){return!0}}]),r}(at);function nc(t){"@babel/helpers - typeof";return nc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nc(t)}function _3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A3e(n.key),n)}}function x3e(t,e,r){return e&&zL(t.prototype,e),r&&zL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function A3e(t){var e=j3e(t,"string");return nc(e)==="symbol"?e:String(e)}function j3e(t,e){if(nc(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(nc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sa(){return typeof Reflect<"u"&&Reflect.get?Sa=Reflect.get.bind():Sa=function(t,e,r){var n=I3e(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Sa.apply(this,arguments)}function I3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Ao(t),t!==null););return t}function H3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IO(t,e)}function IO(t,e){return IO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},IO(t,e)}function D3e(t){var e=B3e();return function(){var r=Ao(t),n;if(e){var o=Ao(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N3e(this,n)}}function N3e(t,e){if(e&&(nc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return L3e(t)}function L3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ao(t){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ao(t)}var Iy="trimRows",V3e=330,F3e=function(t){H3e(r,t);var e=D3e(r);function r(n){var o;return _3e(this,r),o=e.call(this,n),o.trimmedRowsMap=null,o}return x3e(r,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[Iy]}},{key:"enablePlugin",value:function(){var n=this;this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new hp),this.trimmedRowsMap.addLocalHook("init",function(){return n.onMapInit()}),Sa(Ao(r.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){var n=this,o=this.hot.getSettings()[Iy];Array.isArray(o)&&this.hot.batchExecution(function(){n.trimmedRowsMap.clear(),_(o,function(i){n.trimmedRowsMap.setValueAtIndex(i,!0)})},!0),Sa(Ao(r.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.hot.rowIndexMapper.unregisterMap("trimRows"),Sa(Ao(r.prototype),"disablePlugin",this).call(this)}},{key:"getTrimmedRows",value:function(){return this.trimmedRowsMap.getTrimmedIndexes()}},{key:"trimRows",value:function(n){var o=this,i=this.getTrimmedRows(),a=this.isValidConfig(n),s=i;a&&(s=Array.from(new Set(i.concat(n))));var l=this.hot.runHooks("beforeTrimRow",i,s,a);l!==!1&&(a&&this.hot.batchExecution(function(){_(n,function(u){o.trimmedRowsMap.setValueAtIndex(u,!0)})},!0),this.hot.runHooks("afterTrimRow",i,s,a,a&&s.length>i.length))}},{key:"trimRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.trimRows(o)}},{key:"untrimRows",value:function(n){var o=this.getTrimmedRows(),i=this.isValidConfig(n),a=o,s=this.trimmedRowsMap.getValues().slice(),l=n.length>0;i&&l&&(_(n,function(c){s[c]=!1}),a=an(s,function(c,f,h){return f&&c.push(h),c},[]));var u=this.hot.runHooks("beforeUntrimRow",o,a,i&&l);u!==!1&&(i&&l&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",o,a,i&&l,i&&a.length<o.length))}},{key:"untrimRow",value:function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];this.untrimRows(o)}},{key:"isTrimmed",value:function(n){return this.trimmedRowsMap.getValueAtIndex(n)||!1}},{key:"untrimAll",value:function(){this.untrimRows(this.getTrimmedRows())}},{key:"isValidConfig",value:function(n){var o=this.hot.countSourceRows();return n.every(function(i){return Number.isInteger(i)&&i>=0&&i<o})}},{key:"onMapInit",value:function(){var n=this,o=this.hot.getSettings()[Iy];Array.isArray(o)&&this.hot.batchExecution(function(){_(o,function(i){n.trimmedRowsMap.setValueAtIndex(i,!0)})},!0)}},{key:"destroy",value:function(){Sa(Ao(r.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return Iy}},{key:"PLUGIN_PRIORITY",get:function(){return V3e}}]),r}(at);function rc(t){"@babel/helpers - typeof";return rc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rc(t)}function KY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YL(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,W3e(n.key),n)}}function qY(t,e,r){return e&&YL(t.prototype,e),r&&YL(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function W3e(t){var e=U3e(t,"string");return rc(e)==="symbol"?e:String(e)}function U3e(t,e){if(rc(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(rc(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XY(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HO(t,e)}function HO(t,e){return HO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},HO(t,e)}function ZY(t){var e=G3e();return function(){var r=Fg(t),n;if(e){var o=Fg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return z3e(this,n)}}function z3e(t,e){if(e&&(rc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Y3e(t)}function Y3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function G3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Fg(t){return Fg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fg(t)}function $3e(t){return X3e(t)||q3e(t)||JY(t)||K3e()}function K3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q3e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function X3e(t){if(Array.isArray(t))return DO(t)}function QY(t,e){return J3e(t)||Q3e(t,e)||JY(t,e)||Z3e()}function Z3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JY(t,e){if(t){if(typeof t=="string")return DO(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return DO(t,e)}}function DO(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Q3e(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,o=c}finally{try{if(!l&&r.return!=null&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}function J3e(t){if(Array.isArray(t))return t}var eG="undoRedo",e$e="undoRedo";function he(t){var e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,n){var o=this,i=r&&r.length;if(i){var a=r.find(function(l){var u=QY(l,4),c=u[2],f=u[3];return c!==f});if(a){var s=function(){var l=r.reduce(function(c,f){return c.push($3e(f)),c},[]);_(l,function(c){c[1]=t.propToCol(c[1])});var u=i>1?o.getSelected():[[l[0][0],l[0][1]]];return new he.ChangeAction(l,u)};e.done(s,n)}}}),t.addHook("afterCreateRow",function(r,n,o){e.done(function(){return new he.CreateRowAction(r,n)},o)}),t.addHook("beforeRemoveRow",function(r,n,o,i){var a=function(){var s=t.toPhysicalRow(r),l=yn(e.instance.getSourceData(s,0,s+n-1,e.instance.countSourceCols()-1));return new he.RemoveRowAction(s,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(a,i)}),t.addHook("afterCreateCol",function(r,n,o){e.done(function(){return new he.CreateColumnAction(r,n)},o)}),t.addHook("beforeRemoveCol",function(r,n,o,i){var a=function(){var s=e.instance.getSourceDataArray(),l=(e.instance.countCols()+r)%e.instance.countCols(),u=[],c=[],f=[];Oe(s.length-1,function(y){var g=[],v=s[y];Oe(l,l+(n-1),function(S){g.push(v[t.toPhysicalColumn(S)])}),u.push(g)}),Oe(n-1,function(y){f.push(t.toPhysicalColumn(l+y))}),Array.isArray(t.getSettings().colHeaders)&&Oe(n-1,function(y){c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+y)]||null)});var h=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new he.RemoveColumnAction(l,f,u,c,h,p,t.getSettings().fixedColumnsStart)};e.done(a,i)}),t.addHook("beforeCellAlignment",function(r,n,o,i){e.done(function(){return new he.CellAlignmentAction(r,n,o,i)})}),t.addHook("beforeFilter",function(r){e.done(function(){return new he.FiltersAction(r)})}),t.addHook("beforeRowMove",function(r,n){r!==!1&&e.done(function(){return new he.RowMoveAction(r,n)})}),t.addHook("beforeMergeCells",function(r,n){n||e.done(function(){return new he.MergeCellsAction(t,r)})}),t.addHook("afterUnmergeCells",function(r,n){n||e.done(function(){return new he.UnmergeCellsAction(t,r)})}),t.addHook("afterInit",function(){e.init()})}he.prototype.done=function(t,e){if(!this.ignoreNewActions){var r=e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto";if(!r){var n=this.doneActions.slice(),o=this.instance.runHooks("beforeUndoStackChange",n,e);if(o!==!1){var i=t(),a=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}}}};he.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);var e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());var r=yn(e),n=this.instance.runHooks("beforeUndo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};he.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);var e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());var r=yn(e),n=this.instance.runHooks("beforeRedo",r);if(n===!1)return;this.ignoreNewActions=!0;var o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};he.prototype.isUndoAvailable=function(){return this.doneActions.length>0};he.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};he.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};he.prototype.isEnabled=function(){return this.enabled};he.prototype.enable=function(){if(!this.isEnabled()){var t=this.instance;this.enabled=!0,r$e(t),this.registerShortcuts(),t.addHook("afterChange",tG)}};he.prototype.disable=function(){if(this.isEnabled()){var t=this.instance;this.enabled=!1,o$e(t),this.unregisterShortcuts(),t.removeHook("afterChange",tG)}};he.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};he.Action=function(){};he.Action.prototype.undo=function(){};he.Action.prototype.redo=function(){};he.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ei(he.ChangeAction,he.Action);he.ChangeAction.prototype.undo=function(t,e){for(var r=yn(this.changes),n=t.countEmptyRows(!0),o=t.countEmptyCols(!0),i=0,a=r.length;i<a;i++)r[i].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(var s=0,l=r.length;s<l;s++){var u=QY(r[s],2),c=u[0],f=u[1];t.getSettings().minSpareRows&&c+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(c+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&f+1+t.getSettings().minSpareCols===t.countCols()&&o===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(f+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};he.ChangeAction.prototype.redo=function(t,e){for(var r=yn(this.changes),n=0,o=r.length;n<o;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};he.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ei(he.CreateRowAction,he.Action);he.CreateRowAction.prototype.undo=function(t,e){var r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};he.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};he.RemoveRowAction=function(t,e,r,n,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o};Ei(he.RemoveRowAction,he.Action);he.RemoveRowAction.prototype.undo=function(t,e){var r=this,n=t.getSettings(),o=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach(function(i,a){Object.keys(i).forEach(function(s){var l=parseInt(s,10);o.push([r.index+a,isNaN(l)?s:l,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(o,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};he.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};he.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ei(he.CreateColumnAction,he.Action);he.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};he.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};he.RemoveColumnAction=function(t,e,r,n,o,i,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a};Ei(he.RemoveColumnAction,he.Action);he.RemoveColumnAction.prototype.undo=function(t,e){var r=this,n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;for(var o=this.indexes.slice(0).sort(),i=function(f,h,p){return p[r.indexes.indexOf(o[h])]},a=this.data.length,s=[],l=0;l<a;l++)s.push(Ye(this.data[l],i));var u=Ye(this.headers,i),c=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),_(t.getSourceDataArray(),function(f,h){_(o,function(p,y){f[p]=s[h][y],c.push([h,p,f[p]])})}),t.setSourceDataAtCell(c,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&_(u,function(f,h){t.getSettings().colHeaders[o[h]]=f}),t.batchExecution(function(){t.rowIndexMapper.setIndexesSequence(r.rowPositions),t.columnIndexMapper.setIndexesSequence(r.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};he.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};he.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};he.CellAlignmentAction.prototype.undo=function(t,e){var r=this;_(this.range,function(n){n.forAll(function(o,i){o>=0&&i>=0&&t.setCellMeta(o,i,"className",r.stateBefore[o][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};he.CellAlignmentAction.prototype.redo=function(t,e){ti(this.range,this.type,this.alignment,function(r,n){return t.getCellMeta(r,n)},function(r,n,o,i){return t.setCellMeta(r,n,o,i)}),t.addHookOnce("afterViewRender",e),t.render()};he.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Ei(he.FiltersAction,he.Action);he.FiltersAction.prototype.undo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()};he.FiltersAction.prototype.redo=function(t,e){var r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};var t$e=function(t){XY(r,t);var e=ZY(r);function r(n,o){var i;KY(this,r),i=e.call(this),i.cellRange=o;var a=i.cellRange.getTopStartCorner(),s=i.cellRange.getBottomEndCorner();return i.rangeData=n.getData(a.row,a.col,s.row,s.col),i}return qY(r,[{key:"undo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.unmergeRange(this.cellRange,!0);var a=this.cellRange.getTopStartCorner();n.populateFromArray(a.row,a.col,this.rangeData,void 0,void 0,"MergeCells")}},{key:"redo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.mergeRange(this.cellRange)}}]),r}(he.Action);he.MergeCellsAction=t$e;var n$e=function(t){XY(r,t);var e=ZY(r);function r(n,o){var i;return KY(this,r),i=e.call(this),i.cellRange=o,i}return qY(r,[{key:"undo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.mergeRange(this.cellRange,!0)}},{key:"redo",value:function(n,o){var i=n.getPlugin("mergeCells");n.addHookOnce("afterViewRender",o),i.unmergeRange(this.cellRange,!0),n.render()}}]),r}(he.Action);he.UnmergeCellsAction=n$e;he.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Ei(he.RowMoveAction,he.Action);he.RowMoveAction.prototype.undo=function(t,e){var r=this,n=t.getPlugin("manualRowMove"),o=[].concat(this.rows),i=o.filter(function(c){return c>r.finalIndex}),a=o.filter(function(c){return c<=r.finalIndex}),s=i.sort(function(c,f){return f-c}).concat(a.sort(function(c,f){return c-f}));t.addHookOnce("afterViewRender",e);for(var l=0;l<s.length;l+=1){var u=t.toVisualRow(s[l]);n.moveRow(u,s[l])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};he.RowMoveAction.prototype.redo=function(t,e){var r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};he.prototype.init=function(){var t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};he.prototype.registerShortcuts=function(){var t=this,e=this.instance.getShortcutManager(),r=e.getContext("grid"),n=function(i){return!i.altKey},o={runOnlyIf:n,group:eG};r.addShortcuts([{keys:[["Control/Meta","z"]],callback:function(){t.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:function(){t.redo()}}],o)};he.prototype.unregisterShortcuts=function(){var t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(eG)};function tG(t,e){var r=this;if(e==="loadData")return r.undoRedo.clear()}function r$e(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function o$e(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var Sp=ye.getSingleton();Sp.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Sp.register("beforeUndo");Sp.register("afterUndo");Sp.register("beforeRedo");Sp.register("afterRedo");he.PLUGIN_KEY=e$e;he.SETTING_KEYS=!0;function i$e(){Je(qRe),Je(wEe),Je(LEe),Je(xTe),Je(XTe),Je(fz),Je(CMe),Je(t_e),Je(Rz),Je(nAe),Je(MAe),Je(VAe),Je(Nz),Je(zje),Je(VLe),Je(VBe),Je(fVe),Je(DVe),Je(iFe),Je($Fe),Je(oWe),Je(GWe),Je(rUe),Je(t2e),Je(C2e),Je(H2e),Je(uYe),Je(AGe),Je(XGe),Je(m3e),Je(M3e),Je(F3e),Je(he)}function a$e(){lke(),Oke(),Bke(),nRe(),i$e()}a$e();const u$e=Ft.memo(function(t){let{name:e,id:r,SVs:n,actions:o,callAction:i}=aG(t),a=s=>{i({action:o.recordVisibilityChange,args:{isVisible:s}})};return sG.useEffect(()=>()=>{i({action:o.recordVisibilityChange,args:{isVisible:!1}})},[]),n.hidden?null:kp.jsx(lG,{partialVisibility:!0,onChange:a,children:kp.jsxs("div",{id:r,style:{margin:"12px 0"},children:[kp.jsx("a",{name:r}),kp.jsx(j2,{licenseKey:"non-commercial-and-evaluation",data:n.cells.map(s=>[...s]),colHeaders:n.columnHeaders,rowHeaders:n.rowHeaders,width:NT(n.width),height:NT(n.height),afterChange:(s,l)=>i({action:o.onChange,args:{changes:s,source:l}}),formulas:{engine:uG},fixedRowsTop:n.fixedRowsTop,fixedColumnsLeft:n.fixedColumnsLeft,hiddenColumns:{columns:n.hiddenColumns.map(s=>s-1),indicators:!1},hiddenRows:{rows:n.hiddenRows.map(s=>s-1),indicators:!1},readOnly:n.disabled,disableVisualSelection:n.disabled,stretchH:"all"})]})})});export{u$e as default};
