import{M as J,u as j,r as m,v as X,j as g}from"./index-2b5c64d9.js";import{BoardContext as G}from"./graph-6d43a295-5c8ba528.js";import"./css-ab4d83ca-d016d639.js";const T=J.memo(function(u){let{name:Y,id:_,SVs:n}=j(u);const a=m.useContext(G);let p=m.useRef([]),d=m.useRef([]),E=m.useRef(null),U=m.useRef(null),b=m.useRef(null);m.useEffect(()=>()=>{v()},[]);function D(){let{xmin:f,xmax:C,ymin:O,ymax:S}=n.graphLimits,i=(S-O)*.06,s=(C-f)*.05,x=(C-f)*.02,t=f+(C-f)*.05,R;n.position.slice(0,5)==="upper"?R=O+(S-O)*.95:R=O+(S-O)*.05+i*n.legendElements.length;let y=n.position.slice(n.position.length-5,n.position.length)==="right";p.current=[],d.current=[];let c=0,B=!1;for(let[l,e]of n.legendElements.entries())if(e.label){let r=R-l*i,o={fixed:!0,highlight:!1};e.label.hasLatex&&(o.useMathJax=!0,o.parse=!1,B=!0);let h=a.create("text",[t+s+x,r,e.label.value],o);d.current.push(h),c=Math.max(c,h.rendNode.offsetWidth)}c/=a.unitX,y&&(t=Math.max(t,C-s-3*x-c));for(let[l,e]of n.legendElements.entries()){let r=R-l*i;if(e.swatchType==="marker"){let o={fillColor:e.markerColor,fillOpacity:e.lineOpacity,strokeColor:"none",size:e.markerSize,face:M(e.markerStyle),fixed:!0,highlight:!1,withLabel:!1,showInfoBox:!1},h=a.create("point",[t+s/2,r],o);p.current.push(h)}else if(e.swatchType==="rectangle"){let o={fillColor:e.filled?e.fillColor:"none",fillOpacity:e.fillOpacity,fixed:!0,highlight:!1,vertices:{visible:!1},borders:{strokeColor:e.lineColor,strokeWidth:e.lineWidth,strokeOpacity:e.lineOpacity,dash:k(e.lineStyle),fixed:!0,highlight:!1}},h=a.create("polygon",[[t,r+i/4],[t+s,r+i/4],[t+s,r-i/4],[t,r-i/4]],o);p.current.push(h)}else{let o={strokeColor:e.lineColor,strokeWidth:e.lineWidth,strokeOpacity:e.lineOpacity,dash:k(e.lineStyle),fixed:!0,highlight:!1},h=a.create("segment",[[t,r],[t+s,r]],o);p.current.push(h)}y&&e.label&&d.current[l].coords.setCoordinates(JXG.COORDS_BY_USER,[t+s+x,r])}y&&B&&MathJax.Hub.Queue(()=>{c=0;for(let l of d.current)c=Math.max(c,l.rendNode.offsetWidth);c/=a.unitX,t=Math.max(t,C-s-3*x-c);for(let[l,e]of p.current.entries()){let r=R-l*i;if(e.elType==="point")e.coords.setCoordinates(JXG.COORDS_BY_USER,[t+s/2,r]),e.needsUpdate=!0,e.update();else if(e.elType==="polygon"){e.vertices[0].coords.setCoordinates(JXG.COORDS_BY_USER,[t,r+i/4]),e.vertices[1].coords.setCoordinates(JXG.COORDS_BY_USER,[t+s,r+i/4]),e.vertices[2].coords.setCoordinates(JXG.COORDS_BY_USER,[t+s,r-i/4]),e.vertices[3].coords.setCoordinates(JXG.COORDS_BY_USER,[t,r-i/4]);for(let o=0;o<4;o++)e.vertices[o].needsUpdate=!0,e.vertices[o].update(),e.borders[o].needsUpdate=!0,e.borders[o].update();e.needsUpdate=!0,e.update()}else e.point1.coords.setCoordinates(JXG.COORDS_BY_USER,[t,r]),e.point2.coords.setCoordinates(JXG.COORDS_BY_USER,[t+s,r]),e.needsUpdate=!0,e.update();d.current[l]&&(d.current[l].coords.setCoordinates(JXG.COORDS_BY_USER,[t+s+x,r]),d.current[l].needsUpdate=!0,d.current[l].update())}a.updateRenderer()})}function v(){for(let f of p.current)a.removeObject(f);for(let f of d.current)a.removeObject(f);p.current=[],d.current=[]}return a?((!X(E.current,n.legendElements)||!X(b.current,n.graphLimits)||U.current!==n.position)&&(p.current.length>0&&v(),D()),E.current=[...n.legendElements],b.current=Object.assign({},n.graphLimits),U.current=n.position,g.jsx(g.Fragment,{children:g.jsx("a",{name:_})})):n.hidden?null:g.jsx(g.Fragment,{children:g.jsx("a",{name:_})})});function k(u){return u==="dashed"?2:u==="solid"?0:u==="dotted"?1:0}function M(u){return u==="triangle"?"triangleup":u}export{T as default};
