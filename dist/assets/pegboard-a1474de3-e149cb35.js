import{M as Q,u as W,r as B,C as f}from"./index-2b5c64d9.js";import{BoardContext as Z,BASE_LAYER_OFFSET as E}from"./graph-6d43a295-5c8ba528.js";import"./css-ab4d83ca-d016d639.js";const ne=Q.memo(function J(L){var A;let{name:$,id:q,SVs:u,actions:H,sourceOfUpdate:I,callAction:K}=W(L);J.ignoreActionsWithoutCore=()=>!0;const c=B.useContext(Z);let s=B.useRef(null),O=B.useRef(null),h=B.useRef(null),x=B.useRef(null),p=B.useRef(null),b=B.useRef(null);h.current=u.dx,x.current=u.dy,p.current=u.xoffset,b.current=u.yoffset;let v=B.useRef({visible:!u.hidden,fixed:!0,withlabel:!1,layer:10*u.layer+E,fillColor:"darkgray",strokeColor:"darkgray",size:.1,face:"circle",highlight:!1,showinfobox:!1});v.current.visible=!u.hidden,v.current.layer=10*u.layer+E,B.useEffect(()=>()=>{w()},[]);function S(){let[i,M,y,C]=c.getBoundingBox(),R=(i-p.current)/h.current,g=(y-p.current)/h.current,F=(C-b.current)/x.current,N=(M-b.current)/x.current,m=f.math.round(Math.min(R,g)+1),d=f.math.round(Math.max(R,g)-1),l=f.math.round(Math.min(F,N)+1),a=f.math.round(Math.max(F,N)-1);if(O.current=[m,d,l,a],Number.isFinite(m)&&Number.isFinite(d)&&Number.isFinite(l)&&Number.isFinite(a)){let r=[];for(let t=l;t<=a;t++){let o=t*u.dy+u.yoffset,e=[];for(let n=m;n<=d;n++)e.push(c.create("point",[n*u.dx+u.xoffset,o],v.current));r.push(e)}s.current=r}c.on("boundingbox",()=>{let[r,t,o,e]=c.getBoundingBox(),n=(r-p.current)/h.current,j=(o-p.current)/h.current,k=(e-b.current)/x.current,U=(t-b.current)/x.current,Y=f.math.round(Math.min(n,j)+1),z=f.math.round(Math.max(n,j)-1),D=f.math.round(Math.min(k,U)+1),G=f.math.round(Math.max(k,U)-1),[P,T,V,X]=O.current;(Y!==P||z!==T||D!==V||G!==X)&&_(Y,z,D,G)})}function w(){if(s.current!==null)for(let i of s.current)for(let M of i)c.removeObject(M);s.current=null}function _(i,M,y,C){if(s.current===null)return S();if(!Number.isFinite(i)||!Number.isFinite(M)||!Number.isFinite(y)||!Number.isFinite(C))return w();let[R,g,F,N]=O.current,m=C-y+1,d=N-F+1,l=M-i+1,a=g-R+1;for(let r=0;r<Math.min(m,d);r++){let t=s.current[r],o=(r+y)*x.current+b.current;for(let e=0;e<Math.min(l,a);e++){let n=(e+i)*h.current+p.current;t[e].coords.setCoordinates(JXG.COORDS_BY_USER,[n,o]),t[e].needsUpdate=!0,t[e].update()}if(a>l)for(let e=l;e<a;e++){let n=t.pop();c.removeObject(n)}else if(a<l)for(let e=a;e<l;e++){let n=(e+i)*h.current+p.current;t.push(c.create("point",[n,o],v.current))}}if(d>m)for(let r=m;r<d;r++){let t=s.current.pop();for(let o=0;o<a;o++){let e=t.pop();c.removeObject(e)}}else if(d<m)for(let r=d;r<m;r++){let t=[],o=(r+y)*x.current+b.current;for(let e=0;e<l;e++){let n=(e+i)*h.current+p.current;t.push(c.create("point",[n,o],v.current))}s.current.push(t)}O.current=[i,M,y,C],c.updateRenderer()}if(c)if(s.current===null)S();else{let[i,M,y,C]=c.getBoundingBox(),R=(i-p.current)/h.current,g=(y-p.current)/h.current,F=(C-b.current)/x.current,N=(M-b.current)/x.current,m=f.math.round(Math.min(R,g)+1),d=f.math.round(Math.max(R,g)-1),l=f.math.round(Math.min(F,N)+1),a=f.math.round(Math.max(F,N)-1);_(m,d,l,a);let r=(A=s.current[0])==null?void 0:A[0];if(r){let t=10*u.layer+E;if(r.visProp.layer!==t)for(let o of s.current)for(let e of o)e.setAttribute({layer:t})}}return null});export{ne as default};
