import{M as ue,u as oe,r as u,h as ae,i as se,j as de}from"./index-2b5c64d9.js";import{BoardContext as fe,LINE_LAYER_OFFSET as H,POINT_LAYER_OFFSET as Q}from"./graph-6d43a295-5c8ba528.js";import{v as x,a as q,X as W,z as X,L as V,C as K,Y as Z,q as ee}from"./offGraphIndicators-6eabeb84-d9cfe74c.js";import"./css-ab4d83ca-d016d639.js";const ge=ue.memo(function E(te){let{name:F,id:J,SVs:e,actions:a,callAction:s}=oe(te);E.ignoreActionsWithoutCore=()=>!0;const l=u.useContext(fe);let r=u.useRef(null),n=u.useRef(null),d=u.useRef(!1),S=u.useRef(null),I=u.useRef(!1),_=u.useRef(!1),M=u.useRef(null),f=u.useRef(null),g=u.useRef(null),Y=u.useRef(null),N=u.useRef(null),v=u.useRef(null),b=u.useRef(null),G=u.useRef(null),P=u.useRef(!1),O=u.useRef(!1),h=u.useRef(!1),i=u.useRef([0,0]),p=u.useRef([0,0]),U=u.useRef([0,0]);b.current=e.numericalCenter,G.current=e.throughAngles,P.current=e.fixed,O.current=!e.draggable||e.fixLocation||e.fixed;const D=ae(se);u.useEffect(()=>()=>{r.current&&j(),l&&l.off("move",$)},[]),u.useEffect(()=>{l&&l.on("move",$)},[l]);function ne(){if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))return null;let C=D==="dark"?e.selectedStyle.lineColorDarkMode:e.selectedStyle.lineColor,y=D==="dark"?e.selectedStyle.fillColorDarkMode:e.selectedStyle.fillColor;y=e.filled?y:"none";let L=D==="dark"?e.selectedStyle.markerColorDarkMode:e.selectedStyle.markerColor,R=e.labelForGraph!=="";var o={name:e.labelForGraph,visible:!e.hidden,withlabel:R,fixed:P.current,layer:10*e.layer+H,strokeColor:C,strokeOpacity:e.selectedStyle.lineOpacity,highlightStrokeColor:C,strokeWidth:e.selectedStyle.lineWidth,highlightStrokeWidth:e.selectedStyle.lineWidth,highlightStrokeOpacity:e.selectedStyle.lineOpacity*.5,dash:re(e.selectedStyle.lineStyle),fillColor:y,fillOpacity:e.selectedStyle.fillOpacity,highlightFillColor:y,highlightFillOpacity:e.selectedStyle.fillOpacity*.5,highlight:!O.current};e.filled&&(o.hasInnerPoints=!0),o.label={highlight:!1},e.labelHasLatex&&(o.label.useMathJax=!0),e.labelForGraph!==""&&(e.applyStyleToLabel?o.label.strokeColor=C:o.label.strokeColor="var(--canvastext)"),r.current=l.create("circle",[[...e.numericalCenter],e.numericalRadius],o),r.current.isDraggable=!O.current;let m={name:e.labelForGraph,visible:!e.hidden&&h.current,withlabel:R,fixed:P.current,layer:10*e.layer+Q,fillColor:L,strokeColor:"none",strokeOpacity:e.selectedStyle.markerOpacity,fillOpacity:e.selectedStyle.markerOpacity,highlightFillColor:"var(--mainGray)",highlightStrokeColor:"var(--lightBlue)",size:K(e.selectedStyle.markerSize,e.selectedStyle.markerStyle),face:V(e.selectedStyle.markerStyle,i.current),highlight:!O.current,showinfobox:!1};if(R){let t=Z("upperright",i.current);N.current=t;let{offset:c,anchorx:A,anchory:k}=ee(t);m.label={offset:c,anchorx:A,anchory:k,highlight:!1},e.labelHasLatex&&(m.label.useMathJax=!0),e.applyStyleToLabel?m.label.strokeColor=L:m.label.strokeColor="var(--canvastext)"}else m.label={highlight:!1},e.labelHasLatex&&(m.label.useMathJax=!0);return n.current=l.create("point",[...p.current],m),n.isDraggable=!O.current,r.current.on("drag",function(t){let c=t.type==="pointermove";if((!c||Math.abs(t.x-S.current[0])>.1||Math.abs(t.y-S.current[1])>.1)&&(d.current=!0),c){var A=l.origin.scrCoords;let k=(M.current[1]+t.x-S.current[0]-A[1])/l.unitX,w=(A[2]-(M.current[2]+t.y-S.current[1]))/l.unitY;v.current=[k,w]}else v.current=[r.current.center.X(),r.current.center.Y()];s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current,transient:!0,skippable:!0}}),r.current.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...b.current])}),r.current.on("up",function(t){d.current?s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}):!_.current&&!P.current&&s({action:a.circleClicked,args:{name:F}}),I.current=!1}),r.current.on("keyfocusout",function(t){d.current&&(s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}),d.current=!1),I.current=!1}),r.current.on("down",function(t){d.current=!1,S.current=[t.x,t.y],M.current=[...r.current.center.coords.scrCoords],f.current=r.current.radius,g.current=[...G.current],I.current=!0,_.current=!1,P.current||s({action:a.circleFocused,args:{name:F}})}),r.current.on("hit",function(t){d.current=!1,M.current=[...r.current.center.coords.scrCoords],f.current=r.current.radius,g.current=[...G.current],s({action:a.circleFocused,args:{name:F}})}),r.current.on("keydown",function(t){t.key==="Enter"&&(d.current&&(s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}),d.current=!1),s({action:a.circleClicked,args:{name:F}}))}),n.current.on("drag",function(t){(t.type!=="pointermove"||Math.abs(t.x-S.current[0])>.1||Math.abs(t.y-S.current[1])>.1)&&(d.current=!0),v.current=[n.current.X()+U.current[0],n.current.Y()+U.current[1]],s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current,transient:!0,skippable:!0}})}),n.current.on("up",function(t){d.current?s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}):!_.current&&!P.current&&s({action:a.circleClicked,args:{name:F}}),I.current=!1}),n.current.on("keyfocusout",function(t){d.current&&(s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}),d.current=!1),I.current=!1}),n.current.on("down",function(t){d.current=!1,S.current=[t.x,t.y],M.current=[...r.current.center.coords.scrCoords],f.current=r.current.radius,g.current=[...G.current];let{flippedX:c,flippedY:A}=q(l),k=c?-1:1,w=A?-1:1;if(i.current[0]===0||i.current[1]===0)U.current=[k*i.current[0]*f.current,w*i.current[1]*f.current];else{let T=Math.sqrt(2);U.current=[k/T*i.current[0]*f.current,w/T*i.current[1]*f.current]}I.current=!0,_.current=!1,P.current||s({action:a.circleFocused,args:{name:F}})}),n.current.on("hit",function(t){d.current=!1,M.current=[...r.current.center.coords.scrCoords],f.current=r.current.radius,g.current=[...G.current],s({action:a.circleFocused,args:{name:F}})}),n.current.on("keydown",function(t){t.key==="Enter"&&(d.current&&(s({action:a.moveCircle,args:{center:v.current,radius:f.current,throughAngles:g.current}}),d.current=!1),s({action:a.circleClicked,args:{name:F}}))}),Y.current=e.labelForGraph!=="",r.current}function $(C){I.current&&(Math.abs(C.x-S.current[0])>.1||Math.abs(C.y-S.current[1])>.1)&&(_.current=!0)}function j(){n.current.off("drag"),n.current.off("down"),n.current.off("up"),n.current.off("hit"),n.current.off("keyfocusout"),n.current.off("keydown"),l.removeObject(n.current),n.current=null,r.current.off("drag"),r.current.off("down"),r.current.off("up"),r.current.off("hit"),r.current.off("keyfocusout"),r.current.off("keydown"),l.removeObject(r.current),r.current=null}if(l){if(b.current=[...e.numericalCenter],h.current=!1,i.current=[0,0],p.current=[0,0],!e.hideOffGraphIndicator){let C=x(b.current,l);if(C.needIndicator){let y=C.indicatorSides,{flippedX:L,flippedY:R}=q(l),o=L?-1:1,m=R?-1:1;if(y[0]===1)if(y[1]===1){let t=[...b.current];if(t[0]-=e.numericalRadius*o,t[1]-=e.numericalRadius*m,x(t,l).needIndicator)h.current=!0,i.current=[1,1],p.current=W(l,[1,1]);else{let c=X({center:e.numericalCenter,radius:e.numericalRadius,directionToCheck:[1,1],board:l});c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}}else if(y[1]===-1){let t=[...b.current];if(t[0]-=e.numericalRadius*o,t[1]+=e.numericalRadius*m,x(t,l).needIndicator)h.current=!0,i.current=[1,-1],p.current=W(l,[1,-1]);else{let c=X({center:e.numericalCenter,radius:e.numericalRadius,directionToCheck:[1,-1],board:l});c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}}else{let t=[...b.current];t[0]-=e.numericalRadius*o;let c=x(t,l);c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}else if(y[0]===-1)if(y[1]===1){let t=[...b.current];if(t[0]+=e.numericalRadius*o,t[1]-=e.numericalRadius*m,x(t,l).needIndicator)h.current=!0,i.current=[-1,1],p.current=W(l,[-1,1]);else{let c=X({center:e.numericalCenter,radius:e.numericalRadius,directionToCheck:[-1,1],board:l});c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}}else if(y[1]===-1){let t=[...b.current];if(t[0]+=e.numericalRadius*o,t[1]+=e.numericalRadius*m,x(t,l).needIndicator)h.current=!0,i.current=[-1,-1],p.current=W(l,[-1,-1]);else{let c=X({center:e.numericalCenter,radius:e.numericalRadius,directionToCheck:[-1,-1],board:l});c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}}else{let t=[...b.current];t[0]+=e.numericalRadius*o;let c=x(t,l);c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}else if(y[1]===1){let t=[...b.current];t[1]-=e.numericalRadius*o;let c=x(t,l);c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}else{let t=[...b.current];t[1]+=e.numericalRadius*o;let c=x(t,l);c.needIndicator&&(h.current=!0,i.current=c.indicatorSides,p.current=c.indicatorCoords)}}}if(!r.current)ne();else if(!(Number.isFinite(e.numericalCenter[0])&&Number.isFinite(e.numericalCenter[1])&&e.numericalRadius>0))j();else{l.updateQuality===l.BOARD_QUALITY_LOW&&(l.itemsRenderedLowQuality[J]=r.current);let C=e.numericalCenter.every(k=>Number.isFinite(k));r.current.center.coords.setCoordinates(JXG.COORDS_BY_USER,[...e.numericalCenter]),r.current.setRadius(e.numericalRadius);let y=!e.hidden;C?(r.current.visProp.visible=y,r.current.visPropCalc.visible=y):(r.current.visProp.visible=!1,r.current.visPropCalc.visible=!1),r.current.visProp.fixed=P.current,r.current.visProp.highlight=!O.current,r.current.isDraggable=!O.current;let L=10*e.layer+H;r.current.visProp.layer!==L&&r.current.setAttribute({layer:L});let R=D==="dark"?e.selectedStyle.lineColorDarkMode:e.selectedStyle.lineColor,o=D==="dark"?e.selectedStyle.fillColorDarkMode:e.selectedStyle.fillColor;o=e.filled?o:"none",r.current.visProp.strokecolor!==R&&(r.current.visProp.strokecolor=R,r.current.visProp.highlightstrokecolor=R),r.current.visProp.strokeopacity!==e.selectedStyle.lineOpacity&&(r.current.visProp.strokeopacity=e.selectedStyle.lineOpacity,r.current.visProp.highlightstrokeopacity=e.selectedStyle.lineOpacity*.5);let m=re(e.selectedStyle.lineStyle);r.current.visProp.dash!==m&&(r.current.visProp.dash=m),r.current.visProp.strokewidth!==e.selectedStyle.lineWidth&&(r.current.visProp.strokewidth=e.selectedStyle.lineWidth,r.current.visProp.highlightstrokewidth=e.selectedStyle.lineWidth),r.current.visProp.fillcolor!==o&&(r.current.visProp.fillcolor=o,r.current.visProp.highlightfillcolor=o,r.current.visProp.hasinnerpoints=e.filled),r.current.visProp.fillopacity!==e.selectedStyle.fillOpacity&&(r.current.visProp.fillopacity=e.selectedStyle.fillOpacity,r.current.visProp.highlightfillopacity=e.selectedStyle.fillOpacity*.5),r.current.name=e.labelForGraph;let t=e.labelForGraph!=="";t!=Y.current&&(r.current.setAttribute({withlabel:t}),Y.current=t),r.current.needsUpdate=!0,r.current.update(),r.current.hasLabel&&(e.applyStyleToLabel?r.current.label.visProp.strokecolor=R:r.current.label.visProp.strokecolor="var(--canvastext)",r.current.label.needsUpdate=!0,r.current.label.update());let c=h.current&&!e.hidden,A=n.current.visProp.visible!==c;if(n.current.visProp.visible=c,n.current.visPropCalc.visible=c,c){n.current.coords.setCoordinates(JXG.COORDS_BY_USER,p.current);let k=10*e.layer+Q;n.current.visProp.layer!==k&&n.current.setAttribute({layer:k}),n.current.visProp.highlight=!O.current,n.current.visProp.fixed=P.current,n.current.isDraggable=!O.current;let w=D==="dark"?e.selectedStyle.markerColorDarkMode:e.selectedStyle.markerColor;n.current.visProp.fillcolor!==w&&(n.current.visProp.fillcolor=w),n.current.visProp.strokeopacity!==e.selectedStyle.markerOpacity&&(n.current.visProp.strokeopacity=e.selectedStyle.markerOpacity,n.current.visProp.fillopacity=e.selectedStyle.markerOpacity);let T=V(e.selectedStyle.markerStyle,i.current);n.current.visProp.face!==T&&n.current.setAttribute({face:T});let z=K(e.selectedStyle.markerSize,e.selectedStyle.markerStyle);if(n.current.visProp.size!==z&&n.current.setAttribute({size:z}),n.current.name=e.labelForGraph,t!=Y.current&&n.current.setAttribute({withlabel:t}),n.current.hasLabel){n.current.label.needsUpdate=!0,e.applyStyleToLabel?n.current.label.visProp.strokecolor=w:n.current.label.visProp.strokecolor="var(--canvastext)";let B=Z("upperright",i.current);if(B!==N.current){let{offset:ce,anchorx:le,anchory:ie}=ee(B);n.current.label.visProp.anchorx=le,n.current.label.visProp.anchory=ie,n.current.label.visProp.offset=ce,N.current=B,n.current.label.fullUpdate()}else n.current.label.update()}}c||A?n.current.fullUpdate():n.current.update(),l.updateRenderer()}}return e.hidden?null:de.jsx("a",{name:J})});function re(E){return E==="solid"?0:E==="dashed"?2:E==="dotted"?1:0}export{ge as default};
